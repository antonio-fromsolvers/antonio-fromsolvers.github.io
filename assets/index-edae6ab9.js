var Me=Object.defineProperty;var Re=(n,t,e)=>t in n?Me(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var gt=(n,t,e)=>(Re(n,typeof t!="symbol"?t+"":t,e),e),Ce=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var Te=(n,t,e)=>(Ce(n,t,"read from private field"),e?e.call(n):t.get(n)),Se=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)},Ee=(n,t,e,s)=>(Ce(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();const index="";var AttachmentType=(n=>(n[n.Region=0]="Region",n[n.BoundingBox=1]="BoundingBox",n[n.Mesh=2]="Mesh",n[n.LinkedMesh=3]="LinkedMesh",n[n.Path=4]="Path",n[n.Point=5]="Point",n[n.Clipping=6]="Clipping",n))(AttachmentType||{});class BinaryInput{constructor(t,e=new Array,s=0,r=new DataView(t.buffer)){this.strings=e,this.index=s,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),s=e&127;return e&128&&(e=this.readByte(),s|=(e&127)<<7,e&128&&(e=this.readByte(),s|=(e&127)<<14,e&128&&(e=this.readByte(),s|=(e&127)<<21,e&128&&(e=this.readByte(),s|=(e&127)<<28)))),t?s:s>>>1^-(s&1)}readStringRef(){const t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let s=0;s<t;){const r=this.readUnsignedByte();switch(r>>4){case 12:case 13:e+=String.fromCharCode((r&31)<<6|this.readByte()&63),s+=2;break;case 14:e+=String.fromCharCode((r&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),s+=3;break;default:e+=String.fromCharCode(r),s++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}var MixBlend=(n=>(n[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",n))(MixBlend||{}),MixDirection=(n=>(n[n.mixIn=0]="mixIn",n[n.mixOut=1]="mixOut",n))(MixDirection||{}),PositionMode=(n=>(n[n.Fixed=0]="Fixed",n[n.Percent=1]="Percent",n))(PositionMode||{}),RotateMode=(n=>(n[n.Tangent=0]="Tangent",n[n.Chain=1]="Chain",n[n.ChainScale=2]="ChainScale",n))(RotateMode||{}),TransformMode=(n=>(n[n.Normal=0]="Normal",n[n.OnlyTranslation=1]="OnlyTranslation",n[n.NoRotationOrReflection=2]="NoRotationOrReflection",n[n.NoScale=3]="NoScale",n[n.NoScaleOrReflection=4]="NoScaleOrReflection",n))(TransformMode||{}),ENV=(n=>(n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2",n))(ENV||{}),BUFFER_BITS=(n=>(n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL",n))(BUFFER_BITS||{}),BLEND_MODES=(n=>(n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR",n))(BLEND_MODES||{}),DRAW_MODES=(n=>(n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n))(DRAW_MODES||{}),FORMATS=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(FORMATS||{}),TARGETS=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(TARGETS||{}),TYPES=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(TYPES||{}),SAMPLER_TYPES=(n=>(n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT",n))(SAMPLER_TYPES||{}),SCALE_MODES=(n=>(n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR",n))(SCALE_MODES||{}),WRAP_MODES=(n=>(n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n))(WRAP_MODES||{}),MIPMAP_MODES=(n=>(n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL",n))(MIPMAP_MODES||{}),ALPHA_MODES=(n=>(n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",n))(ALPHA_MODES||{}),CLEAR_MODES=(n=>(n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT",n))(CLEAR_MODES||{}),GC_MODES=(n=>(n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",n))(GC_MODES||{}),PRECISION=(n=>(n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp",n))(PRECISION||{}),MASK_TYPES=(n=>(n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR",n))(MASK_TYPES||{}),MSAA_QUALITY=(n=>(n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH",n))(MSAA_QUALITY||{}),BUFFER_TYPE=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(BUFFER_TYPE||{});const BrowserAdapter={createCanvas:(n,t)=>{const e=document.createElement("canvas");return e.width=n,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,t)=>fetch(n,t),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")},settings$1={ADAPTER:BrowserAdapter,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function createMatch(n){return function(t){return t.test(n)}}function isMobile$1(n){var t={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?t.userAgent=n:n&&n.userAgent&&(t={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=createMatch(e),a={apple:{phone:r(appleIphone)&&!r(windowsPhone),ipod:r(appleIpod),tablet:!r(appleIphone)&&(r(appleTablet)||isAppleTabletOnIos13(t))&&!r(windowsPhone),universal:r(appleUniversal),device:(r(appleIphone)||r(appleIpod)||r(appleTablet)||r(appleUniversal)||isAppleTabletOnIos13(t))&&!r(windowsPhone)},amazon:{phone:r(amazonPhone),tablet:!r(amazonPhone)&&r(amazonTablet),device:r(amazonPhone)||r(amazonTablet)},android:{phone:!r(windowsPhone)&&r(amazonPhone)||!r(windowsPhone)&&r(androidPhone),tablet:!r(windowsPhone)&&!r(amazonPhone)&&!r(androidPhone)&&(r(amazonTablet)||r(androidTablet)),device:!r(windowsPhone)&&(r(amazonPhone)||r(amazonTablet)||r(androidPhone)||r(androidTablet))||r(/\bokhttp\b/i)},windows:{phone:r(windowsPhone),tablet:r(windowsTablet),device:r(windowsPhone)||r(windowsTablet)},other:{blackberry:r(otherBlackBerry),blackberry10:r(otherBlackBerry10),opera:r(otherOpera),firefox:r(otherFirefox),chrome:r(otherChrome),device:r(otherBlackBerry)||r(otherBlackBerry10)||r(otherOpera)||r(otherFirefox)||r(otherChrome)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}const isMobile=isMobile$1(globalThis.navigator);settings$1.RETINA_PREFIX=/@([0-9\.]+)x/;settings$1.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},eventemitter3Exports={},eventemitter3={get exports(){return eventemitter3Exports},set exports(n){eventemitter3Exports=n}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(o,u,d){this.fn=o,this.context=u,this.once=d||!1}function a(o,u,d,m,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new r(d,m||o,p),_=e?e+u:u;return o._events[_]?o._events[_].fn?o._events[_]=[o._events[_],g]:o._events[_].push(g):(o._events[_]=g,o._eventsCount++),o}function h(o,u){--o._eventsCount===0?o._events=new s:delete o._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],d,m;if(this._eventsCount===0)return u;for(m in d=this._events)t.call(d,m)&&u.push(e?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},c.prototype.listeners=function(u){var d=e?e+u:u,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var p=0,g=m.length,_=new Array(g);p<g;p++)_[p]=m[p].fn;return _},c.prototype.listenerCount=function(u){var d=e?e+u:u,m=this._events[d];return m?m.fn?1:m.length:0},c.prototype.emit=function(u,d,m,p,g,_){var y=e?e+u:u;if(!this._events[y])return!1;var v=this._events[y],U=arguments.length,w,k;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),U){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,m),!0;case 4:return v.fn.call(v.context,d,m,p),!0;case 5:return v.fn.call(v.context,d,m,p,g),!0;case 6:return v.fn.call(v.context,d,m,p,g,_),!0}for(k=1,w=new Array(U-1);k<U;k++)w[k-1]=arguments[k];v.fn.apply(v.context,w)}else{var N=v.length,W;for(k=0;k<N;k++)switch(v[k].once&&this.removeListener(u,v[k].fn,void 0,!0),U){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,d);break;case 3:v[k].fn.call(v[k].context,d,m);break;case 4:v[k].fn.call(v[k].context,d,m,p);break;default:if(!w)for(W=1,w=new Array(U-1);W<U;W++)w[W-1]=arguments[W];v[k].fn.apply(v[k].context,w)}}return!0},c.prototype.on=function(u,d,m){return a(this,u,d,m,!1)},c.prototype.once=function(u,d,m){return a(this,u,d,m,!0)},c.prototype.removeListener=function(u,d,m,p){var g=e?e+u:u;if(!this._events[g])return this;if(!d)return h(this,g),this;var _=this._events[g];if(_.fn)_.fn===d&&(!p||_.once)&&(!m||_.context===m)&&h(this,g);else{for(var y=0,v=[],U=_.length;y<U;y++)(_[y].fn!==d||p&&!_[y].once||m&&_[y].context!==m)&&v.push(_[y]);v.length?this._events[g]=v.length===1?v[0]:v:h(this,g)}return this},c.prototype.removeAllListeners=function(u){var d;return u?(d=e?e+u:u,this._events[d]&&h(this,d)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=e,c.EventEmitter=c,n.exports=c})(eventemitter3);var earcutExports={},earcut$1={get exports(){return earcutExports},set exports(n){earcutExports=n}};earcut$1.exports=earcut;earcutExports.default=earcut;function earcut(n,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:n.length,a=linkedList(n,0,r,e,!0),h=[];if(!a||a.next===a.prev)return h;var c,o,u,d,m,p,g;if(s&&(a=eliminateHoles(n,t,a,e)),n.length>80*e){c=u=n[0],o=d=n[1];for(var _=e;_<r;_+=e)m=n[_],p=n[_+1],m<c&&(c=m),p<o&&(o=p),m>u&&(u=m),p>d&&(d=p);g=Math.max(u-c,d-o),g=g!==0?32767/g:0}return earcutLinked(a,h,e,c,o,g,0),h}function linkedList(n,t,e,s,r){var a,h;if(r===signedArea(n,t,e,s)>0)for(a=t;a<e;a+=s)h=insertNode(a,n[a],n[a+1],h);else for(a=e-s;a>=t;a-=s)h=insertNode(a,n[a],n[a+1],h);return h&&equals(h,h.next)&&(removeNode(h),h=h.next),h}function filterPoints(n,t){if(!n)return n;t||(t=n);var e=n,s;do if(s=!1,!e.steiner&&(equals(e,e.next)||area(e.prev,e,e.next)===0)){if(removeNode(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function earcutLinked(n,t,e,s,r,a,h){if(n){!h&&a&&indexCurve(n,s,r,a);for(var c=n,o,u;n.prev!==n.next;){if(o=n.prev,u=n.next,a?isEarHashed(n,s,r,a):isEar(n)){t.push(o.i/e|0),t.push(n.i/e|0),t.push(u.i/e|0),removeNode(n),n=u.next,c=u.next;continue}if(n=u,n===c){h?h===1?(n=cureLocalIntersections(filterPoints(n),t,e),earcutLinked(n,t,e,s,r,a,2)):h===2&&splitEarcut(n,t,e,s,r,a):earcutLinked(filterPoints(n),t,e,s,r,a,1);break}}}}function isEar(n){var t=n.prev,e=n,s=n.next;if(area(t,e,s)>=0)return!1;for(var r=t.x,a=e.x,h=s.x,c=t.y,o=e.y,u=s.y,d=r<a?r<h?r:h:a<h?a:h,m=c<o?c<u?c:u:o<u?o:u,p=r>a?r>h?r:h:a>h?a:h,g=c>o?c>u?c:u:o>u?o:u,_=s.next;_!==t;){if(_.x>=d&&_.x<=p&&_.y>=m&&_.y<=g&&pointInTriangle(r,c,a,o,h,u,_.x,_.y)&&area(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function isEarHashed(n,t,e,s){var r=n.prev,a=n,h=n.next;if(area(r,a,h)>=0)return!1;for(var c=r.x,o=a.x,u=h.x,d=r.y,m=a.y,p=h.y,g=c<o?c<u?c:u:o<u?o:u,_=d<m?d<p?d:p:m<p?m:p,y=c>o?c>u?c:u:o>u?o:u,v=d>m?d>p?d:p:m>p?m:p,U=zOrder(g,_,t,e,s),w=zOrder(y,v,t,e,s),k=n.prevZ,N=n.nextZ;k&&k.z>=U&&N&&N.z<=w;){if(k.x>=g&&k.x<=y&&k.y>=_&&k.y<=v&&k!==r&&k!==h&&pointInTriangle(c,d,o,m,u,p,k.x,k.y)&&area(k.prev,k,k.next)>=0||(k=k.prevZ,N.x>=g&&N.x<=y&&N.y>=_&&N.y<=v&&N!==r&&N!==h&&pointInTriangle(c,d,o,m,u,p,N.x,N.y)&&area(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;k&&k.z>=U;){if(k.x>=g&&k.x<=y&&k.y>=_&&k.y<=v&&k!==r&&k!==h&&pointInTriangle(c,d,o,m,u,p,k.x,k.y)&&area(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;N&&N.z<=w;){if(N.x>=g&&N.x<=y&&N.y>=_&&N.y<=v&&N!==r&&N!==h&&pointInTriangle(c,d,o,m,u,p,N.x,N.y)&&area(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function cureLocalIntersections(n,t,e){var s=n;do{var r=s.prev,a=s.next.next;!equals(r,a)&&intersects(r,s,s.next,a)&&locallyInside(r,a)&&locallyInside(a,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(a.i/e|0),removeNode(s),removeNode(s.next),s=n=a),s=s.next}while(s!==n);return filterPoints(s)}function splitEarcut(n,t,e,s,r,a){var h=n;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&isValidDiagonal(h,c)){var o=splitPolygon(h,c);h=filterPoints(h,h.next),o=filterPoints(o,o.next),earcutLinked(h,t,e,s,r,a,0),earcutLinked(o,t,e,s,r,a,0);return}c=c.next}h=h.next}while(h!==n)}function eliminateHoles(n,t,e,s){var r=[],a,h,c,o,u;for(a=0,h=t.length;a<h;a++)c=t[a]*s,o=a<h-1?t[a+1]*s:n.length,u=linkedList(n,c,o,s,!1),u===u.next&&(u.steiner=!0),r.push(getLeftmost(u));for(r.sort(compareX),a=0;a<r.length;a++)e=eliminateHole(r[a],e);return e}function compareX(n,t){return n.x-t.x}function eliminateHole(n,t){var e=findHoleBridge(n,t);if(!e)return t;var s=splitPolygon(e,n);return filterPoints(s,s.next),filterPoints(e,e.next)}function findHoleBridge(n,t){var e=t,s=n.x,r=n.y,a=-1/0,h;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var c=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(c<=s&&c>a&&(a=c,h=e.x<e.next.x?e:e.next,c===s))return h}e=e.next}while(e!==t);if(!h)return null;var o=h,u=h.x,d=h.y,m=1/0,p;e=h;do s>=e.x&&e.x>=u&&s!==e.x&&pointInTriangle(r<d?s:a,r,u,d,r<d?a:s,r,e.x,e.y)&&(p=Math.abs(r-e.y)/(s-e.x),locallyInside(e,n)&&(p<m||p===m&&(e.x>h.x||e.x===h.x&&sectorContainsSector(h,e)))&&(h=e,m=p)),e=e.next;while(e!==o);return h}function sectorContainsSector(n,t){return area(n.prev,n,t.prev)<0&&area(t.next,n,n.next)<0}function indexCurve(n,t,e,s){var r=n;do r.z===0&&(r.z=zOrder(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,sortLinked(r)}function sortLinked(n){var t,e,s,r,a,h,c,o,u=1;do{for(e=n,n=null,a=null,h=0;e;){for(h++,s=e,c=0,t=0;t<u&&(c++,s=s.nextZ,!!s);t++);for(o=u;c>0||o>0&&s;)c!==0&&(o===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,c--):(r=s,s=s.nextZ,o--),a?a.nextZ=r:n=r,r.prevZ=a,a=r;e=s}a.nextZ=null,u*=2}while(h>1);return n}function zOrder(n,t,e,s,r){return n=(n-e)*r|0,t=(t-s)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function getLeftmost(n){var t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function pointInTriangle(n,t,e,s,r,a,h,c){return(r-h)*(t-c)>=(n-h)*(a-c)&&(n-h)*(s-c)>=(e-h)*(t-c)&&(e-h)*(a-c)>=(r-h)*(s-c)}function isValidDiagonal(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!intersectsPolygon(n,t)&&(locallyInside(n,t)&&locallyInside(t,n)&&middleInside(n,t)&&(area(n.prev,n,t.prev)||area(n,t.prev,t))||equals(n,t)&&area(n.prev,n,n.next)>0&&area(t.prev,t,t.next)>0)}function area(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function equals(n,t){return n.x===t.x&&n.y===t.y}function intersects(n,t,e,s){var r=sign$1(area(n,t,e)),a=sign$1(area(n,t,s)),h=sign$1(area(e,s,n)),c=sign$1(area(e,s,t));return!!(r!==a&&h!==c||r===0&&onSegment(n,e,t)||a===0&&onSegment(n,s,t)||h===0&&onSegment(e,n,s)||c===0&&onSegment(e,t,s))}function onSegment(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function sign$1(n){return n>0?1:n<0?-1:0}function intersectsPolygon(n,t){var e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&intersects(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function locallyInside(n,t){return area(n.prev,n,n.next)<0?area(n,t,n.next)>=0&&area(n,n.prev,t)>=0:area(n,t,n.prev)<0||area(n,n.next,t)<0}function middleInside(n,t){var e=n,s=!1,r=(n.x+t.x)/2,a=(n.y+t.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&r<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==n);return s}function splitPolygon(n,t){var e=new Node(n.i,n.x,n.y),s=new Node(t.i,t.x,t.y),r=n.next,a=t.prev;return n.next=t,t.prev=n,e.next=r,r.prev=e,s.next=e,e.prev=s,a.next=s,s.prev=a,s}function insertNode(n,t,e,s){var r=new Node(n,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function removeNode(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Node(n,t,e){this.i=n,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}earcut.deviation=function(n,t,e,s){var r=t&&t.length,a=r?t[0]*e:n.length,h=Math.abs(signedArea(n,0,a,e));if(r)for(var c=0,o=t.length;c<o;c++){var u=t[c]*e,d=c<o-1?t[c+1]*e:n.length;h-=Math.abs(signedArea(n,u,d,e))}var m=0;for(c=0;c<s.length;c+=3){var p=s[c]*e,g=s[c+1]*e,_=s[c+2]*e;m+=Math.abs((n[p]-n[_])*(n[g+1]-n[p+1])-(n[p]-n[g])*(n[_+1]-n[p+1]))}return h===0&&m===0?0:Math.abs((m-h)/h)};function signedArea(n,t,e,s){for(var r=0,a=t,h=e-s;a<e;a+=s)r+=(n[h]-n[a])*(n[a+1]+n[h+1]),h=a;return r}earcut.flatten=function(n){for(var t=n[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<n.length;r++){for(var a=0;a<n[r].length;a++)for(var h=0;h<t;h++)e.vertices.push(n[r][a][h]);r>0&&(s+=n[r-1].length,e.holes.push(s))}return e};var punycodeExports={},punycode$1={get exports(){return punycodeExports},set exports(n){punycodeExports=n}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(n,t){(function(e){var s=t&&!t.nodeType&&t,r=n&&!n.nodeType&&n,a=typeof commonjsGlobal=="object"&&commonjsGlobal;(a.global===a||a.window===a||a.self===a)&&(e=a);var h,c=2147483647,o=36,u=1,d=26,m=38,p=700,g=72,_=128,y="-",v=/^xn--/,U=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=o-u,W=Math.floor,et=String.fromCharCode,it;function ft(Et){throw RangeError(k[Et])}function mt(Et,Ft){for(var Lt=Et.length,Ht=[];Lt--;)Ht[Lt]=Ft(Et[Lt]);return Ht}function xt(Et,Ft){var Lt=Et.split("@"),Ht="";Lt.length>1&&(Ht=Lt[0]+"@",Et=Lt[1]),Et=Et.replace(w,".");var Wt=Et.split("."),Zt=mt(Wt,Ft).join(".");return Ht+Zt}function yt(Et){for(var Ft=[],Lt=0,Ht=Et.length,Wt,Zt;Lt<Ht;)Wt=Et.charCodeAt(Lt++),Wt>=55296&&Wt<=56319&&Lt<Ht?(Zt=Et.charCodeAt(Lt++),(Zt&64512)==56320?Ft.push(((Wt&1023)<<10)+(Zt&1023)+65536):(Ft.push(Wt),Lt--)):Ft.push(Wt);return Ft}function vt(Et){return mt(Et,function(Ft){var Lt="";return Ft>65535&&(Ft-=65536,Lt+=et(Ft>>>10&1023|55296),Ft=56320|Ft&1023),Lt+=et(Ft),Lt}).join("")}function St(Et){return Et-48<10?Et-22:Et-65<26?Et-65:Et-97<26?Et-97:o}function wt(Et,Ft){return Et+22+75*(Et<26)-((Ft!=0)<<5)}function Ct(Et,Ft,Lt){var Ht=0;for(Et=Lt?W(Et/p):Et>>1,Et+=W(Et/Ft);Et>N*d>>1;Ht+=o)Et=W(Et/N);return W(Ht+(N+1)*Et/(Et+m))}function It(Et){var Ft=[],Lt=Et.length,Ht,Wt=0,Zt=_,ee=g,ne,se,Nt,Yt,zt,te,Qt,ie,re;for(ne=Et.lastIndexOf(y),ne<0&&(ne=0),se=0;se<ne;++se)Et.charCodeAt(se)>=128&&ft("not-basic"),Ft.push(Et.charCodeAt(se));for(Nt=ne>0?ne+1:0;Nt<Lt;){for(Yt=Wt,zt=1,te=o;Nt>=Lt&&ft("invalid-input"),Qt=St(Et.charCodeAt(Nt++)),(Qt>=o||Qt>W((c-Wt)/zt))&&ft("overflow"),Wt+=Qt*zt,ie=te<=ee?u:te>=ee+d?d:te-ee,!(Qt<ie);te+=o)re=o-ie,zt>W(c/re)&&ft("overflow"),zt*=re;Ht=Ft.length+1,ee=Ct(Wt-Yt,Ht,Yt==0),W(Wt/Ht)>c-Zt&&ft("overflow"),Zt+=W(Wt/Ht),Wt%=Ht,Ft.splice(Wt++,0,Zt)}return vt(Ft)}function Pt(Et){var Ft,Lt,Ht,Wt,Zt,ee,ne,se,Nt,Yt,zt,te=[],Qt,ie,re,le;for(Et=yt(Et),Qt=Et.length,Ft=_,Lt=0,Zt=g,ee=0;ee<Qt;++ee)zt=Et[ee],zt<128&&te.push(et(zt));for(Ht=Wt=te.length,Wt&&te.push(y);Ht<Qt;){for(ne=c,ee=0;ee<Qt;++ee)zt=Et[ee],zt>=Ft&&zt<ne&&(ne=zt);for(ie=Ht+1,ne-Ft>W((c-Lt)/ie)&&ft("overflow"),Lt+=(ne-Ft)*ie,Ft=ne,ee=0;ee<Qt;++ee)if(zt=Et[ee],zt<Ft&&++Lt>c&&ft("overflow"),zt==Ft){for(se=Lt,Nt=o;Yt=Nt<=Zt?u:Nt>=Zt+d?d:Nt-Zt,!(se<Yt);Nt+=o)le=se-Yt,re=o-Yt,te.push(et(wt(Yt+le%re,0))),se=W(le/re);te.push(et(wt(se,0))),Zt=Ct(Lt,ie,Ht==Wt),Lt=0,++Ht}++Lt,++Ft}return te.join("")}function Xt(Et){return xt(Et,function(Ft){return v.test(Ft)?It(Ft.slice(4).toLowerCase()):Ft})}function Ut(Et){return xt(Et,function(Ft){return U.test(Ft)?"xn--"+Pt(Ft):Ft})}if(h={version:"1.3.2",ucs2:{decode:yt,encode:vt},decode:It,encode:Pt,toASCII:Ut,toUnicode:Xt},s&&r)if(n.exports==s)r.exports=h;else for(it in h)h.hasOwnProperty(it)&&(s[it]=h[it]);else e.punycode=h})(commonjsGlobal)})(punycode$1,punycodeExports);var util$9={isString:function(n){return typeof n=="string"},isObject:function(n){return typeof n=="object"&&n!==null},isNull:function(n){return n===null},isNullOrUndefined:function(n){return n==null}},querystring$1={};function hasOwnProperty(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var decode=function(n,t,e,s){t=t||"&",e=e||"=";var r={};if(typeof n!="string"||n.length===0)return r;var a=/\+/g;n=n.split(t);var h=1e3;s&&typeof s.maxKeys=="number"&&(h=s.maxKeys);var c=n.length;h>0&&c>h&&(c=h);for(var o=0;o<c;++o){var u=n[o].replace(a,"%20"),d=u.indexOf(e),m,p,g,_;d>=0?(m=u.substr(0,d),p=u.substr(d+1)):(m=u,p=""),g=decodeURIComponent(m),_=decodeURIComponent(p),hasOwnProperty(r,g)?Array.isArray(r[g])?r[g].push(_):r[g]=[r[g],_]:r[g]=_}return r},stringifyPrimitive=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}},encode=function(n,t,e,s){return t=t||"&",e=e||"=",n===null&&(n=void 0),typeof n=="object"?Object.keys(n).map(function(r){var a=encodeURIComponent(stringifyPrimitive(r))+e;return Array.isArray(n[r])?n[r].map(function(h){return a+encodeURIComponent(stringifyPrimitive(h))}).join(t):a+encodeURIComponent(stringifyPrimitive(n[r]))}).join(t):s?encodeURIComponent(stringifyPrimitive(s))+e+encodeURIComponent(stringifyPrimitive(n)):""};querystring$1.decode=querystring$1.parse=decode;querystring$1.encode=querystring$1.stringify=encode;var punycode=punycodeExports,util$8=util$9,parse$1=urlParse,resolve=urlResolve,format=urlFormat;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r",`
`,"	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=querystring$1;function urlParse(n,t,e){if(n&&util$8.isObject(n)&&n instanceof Url)return n;var s=new Url;return s.parse(n,t,e),s}Url.prototype.parse=function(n,t,e){if(!util$8.isString(n))throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var s=n.indexOf("?"),r=s!==-1&&s<n.indexOf("#")?"?":"#",a=n.split(r),h=/\\/g;a[0]=a[0].replace(h,"/"),n=a.join(r);var c=n;if(c=c.trim(),!e&&n.split("#").length===1){var o=simplePathPattern.exec(c);if(o)return this.path=c,this.href=c,this.pathname=o[1],o[2]?(this.search=o[2],t?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=protocolPattern.exec(c);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,c=c.substr(u.length)}if(e||u||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var m=c.substr(0,2)==="//";m&&!(u&&hostlessProtocol[u])&&(c=c.substr(2),this.slashes=!0)}if(!hostlessProtocol[u]&&(m||u&&!slashedProtocol[u])){for(var p=-1,g=0;g<hostEndingChars.length;g++){var _=c.indexOf(hostEndingChars[g]);_!==-1&&(p===-1||_<p)&&(p=_)}var y,v;p===-1?v=c.lastIndexOf("@"):v=c.lastIndexOf("@",p),v!==-1&&(y=c.slice(0,v),c=c.slice(v+1),this.auth=decodeURIComponent(y)),p=-1;for(var g=0;g<nonHostChars.length;g++){var _=c.indexOf(nonHostChars[g]);_!==-1&&(p===-1||_<p)&&(p=_)}p===-1&&(p=c.length),this.host=c.slice(0,p),c=c.slice(p),this.parseHost(),this.hostname=this.hostname||"";var U=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!U)for(var w=this.hostname.split(/\./),g=0,k=w.length;g<k;g++){var N=w[g];if(N&&!N.match(hostnamePartPattern)){for(var W="",et=0,it=N.length;et<it;et++)N.charCodeAt(et)>127?W+="x":W+=N[et];if(!W.match(hostnamePartPattern)){var ft=w.slice(0,g),mt=w.slice(g+1),xt=N.match(hostnamePartStart);xt&&(ft.push(xt[1]),mt.unshift(xt[2])),mt.length&&(c="/"+mt.join(".")+c),this.hostname=ft.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),U||(this.hostname=punycode.toASCII(this.hostname));var yt=this.port?":"+this.port:"",vt=this.hostname||"";this.host=vt+yt,this.href+=this.host,U&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),c[0]!=="/"&&(c="/"+c))}if(!unsafeProtocol[d])for(var g=0,k=autoEscape.length;g<k;g++){var St=autoEscape[g];if(c.indexOf(St)!==-1){var wt=encodeURIComponent(St);wt===St&&(wt=escape(St)),c=c.split(St).join(wt)}}var Ct=c.indexOf("#");Ct!==-1&&(this.hash=c.substr(Ct),c=c.slice(0,Ct));var It=c.indexOf("?");if(It!==-1?(this.search=c.substr(It),this.query=c.substr(It+1),t&&(this.query=querystring.parse(this.query)),c=c.slice(0,It)):t&&(this.search="",this.query={}),c&&(this.pathname=c),slashedProtocol[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var yt=this.pathname||"",Pt=this.search||"";this.path=yt+Pt}return this.href=this.format(),this};function urlFormat(n){return util$8.isString(n)&&(n=urlParse(n)),n instanceof Url?n.format():Url.prototype.format.call(n)}Url.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var t=this.protocol||"",e=this.pathname||"",s=this.hash||"",r=!1,a="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&util$8.isObject(this.query)&&Object.keys(this.query).length&&(a=querystring.stringify(this.query));var h=this.search||a&&"?"+a||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||slashedProtocol[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),h&&h.charAt(0)!=="?"&&(h="?"+h),e=e.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),h=h.replace("#","%23"),t+r+e+h+s};function urlResolve(n,t){return urlParse(n,!1,!0).resolve(t)}Url.prototype.resolve=function(n){return this.resolveObject(urlParse(n,!1,!0)).format()};Url.prototype.resolveObject=function(n){if(util$8.isString(n)){var t=new Url;t.parse(n,!1,!0),n=t}for(var e=new Url,s=Object.keys(this),r=0;r<s.length;r++){var a=s[r];e[a]=this[a]}if(e.hash=n.hash,n.href==="")return e.href=e.format(),e;if(n.slashes&&!n.protocol){for(var h=Object.keys(n),c=0;c<h.length;c++){var o=h[c];o!=="protocol"&&(e[o]=n[o])}return slashedProtocol[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(n.protocol&&n.protocol!==e.protocol){if(!slashedProtocol[n.protocol]){for(var u=Object.keys(n),d=0;d<u.length;d++){var m=u[d];e[m]=n[m]}return e.href=e.format(),e}if(e.protocol=n.protocol,!n.host&&!hostlessProtocol[n.protocol]){for(var k=(n.pathname||"").split("/");k.length&&!(n.host=k.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),k[0]!==""&&k.unshift(""),k.length<2&&k.unshift(""),e.pathname=k.join("/")}else e.pathname=n.pathname;if(e.search=n.search,e.query=n.query,e.host=n.host||"",e.auth=n.auth,e.hostname=n.hostname||n.host,e.port=n.port,e.pathname||e.search){var p=e.pathname||"",g=e.search||"";e.path=p+g}return e.slashes=e.slashes||n.slashes,e.href=e.format(),e}var _=e.pathname&&e.pathname.charAt(0)==="/",y=n.host||n.pathname&&n.pathname.charAt(0)==="/",v=y||_||e.host&&n.pathname,U=v,w=e.pathname&&e.pathname.split("/")||[],k=n.pathname&&n.pathname.split("/")||[],N=e.protocol&&!slashedProtocol[e.protocol];if(N&&(e.hostname="",e.port=null,e.host&&(w[0]===""?w[0]=e.host:w.unshift(e.host)),e.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(k[0]===""?k[0]=n.host:k.unshift(n.host)),n.host=null),v=v&&(k[0]===""||w[0]==="")),y)e.host=n.host||n.host===""?n.host:e.host,e.hostname=n.hostname||n.hostname===""?n.hostname:e.hostname,e.search=n.search,e.query=n.query,w=k;else if(k.length)w||(w=[]),w.pop(),w=w.concat(k),e.search=n.search,e.query=n.query;else if(!util$8.isNullOrUndefined(n.search)){if(N){e.hostname=e.host=w.shift();var W=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;W&&(e.auth=W.shift(),e.host=e.hostname=W.shift())}return e.search=n.search,e.query=n.query,(!util$8.isNull(e.pathname)||!util$8.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!w.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var et=w.slice(-1)[0],it=(e.host||n.host||w.length>1)&&(et==="."||et==="..")||et==="",ft=0,mt=w.length;mt>=0;mt--)et=w[mt],et==="."?w.splice(mt,1):et===".."?(w.splice(mt,1),ft++):ft&&(w.splice(mt,1),ft--);if(!v&&!U)for(;ft--;ft)w.unshift("..");v&&w[0]!==""&&(!w[0]||w[0].charAt(0)!=="/")&&w.unshift(""),it&&w.join("/").substr(-1)!=="/"&&w.push("");var xt=w[0]===""||w[0]&&w[0].charAt(0)==="/";if(N){e.hostname=e.host=xt?"":w.length?w.shift():"";var W=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;W&&(e.auth=W.shift(),e.host=e.hostname=W.shift())}return v=v||e.host&&w.length,v&&!xt&&w.unshift(""),w.length?e.pathname=w.join("/"):(e.pathname=null,e.path=null),(!util$8.isNull(e.pathname)||!util$8.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=n.auth||e.auth,e.slashes=e.slashes||n.slashes,e.href=e.format(),e};Url.prototype.parseHost=function(){var n=this.host,t=portPattern.exec(n);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),n=n.substr(0,n.length-t.length)),n&&(this.hostname=n)};const url={parse:parse$1,format,resolve};function assertPath(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function removeUrlParams(n){return n.split("?")[0].split("#")[0]}function escapeRegExp(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(n,t,e){return n.replace(new RegExp(escapeRegExp(t),"g"),e)}function normalizeStringPosix(n,t){let e="",s=0,r=-1,a=0,h=-1;for(let c=0;c<=n.length;++c){if(c<n.length)h=n.charCodeAt(c);else{if(h===47)break;h=47}if(h===47){if(!(r===c-1||a===1))if(r!==c-1&&a===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",s=0):(e=e.slice(0,o),s=e.length-1-e.lastIndexOf("/")),r=c,a=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=c,a=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${n.slice(r+1,c)}`:e=n.slice(r+1,c),s=c-r-1;r=c,a=0}else h===46&&a!==-1?++a:a=-1}return e}const path$1={toPosix(n){return replaceAll(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},hasProtocol(n){return/^[^/:]+:\//.test(this.toPosix(n))},getProtocol(n){assertPath(n),n=this.toPosix(n);let t="";const e=/^file:\/\/\//.exec(n),s=/^[^/:]+:\/\//.exec(n),r=/^[^/:]+:\//.exec(n);if(e||s||r){const a=(e==null?void 0:e[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);t=a,n=n.slice(a.length)}return t},toAbsolute(n,t,e){if(this.isDataUrl(n))return n;const s=removeUrlParams(this.toPosix(t??settings$1.ADAPTER.getBaseUrl())),r=removeUrlParams(this.toPosix(e??this.rootname(s)));return assertPath(n),n=this.toPosix(n),n.startsWith("/")?path$1.join(r,n.slice(1)):this.isAbsolute(n)?n:this.join(s,n)},normalize(n){if(n=this.toPosix(n),assertPath(n),n.length===0)return".";let t="";const e=n.startsWith("/");this.hasProtocol(n)&&(t=this.rootname(n),n=n.slice(t.length));const s=n.endsWith("/");return n=normalizeStringPosix(n,!1),n.length>0&&s&&(n+="/"),e?`/${n}`:t+n},isAbsolute(n){return assertPath(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let t;for(let e=0;e<n.length;++e){const s=n[e];if(assertPath(s),s.length>0)if(t===void 0)t=s;else{const r=n[e-1]??"";this.extname(r)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(n){if(assertPath(n),n.length===0)return".";n=this.toPosix(n);let t=n.charCodeAt(0);const e=t===47;let s=-1,r=!0;const a=this.getProtocol(n),h=n;n=n.slice(a.length);for(let c=n.length-1;c>=1;--c)if(t=n.charCodeAt(c),t===47){if(!r){s=c;break}}else r=!1;return s===-1?e?"/":this.isUrl(h)?a+n:a:e&&s===1?"//":a+n.slice(0,s)},rootname(n){assertPath(n),n=this.toPosix(n);let t="";if(n.startsWith("/")?t="/":t=this.getProtocol(n),this.isUrl(n)){const e=n.indexOf("/",t.length);e!==-1?t=n.slice(0,e):t=n,t.endsWith("/")||(t+="/")}return t},basename(n,t){assertPath(n),t&&assertPath(t),n=removeUrlParams(this.toPosix(n));let e=0,s=-1,r=!0,a;if(t!==void 0&&t.length>0&&t.length<=n.length){if(t.length===n.length&&t===n)return"";let h=t.length-1,c=-1;for(a=n.length-1;a>=0;--a){const o=n.charCodeAt(a);if(o===47){if(!r){e=a+1;break}}else c===-1&&(r=!1,c=a+1),h>=0&&(o===t.charCodeAt(h)?--h===-1&&(s=a):(h=-1,s=c))}return e===s?s=c:s===-1&&(s=n.length),n.slice(e,s)}for(a=n.length-1;a>=0;--a)if(n.charCodeAt(a)===47){if(!r){e=a+1;break}}else s===-1&&(r=!1,s=a+1);return s===-1?"":n.slice(e,s)},extname(n){assertPath(n),n=removeUrlParams(this.toPosix(n));let t=-1,e=0,s=-1,r=!0,a=0;for(let h=n.length-1;h>=0;--h){const c=n.charCodeAt(h);if(c===47){if(!r){e=h+1;break}continue}s===-1&&(r=!1,s=h+1),c===46?t===-1?t=h:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||s===-1||a===0||a===1&&t===s-1&&t===e+1?"":n.slice(t,s)},parse(n){assertPath(n);const t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;n=removeUrlParams(this.toPosix(n));let e=n.charCodeAt(0);const s=this.isAbsolute(n);let r;t.root=this.rootname(n),s||this.hasProtocol(n)?r=1:r=0;let a=-1,h=0,c=-1,o=!0,u=n.length-1,d=0;for(;u>=r;--u){if(e=n.charCodeAt(u),e===47){if(!o){h=u+1;break}continue}c===-1&&(o=!1,c=u+1),e===46?a===-1?a=u:d!==1&&(d=1):a!==-1&&(d=-1)}return a===-1||c===-1||d===0||d===1&&a===c-1&&a===h+1?c!==-1&&(h===0&&s?t.base=t.name=n.slice(1,c):t.base=t.name=n.slice(h,c)):(h===0&&s?(t.name=n.slice(1,a),t.base=n.slice(1,c)):(t.name=n.slice(h,a),t.base=n.slice(h,c)),t.ext=n.slice(a,c)),t.dir=this.dirname(n),t},sep:"/",delimiter:":"},warnings={};function deprecation(n,t,e=3){if(warnings[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${n}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`),console.warn(s))),warnings[t]=!0}let supported;function isWebGLSupported(){return typeof supported>"u"&&(supported=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:settings$1.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!settings$1.ADAPTER.getWebGLRenderingContext())return!1;const s=settings$1.ADAPTER.createCanvas();let r=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const a=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const h=r.getExtension("WEBGL_lose_context");h&&h.loseContext()}return r=null,a}catch{return!1}}()),supported}var aliceblue="#f0f8ff",antiquewhite="#faebd7",aqua="#00ffff",aquamarine="#7fffd4",azure="#f0ffff",beige="#f5f5dc",bisque="#ffe4c4",black="#000000",blanchedalmond="#ffebcd",blue="#0000ff",blueviolet="#8a2be2",brown="#a52a2a",burlywood="#deb887",cadetblue="#5f9ea0",chartreuse="#7fff00",chocolate="#d2691e",coral="#ff7f50",cornflowerblue="#6495ed",cornsilk="#fff8dc",crimson="#dc143c",cyan="#00ffff",darkblue="#00008b",darkcyan="#008b8b",darkgoldenrod="#b8860b",darkgray="#a9a9a9",darkgreen="#006400",darkgrey="#a9a9a9",darkkhaki="#bdb76b",darkmagenta="#8b008b",darkolivegreen="#556b2f",darkorange="#ff8c00",darkorchid="#9932cc",darkred="#8b0000",darksalmon="#e9967a",darkseagreen="#8fbc8f",darkslateblue="#483d8b",darkslategray="#2f4f4f",darkslategrey="#2f4f4f",darkturquoise="#00ced1",darkviolet="#9400d3",deeppink="#ff1493",deepskyblue="#00bfff",dimgray="#696969",dimgrey="#696969",dodgerblue="#1e90ff",firebrick="#b22222",floralwhite="#fffaf0",forestgreen="#228b22",fuchsia="#ff00ff",gainsboro="#dcdcdc",ghostwhite="#f8f8ff",goldenrod="#daa520",gold="#ffd700",gray="#808080",green="#008000",greenyellow="#adff2f",grey="#808080",honeydew="#f0fff0",hotpink="#ff69b4",indianred="#cd5c5c",indigo="#4b0082",ivory="#fffff0",khaki="#f0e68c",lavenderblush="#fff0f5",lavender="#e6e6fa",lawngreen="#7cfc00",lemonchiffon="#fffacd",lightblue="#add8e6",lightcoral="#f08080",lightcyan="#e0ffff",lightgoldenrodyellow="#fafad2",lightgray="#d3d3d3",lightgreen="#90ee90",lightgrey="#d3d3d3",lightpink="#ffb6c1",lightsalmon="#ffa07a",lightseagreen="#20b2aa",lightskyblue="#87cefa",lightslategray="#778899",lightslategrey="#778899",lightsteelblue="#b0c4de",lightyellow="#ffffe0",lime="#00ff00",limegreen="#32cd32",linen="#faf0e6",magenta="#ff00ff",maroon="#800000",mediumaquamarine="#66cdaa",mediumblue="#0000cd",mediumorchid="#ba55d3",mediumpurple="#9370db",mediumseagreen="#3cb371",mediumslateblue="#7b68ee",mediumspringgreen="#00fa9a",mediumturquoise="#48d1cc",mediumvioletred="#c71585",midnightblue="#191970",mintcream="#f5fffa",mistyrose="#ffe4e1",moccasin="#ffe4b5",navajowhite="#ffdead",navy="#000080",oldlace="#fdf5e6",olive="#808000",olivedrab="#6b8e23",orange="#ffa500",orangered="#ff4500",orchid="#da70d6",palegoldenrod="#eee8aa",palegreen="#98fb98",paleturquoise="#afeeee",palevioletred="#db7093",papayawhip="#ffefd5",peachpuff="#ffdab9",peru="#cd853f",pink="#ffc0cb",plum="#dda0dd",powderblue="#b0e0e6",purple="#800080",rebeccapurple="#663399",red="#ff0000",rosybrown="#bc8f8f",royalblue="#4169e1",saddlebrown="#8b4513",salmon="#fa8072",sandybrown="#f4a460",seagreen="#2e8b57",seashell="#fff5ee",sienna="#a0522d",silver="#c0c0c0",skyblue="#87ceeb",slateblue="#6a5acd",slategray="#708090",slategrey="#708090",snow="#fffafa",springgreen="#00ff7f",steelblue="#4682b4",tan="#d2b48c",teal="#008080",thistle="#d8bfd8",tomato="#ff6347",turquoise="#40e0d0",violet="#ee82ee",wheat="#f5deb3",white="#ffffff",whitesmoke="#f5f5f5",yellow="#ffff00",yellowgreen="#9acd32",cssColorNames={aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,goldenrod,gold,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavenderblush,lavender,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen};function hex2rgb(n,t=[]){return t[0]=(n>>16&255)/255,t[1]=(n>>8&255)/255,t[2]=(n&255)/255,t}function hex2string(n){let t=n.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function string2hex(n){if(typeof n=="string"&&(n=cssColorNames[n.toLowerCase()]||n,n[0]==="#"&&(n=n.slice(1)),n.length===3)){const[t,e,s]=n;n=t+t+e+e+s+s}return parseInt(n,16)}function rgb2hex(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function mapPremultipliedBlendModes(){const n=[],t=[];for(let s=0;s<32;s++)n[s]=s,t[s]=s;n[BLEND_MODES.NORMAL_NPM]=BLEND_MODES.NORMAL,n[BLEND_MODES.ADD_NPM]=BLEND_MODES.ADD,n[BLEND_MODES.SCREEN_NPM]=BLEND_MODES.SCREEN,t[BLEND_MODES.NORMAL]=BLEND_MODES.NORMAL_NPM,t[BLEND_MODES.ADD]=BLEND_MODES.ADD_NPM,t[BLEND_MODES.SCREEN]=BLEND_MODES.SCREEN_NPM;const e=[];return e.push(t),e.push(n),e}const premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(n,t){return premultiplyBlendMode[t?1:0][n]}function premultiplyRgba(n,t,e,s){return e=e||new Float32Array(4),s||s===void 0?(e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t):(e[0]=n[0],e[1]=n[1],e[2]=n[2]),e[3]=t,e}function premultiplyTint(n,t){if(t===1)return(t*255<<24)+n;if(t===0)return 0;let e=n>>16&255,s=n>>8&255,r=n&255;return e=e*t+.5|0,s=s*t+.5|0,r=r*t+.5|0,(t*255<<24)+(e<<16)+(s<<8)+r}function premultiplyTintToRgba(n,t,e,s){return e=e||new Float32Array(4),e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,(s||s===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function createIndicesForQuads(n,t=null){const e=n*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let s=0,r=0;s<e;s+=6,r+=4)t[s+0]=r+0,t[s+1]=r+1,t[s+2]=r+2,t[s+3]=r+0,t[s+4]=r+2,t[s+5]=r+3;return t}function getBufferType(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function nextPow2(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function isPow2(n){return!(n&n-1)&&!!n}function log2(n){let t=(n>65535?1:0)<<4;n>>>=t;let e=(n>255?1:0)<<3;return n>>>=e,t|=e,e=(n>15?1:0)<<2,n>>>=e,t|=e,e=(n>3?1:0)<<1,n>>>=e,t|=e,t|n>>1}function removeItems(n,t,e){const s=n.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const a=s-e;for(r=t;r<a;++r)n[r]=n[r+e];n.length=a}function sign(n){return n===0?0:n<0?-1:1}let nextUid=0;function uid(){return++nextUid}const _BoundingBox=class{constructor(n,t,e,s){this.left=n,this.top=t,this.right=e,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let BoundingBox=_BoundingBox;BoundingBox.EMPTY=new _BoundingBox(0,0,0,0);const ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);class CanvasRenderTarget{constructor(t,e,s){this._canvas=settings$1.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||settings$1.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function checkRow(n,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(n[r+3]!==0)return!1;return!0}function checkColumn(n,t,e,s,r){const a=4*t;for(let h=s,c=s*a+4*e;h<=r;++h,c+=a)if(n[c+3]!==0)return!1;return!0}function getCanvasBoundingBox(n){const{width:t,height:e}=n,s=n.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const a=s.getImageData(0,0,t,e).data;let h=0,c=0,o=t-1,u=e-1;for(;c<e&&checkRow(a,t,c);)++c;if(c===e)return BoundingBox.EMPTY;for(;checkRow(a,t,u);)--u;for(;checkColumn(a,t,h,c,u);)++h;for(;checkColumn(a,t,o,c,u);)--o;return++o,++u,new BoundingBox(h,c,o,u)}function trimCanvas(n){const t=getCanvasBoundingBox(n),{width:e,height:s}=t;let r=null;if(!t.isEmpty()){const a=n.getContext("2d");if(a===null)throw new TypeError("Failed to get canvas 2D context");r=a.getImageData(t.left,t.top,e,s)}return{width:e,height:s,data:r}}let tempAnchor;function determineCrossOrigin(n,t=globalThis.location){if(n.startsWith("data:"))return"";t=t||globalThis.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=n;const e=url.parse(tempAnchor.href),s=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!s||e.protocol!==t.protocol?"anonymous":""}function getResolutionOfUrl(n,t=1){var s;const e=(s=settings$1.RETINA_PREFIX)==null?void 0:s.exec(n);return e?parseFloat(e[1]):t}var ExtensionType=(n=>(n.Renderer="renderer",n.Application="application",n.RendererSystem="renderer-webgl-system",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererSystem="renderer-canvas-system",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n))(ExtensionType||{});const normalizeExtension=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},normalizePriority=(n,t)=>normalizeExtension(n).priority??t,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(normalizeExtension).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...n){return n.map(normalizeExtension).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(n,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[n]||r[n])throw new Error(`Extension type ${n} already has a handler`);s[n]=t,r[n]=e;const a=this._queue;return a[n]&&(a[n].forEach(h=>t(h)),delete a[n]),this},handleByMap(n,t){return this.handle(n,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(n,t,e=-1){return this.handle(n,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,a)=>normalizePriority(a,e)-normalizePriority(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};class ViewableBuffer{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const fragTemplate$1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(n){let t="";for(let e=0;e<n;++e)e>0&&(t+=`
else `),e<n-1&&(t+=`if(test == ${e}.0){}`);return t}function checkMaxIfStatementsInShader(n,t){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=fragTemplate$1.replace(/%forloop%/gi,generateIfTestSrc(n));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))n=n/2|0;else break}return n}const BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5;let State$1=class{constructor(){this.data=0,this.blendMode=BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(t){!!(this.data&1<<BLEND$1)!==t&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$1)}set offsets(t){!!(this.data&1<<OFFSET$1)!==t&&(this.data^=1<<OFFSET$1)}get culling(){return!!(this.data&1<<CULLING$1)}set culling(t){!!(this.data&1<<CULLING$1)!==t&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(t){!!(this.data&1<<DEPTH_TEST$1)!==t&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(t){!!(this.data&1<<DEPTH_MASK$1)!==t&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(t){!!(this.data&1<<WINDING$1)!==t&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==BLEND_MODES.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new State$1;return t.depthTest=!1,t.blend=!0,t}};const INSTALLED=[];function autoDetectResource(n,t){if(!n)return null;let e="";if(typeof n=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);s&&(e=s[1].toLowerCase())}for(let s=INSTALLED.length-1;s>=0;--s){const r=INSTALLED[s];if(r.test&&r.test(n,e))return new r(n,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Runner{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,s,r,a,h,c,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let m=0,p=d.length;m<p;m++)d[m][u](t,e,s,r,a,h,c,o);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}});class Resource{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class BufferResource extends Resource{constructor(t,e){const{width:s,height:r}=e||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=t}upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ALPHA_MODES.UNPACK);const a=e.realWidth,h=e.realHeight;return s.width===a&&s.height===h?r.texSubImage2D(e.target,0,0,0,a,h,e.format,s.type,this.data):(s.width=a,s.height=h,r.texImage2D(e.target,0,s.internalFormat,a,h,0,e.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const defaultBufferOptions={scaleMode:SCALE_MODES.NEAREST,format:FORMATS.RGBA,alphaMode:ALPHA_MODES.NPM},_BaseTexture=class extends eventemitter3Exports{constructor(n=null,t=null){super(),t=Object.assign({},_BaseTexture.defaultOptions,t);const{alphaMode:e,mipmap:s,anisotropicLevel:r,scaleMode:a,width:h,height:c,wrapMode:o,format:u,type:d,target:m,resolution:p,resourceOptions:g}=t;n&&!(n instanceof Resource)&&(n=autoDetectResource(n,g),n.internal=!0),this.resolution=p||settings$1.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=o,this._scaleMode=a,this.format=u,this.type=d,this.target=m,this.alphaMode=e,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(n)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(n){this._mipmap!==n&&(this._mipmap=n,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(n){this._scaleMode!==n&&(this._scaleMode=n,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(n){this._wrapMode!==n&&(this._wrapMode=n,this.dirtyStyleId++)}setStyle(n,t){let e;return n!==void 0&&n!==this.scaleMode&&(this.scaleMode=n,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(n,t,e){return e=e||this.resolution,this.setRealSize(n*e,t*e,e)}setRealSize(n,t,e){return this.resolution=e||this.resolution,this.width=Math.round(n)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(n){const t=this.resolution;return t===n?this:(this.resolution=n,this.valid&&(this.width=Math.round(this.width*t)/n,this.height=Math.round(this.height*t)/n,this.emit("update",this)),this._refreshPOT(),this)}setResource(n){if(this.resource===n)return this;if(this.resource)throw new Error("Resource can be set only once");return n.bind(this),this.resource=n,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(n){this.emit("error",this,n)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.dispose(),_BaseTexture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(n,t,e=settings$1.STRICT_TEXTURE_CACHE){const s=typeof n=="string";let r=null;if(s)r=n;else{if(!n._pixiId){const h=(t==null?void 0:t.pixiIdPrefix)||"pixiid";n._pixiId=`${h}_${uid()}`}r=n._pixiId}let a=BaseTextureCache[r];if(s&&e&&!a)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return a||(a=new _BaseTexture(n,t),a.cacheId=r,_BaseTexture.addToCache(a,r)),a}static fromBuffer(n,t,e,s){n=n||new Float32Array(t*e*4);const r=new BufferResource(n,{width:t,height:e}),a=n instanceof Float32Array?TYPES.FLOAT:TYPES.UNSIGNED_BYTE;return new _BaseTexture(r,Object.assign({},defaultBufferOptions,s||{width:t,height:e,type:a}))}static addToCache(n,t){t&&(n.textureCacheIds.includes(t)||n.textureCacheIds.push(t),BaseTextureCache[t]&&BaseTextureCache[t]!==n&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),BaseTextureCache[t]=n)}static removeFromCache(n){if(typeof n=="string"){const t=BaseTextureCache[n];if(t){const e=t.textureCacheIds.indexOf(n);return e>-1&&t.textureCacheIds.splice(e,1),delete BaseTextureCache[n],t}}else if(n!=null&&n.textureCacheIds){for(let t=0;t<n.textureCacheIds.length;++t)delete BaseTextureCache[n.textureCacheIds[t]];return n.textureCacheIds.length=0,n}return null}};let BaseTexture=_BaseTexture;BaseTexture.defaultOptions={mipmap:MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:SCALE_MODES.LINEAR,wrapMode:WRAP_MODES.CLAMP,alphaMode:ALPHA_MODES.UNPACK,target:TARGETS.TEXTURE_2D,format:FORMATS.RGBA,type:TYPES.UNSIGNED_BYTE};BaseTexture._globalBatch=0;class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UID$4=0;class Buffer{constructor(t,e=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=UID$4++,this.disposeRunner=new Runner("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Buffer(t)}}class Attribute{constructor(t,e=0,s=!1,r=TYPES.FLOAT,a,h,c,o=1){this.buffer=t,this.size=e,this.normalized=s,this.type=r,this.stride=a,this.start=h,this.instance=c,this.divisor=o}destroy(){this.buffer=null}static from(t,e,s,r,a){return new Attribute(t,e,s,r,a)}}const map$1={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(n,t){let e=0,s=0;const r={};for(let o=0;o<n.length;o++)s+=t[o],e+=n[o].length;const a=new ArrayBuffer(e*4);let h=null,c=0;for(let o=0;o<n.length;o++){const u=t[o],d=n[o],m=getBufferType(d);r[m]||(r[m]=new map$1[m](a)),h=r[m];for(let p=0;p<d.length;p++){const g=(p/u|0)*s+c,_=p%u;h[g+_]=d[p]}c+=u}return new Float32Array(a)}const byteSizeMap$1={5126:4,5123:2,5121:1};let UID$3=0;const map={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Geometry{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=UID$3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}addAttribute(t,e,s=0,r=!1,a,h,c,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Buffer||(e instanceof Array&&(e=new Float32Array(e)),e=new Buffer(e));const u=t.split("|");if(u.length>1){for(let m=0;m<u.length;m++)this.addAttribute(u[m],e,s,r,a);return this}let d=this.buffers.indexOf(e);return d===-1&&(this.buffers.push(e),d=this.buffers.length-1),this.attributes[t]=new Attribute(d,s,r,a,h,c,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Buffer||(t instanceof Array&&(t=new Uint16Array(t)),t=new Buffer(t)),t.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],s=new Buffer;let r;for(r in this.attributes){const a=this.attributes[r],h=this.buffers[a.buffer];t.push(h.data),e.push(a.size*byteSizeMap$1[a.type]/4),a.buffer=0}for(s.data=interleaveTypedArrays(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Geometry;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Buffer(this.buffers[e].data.slice(0));for(const e in this.attributes){const s=this.attributes[e];t.attributes[e]=new Attribute(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Geometry,s=[],r=[],a=[];let h;for(let c=0;c<t.length;c++){h=t[c];for(let o=0;o<h.buffers.length;o++)r[o]=r[o]||0,r[o]+=h.buffers[o].data.length,a[o]=0}for(let c=0;c<h.buffers.length;c++)s[c]=new map[getBufferType(h.buffers[c].data)](r[c]),e.buffers[c]=new Buffer(s[c]);for(let c=0;c<t.length;c++){h=t[c];for(let o=0;o<h.buffers.length;o++)s[o].set(h.buffers[o].data,a[o]),a[o]+=h.buffers[o].data.length}if(e.attributes=h.attributes,h.indexBuffer){e.indexBuffer=e.buffers[h.buffers.indexOf(h.indexBuffer)],e.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let c=0,o=0,u=0,d=0;for(let m=0;m<h.buffers.length;m++)if(h.buffers[m]!==h.indexBuffer){d=m;break}for(const m in h.attributes){const p=h.attributes[m];(p.buffer|0)===d&&(o+=p.size*byteSizeMap$1[p.type]/4)}for(let m=0;m<t.length;m++){const p=t[m].indexBuffer.data;for(let g=0;g<p.length;g++)e.indexBuffer.data[g+u]+=c;c+=t[m].buffers[d].data.length/o,u+=p.length}}return e}}class BatchGeometry extends Geometry{constructor(t=!1){super(),this._buffer=new Buffer(null,t,!1),this._indexBuffer=new Buffer(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,TYPES.FLOAT).addIndex(this._indexBuffer)}}const PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;var SHAPES=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC",n))(SHAPES||{});class Point{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Point(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const tempPoints$1=[new Point,new Point,new Point,new Point];class Rectangle{constructor(t=0,e=0,s=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r),this.type=SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const ft=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=ft)return!1;const xt=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>xt}const s=this.left,r=this.right,a=this.top,h=this.bottom;if(r<=s||h<=a)return!1;const c=tempPoints$1[0].set(t.left,t.top),o=tempPoints$1[1].set(t.left,t.bottom),u=tempPoints$1[2].set(t.right,t.top),d=tempPoints$1[3].set(t.right,t.bottom);if(u.x<=c.x||o.y<=c.y)return!1;const m=Math.sign(e.a*e.d-e.b*e.c);if(m===0||(e.apply(c,c),e.apply(o,o),e.apply(u,u),e.apply(d,d),Math.max(c.x,o.x,u.x,d.x)<=s||Math.min(c.x,o.x,u.x,d.x)>=r||Math.max(c.y,o.y,u.y,d.y)<=a||Math.min(c.y,o.y,u.y,d.y)>=h))return!1;const p=m*(o.y-c.y),g=m*(c.x-o.x),_=p*s+g*a,y=p*r+g*a,v=p*s+g*h,U=p*r+g*h;if(Math.max(_,y,v,U)<=p*c.x+g*c.y||Math.min(_,y,v,U)>=p*d.x+g*d.y)return!1;const w=m*(c.y-u.y),k=m*(u.x-c.x),N=w*s+k*a,W=w*r+k*a,et=w*s+k*h,it=w*r+k*h;return!(Math.max(N,W,et,it)<=w*c.x+k*c.y||Math.min(N,W,et,it)>=w*d.x+k*d.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),a=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(a-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),a=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=a-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Circle{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.radius=s,this.type=SHAPES.CIRC}clone(){return new Circle(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,a=this.y-e;return r*=r,a*=a,r+a<=s}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ellipse{constructor(t=0,e=0,s=0,r=0){this.x=t,this.y=e,this.width=s,this.height=r,this.type=SHAPES.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,r=(e-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Polygon{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,a=e.length;r<a;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.type=SHAPES.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Polygon(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let a=0,h=r-1;a<r;h=a++){const c=this.points[a*2],o=this.points[a*2+1],u=this.points[h*2],d=this.points[h*2+1];o>e!=d>e&&t<(u-c)*((e-o)/(d-o))+c&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class RoundedRectangle{constructor(t=0,e=0,s=0,r=0,a=20){this.x=t,this.y=e,this.width=s,this.height=r,this.radius=a,this.type=SHAPES.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),a=e-(this.y+s);const h=s*s;if(r*r+a*a<=h||(r=t-(this.x+this.width-s),r*r+a*a<=h)||(a=e-(this.y+this.height-s),r*r+a*a<=h)||(r=t-(this.x+s),r*r+a*a<=h))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Matrix{constructor(t=1,e=0,s=0,r=1,a=0,h=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=a,this.ty=h}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,a,h){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=a,this.ty=h,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new Point;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Point;const s=1/(this.a*this.d+this.c*-this.b),r=t.x,a=t.y;return e.x=this.d*s*r+-this.c*s*a+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*a+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,a=this.c,h=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=a*e-this.d*s,this.d=a*s+this.d*e,this.tx=h*e-this.ty*s,this.ty=h*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,a=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*a,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*a,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*a+this.ty,this}setTransform(t,e,s,r,a,h,c,o,u){return this.a=Math.cos(c+u)*a,this.b=Math.sin(c+u)*a,this.c=-Math.sin(c-o)*h,this.d=Math.cos(c-o)*h,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,a=this.d,h=t.pivot,c=-Math.atan2(-r,a),o=Math.atan2(s,e),u=Math.abs(c+o);return u<1e-5||Math.abs(PI_2-u)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=c,t.skew.y=o),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+a*a),t.position.x=this.tx+(h.x*e+h.y*r),t.position.y=this.ty+(h.x*s+h.y*a),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,a=this.tx,h=t*r-e*s;return this.a=r/h,this.b=-e/h,this.c=-s/h,this.d=t/h,this.tx=(s*this.ty-r*a)/h,this.ty=-(t*this.ty-e*a)/h,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Matrix;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}}const ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init$1(){for(let n=0;n<16;n++){const t=[];rotationCayley.push(t);for(let e=0;e<16;e++){const s=signum(ux[n]*ux[e]+vx[n]*uy[e]),r=signum(uy[n]*ux[e]+vy[n]*uy[e]),a=signum(ux[n]*vx[e]+vx[n]*vy[e]),h=signum(uy[n]*vx[e]+vy[n]*vy[e]);for(let c=0;c<16;c++)if(ux[c]===s&&uy[c]===r&&vx[c]===a&&vy[c]===h){t.push(c);break}}}for(let n=0;n<16;n++){const t=new Matrix;t.set(ux[n],uy[n],vx[n],vy[n],0,0),rotationMatrices.push(t)}}init$1();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>ux[n],uY:n=>uy[n],vX:n=>vx[n],vY:n=>vy[n],inv:n=>n&8?n&15:-n&7,add:(n,t)=>rotationCayley[n][t],sub:(n,t)=>rotationCayley[n][groupD8.inv(t)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,t)=>Math.abs(n)*2<=Math.abs(t)?t>=0?groupD8.S:groupD8.N:Math.abs(t)*2<=Math.abs(n)?n>0?groupD8.E:groupD8.W:t>0?n>0?groupD8.SE:groupD8.SW:n>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(n,t,e=0,s=0)=>{const r=rotationMatrices[groupD8.inv(t)];r.tx=e,r.ty=s,n.append(r)}};class ObservablePoint{constructor(t,e,s=0,r=0){this._x=s,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new ObservablePoint(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const _Transform=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(n){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){const e=n.worldTransform,s=this.worldTransform;s.a=t.a*e.a+t.b*e.c,s.b=t.a*e.b+t.b*e.d,s.c=t.c*e.a+t.d*e.c,s.d=t.c*e.b+t.d*e.d,s.tx=t.tx*e.a+t.ty*e.c+e.tx,s.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=n._worldID,this._worldID++}}setFromMatrix(n){n.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())}};let Transform=_Transform;Transform.IDENTITY=new _Transform;var defaultFragment$2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,defaultVertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function compileShader(n,t,e){const s=n.createShader(t);return n.shaderSource(s,e),n.compileShader(s),s}function booleanArray(n){const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=!1;return t}function defaultValue(n,t){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray(2*t);case"bvec3":return booleanArray(3*t);case"bvec4":return booleanArray(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const uniformParsers=[{test:n=>n.type==="float"&&n.size===1&&!n.isArray,code:n=>`
            if(uv["${n}"] !== ud["${n}"].value)
            {
                ud["${n}"].value = uv["${n}"]
                gl.uniform1f(ud["${n}"].location, uv["${n}"])
            }
            `},{test:(n,t)=>(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(t==null||t.castToBaseTexture!==void 0),code:n=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${n}"], t);

            if(ud["${n}"].value !== t)
            {
                ud["${n}"].value = t;
                gl.uniform1i(ud["${n}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(n,t)=>n.type==="mat3"&&n.size===1&&!n.isArray&&t.a!==void 0,code:n=>`
            gl.uniformMatrix3fv(ud["${n}"].location, false, uv["${n}"].toArray(true));
            `,codeUbo:n=>`
                var ${n}_matrix = uv.${n}.toArray(true);

                data[offset] = ${n}_matrix[0];
                data[offset+1] = ${n}_matrix[1];
                data[offset+2] = ${n}_matrix[2];
        
                data[offset + 4] = ${n}_matrix[3];
                data[offset + 5] = ${n}_matrix[4];
                data[offset + 6] = ${n}_matrix[5];
        
                data[offset + 8] = ${n}_matrix[6];
                data[offset + 9] = ${n}_matrix[7];
                data[offset + 10] = ${n}_matrix[8];
            `},{test:(n,t)=>n.type==="vec2"&&n.size===1&&!n.isArray&&t.x!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${n}"].location, v.x, v.y);
                }`,codeUbo:n=>`
                v = uv.${n};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:n=>n.type==="vec2"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${n}"].location, v[0], v[1]);
                }
            `},{test:(n,t)=>n.type==="vec4"&&n.size===1&&!n.isArray&&t.width!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${n}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:n=>n.type==="vec4"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${n}"].location, v[0], v[1], v[2], v[3])
                }`}],GLSL_TO_SINGLE_SETTERS_CACHED={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(n,t){var s;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in n.uniforms){const a=t[r];if(!a){(s=n.uniforms[r])!=null&&s.group&&(n.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const h=n.uniforms[r];let c=!1;for(let o=0;o<uniformParsers.length;o++)if(uniformParsers[o].test(a,h)){e.push(uniformParsers[o].code(r,h)),c=!0;break}if(!c){const u=(a.size===1&&!a.isArray?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[a.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${u};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const unknownContext={};let context=unknownContext;function getTestContext(){if(context===unknownContext||context!=null&&context.isContextLost()){const n=settings$1.ADAPTER.createCanvas();let t;settings$1.PREFER_ENV>=ENV.WEBGL2&&(t=n.getContext("webgl2",{})),t||(t=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),context=t}return context}let maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=PRECISION.MEDIUM;const n=getTestContext();n&&n.getShaderPrecisionFormat&&(maxFragmentPrecision=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?PRECISION.HIGH:PRECISION.MEDIUM)}return maxFragmentPrecision}function logPrettyShaderError(n,t){const e=n.getShaderSource(t).split(`
`).map((u,d)=>`${d}: ${u}`),s=n.getShaderInfoLog(t),r=s.split(`
`),a={},h=r.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!a[u]?(a[u]=!0,!0):!1),c=[""];h.forEach(u=>{e[u-1]=`%c${e[u-1]}%c`,c.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const o=e.join(`
`);c[0]=o,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...c),console.groupEnd()}function logProgramError(n,t,e,s){n.getProgramParameter(t,n.LINK_STATUS)||(n.getShaderParameter(e,n.COMPILE_STATUS)||logPrettyShaderError(n,e),n.getShaderParameter(s,n.COMPILE_STATUS)||logPrettyShaderError(n,s),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(t)))}const GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(n){return GLSL_TO_SIZE[n]}let GL_TABLE=null;const GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(n,t){if(!GL_TABLE){const e=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let s=0;s<e.length;++s){const r=e[s];GL_TABLE[n[r]]=GL_TO_GLSL_TYPES[r]}}return GL_TABLE[t]}function setPrecision(n,t,e){if(n.substring(0,9)!=="precision"){let s=t;return t===PRECISION.HIGH&&e!==PRECISION.HIGH&&(s=PRECISION.MEDIUM),`precision ${s} float;
${n}`}else if(e!==PRECISION.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}let UID$2=0;const nameCache={},_Program=class{constructor(n,t,e="pixi-shader",s={}){this.extra={},this.id=UID$2++,this.vertexSrc=n||_Program.defaultVertexSrc,this.fragmentSrc=t||_Program.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),nameCache[e]?(nameCache[e]++,e+=`-${nameCache[e]}`):nameCache[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=setPrecision(this.vertexSrc,_Program.defaultVertexPrecision,PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,_Program.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return defaultVertex$3}static get defaultFragmentSrc(){return defaultFragment$2}static from(n,t,e){const s=n+t;let r=ProgramCache[s];return r||(ProgramCache[s]=r=new _Program(n,t,e)),r}};let Program=_Program;Program.defaultVertexPrecision=PRECISION.HIGH;Program.defaultFragmentPrecision=isMobile.apple.device?PRECISION.HIGH:PRECISION.MEDIUM;let UID$1=0;class UniformGroup{constructor(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$1++,this.static=!!e,this.ubo=!!s,t instanceof Buffer?(this.buffer=t,this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Buffer(new Float32Array(1)),this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,s){if(!this.ubo)this.uniforms[t]=new UniformGroup(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,s){return new UniformGroup(t,e,s)}static uboFrom(t,e){return new UniformGroup(t,e??!0,!0)}}class Shader{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof UniformGroup?this.uniformGroup=e:this.uniformGroup=new UniformGroup(e):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const s in e.uniforms){const r=e.uniforms[s];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,s){const r=Program.from(t,e);return new Shader(r,s)}}class BatchShaderGenerator{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let a=0;a<t;a++)s[a]=a;this.defaultGroupCache[t]=UniformGroup.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Program(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[t]};return new Shader(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+=`if(vTextureId < ${s}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function canUploadSameBuffer(){return!isMobile.apple.device}function maxRecommendedTextures(n){let t=!0;const e=settings$1.ADAPTER.getNavigator();if(isMobile.tablet||isMobile.phone){if(isMobile.apple.device){const s=e.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(isMobile.android.device){const s=e.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?n:4}class ObjectRenderer{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var defaultFragment$1=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,defaultVertex$2=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const _BatchRenderer=class extends ObjectRenderer{constructor(n){super(n),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State$1.for2d(),this.size=_BatchRenderer.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),n.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(n){this._defaultMaxTextures=n}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(n){this._canUploadSameBuffer=n}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return defaultVertex$2}static get defaultFragmentTemplate(){return defaultFragment$1}setShaderGenerator({vertex:n=_BatchRenderer.defaultVertexSrc,fragment:t=_BatchRenderer.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(n,t)}contextChange(){const n=this.renderer.gl;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),_BatchRenderer.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,n)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:n,_textureArrayPool:t}=_BatchRenderer,e=this.size/4,s=Math.floor(e/this.maxTextures)+1;for(;n.length<e;)n.push(new BatchDrawCall);for(;t.length<s;)t.push(new BatchTextureArray);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(n){n._texture.valid&&(this._vertexCount+n.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=n.vertexData.length/2,this._indexCount+=n.indices.length,this._bufferedTextures[this._bufferSize]=n._texture.baseTexture,this._bufferedElements[this._bufferSize++]=n)}buildTexturesAndDrawCalls(){const{_bufferedTextures:n,maxTextures:t}=this,e=_BatchRenderer._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,a=this.renderer.textureGC.count;let h=++BaseTexture._globalBatch,c=0,o=e[0],u=0;s.copyBoundTextures(r,t);for(let d=0;d<this._bufferSize;++d){const m=n[d];n[d]=null,m._batchEnabled!==h&&(o.count>=t&&(s.boundArray(o,r,h,t),this.buildDrawCalls(o,u,d),u=d,o=e[++c],++h),m._batchEnabled=h,m.touched=a,o.elements[o.count++]=m)}o.count>0&&(s.boundArray(o,r,h,t),this.buildDrawCalls(o,u,this._bufferSize),++c,++h);for(let d=0;d<r.length;d++)r[d]=null;BaseTexture._globalBatch=h}buildDrawCalls(n,t,e){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:a,vertexSize:h}=this,c=_BatchRenderer._drawCallPool;let o=this._dcIndex,u=this._aIndex,d=this._iIndex,m=c[o];m.start=this._iIndex,m.texArray=n;for(let p=t;p<e;++p){const g=s[p],_=g._texture.baseTexture,y=premultiplyBlendMode[_.alphaMode?1:0][g.blendMode];s[p]=null,t<p&&m.blend!==y&&(m.size=d-m.start,t=p,m=c[++o],m.texArray=n,m.start=d),this.packInterleavedGeometry(g,r,a,u,d),u+=g.vertexData.length/2*h,d+=g.indices.length,m.blend=y}t<e&&(m.size=d-m.start,++o),this._dcIndex=o,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(n){const t=this.renderer.texture;for(let e=0;e<n.count;e++)t.bind(n.elements[e],n.ids[e]),n.elements[e]=null;n.count=0}updateGeometry(){const{_packedGeometries:n,_attributeBuffer:t,_indexBuffer:e}=this;_BatchRenderer.canUploadSameBuffer?(n[this._flushId]._buffer.update(t.rawBinaryData),n[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,n[this._flushId]=new this.geometryClass),n[this._flushId]._buffer.update(t.rawBinaryData),n[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(n[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const n=this._dcIndex,{gl:t,state:e}=this.renderer,s=_BatchRenderer._drawCallPool;let r=null;for(let a=0;a<n;a++){const{texArray:h,type:c,size:o,start:u,blend:d}=s[a];r!==h&&(r=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,e.set(this.state),t.drawElements(c,o,t.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),_BatchRenderer.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]&&this._packedGeometries[n].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(n){const t=nextPow2(Math.ceil(n/8)),e=log2(t),s=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new ViewableBuffer(s*this.vertexSize*4)),r}getIndexBuffer(n){const t=nextPow2(Math.ceil(n/12)),e=log2(t),s=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(s)),r}packInterleavedGeometry(n,t,e,s,r){const{uint32View:a,float32View:h}=t,c=s/this.vertexSize,o=n.uvs,u=n.indices,d=n.vertexData,m=n._texture.baseTexture._batchLocation,p=Math.min(n.worldAlpha,1),g=p<1&&n._texture.baseTexture.alphaMode?premultiplyTint(n._tintRGB,p):n._tintRGB+(p*255<<24);for(let _=0;_<d.length;_+=2)h[s++]=d[_],h[s++]=d[_+1],h[s++]=o[_],h[s++]=o[_+1],a[s++]=g,h[s++]=m;for(let _=0;_<u.length;_++)e[r++]=c+u[_]}};let BatchRenderer=_BatchRenderer;BatchRenderer.defaultBatchSize=4096;BatchRenderer.extension={name:"batch",type:ExtensionType.RendererPlugin};BatchRenderer._drawCallPool=[];BatchRenderer._textureArrayPool=[];extensions$1.add(BatchRenderer);var defaultFragment=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,defaultVertex$1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const _Filter=class extends Shader{constructor(n,t,e){const s=Program.from(n||_Filter.defaultVertexSrc,t||_Filter.defaultFragmentSrc);super(s,e),this.padding=0,this.resolution=_Filter.defaultResolution,this.multisample=_Filter.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State$1}apply(n,t,e,s,r){n.applyFilter(this,t,e,s)}get blendMode(){return this.state.blendMode}set blendMode(n){this.state.blendMode=n}get resolution(){return this._resolution}set resolution(n){this._resolution=n}static get defaultVertexSrc(){return defaultVertex$1}static get defaultFragmentSrc(){return defaultFragment}};let Filter=_Filter;Filter.defaultResolution=1;Filter.defaultMultisample=MSAA_QUALITY.NONE;class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?string2hex(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=hex2string(t),hex2rgb(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}BackgroundSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"background"};extensions$1.add(BackgroundSystem);class BatchSystem{constructor(t){this.renderer=t,this.emptyRenderer=new ObjectRenderer(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:s}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=s[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,s,r){const{elements:a,ids:h,count:c}=t;let o=0;for(let u=0;u<c;u++){const d=a[u],m=d._batchLocation;if(m>=0&&m<r&&e[m]===d){h[u]=m;continue}for(;o<r;){const p=e[o];if(p&&p._batchEnabled===s&&p._batchLocation===o){o++;continue}h[u]=o,d._batchLocation=o,e[o]=d;break}}}destroy(){this.renderer=null}}BatchSystem.extension={type:ExtensionType.RendererSystem,name:"batch"};extensions$1.add(BatchSystem);let CONTEXT_UID_COUNTER=0;class ContextSystem{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let s;if(settings$1.PREFER_ENV>=ENV.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ContextSystem.extension={type:ExtensionType.RendererSystem,name:"context"};extensions$1.add(ContextSystem);class DepthResource extends BufferResource{upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ALPHA_MODES.UNPACK);const a=e.realWidth,h=e.realHeight;return s.width===a&&s.height===h?r.texSubImage2D(e.target,0,0,0,a,h,e.format,s.type,this.data):(s.width=a,s.height=h,r.texImage2D(e.target,0,s.internalFormat,a,h,0,e.format,s.type,this.data)),!0}}class Framebuffer{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,mipmap:MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new BaseTexture(new DepthResource(null,{width:this.width,height:this.height}),{scaleMode:SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES.OFF,format:FORMATS.DEPTH_COMPONENT,type:TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],a=r.resolution;r.setSize(t/a,e/a)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class BaseRenderTexture extends BaseTexture{constructor(t={}){if(typeof t=="number"){const e=arguments[0],s=arguments[1],r=arguments[2],a=arguments[3];t={width:e,height:s,scaleMode:r,resolution:a}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=MSAA_QUALITY.NONE),super(null,t),this.mipmap=MIPMAP_MODES.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class BaseImageResource extends Resource{constructor(t){const e=t,s=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(s,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=determineCrossOrigin(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,e,s,r){const a=t.gl,h=e.realWidth,c=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ALPHA_MODES.UNPACK),!this.noSubImage&&e.target===a.TEXTURE_2D&&s.width===h&&s.height===c?a.texSubImage2D(a.TEXTURE_2D,0,0,0,e.format,s.type,r):(s.width=h,s.height=c,a.texImage2D(e.target,0,s.internalFormat,e.format,s.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(e,s),super.update()}dispose(){this.source=null}}class ImageResource extends BaseImageResource{constructor(t,e){if(e=e||{},typeof t=="string"){const s=new Image;BaseImageResource.crossOrigin(s,t,e.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??settings$1.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,s)=>{const r=this.source;this.url=r.src;const a=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?a():(r.onload=a,r.onerror=h=>{s(h),this.onError.emit(h)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,s){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,s,this.bitmap),!this.preserveBitmap){let r=!0;const a=e._glTextures;for(const h in a){const c=a[h];if(c!==s&&c.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const r=e.width,a=e.height;if(s){const h=t.width/2/r,c=t.height/2/a,o=t.x/r+h,u=t.y/a+c;s=groupD8.add(s,groupD8.NW),this.x0=o+h*groupD8.uX(s),this.y0=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x1=o+h*groupD8.uX(s),this.y1=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x2=o+h*groupD8.uX(s),this.y2=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x3=o+h*groupD8.uX(s),this.y3=u+c*groupD8.uY(s)}else this.x0=t.x/r,this.y0=t.y/a,this.x1=(t.x+t.width)/r,this.y1=t.y/a,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/a,this.x3=t.x/r,this.y3=(t.y+t.height)/a;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const DEFAULT_UVS=new TextureUvs;function removeAllHandlers(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}class Texture extends eventemitter3Exports{constructor(t,e,s,r,a,h){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Rectangle(0,0,1,1)),t instanceof Texture&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=DEFAULT_UVS,this.uvMatrix=null,this.orig=s||e,this._rotate=Number(a||0),a===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=h?new Point(h.x,h.y):new Point(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&TextureCache[e.url]&&Texture.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),s=new Texture(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},s=settings$1.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let a=null;if(r)a=t;else if(t instanceof BaseTexture){if(!t.cacheId){const c=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${c}-${uid()}`,BaseTexture.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){const c=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${c}_${uid()}`}a=t._pixiId}let h=TextureCache[a];if(r&&s&&!h)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return!h&&!(t instanceof BaseTexture)?(e.resolution||(e.resolution=getResolutionOfUrl(t)),h=new Texture(new BaseTexture(t,e)),h.baseTexture.cacheId=a,BaseTexture.addToCache(h.baseTexture,a),Texture.addToCache(h,a)):!h&&t instanceof BaseTexture&&(h=new Texture(t),Texture.addToCache(h,a)),h}static fromURL(t,e){const s=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=Texture.from(t,Object.assign({resourceOptions:s},e),!1),a=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):a.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,s,r){return new Texture(BaseTexture.fromBuffer(t,e,s,r))}static fromLoader(t,e,s,r){const a=new BaseTexture(t,Object.assign({scaleMode:BaseTexture.defaultOptions.scaleMode,resolution:getResolutionOfUrl(e)},r)),{resource:h}=a;h instanceof ImageResource&&(h.url=e);const c=new Texture(a);return s||(s=e),BaseTexture.addToCache(c.baseTexture,s),Texture.addToCache(c,s),s!==e&&(BaseTexture.addToCache(c.baseTexture,e),Texture.addToCache(c,e)),c.baseTexture.valid?Promise.resolve(c):new Promise(o=>{c.baseTexture.once("loaded",()=>o(c))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),TextureCache[e]&&TextureCache[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),TextureCache[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=TextureCache[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete TextureCache[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)TextureCache[t.textureCacheIds[e]]===t&&delete TextureCache[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:s,width:r,height:a}=t,h=e+r>this.baseTexture.width,c=s+a>this.baseTexture.height;if(h||c){const o=h&&c?"and":"or",u=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,d=`Y: ${s} + ${a} = ${s+a} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${o} ${d}`)}this.valid=r&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Texture._EMPTY||(Texture._EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture._EMPTY),removeAllHandlers(Texture._EMPTY.baseTexture)),Texture._EMPTY}static get WHITE(){if(!Texture._WHITE){const t=settings$1.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),Texture._WHITE=new Texture(BaseTexture.from(t)),removeAllHandlers(Texture._WHITE),removeAllHandlers(Texture._WHITE.baseTexture)}return Texture._WHITE}}class RenderTexture extends Texture{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,s=!0){const r=this.baseTexture.resolution,a=Math.round(t*r)/r,h=Math.round(e*r)/r;this.valid=a>0&&h>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=h,s&&this.baseTexture.resize(a,h),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new RenderTexture(new BaseRenderTexture(t))}}class RenderTexturePool{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,s=MSAA_QUALITY.NONE){const r=new BaseRenderTexture(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new RenderTexture(r)}getOptimalTexture(t,e,s=1,r=MSAA_QUALITY.NONE){let a;t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=nextPow2(t),e=nextPow2(e),a=((t&65535)<<16|e&65535)>>>0,r>1&&(a+=r*4294967296)):a=r>1?-r:-1,this.texturePool[a]||(this.texturePool[a]=[]);let h=this.texturePool[a].pop();return h||(h=this.createTexture(t,e,r)),h.filterPoolKey=a,h.setResolution(s),h}getFilterTexture(t,e,s){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||MSAA_QUALITY.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}RenderTexturePool.SCREEN_KEY=-1;class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer(this.vertices),this.uvBuffer=new Buffer(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+e.width/t.width,this.uvs[3]=r,this.uvs[4]=s+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=s,this.uvs[7]=r+e.height/t.height,s=e.x,r=e.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+e.width,this.vertices[3]=r,this.vertices[4]=s+e.width,this.vertices[5]=r+e.height,this.vertices[6]=s,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const tempPoints=[new Point,new Point,new Point,new Point],tempMatrix$2=new Matrix;class FilterSystem{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const s=this.renderer,r=this.defaultFilterStack,a=this.statePool.pop()||new FilterState,h=this.renderer.renderTexture;let c=e[0].resolution,o=e[0].multisample,u=e[0].padding,d=e[0].autoFit,m=e[0].legacy??!0;for(let _=1;_<e.length;_++){const y=e[_];c=Math.min(c,y.resolution),o=Math.min(o,y.multisample),u=this.useMaxPadding?Math.max(u,y.padding):u+y.padding,d=d&&y.autoFit,m=m||(y.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),r.push(a),a.resolution=c,a.multisample=o,a.legacy=m,a.target=t,a.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),a.sourceFrame.pad(u);const p=this.tempRect.copyFrom(h.sourceFrame);s.projection.transform&&this.transformAABB(tempMatrix$2.copyFrom(s.projection.transform).invert(),p),d?(a.sourceFrame.fit(p),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(p)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,h.current?h.current.resolution:s.resolution,h.sourceFrame,h.destinationFrame,s.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,c,o),a.filters=e,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;const g=this.tempRect;g.x=0,g.y=0,g.width=a.sourceFrame.width,g.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(h.sourceFrame),a.bindingDestinationFrame.copyFrom(h.destinationFrame),a.transform=s.projection.transform,s.projection.transform=null,h.bind(a.renderTexture,a.sourceFrame,g),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const a=r.inputSize,h=r.inputPixel,c=r.inputClamp;if(a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],h[0]=Math.round(a[0]*e.resolution),h[1]=Math.round(a[1]*e.resolution),h[2]=1/h[0],h[3]=1/h[1],c[0]=.5*h[2],c[1]=.5*h[3],c[2]=e.sourceFrame.width*a[2]-.5*h[2],c[3]=e.sourceFrame.height*a[3]-.5*h[3],e.legacy){const u=r.filterArea;u[0]=e.destinationFrame.width,u[1]=e.destinationFrame.height,u[2]=e.sourceFrame.x,u[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,o.renderTexture,CLEAR_MODES.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let u=e.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,e.resolution);d.filterFrame=u.filterFrame;let m=0;for(m=0;m<s.length-1;++m){m===1&&e.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,e.resolution),d.filterFrame=u.filterFrame),s[m].apply(this,u,d,CLEAR_MODES.CLEAR,e);const p=u;u=d,d=p}s[m].apply(this,u,o.renderTexture,CLEAR_MODES.BLEND,e),m>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=CLEAR_MODES.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const h=this.tempRect;h.x=0,h.y=0,h.width=t.filterFrame.width,h.height=t.filterFrame.height,s.bind(t,t.filterFrame,h)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const a=r.stateId&1||this.forceClear;(e===CLEAR_MODES.CLEAR||e===CLEAR_MODES.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,s,r){const a=this.renderer;a.state.set(t.state),this.bindAndClear(s,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(DRAW_MODES.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:a}=e._texture,h=t.set(r.width,0,0,r.height,s.x,s.y),c=e.worldTransform.copyTo(Matrix.TEMP_MATRIX);return c.invert(),h.prepend(c),h.scale(1/a.width,1/a.height),h.translate(e.anchor.x,e.anchor.y),h}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,s=1,r=MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(t,e,s,r)}getFilterTexture(t,e,s){if(typeof t=="number"){const a=t;t=e,e=a}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||MSAA_QUALITY.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const s=tempPoints[0],r=tempPoints[1],a=tempPoints[2],h=tempPoints[3];s.set(e.left,e.top),r.set(e.left,e.bottom),a.set(e.right,e.top),h.set(e.right,e.bottom),t.apply(s,s),t.apply(r,r),t.apply(a,a),t.apply(h,h);const c=Math.min(s.x,r.x,a.x,h.x),o=Math.min(s.y,r.y,a.y,h.y),u=Math.max(s.x,r.x,a.x,h.x),d=Math.max(s.y,r.y,a.y,h.y);e.x=c,e.y=o,e.width=u-c,e.height=d-o}roundFrame(t,e,s,r,a){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(a){const{a:h,b:c,c:o,d:u}=a;if((Math.abs(c)>1e-4||Math.abs(o)>1e-4)&&(Math.abs(h)>1e-4||Math.abs(u)>1e-4))return}a=a?tempMatrix$2.copyFrom(a):tempMatrix$2.identity(),a.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(a,t),t.ceil(e),this.transformAABB(a.invert(),t)}}}FilterSystem.extension={type:ExtensionType.RendererSystem,name:"filter"};extensions$1.add(FilterSystem);class GLFramebuffer{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const tempRectangle=new Rectangle;class FramebufferSystem{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,s=0){const{gl:r}=this;if(t){const a=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,a.mipLevel=s),a.dirtyId!==t.dirtyId&&(a.dirtyId=t.dirtyId,a.dirtyFormat!==t.dirtyFormat?(a.dirtyFormat=t.dirtyFormat,a.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):a.dirtySize!==t.dirtySize&&(a.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let h=0;h<t.colorTextures.length;h++){const c=t.colorTextures[h];this.renderer.texture.unbind(c.parentTextureArray||c)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const h=e.width>>s,c=e.height>>s,o=h/e.width;this.setViewport(e.x*o,e.y*o,h,c)}else{const h=t.width>>s,c=t.height>>s;this.setViewport(0,0,h,c)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,s,r){const a=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),r=Math.round(r),(a.width!==s||a.height!==r||a.x!==t||a.y!==e)&&(a.x=t,a.y=e,a.width=s,a.height=r,this.gl.viewport(t,e,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,s,r,a=BUFFER_BITS.COLOR|BUFFER_BITS.DEPTH){const{gl:h}=this;h.clearColor(t,e,s,r),h.clear(a)}initFramebuffer(t){const{gl:e}=this,s=new GLFramebuffer(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:e}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,s.stencil),s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let a=r.length;e.drawBuffers||(a=Math.min(a,1));for(let h=0;h<a;h++){const c=r[h],o=c.parentTextureArray||c;this.renderer.texture.bind(o,0),h===0&&s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID],a=t.colorTextures;let h=a.length;s.drawBuffers||(h=Math.min(h,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const c=[];for(let o=0;o<h;o++){const u=a[o],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),o===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+o,u.target,d._glTextures[this.CONTEXT_UID].texture,e),c.push(s.COLOR_ATTACHMENT0+o))}if(c.length>1&&s.drawBuffers(c),t.depthTexture&&this.writeDepthTexture){const u=t.depthTexture;this.renderer.texture.bind(u,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let s=MSAA_QUALITY.NONE;if(t<=1||e===null)return s;for(let r=0;r<e.length;r++)if(e[r]<=t){s=e[r];break}return s===1&&(s=MSAA_QUALITY.NONE),s}blit(t,e,s){const{current:r,renderer:a,gl:h,CONTEXT_UID:c}=this;if(a.context.webGLVersion!==2||!r)return;const o=r.glFramebuffers[c];if(!o)return;if(!t){if(!o.msaaBuffer)return;const d=r.colorTextures[0];if(!d)return;o.blitFramebuffer||(o.blitFramebuffer=new Framebuffer(r.width,r.height),o.blitFramebuffer.addColorTexture(0,d)),t=o.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=tempRectangle,e.width=r.width,e.height=r.height),s||(s=e);const u=e.width===s.width&&e.height===s.height;this.bind(t),h.bindFramebuffer(h.READ_FRAMEBUFFER,o.framebuffer),h.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,h.COLOR_BUFFER_BIT,u?h.NEAREST:h.LINEAR)}disposeFramebuffer(t,e){const s=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const a=this.managedFramebuffers.indexOf(t);a>=0&&this.managedFramebuffers.splice(a,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&s.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const s=t.width,r=t.height,a=this.gl,h=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,h),e.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,e.multisample,a.DEPTH24_STENCIL8,s,r):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,s,r),e.stencil=h,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,h)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}}FramebufferSystem.extension={type:ExtensionType.RendererSystem,name:"framebuffer"};extensions$1.add(FramebufferSystem);const byteSizeMap={5126:4,5123:2,5121:1};class GeometrySystem{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=r=>s.bindVertexArrayOES(r),t.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(r,a)=>s.vertexAttribDivisorANGLE(r,a),t.drawElementsInstanced=(r,a,h,c,o)=>s.drawElementsInstancedANGLE(r,a,h,c,o),t.drawArraysInstanced=(r,a,h,c)=>s.drawArraysInstancedANGLE(r,a,h,c)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:s}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],a=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},a=!0);const h=r[e.program.id]||this.initGeometryVao(t,e,a);this._activeGeometry=t,this._activeVao!==h&&(this._activeVao=h,this.hasVao?s.bindVertexArray(h):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const r=t.buffers[s];e.update(r)}}checkCompatibility(t,e){const s=t.attributes,r=e.attributeData;for(const a in r)if(!s[a])throw new Error(`shader and geometry incompatible, geometry missing the "${a}" attribute`)}getSignature(t,e){const s=t.attributes,r=e.attributeData,a=["g",t.id];for(const h in s)r[h]&&a.push(h,r[h].location);return a.join("-")}initGeometryVao(t,e,s=!0){const r=this.gl,a=this.CONTEXT_UID,h=this.renderer.buffer,c=e.program;c.glPrograms[a]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,c);const o=this.getSignature(t,c),u=t.glVertexArrayObjects[this.CONTEXT_UID];let d=u[o];if(d)return u[c.id]=d,d;const m=t.buffers,p=t.attributes,g={},_={};for(const y in m)g[y]=0,_[y]=0;for(const y in p)!p[y].size&&c.attributeData[y]?p[y].size=c.attributeData[y].size:p[y].size||console.warn(`PIXI Geometry attribute '${y}' size cannot be determined (likely the bound shader does not have the attribute)`),g[p[y].buffer]+=p[y].size*byteSizeMap[p[y].type];for(const y in p){const v=p[y],U=v.size;v.stride===void 0&&(g[v.buffer]===U*byteSizeMap[v.type]?v.stride=0:v.stride=g[v.buffer]),v.start===void 0&&(v.start=_[v.buffer],_[v.buffer]+=U*byteSizeMap[v.type])}d=r.createVertexArray(),r.bindVertexArray(d);for(let y=0;y<m.length;y++){const v=m[y];h.bind(v),s&&v._glBuffers[a].refCount++}return this.activateVao(t,c),u[c.id]=d,u[o]=d,r.bindVertexArray(null),h.unbind(BUFFER_TYPE.ARRAY_BUFFER),d}disposeGeometry(t,e){var c;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,a=t.buffers,h=(c=this.renderer)==null?void 0:c.buffer;if(t.disposeRunner.remove(this),!!s){if(h)for(let o=0;o<a.length;o++){const u=a[o]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!e&&h.dispose(a[o],e))}if(!e){for(const o in s)if(o[0]==="g"){const u=s[o];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)}activateVao(t,e){const s=this.gl,r=this.CONTEXT_UID,a=this.renderer.buffer,h=t.buffers,c=t.attributes;t.indexBuffer&&a.bind(t.indexBuffer);let o=null;for(const u in c){const d=c[u],m=h[d.buffer],p=m._glBuffers[r];if(e.attributeData[u]){o!==p&&(a.bind(m),o=p);const g=e.attributeData[u].location;if(s.enableVertexAttribArray(g),s.vertexAttribPointer(g,d.size,d.type||s.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)s.vertexAttribDivisor(g,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,s,r){const{gl:a}=this,h=this._activeGeometry;if(h.indexBuffer){const c=h.indexBuffer.data.BYTES_PER_ELEMENT,o=c===2?a.UNSIGNED_SHORT:a.UNSIGNED_INT;c===2||c===4&&this.canUseUInt32ElementIndex?h.instanced?a.drawElementsInstanced(t,e||h.indexBuffer.data.length,o,(s||0)*c,r||1):a.drawElements(t,e||h.indexBuffer.data.length,o,(s||0)*c):console.warn("unsupported index buffer type: uint32")}else h.instanced?a.drawArraysInstanced(t,s,e||h.getSize(),r||1):a.drawArrays(t,s,e||h.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}GeometrySystem.extension={type:ExtensionType.RendererSystem,name:"geometry"};extensions$1.add(GeometrySystem);const tempMat$1=new Matrix;class TextureMatrix{constructor(t,e){this._texture=t,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const a=t[r],h=t[r+1];e[r]=a*s.a+h*s.c+s.tx,e[r+1]=a*s.b+h*s.d+s.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,a=e.trim;a&&(tempMat$1.set(r.width/a.width,0,0,r.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(tempMat$1));const h=e.baseTexture,c=this.uClampFrame,o=this.clampMargin/h.resolution,u=this.clampOffset;return c[0]=(e._frame.x+o+u)/h.width,c[1]=(e._frame.y+o+u)/h.height,c[2]=(e._frame.x+e._frame.width-o+u)/h.width,c[3]=(e._frame.y+e._frame.height-o+u)/h.height,this.uClampOffset[0]=u/h.realWidth,this.uClampOffset[1]=u/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0}}var fragment$7=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vertex$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class SpriteMaskFilter extends Filter{constructor(t,e,s){let r=null;typeof t!="string"&&e===void 0&&s===void 0&&(r=t,t=void 0,e=void 0,s=void 0),super(t||vertex$4,e||fragment$7,s),this.maskSprite=r,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,s,r){const a=this._maskSprite,h=a._texture;h.valid&&(h.uvMatrix||(h.uvMatrix=new TextureMatrix(h,0)),h.uvMatrix.update(),this.uniforms.npmAlpha=h.baseTexture.alphaMode?0:1,this.uniforms.mask=h,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,a).prepend(h.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=h.uvMatrix.uClampFrame,t.applyFilter(this,e,s,r))}}class MaskData{constructor(t=null){this.type=MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Filter.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class MaskSystem{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let s=e;if(!s.isMaskData){const a=this.maskDataPool.pop()||new MaskData;a.pooled=!0,a.maskObject=e,s=a}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==MASK_TYPES.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.push(s);break;case MASK_TYPES.STENCIL:this.renderer.stencil.push(s);break;case MASK_TYPES.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case MASK_TYPES.COLOR:this.pushColorMask(s);break}s.type===MASK_TYPES.SPRITE&&this.maskStack.push(s)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.pop(e);break;case MASK_TYPES.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case MASK_TYPES.SPRITE:this.popSpriteMask(e);break;case MASK_TYPES.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===MASK_TYPES.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=MASK_TYPES.SCISSOR:t.type=MASK_TYPES.STENCIL:t.type=MASK_TYPES.COLOR}pushSpriteMask(t){const{maskObject:e}=t,s=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter]));const a=this.renderer,h=a.renderTexture;let c,o;if(h.current){const d=h.current;c=t.resolution||d.resolution,o=t.multisample??d.multisample}else c=t.resolution||a.resolution,o=t.multisample??a.multisample;r[0].resolution=c,r[0].multisample=o,r[0].maskSprite=e;const u=s.filterArea;s.filterArea=e.getBounds(!0),a.filter.push(s,r),s.filterArea=u,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}MaskSystem.extension={type:ExtensionType.RendererSystem,name:"mask"};extensions$1.add(MaskSystem);class AbstractMaskSystem{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,s=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==s&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const tempMatrix$1=new Matrix,rectPool=[],_ScissorSystem=class extends AbstractMaskSystem{constructor(n){super(n),this.glConst=settings$1.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const n=this.maskStack[this.maskStack.length-1];return n?n._scissorCounter:0}calcScissorRect(n){if(n._scissorRectLocal)return;const t=n._scissorRect,{maskObject:e}=n,{renderer:s}=this,r=s.renderTexture,a=e.getBounds(!0,rectPool.pop()??new Rectangle);this.roundFrameToPixels(a,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),t&&a.fit(t),n._scissorRectLocal=a}static isMatrixRotated(n){if(!n)return!1;const{a:t,b:e,c:s,d:r}=n;return(Math.abs(e)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(n){const{maskObject:t}=n;if(!t.isFastRect||!t.isFastRect()||_ScissorSystem.isMatrixRotated(t.worldTransform)||_ScissorSystem.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(n);const e=n._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(n,t,e,s,r){_ScissorSystem.isMatrixRotated(r)||(r=r?tempMatrix$1.copyFrom(r):tempMatrix$1.identity(),r.translate(-e.x,-e.y).scale(s.width/e.width,s.height/e.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,n),n.fit(s),n.x=Math.round(n.x*t),n.y=Math.round(n.y*t),n.width=Math.round(n.width*t),n.height=Math.round(n.height*t))}push(n){n._scissorRectLocal||this.calcScissorRect(n);const{gl:t}=this.renderer;n._scissorRect||t.enable(t.SCISSOR_TEST),n._scissorCounter++,n._scissorRect=n._scissorRectLocal,this._useCurrent()}pop(n){const{gl:t}=this.renderer;n&&rectPool.push(n._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const n=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=n.y:t=this.renderer.height-n.height-n.y,this.renderer.gl.scissor(n.x,t,n.width,n.height)}};let ScissorSystem=_ScissorSystem;ScissorSystem.extension={type:ExtensionType.RendererSystem,name:"scissor"};extensions$1.add(ScissorSystem);class StencilSystem extends AbstractMaskSystem{constructor(t){super(t),this.glConst=settings$1.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:s}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const a=t._colorMask;a!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,a!==0&&(t._colorMask=a,s.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(s._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}StencilSystem.extension={type:ExtensionType.RendererSystem,name:"stencil"};extensions$1.add(StencilSystem);class PluginSystem{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}PluginSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_plugin"};extensions$1.add(PluginSystem);class ProjectionSystem{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(t,e,s,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)}calculateProjection(t,e,s,r){const a=this.projectionMatrix,h=r?-1:1;a.identity(),a.a=1/e.width*2,a.d=h*(1/e.height*2),a.tx=-1-e.x*a.a,a.ty=-h-e.y*a.d}setTransform(t){}destroy(){this.renderer=null}}ProjectionSystem.extension={type:ExtensionType.RendererSystem,name:"projection"};extensions$1.add(ProjectionSystem);const tempTransform=new Transform;class GenerateTextureSystem{constructor(t){this.renderer=t,this._tempMatrix=new Matrix}generateTexture(t,e){const{region:s,...r}=e||{},a=s||t.getLocalBounds(null,!0);a.width===0&&(a.width=1),a.height===0&&(a.height=1);const h=RenderTexture.create({width:a.width,height:a.height,...r});this._tempMatrix.tx=-a.x,this._tempMatrix.ty=-a.y;const c=t.transform;return t.transform=tempTransform,this.renderer.render(t,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=c,h}destroy(){}}GenerateTextureSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"textureGenerator"};extensions$1.add(GenerateTextureSystem);const tempRect=new Rectangle,tempRect2=new Rectangle;class RenderTextureSystem{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}bind(t=null,e,s){const r=this.renderer;this.current=t;let a,h,c;t?(a=t.baseTexture,c=a.resolution,e||(tempRect.width=t.frame.width,tempRect.height=t.frame.height,e=tempRect),s||(tempRect2.x=t.frame.x,tempRect2.y=t.frame.y,tempRect2.width=e.width,tempRect2.height=e.height,s=tempRect2),h=a.framebuffer):(c=r.resolution,e||(tempRect.width=r._view.screen.width,tempRect.height=r._view.screen.height,e=tempRect),s||(s=tempRect,s.width=e.width,s.height=e.height));const o=this.viewportFrame;o.x=s.x*c,o.y=s.y*c,o.width=s.width*c,o.height=s.height*c,t||(o.y=r.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(h,o),this.renderer.projection.update(s,e,c,!h),t?this.renderer.mask.setMaskStack(a.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const s=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==r.width||s.height!==r.height;if(a){let{x:h,y:c,width:o,height:u}=this.viewportFrame;h=Math.round(h),c=Math.round(c),o=Math.round(o),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,c,o,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}RenderTextureSystem.extension={type:ExtensionType.RendererSystem,name:"renderTexture"};extensions$1.add(RenderTextureSystem);class GLProgram{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function getAttributeData(n,t){const e={},s=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const a=t.getActiveAttrib(n,r);if(a.name.startsWith("gl_"))continue;const h=mapType(t,a.type),c={type:h,name:a.name,size:mapSize(h),location:t.getAttribLocation(n,a.name)};e[a.name]=c}return e}function getUniformData(n,t){const e={},s=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const a=t.getActiveUniform(n,r),h=a.name.replace(/\[.*?\]$/,""),c=!!a.name.match(/\[.*?\]$/),o=mapType(t,a.type);e[h]={name:h,index:r,type:o,size:a.size,isArray:c,value:defaultValue(o,a.size)}}return e}function generateProgram(n,t){var o;const e=compileShader(n,n.VERTEX_SHADER,t.vertexSrc),s=compileShader(n,n.FRAGMENT_SHADER,t.fragmentSrc),r=n.createProgram();n.attachShader(r,e),n.attachShader(r,s);const a=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(a&&(typeof n.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(r,a.names,a.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||logProgramError(n,r,e,s),t.attributeData=getAttributeData(r,n),t.uniformData=getUniformData(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const u=Object.keys(t.attributeData);u.sort((d,m)=>d>m?1:-1);for(let d=0;d<u.length;d++)t.attributeData[u[d]].location=d,n.bindAttribLocation(r,d,u[d]);n.linkProgram(r)}n.deleteShader(e),n.deleteShader(s);const h={};for(const u in t.uniformData){const d=t.uniformData[u];h[u]={location:n.getUniformLocation(r,u),value:defaultValue(d.type,d.size)}}return new GLProgram(r,h)}function uboUpdate(n,t,e,s,r){e.buffer.update(r)}const UBO_TO_SINGLE_SETTERS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function createUBOElements(n){const t=n.map(a=>({data:a,offset:0,dataLen:0,dirty:0}));let e=0,s=0,r=0;for(let a=0;a<t.length;a++){const h=t[a];if(e=GLSL_TO_STD40_SIZE[h.data.type],h.data.size>1&&(e=Math.max(e,16)*h.data.size),h.dataLen=e,s%e!==0&&s<16){const c=s%e%16;s+=c,r+=c}s+e>16?(r=Math.ceil(r/16)*16,h.offset=r,r+=e,s=e):(h.offset=r,s+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function getUBOData(n,t){const e=[];for(const s in n)t[s]&&e.push(t[s]);return e.sort((s,r)=>s.index-r.index),e}function generateUniformBufferSync(n,t){if(!n.autoManage)return{size:0,syncFunc:uboUpdate};const e=getUBOData(n.uniforms,t),{uboElements:s,size:r}=createUBOElements(e),a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let h=0;h<s.length;h++){const c=s[h],o=n.uniforms[c.data.name],u=c.data.name;let d=!1;for(let m=0;m<uniformParsers.length;m++){const p=uniformParsers[m];if(p.codeUbo&&p.test(c.data,o)){a.push(`offset = ${c.offset/4};`,uniformParsers[m].codeUbo(c.data.name,o)),d=!0;break}}if(!d)if(c.data.size>1){const m=mapSize(c.data.type),p=Math.max(GLSL_TO_STD40_SIZE[c.data.type]/16,1),g=m/p,_=(4-g%4)%4;a.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${c.offset/4};

                t = 0;

                for(var i=0; i < ${c.data.size*p}; i++)
                {
                    for(var j = 0; j < ${g}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{const m=UBO_TO_SINGLE_SETTERS[c.data.type];a.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${c.offset/4};
                ${m};
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}let UID=0;const defaultSyncData={textureCount:0,uboCount:0};class ShaderSystem{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID++}systemCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),e||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(t.uniformGroup,defaultSyncData)),r}setUniforms(t){const e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,e){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))}syncUniforms(t,e,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=generateUniformsSync(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const r=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),r(s.uniformData,t.uniforms,this.renderer,defaultSyncData,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])}createSyncBufferGroup(t,e,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const a=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,a,this.shader.uniformBindCount),this.shader.uniformBindCount++;const h=this.getSignature(t,this.shader.program.uniformData,"ubo");let c=this._uboCache[h];if(c||(c=this._uboCache[h]=generateUniformBufferSync(t,this.shader.program.uniformData)),t.autoManage){const o=new Float32Array(c.size/4);t.buffer.update(o)}return e.uniformGroups[t.id]=c.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,s){const r=t.uniforms,a=[`${s}-`];for(const h in r)a.push(h),e[h]&&a.push(e[h].type);return a.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,s=t.program,r=generateProgram(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ShaderSystem.extension={type:ExtensionType.RendererSystem,name:"shader"};extensions$1.add(ShaderSystem);class StartupSystem{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.1 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}StartupSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"startup"};extensions$1.add(StartupSystem);function mapWebGLBlendModesToPixi(n,t=[]){return t[BLEND_MODES.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.ADD]=[n.ONE,n.ONE],t[BLEND_MODES.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.NONE]=[0,0],t[BLEND_MODES.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],t[BLEND_MODES.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SRC_IN]=[n.DST_ALPHA,n.ZERO],t[BLEND_MODES.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],t[BLEND_MODES.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],t[BLEND_MODES.DST_IN]=[n.ZERO,n.SRC_ALPHA],t[BLEND_MODES.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],t[BLEND_MODES.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],t}const BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_StateSystem=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new State$1,this.defaultState.blend=!0}contextChange(n){this.gl=n,this.blendModes=mapWebGLBlendModesToPixi(n),this.set(this.defaultState),this.reset()}set(n){if(n=n||this.defaultState,this.stateId!==n.data){let t=this.stateId^n.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(n.data&1<<e)),t=t>>1,e++;this.stateId=n.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,n)}forceState(n){n=n||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(n.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,n);this.stateId=n.data}setBlend(n){this.updateCheck(_StateSystem.checkBlendMode,n),this.gl[n?"enable":"disable"](this.gl.BLEND)}setOffset(n){this.updateCheck(_StateSystem.checkPolygonOffset,n),this.gl[n?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(n){this.gl[n?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(n){this.gl.depthMask(n)}setCullFace(n){this.gl[n?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(n){this.gl.frontFace(this.gl[n?"CW":"CCW"])}setBlendMode(n){if(n===this.blendMode)return;this.blendMode=n;const t=this.blendModes[n],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(n,t){this.gl.polygonOffset(n,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(n,t){const e=this.checks.indexOf(n);t&&e===-1?this.checks.push(n):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(n,t){n.setBlendMode(t.blendMode)}static checkPolygonOffset(n,t){n.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let StateSystem=_StateSystem;StateSystem.extension={type:ExtensionType.RendererSystem,name:"state"};extensions$1.add(StateSystem);class SystemManager extends eventemitter3Exports{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),s=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of s)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new Runner(e)})}addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(t,e){const s=Object.keys(this._systemsHash);t.items.forEach(r=>{const a=s.find(h=>this._systemsHash[h]===r);r[t.name](e[a])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const _TextureGCSystem=class{constructor(n){this.renderer=n,this.count=0,this.checkCount=0,this.maxIdle=_TextureGCSystem.defaultMaxIdle,this.checkCountMax=_TextureGCSystem.defaultCheckCountMax,this.mode=_TextureGCSystem.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const n=this.renderer.texture,t=n.managedTextures;let e=!1;for(let s=0;s<t.length;s++){const r=t[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(n.destroyTexture(r,!0),t[s]=null,e=!0)}if(e){let s=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[s++]=t[r]);t.length=s}}unload(n){const t=this.renderer.texture,e=n._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let s=n.children.length-1;s>=0;s--)this.unload(n.children[s])}destroy(){this.renderer=null}};let TextureGCSystem=_TextureGCSystem;TextureGCSystem.defaultMode=GC_MODES.AUTO;TextureGCSystem.defaultMaxIdle=60*60;TextureGCSystem.defaultCheckCountMax=60*10;TextureGCSystem.extension={type:ExtensionType.RendererSystem,name:"textureGC"};extensions$1.add(TextureGCSystem);class GLTexture{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=TYPES.UNSIGNED_BYTE,this.internalFormat=FORMATS.RGBA,this.samplerType=0}}function mapTypeAndFormatToInternalFormat(n){let t;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?t={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:n.RGBA8,[FORMATS.RGB]:n.RGB8,[FORMATS.RG]:n.RG8,[FORMATS.RED]:n.R8,[FORMATS.RGBA_INTEGER]:n.RGBA8UI,[FORMATS.RGB_INTEGER]:n.RGB8UI,[FORMATS.RG_INTEGER]:n.RG8UI,[FORMATS.RED_INTEGER]:n.R8UI,[FORMATS.ALPHA]:n.ALPHA,[FORMATS.LUMINANCE]:n.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[TYPES.BYTE]:{[FORMATS.RGBA]:n.RGBA8_SNORM,[FORMATS.RGB]:n.RGB8_SNORM,[FORMATS.RG]:n.RG8_SNORM,[FORMATS.RED]:n.R8_SNORM,[FORMATS.RGBA_INTEGER]:n.RGBA8I,[FORMATS.RGB_INTEGER]:n.RGB8I,[FORMATS.RG_INTEGER]:n.RG8I,[FORMATS.RED_INTEGER]:n.R8I},[TYPES.UNSIGNED_SHORT]:{[FORMATS.RGBA_INTEGER]:n.RGBA16UI,[FORMATS.RGB_INTEGER]:n.RGB16UI,[FORMATS.RG_INTEGER]:n.RG16UI,[FORMATS.RED_INTEGER]:n.R16UI,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT16},[TYPES.SHORT]:{[FORMATS.RGBA_INTEGER]:n.RGBA16I,[FORMATS.RGB_INTEGER]:n.RGB16I,[FORMATS.RG_INTEGER]:n.RG16I,[FORMATS.RED_INTEGER]:n.R16I},[TYPES.UNSIGNED_INT]:{[FORMATS.RGBA_INTEGER]:n.RGBA32UI,[FORMATS.RGB_INTEGER]:n.RGB32UI,[FORMATS.RG_INTEGER]:n.RG32UI,[FORMATS.RED_INTEGER]:n.R32UI,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT24},[TYPES.INT]:{[FORMATS.RGBA_INTEGER]:n.RGBA32I,[FORMATS.RGB_INTEGER]:n.RGB32I,[FORMATS.RG_INTEGER]:n.RG32I,[FORMATS.RED_INTEGER]:n.R32I},[TYPES.FLOAT]:{[FORMATS.RGBA]:n.RGBA32F,[FORMATS.RGB]:n.RGB32F,[FORMATS.RG]:n.RG32F,[FORMATS.RED]:n.R32F,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT32F},[TYPES.HALF_FLOAT]:{[FORMATS.RGBA]:n.RGBA16F,[FORMATS.RGB]:n.RGB16F,[FORMATS.RG]:n.RG16F,[FORMATS.RED]:n.R16F},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:n.RGB565},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:n.RGBA4},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:n.RGB5_A1},[TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[FORMATS.RGBA]:n.RGB10_A2,[FORMATS.RGBA_INTEGER]:n.RGB10_A2UI},[TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[FORMATS.RGB]:n.R11F_G11F_B10F},[TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[FORMATS.RGB]:n.RGB9_E5},[TYPES.UNSIGNED_INT_24_8]:{[FORMATS.DEPTH_STENCIL]:n.DEPTH24_STENCIL8},[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[FORMATS.DEPTH_STENCIL]:n.DEPTH32F_STENCIL8}}:t={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:n.RGBA,[FORMATS.RGB]:n.RGB,[FORMATS.ALPHA]:n.ALPHA,[FORMATS.LUMINANCE]:n.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:n.RGB},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:n.RGBA},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:n.RGBA}},t}class TextureSystem{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new GLTexture(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new GLTexture(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),s[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let a=t-1;a>=0;--a){const h=e[a];h&&h._glTextures[r].samplerType!==SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(h)}}initTexture(t){const e=new GLTexture(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var s;e.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===TYPES.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const s=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(s,t,e))e.samplerType!==SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{const a=t.realWidth,h=t.realHeight,c=s.gl;(e.width!==a||e.height!==h||e.dirtyId<0)&&(e.width=a,e.height=h,c.texImage2D(t.target,0,e.internalFormat,a,h,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&removeItems(this.managedTextures,r,1)}}updateTextureStyle(t){var s;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===MIPMAP_MODES.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=WRAP_MODES.CLAMP:e.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const s=this.gl;if(e.mipmap&&t.mipmap!==MIPMAP_MODES.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===SCALE_MODES.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===SCALE_MODES.LINEAR){const a=Math.min(t.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===SCALE_MODES.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===SCALE_MODES.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}TextureSystem.extension={type:ExtensionType.RendererSystem,name:"texture"};extensions$1.add(TextureSystem);class TransformFeedbackSystem{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:s,renderer:r}=this;e&&r.shader.bind(e),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:s,CONTEXT_UID:r}=this,a=e.createTransformFeedback();t._glTransformFeedbacks[r]=a,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,a);for(let h=0;h<t.buffers.length;h++){const c=t.buffers[h];c&&(s.buffer.update(c),c._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,h,c._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),a}disposeTransformFeedback(t,e){const s=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const a=this.renderer.buffer;if(a)for(let h=0;h<t.buffers.length;h++){const c=t.buffers[h];if(!c)continue;const o=c._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,o.refCount===0&&!e&&a.dispose(c,e))}s&&(e||r.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}TransformFeedbackSystem.extension={type:ExtensionType.RendererSystem,name:"transformFeedback"};extensions$1.add(TransformFeedbackSystem);class ViewSystem{constructor(t){this.renderer=t}init(t){this.screen=new Rectangle(0,0,t.width,t.height),this.element=t.view||settings$1.ADAPTER.createCanvas(),this.resolution=t.resolution||settings$1.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ViewSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_view"};extensions$1.add(ViewSystem);settings$1.PREFER_ENV=ENV.WEBGL2;settings$1.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(settings$1,{WRAP_MODE:{get(){return BaseTexture.defaultOptions.wrapMode},set(n){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),BaseTexture.defaultOptions.wrapMode=n}},SCALE_MODE:{get(){return BaseTexture.defaultOptions.scaleMode},set(n){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),BaseTexture.defaultOptions.scaleMode=n}},MIPMAP_TEXTURES:{get(){return BaseTexture.defaultOptions.mipmap},set(n){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),BaseTexture.defaultOptions.mipmap=n}},ANISOTROPIC_LEVEL:{get(){return BaseTexture.defaultOptions.anisotropicLevel},set(n){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),BaseTexture.defaultOptions.anisotropicLevel=n}},FILTER_RESOLUTION:{get(){return deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Filter.defaultResolution},set(n){Filter.defaultResolution=n}},FILTER_MULTISAMPLE:{get(){return deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Filter.defaultMultisample},set(n){Filter.defaultMultisample=n}},SPRITE_MAX_TEXTURES:{get(){return BatchRenderer.defaultMaxTextures},set(n){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),BatchRenderer.defaultMaxTextures=n}},SPRITE_BATCH_SIZE:{get(){return BatchRenderer.defaultBatchSize},set(n){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),BatchRenderer.defaultBatchSize=n}},CAN_UPLOAD_SAME_BUFFER:{get(){return BatchRenderer.canUploadSameBuffer},set(n){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),BatchRenderer.canUploadSameBuffer=n}},GC_MODE:{get(){return TextureGCSystem.defaultMode},set(n){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),TextureGCSystem.defaultMode=n}},GC_MAX_IDLE:{get(){return TextureGCSystem.defaultMaxIdle},set(n){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),TextureGCSystem.defaultMaxIdle=n}},GC_MAX_CHECK_COUNT:{get(){return TextureGCSystem.defaultCheckCountMax},set(n){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),TextureGCSystem.defaultCheckCountMax=n}},PRECISION_VERTEX:{get(){return Program.defaultVertexPrecision},set(n){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Program.defaultVertexPrecision=n}},PRECISION_FRAGMENT:{get(){return Program.defaultFragmentPrecision},set(n){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Program.defaultFragmentPrecision=n}}});var UPDATE_PRIORITY=(n=>(n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(UPDATE_PRIORITY||{});class TickerListener{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const _Ticker=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/_Ticker.targetFPMS,this.elapsedMS=1/_Ticker.targetFPMS,this._tick=n=>{this._requestId=null,this.started&&(this.update(n),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(n,t,e=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(n,t,e))}addOnce(n,t,e=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(n,t,e,!0))}_addListener(n){let t=this._head.next,e=this._head;if(!t)n.connect(e);else{for(;t;){if(n.priority>t.priority){n.connect(e);break}e=t,t=t.next}n.previous||n.connect(e)}return this._startIfPossible(),this}remove(n,t){let e=this._head.next;for(;e;)e.match(n,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let n=0,t=this._head;for(;t=t.next;)n++;return n}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let n=this._head.next;for(;n;)n=n.destroy(!0);this._head.destroy(),this._head=null}}update(n=performance.now()){let t;if(n>this.lastTime){if(t=this.elapsedMS=n-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=n-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=n-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*_Ticker.targetFPMS;const e=this._head;let s=e.next;for(;s;)s=s.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=n}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(n){const t=Math.min(this.maxFPS,n),e=Math.min(Math.max(0,t)/1e3,_Ticker.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(n){if(n===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,n);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!_Ticker._shared){const n=_Ticker._shared=new _Ticker;n.autoStart=!0,n._protected=!0}return _Ticker._shared}static get system(){if(!_Ticker._system){const n=_Ticker._system=new _Ticker;n.autoStart=!0,n._protected=!0}return _Ticker._system}};let Ticker=_Ticker;Ticker.targetFPMS=.06;Object.defineProperties(settings$1,{TARGET_FPMS:{get(){return Ticker.targetFPMS},set(n){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ticker.targetFPMS=n}}});class TickerPlugin{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ticker.shared:new Ticker,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}TickerPlugin.extension=ExtensionType.Application;extensions$1.add(TickerPlugin);const renderers=[];extensions$1.handleByList(ExtensionType.Renderer,renderers);function autoDetectRenderer(n){for(const t of renderers)if(t.test(n))return new t(n);throw new Error("Unable to auto-detect a suitable renderer.")}var $defaultVertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$defaultFilterVertex=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const defaultVertex=$defaultVertex,defaultFilterVertex=$defaultFilterVertex;class MultisampleSystem{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}e>=MSAA_QUALITY.HIGH?this.multisample=MSAA_QUALITY.HIGH:e>=MSAA_QUALITY.MEDIUM?this.multisample=MSAA_QUALITY.MEDIUM:e>=MSAA_QUALITY.LOW?this.multisample=MSAA_QUALITY.LOW:this.multisample=MSAA_QUALITY.NONE}destroy(){}}MultisampleSystem.extension={type:ExtensionType.RendererSystem,name:"_multisample"};extensions$1.add(MultisampleSystem);class GLBuffer{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class BufferSystem{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const a=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,s.bindBufferBase(s.UNIFORM_BUFFER,e,a.buffer)}}bindBufferRange(t,e,s){const{gl:r,CONTEXT_UID:a}=this;s=s||0;const h=t._glBuffers[a]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,h.buffer,s*256,256)}update(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const a=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,a)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),s&&(e||r.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:s}=this;return t._glBuffers[e]=new GLBuffer(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}BufferSystem.extension={type:ExtensionType.RendererSystem,name:"buffer"};extensions$1.add(BufferSystem);class ObjectRendererSystem{constructor(t){this.renderer=t}render(t,e){const s=this.renderer;let r,a,h,c;if(e&&(r=e.renderTexture,a=e.clear,h=e.transform,c=e.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=h,!s.context.isLost){if(r||(this.lastObjectRendered=t),!c){const o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(a??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),r&&(e.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ObjectRendererSystem.extension={type:ExtensionType.RendererSystem,name:"objectRenderer"};extensions$1.add(ObjectRendererSystem);const _Renderer=class extends SystemManager{constructor(n){super(),n=Object.assign({},settings$1.RENDER_OPTIONS,n),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:_Renderer.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in n&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),n.premultipliedAlpha=n.useContextAlpha&&n.useContextAlpha!=="notMultiplied",n.backgroundAlpha=n.useContextAlpha===!1?1:n.backgroundAlpha);const e={hello:n.hello,_plugin:_Renderer.__plugins,background:{alpha:n.backgroundAlpha,color:n.background??n.backgroundColor,clearBeforeRender:n.clearBeforeRender},_view:{height:n.height,width:n.width,autoDensity:n.autoDensity,resolution:n.resolution,view:n.view},context:{antialias:n.antialias,context:n.context,powerPreference:n.powerPreference,premultipliedAlpha:n.premultipliedAlpha,preserveDrawingBuffer:n.preserveDrawingBuffer}};this.startup.run(e),this.options=n}static test(n){return n!=null&&n.forceCanvas?!1:isWebGLSupported()}render(n,t){this.objectRenderer.render(n,t)}resize(n,t){this._view.resizeView(n,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(n=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:n}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(n){this._view.resolution=n,this.runners.resolutionChange.emit(n)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(n){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=n}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(n){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=n}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(n,t){return this.textureGenerator.generateTexture(n,t)}};let Renderer=_Renderer;Renderer.extension={type:ExtensionType.Renderer,priority:1};Renderer.__plugins={};Renderer.__systems={};extensions$1.handleByMap(ExtensionType.RendererPlugin,Renderer.__plugins);extensions$1.handleByMap(ExtensionType.RendererSystem,Renderer.__systems);extensions$1.add(Renderer);class AbstractMultiResource extends Resource{constructor(t,e){const{width:s,height:r}=e||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let a=0;a<t;a++){const h=new BaseTexture;this.items.push(h),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof Resource?this.addResourceAt(t[s],s):this.addResourceAt(autoDetectResource(t[s],e),s))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(e).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class ArrayResource extends AbstractMultiResource{constructor(t,e){const{width:s,height:r}=e||{};let a,h;Array.isArray(t)?(a=t,h=t.length):h=t,super(h,{width:s,height:r}),a&&this.initFromArray(a,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=TARGETS.TEXTURE_2D_ARRAY}upload(t,e,s){const{length:r,itemDirtyIds:a,items:h}=this,{gl:c}=t;s.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,e.format,s.type,null);for(let o=0;o<r;o++){const u=h[o];a[o]<u.dirtyId&&(a[o]=u.dirtyId,u.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,o,u.resource.width,u.resource.height,1,e.format,s.type,u.resource.source))}return!0}}class CanvasResource extends BaseImageResource{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const _CubeResource=class extends AbstractMultiResource{constructor(n,t){const{width:e,height:s,autoLoad:r,linkBaseTexture:a}=t||{};if(n&&n.length!==_CubeResource.SIDES)throw new Error(`Invalid length. Got ${n.length}, expected 6`);super(6,{width:e,height:s});for(let h=0;h<_CubeResource.SIDES;h++)this.items[h].target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=a!==!1,n&&this.initFromArray(n,t),r!==!1&&this.load()}bind(n){super.bind(n),n.target=TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(n,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||n.parentTextureArray||Object.keys(n._glTextures).length>0)if(n.resource)this.addResourceAt(n.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else n.target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.parentTextureArray=this.baseTexture,this.items[t]=n;return n.valid&&!this.valid&&this.resize(n.realWidth,n.realHeight),this.items[t]=n,this}upload(n,t,e){const s=this.itemDirtyIds;for(let r=0;r<_CubeResource.SIDES;r++){const a=this.items[r];(s[r]<a.dirtyId||e.dirtyId<t.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(n,a,e),s[r]=a.dirtyId):s[r]<-1&&(n.gl.texImage2D(a.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),s[r]=-1))}return!0}static test(n){return Array.isArray(n)&&n.length===_CubeResource.SIDES}};let CubeResource=_CubeResource;CubeResource.SIDES=6;class ImageBitmapResource extends BaseImageResource{constructor(t,e){e=e||{};let s,r;typeof t=="string"?(s=ImageBitmapResource.EMPTY,r=t):(s=t,r=null),super(s),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const s=await settings$1.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const a=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=a,this.update(),t(this)}catch(s){if(this.destroyed)return;e(s),this.onError.emit(s)}}),this._load)}upload(t,e,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??settings$1.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}}const _SVGResource=class extends BaseImageResource{constructor(n,t){t=t||{},super(settings$1.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=n,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(n=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),n(this)},_SVGResource.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const n=new Image;BaseImageResource.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=t=>{this._resolve&&(n.onerror=null,this.onError.emit(t))},n.onload=()=>{if(!this._resolve)return;const t=n.width,e=n.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),s=Math.round(s),r=Math.round(r);const a=this.source;a.width=s,a.height=r,a._pixiId=`canvas_${uid()}`,a.getContext("2d").drawImage(n,0,0,t,e,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(n){const t=_SVGResource.SVG_SIZE.exec(n),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(n,t){return t==="svg"||typeof n=="string"&&n.startsWith("data:image/svg+xml")||typeof n=="string"&&_SVGResource.SVG_XML.test(n)}};let SVGResource=_SVGResource;SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const _VideoResource=class extends BaseImageResource{constructor(n,t){if(t=t||{},!(n instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof n=="string"&&(n=[n]);const s=n[0].src||n[0];BaseImageResource.crossOrigin(e,s,t.crossorigin);for(let r=0;r<n.length;++r){const a=document.createElement("source");let{src:h,mime:c}=n[r];h=h||n[r];const o=h.split("?").shift().toLowerCase(),u=o.slice(o.lastIndexOf(".")+1);c=c||_VideoResource.MIME_TYPES[u]||`video/${u}`,a.src=h,a.type=c,e.appendChild(a)}n=e}super(n),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(n=0){if(!this.destroyed){const t=Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const n=this.source;return(n.readyState===n.HAVE_ENOUGH_DATA||n.readyState===n.HAVE_FUTURE_DATA)&&n.width&&n.height&&(n.complete=!0),n.addEventListener("play",this._onPlayStart.bind(this)),n.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(n.addEventListener("canplay",this._onCanPlay),n.addEventListener("canplaythrough",this._onCanPlay),n.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,n.load())}),this._load}_onError(n){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(n)}_isSourcePlaying(){const n=this.source;return!n.paused&&!n.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const n=this.source;n.removeEventListener("canplay",this._onCanPlay),n.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(n.videoWidth,n.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&n.play()}dispose(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1);const n=this.source;n&&(n.removeEventListener("error",this._onError,!0),n.pause(),n.src="",n.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(n){n!==this._autoUpdate&&(this._autoUpdate=n,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(n){n!==this._updateFPS&&(this._updateFPS=n)}static test(n,t){return globalThis.HTMLVideoElement&&n instanceof HTMLVideoElement||_VideoResource.TYPES.includes(t)}};let VideoResource=_VideoResource;VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};INSTALLED.push(ImageBitmapResource,ImageResource,CanvasResource,VideoResource,SVGResource,BufferResource,CubeResource,ArrayResource);function filterFromString(n){switch(n.toLowerCase()){case"nearest":return TextureFilter.Nearest;case"linear":return TextureFilter.Linear;case"mipmap":return TextureFilter.MipMap;case"mipmapnearestnearest":return TextureFilter.MipMapNearestNearest;case"mipmaplinearnearest":return TextureFilter.MipMapLinearNearest;case"mipmapnearestlinear":return TextureFilter.MipMapNearestLinear;case"mipmaplinearlinear":return TextureFilter.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${n}`)}}var TextureFilter=(n=>(n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",n))(TextureFilter||{}),TextureWrap=(n=>(n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat",n))(TextureWrap||{});class TextureRegion{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class RegionFields{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class TextureAtlas{constructor(t,e,s){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,s)}addTexture(t,e){const s=this.pages;let r=null;for(let h=0;h<s.length;h++)if(s[h].baseTexture===e.baseTexture){r=s[h];break}if(r===null){r=new TextureAtlasPage,r.name="texturePage";const h=e.baseTexture;r.width=h.realWidth,r.height=h.realHeight,r.baseTexture=h,r.minFilter=r.magFilter=TextureFilter.Nearest,r.uWrap=TextureWrap.ClampToEdge,r.vWrap=TextureWrap.ClampToEdge,s.push(r)}const a=new TextureAtlasRegion;return a.name=t,a.page=r,a.texture=e,a.index=-1,this.regions.push(a),a}addTextureHash(t,e){for(const s in t)t.hasOwnProperty(s)&&this.addTexture(e&&s.indexOf(".")!==-1?s.substr(0,s.lastIndexOf(".")):s,t[s])}addSpineAtlas(t,e,s){return this.load(t,e,s)}load(t,e,s){if(e==null)throw new Error("textureLoader cannot be null.");const r=new TextureAtlasReader(t),a=new Array(4);let h=null;const c={};let o=null;c.size=()=>{h.width=parseInt(a[1]),h.height=parseInt(a[2])},c.format=()=>{},c.filter=()=>{h.minFilter=filterFromString(a[1]),h.magFilter=filterFromString(a[2])},c.repeat=()=>{a[1].indexOf("x")!=-1&&(h.uWrap=TextureWrap.Repeat),a[1].indexOf("y")!=-1&&(h.vWrap=TextureWrap.Repeat)},c.pma=()=>{h.pma=a[1]=="true"};const u={};u.xy=()=>{o.x=parseInt(a[1]),o.y=parseInt(a[2])},u.size=()=>{o.width=parseInt(a[1]),o.height=parseInt(a[2])},u.bounds=()=>{o.x=parseInt(a[1]),o.y=parseInt(a[2]),o.width=parseInt(a[3]),o.height=parseInt(a[4])},u.offset=()=>{o.offsetX=parseInt(a[1]),o.offsetY=parseInt(a[2])},u.orig=()=>{o.originalWidth=parseInt(a[1]),o.originalHeight=parseInt(a[2])},u.offsets=()=>{o.offsetX=parseInt(a[1]),o.offsetY=parseInt(a[2]),o.originalWidth=parseInt(a[3]),o.originalHeight=parseInt(a[4])},u.rotate=()=>{const p=a[1];let g=0;p.toLocaleLowerCase()=="true"?g=6:p.toLocaleLowerCase()=="false"?g=0:g=(720-parseFloat(p))%360/45,o.rotate=g},u.index=()=>{o.index=parseInt(a[1])};let d=r.readLine();for(;d!=null&&d.trim().length==0;)d=r.readLine();for(;!(d==null||d.trim().length==0||r.readEntry(a,d)==0);)d=r.readLine();const m=()=>{for(;;){if(d==null)return s&&s(this);if(d.trim().length==0)h=null,d=r.readLine();else if(h===null){for(h=new TextureAtlasPage,h.name=d.trim();r.readEntry(a,d=r.readLine())!=0;){const p=c[a[0]];p&&p()}this.pages.push(h),e(h.name,p=>{if(p===null)return this.pages.splice(this.pages.indexOf(h),1),s&&s(null);h.baseTexture=p,h.pma&&(p.alphaMode=ALPHA_MODES.PMA),p.valid||p.setSize(h.width,h.height),h.setFilters(),(!h.width||!h.height)&&(h.width=p.realWidth,h.height=p.realHeight,(!h.width||!h.height)&&console.log(`ERROR spine atlas page ${h.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),m()});break}else{o=new RegionFields;const p=new TextureAtlasRegion;p.name=d,p.page=h;let g=null,_=null;for(;;){const N=r.readEntry(a,d=r.readLine());if(N==0)break;const W=u[a[0]];if(W)W();else{g==null&&(g=[],_=[]),g.push(a[0]);const et=[];for(let it=0;it<N;it++)et.push(parseInt(a[it+1]));_.push(et)}}o.originalWidth==0&&o.originalHeight==0&&(o.originalWidth=o.width,o.originalHeight=o.height);const y=h.baseTexture.resolution;o.x/=y,o.y/=y,o.width/=y,o.height/=y,o.originalWidth/=y,o.originalHeight/=y,o.offsetX/=y,o.offsetY/=y;const v=o.rotate%4!==0,U=new Rectangle(o.x,o.y,v?o.height:o.width,v?o.width:o.height),w=new Rectangle(0,0,o.originalWidth,o.originalHeight),k=new Rectangle(o.offsetX,o.originalHeight-o.height-o.offsetY,o.width,o.height);p.texture=new Texture(p.page.baseTexture,U,w,k,o.rotate),p.index=o.index,p.texture.updateUvs(),this.regions.push(p)}}};m()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class TextureAtlasReader{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;const s=e.indexOf(":");if(s==-1)return 0;t[0]=e.substr(0,s).trim();for(let r=1,a=s+1;;r++){const h=e.indexOf(",",a);if(h==-1)return t[r]=e.substr(a).trim(),r;if(t[r]=e.substr(a,h-a).trim(),a=h+1,r==4)return 4}}}class TextureAtlasPage{constructor(){this.minFilter=TextureFilter.Nearest,this.magFilter=TextureFilter.Nearest,this.uWrap=TextureWrap.ClampToEdge,this.vWrap=TextureWrap.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==TextureFilter.Linear?t.scaleMode=SCALE_MODES.LINEAR:this.minFilter==TextureFilter.Nearest?t.scaleMode=SCALE_MODES.NEAREST:(t.mipmap=MIPMAP_MODES.POW2,e==TextureFilter.MipMapNearestNearest?t.scaleMode=SCALE_MODES.NEAREST:t.scaleMode=SCALE_MODES.LINEAR)}}class TextureAtlasRegion extends TextureRegion{}class IntSet{constructor(){this.array=new Array}add(t){const e=this.contains(t);return this.array[t|0]=t|0,!e}contains(t){return this.array[t|0]!=null}remove(t){this.array[t|0]=void 0}clear(){this.array.length=0}}class StringSet{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){const e=this.size;for(let s=0,r=t.length;s<r;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const _Color=class{constructor(n=0,t=0,e=0,s=0){this.r=n,this.g=t,this.b=e,this.a=s}set(n,t,e,s){return this.r=n,this.g=t,this.b=e,this.a=s,this.clamp()}setFromColor(n){return this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this}setFromString(n){return n=n.charAt(0)=="#"?n.substr(1):n,this.r=parseInt(n.substr(0,2),16)/255,this.g=parseInt(n.substr(2,2),16)/255,this.b=parseInt(n.substr(4,2),16)/255,this.a=n.length!=8?1:parseInt(n.substr(6,2),16)/255,this}add(n,t,e,s){return this.r+=n,this.g+=t,this.b+=e,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(n,t){n.r=((t&4278190080)>>>24)/255,n.g=((t&16711680)>>>16)/255,n.b=((t&65280)>>>8)/255,n.a=(t&255)/255}static rgb888ToColor(n,t){n.r=((t&16711680)>>>16)/255,n.g=((t&65280)>>>8)/255,n.b=(t&255)/255}static fromString(n){return new _Color().setFromString(n)}};let Color=_Color;Color.WHITE=new _Color(1,1,1,1);Color.RED=new _Color(1,0,0,1);Color.GREEN=new _Color(0,1,0,1);Color.BLUE=new _Color(0,0,1,1);Color.MAGENTA=new _Color(1,0,1,1);const _MathUtils=class{static clamp(n,t,e){return n<t?t:n>e?e:n}static cosDeg(n){return Math.cos(n*_MathUtils.degRad)}static sinDeg(n){return Math.sin(n*_MathUtils.degRad)}static signum(n){return Math.sign(n)}static toInt(n){return n>0?Math.floor(n):Math.ceil(n)}static cbrt(n){const t=Math.pow(Math.abs(n),.3333333333333333);return n<0?-t:t}static randomTriangular(n,t){return _MathUtils.randomTriangularWith(n,t,(n+t)*.5)}static randomTriangularWith(n,t,e){const s=Math.random(),r=t-n;return s<=(e-n)/r?n+Math.sqrt(s*r*(e-n)):t-Math.sqrt((1-s)*r*(t-e))}static isPowerOfTwo(n){return n&&(n&n-1)===0}};let MathUtils=_MathUtils;MathUtils.PI=3.1415927;MathUtils.PI2=_MathUtils.PI*2;MathUtils.radiansToDegrees=180/_MathUtils.PI;MathUtils.radDeg=_MathUtils.radiansToDegrees;MathUtils.degreesToRadians=_MathUtils.PI/180;MathUtils.degRad=_MathUtils.degreesToRadians;let Interpolation$1=class{apply(t,e,s){return t+(e-t)*this.applyInternal(s)}};class Pow extends Interpolation$1{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(t*2,this.power)/2:Math.pow((t-1)*2,this.power)/(this.power%2==0?-2:2)+1}}class PowOut extends Pow{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}}const _Utils=class{static arrayCopy(n,t,e,s,r){for(let a=t,h=s;a<t+r;a++,h++)e[h]=n[a]}static arrayFill(n,t,e,s){for(let r=t;r<e;r++)n[r]=s}static setArraySize(n,t,e=0){const s=n.length;if(s==t)return n;if(n.length=t,s<t)for(let r=s;r<t;r++)n[r]=e;return n}static ensureArrayCapacity(n,t,e=0){return n.length>=t?n:_Utils.setArraySize(n,t,e)}static newArray(n,t){const e=new Array(n);for(let s=0;s<n;s++)e[s]=t;return e}static newFloatArray(n){if(_Utils.SUPPORTS_TYPED_ARRAYS)return new Float32Array(n);const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=0;return t}static newShortArray(n){if(_Utils.SUPPORTS_TYPED_ARRAYS)return new Int16Array(n);const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=0;return t}static toFloatArray(n){return _Utils.SUPPORTS_TYPED_ARRAYS?new Float32Array(n):n}static toSinglePrecision(n){return _Utils.SUPPORTS_TYPED_ARRAYS?Math.fround(n):n}static webkit602BugfixHelper(n,t){}static contains(n,t,e=!0){for(let s=0;s<n.length;s++)if(n[s]==t)return!0;return!1}static enumValue(n,t){return n[t[0].toUpperCase()+t.slice(1)]}};let Utils=_Utils;Utils.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";let Pool$1=class{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}};class Vector2{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class SkeletonBoundsBase{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new Pool$1(()=>Utils.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");const s=this.boundingBoxes,r=this.polygons,a=this.polygonPool,h=t.slots,c=h.length;s.length=0,a.freeAll(r),r.length=0;for(let o=0;o<c;o++){const u=h[o];if(!u.bone.active)continue;const d=u.getAttachment();if(d!=null&&d.type===AttachmentType.BoundingBox){const m=d;s.push(m);let p=a.obtain();p.length!=m.worldVerticesLength&&(p=Utils.newFloatArray(m.worldVerticesLength)),r.push(p),m.computeWorldVertices(u,0,m.worldVerticesLength,p,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const a=this.polygons;for(let h=0,c=a.length;h<c;h++){const o=a[h],u=o;for(let d=0,m=o.length;d<m;d+=2){const p=u[d],g=u[d+1];t=Math.min(t,p),e=Math.min(e,g),s=Math.max(s,p),r=Math.max(r,g)}}this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,r){const a=this.minX,h=this.minY,c=this.maxX,o=this.maxY;if(t<=a&&s<=a||e<=h&&r<=h||t>=c&&s>=c||e>=o&&r>=o)return!1;const u=(r-e)/(s-t);let d=u*(a-t)+e;if(d>h&&d<o||(d=u*(c-t)+e,d>h&&d<o))return!0;let m=(h-e)/u+t;return m>a&&m<c||(m=(o-e)/u+t,m>a&&m<c)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){const s=this.polygons;for(let r=0,a=s.length;r<a;r++)if(this.containsPointPolygon(s[r],t,e))return this.boundingBoxes[r];return null}containsPointPolygon(t,e,s){const r=t,a=t.length;let h=a-2,c=!1;for(let o=0;o<a;o+=2){const u=r[o+1],d=r[h+1];if(u<s&&d>=s||d<s&&u>=s){const m=r[o];m+(s-u)/(d-u)*(r[h]-m)<e&&(c=!c)}h=o}return c}intersectsSegment(t,e,s,r){const a=this.polygons;for(let h=0,c=a.length;h<c;h++)if(this.intersectsSegmentPolygon(a[h],t,e,s,r))return this.boundingBoxes[h];return null}intersectsSegmentPolygon(t,e,s,r,a){const h=t,c=t.length,o=e-r,u=s-a,d=e*a-s*r;let m=h[c-2],p=h[c-1];for(let g=0;g<c;g+=2){const _=h[g],y=h[g+1],v=m*y-p*_,U=m-_,w=p-y,k=o*w-u*U,N=(d*U-o*v)/k;if((N>=m&&N<=_||N>=_&&N<=m)&&(N>=e&&N<=r||N>=r&&N<=e)){const W=(d*w-u*v)/k;if((W>=p&&W<=y||W>=y&&W<=p)&&(W>=s&&W<=a||W>=a&&W<=s))return!0}m=_,p=y}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");const e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}const settings={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0};class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:(t=t||new Rectangle(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:s,b:r,c:a,d:h,tx:c,ty:o}=t,u=s*e.x+a*e.y+c,d=r*e.x+h*e.y+o;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let e=this.minX,s=this.minY,r=this.maxX,a=this.maxY,h=t[0],c=t[1];e=h<e?h:e,s=c<s?c:s,r=h>r?h:r,a=c>a?c:a,h=t[2],c=t[3],e=h<e?h:e,s=c<s?c:s,r=h>r?h:r,a=c>a?c:a,h=t[4],c=t[5],e=h<e?h:e,s=c<s?c:s,r=h>r?h:r,a=c>a?c:a,h=t[6],c=t[7],e=h<e?h:e,s=c<s?c:s,r=h>r?h:r,a=c>a?c:a,this.minX=e,this.minY=s,this.maxX=r,this.maxY=a}addFrame(t,e,s,r,a){this.addFrameMatrix(t.worldTransform,e,s,r,a)}addFrameMatrix(t,e,s,r,a){const h=t.a,c=t.b,o=t.c,u=t.d,d=t.tx,m=t.ty;let p=this.minX,g=this.minY,_=this.maxX,y=this.maxY,v=h*e+o*s+d,U=c*e+u*s+m;p=v<p?v:p,g=U<g?U:g,_=v>_?v:_,y=U>y?U:y,v=h*r+o*s+d,U=c*r+u*s+m,p=v<p?v:p,g=U<g?U:g,_=v>_?v:_,y=U>y?U:y,v=h*e+o*a+d,U=c*e+u*a+m,p=v<p?v:p,g=U<g?U:g,_=v>_?v:_,y=U>y?U:y,v=h*r+o*a+d,U=c*r+u*a+m,p=v<p?v:p,g=U<g?U:g,_=v>_?v:_,y=U>y?U:y,this.minX=p,this.minY=g,this.maxX=_,this.maxY=y}addVertexData(t,e,s){let r=this.minX,a=this.minY,h=this.maxX,c=this.maxY;for(let o=e;o<s;o+=2){const u=t[o],d=t[o+1];r=u<r?u:r,a=d<a?d:a,h=u>h?u:h,c=d>c?d:c}this.minX=r,this.minY=a,this.maxX=h,this.maxY=c}addVertices(t,e,s,r){this.addVerticesMatrix(t.worldTransform,e,s,r)}addVerticesMatrix(t,e,s,r,a=0,h=a){const c=t.a,o=t.b,u=t.c,d=t.d,m=t.tx,p=t.ty;let g=this.minX,_=this.minY,y=this.maxX,v=this.maxY;for(let U=s;U<r;U+=2){const w=e[U],k=e[U+1],N=c*w+u*k+m,W=d*k+o*w+p;g=Math.min(g,N-a),y=Math.max(y,N+a),_=Math.min(_,W-h),v=Math.max(v,W+h)}this.minX=g,this.minY=_,this.maxX=y,this.maxY=v}addBounds(t){const e=this.minX,s=this.minY,r=this.maxX,a=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>a?t.maxY:a}addBoundsMask(t,e){const s=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,a=t.maxX<e.maxX?t.maxX:e.maxX,h=t.maxY<e.maxY?t.maxY:e.maxY;if(s<=a&&r<=h){const c=this.minX,o=this.minY,u=this.maxX,d=this.maxY;this.minX=s<c?s:c,this.minY=r<o?r:o,this.maxX=a>u?a:u,this.maxY=h>d?h:d}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const s=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,a=t.maxX<e.x+e.width?t.maxX:e.x+e.width,h=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(s<=a&&r<=h){const c=this.minX,o=this.minY,u=this.maxX,d=this.maxY;this.minX=s<c?s:c,this.minY=r<o?r:o,this.maxX=a>u?a:u,this.maxY=h>d?h:d}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,s,r,a,h){t-=a,e-=h,s+=a,r+=h,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class DisplayObject extends eventemitter3Exports{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let s=0;s<e.length;++s){const r=e[s];Object.defineProperty(DisplayObject.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);const e=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const h=this.getBounds(!1,t);return this.parent=s,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-a,h}toGlobal(t,e,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,s,r){return e&&(t=e.toGlobal(t,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,s=1,r=1,a=0,h=0,c=0,o=0,u=0){return this.position.x=t,this.position.y=e,this.scale.x=s||1,this.scale.y=r||1,this.rotation=a,this.skew.x=h,this.skew.y=c,this.pivot.x=o,this.pivot.y=u,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*RAD_TO_DEG}set angle(t){this.transform.rotation=t*DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;const tempMatrix=new Matrix;function sortChildren(n,t){return n.zIndex===t.zIndex?n._lastSortedIndex-t._lastSortedIndex:n.zIndex-t.zIndex}const _Container=class extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=_Container.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(n){}addChild(...n){if(n.length>1)for(let t=0;t<n.length;t++)this.addChild(n[t]);else{const t=n[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return n[0]}addChildAt(n,t){if(t<0||t>this.children.length)throw new Error(`${n}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.splice(t,0,n),this._boundsID++,this.onChildrenChange(t),n.emit("added",this),this.emit("childAdded",n,this,t),n}swapChildren(n,t){if(n===t)return;const e=this.getChildIndex(n),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=n,this.onChildrenChange(e<s?e:s)}getChildIndex(n){const t=this.children.indexOf(n);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(n,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(n);removeItems(this.children,e,1),this.children.splice(t,0,n),this.onChildrenChange(t)}getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]}removeChild(...n){if(n.length>1)for(let t=0;t<n.length;t++)this.removeChild(n[t]);else{const t=n[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return n[0]}removeChildAt(n){const t=this.getChildAt(n);return t.parent=null,t.transform._parentID=-1,removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n),t}removeChildren(n=0,t=this.children.length){const e=n,s=t,r=s-e;let a;if(r>0&&r<=s){a=this.children.splice(e,r);for(let h=0;h<a.length;++h)a[h].parent=null,a[h].transform&&(a[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(n);for(let h=0;h<a.length;++h)a[h].emit("removed",this),this.emit("childRemoved",a[h],this,h);return a}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let n=!1;for(let t=0,e=this.children.length;t<e;++t){const s=this.children[t];s._lastSortedIndex=t,!n&&s.zIndex!==0&&(n=!0)}n&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let n=0,t=this.children.length;n<t;++n){const e=this.children[n];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let n=0;n<this.children.length;n++){const t=this.children[n];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(n,t=!1){const e=super.getLocalBounds(n);if(!t)for(let s=0,r=this.children.length;s<r;++s){const a=this.children[s];a.visible&&a.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(n){const t=n.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,s;this.cullArea?(e=this.cullArea,s=this.worldTransform):this._render!==_Container.prototype._render&&(e=this.getBounds(!0));const r=n.projection.transform;if(r&&(s?(s=tempMatrix.copyFrom(s),s.prepend(r)):s=r),e&&t.intersects(e,s))this._render(n);else if(this.cullArea)return;for(let a=0,h=this.children.length;a<h;++a){const c=this.children[a],o=c.cullable;c.cullable=o||!this.cullArea,c.render(n),c.cullable=o}}render(n){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(n);else if(this.cullable)this._renderWithCulling(n);else{this._render(n);for(let e=0,s=this.children.length;e<s;++e)this.children[e].render(n)}}renderAdvanced(n){var r,a,h;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let c=0;c<t.length;c++)t[c].enabled&&this._enabledFilters.push(t[c])}const s=t&&((r=this._enabledFilters)==null?void 0:r.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==MASK_TYPES.NONE));if(s&&n.batch.flush(),t&&((a=this._enabledFilters)!=null&&a.length)&&n.filter.push(this,this._enabledFilters),e&&n.mask.push(this,this._mask),this.cullable)this._renderWithCulling(n);else{this._render(n);for(let c=0,o=this.children.length;c<o;++c)this.children[c].render(n)}s&&n.batch.flush(),e&&n.mask.pop(this),t&&((h=this._enabledFilters)!=null&&h.length)&&n.filter.pop()}_render(n){}destroy(n){super.destroy(),this.sortDirty=!1;const t=typeof n=="boolean"?n:n==null?void 0:n.children,e=this.removeChildren(0,this.children.length);if(t)for(let s=0;s<e.length;++s)e[s].destroy(n)}get width(){return this.scale.x*this.getLocalBounds().width}set width(n){const t=this.getLocalBounds().width;t!==0?this.scale.x=n/t:this.scale.x=1,this._width=n}get height(){return this.scale.y*this.getLocalBounds().height}set height(n){const t=this.getLocalBounds().height;t!==0?this.scale.y=n/t:this.scale.y=1,this._height=n}};let Container=_Container;Container.defaultSortableChildren=!1;Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;Object.defineProperties(settings$1,{SORTABLE_CHILDREN:{get(){return Container.defaultSortableChildren},set(n){deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Container.defaultSortableChildren=n}}});const tempPoint$1=new Point,indices=new Uint16Array([0,1,2,0,2,3]);class Sprite extends Container{constructor(t){super(),this._anchor=new ObservablePoint(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=indices,this.pluginName="batch",this.isSprite=!0,this._roundPixels=settings$1.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,s=e.a,r=e.b,a=e.c,h=e.d,c=e.tx,o=e.ty,u=this.vertexData,d=t.trim,m=t.orig,p=this._anchor;let g=0,_=0,y=0,v=0;if(d?(_=d.x-p._x*m.width,g=_+d.width,v=d.y-p._y*m.height,y=v+d.height):(_=-p._x*m.width,g=_+m.width,v=-p._y*m.height,y=v+m.height),u[0]=s*_+a*v+c,u[1]=h*v+r*_+o,u[2]=s*g+a*v+c,u[3]=h*v+r*g+o,u[4]=s*g+a*y+c,u[5]=h*y+r*g+o,u[6]=s*_+a*y+c,u[7]=h*y+r*_+o,this._roundPixels){const U=settings$1.RESOLUTION;for(let w=0;w<u.length;++w)u[w]=Math.round(u[w]*U)/U}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,s=t.orig,r=this._anchor,a=this.transform.worldTransform,h=a.a,c=a.b,o=a.c,u=a.d,d=a.tx,m=a.ty,p=-r._x*s.width,g=p+s.width,_=-r._y*s.height,y=_+s.height;e[0]=h*p+o*_+d,e[1]=u*_+c*p+m,e[2]=h*g+o*_+d,e[3]=u*_+c*g+m,e[4]=h*g+o*y+d,e[5]=u*y+c*g+m,e[6]=h*p+o*y+d,e[7]=u*y+c*p+m}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,tempPoint$1);const e=this._texture.orig.width,s=this._texture.orig.height,r=-e*this.anchor.x;let a=0;return tempPoint$1.x>=r&&tempPoint$1.x<r+e&&(a=-s*this.anchor.y,tempPoint$1.y>=a&&tempPoint$1.y<a+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(t,e){const s=t instanceof Texture?t:Texture.from(t,e);return new Sprite(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}class MeshBatchUvs{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const tempPoint=new Point,tempPolygon=new Polygon,_Mesh=class extends Container{constructor(n,t,e,s=DRAW_MODES.TRIANGLES){super(),this.geometry=n,this.shader=t,this.state=e||State$1.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=settings$1.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(n){this._geometry!==n&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=n,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(n){this.shader=n}get material(){return this.shader}set blendMode(n){this.state.blendMode=n}get blendMode(){return this.state.blendMode}set roundPixels(n){this._roundPixels!==n&&(this._transformID=-1),this._roundPixels=n}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(n){this.shader.tint=n}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(n){this.shader.texture=n}_render(n){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES.TRIANGLES&&t.length<_Mesh.BATCHABLE_SIZE*2?this._renderToBatch(n):this._renderDefault(n)}_renderDefault(n){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),n.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),n.shader.bind(t),n.state.set(this.state),n.geometry.bind(this.geometry,t),n.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(n){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const s=this.material.pluginName;n.batch.setObjectRenderer(n.plugins[s]),n.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,s=t._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,a=r.a,h=r.b,c=r.c,o=r.d,u=r.tx,d=r.ty,m=this.vertexData;for(let p=0;p<m.length/2;p++){const g=e[p*2],_=e[p*2+1];m[p*2]=a*g+c*_+u,m[p*2+1]=h*g+o*_+d}if(this._roundPixels){const p=settings$1.RESOLUTION;for(let g=0;g<m.length;++g)m[g]=Math.round(m[g]*p)/p}this.vertexDirty=s}calculateUvs(){const n=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=n.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(n,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(n){if(!this.getBounds().contains(n.x,n.y))return!1;this.worldTransform.applyInverse(n,tempPoint);const t=this.geometry.getBuffer("aVertexPosition").data,e=tempPolygon.points,s=this.geometry.getIndex().data,r=s.length,a=this.drawMode===4?3:1;for(let h=0;h+2<r;h+=a){const c=s[h]*2,o=s[h+1]*2,u=s[h+2]*2;if(e[0]=t[c],e[1]=t[c+1],e[2]=t[o],e[3]=t[o+1],e[4]=t[u],e[5]=t[u+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}return!1}destroy(n){super.destroy(n),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Mesh=_Mesh;Mesh.BATCHABLE_SIZE=100;class MeshGeometry extends Geometry{constructor(t,e,s){super();const r=new Buffer(t),a=new Buffer(e,!0),h=new Buffer(s,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",a,2,!1,TYPES.FLOAT).addIndex(h),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fragment$6=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class MeshMaterial extends Shader{constructor(t,e){const s={uSampler:t,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(s,e.uniforms),super(e.program||Program.from(vertex$3,fragment$6),s),this._colorDirty=!1,this.uvMatrix=new TextureMatrix(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class PlaneGeometry extends MeshGeometry{constructor(t=100,e=100,s=10,r=10){super(),this.segWidth=s,this.segHeight=r,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],s=[],r=[],a=this.segWidth-1,h=this.segHeight-1,c=this.width/a,o=this.height/h;for(let d=0;d<t;d++){const m=d%this.segWidth,p=d/this.segWidth|0;e.push(m*c,p*o),s.push(m/a,p/h)}const u=a*h;for(let d=0;d<u;d++){const m=d%a,p=d/a|0,g=p*this.segWidth+m,_=p*this.segWidth+m+1,y=(p+1)*this.segWidth+m,v=(p+1)*this.segWidth+m+1;r.push(g,_,y,_,v,y)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class SimplePlane extends Mesh{constructor(t,e,s){const r=new PlaneGeometry(t.width,t.height,e,s),a=new MeshMaterial(Texture.WHITE);super(r,a),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:s}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==s)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const DEFAULT_BORDER_SIZE=10;class NineSlicePlane extends SimplePlane{constructor(t,e=DEFAULT_BORDER_SIZE,s=DEFAULT_BORDER_SIZE,r=DEFAULT_BORDER_SIZE,a=DEFAULT_BORDER_SIZE){super(Texture.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e,this._rightWidth=r,this._topHeight=s,this._bottomHeight=a,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,s=this._topHeight+this._bottomHeight,r=this._height>s?1:this._height/s;return Math.min(e,r)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const s=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=s*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-s*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class SimpleMesh extends Mesh{constructor(t=Texture.EMPTY,e,s,r,a){const h=new MeshGeometry(e,s,r);h.getBuffer("aVertexPosition").static=!1;const c=new MeshMaterial(t);super(h,c,null,a),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}const buildCircle={build(n){const t=n.points;let e,s,r,a,h,c;if(n.type===SHAPES.CIRC){const _=n.shape;e=_.x,s=_.y,h=c=_.radius,r=a=0}else if(n.type===SHAPES.ELIP){const _=n.shape;e=_.x,s=_.y,h=_.width,c=_.height,r=a=0}else{const _=n.shape,y=_.width/2,v=_.height/2;e=_.x+y,s=_.y+v,h=c=Math.max(0,Math.min(_.radius,Math.min(y,v))),r=y-h,a=v-c}if(!(h>=0&&c>=0&&r>=0&&a>=0)){t.length=0;return}const o=Math.ceil(2.3*Math.sqrt(h+c)),u=o*8+(r?4:0)+(a?4:0);if(t.length=u,u===0)return;if(o===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=s+a,t[2]=t[4]=e-r,t[5]=t[7]=s-a;return}let d=0,m=o*4+(r?2:0)+2,p=m,g=u;{const _=r+h,y=a,v=e+_,U=e-_,w=s+y;if(t[d++]=v,t[d++]=w,t[--m]=w,t[--m]=U,a){const k=s-y;t[p++]=U,t[p++]=k,t[--g]=k,t[--g]=v}}for(let _=1;_<o;_++){const y=Math.PI/2*(_/o),v=r+Math.cos(y)*h,U=a+Math.sin(y)*c,w=e+v,k=e-v,N=s+U,W=s-U;t[d++]=w,t[d++]=N,t[--m]=N,t[--m]=k,t[p++]=k,t[p++]=W,t[--g]=W,t[--g]=w}{const _=r,y=a+c,v=e+_,U=e-_,w=s+y,k=s-y;t[d++]=v,t[d++]=w,t[--g]=k,t[--g]=v,r&&(t[d++]=U,t[d++]=w,t[--g]=k,t[--g]=U)}},triangulate(n,t){const e=n.points,s=t.points,r=t.indices;if(e.length===0)return;let a=s.length/2;const h=a;let c,o;if(n.type!==SHAPES.RREC){const d=n.shape;c=d.x,o=d.y}else{const d=n.shape;c=d.x+d.width/2,o=d.y+d.height/2}const u=n.matrix;s.push(n.matrix?u.a*c+u.c*o+u.tx:c,n.matrix?u.b*c+u.d*o+u.ty:o),a++,s.push(e[0],e[1]);for(let d=2;d<e.length;d+=2)s.push(e[d],e[d+1]),r.push(a++,h,a);r.push(h+1,h,a)}};function fixOrientation(n,t=!1){const e=n.length;if(e<6)return;let s=0;for(let r=0,a=n[e-2],h=n[e-1];r<e;r+=2){const c=n[r],o=n[r+1];s+=(c-a)*(o+h),a=c,h=o}if(!t&&s>0||t&&s<=0){const r=e/2;for(let a=r+r%2;a<e;a+=2){const h=e-a-2,c=e-a-1,o=a,u=a+1;[n[h],n[o]]=[n[o],n[h]],[n[c],n[u]]=[n[u],n[c]]}}}const buildPoly={build(n){n.points=n.shape.points.slice()},triangulate(n,t){let e=n.points;const s=n.holes,r=t.points,a=t.indices;if(e.length>=6){fixOrientation(e,!1);const h=[];for(let u=0;u<s.length;u++){const d=s[u];fixOrientation(d.points,!0),h.push(e.length/2),e=e.concat(d.points)}const c=earcutExports(e,h,2);if(!c)return;const o=r.length/2;for(let u=0;u<c.length;u+=3)a.push(c[u]+o),a.push(c[u+1]+o),a.push(c[u+2]+o);for(let u=0;u<e.length;u++)r.push(e[u])}}},buildRectangle={build(n){const t=n.shape,e=t.x,s=t.y,r=t.width,a=t.height,h=n.points;h.length=0,r>=0&&a>=0&&h.push(e,s,e+r,s,e+r,s+a,e,s+a)},triangulate(n,t){const e=n.points,s=t.points;if(e.length===0)return;const r=s.length/2;s.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},buildRoundedRectangle={build(n){buildCircle.build(n)},triangulate(n,t){buildCircle.triangulate(n,t)}};var LINE_JOIN=(n=>(n.MITER="miter",n.BEVEL="bevel",n.ROUND="round",n))(LINE_JOIN||{}),LINE_CAP=(n=>(n.BUTT="butt",n.ROUND="round",n.SQUARE="square",n))(LINE_CAP||{});const curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,t=20){if(!this.adaptive||!n||isNaN(n))return t;let e=Math.ceil(n/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class ArcUtils{static curveTo(t,e,s,r,a,h){const c=h[h.length-2],u=h[h.length-1]-e,d=c-t,m=r-e,p=s-t,g=Math.abs(u*p-d*m);if(g<1e-8||a===0)return(h[h.length-2]!==t||h[h.length-1]!==e)&&h.push(t,e),null;const _=u*u+d*d,y=m*m+p*p,v=u*m+d*p,U=a*Math.sqrt(_)/g,w=a*Math.sqrt(y)/g,k=U*v/_,N=w*v/y,W=U*p+w*d,et=U*m+w*u,it=d*(w+k),ft=u*(w+k),mt=p*(U+N),xt=m*(U+N),yt=Math.atan2(ft-et,it-W),vt=Math.atan2(xt-et,mt-W);return{cx:W+t,cy:et+e,radius:a,startAngle:yt,endAngle:vt,anticlockwise:d*m>p*u}}static arc(t,e,s,r,a,h,c,o,u){const d=c-h,m=curves._segmentsCount(Math.abs(d)*a,Math.ceil(Math.abs(d)/PI_2)*40),p=d/(m*2),g=p*2,_=Math.cos(p),y=Math.sin(p),v=m-1,U=v%1/v;for(let w=0;w<=v;++w){const k=w+U*w,N=p+h+g*k,W=Math.cos(N),et=-Math.sin(N);u.push((_*W+y*et)*a+s,(_*-et+y*W)*a+r)}}}class BatchPart{constructor(){this.reset()}begin(t,e,s){this.reset(),this.style=t,this.start=e,this.attribStart=s}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class BezierUtils{static curveLength(t,e,s,r,a,h,c,o){let d=0,m=0,p=0,g=0,_=0,y=0,v=0,U=0,w=0,k=0,N=0,W=t,et=e;for(let it=1;it<=10;++it)m=it/10,p=m*m,g=p*m,_=1-m,y=_*_,v=y*_,U=v*t+3*y*m*s+3*_*p*a+g*c,w=v*e+3*y*m*r+3*_*p*h+g*o,k=W-U,N=et-w,W=U,et=w,d+=Math.sqrt(k*k+N*N);return d}static curveTo(t,e,s,r,a,h,c){const o=c[c.length-2],u=c[c.length-1];c.length-=2;const d=curves._segmentsCount(BezierUtils.curveLength(o,u,t,e,s,r,a,h));let m=0,p=0,g=0,_=0,y=0;c.push(o,u);for(let v=1,U=0;v<=d;++v)U=v/d,m=1-U,p=m*m,g=p*m,_=U*U,y=_*U,c.push(g*o+3*p*U*t+3*m*_*s+y*a,g*u+3*p*U*e+3*m*_*r+y*h)}}function square(n,t,e,s,r,a,h,c){const o=n-e*r,u=t-s*r,d=n+e*a,m=t+s*a;let p,g;h?(p=s,g=-e):(p=-s,g=e);const _=o+p,y=u+g,v=d+p,U=m+g;return c.push(_,y),c.push(v,U),2}function round(n,t,e,s,r,a,h,c){const o=e-n,u=s-t;let d=Math.atan2(o,u),m=Math.atan2(r-n,a-t);c&&d<m?d+=Math.PI*2:!c&&d>m&&(m+=Math.PI*2);let p=d;const g=m-d,_=Math.abs(g),y=Math.sqrt(o*o+u*u),v=(15*_*Math.sqrt(y)/Math.PI>>0)+1,U=g/v;if(p+=U,c){h.push(n,t),h.push(e,s);for(let w=1,k=p;w<v;w++,k+=U)h.push(n,t),h.push(n+Math.sin(k)*y,t+Math.cos(k)*y);h.push(n,t),h.push(r,a)}else{h.push(e,s),h.push(n,t);for(let w=1,k=p;w<v;w++,k+=U)h.push(n+Math.sin(k)*y,t+Math.cos(k)*y),h.push(n,t);h.push(r,a),h.push(n,t)}return v*2}function buildNonNativeLine(n,t){const e=n.shape;let s=n.points||e.points.slice();const r=t.closePointEps;if(s.length===0)return;const a=n.lineStyle,h=new Point(s[0],s[1]),c=new Point(s[s.length-2],s[s.length-1]),o=e.type!==SHAPES.POLY||e.closeStroke,u=Math.abs(h.x-c.x)<r&&Math.abs(h.y-c.y)<r;if(o){s=s.slice(),u&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const Pt=(h.x+c.x)*.5,Xt=(c.y+h.y)*.5;s.unshift(Pt,Xt),s.push(Pt,Xt)}const d=t.points,m=s.length/2;let p=s.length;const g=d.length/2,_=a.width/2,y=_*_,v=a.miterLimit*a.miterLimit;let U=s[0],w=s[1],k=s[2],N=s[3],W=0,et=0,it=-(w-N),ft=U-k,mt=0,xt=0,yt=Math.sqrt(it*it+ft*ft);it/=yt,ft/=yt,it*=_,ft*=_;const vt=a.alignment,St=(1-vt)*2,wt=vt*2;o||(a.cap===LINE_CAP.ROUND?p+=round(U-it*(St-wt)*.5,w-ft*(St-wt)*.5,U-it*St,w-ft*St,U+it*wt,w+ft*wt,d,!0)+2:a.cap===LINE_CAP.SQUARE&&(p+=square(U,w,it,ft,St,wt,!0,d))),d.push(U-it*St,w-ft*St),d.push(U+it*wt,w+ft*wt);for(let Pt=1;Pt<m-1;++Pt){U=s[(Pt-1)*2],w=s[(Pt-1)*2+1],k=s[Pt*2],N=s[Pt*2+1],W=s[(Pt+1)*2],et=s[(Pt+1)*2+1],it=-(w-N),ft=U-k,yt=Math.sqrt(it*it+ft*ft),it/=yt,ft/=yt,it*=_,ft*=_,mt=-(N-et),xt=k-W,yt=Math.sqrt(mt*mt+xt*xt),mt/=yt,xt/=yt,mt*=_,xt*=_;const Xt=k-U,Ut=w-N,Et=k-W,Ft=et-N,Lt=Xt*Et+Ut*Ft,Ht=Ut*Et-Ft*Xt,Wt=Ht<0;if(Math.abs(Ht)<.001*Math.abs(Lt)){d.push(k-it*St,N-ft*St),d.push(k+it*wt,N+ft*wt),Lt>=0&&(a.join===LINE_JOIN.ROUND?p+=round(k,N,k-it*St,N-ft*St,k-mt*St,N-xt*St,d,!1)+4:p+=2,d.push(k-mt*wt,N-xt*wt),d.push(k+mt*St,N+xt*St));continue}const Zt=(-it+U)*(-ft+N)-(-it+k)*(-ft+w),ee=(-mt+W)*(-xt+N)-(-mt+k)*(-xt+et),ne=(Xt*ee-Et*Zt)/Ht,se=(Ft*Zt-Ut*ee)/Ht,Nt=(ne-k)*(ne-k)+(se-N)*(se-N),Yt=k+(ne-k)*St,zt=N+(se-N)*St,te=k-(ne-k)*wt,Qt=N-(se-N)*wt,ie=Math.min(Xt*Xt+Ut*Ut,Et*Et+Ft*Ft),re=Wt?St:wt,le=ie+re*re*y;Nt<=le?a.join===LINE_JOIN.BEVEL||Nt/y>v?(Wt?(d.push(Yt,zt),d.push(k+it*wt,N+ft*wt),d.push(Yt,zt),d.push(k+mt*wt,N+xt*wt)):(d.push(k-it*St,N-ft*St),d.push(te,Qt),d.push(k-mt*St,N-xt*St),d.push(te,Qt)),p+=2):a.join===LINE_JOIN.ROUND?Wt?(d.push(Yt,zt),d.push(k+it*wt,N+ft*wt),p+=round(k,N,k+it*wt,N+ft*wt,k+mt*wt,N+xt*wt,d,!0)+4,d.push(Yt,zt),d.push(k+mt*wt,N+xt*wt)):(d.push(k-it*St,N-ft*St),d.push(te,Qt),p+=round(k,N,k-it*St,N-ft*St,k-mt*St,N-xt*St,d,!1)+4,d.push(k-mt*St,N-xt*St),d.push(te,Qt)):(d.push(Yt,zt),d.push(te,Qt)):(d.push(k-it*St,N-ft*St),d.push(k+it*wt,N+ft*wt),a.join===LINE_JOIN.ROUND?Wt?p+=round(k,N,k+it*wt,N+ft*wt,k+mt*wt,N+xt*wt,d,!0)+2:p+=round(k,N,k-it*St,N-ft*St,k-mt*St,N-xt*St,d,!1)+2:a.join===LINE_JOIN.MITER&&Nt/y<=v&&(Wt?(d.push(te,Qt),d.push(te,Qt)):(d.push(Yt,zt),d.push(Yt,zt)),p+=2),d.push(k-mt*St,N-xt*St),d.push(k+mt*wt,N+xt*wt),p+=2)}U=s[(m-2)*2],w=s[(m-2)*2+1],k=s[(m-1)*2],N=s[(m-1)*2+1],it=-(w-N),ft=U-k,yt=Math.sqrt(it*it+ft*ft),it/=yt,ft/=yt,it*=_,ft*=_,d.push(k-it*St,N-ft*St),d.push(k+it*wt,N+ft*wt),o||(a.cap===LINE_CAP.ROUND?p+=round(k-it*(St-wt)*.5,N-ft*(St-wt)*.5,k-it*St,N-ft*St,k+it*wt,N+ft*wt,d,!1)+2:a.cap===LINE_CAP.SQUARE&&(p+=square(k,N,it,ft,St,wt,!1,d)));const Ct=t.indices,It=curves.epsilon*curves.epsilon;for(let Pt=g;Pt<p+g-2;++Pt)U=d[Pt*2],w=d[Pt*2+1],k=d[(Pt+1)*2],N=d[(Pt+1)*2+1],W=d[(Pt+2)*2],et=d[(Pt+2)*2+1],!(Math.abs(U*(N-et)+k*(et-w)+W*(w-N))<It)&&Ct.push(Pt,Pt+1,Pt+2)}function buildNativeLine(n,t){let e=0;const s=n.shape,r=n.points||s.points,a=s.type!==SHAPES.POLY||s.closeStroke;if(r.length===0)return;const h=t.points,c=t.indices,o=r.length/2,u=h.length/2;let d=u;for(h.push(r[0],r[1]),e=1;e<o;e++)h.push(r[e*2],r[e*2+1]),c.push(d,d+1),d++;a&&c.push(d,u)}function buildLine(n,t){n.lineStyle.native?buildNativeLine(n,t):buildNonNativeLine(n,t)}class QuadraticUtils{static curveLength(t,e,s,r,a,h){const c=t-2*s+a,o=e-2*r+h,u=2*s-2*t,d=2*r-2*e,m=4*(c*c+o*o),p=4*(c*u+o*d),g=u*u+d*d,_=2*Math.sqrt(m+p+g),y=Math.sqrt(m),v=2*m*y,U=2*Math.sqrt(g),w=p/y;return(v*_+y*p*(_-U)+(4*g*m-p*p)*Math.log((2*y+w+_)/(w+U)))/(4*v)}static curveTo(t,e,s,r,a){const h=a[a.length-2],c=a[a.length-1],o=curves._segmentsCount(QuadraticUtils.curveLength(h,c,t,e,s,r));let u=0,d=0;for(let m=1;m<=o;++m){const p=m/o;u=h+(t-h)*p,d=c+(e-c)*p,a.push(u+(t+(s-t)*p-u)*p,d+(e+(r-e)*p-d)*p)}}}const FILL_COMMANDS={[SHAPES.POLY]:buildPoly,[SHAPES.CIRC]:buildCircle,[SHAPES.ELIP]:buildCircle,[SHAPES.RECT]:buildRectangle,[SHAPES.RREC]:buildRoundedRectangle},BATCH_POOL=[],DRAW_CALL_POOL=[];class GraphicsData{constructor(t,e=null,s=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const tmpPoint=new Point,_GraphicsGeometry=class extends BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[n]);this.drawCalls.length=0;for(let n=0;n<this.batches.length;n++){const t=this.batches[n];t.reset(),BATCH_POOL.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(n,t=null,e=null,s=null){const r=new GraphicsData(n,t,e,s);return this.graphicsData.push(r),this.dirty++,this}drawHole(n,t=null){if(!this.graphicsData.length)return null;const e=new GraphicsData(n,null,null,t),s=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=s.lineStyle,s.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(n){const t=this.graphicsData;for(let e=0;e<t.length;++e){const s=t[e];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(n,tmpPoint):tmpPoint.copyFrom(n),s.shape.contains(tmpPoint.x,tmpPoint.y))){let r=!1;if(s.holes){for(let a=0;a<s.holes.length;a++)if(s.holes[a].shape.contains(tmpPoint.x,tmpPoint.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const n=this.uvs,t=this.graphicsData;let e=null,s=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],s=e.style);for(let c=this.shapeIndex;c<t.length;c++){this.shapeIndex++;const o=t[c],u=o.fillStyle,d=o.lineStyle;FILL_COMMANDS[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(u.visible||d.visible)&&this.processHoles(o.holes);for(let p=0;p<2;p++){const g=p===0?u:d;if(!g.visible)continue;const _=g.texture.baseTexture,y=this.indices.length,v=this.points.length/2;_.wrapMode=WRAP_MODES.REPEAT,p===0?this.processFill(o):this.processLine(o);const U=this.points.length/2-v;U!==0&&(e&&!this._compareStyles(s,g)&&(e.end(y,v),e=null),e||(e=BATCH_POOL.pop()||new BatchPart,e.begin(g,y,v),this.batches.push(e),s=g),this.addUvs(this.points,n,g.texture,v,U,g.matrix))}}const r=this.indices.length,a=this.points.length/2;if(e&&e.end(r,a),this.batches.length===0){this.batchable=!0;return}const h=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(n,t){return!(!n||!t||n.texture.baseTexture!==t.texture.baseTexture||n.color+n.alpha!==t.color+t.alpha||!!n.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let n=0,t=this.graphicsData.length;n<t;n++){const e=this.graphicsData[n],s=e.fillStyle,r=e.lineStyle;if(s&&!s.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const n=this.batches;for(let t=0,e=n.length;t<e;t++){const s=n[t];for(let r=0;r<s.size;r++){const a=s.start+r;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const n=this.batches;for(let t=0;t<n.length;t++)if(n[t].style.native)return!1;return this.points.length<_GraphicsGeometry.BATCHABLE_SIZE*2}buildDrawCalls(){let n=++BaseTexture._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let s=DRAW_CALL_POOL.pop();s||(s=new BatchDrawCall,s.texArray=new BatchTextureArray),s.texArray.count=0,s.start=0,s.size=0,s.type=DRAW_MODES.TRIANGLES;let r=0,a=null,h=0,c=!1,o=DRAW_MODES.TRIANGLES,u=0;this.drawCalls.push(s);for(let d=0;d<this.batches.length;d++){const m=this.batches[d],p=8,g=m.style,_=g.texture.baseTexture;c!==!!g.native&&(c=!!g.native,o=c?DRAW_MODES.LINES:DRAW_MODES.TRIANGLES,a=null,r=p,n++),a!==_&&(a=_,_._batchEnabled!==n&&(r===p&&(n++,r=0,s.size>0&&(s=DRAW_CALL_POOL.pop(),s||(s=new BatchDrawCall,s.texArray=new BatchTextureArray),this.drawCalls.push(s)),s.start=u,s.size=0,s.texArray.count=0,s.type=o),_.touched=1,_._batchEnabled=n,_._batchLocation=r,_.wrapMode=WRAP_MODES.REPEAT,s.texArray.elements[s.texArray.count++]=_,r++)),s.size+=m.size,u+=m.size,h=_._batchLocation,this.addColors(t,g.color,g.alpha,m.attribSize,m.attribStart),this.addTextureIds(e,h,m.attribSize,m.attribStart)}BaseTexture._globalBatch=n,this.packAttributes()}packAttributes(){const n=this.points,t=this.uvs,e=this.colors,s=this.textureIds,r=new ArrayBuffer(n.length*3*4),a=new Float32Array(r),h=new Uint32Array(r);let c=0;for(let o=0;o<n.length/2;o++)a[c++]=n[o*2],a[c++]=n[o*2+1],a[c++]=t[o*2],a[c++]=t[o*2+1],h[c++]=e[o],a[c++]=s[o];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(n){n.holes.length?buildPoly.triangulate(n,this):FILL_COMMANDS[n.type].triangulate(n,this)}processLine(n){buildLine(n,this);for(let t=0;t<n.holes.length;t++)buildLine(n.holes[t],this)}processHoles(n){for(let t=0;t<n.length;t++){const e=n[t];FILL_COMMANDS[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const n=this._bounds;n.clear(),n.addVertexData(this.points,0,this.points.length),n.pad(this.boundsPadding,this.boundsPadding)}transformPoints(n,t){for(let e=0;e<n.length/2;e++){const s=n[e*2],r=n[e*2+1];n[e*2]=t.a*s+t.c*r+t.tx,n[e*2+1]=t.b*s+t.d*r+t.ty}}addColors(n,t,e,s,r=0){const a=(t>>16)+(t&65280)+((t&255)<<16),h=premultiplyTint(a,e);n.length=Math.max(n.length,r+s);for(let c=0;c<s;c++)n[r+c]=h}addTextureIds(n,t,e,s=0){n.length=Math.max(n.length,s+e);for(let r=0;r<e;r++)n[s+r]=t}addUvs(n,t,e,s,r,a=null){let h=0;const c=t.length,o=e.frame;for(;h<r;){let d=n[(s+h)*2],m=n[(s+h)*2+1];if(a){const p=a.a*d+a.c*m+a.tx;m=a.b*d+a.d*m+a.ty,d=p}h++,t.push(d/o.width,m/o.height)}const u=e.baseTexture;(o.width<u.width||o.height<u.height)&&this.adjustUvs(t,e,c,r)}adjustUvs(n,t,e,s){const r=t.baseTexture,a=1e-6,h=e+s*2,c=t.frame,o=c.width/r.width,u=c.height/r.height;let d=c.x/c.width,m=c.y/c.height,p=Math.floor(n[e]+a),g=Math.floor(n[e+1]+a);for(let _=e+2;_<h;_+=2)p=Math.min(p,Math.floor(n[_]+a)),g=Math.min(g,Math.floor(n[_+1]+a));d-=p,m-=g;for(let _=e;_<h;_+=2)n[_]=(n[_]+d)*o,n[_+1]=(n[_+1]+m)*u}};let GraphicsGeometry=_GraphicsGeometry;GraphicsGeometry.BATCHABLE_SIZE=100;class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new FillStyle;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}clone(){const t=new LineStyle;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const temp=new Float32Array(3),DEFAULT_SHADERS={},_Graphics=class extends Container{constructor(n=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=State$1.for2d(),this._geometry=n||new GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new _Graphics(this._geometry)}set blendMode(n){this.state.blendMode=n}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(n){this._tint=n}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(n=null,t=0,e=1,s=.5,r=!1){return typeof n=="number"&&(n={width:n,color:t,alpha:e,alignment:s,native:r}),this.lineTextureStyle(n)}lineTextureStyle(n){n=Object.assign({width:0,texture:Texture.WHITE,color:n!=null&&n.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10},n),this.currentPath&&this.startPoly();const t=n.width>0&&n.alpha>0;return t?(n.matrix&&(n.matrix=n.matrix.clone(),n.matrix.invert()),Object.assign(this._lineStyle,{visible:t},n)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const n=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(n[t-2],n[t-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(n,t){return this.startPoly(),this.currentPath.points[0]=n,this.currentPath.points[1]=t,this}lineTo(n,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,s=e[e.length-2],r=e[e.length-1];return(s!==n||r!==t)&&e.push(n,t),this}_initCurve(n=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[n,t]):this.moveTo(n,t)}quadraticCurveTo(n,t,e,s){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),QuadraticUtils.curveTo(n,t,e,s,r),this}bezierCurveTo(n,t,e,s,r,a){return this._initCurve(),BezierUtils.curveTo(n,t,e,s,r,a,this.currentPath.points),this}arcTo(n,t,e,s,r){this._initCurve(n,t);const a=this.currentPath.points,h=ArcUtils.curveTo(n,t,e,s,r,a);if(h){const{cx:c,cy:o,radius:u,startAngle:d,endAngle:m,anticlockwise:p}=h;this.arc(c,o,u,d,m,p)}return this}arc(n,t,e,s,r,a=!1){if(s===r)return this;if(!a&&r<=s?r+=PI_2:a&&s<=r&&(s+=PI_2),r-s===0)return this;const c=n+Math.cos(s)*e,o=t+Math.sin(s)*e,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const m=Math.abs(d[d.length-2]-c),p=Math.abs(d[d.length-1]-o);m<u&&p<u||d.push(c,o)}else this.moveTo(c,o),d=this.currentPath.points;return ArcUtils.arc(c,o,n,t,e,s,r,a,d),this}beginFill(n=0,t=1){return this.beginTextureFill({texture:Texture.WHITE,color:n,alpha:t})}beginTextureFill(n){n=Object.assign({texture:Texture.WHITE,color:16777215,alpha:1,matrix:null},n),this.currentPath&&this.startPoly();const t=n.alpha>0;return t?(n.matrix&&(n.matrix=n.matrix.clone(),n.matrix.invert()),Object.assign(this._fillStyle,{visible:t},n)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(n,t,e,s){return this.drawShape(new Rectangle(n,t,e,s))}drawRoundedRect(n,t,e,s,r){return this.drawShape(new RoundedRectangle(n,t,e,s,r))}drawCircle(n,t,e){return this.drawShape(new Circle(n,t,e))}drawEllipse(n,t,e,s){return this.drawShape(new Ellipse(n,t,e,s))}drawPolygon(...n){let t,e=!0;const s=n[0];s.points?(e=s.closeStroke,t=s.points):Array.isArray(n[0])?t=n[0]:t=n;const r=new Polygon(t);return r.closeStroke=e,this.drawShape(r),this}drawShape(n){return this._holeMode?this._geometry.drawHole(n,this._matrix):this._geometry.drawShape(n,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const n=this._geometry.graphicsData;return n.length===1&&n[0].shape.type===SHAPES.RECT&&!n[0].matrix&&!n[0].holes.length&&!(n[0].lineStyle.visible&&n[0].lineStyle.width)}_render(n){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(n)):(n.batch.flush(),this._renderDirect(n))}_populateBatches(){const n=this._geometry,t=this.blendMode,e=n.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=n.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(n.points);for(let s=0;s<e;s++){const r=n.batches[s],a=r.style.color,h=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),c=new Float32Array(n.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),o=new Uint16Array(n.indicesUint16.buffer,r.start*2,r.size),u={vertexData:h,blendMode:t,indices:o,uvs:c,_batchRGB:hex2rgb(a),_tintRGB:a,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[s]=u}}_renderBatched(n){if(this.batches.length){n.batch.setObjectRenderer(n.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const s=this.batches[t];s.worldAlpha=this.worldAlpha*s.alpha,n.plugins[this.pluginName].render(s)}}}_renderDirect(n){const t=this._resolveDirectShader(n),e=this._geometry,s=this.tint,r=this.worldAlpha,a=t.uniforms,h=e.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*r,a.tint[1]=(s>>8&255)/255*r,a.tint[2]=(s&255)/255*r,a.tint[3]=r,n.shader.bind(t),n.geometry.bind(e,t),n.state.set(this.state);for(let c=0,o=h.length;c<o;c++)this._renderDrawCallDirect(n,e.drawCalls[c])}_renderDrawCallDirect(n,t){const{texArray:e,type:s,size:r,start:a}=t,h=e.count;for(let c=0;c<h;c++)n.texture.bind(e.elements[c],c);n.geometry.draw(s,r,a)}_resolveDirectShader(n){let t=this.shader;const e=this.pluginName;if(!t){if(!DEFAULT_SHADERS[e]){const{maxTextures:s}=n.plugins[e],r=new Int32Array(s);for(let c=0;c<s;c++)r[c]=c;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:r},!0)},h=n.plugins[e]._shader.program;DEFAULT_SHADERS[e]=new Shader(h,a)}t=DEFAULT_SHADERS[e]}return t}_calculateBounds(){this.finishPoly();const n=this._geometry;if(!n.graphicsData.length)return;const{minX:t,minY:e,maxX:s,maxY:r}=n.bounds;this._bounds.addFrame(this.transform,t,e,s,r)}containsPoint(n){return this.worldTransform.applyInverse(n,_Graphics._TEMP_POINT),this._geometry.containsPoint(_Graphics._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const n=hex2rgb(this.tint,temp);for(let t=0;t<this.batches.length;t++){const e=this.batches[t],s=e._batchRGB,r=n[0]*s[0]*255,a=n[1]*s[1]*255,h=n[2]*s[2]*255,c=(r<<16)+(a<<8)+(h|0);e._tintRGB=(c>>16)+(c&65280)+((c&255)<<16)}}}calculateVertices(){const n=this.transform._worldID;if(this._transformID===n)return;this._transformID=n;const t=this.transform.worldTransform,e=t.a,s=t.b,r=t.c,a=t.d,h=t.tx,c=t.ty,o=this._geometry.points,u=this.vertexData;let d=0;for(let m=0;m<o.length;m+=2){const p=o[m],g=o[m+1];u[d++]=e*p+r*g+h,u[d++]=a*g+s*p+c}}closePath(){const n=this.currentPath;return n&&(n.closeStroke=!0,this.finishPoly()),this}setMatrix(n){return this._matrix=n,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(n){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(n)}};let Graphics=_Graphics;Graphics.curves=curves;Graphics._TEMP_POINT=new Point;const tempRgb=[0,0,0];class SpineSprite extends Sprite{constructor(){super(...arguments),this.region=null,this.attachment=null}}class SpineMesh extends SimpleMesh{constructor(t,e,s,r,a){super(t,e,s,r,a),this.region=null,this.attachment=null}}const _SpineBase=class extends Container{constructor(n){if(super(),!n)throw new Error("The spineData param is required.");if(typeof n=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=n,this.createSkeleton(n),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const s=this.skeleton.slots[t],r=s.getAttachment(),a=this.newContainer();if(this.slotContainers.push(a),this.addChild(a),this.tempClipContainers.push(null),!!r)if(r.type===AttachmentType.Region){const h=r.name,c=this.createSprite(s,r,h);s.currentSprite=c,s.currentSpriteName=h,a.addChild(c)}else if(r.type===AttachmentType.Mesh){const h=this.createMesh(s,r);s.currentMesh=h,s.currentMeshId=r.id,s.currentMeshName=r.name,a.addChild(h)}else r.type===AttachmentType.Clipping&&(this.createGraphics(s,r),a.addChild(s.clippingContainer),a.addChild(s.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(n){var t;n!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),n==null||n.registerSpine(this),this._debug=n)}get autoUpdate(){return this._autoUpdate}set autoUpdate(n){n!==this._autoUpdate&&(this._autoUpdate=n,this.updateTransform=n?_SpineBase.prototype.autoUpdateTransform:Container.prototype.updateTransform)}get tint(){return rgb2hex(this.tintRgb)}set tint(n){this.tintRgb=hex2rgb(n,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:settings.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(n){var u;const t=this.delayLimit;if(n>t&&(n=t),this.state.update(n),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const e=this.skeleton.slots,s=this.color;let r=null,a=null;s?(r=s.light,a=s.dark):r=this.tintRgb;for(let d=0,m=e.length;d<m;d++){const p=e[d],g=p.getAttachment(),_=this.slotContainers[d];if(!g){_.visible=!1;continue}let y=null;g.sequence&&g.sequence.apply(p,g);let v=g.region;const U=g.color;switch(g!=null&&g.type){case AttachmentType.Region:if(_.transform.setFromMatrix(p.bone.matrix),v=g.region,p.currentMesh&&(p.currentMesh.visible=!1,p.currentMesh=null,p.currentMeshId=void 0,p.currentMeshName=void 0),!v){p.currentSprite&&(p.currentSprite.renderable=!1);break}if(!p.currentSpriteName||p.currentSpriteName!==g.name){const N=g.name;if(p.currentSprite&&(p.currentSprite.visible=!1),p.sprites=p.sprites||{},p.sprites[N]!==void 0)p.sprites[N].visible=!0;else{const W=this.createSprite(p,g,N);_.addChild(W)}p.currentSprite=p.sprites[N],p.currentSpriteName=N}p.currentSprite.renderable=!0,p.hackRegion||this.setSpriteRegion(g,p.currentSprite,v),p.currentSprite.color?y=p.currentSprite.color:(tempRgb[0]=r[0]*p.color.r*U.r,tempRgb[1]=r[1]*p.color.g*U.g,tempRgb[2]=r[2]*p.color.b*U.b,p.currentSprite.tint=rgb2hex(tempRgb)),p.currentSprite.blendMode=p.blendMode;break;case AttachmentType.Mesh:if(p.currentSprite){p.currentSprite.visible=!1,p.currentSprite=null,p.currentSpriteName=void 0;const N=new Transform;N._parentID=-1,N._worldID=_.transform._worldID,_.transform=N}if(!v){p.currentMesh&&(p.currentMesh.renderable=!1);break}const k=g.id;if(p.currentMeshId===void 0||p.currentMeshId!==k){const N=k;if(p.currentMesh&&(p.currentMesh.visible=!1),p.meshes=p.meshes||{},p.meshes[N]!==void 0)p.meshes[N].visible=!0;else{const W=this.createMesh(p,g);_.addChild(W)}p.currentMesh=p.meshes[N],p.currentMeshName=g.name,p.currentMeshId=N}p.currentMesh.renderable=!0,g.computeWorldVerticesOld(p,p.currentMesh.vertices),p.currentMesh.color?y=p.currentMesh.color:(tempRgb[0]=r[0]*p.color.r*U.r,tempRgb[1]=r[1]*p.color.g*U.g,tempRgb[2]=r[2]*p.color.b*U.b,p.currentMesh.tint=rgb2hex(tempRgb)),p.currentMesh.blendMode=p.blendMode,p.hackRegion||this.setMeshRegion(g,p.currentMesh,v);break;case AttachmentType.Clipping:p.currentGraphics||(this.createGraphics(p,g),_.addChild(p.clippingContainer),_.addChild(p.currentGraphics)),this.updateGraphics(p,g),_.alpha=1,_.visible=!0;continue;default:_.visible=!1;continue}if(_.visible=!0,y){let w=p.color.r*U.r,k=p.color.g*U.g,N=p.color.b*U.b;y.setLight(r[0]*w+a[0]*(1-w),r[1]*k+a[1]*(1-k),r[2]*N+a[2]*(1-N)),p.darkColor?(w=p.darkColor.r,k=p.darkColor.g,N=p.darkColor.b):(w=0,k=0,N=0),y.setDark(r[0]*w+a[0]*(1-w),r[1]*k+a[1]*(1-k),r[2]*N+a[2]*(1-N))}_.alpha=p.color.a}const h=this.skeleton.drawOrder;let c=null,o=null;for(let d=0,m=h.length;d<m;d++){const p=e[h[d].data.index],g=this.slotContainers[h[d].data.index];if(o||g.parent!==null&&g.parent!==this&&(g.parent.removeChild(g),g.parent=this),p.currentGraphics&&p.getAttachment())o=p.clippingContainer,c=p.getAttachment(),o.children.length=0,this.children[d]=g,c.endSlot===p.data&&(c.endSlot=null);else if(o){let _=this.tempClipContainers[d];_||(_=this.tempClipContainers[d]=this.newContainer(),_.visible=!1),this.children[d]=_,g.parent=null,o.addChild(g),c.endSlot==p.data&&(o.renderable=!0,o=null,c=null)}else this.children[d]=g}(u=this._debug)==null||u.renderDebug(this)}setSpriteRegion(n,t,e){t.attachment===n&&t.region===e||(t.region=e,t.attachment=n,t.texture=e.texture,t.rotation=n.rotation*MathUtils.degRad,t.position.x=n.x,t.position.y=n.y,t.alpha=n.color.a,e.size?(t.scale.x=e.size.width/e.originalWidth,t.scale.y=-e.size.height/e.originalHeight):(t.scale.x=n.scaleX*n.width/e.originalWidth,t.scale.y=-n.scaleY*n.height/e.originalHeight))}setMeshRegion(n,t,e){t.attachment===n&&t.region===e||(t.region=e,t.attachment=n,t.texture=e.texture,e.texture.updateUvs(),t.uvBuffer.update(n.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const n=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(n)}Container.prototype.updateTransform.call(this)}createSprite(n,t,e){let s=t.region;n.hackAttachment===t&&(s=n.hackRegion);const r=s?s.texture:null,a=this.newSprite(r);return a.anchor.set(.5),s&&this.setSpriteRegion(t,a,t.region),n.sprites=n.sprites||{},n.sprites[e]=a,a}createMesh(n,t){let e=t.region;n.hackAttachment===t&&(e=n.hackRegion,n.hackAttachment=null,n.hackRegion=null);const s=this.newMesh(e?e.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),DRAW_MODES.TRIANGLES);return typeof s._canvasPadding<"u"&&(s._canvasPadding=1.5),s.alpha=t.color.a,s.region=t.region,e&&this.setMeshRegion(t,s,e),n.meshes=n.meshes||{},n.meshes[t.id]=s,s}createGraphics(n,t){const e=this.newGraphics(),s=new Polygon([]);return e.clear(),e.beginFill(16777215,1),e.drawPolygon(s),e.renderable=!1,n.currentGraphics=e,n.clippingContainer=this.newContainer(),n.clippingContainer.mask=n.currentGraphics,e}updateGraphics(n,t){const e=n.currentGraphics.geometry,s=e.graphicsData[0].shape.points,r=t.worldVerticesLength;s.length=r,t.computeWorldVertices(n,0,r,s,0,2),e.invalidate()}hackTextureBySlotIndex(n,t=null,e=null){const s=this.skeleton.slots[n];if(!s)return!1;const r=s.getAttachment();let a=r.region;return t?(a=new TextureRegion,a.texture=t,a.size=e,s.hackRegion=a,s.hackAttachment=r):(s.hackRegion=null,s.hackAttachment=null),s.currentSprite?this.setSpriteRegion(r,s.currentSprite,a):s.currentMesh&&this.setMeshRegion(r,s.currentMesh,a),!0}hackTextureBySlotName(n,t=null,e=null){const s=this.skeleton.findSlotIndex(n);return s==-1?!1:this.hackTextureBySlotIndex(s,t,e)}hackTextureAttachment(n,t,e,s=null){const r=this.skeleton.findSlotIndex(n),a=this.skeleton.getAttachmentByName(n,t);a.region.texture=e;const h=this.skeleton.slots[r];if(!h)return!1;const c=h.getAttachment();if(t===c.name){let o=a.region;return e?(o=new TextureRegion,o.texture=e,o.size=s,h.hackRegion=o,h.hackAttachment=c):(h.hackRegion=null,h.hackAttachment=null),h.currentSprite&&h.currentSprite.region!=o?(this.setSpriteRegion(c,h.currentSprite,o),h.currentSprite.region=o):h.currentMesh&&h.currentMesh.region!=o&&this.setMeshRegion(c,h.currentMesh,o),!0}return!1}newContainer(){return new Container}newSprite(n){return new SpineSprite(n)}newGraphics(){return new Graphics}newMesh(n,t,e,s,r){return new SpineMesh(n,t,e,s,r)}transformHack(){return 1}hackAttachmentGroups(n,t,e){if(!n)return;const s=[],r=[];for(let a=0,h=this.skeleton.slots.length;a<h;a++){const c=this.skeleton.slots[a],o=c.currentSpriteName||c.currentMeshName||"",u=c.currentSprite||c.currentMesh;o.endsWith(n)?(u.parentGroup=t,r.push(u)):e&&u&&(u.parentGroup=e,s.push(u))}return[s,r]}destroy(n){this.debug=null;for(let t=0,e=this.skeleton.slots.length;t<e;t++){const s=this.skeleton.slots[t];for(const r in s.meshes)s.meshes[r].destroy(n);s.meshes=null;for(const r in s.sprites)s.sprites[r].destroy(n);s.sprites=null}for(let t=0,e=this.slotContainers.length;t<e;t++)this.slotContainers[t].destroy(n);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(n)}};let SpineBase=_SpineBase;SpineBase.clippingPolygon=[];Object.defineProperty(SpineBase.prototype,"visible",{get(){return this._visible},set(n){n!==this._visible&&(this._visible=n,n&&(this.lastTime=0))}});const assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions$1.handle(ExtensionType.Asset,n=>{const t=n.ref;Object.entries(assetKeyMap).filter(([e])=>!!t[e]).forEach(([e,s])=>extensions$1.add(Object.assign(t[e],{extension:t[e].extension??s})))},n=>{const t=n.ref;Object.keys(assetKeyMap).filter(e=>!!t[e]).forEach(e=>extensions$1.remove(t[e]))});class BackgroundLoader{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function checkDataUrl(n,t){if(Array.isArray(t)){for(const e of t)if(n.startsWith(`data:${e}`))return!0;return!1}return n.startsWith(`data:${t}`)}function checkExtension(n,t){const e=n.split("?")[0],s=path$1.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const convertToList=(n,t)=>(Array.isArray(n)||(n=[n]),t?n.map(e=>typeof e=="string"?t(e):e):n),copySearchParams=(n,t)=>{const e=t.split("?")[1];return e&&(n+=`?${e}`),n};function processX(n,t,e,s,r){const a=t[e];for(let h=0;h<a.length;h++){const c=a[h];e<t.length-1?processX(n.replace(s[e],c),t,e+1,s,r):r.push(n.replace(s[e],c))}}function createStringVariations(n){const t=/\{(.*?)\}/g,e=n.match(t),s=[];if(e){const r=[];e.forEach(a=>{const h=a.substring(1,a.length-1).split(",");r.push(h)}),processX(n,r,0,e,s)}else s.push(n);return s}const isSingleItem=n=>!Array.isArray(n);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=convertToList(t);let r;for(let c=0;c<this.parsers.length;c++){const o=this.parsers[c];if(o.test(e)){r=o.getCacheableAssets(s,e);break}}r||(r={},s.forEach(c=>{r[c]=e}));const a=Object.keys(r),h={cacheKeys:a,keys:s};if(s.forEach(c=>{this._cacheMap.set(c,h)}),a.forEach(c=>{this._cache.has(c)&&this._cache.get(c)!==e&&console.warn("[Cache] already has key:",c),this._cache.set(c,r[c])}),e instanceof Texture){const c=e;s.forEach(o=>{c.baseTexture!==Texture.EMPTY.baseTexture&&BaseTexture.addToCache(c.baseTexture,o),Texture.addToCache(c,o)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Cache=new CacheClass;class Loader{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var a,h;let r=null;for(let c=0;c<this.parsers.length;c++){const o=this.parsers[c];if(o.load&&((a=o.test)!=null&&a.call(o,t,e,this))){r=await o.load(t,e,this),s.parser=o;break}}if(!s.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let c=0;c<this.parsers.length;c++){const o=this.parsers[c];o.parse&&o.parse&&await((h=o.testParse)==null?void 0:h.call(o,r,e,this))&&(r=await o.parse(r,e,this)||r,s.parser=o)}return r})(),s}async load(t,e){let s=0;const r={},a=isSingleItem(t),h=convertToList(t,u=>({src:u})),c=h.length,o=h.map(async u=>{const d=path$1.toAbsolute(u.src);if(!r[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),r[u.src]=await this.promiseCache[d].promise,e&&e(++s/c)}catch(m){throw delete this.promiseCache[d],delete r[u.src],new Error(`[Loader.load] Failed to load ${d}.
${m}`)}});return await Promise.all(o),a?r[h[0].src]:r}async unload(t){const s=convertToList(t,r=>({src:r})).map(async r=>{var c,o;const a=path$1.toAbsolute(r.src),h=this.promiseCache[a];if(h){const u=await h.promise;(o=(c=h.parser)==null?void 0:c.unload)==null||o.call(c,u,r,this),delete this.promiseCache[a]}});await Promise.all(s)}get parsers(){return this._parsers}}var LoaderParserPriority=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(LoaderParserPriority||{});const loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return path$1.extname(n).toLowerCase()===".json"},async load(n){return await(await settings$1.ADAPTER.fetch(n)).json()}};extensions$1.add(loadJson);const loadTxt={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return path$1.extname(n).toLowerCase()===".txt"},async load(n){return await(await settings$1.ADAPTER.fetch(n)).text()}};extensions$1.add(loadTxt);const validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"];function getFontFamilyName(n){const t=path$1.extname(n);return path$1.basename(n,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}const loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return checkDataUrl(n,validFontMIMEs)||checkExtension(n,validFontExtensions)},async load(n,t){var s,r,a;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const e=settings$1.ADAPTER.getFontFaceSet();if(e){const h=[],c=((s=t.data)==null?void 0:s.family)??getFontFamilyName(n),o=((a=(r=t.data)==null?void 0:r.weights)==null?void 0:a.filter(d=>validWeights.includes(d)))??["normal"],u=t.data??{};for(let d=0;d<o.length;d++){const m=o[d],p=new FontFace(c,`url(${encodeURI(n)})`,{...u,weight:m});await p.load(),e.add(p),h.push(p)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(t=>settings$1.ADAPTER.getFontFaceSet().delete(t))}};extensions$1.add(loadWebFont);let UUID=0,MAX_WORKERS;const WHITE_PNG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",checkImageBitmapCode={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${WHITE_PNG}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},workerCode={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let workerURL;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([checkImageBitmapCode.code],{type:"application/javascript"})),s=new Worker(e);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){MAX_WORKERS===void 0&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<MAX_WORKERS&&(workerURL||(workerURL=URL.createObjectURL(new Blob([workerCode.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(workerURL),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,a)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:a})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[UUID]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:UUID++,id:s})}}const WorkerManager=new WorkerManagerClass;function createTexture(n,t,e){const s=new Texture(n);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),s}const validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(n){const t=await settings$1.ADAPTER.fetch(n);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const loadTextures={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{preferWorkers:!0},test(n){return checkDataUrl(n,validImageMIMEs)||checkExtension(n,validImageExtensions)},async load(n,t,e){let s=null;globalThis.createImageBitmap?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?s=await WorkerManager.loadImageBitmap(n):s=await loadImageBitmap(n):s=await new Promise(a=>{s=new Image,s.crossOrigin="anonymous",s.src=n,s.complete?a(s):s.onload=()=>{a(s)}});const r=new BaseTexture(s,{resolution:getResolutionOfUrl(n),...t.data});return r.resource.src=n,createTexture(r,e,n)},unload(n){n.destroy(!0)}};extensions$1.add(loadTextures);const loadSVG={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return path$1.extname(n).toLowerCase()===".svg"},async testParse(n){return SVGResource.test(n)},async parse(n,t,e){var h,c,o;const s=new SVGResource(n,(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions),r=new BaseTexture(s,{resolution:getResolutionOfUrl(n),...t==null?void 0:t.data});r.resource.src=n;const a=createTexture(r,e,n);return(o=(c=t==null?void 0:t.data)==null?void 0:c.resourceOptions)!=null&&o.autoLoad||await s.load(),a},async load(n,t){return(await settings$1.ADAPTER.fetch(n)).text()},unload:loadTextures.unload};extensions$1.add(loadSVG);class Resolver{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,e)=>`${t}${this._bundleIdConnector}${e}`,this._extractAssetIdFromBundle=(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const a=this._createBundleAssetId(t,r.name);s.push(a),this.add([r.name,a],r.srcs,r.data)}else{const a=r.name.map(h=>this._createBundleAssetId(t,h));a.forEach(h=>{s.push(h)}),this.add([...r.name,...a],r.srcs)}}):Object.keys(e).forEach(r=>{s.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=s}add(t,e,s){const r=convertToList(t);r.forEach(h=>{this._assetMap[h]&&console.warn(`[Resolver] already has key: ${h} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=createStringVariations(e):e=[e]);const a=e.map(h=>{let c=h;if(typeof h=="string"){let o=!1;for(let u=0;u<this._parsers.length;u++){const d=this._parsers[u];if(d.test(h)){c=d.parse(h),o=!0;break}}o||(c={src:h})}return c.format||(c.format=c.src.split(".").pop()),c.alias||(c.alias=r),(this._basePath||this._rootPath)&&(c.src=path$1.toAbsolute(c.src,this._basePath,this._rootPath)),c.src=this._appendDefaultSearchParams(c.src),c.data=c.data??s,c});r.forEach(h=>{this._assetMap[h]=a})}resolveBundle(t){const e=isSingleItem(t);t=convertToList(t);const s={};return t.forEach(r=>{const a=this._bundles[r];if(a){const h=this.resolve(a),c={};for(const o in h){const u=h[o];c[this._extractAssetIdFromBundle(r,o)]=u}s[r]=c}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=isSingleItem(t);t=convertToList(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let a=this._assetMap[r];const h=this._getPreferredOrder(a),c=a[0];h==null||h.priority.forEach(o=>{h.params[o].forEach(u=>{const d=a.filter(m=>m[o]?m[o]===u:!1);d.length&&(a=d)})}),this._resolverHash[r]=a[0]??c}else{let a=r;(this._basePath||this._rootPath)&&(a=path$1.toAbsolute(a,this._basePath,this._rootPath)),a=this._appendDefaultSearchParams(a),this._resolverHash[r]={src:a}}s[r]=this._resolverHash[r]}),e?s[t[0]]:s}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(a=>a.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var a,h,c;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((a=t.texturePreference)==null?void 0:a.resolution)??1,s=typeof e=="number"?[e]:e;let r=[];if((h=t.texturePreference)!=null&&h.format){const o=(c=t.texturePreference)==null?void 0:c.format;r=typeof o=="string"?[o]:o;for(const u of this._detections)await u.test()||(r=await u.remove(r))}else for(const o of this._detections)await o.test()&&(r=await o.add(r));this.resolver.prefer({params:{format:r,resolution:s}})}add(t,e,s){this.resolver.add(t,e,s)}async load(t,e){this._initialized||await this.init();const s=isSingleItem(t),r=convertToList(t).map(c=>typeof c!="string"?(this.resolver.add(c.src,c),c.src):c),a=this.resolver.resolve(r),h=await this._mapLoadToResolve(a,e);return s?h[r[0]]:h}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),a={},h=Object.keys(r);let c=0,o=0;const u=()=>{e==null||e(++c/o)},d=h.map(m=>{const p=r[m];return o+=Object.keys(p).length,this._mapLoadToResolve(p,u).then(g=>{a[m]=g})});return await Promise.all(d),s?a[t[0]]:a}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Cache.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=Cache.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const a=await this.loader.load(s,e);this._backgroundLoader.active=!0;const h={};return s.forEach((c,o)=>{const u=a[c.src],d=[c.src];c.alias&&d.push(...c.alias),h[r[o]]=u,Cache.set(d,u)}),h}async unload(t){this._initialized||await this.init();const e=convertToList(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=convertToList(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{Cache.remove(s.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return loadTextures.config.preferWorkers}set preferWorkers(t){loadTextures.config.preferWorkers=t}}const Assets=new AssetsClass;extensions$1.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections);const cacheTextureArray={extension:ExtensionType.CacheParser,test:n=>Array.isArray(n)&&n.every(t=>t instanceof Texture),getCacheableAssets:(n,t)=>{const e={};return n.forEach(s=>{t.forEach((r,a)=>{e[s+(a===0?"":a+1)]=r})}),e}};extensions$1.add(cacheTextureArray);const detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const n="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await settings$1.ADAPTER.fetch(n).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async n=>[...n,"avif"],remove:async n=>n.filter(t=>t!=="avif")};extensions$1.add(detectAvif);const detectWebp={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await settings$1.ADAPTER.fetch(n).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async n=>[...n,"webp"],remove:async n=>n.filter(t=>t!=="webp")};extensions$1.add(detectWebp);const imageFormats=["png","jpg","jpeg"],detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...imageFormats],remove:async n=>n.filter(t=>!imageFormats.includes(t))};extensions$1.add(detectDefaults);const resolveTextureUrl={extension:ExtensionType.ResolveParser,test:loadTextures.test,parse:n=>{var t;return{resolution:parseFloat(((t=settings$1.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:n.split(".").pop(),src:n}}};extensions$1.add(resolveTextureUrl);const spineTextureAtlasLoader={extension:ExtensionType.Asset,loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(n){return checkExtension(n,".atlas")},async load(n){return await(await settings$1.ADAPTER.fetch(n)).text()},testParse(n,t){const e=checkExtension(t.src,".atlas"),s=typeof n=="string";return Promise.resolve(e&&s)},async parse(n,t,e){const s=t.data;let r=path$1.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let a=null,h=null;const c=new Promise((d,m)=>{a=d,h=m});let o;const u=d=>{d||h(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),a(o)};if(s.image||s.images){const d=Object.assign(s.image?{default:s.image}:{},s.images);o=new TextureAtlas(n,(m,p)=>{const g=d[m]||d.default;g&&g.baseTexture?p(g.baseTexture):p(g)},u)}else o=new TextureAtlas(n,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(e,r,s.imageMetadata),u);return await c},unload(n){n.dispose()}}},makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject=(n,t,e)=>async(s,r)=>{const a=path$1.join(...t.split(path$1.sep),s),h=await n.load({src:a,data:e});r(h.baseTexture)};extensions$1.add(spineTextureAtlasLoader);function isJson(n){return n.hasOwnProperty("bones")}function isBuffer(n){return n instanceof ArrayBuffer}class SpineLoaderAbstract{constructor(){}installLoader(){const t=this,e={extension:ExtensionType.Asset,loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(s){return checkExtension(s,".skel")},async load(s){return await(await settings$1.ADAPTER.fetch(s)).arrayBuffer()},testParse(s,r){var o;const a=checkExtension(r.src,".json")&&isJson(s),h=checkExtension(r.src,".skel")&&isBuffer(s),c=((o=r.data)==null?void 0:o.spineAtlas)===!1;return Promise.resolve(a&&!c||h)},async parse(s,r,a){const h=path$1.extname(r.src).toLowerCase(),c=path$1.basename(r.src,h);let o=path$1.dirname(r.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");const u=checkExtension(r.src,".json")&&isJson(s);let d=null,m=s;u?d=t.createJsonParser():(d=t.createBinaryParser(),m=new Uint8Array(s));const p=r.data||{},g=(p==null?void 0:p.spineSkeletonScale)??null;g&&(d.scale=g);const _=p.spineAtlas;if(_&&_.pages)return t.parseData(d,_,m);const y=p.atlasRawData;if(y){let w=null,k=null;const N=new Promise((it,ft)=>{w=it,k=ft}),W=new TextureAtlas(y,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(a,o,p.imageMetadata),it=>{it||k(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),w(W)}),et=await N;return t.parseData(d,et,m)}let v=p.spineAtlasFile;v||(v=`${o+c}.atlas`);const U=await a.load({src:v,data:p,alias:p.spineAtlasAlias});return t.parseData(d,U,m)}}};return extensions$1.add(e),e}}let Attachment$2=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const _VertexAttachment$2=class extends Attachment$2{constructor(t){super(t),this.id=(_VertexAttachment$2.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,s,r,a,h){s=a+(s>>1)*h;const c=t.bone.skeleton,o=t.deform;let u=this.vertices;const d=this.bones;if(d==null){o.length>0&&(u=o);const _=t.bone.matrix,y=_.tx,v=_.ty,U=_.a,w=_.c,k=_.b,N=_.d;for(let W=e,et=a;et<s;W+=2,et+=h){const it=u[W],ft=u[W+1];r[et]=it*U+ft*w+y,r[et+1]=it*k+ft*N+v}return}let m=0,p=0;for(let _=0;_<e;_+=2){const y=d[m];m+=y+1,p+=y}const g=c.bones;if(o.length==0)for(let _=a,y=p*3;_<s;_+=h){let v=0,U=0,w=d[m++];for(w+=m;m<w;m++,y+=3){const k=g[d[m]].matrix,N=u[y],W=u[y+1],et=u[y+2];v+=(N*k.a+W*k.c+k.tx)*et,U+=(N*k.b+W*k.d+k.ty)*et}r[_]=v,r[_+1]=U}else{const _=o;for(let y=a,v=p*3,U=p<<1;y<s;y+=h){let w=0,k=0,N=d[m++];for(N+=m;m<N;m++,v+=3,U+=2){const W=g[d[m]].matrix,et=u[v]+_[U],it=u[v+1]+_[U+1],ft=u[v+2];w+=(et*W.a+it*W.c+W.tx)*ft,k+=(et*W.b+it*W.d+W.ty)*ft}r[y]=w,r[y+1]=k}}}copyTo(t){this.bones!=null?(t.bones=new Array(this.bones.length),Utils.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices!=null?(t.vertices=Utils.newFloatArray(this.vertices.length),Utils.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}};let VertexAttachment$2=_VertexAttachment$2;VertexAttachment$2.nextID=0;let BoundingBoxAttachment$2=class extends VertexAttachment$2{constructor(t){super(t),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}copy(){const t=new BoundingBoxAttachment$2(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}},ClippingAttachment$2=class extends VertexAttachment$2{constructor(t){super(t),this.type=AttachmentType.Clipping,this.color=new Color(.2275,.2275,.8078,1)}copy(){const t=new ClippingAttachment$2(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}},MeshAttachment$2=class extends VertexAttachment$2{constructor(t){super(t),this.type=AttachmentType.Mesh,this.color=new Color(1,1,1,1),this.tempColor=new Color(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();const t=new MeshAttachment$2(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),Utils.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),Utils.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,this.edges!=null&&(t.edges=new Array(this.edges.length),Utils.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){const t=new MeshAttachment$2(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(this.parentMesh!=null?this.parentMesh:this),t}},PathAttachment$2=class extends VertexAttachment$2{constructor(t){super(t),this.type=AttachmentType.Path,this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}copy(){const t=new PathAttachment$2(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),Utils.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}},PointAttachment$2=class extends VertexAttachment$2{constructor(t){super(t),this.type=AttachmentType.Point,this.color=new Color(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),a=s*e.a+r*e.c,h=s*e.b+r*e.d;return Math.atan2(h,a)*MathUtils.radDeg}copy(){const t=new PointAttachment$2(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}},Slot$2=class{constructor(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new Color,this.darkColor=t.darkColor==null?null:new Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const _RegionAttachment$2=class extends Attachment$2{constructor(t){super(t),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,a=s+this.region.width*t,h=r+this.region.height*e,c=this.rotation*Math.PI/180,o=Math.cos(c),u=Math.sin(c),d=s*o+this.x,m=s*u,p=r*o+this.y,g=r*u,_=a*o+this.x,y=a*u,v=h*o+this.y,U=h*u,w=this.offset;w[_RegionAttachment$2.OX1]=d-g,w[_RegionAttachment$2.OY1]=p+m,w[_RegionAttachment$2.OX2]=d-U,w[_RegionAttachment$2.OY2]=v+m,w[_RegionAttachment$2.OX3]=_-U,w[_RegionAttachment$2.OY3]=v+y,w[_RegionAttachment$2.OX4]=_-g,w[_RegionAttachment$2.OY4]=p+y}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,s,r){const a=this.offset,h=t instanceof Slot$2?t.bone.matrix:t.matrix,c=h.tx,o=h.ty,u=h.a,d=h.c,m=h.b,p=h.d;let g=0,_=0;g=a[_RegionAttachment$2.OX1],_=a[_RegionAttachment$2.OY1],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$2.OX2],_=a[_RegionAttachment$2.OY2],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$2.OX3],_=a[_RegionAttachment$2.OY3],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$2.OX4],_=a[_RegionAttachment$2.OY4],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o}copy(){const t=new _RegionAttachment$2(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,Utils.arrayCopy(this.uvs,0,t.uvs,0,8),Utils.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}};let RegionAttachment$2=_RegionAttachment$2;RegionAttachment$2.OX1=0;RegionAttachment$2.OY1=1;RegionAttachment$2.OX2=2;RegionAttachment$2.OY2=3;RegionAttachment$2.OX3=4;RegionAttachment$2.OY3=5;RegionAttachment$2.OX4=6;RegionAttachment$2.OY4=7;RegionAttachment$2.X1=0;RegionAttachment$2.Y1=1;RegionAttachment$2.C1R=2;RegionAttachment$2.C1G=3;RegionAttachment$2.C1B=4;RegionAttachment$2.C1A=5;RegionAttachment$2.U1=6;RegionAttachment$2.V1=7;RegionAttachment$2.X2=8;RegionAttachment$2.Y2=9;RegionAttachment$2.C2R=10;RegionAttachment$2.C2G=11;RegionAttachment$2.C2B=12;RegionAttachment$2.C2A=13;RegionAttachment$2.U2=14;RegionAttachment$2.V2=15;RegionAttachment$2.X3=16;RegionAttachment$2.Y3=17;RegionAttachment$2.C3R=18;RegionAttachment$2.C3G=19;RegionAttachment$2.C3B=20;RegionAttachment$2.C3A=21;RegionAttachment$2.U3=22;RegionAttachment$2.V3=23;RegionAttachment$2.X4=24;RegionAttachment$2.Y4=25;RegionAttachment$2.C4R=26;RegionAttachment$2.C4G=27;RegionAttachment$2.C4B=28;RegionAttachment$2.C4A=29;RegionAttachment$2.U4=30;RegionAttachment$2.V4=31;let JitterEffect$1=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,s,r){t.x+=MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=MathUtils.randomTriangular(-this.jitterX,this.jitterY)}end(){}};const _SwirlEffect$1=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,s,r){const a=this.angle*MathUtils.degreesToRadians,h=t.x-this.worldX,c=t.y-this.worldY,o=Math.sqrt(h*h+c*c);if(o<this.radius){const u=_SwirlEffect$1.interpolation.apply(0,a,(this.radius-o)/this.radius),d=Math.cos(u),m=Math.sin(u);t.x=d*h-m*c+this.worldX,t.y=m*h+d*c+this.worldY}}end(){}};let SwirlEffect$1=_SwirlEffect$1;SwirlEffect$1.interpolation=new PowOut(2);let Animation$4=class{constructor(t,e,s){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let r=0;r<e.length;r++)this.timelineIds[e[r].getPropertyId()]=!0;this.duration=s}hasTimeline(t){return this.timelineIds[t]==!0}apply(t,e,s,r,a,h,c,o){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const u=this.timelines;for(let d=0,m=u.length;d<m;d++)u[d].apply(t,e,s,a,h,c,o)}static binarySearch(t,e,s=1){let r=0,a=t.length/s-2;if(a==0)return s;let h=a>>>1;for(;;){if(t[(h+1)*s]<=e?r=h+1:a=h,r==a)return(r+1)*s;h=r+a>>>1}}static linearSearch(t,e,s){for(let r=0,a=t.length-s;r<=a;r+=s)if(t[r]>e)return r;return-1}};var TimelineType$1=(n=>(n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor",n))(TimelineType$1||{});const _CurveTimeline$1=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=Utils.newFloatArray((t-1)*_CurveTimeline$1.BEZIER_SIZE)}getFrameCount(){return this.curves.length/_CurveTimeline$1.BEZIER_SIZE+1}setLinear(t){this.curves[t*_CurveTimeline$1.BEZIER_SIZE]=_CurveTimeline$1.LINEAR}setStepped(t){this.curves[t*_CurveTimeline$1.BEZIER_SIZE]=_CurveTimeline$1.STEPPED}getCurveType(t){const e=t*_CurveTimeline$1.BEZIER_SIZE;if(e==this.curves.length)return _CurveTimeline$1.LINEAR;const s=this.curves[e];return s==_CurveTimeline$1.LINEAR?_CurveTimeline$1.LINEAR:s==_CurveTimeline$1.STEPPED?_CurveTimeline$1.STEPPED:_CurveTimeline$1.BEZIER}setCurve(t,e,s,r,a){const h=(-e*2+r)*.03,c=(-s*2+a)*.03,o=((e-r)*3+1)*.006,u=((s-a)*3+1)*.006;let d=h*2+o,m=c*2+u,p=e*.3+h+o*.16666667,g=s*.3+c+u*.16666667,_=t*_CurveTimeline$1.BEZIER_SIZE;const y=this.curves;y[_++]=_CurveTimeline$1.BEZIER;let v=p,U=g;for(let w=_+_CurveTimeline$1.BEZIER_SIZE-1;_<w;_+=2)y[_]=v,y[_+1]=U,p+=d,g+=m,d+=o,m+=u,v+=p,U+=g}getCurvePercent(t,e){e=MathUtils.clamp(e,0,1);const s=this.curves;let r=t*_CurveTimeline$1.BEZIER_SIZE;const a=s[r];if(a==_CurveTimeline$1.LINEAR)return e;if(a==_CurveTimeline$1.STEPPED)return 0;r++;let h=0;for(let o=r,u=r+_CurveTimeline$1.BEZIER_SIZE-1;r<u;r+=2)if(h=s[r],h>=e){let d,m;return r==o?(d=0,m=0):(d=s[r-2],m=s[r-1]),m+(s[r+1]-m)*(e-d)/(h-d)}const c=s[r-1];return c+(1-c)*(e-h)/(1-h)}};let CurveTimeline$2=_CurveTimeline$1;CurveTimeline$2.LINEAR=0;CurveTimeline$2.STEPPED=1;CurveTimeline$2.BEZIER=2;CurveTimeline$2.BEZIER_SIZE=10*2-1;const _RotateTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+_RotateTimeline$1.ROTATION]=s}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.rotation=u.data.rotation;return;case MixBlend.first:const y=u.data.rotation-u.rotation;u.rotation+=(y-(16384-(16384.499999999996-y/360|0))*360)*a}return}if(s>=o[o.length-_RotateTimeline$1.ENTRIES]){let y=o[o.length+_RotateTimeline$1.PREV_ROTATION];switch(h){case MixBlend.setup:u.rotation=u.data.rotation+y*a;break;case MixBlend.first:case MixBlend.replace:y+=u.data.rotation-u.rotation,y-=(16384-(16384.499999999996-y/360|0))*360;case MixBlend.add:u.rotation+=y*a}return}const d=Animation$4.binarySearch(o,s,_RotateTimeline$1.ENTRIES),m=o[d+_RotateTimeline$1.PREV_ROTATION],p=o[d],g=this.getCurvePercent((d>>1)-1,1-(s-p)/(o[d+_RotateTimeline$1.PREV_TIME]-p));let _=o[d+_RotateTimeline$1.ROTATION]-m;switch(_=m+(_-(16384-(16384.499999999996-_/360|0))*360)*g,h){case MixBlend.setup:u.rotation=u.data.rotation+(_-(16384-(16384.499999999996-_/360|0))*360)*a;break;case MixBlend.first:case MixBlend.replace:_+=u.data.rotation-u.rotation;case MixBlend.add:u.rotation+=(_-(16384-(16384.499999999996-_/360|0))*360)*a}}};let RotateTimeline$2=_RotateTimeline$1;RotateTimeline$2.ENTRIES=2;RotateTimeline$2.PREV_TIME=-2;RotateTimeline$2.PREV_ROTATION=-1;RotateTimeline$2.ROTATION=1;const _TranslateTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_TranslateTimeline$1.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,s,r){t*=_TranslateTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_TranslateTimeline$1.X]=s,this.frames[t+_TranslateTimeline$1.Y]=r}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.x=u.data.x,u.y=u.data.y;return;case MixBlend.first:u.x+=(u.data.x-u.x)*a,u.y+=(u.data.y-u.y)*a}return}let d=0,m=0;if(s>=o[o.length-_TranslateTimeline$1.ENTRIES])d=o[o.length+_TranslateTimeline$1.PREV_X],m=o[o.length+_TranslateTimeline$1.PREV_Y];else{const p=Animation$4.binarySearch(o,s,_TranslateTimeline$1.ENTRIES);d=o[p+_TranslateTimeline$1.PREV_X],m=o[p+_TranslateTimeline$1.PREV_Y];const g=o[p],_=this.getCurvePercent(p/_TranslateTimeline$1.ENTRIES-1,1-(s-g)/(o[p+_TranslateTimeline$1.PREV_TIME]-g));d+=(o[p+_TranslateTimeline$1.X]-d)*_,m+=(o[p+_TranslateTimeline$1.Y]-m)*_}switch(h){case MixBlend.setup:u.x=u.data.x+d*a,u.y=u.data.y+m*a;break;case MixBlend.first:case MixBlend.replace:u.x+=(u.data.x+d-u.x)*a,u.y+=(u.data.y+m-u.y)*a;break;case MixBlend.add:u.x+=d*a,u.y+=m*a}}};let TranslateTimeline$2=_TranslateTimeline$1;TranslateTimeline$2.ENTRIES=3;TranslateTimeline$2.PREV_TIME=-3;TranslateTimeline$2.PREV_X=-2;TranslateTimeline$2.PREV_Y=-1;TranslateTimeline$2.X=1;TranslateTimeline$2.Y=2;let ScaleTimeline$2=class extends TranslateTimeline$2{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.scaleX=u.data.scaleX,u.scaleY=u.data.scaleY;return;case MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*a,u.scaleY+=(u.data.scaleY-u.scaleY)*a}return}let d=0,m=0;if(s>=o[o.length-ScaleTimeline$2.ENTRIES])d=o[o.length+ScaleTimeline$2.PREV_X]*u.data.scaleX,m=o[o.length+ScaleTimeline$2.PREV_Y]*u.data.scaleY;else{const p=Animation$4.binarySearch(o,s,ScaleTimeline$2.ENTRIES);d=o[p+ScaleTimeline$2.PREV_X],m=o[p+ScaleTimeline$2.PREV_Y];const g=o[p],_=this.getCurvePercent(p/ScaleTimeline$2.ENTRIES-1,1-(s-g)/(o[p+ScaleTimeline$2.PREV_TIME]-g));d=(d+(o[p+ScaleTimeline$2.X]-d)*_)*u.data.scaleX,m=(m+(o[p+ScaleTimeline$2.Y]-m)*_)*u.data.scaleY}if(a==1)h==MixBlend.add?(u.scaleX+=d-u.data.scaleX,u.scaleY+=m-u.data.scaleY):(u.scaleX=d,u.scaleY=m);else{let p=0,g=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:p=u.data.scaleX,g=u.data.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-g)*a;break;case MixBlend.first:case MixBlend.replace:p=u.scaleX,g=u.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-g)*a;break;case MixBlend.add:p=u.scaleX,g=u.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-u.data.scaleX)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-u.data.scaleY)*a}else switch(h){case MixBlend.setup:p=Math.abs(u.data.scaleX)*MathUtils.signum(d),g=Math.abs(u.data.scaleY)*MathUtils.signum(m),u.scaleX=p+(d-p)*a,u.scaleY=g+(m-g)*a;break;case MixBlend.first:case MixBlend.replace:p=Math.abs(u.scaleX)*MathUtils.signum(d),g=Math.abs(u.scaleY)*MathUtils.signum(m),u.scaleX=p+(d-p)*a,u.scaleY=g+(m-g)*a;break;case MixBlend.add:p=MathUtils.signum(d),g=MathUtils.signum(m),u.scaleX=Math.abs(u.scaleX)*p+(d-Math.abs(u.data.scaleX)*p)*a,u.scaleY=Math.abs(u.scaleY)*g+(m-Math.abs(u.data.scaleY)*g)*a}}}},ShearTimeline$2=class extends TranslateTimeline$2{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.shearX=u.data.shearX,u.shearY=u.data.shearY;return;case MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*a,u.shearY+=(u.data.shearY-u.shearY)*a}return}let d=0,m=0;if(s>=o[o.length-ShearTimeline$2.ENTRIES])d=o[o.length+ShearTimeline$2.PREV_X],m=o[o.length+ShearTimeline$2.PREV_Y];else{const p=Animation$4.binarySearch(o,s,ShearTimeline$2.ENTRIES);d=o[p+ShearTimeline$2.PREV_X],m=o[p+ShearTimeline$2.PREV_Y];const g=o[p],_=this.getCurvePercent(p/ShearTimeline$2.ENTRIES-1,1-(s-g)/(o[p+ShearTimeline$2.PREV_TIME]-g));d=d+(o[p+ShearTimeline$2.X]-d)*_,m=m+(o[p+ShearTimeline$2.Y]-m)*_}switch(h){case MixBlend.setup:u.shearX=u.data.shearX+d*a,u.shearY=u.data.shearY+m*a;break;case MixBlend.first:case MixBlend.replace:u.shearX+=(u.data.shearX+d-u.shearX)*a,u.shearY+=(u.data.shearY+m-u.shearY)*a;break;case MixBlend.add:u.shearX+=d*a,u.shearY+=m*a}}};const _ColorTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_ColorTimeline$1.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,s,r,a,h){t*=_ColorTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_ColorTimeline$1.R]=s,this.frames[t+_ColorTimeline$1.G]=r,this.frames[t+_ColorTimeline$1.B]=a,this.frames[t+_ColorTimeline$1.A]=h}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.color.setFromColor(o.data.color);return;case MixBlend.first:const _=o.color,y=o.data.color;_.add((y.r-_.r)*a,(y.g-_.g)*a,(y.b-_.b)*a,(y.a-_.a)*a)}return}let d=0,m=0,p=0,g=0;if(s>=u[u.length-_ColorTimeline$1.ENTRIES]){const _=u.length;d=u[_+_ColorTimeline$1.PREV_R],m=u[_+_ColorTimeline$1.PREV_G],p=u[_+_ColorTimeline$1.PREV_B],g=u[_+_ColorTimeline$1.PREV_A]}else{const _=Animation$4.binarySearch(u,s,_ColorTimeline$1.ENTRIES);d=u[_+_ColorTimeline$1.PREV_R],m=u[_+_ColorTimeline$1.PREV_G],p=u[_+_ColorTimeline$1.PREV_B],g=u[_+_ColorTimeline$1.PREV_A];const y=u[_],v=this.getCurvePercent(_/_ColorTimeline$1.ENTRIES-1,1-(s-y)/(u[_+_ColorTimeline$1.PREV_TIME]-y));d+=(u[_+_ColorTimeline$1.R]-d)*v,m+=(u[_+_ColorTimeline$1.G]-m)*v,p+=(u[_+_ColorTimeline$1.B]-p)*v,g+=(u[_+_ColorTimeline$1.A]-g)*v}if(a==1)o.color.set(d,m,p,g);else{const _=o.color;h==MixBlend.setup&&_.setFromColor(o.data.color),_.add((d-_.r)*a,(m-_.g)*a,(p-_.b)*a,(g-_.a)*a)}}};let ColorTimeline$1=_ColorTimeline$1;ColorTimeline$1.ENTRIES=5;ColorTimeline$1.PREV_TIME=-5;ColorTimeline$1.PREV_R=-4;ColorTimeline$1.PREV_G=-3;ColorTimeline$1.PREV_B=-2;ColorTimeline$1.PREV_A=-1;ColorTimeline$1.R=1;ColorTimeline$1.G=2;ColorTimeline$1.B=3;ColorTimeline$1.A=4;const _TwoColorTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_TwoColorTimeline$1.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,s,r,a,h,c,o,u){t*=_TwoColorTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_TwoColorTimeline$1.R]=s,this.frames[t+_TwoColorTimeline$1.G]=r,this.frames[t+_TwoColorTimeline$1.B]=a,this.frames[t+_TwoColorTimeline$1.A]=h,this.frames[t+_TwoColorTimeline$1.R2]=c,this.frames[t+_TwoColorTimeline$1.G2]=o,this.frames[t+_TwoColorTimeline$1.B2]=u}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.color.setFromColor(o.data.color),o.darkColor.setFromColor(o.data.darkColor);return;case MixBlend.first:const U=o.color,w=o.darkColor,k=o.data.color,N=o.data.darkColor;U.add((k.r-U.r)*a,(k.g-U.g)*a,(k.b-U.b)*a,(k.a-U.a)*a),w.add((N.r-w.r)*a,(N.g-w.g)*a,(N.b-w.b)*a,0)}return}let d=0,m=0,p=0,g=0,_=0,y=0,v=0;if(s>=u[u.length-_TwoColorTimeline$1.ENTRIES]){const U=u.length;d=u[U+_TwoColorTimeline$1.PREV_R],m=u[U+_TwoColorTimeline$1.PREV_G],p=u[U+_TwoColorTimeline$1.PREV_B],g=u[U+_TwoColorTimeline$1.PREV_A],_=u[U+_TwoColorTimeline$1.PREV_R2],y=u[U+_TwoColorTimeline$1.PREV_G2],v=u[U+_TwoColorTimeline$1.PREV_B2]}else{const U=Animation$4.binarySearch(u,s,_TwoColorTimeline$1.ENTRIES);d=u[U+_TwoColorTimeline$1.PREV_R],m=u[U+_TwoColorTimeline$1.PREV_G],p=u[U+_TwoColorTimeline$1.PREV_B],g=u[U+_TwoColorTimeline$1.PREV_A],_=u[U+_TwoColorTimeline$1.PREV_R2],y=u[U+_TwoColorTimeline$1.PREV_G2],v=u[U+_TwoColorTimeline$1.PREV_B2];const w=u[U],k=this.getCurvePercent(U/_TwoColorTimeline$1.ENTRIES-1,1-(s-w)/(u[U+_TwoColorTimeline$1.PREV_TIME]-w));d+=(u[U+_TwoColorTimeline$1.R]-d)*k,m+=(u[U+_TwoColorTimeline$1.G]-m)*k,p+=(u[U+_TwoColorTimeline$1.B]-p)*k,g+=(u[U+_TwoColorTimeline$1.A]-g)*k,_+=(u[U+_TwoColorTimeline$1.R2]-_)*k,y+=(u[U+_TwoColorTimeline$1.G2]-y)*k,v+=(u[U+_TwoColorTimeline$1.B2]-v)*k}if(a==1)o.color.set(d,m,p,g),o.darkColor.set(_,y,v,1);else{const U=o.color,w=o.darkColor;h==MixBlend.setup&&(U.setFromColor(o.data.color),w.setFromColor(o.data.darkColor)),U.add((d-U.r)*a,(m-U.g)*a,(p-U.b)*a,(g-U.a)*a),w.add((_-w.r)*a,(y-w.g)*a,(v-w.b)*a,0)}}};let TwoColorTimeline$1=_TwoColorTimeline$1;TwoColorTimeline$1.ENTRIES=8;TwoColorTimeline$1.PREV_TIME=-8;TwoColorTimeline$1.PREV_R=-7;TwoColorTimeline$1.PREV_G=-6;TwoColorTimeline$1.PREV_B=-5;TwoColorTimeline$1.PREV_A=-4;TwoColorTimeline$1.PREV_R2=-3;TwoColorTimeline$1.PREV_G2=-2;TwoColorTimeline$1.PREV_B2=-1;TwoColorTimeline$1.R=1;TwoColorTimeline$1.G=2;TwoColorTimeline$1.B=3;TwoColorTimeline$1.A=4;TwoColorTimeline$1.R2=5;TwoColorTimeline$1.G2=6;TwoColorTimeline$1.B2=7;let AttachmentTimeline$2=class{constructor(t){this.frames=Utils.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;if(c==MixDirection.mixOut){h==MixBlend.setup&&this.setAttachment(t,o,o.data.attachmentName);return}const u=this.frames;if(s<u[0]){(h==MixBlend.setup||h==MixBlend.first)&&this.setAttachment(t,o,o.data.attachmentName);return}let d=0;s>=u[u.length-1]?d=u.length-1:d=Animation$4.binarySearch(u,s,1)-1;const m=this.attachmentNames[d];t.slots[this.slotIndex].setAttachment(m==null?null:t.getAttachment(this.slotIndex,m))}setAttachment(t,e,s){e.setAttachment(s==null?null:t.getAttachment(this.slotIndex,s))}},zeros$1=null,DeformTimeline$2=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t),this.frameVertices=new Array(t),zeros$1==null&&(zeros$1=Utils.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,s){this.frames[t]=e,this.frameVertices[t]=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=o.getAttachment();if(!(u instanceof VertexAttachment$2)||u.deformAttachment!=this.attachment)return;const d=o.deform;d.length==0&&(h=MixBlend.setup);const m=this.frameVertices,p=m[0].length,g=this.frames;if(s<g[0]){const N=u;switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(a==1){d.length=0;break}const W=Utils.setArraySize(d,p);if(N.bones==null){const et=N.vertices;for(let it=0;it<p;it++)W[it]+=(et[it]-W[it])*a}else{a=1-a;for(let et=0;et<p;et++)W[et]*=a}}return}const _=Utils.setArraySize(d,p);if(s>=g[g.length-1]){const N=m[g.length-1];if(a==1)if(h==MixBlend.add){const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++)_[it]+=N[it]-et[it]}else for(let et=0;et<p;et++)_[et]+=N[et]}else Utils.arrayCopy(N,0,_,0,p);else switch(h){case MixBlend.setup:{const et=u;if(et.bones==null){const it=et.vertices;for(let ft=0;ft<p;ft++){const mt=it[ft];_[ft]=mt+(N[ft]-mt)*a}}else for(let it=0;it<p;it++)_[it]=N[it]*a;break}case MixBlend.first:case MixBlend.replace:for(let et=0;et<p;et++)_[et]+=(N[et]-_[et])*a;break;case MixBlend.add:const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++)_[it]+=(N[it]-et[it])*a}else for(let et=0;et<p;et++)_[et]+=N[et]*a}return}const y=Animation$4.binarySearch(g,s),v=m[y-1],U=m[y],w=g[y],k=this.getCurvePercent(y-1,1-(s-w)/(g[y-1]-w));if(a==1)if(h==MixBlend.add){const N=u;if(N.bones==null){const W=N.vertices;for(let et=0;et<p;et++){const it=v[et];_[et]+=it+(U[et]-it)*k-W[et]}}else for(let W=0;W<p;W++){const et=v[W];_[W]+=et+(U[W]-et)*k}}else for(let N=0;N<p;N++){const W=v[N];_[N]=W+(U[N]-W)*k}else switch(h){case MixBlend.setup:{const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++){const ft=v[it],mt=et[it];_[it]=mt+(ft+(U[it]-ft)*k-mt)*a}}else for(let et=0;et<p;et++){const it=v[et];_[et]=(it+(U[et]-it)*k)*a}break}case MixBlend.first:case MixBlend.replace:for(let W=0;W<p;W++){const et=v[W];_[W]+=(et+(U[W]-et)*k-_[W])*a}break;case MixBlend.add:const N=u;if(N.bones==null){const W=N.vertices;for(let et=0;et<p;et++){const it=v[et];_[et]+=(it+(U[et]-it)*k-W[et])*a}}else for(let W=0;W<p;W++){const et=v[W];_[W]+=(et+(U[W]-et)*k)*a}}}},EventTimeline$2=class{constructor(t){this.frames=Utils.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,r,a,h,c){if(r==null)return;const o=this.frames,u=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,r,a,h,c),e=-1;else if(e>=o[u-1])return;if(s<o[0])return;let d=0;if(e<o[0])d=0;else{d=Animation$4.binarySearch(o,e);const m=o[d];for(;d>0&&o[d-1]==m;)d--}for(;d<u&&s>=o[d];d++)r.push(this.events[d])}},DrawOrderTimeline$2=class{constructor(t){this.frames=Utils.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,r,a,h,c){const o=t.drawOrder,u=t.slots;if(c==MixDirection.mixOut&&h==MixBlend.setup){Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const d=this.frames;if(s<d[0]){(h==MixBlend.setup||h==MixBlend.first)&&Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let m=0;s>=d[d.length-1]?m=d.length-1:m=Animation$4.binarySearch(d,s)-1;const p=this.drawOrders[m];if(p==null)Utils.arrayCopy(u,0,o,0,u.length);else for(let g=0,_=p.length;g<_;g++)o[g]=u[p[g]]}};const _IkConstraintTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_IkConstraintTimeline$1.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,s,r,a,h,c){t*=_IkConstraintTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_IkConstraintTimeline$1.MIX]=s,this.frames[t+_IkConstraintTimeline$1.SOFTNESS]=r,this.frames[t+_IkConstraintTimeline$1.BEND_DIRECTION]=a,this.frames[t+_IkConstraintTimeline$1.COMPRESS]=h?1:0,this.frames[t+_IkConstraintTimeline$1.STRETCH]=c?1:0}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.ikConstraints[this.ikConstraintIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.mix=u.data.mix,u.softness=u.data.softness,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch;return;case MixBlend.first:u.mix+=(u.data.mix-u.mix)*a,u.softness+=(u.data.softness-u.softness)*a,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch}return}if(s>=o[o.length-_IkConstraintTimeline$1.ENTRIES]){h==MixBlend.setup?(u.mix=u.data.mix+(o[o.length+_IkConstraintTimeline$1.PREV_MIX]-u.data.mix)*a,u.softness=u.data.softness+(o[o.length+_IkConstraintTimeline$1.PREV_SOFTNESS]-u.data.softness)*a,c==MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=o[o.length+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=o[o.length+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=o[o.length+_IkConstraintTimeline$1.PREV_STRETCH]!=0)):(u.mix+=(o[o.length+_IkConstraintTimeline$1.PREV_MIX]-u.mix)*a,u.softness+=(o[o.length+_IkConstraintTimeline$1.PREV_SOFTNESS]-u.softness)*a,c==MixDirection.mixIn&&(u.bendDirection=o[o.length+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=o[o.length+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=o[o.length+_IkConstraintTimeline$1.PREV_STRETCH]!=0));return}const d=Animation$4.binarySearch(o,s,_IkConstraintTimeline$1.ENTRIES),m=o[d+_IkConstraintTimeline$1.PREV_MIX],p=o[d+_IkConstraintTimeline$1.PREV_SOFTNESS],g=o[d],_=this.getCurvePercent(d/_IkConstraintTimeline$1.ENTRIES-1,1-(s-g)/(o[d+_IkConstraintTimeline$1.PREV_TIME]-g));h==MixBlend.setup?(u.mix=u.data.mix+(m+(o[d+_IkConstraintTimeline$1.MIX]-m)*_-u.data.mix)*a,u.softness=u.data.softness+(p+(o[d+_IkConstraintTimeline$1.SOFTNESS]-p)*_-u.data.softness)*a,c==MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=o[d+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=o[d+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=o[d+_IkConstraintTimeline$1.PREV_STRETCH]!=0)):(u.mix+=(m+(o[d+_IkConstraintTimeline$1.MIX]-m)*_-u.mix)*a,u.softness+=(p+(o[d+_IkConstraintTimeline$1.SOFTNESS]-p)*_-u.softness)*a,c==MixDirection.mixIn&&(u.bendDirection=o[d+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=o[d+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=o[d+_IkConstraintTimeline$1.PREV_STRETCH]!=0))}};let IkConstraintTimeline$2=_IkConstraintTimeline$1;IkConstraintTimeline$2.ENTRIES=6;IkConstraintTimeline$2.PREV_TIME=-6;IkConstraintTimeline$2.PREV_MIX=-5;IkConstraintTimeline$2.PREV_SOFTNESS=-4;IkConstraintTimeline$2.PREV_BEND_DIRECTION=-3;IkConstraintTimeline$2.PREV_COMPRESS=-2;IkConstraintTimeline$2.PREV_STRETCH=-1;IkConstraintTimeline$2.MIX=1;IkConstraintTimeline$2.SOFTNESS=2;IkConstraintTimeline$2.BEND_DIRECTION=3;IkConstraintTimeline$2.COMPRESS=4;IkConstraintTimeline$2.STRETCH=5;const _TransformConstraintTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_TransformConstraintTimeline$1.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,s,r,a,h){t*=_TransformConstraintTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_TransformConstraintTimeline$1.ROTATE]=s,this.frames[t+_TransformConstraintTimeline$1.TRANSLATE]=r,this.frames[t+_TransformConstraintTimeline$1.SCALE]=a,this.frames[t+_TransformConstraintTimeline$1.SHEAR]=h}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.transformConstraints[this.transformConstraintIndex];if(!u.active)return;if(s<o[0]){const _=u.data;switch(h){case MixBlend.setup:u.rotateMix=_.rotateMix,u.translateMix=_.translateMix,u.scaleMix=_.scaleMix,u.shearMix=_.shearMix;return;case MixBlend.first:u.rotateMix+=(_.rotateMix-u.rotateMix)*a,u.translateMix+=(_.translateMix-u.translateMix)*a,u.scaleMix+=(_.scaleMix-u.scaleMix)*a,u.shearMix+=(_.shearMix-u.shearMix)*a}return}let d=0,m=0,p=0,g=0;if(s>=o[o.length-_TransformConstraintTimeline$1.ENTRIES]){const _=o.length;d=o[_+_TransformConstraintTimeline$1.PREV_ROTATE],m=o[_+_TransformConstraintTimeline$1.PREV_TRANSLATE],p=o[_+_TransformConstraintTimeline$1.PREV_SCALE],g=o[_+_TransformConstraintTimeline$1.PREV_SHEAR]}else{const _=Animation$4.binarySearch(o,s,_TransformConstraintTimeline$1.ENTRIES);d=o[_+_TransformConstraintTimeline$1.PREV_ROTATE],m=o[_+_TransformConstraintTimeline$1.PREV_TRANSLATE],p=o[_+_TransformConstraintTimeline$1.PREV_SCALE],g=o[_+_TransformConstraintTimeline$1.PREV_SHEAR];const y=o[_],v=this.getCurvePercent(_/_TransformConstraintTimeline$1.ENTRIES-1,1-(s-y)/(o[_+_TransformConstraintTimeline$1.PREV_TIME]-y));d+=(o[_+_TransformConstraintTimeline$1.ROTATE]-d)*v,m+=(o[_+_TransformConstraintTimeline$1.TRANSLATE]-m)*v,p+=(o[_+_TransformConstraintTimeline$1.SCALE]-p)*v,g+=(o[_+_TransformConstraintTimeline$1.SHEAR]-g)*v}if(h==MixBlend.setup){const _=u.data;u.rotateMix=_.rotateMix+(d-_.rotateMix)*a,u.translateMix=_.translateMix+(m-_.translateMix)*a,u.scaleMix=_.scaleMix+(p-_.scaleMix)*a,u.shearMix=_.shearMix+(g-_.shearMix)*a}else u.rotateMix+=(d-u.rotateMix)*a,u.translateMix+=(m-u.translateMix)*a,u.scaleMix+=(p-u.scaleMix)*a,u.shearMix+=(g-u.shearMix)*a}};let TransformConstraintTimeline$2=_TransformConstraintTimeline$1;TransformConstraintTimeline$2.ENTRIES=5;TransformConstraintTimeline$2.PREV_TIME=-5;TransformConstraintTimeline$2.PREV_ROTATE=-4;TransformConstraintTimeline$2.PREV_TRANSLATE=-3;TransformConstraintTimeline$2.PREV_SCALE=-2;TransformConstraintTimeline$2.PREV_SHEAR=-1;TransformConstraintTimeline$2.ROTATE=1;TransformConstraintTimeline$2.TRANSLATE=2;TransformConstraintTimeline$2.SCALE=3;TransformConstraintTimeline$2.SHEAR=4;const _PathConstraintPositionTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_PathConstraintPositionTimeline$1.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,s){t*=_PathConstraintPositionTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_PathConstraintPositionTimeline$1.VALUE]=s}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.position=u.data.position;return;case MixBlend.first:u.position+=(u.data.position-u.position)*a}return}let d=0;if(s>=o[o.length-_PathConstraintPositionTimeline$1.ENTRIES])d=o[o.length+_PathConstraintPositionTimeline$1.PREV_VALUE];else{const m=Animation$4.binarySearch(o,s,_PathConstraintPositionTimeline$1.ENTRIES);d=o[m+_PathConstraintPositionTimeline$1.PREV_VALUE];const p=o[m],g=this.getCurvePercent(m/_PathConstraintPositionTimeline$1.ENTRIES-1,1-(s-p)/(o[m+_PathConstraintPositionTimeline$1.PREV_TIME]-p));d+=(o[m+_PathConstraintPositionTimeline$1.VALUE]-d)*g}h==MixBlend.setup?u.position=u.data.position+(d-u.data.position)*a:u.position+=(d-u.position)*a}};let PathConstraintPositionTimeline$2=_PathConstraintPositionTimeline$1;PathConstraintPositionTimeline$2.ENTRIES=2;PathConstraintPositionTimeline$2.PREV_TIME=-2;PathConstraintPositionTimeline$2.PREV_VALUE=-1;PathConstraintPositionTimeline$2.VALUE=1;let PathConstraintSpacingTimeline$2=class extends PathConstraintPositionTimeline$2{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.spacing=u.data.spacing;return;case MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*a}return}let d=0;if(s>=o[o.length-PathConstraintSpacingTimeline$2.ENTRIES])d=o[o.length+PathConstraintSpacingTimeline$2.PREV_VALUE];else{const m=Animation$4.binarySearch(o,s,PathConstraintSpacingTimeline$2.ENTRIES);d=o[m+PathConstraintSpacingTimeline$2.PREV_VALUE];const p=o[m],g=this.getCurvePercent(m/PathConstraintSpacingTimeline$2.ENTRIES-1,1-(s-p)/(o[m+PathConstraintSpacingTimeline$2.PREV_TIME]-p));d+=(o[m+PathConstraintSpacingTimeline$2.VALUE]-d)*g}h==MixBlend.setup?u.spacing=u.data.spacing+(d-u.data.spacing)*a:u.spacing+=(d-u.spacing)*a}};const _PathConstraintMixTimeline$1=class extends CurveTimeline$2{constructor(t){super(t),this.frames=Utils.newFloatArray(t*_PathConstraintMixTimeline$1.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,s,r){t*=_PathConstraintMixTimeline$1.ENTRIES,this.frames[t]=e,this.frames[t+_PathConstraintMixTimeline$1.ROTATE]=s,this.frames[t+_PathConstraintMixTimeline$1.TRANSLATE]=r}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<o[0]){switch(h){case MixBlend.setup:u.rotateMix=u.data.rotateMix,u.translateMix=u.data.translateMix;return;case MixBlend.first:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*a,u.translateMix+=(u.data.translateMix-u.translateMix)*a}return}let d=0,m=0;if(s>=o[o.length-_PathConstraintMixTimeline$1.ENTRIES])d=o[o.length+_PathConstraintMixTimeline$1.PREV_ROTATE],m=o[o.length+_PathConstraintMixTimeline$1.PREV_TRANSLATE];else{const p=Animation$4.binarySearch(o,s,_PathConstraintMixTimeline$1.ENTRIES);d=o[p+_PathConstraintMixTimeline$1.PREV_ROTATE],m=o[p+_PathConstraintMixTimeline$1.PREV_TRANSLATE];const g=o[p],_=this.getCurvePercent(p/_PathConstraintMixTimeline$1.ENTRIES-1,1-(s-g)/(o[p+_PathConstraintMixTimeline$1.PREV_TIME]-g));d+=(o[p+_PathConstraintMixTimeline$1.ROTATE]-d)*_,m+=(o[p+_PathConstraintMixTimeline$1.TRANSLATE]-m)*_}h==MixBlend.setup?(u.rotateMix=u.data.rotateMix+(d-u.data.rotateMix)*a,u.translateMix=u.data.translateMix+(m-u.data.translateMix)*a):(u.rotateMix+=(d-u.rotateMix)*a,u.translateMix+=(m-u.translateMix)*a)}};let PathConstraintMixTimeline$2=_PathConstraintMixTimeline$1;PathConstraintMixTimeline$2.ENTRIES=3;PathConstraintMixTimeline$2.PREV_TIME=-3;PathConstraintMixTimeline$2.PREV_ROTATE=-2;PathConstraintMixTimeline$2.PREV_TRANSLATE=-1;PathConstraintMixTimeline$2.ROTATE=1;PathConstraintMixTimeline$2.TRANSLATE=2;const _AnimationState$2=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new EventQueue$2(this),this.propertyIDs=new IntSet,this.animationsChanged=!1,this.trackEntryPool=new Pool$1(()=>new TrackEntry$2),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a==null)continue;a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;let h=t*a.timeScale;if(a.delay>0){if(a.delay-=h,a.delay>0)continue;h=-a.delay,a.delay=0}let c=a.next;if(c!=null){const o=a.trackLast-c.delay;if(o>=0){for(c.delay=0,c.trackTime+=a.timeScale==0?0:(o/a.timeScale+t)*c.timeScale,a.trackTime+=h,this.setCurrent(s,c,!0);c.mixingFrom!=null;)c.mixTime+=t,c=c.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&a.mixingFrom==null){e[s]=null,this.queue.end(a),this.disposeNext(a);continue}if(a.mixingFrom!=null&&this.updateMixingFrom(a,t)){let o=a.mixingFrom;for(a.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}a.trackTime+=h}this.queue.drain()}updateMixingFrom(t,e){const s=t.mixingFrom;if(s==null)return!0;const r=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((s.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=s.mixingFrom,s.mixingFrom!=null&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),r):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,s=this.tracks;let r=!1;for(let c=0,o=s.length;c<o;c++){const u=s[c];if(u==null||u.delay>0)continue;r=!0;const d=c==0?MixBlend.first:u.mixBlend;let m=u.alpha;u.mixingFrom!=null?m*=this.applyMixingFrom(u,t,d):u.trackTime>=u.trackEnd&&u.next==null&&(m=0);const p=u.animationLast,g=u.getAnimationTime(),_=u.animation.timelines.length,y=u.animation.timelines;if(c==0&&m==1||d==MixBlend.add)for(let v=0;v<_;v++){const U=y[v];U instanceof AttachmentTimeline$2?this.applyAttachmentTimeline(U,t,g,d,!0):U.apply(t,p,g,e,m,d,MixDirection.mixIn)}else{const v=u.timelineMode,U=u.timelinesRotation.length==0;U&&Utils.setArraySize(u.timelinesRotation,_<<1,null);const w=u.timelinesRotation;for(let k=0;k<_;k++){const N=y[k],W=v[k]==_AnimationState$2.SUBSEQUENT?d:MixBlend.setup;N instanceof RotateTimeline$2?this.applyRotateTimeline(N,t,g,m,W,w,k<<1,U):N instanceof AttachmentTimeline$2?this.applyAttachmentTimeline(N,t,g,d,!0):N.apply(t,p,g,e,m,W,MixDirection.mixIn)}}this.queueEvents(u,g),e.length=0,u.nextAnimationLast=g,u.nextTrackLast=u.trackTime}const a=this.unkeyedState+_AnimationState$2.SETUP,h=t.slots;for(let c=0,o=t.slots.length;c<o;c++){const u=h[c];if(u.attachmentState==a){const d=u.data.attachmentName;u.setAttachment(d==null?null:t.getAttachment(u.data.index,d))}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,e,s){const r=t.mixingFrom;r.mixingFrom!=null&&this.applyMixingFrom(r,e,s);let a=0;t.mixDuration==0?(a=1,s==MixBlend.first&&(s=MixBlend.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),s!=MixBlend.first&&(s=r.mixBlend));const h=a<r.eventThreshold?this.events:null,c=a<r.attachmentThreshold,o=a<r.drawOrderThreshold,u=r.animationLast,d=r.getAnimationTime(),m=r.animation.timelines.length,p=r.animation.timelines,g=r.alpha*t.interruptAlpha,_=g*(1-a);if(s==MixBlend.add)for(let y=0;y<m;y++)p[y].apply(e,u,d,h,_,s,MixDirection.mixOut);else{const y=r.timelineMode,v=r.timelineHoldMix,U=r.timelinesRotation.length==0;U&&Utils.setArraySize(r.timelinesRotation,m<<1,null);const w=r.timelinesRotation;r.totalAlpha=0;for(let k=0;k<m;k++){const N=p[k];let W=MixDirection.mixOut,et,it=0;switch(y[k]){case _AnimationState$2.SUBSEQUENT:if(!o&&N instanceof DrawOrderTimeline$2)continue;et=s,it=_;break;case _AnimationState$2.FIRST:et=MixBlend.setup,it=_;break;case _AnimationState$2.HOLD_SUBSEQUENT:et=s,it=g;break;case _AnimationState$2.HOLD_FIRST:et=MixBlend.setup,it=g;break;default:et=MixBlend.setup;const ft=v[k];it=g*Math.max(0,1-ft.mixTime/ft.mixDuration);break}r.totalAlpha+=it,N instanceof RotateTimeline$2?this.applyRotateTimeline(N,e,d,it,et,w,k<<1,U):N instanceof AttachmentTimeline$2?this.applyAttachmentTimeline(N,e,d,et,c):(o&&N instanceof DrawOrderTimeline$2&&et==MixBlend.setup&&(W=MixDirection.mixIn),N.apply(e,u,d,h,it,et,W))}}return t.mixDuration>0&&this.queueEvents(r,d),this.events.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime,a}applyAttachmentTimeline(t,e,s,r,a){const h=e.slots[t.slotIndex];if(!h.bone.active)return;const c=t.frames;if(s<c[0])(r==MixBlend.setup||r==MixBlend.first)&&this.setAttachment(e,h,h.data.attachmentName,a);else{let o;s>=c[c.length-1]?o=c.length-1:o=Animation$4.binarySearch(c,s)-1,this.setAttachment(e,h,t.attachmentNames[o],a)}h.attachmentState<=this.unkeyedState&&(h.attachmentState=this.unkeyedState+_AnimationState$2.SETUP)}setAttachment(t,e,s,r){e.setAttachment(s==null?null:t.getAttachment(e.data.index,s)),r&&(e.attachmentState=this.unkeyedState+_AnimationState$2.CURRENT)}applyRotateTimeline(t,e,s,r,a,h,c,o){if(o&&(h[c]=0),r==1){t.apply(e,0,s,null,1,a,MixDirection.mixIn);return}const u=t,d=u.frames,m=e.bones[u.boneIndex];if(!m.active)return;let p=0,g=0;if(s<d[0])switch(a){case MixBlend.setup:m.rotation=m.data.rotation;default:return;case MixBlend.first:p=m.rotation,g=m.data.rotation}else if(p=a==MixBlend.setup?m.data.rotation:m.rotation,s>=d[d.length-RotateTimeline$2.ENTRIES])g=m.data.rotation+d[d.length+RotateTimeline$2.PREV_ROTATION];else{const v=Animation$4.binarySearch(d,s,RotateTimeline$2.ENTRIES),U=d[v+RotateTimeline$2.PREV_ROTATION],w=d[v],k=u.getCurvePercent((v>>1)-1,1-(s-w)/(d[v+RotateTimeline$2.PREV_TIME]-w));g=d[v+RotateTimeline$2.ROTATION]-U,g-=(16384-(16384.499999999996-g/360|0))*360,g=U+g*k+m.data.rotation,g-=(16384-(16384.499999999996-g/360|0))*360}let _=0,y=g-p;if(y-=(16384-(16384.499999999996-y/360|0))*360,y==0)_=h[c];else{let v=0,U=0;o?(v=0,U=y):(v=h[c],U=h[c+1]);const w=y>0;let k=v>=0;MathUtils.signum(U)!=MathUtils.signum(y)&&Math.abs(U)<=90&&(Math.abs(v)>180&&(v+=360*MathUtils.signum(v)),k=w),_=y+v-v%360,k!=w&&(_+=360*MathUtils.signum(v)),h[c]=_}h[c+1]=y,p+=_*r,m.rotation=p-(16384-(16384.499999999996-p/360|0))*360}queueEvents(t,e){const s=t.animationStart,r=t.animationEnd,a=r-s,h=t.trackLast%a,c=this.events;let o=0;const u=c.length;for(;o<u;o++){const m=c[o];if(m.time<h)break;m.time>r||this.queue.event(t,m)}let d=!1;for(t.loop?d=a==0||h>t.trackTime%a:d=e>=r&&t.animationLast<r,d&&this.queue.complete(t);o<u;o++)c[o].time<s||this.queue.event(t,c[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let s=e;for(;;){const r=s.mixingFrom;if(r==null)break;this.queue.end(r),s.mixingFrom=null,s.mixingTo=null,s=r}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){const r=this.expandToIndex(t);this.tracks[t]=e,r!=null&&(s&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom!=null&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,s)}setAnimationWith(t,e,s){if(e==null)throw new Error("animation cannot be null.");let r=!0,a=this.expandToIndex(t);a!=null&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,r=!1):this.disposeNext(a));const h=this.trackEntry(t,e,s,a);return this.setCurrent(t,h,r),this.queue.drain(),h}addAnimation(t,e,s,r){const a=this.data.skeletonData.findAnimation(e);if(a==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,a,s,r)}addAnimationWith(t,e,s,r){if(e==null)throw new Error("animation cannot be null.");let a=this.expandToIndex(t);if(a!=null)for(;a.next!=null;)a=a.next;const h=this.trackEntry(t,e,s,a);if(a==null)this.setCurrent(t,h,!0),this.queue.drain();else if(a.next=h,r<=0){const c=a.animationEnd-a.animationStart;c!=0?(a.loop?r+=c*(1+(a.trackTime/c|0)):r+=Math.max(c,a.trackTime),r-=this.data.getMix(a.animation,e)):r=a.trackTime}return h.delay=r,h}setEmptyAnimation(t,e){const s=this.setAnimationWith(t,_AnimationState$2.emptyAnimation,!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e,s){s<=0&&(s-=e);const r=this.addAnimationWith(t,_AnimationState$2.emptyAnimation,!1,s);return r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,r=this.tracks.length;s<r;s++){const a=this.tracks[s];a!=null&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(Utils.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,r){const a=this.trackEntryPool.obtain();return a.trackIndex=t,a.animation=e,a.loop=s,a.holdPrevious=!1,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.interruptAlpha=1,a.mixTime=0,a.mixDuration=r==null?0:this.data.getMix(r.animation,e),a.mixBlend=MixBlend.replace,a}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let s=this.tracks[t];if(s!=null){for(;s.mixingFrom!=null;)s=s.mixingFrom;do(s.mixingFrom==null||s.mixBlend!=MixBlend.add)&&this.computeHold(s),s=s.mixingTo;while(s!=null)}}}computeHold(t){const e=t.mixingTo,s=t.animation.timelines,r=t.animation.timelines.length,a=Utils.setArraySize(t.timelineMode,r);t.timelineHoldMix.length=0;const h=Utils.setArraySize(t.timelineHoldMix,r),c=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<r;o++)a[o]=c.add(s[o].getPropertyId())?_AnimationState$2.HOLD_FIRST:_AnimationState$2.HOLD_SUBSEQUENT;return}t:for(let o=0;o<r;o++){const u=s[o],d=u.getPropertyId();if(!c.add(d))a[o]=_AnimationState$2.SUBSEQUENT;else if(e==null||u instanceof AttachmentTimeline$2||u instanceof DrawOrderTimeline$2||u instanceof EventTimeline$2||!e.animation.hasTimeline(d))a[o]=_AnimationState$2.FIRST;else{for(let m=e.mixingTo;m!=null;m=m.mixingTo)if(!m.animation.hasTimeline(d)){if(t.mixDuration>0){a[o]=_AnimationState$2.HOLD_MIX,h[o]=m;continue t}break}a[o]=_AnimationState$2.HOLD_FIRST}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,s){_AnimationState$2.deprecatedWarning1||(_AnimationState$2.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,s)}addAnimationByName(t,e,s,r){_AnimationState$2.deprecatedWarning2||(_AnimationState$2.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,s,r)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return _AnimationState$2.deprecatedWarning3||(_AnimationState$2.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let AnimationState$2=_AnimationState$2;AnimationState$2.emptyAnimation=new Animation$4("<empty>",[],0);AnimationState$2.SUBSEQUENT=0;AnimationState$2.FIRST=1;AnimationState$2.HOLD_SUBSEQUENT=2;AnimationState$2.HOLD_FIRST=3;AnimationState$2.HOLD_MIX=4;AnimationState$2.SETUP=1;AnimationState$2.CURRENT=2;AnimationState$2.deprecatedWarning1=!1;AnimationState$2.deprecatedWarning2=!1;AnimationState$2.deprecatedWarning3=!1;const _TrackEntry$2=class{constructor(){this.mixBlend=MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return _TrackEntry$2.deprecatedWarning1||(_TrackEntry$2.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){_TrackEntry$2.deprecatedWarning1||(_TrackEntry$2.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return _TrackEntry$2.deprecatedWarning2||(_TrackEntry$2.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){_TrackEntry$2.deprecatedWarning2||(_TrackEntry$2.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let TrackEntry$2=_TrackEntry$2;TrackEntry$2.deprecatedWarning1=!1;TrackEntry$2.deprecatedWarning2=!1;const _EventQueue$1=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(EventType$2.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(EventType$2.interrupt),this.objects.push(t)}end(t){this.objects.push(EventType$2.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(EventType$2.dispose),this.objects.push(t)}complete(t){this.objects.push(EventType$2.complete),this.objects.push(t)}event(t,e){this.objects.push(EventType$2.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return _EventQueue$1.deprecatedWarning1||(_EventQueue$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){const r=t[s],a=t[s+1];switch(r){case EventType$2.start:a.listener!=null&&a.listener.start&&a.listener.start(a);for(let o=0;o<e.length;o++)e[o].start&&e[o].start(a);a.onStart&&this.deprecateStuff()&&a.onStart(a.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(a.trackIndex);break;case EventType$2.interrupt:a.listener!=null&&a.listener.interrupt&&a.listener.interrupt(a);for(let o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(a);break;case EventType$2.end:a.listener!=null&&a.listener.end&&a.listener.end(a);for(let o=0;o<e.length;o++)e[o].end&&e[o].end(a);a.onEnd&&this.deprecateStuff()&&a.onEnd(a.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(a.trackIndex);case EventType$2.dispose:a.listener!=null&&a.listener.dispose&&a.listener.dispose(a);for(let o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(a);this.animState.trackEntryPool.free(a);break;case EventType$2.complete:a.listener!=null&&a.listener.complete&&a.listener.complete(a);for(let o=0;o<e.length;o++)e[o].complete&&e[o].complete(a);const h=MathUtils.toInt(a.loopsCount());a.onComplete&&this.deprecateStuff()&&a.onComplete(a.trackIndex,h),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(a.trackIndex,h);break;case EventType$2.event:const c=t[s+++2];a.listener!=null&&a.listener.event&&a.listener.event(a,c);for(let o=0;o<e.length;o++)e[o].event&&e[o].event(a,c);a.onEvent&&this.deprecateStuff()&&a.onEvent(a.trackIndex,c),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(a.trackIndex,c);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let EventQueue$2=_EventQueue$1;EventQueue$2.deprecatedWarning1=!1;var EventType$2=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(EventType$2||{});let AnimationStateAdapter$1=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};const _AnimationStateData$1=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){const r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);const a=this.skeletonData.findAnimation(e);if(a==null)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,a,s)}setMixByName(t,e,s){_AnimationStateData$1.deprecatedWarning1||(_AnimationStateData$1.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,s)}setMixWith(t,e,s){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=s}getMix(t,e){const s=`${t.name}.${e.name}`,r=this.animationToMixTime[s];return r===void 0?this.defaultMix:r}};let AnimationStateData$2=_AnimationStateData$1;AnimationStateData$2.deprecatedWarning1=!1;let AtlasAttachmentLoader$2=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);const a=new RegionAttachment$2(e);return a.region=r,a}newMeshAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);const a=new MeshAttachment$2(e);return a.region=r,a}newBoundingBoxAttachment(t,e){return new BoundingBoxAttachment$2(e)}newPathAttachment(t,e){return new PathAttachment$2(e)}newPointAttachment(t,e){return new PointAttachment$2(e)}newClippingAttachment(t,e){return new ClippingAttachment$2(e)}},Bone$2=class{constructor(t,e,s){if(this.matrix=new Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,a,h,c){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=a,this.ashearX=h,this.ashearY=c,this.appliedValid=!0;const o=this.parent,u=this.matrix,d=this.skeleton.scaleX,m=-this.skeleton.scaleY;if(o==null){const v=this.skeleton,U=s+90+c;u.a=MathUtils.cosDeg(s+h)*r*d,u.c=MathUtils.cosDeg(U)*a*d,u.b=MathUtils.sinDeg(s+h)*r*m,u.d=MathUtils.sinDeg(U)*a*m,u.tx=t*d+v.x,u.ty=e*m+v.y;return}let p=o.matrix.a,g=o.matrix.c,_=o.matrix.b,y=o.matrix.d;switch(u.tx=p*t+g*e+o.matrix.tx,u.ty=_*t+y*e+o.matrix.ty,this.data.transformMode){case TransformMode.Normal:{const v=s+90+c,U=MathUtils.cosDeg(s+h)*r,w=MathUtils.cosDeg(v)*a,k=MathUtils.sinDeg(s+h)*r,N=MathUtils.sinDeg(v)*a;u.a=p*U+g*k,u.c=p*w+g*N,u.b=_*U+y*k,u.d=_*w+y*N;return}case TransformMode.OnlyTranslation:{const v=s+90+c;u.a=MathUtils.cosDeg(s+h)*r,u.c=MathUtils.cosDeg(v)*a,u.b=MathUtils.sinDeg(s+h)*r,u.d=MathUtils.sinDeg(v)*a;break}case TransformMode.NoRotationOrReflection:{let v=p*p+_*_,U=0;v>1e-4?(v=Math.abs(p*y-g*_)/v,p/=this.skeleton.scaleX,_/=this.skeleton.scaleY,g=_*v,y=p*v,U=Math.atan2(_,p)*MathUtils.radDeg):(p=0,_=0,U=90-Math.atan2(y,g)*MathUtils.radDeg);const w=s+h-U,k=s+c-U+90,N=MathUtils.cosDeg(w)*r,W=MathUtils.cosDeg(k)*a,et=MathUtils.sinDeg(w)*r,it=MathUtils.sinDeg(k)*a;u.a=p*N-g*et,u.c=p*W-g*it,u.b=_*N+y*et,u.d=_*W+y*it;break}case TransformMode.NoScale:case TransformMode.NoScaleOrReflection:{const v=MathUtils.cosDeg(s),U=MathUtils.sinDeg(s);let w=(p*v+g*U)/d,k=(_*v+y*U)/m,N=Math.sqrt(w*w+k*k);N>1e-5&&(N=1/N),w*=N,k*=N,N=Math.sqrt(w*w+k*k),this.data.transformMode==TransformMode.NoScale&&p*y-g*_<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(N=-N);const W=Math.PI/2+Math.atan2(k,w),et=Math.cos(W)*N,it=Math.sin(W)*N,ft=MathUtils.cosDeg(h)*r,mt=MathUtils.cosDeg(90+c)*a,xt=MathUtils.sinDeg(h)*r,yt=MathUtils.sinDeg(90+c)*a;u.a=w*ft+et*xt,u.c=w*mt+et*yt,u.b=k*ft+it*xt,u.d=k*mt+it*yt;break}}u.a*=d,u.c*=d,u.b*=m,u.d*=m}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*MathUtils.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*MathUtils.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*MathUtils.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*MathUtils.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),a=e.tx-s.tx,h=e.ty-s.ty;this.ax=a*s.d*r-h*s.c*r,this.ay=h*s.a*r-a*s.b*r;const c=r*s.d,o=r*s.a,u=r*s.c,d=r*s.b,m=c*e.a-u*e.b,p=c*e.c-u*e.d,g=o*e.b-d*e.a,_=o*e.d-d*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(m*m+g*g),this.ascaleX>1e-4){const y=m*_-p*g;this.ascaleY=y/this.ascaleX,this.ashearY=Math.atan2(m*p+g*_,y)*MathUtils.radDeg,this.arotation=Math.atan2(g,m)*MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(p*p+_*_),this.ashearY=0,this.arotation=90-Math.atan2(_,p)*MathUtils.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=1/(s*h-r*a),o=t.x-e.tx,u=t.y-e.ty;return t.x=o*h*c-u*r*c,t.y=u*s*c-o*a*c,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*MathUtils.radDeg}localToWorldRotation(t){const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*MathUtils.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=MathUtils.cosDeg(t),o=MathUtils.sinDeg(t);e.a=c*s-o*a,e.c=c*r-o*h,e.b=o*s+c*a,e.d=o*r+c*h,this.appliedValid=!1}},BoneData$2=class{constructor(t,e,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,this.skinRequired=!1,this.color=new Color,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}},ConstraintData$1=class{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}},Event$3=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},EventData$2=class{constructor(t){this.name=t}},IkConstraint$2=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}}apply1(t,e,s,r,a,h,c){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,u=o.a;let d=o.c;const m=o.b;let p=o.d,g=-t.ashearX-t.arotation,_=0,y=0;switch(t.data.transformMode){case TransformMode.OnlyTranslation:_=e-t.worldX,y=s-t.worldY;break;case TransformMode.NoRotationOrReflection:const w=Math.abs(u*p-d*m)/(u*u+m*m),k=u/t.skeleton.scaleX,N=m/t.skeleton.scaleY;d=-N*w*t.skeleton.scaleX,p=k*w*t.skeleton.scaleY,g+=Math.atan2(N,k)*MathUtils.radDeg;default:const W=e-o.tx,et=s-o.ty,it=u*p-d*m;_=(W*p-et*d)/it-t.ax,y=(et*u-W*m)/it-t.ay}g+=Math.atan2(y,_)*MathUtils.radDeg,t.ascaleX<0&&(g+=180),g>180?g-=360:g<-180&&(g+=360);let v=t.ascaleX,U=t.ascaleY;if(r||a){switch(t.data.transformMode){case TransformMode.NoScale:case TransformMode.NoScaleOrReflection:_=e-t.worldX,y=s-t.worldY}const w=t.data.length*v,k=Math.sqrt(_*_+y*y);if(r&&k<w||a&&k>w&&w>1e-4){const N=(k/w-1)*c+1;v*=N,h&&(U*=N)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+g*c,v,U,t.ashearX,t.ashearY)}apply2(t,e,s,r,a,h,c,o){if(o==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const u=t.ax,d=t.ay;let m=t.ascaleX,p=m,g=t.ascaleY,_=e.ascaleX;const y=t.matrix;let v=0,U=0,w=0;m<0?(m=-m,v=180,w=-1):(v=0,w=1),g<0&&(g=-g,w=-w),_<0?(_=-_,U=180):U=0;const k=e.ax;let N=0,W=0,et=0,it=y.a,ft=y.c,mt=y.b,xt=y.d;const yt=Math.abs(m-g)<=1e-4;yt?(N=e.ay,W=it*k+ft*N+y.tx,et=mt*k+xt*N+y.ty):(N=0,W=it*k+y.tx,et=mt*k+y.ty);const vt=t.parent.matrix;it=vt.a,ft=vt.c,mt=vt.b,xt=vt.d;const St=1/(it*xt-ft*mt);let wt=W-vt.tx,Ct=et-vt.ty;const It=(wt*xt-Ct*ft)*St-u,Pt=(Ct*it-wt*mt)*St-d,Xt=Math.sqrt(It*It+Pt*Pt);let Ut=e.data.length*_,Et,Ft;if(Xt<1e-4){this.apply1(t,s,r,!1,h,!1,o),e.updateWorldTransformWith(k,N,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}wt=s-vt.tx,Ct=r-vt.ty;let Lt=(wt*xt-Ct*ft)*St-u,Ht=(Ct*it-wt*mt)*St-d,Wt=Lt*Lt+Ht*Ht;if(c!=0){c*=m*(_+1)/2;const ne=Math.sqrt(Wt),se=ne-Xt-Ut*m+c;if(se>0){let Nt=Math.min(1,se/(c*2))-1;Nt=(se-c*(1-Nt*Nt))/ne,Lt-=Nt*Lt,Ht-=Nt*Ht,Wt=Lt*Lt+Ht*Ht}}t:if(yt){Ut*=m;let ne=(Wt-Xt*Xt-Ut*Ut)/(2*Xt*Ut);ne<-1?ne=-1:ne>1&&(ne=1,h&&(p*=(Math.sqrt(Wt)/(Xt+Ut)-1)*o+1)),Ft=Math.acos(ne)*a,it=Xt+Ut*ne,ft=Ut*Math.sin(Ft),Et=Math.atan2(Ht*it-Lt*ft,Lt*it+Ht*ft)}else{it=m*Ut,ft=g*Ut;const ne=it*it,se=ft*ft,Nt=Math.atan2(Ht,Lt);mt=se*Xt*Xt+ne*Wt-ne*se;const Yt=-2*se*Xt,zt=se-ne;if(xt=Yt*Yt-4*zt*mt,xt>=0){let me=Math.sqrt(xt);Yt<0&&(me=-me),me=-(Yt+me)/2;const xe=me/zt,he=mt/me,ye=Math.abs(xe)<Math.abs(he)?xe:he;if(ye*ye<=Wt){Ct=Math.sqrt(Wt-ye*ye)*a,Et=Nt-Math.atan2(Ct,ye),Ft=Math.atan2(Ct/g,(ye-Xt)/m);break t}}let te=MathUtils.PI,Qt=Xt-it,ie=Qt*Qt,re=0,le=0,oe=Xt+it,ge=oe*oe,pe=0;mt=-it*Xt/(ne-se),mt>=-1&&mt<=1&&(mt=Math.acos(mt),wt=it*Math.cos(mt)+Xt,Ct=ft*Math.sin(mt),xt=wt*wt+Ct*Ct,xt<ie&&(te=mt,ie=xt,Qt=wt,re=Ct),xt>ge&&(le=mt,ge=xt,oe=wt,pe=Ct)),Wt<=(ie+ge)/2?(Et=Nt-Math.atan2(re*a,Qt),Ft=te*a):(Et=Nt-Math.atan2(pe*a,oe),Ft=le*a)}const Zt=Math.atan2(N,k)*w;let ee=t.arotation;Et=(Et-Zt)*MathUtils.radDeg+v-ee,Et>180?Et-=360:Et<-180&&(Et+=360),t.updateWorldTransformWith(u,d,ee+Et*o,p,t.ascaleY,0,0),ee=e.arotation,Ft=((Ft+Zt)*MathUtils.radDeg-e.ashearX)*w+U-ee,Ft>180?Ft-=360:Ft<-180&&(Ft+=360),e.updateWorldTransformWith(k,N,ee+Ft*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},IkConstraintData$2=class extends ConstraintData$1{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},PathConstraintData$2=class extends ConstraintData$1{constructor(t){super(t,0,!1),this.bones=new Array}};var SpacingMode$2=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(SpacingMode$2||{});const _PathConstraint$2=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,r=t.bones.length;s<r;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof PathAttachment$2))return;const e=this.rotateMix,s=this.translateMix,r=s>0,a=e>0;if(!r&&!a)return;const h=this.data,c=h.spacingMode,o=c==SpacingMode$2.Length,u=h.rotateMode,d=u==RotateMode.Tangent,m=u==RotateMode.ChainScale,p=this.bones.length,g=d?p:p+1,_=this.bones,y=Utils.setArraySize(this.spaces,g);let v=null;const U=this.spacing;if(m||o){m&&(v=Utils.setArraySize(this.lengths,p));for(let it=0,ft=g-1;it<ft;){const mt=_[it],xt=mt.data.length;if(xt<_PathConstraint$2.epsilon)m&&(v[it]=0),y[++it]=0;else{const yt=xt*mt.matrix.a,vt=xt*mt.matrix.b,St=Math.sqrt(yt*yt+vt*vt);m&&(v[it]=St),y[++it]=(o?xt+U:U)*St/xt}}}else for(let it=1;it<g;it++)y[it]=U;const w=this.computeWorldPositions(t,g,d,h.positionMode==PositionMode.Percent,c==SpacingMode$2.Percent);let k=w[0],N=w[1],W=h.offsetRotation,et=!1;if(W==0)et=u==RotateMode.Chain;else{et=!1;const it=this.target.bone.matrix;W*=it.a*it.d-it.b*it.c>0?MathUtils.degRad:-MathUtils.degRad}for(let it=0,ft=3;it<p;it++,ft+=3){const mt=_[it],xt=mt.matrix;xt.tx+=(k-xt.tx)*s,xt.ty+=(N-xt.ty)*s;const yt=w[ft],vt=w[ft+1],St=yt-k,wt=vt-N;if(m){const Ct=v[it];if(Ct!=0){const It=(Math.sqrt(St*St+wt*wt)/Ct-1)*e+1;xt.a*=It,xt.b*=It}}if(k=yt,N=vt,a){const Ct=xt.a,It=xt.c,Pt=xt.b,Xt=xt.d;let Ut=0,Et=0,Ft=0;if(d&&(d?Ut=w[ft-1]:y[it+1]==0?Ut=w[ft+2]:Ut=Math.atan2(wt,St)),Ut-=Math.atan2(Pt,Ct),et){Et=Math.cos(Ut),Ft=Math.sin(Ut);const Lt=mt.data.length;k+=(Lt*(Et*Ct-Ft*Pt)-St)*e,N+=(Lt*(Ft*Ct+Et*Pt)-wt)*e}else Ut+=W;Ut>MathUtils.PI?Ut-=MathUtils.PI2:Ut<-MathUtils.PI&&(Ut+=MathUtils.PI2),Ut*=e,Et=Math.cos(Ut),Ft=Math.sin(Ut),xt.a=Et*Ct-Ft*Pt,xt.c=Et*It-Ft*Xt,xt.b=Ft*Ct+Et*Pt,xt.d=Ft*It+Et*Xt}mt.appliedValid=!1}}computeWorldPositions(t,e,s,r,a){const h=this.target;let c=this.position;const o=this.spaces,u=Utils.setArraySize(this.positions,e*3+2);let d=null;const m=t.closed;let p=t.worldVerticesLength,g=p/6,_=_PathConstraint$2.NONE;if(!t.constantSpeed){const Ut=t.lengths;g-=m?1:2;const Et=Ut[g];if(r&&(c*=Et),a)for(let Ft=0;Ft<e;Ft++)o[Ft]*=Et;d=Utils.setArraySize(this.world,8);for(let Ft=0,Lt=0,Ht=0;Ft<e;Ft++,Lt+=3){const Wt=o[Ft];c+=Wt;let Zt=c;if(m)Zt%=Et,Zt<0&&(Zt+=Et),Ht=0;else if(Zt<0){_!=_PathConstraint$2.BEFORE&&(_=_PathConstraint$2.BEFORE,t.computeWorldVertices(h,2,4,d,0,2)),this.addBeforePosition(Zt,d,0,u,Lt);continue}else if(Zt>Et){_!=_PathConstraint$2.AFTER&&(_=_PathConstraint$2.AFTER,t.computeWorldVertices(h,p-6,4,d,0,2)),this.addAfterPosition(Zt-Et,d,0,u,Lt);continue}for(;;Ht++){const ee=Ut[Ht];if(!(Zt>ee)){if(Ht==0)Zt/=ee;else{const ne=Ut[Ht-1];Zt=(Zt-ne)/(ee-ne)}break}}Ht!=_&&(_=Ht,m&&Ht==g?(t.computeWorldVertices(h,p-4,4,d,0,2),t.computeWorldVertices(h,0,4,d,4,2)):t.computeWorldVertices(h,Ht*6+2,8,d,0,2)),this.addCurvePosition(Zt,d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],u,Lt,s||Ft>0&&Wt==0)}return u}m?(p+=2,d=Utils.setArraySize(this.world,p),t.computeWorldVertices(h,2,p-4,d,0,2),t.computeWorldVertices(h,0,2,d,p-4,2),d[p-2]=d[0],d[p-1]=d[1]):(g--,p-=4,d=Utils.setArraySize(this.world,p),t.computeWorldVertices(h,2,p,d,0,2));const y=Utils.setArraySize(this.curves,g);let v=0,U=d[0],w=d[1],k=0,N=0,W=0,et=0,it=0,ft=0,mt=0,xt=0,yt=0,vt=0,St=0,wt=0,Ct=0,It=0;for(let Ut=0,Et=2;Ut<g;Ut++,Et+=6)k=d[Et],N=d[Et+1],W=d[Et+2],et=d[Et+3],it=d[Et+4],ft=d[Et+5],mt=(U-k*2+W)*.1875,xt=(w-N*2+et)*.1875,yt=((k-W)*3-U+it)*.09375,vt=((N-et)*3-w+ft)*.09375,St=mt*2+yt,wt=xt*2+vt,Ct=(k-U)*.75+mt+yt*.16666667,It=(N-w)*.75+xt+vt*.16666667,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St,It+=wt,St+=yt,wt+=vt,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St,It+=wt,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St+yt,It+=wt+vt,v+=Math.sqrt(Ct*Ct+It*It),y[Ut]=v,U=it,w=ft;if(r&&(c*=v),a)for(let Ut=0;Ut<e;Ut++)o[Ut]*=v;const Pt=this.segments;let Xt=0;for(let Ut=0,Et=0,Ft=0,Lt=0;Ut<e;Ut++,Et+=3){const Ht=o[Ut];c+=Ht;let Wt=c;if(m)Wt%=v,Wt<0&&(Wt+=v),Ft=0;else if(Wt<0){this.addBeforePosition(Wt,d,0,u,Et);continue}else if(Wt>v){this.addAfterPosition(Wt-v,d,p-4,u,Et);continue}for(;;Ft++){const Zt=y[Ft];if(!(Wt>Zt)){if(Ft==0)Wt/=Zt;else{const ee=y[Ft-1];Wt=(Wt-ee)/(Zt-ee)}break}}if(Ft!=_){_=Ft;let Zt=Ft*6;for(U=d[Zt],w=d[Zt+1],k=d[Zt+2],N=d[Zt+3],W=d[Zt+4],et=d[Zt+5],it=d[Zt+6],ft=d[Zt+7],mt=(U-k*2+W)*.03,xt=(w-N*2+et)*.03,yt=((k-W)*3-U+it)*.006,vt=((N-et)*3-w+ft)*.006,St=mt*2+yt,wt=xt*2+vt,Ct=(k-U)*.3+mt+yt*.16666667,It=(N-w)*.3+xt+vt*.16666667,Xt=Math.sqrt(Ct*Ct+It*It),Pt[0]=Xt,Zt=1;Zt<8;Zt++)Ct+=St,It+=wt,St+=yt,wt+=vt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[Zt]=Xt;Ct+=St,It+=wt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[8]=Xt,Ct+=St+yt,It+=wt+vt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[9]=Xt,Lt=0}for(Wt*=Xt;;Lt++){const Zt=Pt[Lt];if(!(Wt>Zt)){if(Lt==0)Wt/=Zt;else{const ee=Pt[Lt-1];Wt=Lt+(Wt-ee)/(Zt-ee)}break}}this.addCurvePosition(Wt*.1,U,w,k,N,W,et,it,ft,u,Et,s||Ut>0&&Ht==0)}return u}addBeforePosition(t,e,s,r,a){const h=e[s],c=e[s+1],o=e[s+2]-h,u=e[s+3]-c,d=Math.atan2(u,o);r[a]=h+t*Math.cos(d),r[a+1]=c+t*Math.sin(d),r[a+2]=d}addAfterPosition(t,e,s,r,a){const h=e[s+2],c=e[s+3],o=h-e[s],u=c-e[s+1],d=Math.atan2(u,o);r[a]=h+t*Math.cos(d),r[a+1]=c+t*Math.sin(d),r[a+2]=d}addCurvePosition(t,e,s,r,a,h,c,o,u,d,m,p){(t==0||isNaN(t))&&(t=1e-4);const g=t*t,_=g*t,y=1-t,v=y*y,U=v*y,w=y*t,k=w*3,N=y*k,W=k*t,et=e*U+r*N+h*W+o*_,it=s*U+a*N+c*W+u*_;d[m]=et,d[m+1]=it,p&&(d[m+2]=Math.atan2(it-(s*v+a*w*2+c*g),et-(e*v+r*w*2+h*g)))}};let PathConstraint$2=_PathConstraint$2;PathConstraint$2.NONE=-1;PathConstraint$2.BEFORE=-2;PathConstraint$2.AFTER=-3;PathConstraint$2.epsilon=1e-5;let TransformConstraint$2=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Vector2,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target,h=a.matrix,c=h.a,o=h.c,u=h.b,d=h.d,m=c*d-o*u>0?MathUtils.degRad:-MathUtils.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,_=this.bones;for(let y=0,v=_.length;y<v;y++){const U=_[y];let w=!1;const k=U.matrix;if(t!=0){const N=k.a,W=k.c,et=k.b,it=k.d;let ft=Math.atan2(u,c)-Math.atan2(et,N)+p;ft>MathUtils.PI?ft-=MathUtils.PI2:ft<-MathUtils.PI&&(ft+=MathUtils.PI2),ft*=t;const mt=Math.cos(ft),xt=Math.sin(ft);k.a=mt*N-xt*et,k.c=mt*W-xt*it,k.b=xt*N+mt*et,k.d=xt*W+mt*it,w=!0}if(e!=0){const N=this.temp;a.localToWorld(N.set(this.data.offsetX,this.data.offsetY)),k.tx+=(N.x-k.tx)*e,k.ty+=(N.y-k.ty)*e,w=!0}if(s>0){let N=Math.sqrt(k.a*k.a+k.b*k.b),W=Math.sqrt(c*c+u*u);N>1e-5&&(N=(N+(W-N+this.data.offsetScaleX)*s)/N),k.a*=N,k.b*=N,N=Math.sqrt(k.c*k.c+k.d*k.d),W=Math.sqrt(o*o+d*d),N>1e-5&&(N=(N+(W-N+this.data.offsetScaleY)*s)/N),k.c*=N,k.d*=N,w=!0}if(r>0){const N=k.c,W=k.d,et=Math.atan2(W,N);let it=Math.atan2(d,o)-Math.atan2(u,c)-(et-Math.atan2(k.b,k.a));it>MathUtils.PI?it-=MathUtils.PI2:it<-MathUtils.PI&&(it+=MathUtils.PI2),it=et+(it+g)*r;const ft=Math.sqrt(N*N+W*W);k.c=Math.cos(it)*ft,k.d=Math.sin(it)*ft,w=!0}w&&(U.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target,h=a.matrix,c=h.a,o=h.c,u=h.b,d=h.d,m=c*d-o*u>0?MathUtils.degRad:-MathUtils.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,_=this.bones;for(let y=0,v=_.length;y<v;y++){const U=_[y];let w=!1;const k=U.matrix;if(t!=0){const N=k.a,W=k.c,et=k.b,it=k.d;let ft=Math.atan2(u,c)+p;ft>MathUtils.PI?ft-=MathUtils.PI2:ft<-MathUtils.PI&&(ft+=MathUtils.PI2),ft*=t;const mt=Math.cos(ft),xt=Math.sin(ft);k.a=mt*N-xt*et,k.c=mt*W-xt*it,k.b=xt*N+mt*et,k.d=xt*W+mt*it,w=!0}if(e!=0){const N=this.temp;a.localToWorld(N.set(this.data.offsetX,this.data.offsetY)),k.tx+=N.x*e,k.ty+=N.y*e,w=!0}if(s>0){let N=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*s+1;k.a*=N,k.b*=N,N=(Math.sqrt(o*o+d*d)-1+this.data.offsetScaleY)*s+1,k.c*=N,k.d*=N,w=!0}if(r>0){let N=Math.atan2(d,o)-Math.atan2(u,c);N>MathUtils.PI?N-=MathUtils.PI2:N<-MathUtils.PI&&(N+=MathUtils.PI2);const W=k.c,et=k.d;N=Math.atan2(et,W)+(N-MathUtils.PI/2+g)*r;const it=Math.sqrt(W*W+et*et);k.c=Math.cos(N)*it,k.d=Math.sin(N)*it,w=!0}w&&(U.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();const h=this.bones;for(let c=0,o=h.length;c<o;c++){const u=h[c];u.appliedValid||u.updateAppliedTransform();let d=u.arotation;if(t!=0){let v=a.arotation-d+this.data.offsetRotation;v-=(16384-(16384.499999999996-v/360|0))*360,d+=v*t}let m=u.ax,p=u.ay;e!=0&&(m+=(a.ax-m+this.data.offsetX)*e,p+=(a.ay-p+this.data.offsetY)*e);let g=u.ascaleX,_=u.ascaleY;s>0&&(g>1e-5&&(g=(g+(a.ascaleX-g+this.data.offsetScaleX)*s)/g),_>1e-5&&(_=(_+(a.ascaleY-_+this.data.offsetScaleY)*s)/_));const y=u.ashearY;if(r>0){let v=a.ashearY-y+this.data.offsetShearY;v-=(16384-(16384.499999999996-v/360|0))*360,u.shearY+=v*r}u.updateWorldTransformWith(m,p,d,g,_,u.ashearX,y)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();const h=this.bones;for(let c=0,o=h.length;c<o;c++){const u=h[c];u.appliedValid||u.updateAppliedTransform();let d=u.arotation;t!=0&&(d+=(a.arotation+this.data.offsetRotation)*t);let m=u.ax,p=u.ay;e!=0&&(m+=(a.ax+this.data.offsetX)*e,p+=(a.ay+this.data.offsetY)*e);let g=u.ascaleX,_=u.ascaleY;s>0&&(g>1e-5&&(g*=(a.ascaleX-1+this.data.offsetScaleX)*s+1),_>1e-5&&(_*=(a.ascaleY-1+this.data.offsetScaleY)*s+1));let y=u.ashearY;r>0&&(y+=(a.ashearY+this.data.offsetShearY)*r),u.updateWorldTransformWith(m,p,d,g,_,u.ashearX,y)}}};const _Skeleton$2=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const s=t.bones[e];let r;if(s.parent==null)r=new Bone$2(s,this,null);else{const a=this.bones[s.parent.index];r=new Bone$2(s,this,a),a.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const s=t.slots[e],r=this.bones[s.boneData.index],a=new Slot$2(s,r);this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const s=t.ikConstraints[e];this.ikConstraints.push(new IkConstraint$2(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const s=t.transformConstraints[e];this.transformConstraints.push(new TransformConstraint$2(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const s=t.pathConstraints[e];this.pathConstraints.push(new PathConstraint$2(s,this))}this.color=new Color(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let d=0,m=e.length;d<m;d++){const p=e[d];p.sorted=p.data.skinRequired,p.active=!p.sorted}if(this.skin!=null){const d=this.skin.bones;for(let m=0,p=this.skin.bones.length;m<p;m++){let g=this.bones[d[m].index];do g.sorted=!1,g.active=!0,g=g.parent;while(g!=null)}}const s=this.ikConstraints,r=this.transformConstraints,a=this.pathConstraints,h=s.length,c=r.length,o=a.length,u=h+c+o;t:for(let d=0;d<u;d++){for(let m=0;m<h;m++){const p=s[m];if(p.data.order==d){this.sortIkConstraint(p);continue t}}for(let m=0;m<c;m++){const p=r[m];if(p.data.order==d){this.sortTransformConstraint(p);continue t}}for(let m=0;m<o;m++){const p=a[m];if(p.data.order==d){this.sortPathConstraint(p);continue t}}}for(let d=0,m=e.length;d<m;d++)this.sortBone(e[d])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&Utils.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const s=t.bones,r=s[0];if(this.sortBone(r),s.length>1){const a=s[s.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(t),this.sortReset(r.children),s[s.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin!=null&&Utils.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,s=e.data.index,r=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,s,r),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,r);for(let o=0,u=this.data.skins.length;o<u;o++)this.sortPathConstraintAttachment(this.data.skins[o],s,r);const a=e.getAttachment();a instanceof PathAttachment$2&&this.sortPathConstraintAttachmentWith(a,r);const h=t.bones,c=h.length;for(let o=0;o<c;o++)this.sortBone(h[o]);this._updateCache.push(t);for(let o=0;o<c;o++)this.sortReset(h[o].children);for(let o=0;o<c;o++)h[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&Utils.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,s=e.length;if(t.data.local)for(let r=0;r<s;r++){const a=e[r];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(let r=0;r<s;r++)this.sortBone(e[r]);this._updateCache.push(t);for(let r=0;r<s;r++)this.sortReset(e[r].children);for(let r=0;r<s;r++)e[r].sorted=!0}sortPathConstraintAttachment(t,e,s){const r=t.attachments[e];if(r)for(const a in r)this.sortPathConstraintAttachmentWith(r[a],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof PathAttachment$2))return;const s=t.bones;if(s==null)this.sortBone(e);else{const r=this.bones;let a=0;for(;a<s.length;){const h=s[a++];for(let c=a+h;a<c;a++){const o=s[a];this.sortBone(r[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){const r=t[e];r.active&&(r.sorted&&this.sortReset(r.children),r.sorted=!1)}}updateWorldTransform(){const t=this.updateCacheReset;for(let s=0,r=t.length;s<r;s++){const a=t[s];a.ax=a.x,a.ay=a.y,a.arotation=a.rotation,a.ascaleX=a.scaleX,a.ascaleY=a.scaleY,a.ashearX=a.shearX,a.ashearY=a.shearY,a.appliedValid=!0}const e=this._updateCache;for(let s=0,r=e.length;s<r;s++)e[s].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let a=0,h=t.length;a<h;a++)t[a].setToSetupPose();const e=this.ikConstraints;for(let a=0,h=e.length;a<h;a++){const c=e[a];c.mix=c.data.mix,c.softness=c.data.softness,c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch}const s=this.transformConstraints;for(let a=0,h=s.length;a<h;a++){const c=s[a],o=c.data;c.rotateMix=o.rotateMix,c.translateMix=o.translateMix,c.scaleMix=o.scaleMix,c.shearMix=o.shearMix}const r=this.pathConstraints;for(let a=0,h=r.length;a<h;a++){const c=r[a],o=c.data;c.position=o.position,c.spacing=o.spacing,c.rotateMix=o.rotateMix,c.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s],h=a.data.attachmentName;if(h!=null){const c=t.getAttachment(s,h);c!=null&&a.setAttachment(c)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const s=this.skin.getAttachment(t,e);if(s!=null)return s}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const s=this.slots;for(let r=0,a=s.length;r<a;r++){const h=s[r];if(h.data.name==t){let c=null;if(e!=null&&(c=this.getAttachment(r,e),c==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);h.setAttachment(c);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}getBounds(t,e,s=new Array(2)){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const r=this.drawOrder;let a=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let u=0,d=r.length;u<d;u++){const m=r[u];if(!m.bone.active)continue;let p=0,g=null;const _=m.getAttachment();if(_ instanceof RegionAttachment$2)p=8,g=Utils.setArraySize(s,p,0),_.computeWorldVertices(m.bone,g,0,2);else if(_ instanceof MeshAttachment$2){const y=_;p=y.worldVerticesLength,g=Utils.setArraySize(s,p,0),y.computeWorldVertices(m,0,p,g,0,2)}if(g!=null)for(let y=0,v=g.length;y<v;y+=2){const U=g[y],w=g[y+1];a=Math.min(a,U),h=Math.min(h,w),c=Math.max(c,U),o=Math.max(o,w)}}t.set(a,h),e.set(c-a,o-h)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){_Skeleton$2.deprecatedWarning1||(_Skeleton$2.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){_Skeleton$2.deprecatedWarning1||(_Skeleton$2.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let Skeleton$2=_Skeleton$2;Skeleton$2.deprecatedWarning1=!1;let SkeletonData$2=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}},SlotData$2=class{constructor(t,e,s){if(this.color=new Color(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}},TransformConstraintData$2=class extends ConstraintData$1{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},SkinEntry$1=class{constructor(t,e,s){this.slotIndex=t,this.name=e,this.attachment=s}},Skin$2=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}addSkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let a=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){a=!0;break}a||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let a=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){a=!0;break}a||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let a=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){a=!0;break}a||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let a=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){a=!0;break}a||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];r.attachment!=null&&(r.attachment instanceof MeshAttachment$2?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){const s=this.attachments[t];s&&(s[e]=null)}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const s=this.attachments[e];if(s)for(const r in s){const a=s[r];a&&t.push(new SkinEntry$1(e,r,a))}}return t}getAttachmentsForSlot(t,e){const s=this.attachments[t];if(s)for(const r in s){const a=s[r];a&&e.push(new SkinEntry$1(t,r,a))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const a=t.slots[r],h=a.getAttachment();if(h&&s<e.attachments.length){const c=e.attachments[s];for(const o in c){const u=c[o];if(h==u){const d=this.getAttachment(s,o);d!=null&&a.setAttachment(d);break}}}s++}}};const _SkeletonBinary=class{constructor(n){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=n}readSkeletonData(n){const t=this.scale,e=new SkeletonData$2;e.name="";const s=new BinaryInput(n);e.hash=s.readString(),e.version=s.readString(),e.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),e.x=s.readFloat(),e.y=s.readFloat(),e.width=s.readFloat(),e.height=s.readFloat();const r=s.readBoolean();r&&(e.fps=s.readFloat(),e.imagesPath=s.readString(),e.audioPath=s.readString());let a=0;a=s.readInt(!0);for(let c=0;c<a;c++)s.strings.push(s.readString());a=s.readInt(!0);for(let c=0;c<a;c++){const o=s.readString(),u=c==0?null:e.bones[s.readInt(!0)],d=new BoneData$2(c,o,u);d.rotation=s.readFloat(),d.x=s.readFloat()*t,d.y=s.readFloat()*t,d.scaleX=s.readFloat(),d.scaleY=s.readFloat(),d.shearX=s.readFloat(),d.shearY=s.readFloat(),d.length=s.readFloat()*t,d.transformMode=_SkeletonBinary.TransformModeValues[s.readInt(!0)],d.skinRequired=s.readBoolean(),r&&Color.rgba8888ToColor(d.color,s.readInt32()),e.bones.push(d)}a=s.readInt(!0);for(let c=0;c<a;c++){const o=s.readString(),u=e.bones[s.readInt(!0)],d=new SlotData$2(c,o,u);Color.rgba8888ToColor(d.color,s.readInt32());const m=s.readInt32();m!=-1&&Color.rgb888ToColor(d.darkColor=new Color,m),d.attachmentName=s.readStringRef(),d.blendMode=_SkeletonBinary.BlendModeValues[s.readInt(!0)],e.slots.push(d)}a=s.readInt(!0);for(let c=0,o;c<a;c++){const u=new IkConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let d=0;d<o;d++)u.bones.push(e.bones[s.readInt(!0)]);u.target=e.bones[s.readInt(!0)],u.mix=s.readFloat(),u.softness=s.readFloat()*t,u.bendDirection=s.readByte(),u.compress=s.readBoolean(),u.stretch=s.readBoolean(),u.uniform=s.readBoolean(),e.ikConstraints.push(u)}a=s.readInt(!0);for(let c=0,o;c<a;c++){const u=new TransformConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let d=0;d<o;d++)u.bones.push(e.bones[s.readInt(!0)]);u.target=e.bones[s.readInt(!0)],u.local=s.readBoolean(),u.relative=s.readBoolean(),u.offsetRotation=s.readFloat(),u.offsetX=s.readFloat()*t,u.offsetY=s.readFloat()*t,u.offsetScaleX=s.readFloat(),u.offsetScaleY=s.readFloat(),u.offsetShearY=s.readFloat(),u.rotateMix=s.readFloat(),u.translateMix=s.readFloat(),u.scaleMix=s.readFloat(),u.shearMix=s.readFloat(),e.transformConstraints.push(u)}a=s.readInt(!0);for(let c=0,o;c<a;c++){const u=new PathConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let d=0;d<o;d++)u.bones.push(e.bones[s.readInt(!0)]);u.target=e.slots[s.readInt(!0)],u.positionMode=_SkeletonBinary.PositionModeValues[s.readInt(!0)],u.spacingMode=_SkeletonBinary.SpacingModeValues[s.readInt(!0)],u.rotateMode=_SkeletonBinary.RotateModeValues[s.readInt(!0)],u.offsetRotation=s.readFloat(),u.position=s.readFloat(),u.positionMode==PositionMode.Fixed&&(u.position*=t),u.spacing=s.readFloat(),(u.spacingMode==SpacingMode$2.Length||u.spacingMode==SpacingMode$2.Fixed)&&(u.spacing*=t),u.rotateMix=s.readFloat(),u.translateMix=s.readFloat(),e.pathConstraints.push(u)}const h=this.readSkin(s,e,!0,r);h!=null&&(e.defaultSkin=h,e.skins.push(h));{let c=e.skins.length;for(Utils.setArraySize(e.skins,a=c+s.readInt(!0));c<a;c++)e.skins[c]=this.readSkin(s,e,!1,r)}a=this.linkedMeshes.length;for(let c=0;c<a;c++){const o=this.linkedMeshes[c],u=o.skin==null?e.defaultSkin:e.findSkin(o.skin);if(u==null)throw new Error(`Skin not found: ${o.skin}`);const d=u.getAttachment(o.slotIndex,o.parent);if(d==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?d:o.mesh,o.mesh.setParentMesh(d)}this.linkedMeshes.length=0,a=s.readInt(!0);for(let c=0;c<a;c++){const o=new EventData$2(s.readStringRef());o.intValue=s.readInt(!1),o.floatValue=s.readFloat(),o.stringValue=s.readString(),o.audioPath=s.readString(),o.audioPath!=null&&(o.volume=s.readFloat(),o.balance=s.readFloat()),e.events.push(o)}a=s.readInt(!0);for(let c=0;c<a;c++)e.animations.push(this.readAnimation(s,s.readString(),e));return e}readSkin(n,t,e,s){let r=null,a=0;if(e){if(a=n.readInt(!0),a==0)return null;r=new Skin$2("default")}else{r=new Skin$2(n.readStringRef()),r.bones.length=n.readInt(!0);for(let h=0,c=r.bones.length;h<c;h++)r.bones[h]=t.bones[n.readInt(!0)];for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(t.ikConstraints[n.readInt(!0)]);for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(t.transformConstraints[n.readInt(!0)]);for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(t.pathConstraints[n.readInt(!0)]);a=n.readInt(!0)}for(let h=0;h<a;h++){const c=n.readInt(!0);for(let o=0,u=n.readInt(!0);o<u;o++){const d=n.readStringRef(),m=this.readAttachment(n,t,r,c,d,s);m!=null&&r.setAttachment(c,d,m)}}return r}readAttachment(n,t,e,s,r,a){const h=this.scale;let c=n.readStringRef();c==null&&(c=r);const o=n.readByte();switch(_SkeletonBinary.AttachmentTypeValues[o]){case AttachmentType.Region:{let d=n.readStringRef();const m=n.readFloat(),p=n.readFloat(),g=n.readFloat(),_=n.readFloat(),y=n.readFloat(),v=n.readFloat(),U=n.readFloat(),w=n.readInt32();d==null&&(d=c);const k=this.attachmentLoader.newRegionAttachment(e,c,d);return k==null?null:(k.path=d,k.x=p*h,k.y=g*h,k.scaleX=_,k.scaleY=y,k.rotation=m,k.width=v*h,k.height=U*h,Color.rgba8888ToColor(k.color,w),k)}case AttachmentType.BoundingBox:{const d=n.readInt(!0),m=this.readVertices(n,d),p=a?n.readInt32():0,g=this.attachmentLoader.newBoundingBoxAttachment(e,c);return g==null?null:(g.worldVerticesLength=d<<1,g.vertices=m.vertices,g.bones=m.bones,a&&Color.rgba8888ToColor(g.color,p),g)}case AttachmentType.Mesh:{let d=n.readStringRef();const m=n.readInt32(),p=n.readInt(!0),g=this.readFloatArray(n,p<<1,1),_=this.readShortArray(n),y=this.readVertices(n,p),v=n.readInt(!0);let U=null,w=0,k=0;a&&(U=this.readShortArray(n),w=n.readFloat(),k=n.readFloat()),d==null&&(d=c);const N=this.attachmentLoader.newMeshAttachment(e,c,d);return N==null?null:(N.path=d,Color.rgba8888ToColor(N.color,m),N.bones=y.bones,N.vertices=y.vertices,N.worldVerticesLength=p<<1,N.triangles=_,N.regionUVs=new Float32Array(g),N.hullLength=v<<1,a&&(N.edges=U,N.width=w*h,N.height=k*h),N)}case AttachmentType.LinkedMesh:{let d=n.readStringRef();const m=n.readInt32(),p=n.readStringRef(),g=n.readStringRef(),_=n.readBoolean();let y=0,v=0;a&&(y=n.readFloat(),v=n.readFloat()),d==null&&(d=c);const U=this.attachmentLoader.newMeshAttachment(e,c,d);return U==null?null:(U.path=d,Color.rgba8888ToColor(U.color,m),a&&(U.width=y*h,U.height=v*h),this.linkedMeshes.push(new LinkedMesh$4(U,p,s,g,_)),U)}case AttachmentType.Path:{const d=n.readBoolean(),m=n.readBoolean(),p=n.readInt(!0),g=this.readVertices(n,p),_=Utils.newArray(p/3,0);for(let U=0,w=_.length;U<w;U++)_[U]=n.readFloat()*h;const y=a?n.readInt32():0,v=this.attachmentLoader.newPathAttachment(e,c);return v==null?null:(v.closed=d,v.constantSpeed=m,v.worldVerticesLength=p<<1,v.vertices=g.vertices,v.bones=g.bones,v.lengths=_,a&&Color.rgba8888ToColor(v.color,y),v)}case AttachmentType.Point:{const d=n.readFloat(),m=n.readFloat(),p=n.readFloat(),g=a?n.readInt32():0,_=this.attachmentLoader.newPointAttachment(e,c);return _==null?null:(_.x=m*h,_.y=p*h,_.rotation=d,a&&Color.rgba8888ToColor(_.color,g),_)}case AttachmentType.Clipping:{const d=n.readInt(!0),m=n.readInt(!0),p=this.readVertices(n,m),g=a?n.readInt32():0,_=this.attachmentLoader.newClippingAttachment(e,c);return _==null?null:(_.endSlot=t.slots[d],_.worldVerticesLength=m<<1,_.vertices=p.vertices,_.bones=p.bones,a&&Color.rgba8888ToColor(_.color,g),_)}}return null}readVertices(n,t){const e=t<<1,s=new Vertices$1,r=this.scale;if(!n.readBoolean())return s.vertices=this.readFloatArray(n,e,r),s;const a=new Array,h=new Array;for(let c=0;c<t;c++){const o=n.readInt(!0);h.push(o);for(let u=0;u<o;u++)h.push(n.readInt(!0)),a.push(n.readFloat()*r),a.push(n.readFloat()*r),a.push(n.readFloat())}return s.vertices=Utils.toFloatArray(a),s.bones=h,s}readFloatArray(n,t,e){const s=new Array(t);if(e==1)for(let r=0;r<t;r++)s[r]=n.readFloat();else for(let r=0;r<t;r++)s[r]=n.readFloat()*e;return s}readShortArray(n){const t=n.readInt(!0),e=new Array(t);for(let s=0;s<t;s++)e[s]=n.readShort();return e}readAnimation(n,t,e){const s=new Array,r=this.scale;let a=0;const h=new Color,c=new Color;for(let d=0,m=n.readInt(!0);d<m;d++){const p=n.readInt(!0);for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readByte(),v=n.readInt(!0);switch(y){case _SkeletonBinary.SLOT_ATTACHMENT:{const U=new AttachmentTimeline$2(v);U.slotIndex=p;for(let w=0;w<v;w++)U.setFrame(w,n.readFloat(),n.readStringRef());s.push(U),a=Math.max(a,U.frames[v-1]);break}case _SkeletonBinary.SLOT_COLOR:{const U=new ColorTimeline$1(v);U.slotIndex=p;for(let w=0;w<v;w++){const k=n.readFloat();Color.rgba8888ToColor(h,n.readInt32()),U.setFrame(w,k,h.r,h.g,h.b,h.a),w<v-1&&this.readCurve(n,w,U)}s.push(U),a=Math.max(a,U.frames[(v-1)*ColorTimeline$1.ENTRIES]);break}case _SkeletonBinary.SLOT_TWO_COLOR:{const U=new TwoColorTimeline$1(v);U.slotIndex=p;for(let w=0;w<v;w++){const k=n.readFloat();Color.rgba8888ToColor(h,n.readInt32()),Color.rgb888ToColor(c,n.readInt32()),U.setFrame(w,k,h.r,h.g,h.b,h.a,c.r,c.g,c.b),w<v-1&&this.readCurve(n,w,U)}s.push(U),a=Math.max(a,U.frames[(v-1)*TwoColorTimeline$1.ENTRIES]);break}}}}for(let d=0,m=n.readInt(!0);d<m;d++){const p=n.readInt(!0);for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readByte(),v=n.readInt(!0);switch(y){case _SkeletonBinary.BONE_ROTATE:{const U=new RotateTimeline$2(v);U.boneIndex=p;for(let w=0;w<v;w++)U.setFrame(w,n.readFloat(),n.readFloat()),w<v-1&&this.readCurve(n,w,U);s.push(U),a=Math.max(a,U.frames[(v-1)*RotateTimeline$2.ENTRIES]);break}case _SkeletonBinary.BONE_TRANSLATE:case _SkeletonBinary.BONE_SCALE:case _SkeletonBinary.BONE_SHEAR:{let U,w=1;y==_SkeletonBinary.BONE_SCALE?U=new ScaleTimeline$2(v):y==_SkeletonBinary.BONE_SHEAR?U=new ShearTimeline$2(v):(U=new TranslateTimeline$2(v),w=r),U.boneIndex=p;for(let k=0;k<v;k++)U.setFrame(k,n.readFloat(),n.readFloat()*w,n.readFloat()*w),k<v-1&&this.readCurve(n,k,U);s.push(U),a=Math.max(a,U.frames[(v-1)*TranslateTimeline$2.ENTRIES]);break}}}}for(let d=0,m=n.readInt(!0);d<m;d++){const p=n.readInt(!0),g=n.readInt(!0),_=new IkConstraintTimeline$2(g);_.ikConstraintIndex=p;for(let y=0;y<g;y++)_.setFrame(y,n.readFloat(),n.readFloat(),n.readFloat()*r,n.readByte(),n.readBoolean(),n.readBoolean()),y<g-1&&this.readCurve(n,y,_);s.push(_),a=Math.max(a,_.frames[(g-1)*IkConstraintTimeline$2.ENTRIES])}for(let d=0,m=n.readInt(!0);d<m;d++){const p=n.readInt(!0),g=n.readInt(!0),_=new TransformConstraintTimeline$2(g);_.transformConstraintIndex=p;for(let y=0;y<g;y++)_.setFrame(y,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat()),y<g-1&&this.readCurve(n,y,_);s.push(_),a=Math.max(a,_.frames[(g-1)*TransformConstraintTimeline$2.ENTRIES])}for(let d=0,m=n.readInt(!0);d<m;d++){const p=n.readInt(!0),g=e.pathConstraints[p];for(let _=0,y=n.readInt(!0);_<y;_++){const v=n.readByte(),U=n.readInt(!0);switch(v){case _SkeletonBinary.PATH_POSITION:case _SkeletonBinary.PATH_SPACING:{let w,k=1;v==_SkeletonBinary.PATH_SPACING?(w=new PathConstraintSpacingTimeline$2(U),(g.spacingMode==SpacingMode$2.Length||g.spacingMode==SpacingMode$2.Fixed)&&(k=r)):(w=new PathConstraintPositionTimeline$2(U),g.positionMode==PositionMode.Fixed&&(k=r)),w.pathConstraintIndex=p;for(let N=0;N<U;N++)w.setFrame(N,n.readFloat(),n.readFloat()*k),N<U-1&&this.readCurve(n,N,w);s.push(w),a=Math.max(a,w.frames[(U-1)*PathConstraintPositionTimeline$2.ENTRIES]);break}case _SkeletonBinary.PATH_MIX:{const w=new PathConstraintMixTimeline$2(U);w.pathConstraintIndex=p;for(let k=0;k<U;k++)w.setFrame(k,n.readFloat(),n.readFloat(),n.readFloat()),k<U-1&&this.readCurve(n,k,w);s.push(w),a=Math.max(a,w.frames[(U-1)*PathConstraintMixTimeline$2.ENTRIES]);break}}}}for(let d=0,m=n.readInt(!0);d<m;d++){const p=e.skins[n.readInt(!0)];for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readInt(!0);for(let v=0,U=n.readInt(!0);v<U;v++){const w=p.getAttachment(y,n.readStringRef()),k=w.bones!=null,N=w.vertices,W=k?N.length/3*2:N.length,et=n.readInt(!0),it=new DeformTimeline$2(et);it.slotIndex=y,it.attachment=w;for(let ft=0;ft<et;ft++){const mt=n.readFloat();let xt,yt=n.readInt(!0);if(yt==0)xt=k?Utils.newFloatArray(W):N;else{xt=Utils.newFloatArray(W);const vt=n.readInt(!0);if(yt+=vt,r==1)for(let St=vt;St<yt;St++)xt[St]=n.readFloat();else for(let St=vt;St<yt;St++)xt[St]=n.readFloat()*r;if(!k)for(let St=0,wt=xt.length;St<wt;St++)xt[St]+=N[St]}it.setFrame(ft,mt,xt),ft<et-1&&this.readCurve(n,ft,it)}s.push(it),a=Math.max(a,it.frames[et-1])}}}const o=n.readInt(!0);if(o>0){const d=new DrawOrderTimeline$2(o),m=e.slots.length;for(let p=0;p<o;p++){const g=n.readFloat(),_=n.readInt(!0),y=Utils.newArray(m,0);for(let k=m-1;k>=0;k--)y[k]=-1;const v=Utils.newArray(m-_,0);let U=0,w=0;for(let k=0;k<_;k++){const N=n.readInt(!0);for(;U!=N;)v[w++]=U++;y[U+n.readInt(!0)]=U++}for(;U<m;)v[w++]=U++;for(let k=m-1;k>=0;k--)y[k]==-1&&(y[k]=v[--w]);d.setFrame(p,g,y)}s.push(d),a=Math.max(a,d.frames[o-1])}const u=n.readInt(!0);if(u>0){const d=new EventTimeline$2(u);for(let m=0;m<u;m++){const p=n.readFloat(),g=e.events[n.readInt(!0)],_=new Event$3(p,g);_.intValue=n.readInt(!1),_.floatValue=n.readFloat(),_.stringValue=n.readBoolean()?n.readString():g.stringValue,_.data.audioPath!=null&&(_.volume=n.readFloat(),_.balance=n.readFloat()),d.setFrame(m,_)}s.push(d),a=Math.max(a,d.frames[u-1])}return new Animation$4(t,s,a)}readCurve(n,t,e){switch(n.readByte()){case _SkeletonBinary.CURVE_STEPPED:e.setStepped(t);break;case _SkeletonBinary.CURVE_BEZIER:this.setCurve(e,t,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat());break}}setCurve(n,t,e,s,r,a){n.setCurve(t,e,s,r,a)}};let SkeletonBinary$1=_SkeletonBinary;SkeletonBinary$1.AttachmentTypeValues=[0,1,2,3,4,5,6];SkeletonBinary$1.TransformModeValues=[TransformMode.Normal,TransformMode.OnlyTranslation,TransformMode.NoRotationOrReflection,TransformMode.NoScale,TransformMode.NoScaleOrReflection];SkeletonBinary$1.PositionModeValues=[PositionMode.Fixed,PositionMode.Percent];SkeletonBinary$1.SpacingModeValues=[SpacingMode$2.Length,SpacingMode$2.Fixed,SpacingMode$2.Percent];SkeletonBinary$1.RotateModeValues=[RotateMode.Tangent,RotateMode.Chain,RotateMode.ChainScale];SkeletonBinary$1.BlendModeValues=[BLEND_MODES.NORMAL,BLEND_MODES.ADD,BLEND_MODES.MULTIPLY,BLEND_MODES.SCREEN];SkeletonBinary$1.BONE_ROTATE=0;SkeletonBinary$1.BONE_TRANSLATE=1;SkeletonBinary$1.BONE_SCALE=2;SkeletonBinary$1.BONE_SHEAR=3;SkeletonBinary$1.SLOT_ATTACHMENT=0;SkeletonBinary$1.SLOT_COLOR=1;SkeletonBinary$1.SLOT_TWO_COLOR=2;SkeletonBinary$1.PATH_POSITION=0;SkeletonBinary$1.PATH_SPACING=1;SkeletonBinary$1.PATH_MIX=2;SkeletonBinary$1.CURVE_LINEAR=0;SkeletonBinary$1.CURVE_STEPPED=1;SkeletonBinary$1.CURVE_BEZIER=2;let LinkedMesh$4=class{constructor(t,e,s,r,a){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritDeform=a}},Vertices$1=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},SkeletonBounds$2=class extends SkeletonBoundsBase{},SkeletonJson$2=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new SkeletonData$2,r=typeof t=="string"?JSON.parse(t):t,a=r.skeleton;if(a!=null){if(s.hash=a.hash,s.version=a.spine,s.version.substr(0,3)!=="3.8"){const h=`Spine 3.8 loader cant load version ${a.spine}. Please configure your pixi-spine bundle`;console.error(h)}s.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),s.x=a.x,s.y=a.y,s.width=a.width,s.height=a.height,s.fps=a.fps,s.imagesPath=a.images}if(r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let o=null;const u=this.getValue(c,"parent",null);if(u!=null&&(o=s.findBone(u),o==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData$2(s.bones.length,c.name,o);d.length=this.getValue(c,"length",0)*e,d.x=this.getValue(c,"x",0)*e,d.y=this.getValue(c,"y",0)*e,d.rotation=this.getValue(c,"rotation",0),d.scaleX=this.getValue(c,"scaleX",1),d.scaleY=this.getValue(c,"scaleY",1),d.shearX=this.getValue(c,"shearX",0),d.shearY=this.getValue(c,"shearY",0),d.transformMode=SkeletonJson$2.transformModeFromString(this.getValue(c,"transform","normal")),d.skinRequired=this.getValue(c,"skin",!1),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],o=c.name,u=c.bone,d=s.findBone(u);if(d==null)throw new Error(`Slot bone not found: ${u}`);const m=new SlotData$2(s.slots.length,o,d),p=this.getValue(c,"color",null);p!=null&&m.color.setFromString(p);const g=this.getValue(c,"dark",null);g!=null&&(m.darkColor=new Color(1,1,1,1),m.darkColor.setFromString(g)),m.attachmentName=this.getValue(c,"attachment",null),m.blendMode=SkeletonJson$2.blendModeFromString(this.getValue(c,"blend","normal")),s.slots.push(m)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],o=new IkConstraintData$2(c.name);o.order=this.getValue(c,"order",0),o.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`IK bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findBone(u),o.target==null)throw new Error(`IK target bone not found: ${u}`);o.mix=this.getValue(c,"mix",1),o.softness=this.getValue(c,"softness",0)*e,o.bendDirection=this.getValue(c,"bendPositive",!0)?1:-1,o.compress=this.getValue(c,"compress",!1),o.stretch=this.getValue(c,"stretch",!1),o.uniform=this.getValue(c,"uniform",!1),s.ikConstraints.push(o)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],o=new TransformConstraintData$2(c.name);o.order=this.getValue(c,"order",0),o.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`Transform constraint bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findBone(u),o.target==null)throw new Error(`Transform constraint target bone not found: ${u}`);o.local=this.getValue(c,"local",!1),o.relative=this.getValue(c,"relative",!1),o.offsetRotation=this.getValue(c,"rotation",0),o.offsetX=this.getValue(c,"x",0)*e,o.offsetY=this.getValue(c,"y",0)*e,o.offsetScaleX=this.getValue(c,"scaleX",0),o.offsetScaleY=this.getValue(c,"scaleY",0),o.offsetShearY=this.getValue(c,"shearY",0),o.rotateMix=this.getValue(c,"rotateMix",1),o.translateMix=this.getValue(c,"translateMix",1),o.scaleMix=this.getValue(c,"scaleMix",1),o.shearMix=this.getValue(c,"shearMix",1),s.transformConstraints.push(o)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],o=new PathConstraintData$2(c.name);o.order=this.getValue(c,"order",0),o.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`Transform constraint bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findSlot(u),o.target==null)throw new Error(`Path target slot not found: ${u}`);o.positionMode=SkeletonJson$2.positionModeFromString(this.getValue(c,"positionMode","percent")),o.spacingMode=SkeletonJson$2.spacingModeFromString(this.getValue(c,"spacingMode","length")),o.rotateMode=SkeletonJson$2.rotateModeFromString(this.getValue(c,"rotateMode","tangent")),o.offsetRotation=this.getValue(c,"rotation",0),o.position=this.getValue(c,"position",0),o.positionMode==PositionMode.Fixed&&(o.position*=e),o.spacing=this.getValue(c,"spacing",0),(o.spacingMode==SpacingMode$2.Length||o.spacingMode==SpacingMode$2.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(c,"rotateMix",1),o.translateMix=this.getValue(c,"translateMix",1),s.pathConstraints.push(o)}if(r.skins)for(let h=0;h<r.skins.length;h++){const c=r.skins[h],o=new Skin$2(c.name);if(c.bones)for(let u=0;u<c.bones.length;u++){const d=s.findBone(c.bones[u]);if(d==null)throw new Error(`Skin bone not found: ${c.bones[h]}`);o.bones.push(d)}if(c.ik)for(let u=0;u<c.ik.length;u++){const d=s.findIkConstraint(c.ik[u]);if(d==null)throw new Error(`Skin IK constraint not found: ${c.ik[h]}`);o.constraints.push(d)}if(c.transform)for(let u=0;u<c.transform.length;u++){const d=s.findTransformConstraint(c.transform[u]);if(d==null)throw new Error(`Skin transform constraint not found: ${c.transform[h]}`);o.constraints.push(d)}if(c.path)for(let u=0;u<c.path.length;u++){const d=s.findPathConstraint(c.path[u]);if(d==null)throw new Error(`Skin path constraint not found: ${c.path[h]}`);o.constraints.push(d)}for(const u in c.attachments){const d=s.findSlot(u);if(d==null)throw new Error(`Slot not found: ${u}`);const m=c.attachments[u];for(const p in m){const g=this.readAttachment(m[p],o,d.index,p,s);g!=null&&o.setAttachment(d.index,p,g)}}s.skins.push(o),o.name=="default"&&(s.defaultSkin=o)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const o=this.linkedMeshes[h],u=o.skin==null?s.defaultSkin:s.findSkin(o.skin);if(u==null)throw new Error(`Skin not found: ${o.skin}`);const d=u.getAttachment(o.slotIndex,o.parent);if(d==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?d:o.mesh,o.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],o=new EventData$2(h);o.intValue=this.getValue(c,"int",0),o.floatValue=this.getValue(c,"float",0),o.stringValue=this.getValue(c,"string",""),o.audioPath=this.getValue(c,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(c,"volume",1),o.balance=this.getValue(c,"balance",0)),s.events.push(o)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(t,e,s,r,a){const h=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",r),u=this.attachmentLoader.newRegionAttachment(e,r,o);if(u==null)return null;u.path=o,u.x=this.getValue(t,"x",0)*h,u.y=this.getValue(t,"y",0)*h,u.scaleX=this.getValue(t,"scaleX",1),u.scaleY=this.getValue(t,"scaleY",1),u.rotation=this.getValue(t,"rotation",0),u.width=t.width*h,u.height=t.height*h;const d=this.getValue(t,"color",null);return d!=null&&u.color.setFromString(d),u}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",r),u=this.attachmentLoader.newMeshAttachment(e,r,o);if(u==null)return null;u.path=o;const d=this.getValue(t,"color",null);d!=null&&u.color.setFromString(d),u.width=this.getValue(t,"width",0)*h,u.height=this.getValue(t,"height",0)*h;const m=this.getValue(t,"parent",null);if(m!=null)return this.linkedMeshes.push(new LinkedMesh$3(u,this.getValue(t,"skin",null),s,m,this.getValue(t,"deform",!0))),u;const p=t.uvs;return this.readVertices(t,u,p.length),u.triangles=t.triangles,u.regionUVs=new Float32Array(p),u.edges=this.getValue(t,"edges",null),u.hullLength=this.getValue(t,"hull",0)*2,u}case"path":{const o=this.attachmentLoader.newPathAttachment(e,r);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const u=t.vertexCount;this.readVertices(t,o,u<<1);const d=Utils.newArray(u/3,0);for(let p=0;p<t.lengths.length;p++)d[p]=t.lengths[p]*h;o.lengths=d;const m=this.getValue(t,"color",null);return m!=null&&o.color.setFromString(m),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,r);if(o==null)return null;o.x=this.getValue(t,"x",0)*h,o.y=this.getValue(t,"y",0)*h,o.rotation=this.getValue(t,"rotation",0);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,r);if(o==null)return null;const u=this.getValue(t,"end",null);if(u!=null){const p=a.findSlot(u);if(p==null)throw new Error(`Clipping end slot not found: ${u}`);o.endSlot=p}const d=t.vertexCount;this.readVertices(t,o,d<<1);const m=this.getValue(t,"color",null);return m!=null&&o.color.setFromString(m),o}}return null}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const a=t.vertices;if(s==a.length){const o=Utils.toFloatArray(a);if(r!=1)for(let u=0,d=a.length;u<d;u++)o[u]*=r;e.vertices=o;return}const h=new Array,c=new Array;for(let o=0,u=a.length;o<u;){const d=a[o++];c.push(d);for(let m=o+d*4;o<m;o+=4)c.push(a[o]),h.push(a[o+1]*r),h.push(a[o+2]*r),h.push(a[o+3])}e.bones=c,e.vertices=Utils.toFloatArray(h)}readAnimation(t,e,s){const r=this.scale,a=new Array;let h=0;if(t.slots)for(const o in t.slots){const u=t.slots[o],d=s.findSlotIndex(o);if(d==-1)throw new Error(`Slot not found: ${o}`);for(const m in u){const p=u[m];if(m=="attachment"){const g=new AttachmentTimeline$2(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y];g.setFrame(_++,this.getValue(v,"time",0),v.name)}a.push(g),h=Math.max(h,g.frames[g.getFrameCount()-1])}else if(m=="color"){const g=new ColorTimeline$1(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y],U=new Color;U.setFromString(v.color||"ffffffff"),g.setFrame(_,this.getValue(v,"time",0),U.r,U.g,U.b,U.a),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*ColorTimeline$1.ENTRIES])}else if(m=="twoColor"){const g=new TwoColorTimeline$1(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y],U=new Color,w=new Color;U.setFromString(v.light),w.setFromString(v.dark),g.setFrame(_,this.getValue(v,"time",0),U.r,U.g,U.b,U.a,w.r,w.g,w.b),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TwoColorTimeline$1.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${m} (${o})`)}}if(t.bones)for(const o in t.bones){const u=t.bones[o],d=s.findBoneIndex(o);if(d==-1)throw new Error(`Bone not found: ${o}`);for(const m in u){const p=u[m];if(m==="rotate"){const g=new RotateTimeline$2(p.length);g.boneIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y];g.setFrame(_,this.getValue(v,"time",0),this.getValue(v,"angle",0)),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*RotateTimeline$2.ENTRIES])}else if(m==="translate"||m==="scale"||m==="shear"){let g=null,_=1,y=0;m==="scale"?(g=new ScaleTimeline$2(p.length),y=1):m==="shear"?g=new ShearTimeline$2(p.length):(g=new TranslateTimeline$2(p.length),_=r),g.boneIndex=d;let v=0;for(let U=0;U<p.length;U++){const w=p[U],k=this.getValue(w,"x",y),N=this.getValue(w,"y",y);g.setFrame(v,this.getValue(w,"time",0),k*_,N*_),this.readCurve(w,g,v),v++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TranslateTimeline$2.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${m} (${o})`)}}if(t.ik)for(const o in t.ik){const u=t.ik[o],d=s.findIkConstraint(o),m=new IkConstraintTimeline$2(u.length);m.ikConstraintIndex=s.ikConstraints.indexOf(d);let p=0;for(let g=0;g<u.length;g++){const _=u[g];m.setFrame(p,this.getValue(_,"time",0),this.getValue(_,"mix",1),this.getValue(_,"softness",0)*r,this.getValue(_,"bendPositive",!0)?1:-1,this.getValue(_,"compress",!1),this.getValue(_,"stretch",!1)),this.readCurve(_,m,p),p++}a.push(m),h=Math.max(h,m.frames[(m.getFrameCount()-1)*IkConstraintTimeline$2.ENTRIES])}if(t.transform)for(const o in t.transform){const u=t.transform[o],d=s.findTransformConstraint(o),m=new TransformConstraintTimeline$2(u.length);m.transformConstraintIndex=s.transformConstraints.indexOf(d);let p=0;for(let g=0;g<u.length;g++){const _=u[g];m.setFrame(p,this.getValue(_,"time",0),this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1),this.getValue(_,"scaleMix",1),this.getValue(_,"shearMix",1)),this.readCurve(_,m,p),p++}a.push(m),h=Math.max(h,m.frames[(m.getFrameCount()-1)*TransformConstraintTimeline$2.ENTRIES])}if(t.path)for(const o in t.path){const u=t.path[o],d=s.findPathConstraintIndex(o);if(d==-1)throw new Error(`Path constraint not found: ${o}`);const m=s.pathConstraints[d];for(const p in u){const g=u[p];if(p==="position"||p==="spacing"){let _=null,y=1;p==="spacing"?(_=new PathConstraintSpacingTimeline$2(g.length),(m.spacingMode==SpacingMode$2.Length||m.spacingMode==SpacingMode$2.Fixed)&&(y=r)):(_=new PathConstraintPositionTimeline$2(g.length),m.positionMode==PositionMode.Fixed&&(y=r)),_.pathConstraintIndex=d;let v=0;for(let U=0;U<g.length;U++){const w=g[U];_.setFrame(v,this.getValue(w,"time",0),this.getValue(w,p,0)*y),this.readCurve(w,_,v),v++}a.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintPositionTimeline$2.ENTRIES])}else if(p==="mix"){const _=new PathConstraintMixTimeline$2(g.length);_.pathConstraintIndex=d;let y=0;for(let v=0;v<g.length;v++){const U=g[v];_.setFrame(y,this.getValue(U,"time",0),this.getValue(U,"rotateMix",1),this.getValue(U,"translateMix",1)),this.readCurve(U,_,y),y++}a.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintMixTimeline$2.ENTRIES])}}}if(t.deform)for(const o in t.deform){const u=t.deform[o],d=s.findSkin(o);if(d!=null)for(const m in u){const p=u[m],g=s.findSlotIndex(m);if(g==-1)throw new Error(`Slot not found: ${p.name}`);for(const _ in p){const y=p[_],v=d.getAttachment(g,_);if(v==null)throw new Error(`Deform attachment not found: ${y.name}`);const U=v.bones!=null,w=v.vertices,k=U?w.length/3*2:w.length,N=new DeformTimeline$2(y.length);N.slotIndex=g,N.attachment=v;let W=0;for(let et=0;et<y.length;et++){const it=y[et];let ft;const mt=this.getValue(it,"vertices",null);if(mt==null)ft=U?Utils.newFloatArray(k):w;else{ft=Utils.newFloatArray(k);const xt=this.getValue(it,"offset",0);if(Utils.arrayCopy(mt,0,ft,xt,mt.length),r!=1)for(let yt=xt,vt=yt+mt.length;yt<vt;yt++)ft[yt]*=r;if(!U)for(let yt=0;yt<k;yt++)ft[yt]+=w[yt]}N.setFrame(W,this.getValue(it,"time",0),ft),this.readCurve(it,N,W),W++}a.push(N),h=Math.max(h,N.frames[N.getFrameCount()-1])}}}let c=t.drawOrder;if(c==null&&(c=t.draworder),c!=null){const o=new DrawOrderTimeline$2(c.length),u=s.slots.length;let d=0;for(let m=0;m<c.length;m++){const p=c[m];let g=null;const _=this.getValue(p,"offsets",null);if(_!=null){g=Utils.newArray(u,-1);const y=Utils.newArray(u-_.length,0);let v=0,U=0;for(let w=0;w<_.length;w++){const k=_[w],N=s.findSlotIndex(k.slot);if(N==-1)throw new Error(`Slot not found: ${k.slot}`);for(;v!=N;)y[U++]=v++;g[v+k.offset]=v++}for(;v<u;)y[U++]=v++;for(let w=u-1;w>=0;w--)g[w]==-1&&(g[w]=y[--U])}o.setFrame(d++,this.getValue(p,"time",0),g)}a.push(o),h=Math.max(h,o.frames[o.getFrameCount()-1])}if(t.events){const o=new EventTimeline$2(t.events.length);let u=0;for(let d=0;d<t.events.length;d++){const m=t.events[d],p=s.findEvent(m.name);if(p==null)throw new Error(`Event not found: ${m.name}`);const g=new Event$3(Utils.toSinglePrecision(this.getValue(m,"time",0)),p);g.intValue=this.getValue(m,"int",p.intValue),g.floatValue=this.getValue(m,"float",p.floatValue),g.stringValue=this.getValue(m,"string",p.stringValue),g.data.audioPath!=null&&(g.volume=this.getValue(m,"volume",1),g.balance=this.getValue(m,"balance",0)),o.setFrame(u++,g)}a.push(o),h=Math.max(h,o.frames[o.getFrameCount()-1])}if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$4(e,a,h))}readCurve(t,e,s){if(t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(s);else{const r=t.curve;e.setCurve(s,r,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,s){return t[e]!==void 0?t[e]:s}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return BLEND_MODES.NORMAL;if(t=="additive")return BLEND_MODES.ADD;if(t=="multiply")return BLEND_MODES.MULTIPLY;if(t=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return PositionMode.Fixed;if(t=="percent")return PositionMode.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return SpacingMode$2.Length;if(t=="fixed")return SpacingMode$2.Fixed;if(t=="percent")return SpacingMode$2.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return RotateMode.Tangent;if(t=="chain")return RotateMode.Chain;if(t=="chainscale")return RotateMode.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return TransformMode.Normal;if(t=="onlytranslation")return TransformMode.OnlyTranslation;if(t=="norotationorreflection")return TransformMode.NoRotationOrReflection;if(t=="noscale")return TransformMode.NoScale;if(t=="noscaleorreflection")return TransformMode.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},LinkedMesh$3=class{constructor(t,e,s,r,a){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritDeform=a}},Spine$3=class extends SpineBase{createSkeleton(t){this.skeleton=new Skeleton$2(t),this.skeleton.updateWorldTransform(),this.stateData=new AnimationStateData$2(t),this.state=new AnimationState$2(this.stateData)}};const spine38=Object.freeze(Object.defineProperty({__proto__:null,Animation:Animation$4,AnimationState:AnimationState$2,AnimationStateAdapter:AnimationStateAdapter$1,AnimationStateData:AnimationStateData$2,AtlasAttachmentLoader:AtlasAttachmentLoader$2,Attachment:Attachment$2,AttachmentTimeline:AttachmentTimeline$2,Bone:Bone$2,BoneData:BoneData$2,BoundingBoxAttachment:BoundingBoxAttachment$2,ClippingAttachment:ClippingAttachment$2,ColorTimeline:ColorTimeline$1,ConstraintData:ConstraintData$1,CurveTimeline:CurveTimeline$2,DeformTimeline:DeformTimeline$2,DrawOrderTimeline:DrawOrderTimeline$2,Event:Event$3,EventData:EventData$2,EventQueue:EventQueue$2,EventTimeline:EventTimeline$2,EventType:EventType$2,IkConstraint:IkConstraint$2,IkConstraintData:IkConstraintData$2,IkConstraintTimeline:IkConstraintTimeline$2,JitterEffect:JitterEffect$1,MeshAttachment:MeshAttachment$2,PathAttachment:PathAttachment$2,PathConstraint:PathConstraint$2,PathConstraintData:PathConstraintData$2,PathConstraintMixTimeline:PathConstraintMixTimeline$2,PathConstraintPositionTimeline:PathConstraintPositionTimeline$2,PathConstraintSpacingTimeline:PathConstraintSpacingTimeline$2,PointAttachment:PointAttachment$2,RegionAttachment:RegionAttachment$2,RotateTimeline:RotateTimeline$2,ScaleTimeline:ScaleTimeline$2,ShearTimeline:ShearTimeline$2,Skeleton:Skeleton$2,SkeletonBinary:SkeletonBinary$1,SkeletonBounds:SkeletonBounds$2,SkeletonData:SkeletonData$2,SkeletonJson:SkeletonJson$2,Skin:Skin$2,SkinEntry:SkinEntry$1,Slot:Slot$2,SlotData:SlotData$2,SpacingMode:SpacingMode$2,Spine:Spine$3,SwirlEffect:SwirlEffect$1,TimelineType:TimelineType$1,TrackEntry:TrackEntry$2,TransformConstraint:TransformConstraint$2,TransformConstraintData:TransformConstraintData$2,TransformConstraintTimeline:TransformConstraintTimeline$2,TranslateTimeline:TranslateTimeline$2,TwoColorTimeline:TwoColorTimeline$1,VertexAttachment:VertexAttachment$2},Symbol.toStringTag,{value:"Module"}));let Attachment$1=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const _VertexAttachment$1=class extends Attachment$1{constructor(t){super(t),this.id=(_VertexAttachment$1.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,s,r,a,h){s=a+(s>>1)*h;const c=t.bone.skeleton,o=t.attachmentVertices;let u=this.vertices;const d=this.bones;if(d==null){o.length>0&&(u=o);const _=t.bone.matrix,y=_.tx,v=_.ty,U=_.a,w=_.c,k=_.b,N=_.d;for(let W=e,et=a;et<s;W+=2,et+=h){const it=u[W],ft=u[W+1];r[et]=it*U+ft*w+y,r[et+1]=it*k+ft*N+v}return}let m=0,p=0;for(let _=0;_<e;_+=2){const y=d[m];m+=y+1,p+=y}const g=c.bones;if(o.length==0)for(let _=a,y=p*3;_<s;_+=h){let v=0,U=0,w=d[m++];for(w+=m;m<w;m++,y+=3){const k=g[d[m]].matrix,N=u[y],W=u[y+1],et=u[y+2];v+=(N*k.a+W*k.c+k.tx)*et,U+=(N*k.b+W*k.d+k.ty)*et}r[_]=v,r[_+1]=U}else{const _=o;for(let y=a,v=p*3,U=p<<1;y<s;y+=h){let w=0,k=0,N=d[m++];for(N+=m;m<N;m++,v+=3,U+=2){const W=g[d[m]].matrix,et=u[v]+_[U],it=u[v+1]+_[U+1],ft=u[v+2];w+=(et*W.a+it*W.c+W.tx)*ft,k+=(et*W.b+it*W.d+W.ty)*ft}r[y]=w,r[y+1]=k}}}applyDeform(t){return this==t}};let VertexAttachment$1=_VertexAttachment$1;VertexAttachment$1.nextID=0;let BoundingBoxAttachment$1=class extends VertexAttachment$1{constructor(t){super(t),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}},ClippingAttachment$1=class extends VertexAttachment$1{constructor(t){super(t),this.type=AttachmentType.Clipping,this.color=new Color(.2275,.2275,.8078,1)}},MeshAttachment$1=class extends VertexAttachment$1{constructor(t){super(t),this.type=AttachmentType.Mesh,this.color=new Color(1,1,1,1),this.inheritDeform=!1,this.tempColor=new Color(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},PathAttachment$1=class extends VertexAttachment$1{constructor(t){super(t),this.type=AttachmentType.Path,this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}},PointAttachment$1=class extends VertexAttachment$1{constructor(t){super(t),this.type=AttachmentType.Point,this.color=new Color(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),a=s*e.a+r*e.c,h=s*e.b+r*e.d;return Math.atan2(h,a)*MathUtils.radDeg}},Slot$1=class{constructor(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new Color,this.darkColor=t.darkColor==null?null:new Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const _RegionAttachment$1=class extends Attachment$1{constructor(t){super(t),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,a=s+this.region.width*t,h=r+this.region.height*e,c=this.rotation*Math.PI/180,o=Math.cos(c),u=Math.sin(c),d=s*o+this.x,m=s*u,p=r*o+this.y,g=r*u,_=a*o+this.x,y=a*u,v=h*o+this.y,U=h*u,w=this.offset;w[_RegionAttachment$1.OX1]=d-g,w[_RegionAttachment$1.OY1]=p+m,w[_RegionAttachment$1.OX2]=d-U,w[_RegionAttachment$1.OY2]=v+m,w[_RegionAttachment$1.OX3]=_-U,w[_RegionAttachment$1.OY3]=v+y,w[_RegionAttachment$1.OX4]=_-g,w[_RegionAttachment$1.OY4]=p+y}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,s,r){const a=this.offset,h=t instanceof Slot$1?t.bone.matrix:t.matrix,c=h.tx,o=h.ty,u=h.a,d=h.c,m=h.b,p=h.d;let g=0,_=0;g=a[_RegionAttachment$1.OX1],_=a[_RegionAttachment$1.OY1],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$1.OX2],_=a[_RegionAttachment$1.OY2],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$1.OX3],_=a[_RegionAttachment$1.OY3],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o,s+=r,g=a[_RegionAttachment$1.OX4],_=a[_RegionAttachment$1.OY4],e[s]=g*u+_*d+c,e[s+1]=g*m+_*p+o}};let RegionAttachment$1=_RegionAttachment$1;RegionAttachment$1.OX1=0;RegionAttachment$1.OY1=1;RegionAttachment$1.OX2=2;RegionAttachment$1.OY2=3;RegionAttachment$1.OX3=4;RegionAttachment$1.OY3=5;RegionAttachment$1.OX4=6;RegionAttachment$1.OY4=7;RegionAttachment$1.X1=0;RegionAttachment$1.Y1=1;RegionAttachment$1.C1R=2;RegionAttachment$1.C1G=3;RegionAttachment$1.C1B=4;RegionAttachment$1.C1A=5;RegionAttachment$1.U1=6;RegionAttachment$1.V1=7;RegionAttachment$1.X2=8;RegionAttachment$1.Y2=9;RegionAttachment$1.C2R=10;RegionAttachment$1.C2G=11;RegionAttachment$1.C2B=12;RegionAttachment$1.C2A=13;RegionAttachment$1.U2=14;RegionAttachment$1.V2=15;RegionAttachment$1.X3=16;RegionAttachment$1.Y3=17;RegionAttachment$1.C3R=18;RegionAttachment$1.C3G=19;RegionAttachment$1.C3B=20;RegionAttachment$1.C3A=21;RegionAttachment$1.U3=22;RegionAttachment$1.V3=23;RegionAttachment$1.X4=24;RegionAttachment$1.Y4=25;RegionAttachment$1.C4R=26;RegionAttachment$1.C4G=27;RegionAttachment$1.C4B=28;RegionAttachment$1.C4A=29;RegionAttachment$1.U4=30;RegionAttachment$1.V4=31;class JitterEffect{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,s,r){t.x+=MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=MathUtils.randomTriangular(-this.jitterX,this.jitterY)}end(){}}const _SwirlEffect=class{constructor(n){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=n}begin(n){this.worldX=n.x+this.centerX,this.worldY=n.y+this.centerY}transform(n,t,e,s){const r=this.angle*MathUtils.degreesToRadians,a=n.x-this.worldX,h=n.y-this.worldY,c=Math.sqrt(a*a+h*h);if(c<this.radius){const o=_SwirlEffect.interpolation.apply(0,r,(this.radius-c)/this.radius),u=Math.cos(o),d=Math.sin(o);n.x=u*a-d*h+this.worldX,n.y=d*a+u*h+this.worldY}}end(){}};let SwirlEffect=_SwirlEffect;SwirlEffect.interpolation=new PowOut(2);let Animation$3=class{constructor(t,e,s){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=s}apply(t,e,s,r,a,h,c,o){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const u=this.timelines;for(let d=0,m=u.length;d<m;d++)u[d].apply(t,e,s,a,h,c,o)}static binarySearch(t,e,s=1){let r=0,a=t.length/s-2;if(a==0)return s;let h=a>>>1;for(;;){if(t[(h+1)*s]<=e?r=h+1:a=h,r==a)return(r+1)*s;h=r+a>>>1}}static linearSearch(t,e,s){for(let r=0,a=t.length-s;r<=a;r+=s)if(t[r]>e)return r;return-1}};var TimelineType=(n=>(n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor",n))(TimelineType||{});const _CurveTimeline=class{constructor(n){if(n<=0)throw new Error(`frameCount must be > 0: ${n}`);this.curves=Utils.newFloatArray((n-1)*_CurveTimeline.BEZIER_SIZE)}getFrameCount(){return this.curves.length/_CurveTimeline.BEZIER_SIZE+1}setLinear(n){this.curves[n*_CurveTimeline.BEZIER_SIZE]=_CurveTimeline.LINEAR}setStepped(n){this.curves[n*_CurveTimeline.BEZIER_SIZE]=_CurveTimeline.STEPPED}getCurveType(n){const t=n*_CurveTimeline.BEZIER_SIZE;if(t==this.curves.length)return _CurveTimeline.LINEAR;const e=this.curves[t];return e==_CurveTimeline.LINEAR?_CurveTimeline.LINEAR:e==_CurveTimeline.STEPPED?_CurveTimeline.STEPPED:_CurveTimeline.BEZIER}setCurve(n,t,e,s,r){const a=(-t*2+s)*.03,h=(-e*2+r)*.03,c=((t-s)*3+1)*.006,o=((e-r)*3+1)*.006;let u=a*2+c,d=h*2+o,m=t*.3+a+c*.16666667,p=e*.3+h+o*.16666667,g=n*_CurveTimeline.BEZIER_SIZE;const _=this.curves;_[g++]=_CurveTimeline.BEZIER;let y=m,v=p;for(let U=g+_CurveTimeline.BEZIER_SIZE-1;g<U;g+=2)_[g]=y,_[g+1]=v,m+=u,p+=d,u+=c,d+=o,y+=m,v+=p}getCurvePercent(n,t){t=MathUtils.clamp(t,0,1);const e=this.curves;let s=n*_CurveTimeline.BEZIER_SIZE;const r=e[s];if(r==_CurveTimeline.LINEAR)return t;if(r==_CurveTimeline.STEPPED)return 0;s++;let a=0;for(let c=s,o=s+_CurveTimeline.BEZIER_SIZE-1;s<o;s+=2)if(a=e[s],a>=t){let u,d;return s==c?(u=0,d=0):(u=e[s-2],d=e[s-1]),d+(e[s+1]-d)*(t-u)/(a-u)}const h=e[s-1];return h+(1-h)*(t-a)/(1-a)}};let CurveTimeline$1=_CurveTimeline;CurveTimeline$1.LINEAR=0;CurveTimeline$1.STEPPED=1;CurveTimeline$1.BEZIER=2;CurveTimeline$1.BEZIER_SIZE=10*2-1;const _RotateTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(n,t,e){n<<=1,this.frames[n]=t,this.frames[n+_RotateTimeline.ROTATION]=e}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.bones[this.boneIndex];if(e<c[0]){switch(a){case MixBlend.setup:o.rotation=o.data.rotation;return;case MixBlend.first:const _=o.data.rotation-o.rotation;o.rotation+=(_-(16384-(16384.499999999996-_/360|0))*360)*r}return}if(e>=c[c.length-_RotateTimeline.ENTRIES]){let _=c[c.length+_RotateTimeline.PREV_ROTATION];switch(a){case MixBlend.setup:o.rotation=o.data.rotation+_*r;break;case MixBlend.first:case MixBlend.replace:_+=o.data.rotation-o.rotation,_-=(16384-(16384.499999999996-_/360|0))*360;case MixBlend.add:o.rotation+=_*r}return}const u=Animation$3.binarySearch(c,e,_RotateTimeline.ENTRIES),d=c[u+_RotateTimeline.PREV_ROTATION],m=c[u],p=this.getCurvePercent((u>>1)-1,1-(e-m)/(c[u+_RotateTimeline.PREV_TIME]-m));let g=c[u+_RotateTimeline.ROTATION]-d;switch(g=d+(g-(16384-(16384.499999999996-g/360|0))*360)*p,a){case MixBlend.setup:o.rotation=o.data.rotation+(g-(16384-(16384.499999999996-g/360|0))*360)*r;break;case MixBlend.first:case MixBlend.replace:g+=o.data.rotation-o.rotation;case MixBlend.add:o.rotation+=(g-(16384-(16384.499999999996-g/360|0))*360)*r}}};let RotateTimeline$1=_RotateTimeline;RotateTimeline$1.ENTRIES=2;RotateTimeline$1.PREV_TIME=-2;RotateTimeline$1.PREV_ROTATION=-1;RotateTimeline$1.ROTATION=1;const _TranslateTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TranslateTimeline.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(n,t,e,s){n*=_TranslateTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_TranslateTimeline.X]=e,this.frames[n+_TranslateTimeline.Y]=s}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.bones[this.boneIndex];if(e<c[0]){switch(a){case MixBlend.setup:o.x=o.data.x,o.y=o.data.y;return;case MixBlend.first:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}return}let u=0,d=0;if(e>=c[c.length-_TranslateTimeline.ENTRIES])u=c[c.length+_TranslateTimeline.PREV_X],d=c[c.length+_TranslateTimeline.PREV_Y];else{const m=Animation$3.binarySearch(c,e,_TranslateTimeline.ENTRIES);u=c[m+_TranslateTimeline.PREV_X],d=c[m+_TranslateTimeline.PREV_Y];const p=c[m],g=this.getCurvePercent(m/_TranslateTimeline.ENTRIES-1,1-(e-p)/(c[m+_TranslateTimeline.PREV_TIME]-p));u+=(c[m+_TranslateTimeline.X]-u)*g,d+=(c[m+_TranslateTimeline.Y]-d)*g}switch(a){case MixBlend.setup:o.x=o.data.x+u*r,o.y=o.data.y+d*r;break;case MixBlend.first:case MixBlend.replace:o.x+=(o.data.x+u-o.x)*r,o.y+=(o.data.y+d-o.y)*r;break;case MixBlend.add:o.x+=u*r,o.y+=d*r}}};let TranslateTimeline$1=_TranslateTimeline;TranslateTimeline$1.ENTRIES=3;TranslateTimeline$1.PREV_TIME=-3;TranslateTimeline$1.PREV_X=-2;TranslateTimeline$1.PREV_Y=-1;TranslateTimeline$1.X=1;TranslateTimeline$1.Y=2;let ScaleTimeline$1=class extends TranslateTimeline$1{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(s<o[0]){switch(h){case MixBlend.setup:u.scaleX=u.data.scaleX,u.scaleY=u.data.scaleY;return;case MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*a,u.scaleY+=(u.data.scaleY-u.scaleY)*a}return}let d=0,m=0;if(s>=o[o.length-ScaleTimeline$1.ENTRIES])d=o[o.length+ScaleTimeline$1.PREV_X]*u.data.scaleX,m=o[o.length+ScaleTimeline$1.PREV_Y]*u.data.scaleY;else{const p=Animation$3.binarySearch(o,s,ScaleTimeline$1.ENTRIES);d=o[p+ScaleTimeline$1.PREV_X],m=o[p+ScaleTimeline$1.PREV_Y];const g=o[p],_=this.getCurvePercent(p/ScaleTimeline$1.ENTRIES-1,1-(s-g)/(o[p+ScaleTimeline$1.PREV_TIME]-g));d=(d+(o[p+ScaleTimeline$1.X]-d)*_)*u.data.scaleX,m=(m+(o[p+ScaleTimeline$1.Y]-m)*_)*u.data.scaleY}if(a==1)h==MixBlend.add?(u.scaleX+=d-u.data.scaleX,u.scaleY+=m-u.data.scaleY):(u.scaleX=d,u.scaleY=m);else{let p=0,g=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:p=u.data.scaleX,g=u.data.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-g)*a;break;case MixBlend.first:case MixBlend.replace:p=u.scaleX,g=u.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-g)*a;break;case MixBlend.add:p=u.scaleX,g=u.scaleY,u.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-u.data.scaleX)*a,u.scaleY=g+(Math.abs(m)*MathUtils.signum(g)-u.data.scaleY)*a}else switch(h){case MixBlend.setup:p=Math.abs(u.data.scaleX)*MathUtils.signum(d),g=Math.abs(u.data.scaleY)*MathUtils.signum(m),u.scaleX=p+(d-p)*a,u.scaleY=g+(m-g)*a;break;case MixBlend.first:case MixBlend.replace:p=Math.abs(u.scaleX)*MathUtils.signum(d),g=Math.abs(u.scaleY)*MathUtils.signum(m),u.scaleX=p+(d-p)*a,u.scaleY=g+(m-g)*a;break;case MixBlend.add:p=MathUtils.signum(d),g=MathUtils.signum(m),u.scaleX=Math.abs(u.scaleX)*p+(d-Math.abs(u.data.scaleX)*p)*a,u.scaleY=Math.abs(u.scaleY)*g+(m-Math.abs(u.data.scaleY)*g)*a}}}},ShearTimeline$1=class extends TranslateTimeline$1{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.bones[this.boneIndex];if(s<o[0]){switch(h){case MixBlend.setup:u.shearX=u.data.shearX,u.shearY=u.data.shearY;return;case MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*a,u.shearY+=(u.data.shearY-u.shearY)*a}return}let d=0,m=0;if(s>=o[o.length-ShearTimeline$1.ENTRIES])d=o[o.length+ShearTimeline$1.PREV_X],m=o[o.length+ShearTimeline$1.PREV_Y];else{const p=Animation$3.binarySearch(o,s,ShearTimeline$1.ENTRIES);d=o[p+ShearTimeline$1.PREV_X],m=o[p+ShearTimeline$1.PREV_Y];const g=o[p],_=this.getCurvePercent(p/ShearTimeline$1.ENTRIES-1,1-(s-g)/(o[p+ShearTimeline$1.PREV_TIME]-g));d=d+(o[p+ShearTimeline$1.X]-d)*_,m=m+(o[p+ShearTimeline$1.Y]-m)*_}switch(h){case MixBlend.setup:u.shearX=u.data.shearX+d*a,u.shearY=u.data.shearY+m*a;break;case MixBlend.first:case MixBlend.replace:u.shearX+=(u.data.shearX+d-u.shearX)*a,u.shearY+=(u.data.shearY+m-u.shearY)*a;break;case MixBlend.add:u.shearX+=d*a,u.shearY+=m*a}}};const _ColorTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_ColorTimeline.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(n,t,e,s,r,a){n*=_ColorTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_ColorTimeline.R]=e,this.frames[n+_ColorTimeline.G]=s,this.frames[n+_ColorTimeline.B]=r,this.frames[n+_ColorTimeline.A]=a}apply(n,t,e,s,r,a,h){const c=n.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(a){case MixBlend.setup:c.color.setFromColor(c.data.color);return;case MixBlend.first:const g=c.color,_=c.data.color;g.add((_.r-g.r)*r,(_.g-g.g)*r,(_.b-g.b)*r,(_.a-g.a)*r)}return}let u=0,d=0,m=0,p=0;if(e>=o[o.length-_ColorTimeline.ENTRIES]){const g=o.length;u=o[g+_ColorTimeline.PREV_R],d=o[g+_ColorTimeline.PREV_G],m=o[g+_ColorTimeline.PREV_B],p=o[g+_ColorTimeline.PREV_A]}else{const g=Animation$3.binarySearch(o,e,_ColorTimeline.ENTRIES);u=o[g+_ColorTimeline.PREV_R],d=o[g+_ColorTimeline.PREV_G],m=o[g+_ColorTimeline.PREV_B],p=o[g+_ColorTimeline.PREV_A];const _=o[g],y=this.getCurvePercent(g/_ColorTimeline.ENTRIES-1,1-(e-_)/(o[g+_ColorTimeline.PREV_TIME]-_));u+=(o[g+_ColorTimeline.R]-u)*y,d+=(o[g+_ColorTimeline.G]-d)*y,m+=(o[g+_ColorTimeline.B]-m)*y,p+=(o[g+_ColorTimeline.A]-p)*y}if(r==1)c.color.set(u,d,m,p);else{const g=c.color;a==MixBlend.setup&&g.setFromColor(c.data.color),g.add((u-g.r)*r,(d-g.g)*r,(m-g.b)*r,(p-g.a)*r)}}};let ColorTimeline=_ColorTimeline;ColorTimeline.ENTRIES=5;ColorTimeline.PREV_TIME=-5;ColorTimeline.PREV_R=-4;ColorTimeline.PREV_G=-3;ColorTimeline.PREV_B=-2;ColorTimeline.PREV_A=-1;ColorTimeline.R=1;ColorTimeline.G=2;ColorTimeline.B=3;ColorTimeline.A=4;const _TwoColorTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TwoColorTimeline.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(n,t,e,s,r,a,h,c,o){n*=_TwoColorTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_TwoColorTimeline.R]=e,this.frames[n+_TwoColorTimeline.G]=s,this.frames[n+_TwoColorTimeline.B]=r,this.frames[n+_TwoColorTimeline.A]=a,this.frames[n+_TwoColorTimeline.R2]=h,this.frames[n+_TwoColorTimeline.G2]=c,this.frames[n+_TwoColorTimeline.B2]=o}apply(n,t,e,s,r,a,h){const c=n.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(a){case MixBlend.setup:c.color.setFromColor(c.data.color),c.darkColor.setFromColor(c.data.darkColor);return;case MixBlend.first:const v=c.color,U=c.darkColor,w=c.data.color,k=c.data.darkColor;v.add((w.r-v.r)*r,(w.g-v.g)*r,(w.b-v.b)*r,(w.a-v.a)*r),U.add((k.r-U.r)*r,(k.g-U.g)*r,(k.b-U.b)*r,0)}return}let u=0,d=0,m=0,p=0,g=0,_=0,y=0;if(e>=o[o.length-_TwoColorTimeline.ENTRIES]){const v=o.length;u=o[v+_TwoColorTimeline.PREV_R],d=o[v+_TwoColorTimeline.PREV_G],m=o[v+_TwoColorTimeline.PREV_B],p=o[v+_TwoColorTimeline.PREV_A],g=o[v+_TwoColorTimeline.PREV_R2],_=o[v+_TwoColorTimeline.PREV_G2],y=o[v+_TwoColorTimeline.PREV_B2]}else{const v=Animation$3.binarySearch(o,e,_TwoColorTimeline.ENTRIES);u=o[v+_TwoColorTimeline.PREV_R],d=o[v+_TwoColorTimeline.PREV_G],m=o[v+_TwoColorTimeline.PREV_B],p=o[v+_TwoColorTimeline.PREV_A],g=o[v+_TwoColorTimeline.PREV_R2],_=o[v+_TwoColorTimeline.PREV_G2],y=o[v+_TwoColorTimeline.PREV_B2];const U=o[v],w=this.getCurvePercent(v/_TwoColorTimeline.ENTRIES-1,1-(e-U)/(o[v+_TwoColorTimeline.PREV_TIME]-U));u+=(o[v+_TwoColorTimeline.R]-u)*w,d+=(o[v+_TwoColorTimeline.G]-d)*w,m+=(o[v+_TwoColorTimeline.B]-m)*w,p+=(o[v+_TwoColorTimeline.A]-p)*w,g+=(o[v+_TwoColorTimeline.R2]-g)*w,_+=(o[v+_TwoColorTimeline.G2]-_)*w,y+=(o[v+_TwoColorTimeline.B2]-y)*w}if(r==1)c.color.set(u,d,m,p),c.darkColor.set(g,_,y,1);else{const v=c.color,U=c.darkColor;a==MixBlend.setup&&(v.setFromColor(c.data.color),U.setFromColor(c.data.darkColor)),v.add((u-v.r)*r,(d-v.g)*r,(m-v.b)*r,(p-v.a)*r),U.add((g-U.r)*r,(_-U.g)*r,(y-U.b)*r,0)}}};let TwoColorTimeline=_TwoColorTimeline;TwoColorTimeline.ENTRIES=8;TwoColorTimeline.PREV_TIME=-8;TwoColorTimeline.PREV_R=-7;TwoColorTimeline.PREV_G=-6;TwoColorTimeline.PREV_B=-5;TwoColorTimeline.PREV_A=-4;TwoColorTimeline.PREV_R2=-3;TwoColorTimeline.PREV_G2=-2;TwoColorTimeline.PREV_B2=-1;TwoColorTimeline.R=1;TwoColorTimeline.G=2;TwoColorTimeline.B=3;TwoColorTimeline.A=4;TwoColorTimeline.R2=5;TwoColorTimeline.G2=6;TwoColorTimeline.B2=7;let AttachmentTimeline$1=class{constructor(t){this.frames=Utils.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(c==MixDirection.mixOut&&h==MixBlend.setup){const p=o.data.attachmentName;o.setAttachment(p==null?null:t.getAttachment(this.slotIndex,p));return}const u=this.frames;if(s<u[0]){if(h==MixBlend.setup||h==MixBlend.first){const p=o.data.attachmentName;o.setAttachment(p==null?null:t.getAttachment(this.slotIndex,p))}return}let d=0;s>=u[u.length-1]?d=u.length-1:d=Animation$3.binarySearch(u,s,1)-1;const m=this.attachmentNames[d];t.slots[this.slotIndex].setAttachment(m==null?null:t.getAttachment(this.slotIndex,m))}},zeros=null,DeformTimeline$1=class extends CurveTimeline$1{constructor(t){super(t),this.frames=Utils.newFloatArray(t),this.frameVertices=new Array(t),zeros==null&&(zeros=Utils.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,s){this.frames[t]=e,this.frameVertices[t]=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex],u=o.getAttachment();if(!(u instanceof VertexAttachment$1)||!u.applyDeform(this.attachment))return;const d=o.attachmentVertices;d.length==0&&(h=MixBlend.setup);const m=this.frameVertices,p=m[0].length,g=this.frames;if(s<g[0]){const N=u;switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(a==1){d.length=0;break}const W=Utils.setArraySize(d,p);if(N.bones==null){const et=N.vertices;for(let it=0;it<p;it++)W[it]+=(et[it]-W[it])*a}else{a=1-a;for(let et=0;et<p;et++)W[et]*=a}}return}const _=Utils.setArraySize(d,p);if(s>=g[g.length-1]){const N=m[g.length-1];if(a==1)if(h==MixBlend.add){const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++)_[it]+=N[it]-et[it]}else for(let et=0;et<p;et++)_[et]+=N[et]}else Utils.arrayCopy(N,0,_,0,p);else switch(h){case MixBlend.setup:{const et=u;if(et.bones==null){const it=et.vertices;for(let ft=0;ft<p;ft++){const mt=it[ft];_[ft]=mt+(N[ft]-mt)*a}}else for(let it=0;it<p;it++)_[it]=N[it]*a;break}case MixBlend.first:case MixBlend.replace:for(let et=0;et<p;et++)_[et]+=(N[et]-_[et])*a;case MixBlend.add:const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++)_[it]+=(N[it]-et[it])*a}else for(let et=0;et<p;et++)_[et]+=N[et]*a}return}const y=Animation$3.binarySearch(g,s),v=m[y-1],U=m[y],w=g[y],k=this.getCurvePercent(y-1,1-(s-w)/(g[y-1]-w));if(a==1)if(h==MixBlend.add){const N=u;if(N.bones==null){const W=N.vertices;for(let et=0;et<p;et++){const it=v[et];_[et]+=it+(U[et]-it)*k-W[et]}}else for(let W=0;W<p;W++){const et=v[W];_[W]+=et+(U[W]-et)*k}}else for(let N=0;N<p;N++){const W=v[N];_[N]=W+(U[N]-W)*k}else switch(h){case MixBlend.setup:{const W=u;if(W.bones==null){const et=W.vertices;for(let it=0;it<p;it++){const ft=v[it],mt=et[it];_[it]=mt+(ft+(U[it]-ft)*k-mt)*a}}else for(let et=0;et<p;et++){const it=v[et];_[et]=(it+(U[et]-it)*k)*a}break}case MixBlend.first:case MixBlend.replace:for(let W=0;W<p;W++){const et=v[W];_[W]+=(et+(U[W]-et)*k-_[W])*a}break;case MixBlend.add:const N=u;if(N.bones==null){const W=N.vertices;for(let et=0;et<p;et++){const it=v[et];_[et]+=(it+(U[et]-it)*k-W[et])*a}}else for(let W=0;W<p;W++){const et=v[W];_[W]+=(et+(U[W]-et)*k)*a}}}},EventTimeline$1=class{constructor(t){this.frames=Utils.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,r,a,h,c){if(r==null)return;const o=this.frames,u=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,r,a,h,c),e=-1;else if(e>=o[u-1])return;if(s<o[0])return;let d=0;if(e<o[0])d=0;else{d=Animation$3.binarySearch(o,e);const m=o[d];for(;d>0&&o[d-1]==m;)d--}for(;d<u&&s>=o[d];d++)r.push(this.events[d])}},DrawOrderTimeline$1=class{constructor(t){this.frames=Utils.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,r,a,h,c){const o=t.drawOrder,u=t.slots;if(c==MixDirection.mixOut&&h==MixBlend.setup){Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const d=this.frames;if(s<d[0]){(h==MixBlend.setup||h==MixBlend.first)&&Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let m=0;s>=d[d.length-1]?m=d.length-1:m=Animation$3.binarySearch(d,s)-1;const p=this.drawOrders[m];if(p==null)Utils.arrayCopy(u,0,o,0,u.length);else for(let g=0,_=p.length;g<_;g++)o[g]=u[p[g]]}};const _IkConstraintTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_IkConstraintTimeline.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(n,t,e,s,r,a){n*=_IkConstraintTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_IkConstraintTimeline.MIX]=e,this.frames[n+_IkConstraintTimeline.BEND_DIRECTION]=s,this.frames[n+_IkConstraintTimeline.COMPRESS]=r?1:0,this.frames[n+_IkConstraintTimeline.STRETCH]=a?1:0}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.ikConstraints[this.ikConstraintIndex];if(e<c[0]){switch(a){case MixBlend.setup:o.mix=o.data.mix,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case MixBlend.first:o.mix+=(o.data.mix-o.mix)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}if(e>=c[c.length-_IkConstraintTimeline.ENTRIES]){a==MixBlend.setup?(o.mix=o.data.mix+(c[c.length+_IkConstraintTimeline.PREV_MIX]-o.data.mix)*r,h==MixDirection.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=c[c.length+_IkConstraintTimeline.PREV_BEND_DIRECTION],o.compress=c[c.length+_IkConstraintTimeline.PREV_COMPRESS]!=0,o.stretch=c[c.length+_IkConstraintTimeline.PREV_STRETCH]!=0)):(o.mix+=(c[c.length+_IkConstraintTimeline.PREV_MIX]-o.mix)*r,h==MixDirection.mixIn&&(o.bendDirection=c[c.length+_IkConstraintTimeline.PREV_BEND_DIRECTION],o.compress=c[c.length+_IkConstraintTimeline.PREV_COMPRESS]!=0,o.stretch=c[c.length+_IkConstraintTimeline.PREV_STRETCH]!=0));return}const u=Animation$3.binarySearch(c,e,_IkConstraintTimeline.ENTRIES),d=c[u+_IkConstraintTimeline.PREV_MIX],m=c[u],p=this.getCurvePercent(u/_IkConstraintTimeline.ENTRIES-1,1-(e-m)/(c[u+_IkConstraintTimeline.PREV_TIME]-m));a==MixBlend.setup?(o.mix=o.data.mix+(d+(c[u+_IkConstraintTimeline.MIX]-d)*p-o.data.mix)*r,h==MixDirection.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=c[u+_IkConstraintTimeline.PREV_BEND_DIRECTION],o.compress=c[u+_IkConstraintTimeline.PREV_COMPRESS]!=0,o.stretch=c[u+_IkConstraintTimeline.PREV_STRETCH]!=0)):(o.mix+=(d+(c[u+_IkConstraintTimeline.MIX]-d)*p-o.mix)*r,h==MixDirection.mixIn&&(o.bendDirection=c[u+_IkConstraintTimeline.PREV_BEND_DIRECTION],o.compress=c[u+_IkConstraintTimeline.PREV_COMPRESS]!=0,o.stretch=c[u+_IkConstraintTimeline.PREV_STRETCH]!=0))}};let IkConstraintTimeline$1=_IkConstraintTimeline;IkConstraintTimeline$1.ENTRIES=5;IkConstraintTimeline$1.PREV_TIME=-5;IkConstraintTimeline$1.PREV_MIX=-4;IkConstraintTimeline$1.PREV_BEND_DIRECTION=-3;IkConstraintTimeline$1.PREV_COMPRESS=-2;IkConstraintTimeline$1.PREV_STRETCH=-1;IkConstraintTimeline$1.MIX=1;IkConstraintTimeline$1.BEND_DIRECTION=2;IkConstraintTimeline$1.COMPRESS=3;IkConstraintTimeline$1.STRETCH=4;const _TransformConstraintTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TransformConstraintTimeline.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(n,t,e,s,r,a){n*=_TransformConstraintTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_TransformConstraintTimeline.ROTATE]=e,this.frames[n+_TransformConstraintTimeline.TRANSLATE]=s,this.frames[n+_TransformConstraintTimeline.SCALE]=r,this.frames[n+_TransformConstraintTimeline.SHEAR]=a}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.transformConstraints[this.transformConstraintIndex];if(e<c[0]){const g=o.data;switch(a){case MixBlend.setup:o.rotateMix=g.rotateMix,o.translateMix=g.translateMix,o.scaleMix=g.scaleMix,o.shearMix=g.shearMix;return;case MixBlend.first:o.rotateMix+=(g.rotateMix-o.rotateMix)*r,o.translateMix+=(g.translateMix-o.translateMix)*r,o.scaleMix+=(g.scaleMix-o.scaleMix)*r,o.shearMix+=(g.shearMix-o.shearMix)*r}return}let u=0,d=0,m=0,p=0;if(e>=c[c.length-_TransformConstraintTimeline.ENTRIES]){const g=c.length;u=c[g+_TransformConstraintTimeline.PREV_ROTATE],d=c[g+_TransformConstraintTimeline.PREV_TRANSLATE],m=c[g+_TransformConstraintTimeline.PREV_SCALE],p=c[g+_TransformConstraintTimeline.PREV_SHEAR]}else{const g=Animation$3.binarySearch(c,e,_TransformConstraintTimeline.ENTRIES);u=c[g+_TransformConstraintTimeline.PREV_ROTATE],d=c[g+_TransformConstraintTimeline.PREV_TRANSLATE],m=c[g+_TransformConstraintTimeline.PREV_SCALE],p=c[g+_TransformConstraintTimeline.PREV_SHEAR];const _=c[g],y=this.getCurvePercent(g/_TransformConstraintTimeline.ENTRIES-1,1-(e-_)/(c[g+_TransformConstraintTimeline.PREV_TIME]-_));u+=(c[g+_TransformConstraintTimeline.ROTATE]-u)*y,d+=(c[g+_TransformConstraintTimeline.TRANSLATE]-d)*y,m+=(c[g+_TransformConstraintTimeline.SCALE]-m)*y,p+=(c[g+_TransformConstraintTimeline.SHEAR]-p)*y}if(a==MixBlend.setup){const g=o.data;o.rotateMix=g.rotateMix+(u-g.rotateMix)*r,o.translateMix=g.translateMix+(d-g.translateMix)*r,o.scaleMix=g.scaleMix+(m-g.scaleMix)*r,o.shearMix=g.shearMix+(p-g.shearMix)*r}else o.rotateMix+=(u-o.rotateMix)*r,o.translateMix+=(d-o.translateMix)*r,o.scaleMix+=(m-o.scaleMix)*r,o.shearMix+=(p-o.shearMix)*r}};let TransformConstraintTimeline$1=_TransformConstraintTimeline;TransformConstraintTimeline$1.ENTRIES=5;TransformConstraintTimeline$1.PREV_TIME=-5;TransformConstraintTimeline$1.PREV_ROTATE=-4;TransformConstraintTimeline$1.PREV_TRANSLATE=-3;TransformConstraintTimeline$1.PREV_SCALE=-2;TransformConstraintTimeline$1.PREV_SHEAR=-1;TransformConstraintTimeline$1.ROTATE=1;TransformConstraintTimeline$1.TRANSLATE=2;TransformConstraintTimeline$1.SCALE=3;TransformConstraintTimeline$1.SHEAR=4;const _PathConstraintPositionTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_PathConstraintPositionTimeline.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(n,t,e){n*=_PathConstraintPositionTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_PathConstraintPositionTimeline.VALUE]=e}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.pathConstraints[this.pathConstraintIndex];if(e<c[0]){switch(a){case MixBlend.setup:o.position=o.data.position;return;case MixBlend.first:o.position+=(o.data.position-o.position)*r}return}let u=0;if(e>=c[c.length-_PathConstraintPositionTimeline.ENTRIES])u=c[c.length+_PathConstraintPositionTimeline.PREV_VALUE];else{const d=Animation$3.binarySearch(c,e,_PathConstraintPositionTimeline.ENTRIES);u=c[d+_PathConstraintPositionTimeline.PREV_VALUE];const m=c[d],p=this.getCurvePercent(d/_PathConstraintPositionTimeline.ENTRIES-1,1-(e-m)/(c[d+_PathConstraintPositionTimeline.PREV_TIME]-m));u+=(c[d+_PathConstraintPositionTimeline.VALUE]-u)*p}a==MixBlend.setup?o.position=o.data.position+(u-o.data.position)*r:o.position+=(u-o.position)*r}};let PathConstraintPositionTimeline$1=_PathConstraintPositionTimeline;PathConstraintPositionTimeline$1.ENTRIES=2;PathConstraintPositionTimeline$1.PREV_TIME=-2;PathConstraintPositionTimeline$1.PREV_VALUE=-1;PathConstraintPositionTimeline$1.VALUE=1;let PathConstraintSpacingTimeline$1=class extends PathConstraintPositionTimeline$1{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,s,r,a,h,c){const o=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(s<o[0]){switch(h){case MixBlend.setup:u.spacing=u.data.spacing;return;case MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*a}return}let d=0;if(s>=o[o.length-PathConstraintSpacingTimeline$1.ENTRIES])d=o[o.length+PathConstraintSpacingTimeline$1.PREV_VALUE];else{const m=Animation$3.binarySearch(o,s,PathConstraintSpacingTimeline$1.ENTRIES);d=o[m+PathConstraintSpacingTimeline$1.PREV_VALUE];const p=o[m],g=this.getCurvePercent(m/PathConstraintSpacingTimeline$1.ENTRIES-1,1-(s-p)/(o[m+PathConstraintSpacingTimeline$1.PREV_TIME]-p));d+=(o[m+PathConstraintSpacingTimeline$1.VALUE]-d)*g}h==MixBlend.setup?u.spacing=u.data.spacing+(d-u.data.spacing)*a:u.spacing+=(d-u.spacing)*a}};const _PathConstraintMixTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_PathConstraintMixTimeline.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(n,t,e,s){n*=_PathConstraintMixTimeline.ENTRIES,this.frames[n]=t,this.frames[n+_PathConstraintMixTimeline.ROTATE]=e,this.frames[n+_PathConstraintMixTimeline.TRANSLATE]=s}apply(n,t,e,s,r,a,h){const c=this.frames,o=n.pathConstraints[this.pathConstraintIndex];if(e<c[0]){switch(a){case MixBlend.setup:o.rotateMix=o.data.rotateMix,o.translateMix=o.data.translateMix;return;case MixBlend.first:o.rotateMix+=(o.data.rotateMix-o.rotateMix)*r,o.translateMix+=(o.data.translateMix-o.translateMix)*r}return}let u=0,d=0;if(e>=c[c.length-_PathConstraintMixTimeline.ENTRIES])u=c[c.length+_PathConstraintMixTimeline.PREV_ROTATE],d=c[c.length+_PathConstraintMixTimeline.PREV_TRANSLATE];else{const m=Animation$3.binarySearch(c,e,_PathConstraintMixTimeline.ENTRIES);u=c[m+_PathConstraintMixTimeline.PREV_ROTATE],d=c[m+_PathConstraintMixTimeline.PREV_TRANSLATE];const p=c[m],g=this.getCurvePercent(m/_PathConstraintMixTimeline.ENTRIES-1,1-(e-p)/(c[m+_PathConstraintMixTimeline.PREV_TIME]-p));u+=(c[m+_PathConstraintMixTimeline.ROTATE]-u)*g,d+=(c[m+_PathConstraintMixTimeline.TRANSLATE]-d)*g}a==MixBlend.setup?(o.rotateMix=o.data.rotateMix+(u-o.data.rotateMix)*r,o.translateMix=o.data.translateMix+(d-o.data.translateMix)*r):(o.rotateMix+=(u-o.rotateMix)*r,o.translateMix+=(d-o.translateMix)*r)}};let PathConstraintMixTimeline$1=_PathConstraintMixTimeline;PathConstraintMixTimeline$1.ENTRIES=3;PathConstraintMixTimeline$1.PREV_TIME=-3;PathConstraintMixTimeline$1.PREV_ROTATE=-2;PathConstraintMixTimeline$1.PREV_TRANSLATE=-1;PathConstraintMixTimeline$1.ROTATE=1;PathConstraintMixTimeline$1.TRANSLATE=2;const _AnimationState$1=class{constructor(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new EventQueue$1(this),this.propertyIDs=new IntSet,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new Pool$1(()=>new TrackEntry$1),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a==null)continue;a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;let h=t*a.timeScale;if(a.delay>0){if(a.delay-=h,a.delay>0)continue;h=-a.delay,a.delay=0}let c=a.next;if(c!=null){const o=a.trackLast-c.delay;if(o>=0){for(c.delay=0,c.trackTime=a.timeScale==0?0:(o/a.timeScale+t)*c.timeScale,a.trackTime+=h,this.setCurrent(s,c,!0);c.mixingFrom!=null;)c.mixTime+=t,c=c.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&a.mixingFrom==null){e[s]=null,this.queue.end(a),this.disposeNext(a);continue}if(a.mixingFrom!=null&&this.updateMixingFrom(a,t)){let o=a.mixingFrom;for(a.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}a.trackTime+=h}this.queue.drain()}updateMixingFrom(t,e){const s=t.mixingFrom;if(s==null)return!0;const r=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((s.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=s.mixingFrom,s.mixingFrom!=null&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),r):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,s=this.tracks;let r=!1;for(let a=0,h=s.length;a<h;a++){const c=s[a];if(c==null||c.delay>0)continue;r=!0;const o=a==0?MixBlend.first:c.mixBlend;let u=c.alpha;c.mixingFrom!=null?u*=this.applyMixingFrom(c,t,o):c.trackTime>=c.trackEnd&&c.next==null&&(u=0);const d=c.animationLast,m=c.getAnimationTime(),p=c.animation.timelines.length,g=c.animation.timelines;if(a==0&&u==1||o==MixBlend.add)for(let _=0;_<p;_++)g[_].apply(t,d,m,e,u,o,MixDirection.mixIn);else{const _=c.timelineMode,y=c.timelinesRotation.length==0;y&&Utils.setArraySize(c.timelinesRotation,p<<1,null);const v=c.timelinesRotation;for(let U=0;U<p;U++){const w=g[U],k=_[U]==_AnimationState$1.SUBSEQUENT?o:MixBlend.setup;w instanceof RotateTimeline$1?this.applyRotateTimeline(w,t,m,u,k,v,U<<1,y):w.apply(t,d,m,e,u,k,MixDirection.mixIn)}}this.queueEvents(c,m),e.length=0,c.nextAnimationLast=m,c.nextTrackLast=c.trackTime}return this.queue.drain(),r}applyMixingFrom(t,e,s){const r=t.mixingFrom;r.mixingFrom!=null&&this.applyMixingFrom(r,e,s);let a=0;t.mixDuration==0?(a=1,s==MixBlend.first&&(s=MixBlend.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),s!=MixBlend.first&&(s=r.mixBlend));const h=a<r.eventThreshold?this.events:null,c=a<r.attachmentThreshold,o=a<r.drawOrderThreshold,u=r.animationLast,d=r.getAnimationTime(),m=r.animation.timelines.length,p=r.animation.timelines,g=r.alpha*t.interruptAlpha,_=g*(1-a);if(s==MixBlend.add)for(let y=0;y<m;y++)p[y].apply(e,u,d,h,_,s,MixDirection.mixOut);else{const y=r.timelineMode,v=r.timelineHoldMix,U=r.timelinesRotation.length==0;U&&Utils.setArraySize(r.timelinesRotation,m<<1,null);const w=r.timelinesRotation;r.totalAlpha=0;for(let k=0;k<m;k++){const N=p[k];let W=MixDirection.mixOut,et,it=0;switch(y[k]){case _AnimationState$1.SUBSEQUENT:if(!c&&N instanceof AttachmentTimeline$1||!o&&N instanceof DrawOrderTimeline$1)continue;et=s,it=_;break;case _AnimationState$1.FIRST:et=MixBlend.setup,it=_;break;case _AnimationState$1.HOLD:et=MixBlend.setup,it=g;break;default:et=MixBlend.setup;const ft=v[k];it=g*Math.max(0,1-ft.mixTime/ft.mixDuration);break}r.totalAlpha+=it,N instanceof RotateTimeline$1?this.applyRotateTimeline(N,e,d,it,et,w,k<<1,U):(et==MixBlend.setup&&(N instanceof AttachmentTimeline$1?c&&(W=MixDirection.mixOut):N instanceof DrawOrderTimeline$1&&o&&(W=MixDirection.mixOut)),N.apply(e,u,d,h,it,et,W))}}return t.mixDuration>0&&this.queueEvents(r,d),this.events.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime,a}applyRotateTimeline(t,e,s,r,a,h,c,o){if(o&&(h[c]=0),r==1){t.apply(e,0,s,null,1,a,MixDirection.mixIn);return}const u=t,d=u.frames,m=e.bones[u.boneIndex];let p=0,g=0;if(s<d[0])switch(a){case MixBlend.setup:m.rotation=m.data.rotation;default:return;case MixBlend.first:p=m.rotation,g=m.data.rotation}else if(p=a==MixBlend.setup?m.data.rotation:m.rotation,s>=d[d.length-RotateTimeline$1.ENTRIES])g=m.data.rotation+d[d.length+RotateTimeline$1.PREV_ROTATION];else{const v=Animation$3.binarySearch(d,s,RotateTimeline$1.ENTRIES),U=d[v+RotateTimeline$1.PREV_ROTATION],w=d[v],k=u.getCurvePercent((v>>1)-1,1-(s-w)/(d[v+RotateTimeline$1.PREV_TIME]-w));g=d[v+RotateTimeline$1.ROTATION]-U,g-=(16384-(16384.499999999996-g/360|0))*360,g=U+g*k+m.data.rotation,g-=(16384-(16384.499999999996-g/360|0))*360}let _=0,y=g-p;if(y-=(16384-(16384.499999999996-y/360|0))*360,y==0)_=h[c];else{let v=0,U=0;o?(v=0,U=y):(v=h[c],U=h[c+1]);const w=y>0;let k=v>=0;MathUtils.signum(U)!=MathUtils.signum(y)&&Math.abs(U)<=90&&(Math.abs(v)>180&&(v+=360*MathUtils.signum(v)),k=w),_=y+v-v%360,k!=w&&(_+=360*MathUtils.signum(v)),h[c]=_}h[c+1]=y,p+=_*r,m.rotation=p-(16384-(16384.499999999996-p/360|0))*360}queueEvents(t,e){const s=t.animationStart,r=t.animationEnd,a=r-s,h=t.trackLast%a,c=this.events;let o=0;const u=c.length;for(;o<u;o++){const m=c[o];if(m.time<h)break;m.time>r||this.queue.event(t,m)}let d=!1;for(t.loop?d=a==0||h>t.trackTime%a:d=e>=r&&t.animationLast<r,d&&this.queue.complete(t);o<u;o++)c[o].time<s||this.queue.event(t,c[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let s=e;for(;;){const r=s.mixingFrom;if(r==null)break;this.queue.end(r),s.mixingFrom=null,s.mixingTo=null,s=r}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){const r=this.expandToIndex(t);this.tracks[t]=e,r!=null&&(s&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom!=null&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,s)}setAnimationWith(t,e,s){if(e==null)throw new Error("animation cannot be null.");let r=!0,a=this.expandToIndex(t);a!=null&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,r=!1):this.disposeNext(a));const h=this.trackEntry(t,e,s,a);return this.setCurrent(t,h,r),this.queue.drain(),h}addAnimation(t,e,s,r){const a=this.data.skeletonData.findAnimation(e);if(a==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,a,s,r)}addAnimationWith(t,e,s,r){if(e==null)throw new Error("animation cannot be null.");let a=this.expandToIndex(t);if(a!=null)for(;a.next!=null;)a=a.next;const h=this.trackEntry(t,e,s,a);if(a==null)this.setCurrent(t,h,!0),this.queue.drain();else if(a.next=h,r<=0){const c=a.animationEnd-a.animationStart;c!=0?(a.loop?r+=c*(1+(a.trackTime/c|0)):r+=Math.max(c,a.trackTime),r-=this.data.getMix(a.animation,e)):r=a.trackTime}return h.delay=r,h}setEmptyAnimation(t,e){const s=this.setAnimationWith(t,_AnimationState$1.emptyAnimation,!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e,s){s<=0&&(s-=e);const r=this.addAnimationWith(t,_AnimationState$1.emptyAnimation,!1,s);return r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,r=this.tracks.length;s<r;s++){const a=this.tracks[s];a!=null&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(Utils.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,r){const a=this.trackEntryPool.obtain();return a.trackIndex=t,a.animation=e,a.loop=s,a.holdPrevious=!1,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.interruptAlpha=1,a.mixTime=0,a.mixDuration=r==null?0:this.data.getMix(r.animation,e),a}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let s=this.tracks[t];if(s!=null){for(;s.mixingFrom!=null;)s=s.mixingFrom;do(s.mixingFrom==null||s.mixBlend!=MixBlend.add)&&this.setTimelineModes(s),s=s.mixingTo;while(s!=null)}}}setTimelineModes(t){const e=t.mixingTo,s=t.animation.timelines,r=t.animation.timelines.length,a=Utils.setArraySize(t.timelineMode,r);t.timelineHoldMix.length=0;const h=Utils.setArraySize(t.timelineHoldMix,r),c=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<r;o++)c.add(s[o].getPropertyId()),a[o]=_AnimationState$1.HOLD;return}t:for(let o=0;o<r;o++){const u=s[o].getPropertyId();if(!c.add(u))a[o]=_AnimationState$1.SUBSEQUENT;else if(e==null||!this.hasTimeline(e,u))a[o]=_AnimationState$1.FIRST;else{for(let d=e.mixingTo;d!=null;d=d.mixingTo)if(!this.hasTimeline(d,u)){if(t.mixDuration>0){a[o]=_AnimationState$1.HOLD_MIX,h[o]=d;continue t}break}a[o]=_AnimationState$1.HOLD}}}hasTimeline(t,e){const s=t.animation.timelines;for(let r=0,a=s.length;r<a;r++)if(s[r].getPropertyId()==e)return!0;return!1}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,s){_AnimationState$1.deprecatedWarning1||(_AnimationState$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,s)}addAnimationByName(t,e,s,r){_AnimationState$1.deprecatedWarning2||(_AnimationState$1.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,s,r)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return _AnimationState$1.deprecatedWarning3||(_AnimationState$1.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let AnimationState$1=_AnimationState$1;AnimationState$1.emptyAnimation=new Animation$3("<empty>",[],0);AnimationState$1.SUBSEQUENT=0;AnimationState$1.FIRST=1;AnimationState$1.HOLD=2;AnimationState$1.HOLD_MIX=3;AnimationState$1.deprecatedWarning1=!1;AnimationState$1.deprecatedWarning2=!1;AnimationState$1.deprecatedWarning3=!1;const _TrackEntry$1=class{constructor(){this.mixBlend=MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return _TrackEntry$1.deprecatedWarning1||(_TrackEntry$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){_TrackEntry$1.deprecatedWarning1||(_TrackEntry$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return _TrackEntry$1.deprecatedWarning2||(_TrackEntry$1.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){_TrackEntry$1.deprecatedWarning2||(_TrackEntry$1.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let TrackEntry$1=_TrackEntry$1;TrackEntry$1.deprecatedWarning1=!1;TrackEntry$1.deprecatedWarning2=!1;const _EventQueue=class{constructor(n){this.objects=[],this.drainDisabled=!1,this.animState=n}start(n){this.objects.push(EventType$1.start),this.objects.push(n),this.animState.animationsChanged=!0}interrupt(n){this.objects.push(EventType$1.interrupt),this.objects.push(n)}end(n){this.objects.push(EventType$1.end),this.objects.push(n),this.animState.animationsChanged=!0}dispose(n){this.objects.push(EventType$1.dispose),this.objects.push(n)}complete(n){this.objects.push(EventType$1.complete),this.objects.push(n)}event(n,t){this.objects.push(EventType$1.event),this.objects.push(n),this.objects.push(t)}deprecateStuff(){return _EventQueue.deprecatedWarning1||(_EventQueue.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const n=this.objects,t=this.animState.listeners;for(let e=0;e<n.length;e+=2){const s=n[e],r=n[e+1];switch(s){case EventType$1.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let c=0;c<t.length;c++)t[c].start&&t[c].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case EventType$1.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let c=0;c<t.length;c++)t[c].interrupt&&t[c].interrupt(r);break;case EventType$1.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let c=0;c<t.length;c++)t[c].end&&t[c].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case EventType$1.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let c=0;c<t.length;c++)t[c].dispose&&t[c].dispose(r);this.animState.trackEntryPool.free(r);break;case EventType$1.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let c=0;c<t.length;c++)t[c].complete&&t[c].complete(r);const a=MathUtils.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,a),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,a);break;case EventType$1.event:const h=n[e+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,h);for(let c=0;c<t.length;c++)t[c].event&&t[c].event(r,h);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,h),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,h);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let EventQueue$1=_EventQueue;EventQueue$1.deprecatedWarning1=!1;var EventType$1=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(EventType$1||{});class AnimationStateAdapter2{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const _AnimationStateData=class{constructor(n){if(this.animationToMixTime={},this.defaultMix=0,n==null)throw new Error("skeletonData cannot be null.");this.skeletonData=n}setMix(n,t,e){const s=this.skeletonData.findAnimation(n);if(s==null)throw new Error(`Animation not found: ${n}`);const r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(s,r,e)}setMixByName(n,t,e){_AnimationStateData.deprecatedWarning1||(_AnimationStateData.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(n,t,e)}setMixWith(n,t,e){if(n==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");const s=`${n.name}.${t.name}`;this.animationToMixTime[s]=e}getMix(n,t){const e=`${n.name}.${t.name}`,s=this.animationToMixTime[e];return s===void 0?this.defaultMix:s}};let AnimationStateData$1=_AnimationStateData;AnimationStateData$1.deprecatedWarning1=!1;let AtlasAttachmentLoader$1=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);const a=new RegionAttachment$1(e);return a.region=r,a}newMeshAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);const a=new MeshAttachment$1(e);return a.region=r,a}newBoundingBoxAttachment(t,e){return new BoundingBoxAttachment$1(e)}newPathAttachment(t,e){return new PathAttachment$1(e)}newPointAttachment(t,e){return new PointAttachment$1(e)}newClippingAttachment(t,e){return new ClippingAttachment$1(e)}},Bone$1=class{constructor(t,e,s){if(this.matrix=new Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,a,h,c){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=a,this.ashearX=h,this.ashearY=c,this.appliedValid=!0;const o=this.parent,u=this.matrix,d=this.skeleton.scaleX,m=-this.skeleton.scaleY;if(o==null){const v=this.skeleton,U=s+90+c;u.a=MathUtils.cosDeg(s+h)*r*d,u.c=MathUtils.cosDeg(U)*a*d,u.b=MathUtils.sinDeg(s+h)*r*m,u.d=MathUtils.sinDeg(U)*a*m,u.tx=t*d+v.x,u.ty=e*m+v.y;return}let p=o.matrix.a,g=o.matrix.c,_=o.matrix.b,y=o.matrix.d;switch(u.tx=p*t+g*e+o.matrix.tx,u.ty=_*t+y*e+o.matrix.ty,this.data.transformMode){case TransformMode.Normal:{const v=s+90+c,U=MathUtils.cosDeg(s+h)*r,w=MathUtils.cosDeg(v)*a,k=MathUtils.sinDeg(s+h)*r,N=MathUtils.sinDeg(v)*a;u.a=p*U+g*k,u.c=p*w+g*N,u.b=_*U+y*k,u.d=_*w+y*N;return}case TransformMode.OnlyTranslation:{const v=s+90+c;u.a=MathUtils.cosDeg(s+h)*r,u.c=MathUtils.cosDeg(v)*a,u.b=MathUtils.sinDeg(s+h)*r,u.d=MathUtils.sinDeg(v)*a;break}case TransformMode.NoRotationOrReflection:{let v=p*p+_*_,U=0;v>1e-4?(v=Math.abs(p*y-g*_)/v,g=_*v,y=p*v,U=Math.atan2(_,p)*MathUtils.radDeg):(p=0,_=0,U=90-Math.atan2(y,g)*MathUtils.radDeg);const w=s+h-U,k=s+c-U+90,N=MathUtils.cosDeg(w)*r,W=MathUtils.cosDeg(k)*a,et=MathUtils.sinDeg(w)*r,it=MathUtils.sinDeg(k)*a;u.a=p*N-g*et,u.c=p*W-g*it,u.b=_*N+y*et,u.d=_*W+y*it;break}case TransformMode.NoScale:case TransformMode.NoScaleOrReflection:{const v=MathUtils.cosDeg(s),U=MathUtils.sinDeg(s);let w=(p*v+g*U)/d,k=(_*v+y*U)/m,N=Math.sqrt(w*w+k*k);N>1e-5&&(N=1/N),w*=N,k*=N,N=Math.sqrt(w*w+k*k),this.data.transformMode==TransformMode.NoScale&&p*y-g*_<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(N=-N);const W=Math.PI/2+Math.atan2(k,w),et=Math.cos(W)*N,it=Math.sin(W)*N,ft=MathUtils.cosDeg(h)*r,mt=MathUtils.cosDeg(90+c)*a,xt=MathUtils.sinDeg(h)*r,yt=MathUtils.sinDeg(90+c)*a;u.a=w*ft+et*xt,u.c=w*mt+et*yt,u.b=k*ft+it*xt,u.d=k*mt+it*yt;break}}u.a*=d,u.c*=d,u.b*=m,u.d*=m}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*MathUtils.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*MathUtils.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*MathUtils.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*MathUtils.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),a=e.tx-s.tx,h=e.ty-s.ty;this.ax=a*s.d*r-h*s.c*r,this.ay=h*s.a*r-a*s.b*r;const c=r*s.d,o=r*s.a,u=r*s.c,d=r*s.b,m=c*e.a-u*e.b,p=c*e.c-u*e.d,g=o*e.b-d*e.a,_=o*e.d-d*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(m*m+g*g),this.ascaleX>1e-4){const y=m*_-p*g;this.ascaleY=y/this.ascaleX,this.ashearY=Math.atan2(m*p+g*_,y)*MathUtils.radDeg,this.arotation=Math.atan2(g,m)*MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(p*p+_*_),this.ashearY=0,this.arotation=90-Math.atan2(_,p)*MathUtils.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=1/(s*h-r*a),o=t.x-e.tx,u=t.y-e.ty;return t.x=o*h*c-u*r*c,t.y=u*s*c-o*a*c,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*MathUtils.radDeg}localToWorldRotation(t){const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*MathUtils.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=MathUtils.cosDeg(t),o=MathUtils.sinDeg(t);e.a=c*s-o*a,e.c=c*r-o*h,e.b=o*s+c*a,e.d=o*r+c*h,this.appliedValid=!1}},BoneData$1=class{constructor(t,e,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}},Event$2=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},EventData$1=class{constructor(t){this.name=t}},IkConstraint$1=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}}apply1(t,e,s,r,a,h,c){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,u=1/(o.a*o.d-o.b*o.c),d=e-o.tx,m=s-o.ty,p=(d*o.d-m*o.c)*u-t.ax,g=(m*o.a-d*o.b)*u-t.ay;let _=Math.atan2(g,p)*MathUtils.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(_+=180),_>180?_-=360:_<-180&&(_+=360);let y=t.ascaleX,v=t.ascaleY;if(r||a){const U=t.data.length*y,w=Math.sqrt(p*p+g*g);if(r&&w<U||a&&w>U&&U>1e-4){const k=(w/U-1)*c+1;y*=k,h&&(v*=k)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+_*c,y,v,t.ashearX,t.ashearY)}apply2(t,e,s,r,a,h,c){if(c==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const o=t.ax,u=t.ay;let d=t.ascaleX,m=d,p=t.ascaleY,g=e.ascaleX;const _=t.matrix;let y=0,v=0,U=0;d<0?(d=-d,y=180,U=-1):(y=0,U=1),p<0&&(p=-p,U=-U),g<0?(g=-g,v=180):v=0;const w=e.ax;let k=0,N=0,W=0,et=_.a,it=_.c,ft=_.b,mt=_.d;const xt=Math.abs(d-p)<=1e-4;xt?(k=e.ay,N=et*w+it*k+_.tx,W=ft*w+mt*k+_.ty):(k=0,N=et*w+_.tx,W=ft*w+_.ty);const yt=t.parent.matrix;et=yt.a,it=yt.c,ft=yt.b,mt=yt.d;const vt=1/(et*mt-it*ft);let St=s-yt.tx,wt=r-yt.ty;const Ct=(St*mt-wt*it)*vt-o,It=(wt*et-St*ft)*vt-u,Pt=Ct*Ct+It*It;St=N-yt.tx,wt=W-yt.ty;const Xt=(St*mt-wt*it)*vt-o,Ut=(wt*et-St*ft)*vt-u,Et=Math.sqrt(Xt*Xt+Ut*Ut);let Ft=e.data.length*g,Lt=0,Ht=0;t:if(xt){Ft*=d;let ee=(Pt-Et*Et-Ft*Ft)/(2*Et*Ft);ee<-1?ee=-1:ee>1&&(ee=1,h&&Et+Ft>1e-4&&(m*=(Math.sqrt(Pt)/(Et+Ft)-1)*c+1)),Ht=Math.acos(ee)*a,et=Et+Ft*ee,it=Ft*Math.sin(Ht),Lt=Math.atan2(It*et-Ct*it,Ct*et+It*it)}else{et=d*Ft,it=p*Ft;const ee=et*et,ne=it*it,se=Math.atan2(It,Ct);ft=ne*Et*Et+ee*Pt-ee*ne;const Nt=-2*ne*Et,Yt=ne-ee;if(mt=Nt*Nt-4*Yt*ft,mt>=0){let pe=Math.sqrt(mt);Nt<0&&(pe=-pe),pe=-(Nt+pe)/2;const me=pe/Yt,xe=ft/pe,he=Math.abs(me)<Math.abs(xe)?me:xe;if(he*he<=Pt){wt=Math.sqrt(Pt-he*he)*a,Lt=se-Math.atan2(wt,he),Ht=Math.atan2(wt/p,(he-Et)/d);break t}}let zt=MathUtils.PI,te=Et-et,Qt=te*te,ie=0,re=0,le=Et+et,oe=le*le,ge=0;ft=-et*Et/(ee-ne),ft>=-1&&ft<=1&&(ft=Math.acos(ft),St=et*Math.cos(ft)+Et,wt=it*Math.sin(ft),mt=St*St+wt*wt,mt<Qt&&(zt=ft,Qt=mt,te=St,ie=wt),mt>oe&&(re=ft,oe=mt,le=St,ge=wt)),Pt<=(Qt+oe)/2?(Lt=se-Math.atan2(ie*a,te),Ht=zt*a):(Lt=se-Math.atan2(ge*a,le),Ht=re*a)}const Wt=Math.atan2(k,w)*U;let Zt=t.arotation;Lt=(Lt-Wt)*MathUtils.radDeg+y-Zt,Lt>180?Lt-=360:Lt<-180&&(Lt+=360),t.updateWorldTransformWith(o,u,Zt+Lt*c,m,t.ascaleY,0,0),Zt=e.arotation,Ht=((Ht+Wt)*MathUtils.radDeg-e.ashearX)*U+v-Zt,Ht>180?Ht-=360:Ht<-180&&(Ht+=360),e.updateWorldTransformWith(w,k,Zt+Ht*c,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},IkConstraintData$1=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}},PathConstraintData$1=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}};var SpacingMode$1=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(SpacingMode$1||{});const _PathConstraint$1=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,r=t.bones.length;s<r;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof PathAttachment$1))return;const e=this.rotateMix,s=this.translateMix,r=s>0,a=e>0;if(!r&&!a)return;const h=this.data,c=h.spacingMode,o=c==SpacingMode$1.Length,u=h.rotateMode,d=u==RotateMode.Tangent,m=u==RotateMode.ChainScale,p=this.bones.length,g=d?p:p+1,_=this.bones,y=Utils.setArraySize(this.spaces,g);let v=null;const U=this.spacing;if(m||o){m&&(v=Utils.setArraySize(this.lengths,p));for(let it=0,ft=g-1;it<ft;){const mt=_[it],xt=mt.data.length;if(xt<_PathConstraint$1.epsilon)m&&(v[it]=0),y[++it]=0;else{const yt=xt*mt.matrix.a,vt=xt*mt.matrix.b,St=Math.sqrt(yt*yt+vt*vt);m&&(v[it]=St),y[++it]=(o?xt+U:U)*St/xt}}}else for(let it=1;it<g;it++)y[it]=U;const w=this.computeWorldPositions(t,g,d,h.positionMode==PositionMode.Percent,c==SpacingMode$1.Percent);let k=w[0],N=w[1],W=h.offsetRotation,et=!1;if(W==0)et=u==RotateMode.Chain;else{et=!1;const it=this.target.bone.matrix;W*=it.a*it.d-it.b*it.c>0?MathUtils.degRad:-MathUtils.degRad}for(let it=0,ft=3;it<p;it++,ft+=3){const mt=_[it],xt=mt.matrix;xt.tx+=(k-xt.tx)*s,xt.ty+=(N-xt.ty)*s;const yt=w[ft],vt=w[ft+1],St=yt-k,wt=vt-N;if(m){const Ct=v[it];if(Ct!=0){const It=(Math.sqrt(St*St+wt*wt)/Ct-1)*e+1;xt.a*=It,xt.b*=It}}if(k=yt,N=vt,a){const Ct=xt.a,It=xt.c,Pt=xt.b,Xt=xt.d;let Ut=0,Et=0,Ft=0;if(d&&(d?Ut=w[ft-1]:y[it+1]==0?Ut=w[ft+2]:Ut=Math.atan2(wt,St)),Ut-=Math.atan2(Pt,Ct),et){Et=Math.cos(Ut),Ft=Math.sin(Ut);const Lt=mt.data.length;k+=(Lt*(Et*Ct-Ft*Pt)-St)*e,N+=(Lt*(Ft*Ct+Et*Pt)-wt)*e}else Ut+=W;Ut>MathUtils.PI?Ut-=MathUtils.PI2:Ut<-MathUtils.PI&&(Ut+=MathUtils.PI2),Ut*=e,Et=Math.cos(Ut),Ft=Math.sin(Ut),xt.a=Et*Ct-Ft*Pt,xt.c=Et*It-Ft*Xt,xt.b=Ft*Ct+Et*Pt,xt.d=Ft*It+Et*Xt}mt.appliedValid=!1}}computeWorldPositions(t,e,s,r,a){const h=this.target;let c=this.position;const o=this.spaces,u=Utils.setArraySize(this.positions,e*3+2);let d=null;const m=t.closed;let p=t.worldVerticesLength,g=p/6,_=_PathConstraint$1.NONE;if(!t.constantSpeed){const Ut=t.lengths;g-=m?1:2;const Et=Ut[g];if(r&&(c*=Et),a)for(let Ft=0;Ft<e;Ft++)o[Ft]*=Et;d=Utils.setArraySize(this.world,8);for(let Ft=0,Lt=0,Ht=0;Ft<e;Ft++,Lt+=3){const Wt=o[Ft];c+=Wt;let Zt=c;if(m)Zt%=Et,Zt<0&&(Zt+=Et),Ht=0;else if(Zt<0){_!=_PathConstraint$1.BEFORE&&(_=_PathConstraint$1.BEFORE,t.computeWorldVertices(h,2,4,d,0,2)),this.addBeforePosition(Zt,d,0,u,Lt);continue}else if(Zt>Et){_!=_PathConstraint$1.AFTER&&(_=_PathConstraint$1.AFTER,t.computeWorldVertices(h,p-6,4,d,0,2)),this.addAfterPosition(Zt-Et,d,0,u,Lt);continue}for(;;Ht++){const ee=Ut[Ht];if(!(Zt>ee)){if(Ht==0)Zt/=ee;else{const ne=Ut[Ht-1];Zt=(Zt-ne)/(ee-ne)}break}}Ht!=_&&(_=Ht,m&&Ht==g?(t.computeWorldVertices(h,p-4,4,d,0,2),t.computeWorldVertices(h,0,4,d,4,2)):t.computeWorldVertices(h,Ht*6+2,8,d,0,2)),this.addCurvePosition(Zt,d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],u,Lt,s||Ft>0&&Wt==0)}return u}m?(p+=2,d=Utils.setArraySize(this.world,p),t.computeWorldVertices(h,2,p-4,d,0,2),t.computeWorldVertices(h,0,2,d,p-4,2),d[p-2]=d[0],d[p-1]=d[1]):(g--,p-=4,d=Utils.setArraySize(this.world,p),t.computeWorldVertices(h,2,p,d,0,2));const y=Utils.setArraySize(this.curves,g);let v=0,U=d[0],w=d[1],k=0,N=0,W=0,et=0,it=0,ft=0,mt=0,xt=0,yt=0,vt=0,St=0,wt=0,Ct=0,It=0;for(let Ut=0,Et=2;Ut<g;Ut++,Et+=6)k=d[Et],N=d[Et+1],W=d[Et+2],et=d[Et+3],it=d[Et+4],ft=d[Et+5],mt=(U-k*2+W)*.1875,xt=(w-N*2+et)*.1875,yt=((k-W)*3-U+it)*.09375,vt=((N-et)*3-w+ft)*.09375,St=mt*2+yt,wt=xt*2+vt,Ct=(k-U)*.75+mt+yt*.16666667,It=(N-w)*.75+xt+vt*.16666667,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St,It+=wt,St+=yt,wt+=vt,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St,It+=wt,v+=Math.sqrt(Ct*Ct+It*It),Ct+=St+yt,It+=wt+vt,v+=Math.sqrt(Ct*Ct+It*It),y[Ut]=v,U=it,w=ft;if(r&&(c*=v),a)for(let Ut=0;Ut<e;Ut++)o[Ut]*=v;const Pt=this.segments;let Xt=0;for(let Ut=0,Et=0,Ft=0,Lt=0;Ut<e;Ut++,Et+=3){const Ht=o[Ut];c+=Ht;let Wt=c;if(m)Wt%=v,Wt<0&&(Wt+=v),Ft=0;else if(Wt<0){this.addBeforePosition(Wt,d,0,u,Et);continue}else if(Wt>v){this.addAfterPosition(Wt-v,d,p-4,u,Et);continue}for(;;Ft++){const Zt=y[Ft];if(!(Wt>Zt)){if(Ft==0)Wt/=Zt;else{const ee=y[Ft-1];Wt=(Wt-ee)/(Zt-ee)}break}}if(Ft!=_){_=Ft;let Zt=Ft*6;for(U=d[Zt],w=d[Zt+1],k=d[Zt+2],N=d[Zt+3],W=d[Zt+4],et=d[Zt+5],it=d[Zt+6],ft=d[Zt+7],mt=(U-k*2+W)*.03,xt=(w-N*2+et)*.03,yt=((k-W)*3-U+it)*.006,vt=((N-et)*3-w+ft)*.006,St=mt*2+yt,wt=xt*2+vt,Ct=(k-U)*.3+mt+yt*.16666667,It=(N-w)*.3+xt+vt*.16666667,Xt=Math.sqrt(Ct*Ct+It*It),Pt[0]=Xt,Zt=1;Zt<8;Zt++)Ct+=St,It+=wt,St+=yt,wt+=vt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[Zt]=Xt;Ct+=St,It+=wt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[8]=Xt,Ct+=St+yt,It+=wt+vt,Xt+=Math.sqrt(Ct*Ct+It*It),Pt[9]=Xt,Lt=0}for(Wt*=Xt;;Lt++){const Zt=Pt[Lt];if(!(Wt>Zt)){if(Lt==0)Wt/=Zt;else{const ee=Pt[Lt-1];Wt=Lt+(Wt-ee)/(Zt-ee)}break}}this.addCurvePosition(Wt*.1,U,w,k,N,W,et,it,ft,u,Et,s||Ut>0&&Ht==0)}return u}addBeforePosition(t,e,s,r,a){const h=e[s],c=e[s+1],o=e[s+2]-h,u=e[s+3]-c,d=Math.atan2(u,o);r[a]=h+t*Math.cos(d),r[a+1]=c+t*Math.sin(d),r[a+2]=d}addAfterPosition(t,e,s,r,a){const h=e[s+2],c=e[s+3],o=h-e[s],u=c-e[s+1],d=Math.atan2(u,o);r[a]=h+t*Math.cos(d),r[a+1]=c+t*Math.sin(d),r[a+2]=d}addCurvePosition(t,e,s,r,a,h,c,o,u,d,m,p){(t==0||isNaN(t))&&(t=1e-4);const g=t*t,_=g*t,y=1-t,v=y*y,U=v*y,w=y*t,k=w*3,N=y*k,W=k*t,et=e*U+r*N+h*W+o*_,it=s*U+a*N+c*W+u*_;d[m]=et,d[m+1]=it,p&&(d[m+2]=Math.atan2(it-(s*v+a*w*2+c*g),et-(e*v+r*w*2+h*g)))}getOrder(){return this.data.order}};let PathConstraint$1=_PathConstraint$1;PathConstraint$1.NONE=-1;PathConstraint$1.BEFORE=-2;PathConstraint$1.AFTER=-3;PathConstraint$1.epsilon=1e-5;let TransformConstraint$1=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Vector2,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target,h=a.matrix,c=h.a,o=h.c,u=h.b,d=h.d,m=c*d-o*u>0?MathUtils.degRad:-MathUtils.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,_=this.bones;for(let y=0,v=_.length;y<v;y++){const U=_[y];let w=!1;const k=U.matrix;if(t!=0){const N=k.a,W=k.c,et=k.b,it=k.d;let ft=Math.atan2(u,c)-Math.atan2(et,N)+p;ft>MathUtils.PI?ft-=MathUtils.PI2:ft<-MathUtils.PI&&(ft+=MathUtils.PI2),ft*=t;const mt=Math.cos(ft),xt=Math.sin(ft);k.a=mt*N-xt*et,k.c=mt*W-xt*it,k.b=xt*N+mt*et,k.d=xt*W+mt*it,w=!0}if(e!=0){const N=this.temp;a.localToWorld(N.set(this.data.offsetX,this.data.offsetY)),k.tx+=(N.x-k.tx)*e,k.ty+=(N.y-k.ty)*e,w=!0}if(s>0){let N=Math.sqrt(k.a*k.a+k.b*k.b),W=Math.sqrt(c*c+u*u);N>1e-5&&(N=(N+(W-N+this.data.offsetScaleX)*s)/N),k.a*=N,k.b*=N,N=Math.sqrt(k.c*k.c+k.d*k.d),W=Math.sqrt(o*o+d*d),N>1e-5&&(N=(N+(W-N+this.data.offsetScaleY)*s)/N),k.c*=N,k.d*=N,w=!0}if(r>0){const N=k.c,W=k.d,et=Math.atan2(W,N);let it=Math.atan2(d,o)-Math.atan2(u,c)-(et-Math.atan2(k.b,k.a));it>MathUtils.PI?it-=MathUtils.PI2:it<-MathUtils.PI&&(it+=MathUtils.PI2),it=et+(it+g)*r;const ft=Math.sqrt(N*N+W*W);k.c=Math.cos(it)*ft,k.d=Math.sin(it)*ft,w=!0}w&&(U.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target,h=a.matrix,c=h.a,o=h.c,u=h.b,d=h.d,m=c*d-o*u>0?MathUtils.degRad:-MathUtils.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,_=this.bones;for(let y=0,v=_.length;y<v;y++){const U=_[y];let w=!1;const k=U.matrix;if(t!=0){const N=k.a,W=k.c,et=k.b,it=k.d;let ft=Math.atan2(u,c)+p;ft>MathUtils.PI?ft-=MathUtils.PI2:ft<-MathUtils.PI&&(ft+=MathUtils.PI2),ft*=t;const mt=Math.cos(ft),xt=Math.sin(ft);k.a=mt*N-xt*et,k.c=mt*W-xt*it,k.b=xt*N+mt*et,k.d=xt*W+mt*it,w=!0}if(e!=0){const N=this.temp;a.localToWorld(N.set(this.data.offsetX,this.data.offsetY)),k.tx+=N.x*e,k.ty+=N.y*e,w=!0}if(s>0){let N=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*s+1;k.a*=N,k.b*=N,N=(Math.sqrt(o*o+d*d)-1+this.data.offsetScaleY)*s+1,k.c*=N,k.d*=N,w=!0}if(r>0){let N=Math.atan2(d,o)-Math.atan2(u,c);N>MathUtils.PI?N-=MathUtils.PI2:N<-MathUtils.PI&&(N+=MathUtils.PI2);const W=k.c,et=k.d;N=Math.atan2(et,W)+(N-MathUtils.PI/2+g)*r;const it=Math.sqrt(W*W+et*et);k.c=Math.cos(N)*it,k.d=Math.sin(N)*it,w=!0}w&&(U.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();const h=this.bones;for(let c=0,o=h.length;c<o;c++){const u=h[c];u.appliedValid||u.updateAppliedTransform();let d=u.arotation;if(t!=0){let v=a.arotation-d+this.data.offsetRotation;v-=(16384-(16384.499999999996-v/360|0))*360,d+=v*t}let m=u.ax,p=u.ay;e!=0&&(m+=(a.ax-m+this.data.offsetX)*e,p+=(a.ay-p+this.data.offsetY)*e);let g=u.ascaleX,_=u.ascaleY;s>0&&(g>1e-5&&(g=(g+(a.ascaleX-g+this.data.offsetScaleX)*s)/g),_>1e-5&&(_=(_+(a.ascaleY-_+this.data.offsetScaleY)*s)/_));const y=u.ashearY;if(r>0){let v=a.ashearY-y+this.data.offsetShearY;v-=(16384-(16384.499999999996-v/360|0))*360,u.shearY+=v*r}u.updateWorldTransformWith(m,p,d,g,_,u.ashearX,y)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();const h=this.bones;for(let c=0,o=h.length;c<o;c++){const u=h[c];u.appliedValid||u.updateAppliedTransform();let d=u.arotation;t!=0&&(d+=(a.arotation+this.data.offsetRotation)*t);let m=u.ax,p=u.ay;e!=0&&(m+=(a.ax+this.data.offsetX)*e,p+=(a.ay+this.data.offsetY)*e);let g=u.ascaleX,_=u.ascaleY;s>0&&(g>1e-5&&(g*=(a.ascaleX-1+this.data.offsetScaleX)*s+1),_>1e-5&&(_*=(a.ascaleY-1+this.data.offsetScaleY)*s+1));let y=u.ashearY;r>0&&(y+=(a.ashearY+this.data.offsetShearY)*r),u.updateWorldTransformWith(m,p,d,g,_,u.ashearX,y)}}getOrder(){return this.data.order}};const _Skeleton$1=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const s=t.bones[e];let r;if(s.parent==null)r=new Bone$1(s,this,null);else{const a=this.bones[s.parent.index];r=new Bone$1(s,this,a),a.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const s=t.slots[e],r=this.bones[s.boneData.index],a=new Slot$1(s,r);this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const s=t.ikConstraints[e];this.ikConstraints.push(new IkConstraint$1(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const s=t.transformConstraints[e];this.transformConstraints.push(new TransformConstraint$1(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const s=t.pathConstraints[e];this.pathConstraints.push(new PathConstraint$1(s,this))}this.color=new Color(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let d=0,m=e.length;d<m;d++)e[d].sorted=!1;const s=this.ikConstraints,r=this.transformConstraints,a=this.pathConstraints,h=s.length,c=r.length,o=a.length,u=h+c+o;t:for(let d=0;d<u;d++){for(let m=0;m<h;m++){const p=s[m];if(p.data.order==d){this.sortIkConstraint(p);continue t}}for(let m=0;m<c;m++){const p=r[m];if(p.data.order==d){this.sortTransformConstraint(p);continue t}}for(let m=0;m<o;m++){const p=a[m];if(p.data.order==d){this.sortPathConstraint(p);continue t}}}for(let d=0,m=e.length;d<m;d++)this.sortBone(e[d])}sortIkConstraint(t){const e=t.target;this.sortBone(e);const s=t.bones,r=s[0];if(this.sortBone(r),s.length>1){const a=s[s.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(t),this.sortReset(r.children),s[s.length-1].sorted=!0}sortPathConstraint(t){const e=t.target,s=e.data.index,r=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,s,r),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,r);for(let o=0,u=this.data.skins.length;o<u;o++)this.sortPathConstraintAttachment(this.data.skins[o],s,r);const a=e.getAttachment();a instanceof PathAttachment$1&&this.sortPathConstraintAttachmentWith(a,r);const h=t.bones,c=h.length;for(let o=0;o<c;o++)this.sortBone(h[o]);this._updateCache.push(t);for(let o=0;o<c;o++)this.sortReset(h[o].children);for(let o=0;o<c;o++)h[o].sorted=!0}sortTransformConstraint(t){this.sortBone(t.target);const e=t.bones,s=e.length;if(t.data.local)for(let r=0;r<s;r++){const a=e[r];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(let r=0;r<s;r++)this.sortBone(e[r]);this._updateCache.push(t);for(let r=0;r<s;r++)this.sortReset(e[r].children);for(let r=0;r<s;r++)e[r].sorted=!0}sortPathConstraintAttachment(t,e,s){const r=t.attachments[e];if(r)for(const a in r)this.sortPathConstraintAttachmentWith(r[a],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof PathAttachment$1))return;const s=t.bones;if(s==null)this.sortBone(e);else{const r=this.bones;let a=0;for(;a<s.length;){const h=s[a++];for(let c=a+h;a<c;a++){const o=s[a];this.sortBone(r[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){const r=t[e];r.sorted&&this.sortReset(r.children),r.sorted=!1}}updateWorldTransform(){const t=this.updateCacheReset;for(let s=0,r=t.length;s<r;s++){const a=t[s];a.ax=a.x,a.ay=a.y,a.arotation=a.rotation,a.ascaleX=a.scaleX,a.ascaleY=a.scaleY,a.ashearX=a.shearX,a.ashearY=a.shearY,a.appliedValid=!0}const e=this._updateCache;for(let s=0,r=e.length;s<r;s++)e[s].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let a=0,h=t.length;a<h;a++)t[a].setToSetupPose();const e=this.ikConstraints;for(let a=0,h=e.length;a<h;a++){const c=e[a];c.bendDirection=c.data.bendDirection,c.mix=c.data.mix}const s=this.transformConstraints;for(let a=0,h=s.length;a<h;a++){const c=s[a],o=c.data;c.rotateMix=o.rotateMix,c.translateMix=o.translateMix,c.scaleMix=o.scaleMix,c.shearMix=o.shearMix}const r=this.pathConstraints;for(let a=0,h=r.length;a<h;a++){const c=r[a],o=c.data;c.position=o.position,c.spacing=o.spacing,c.rotateMix=o.rotateMix,c.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s],h=a.data.attachmentName;if(h!=null){const c=t.getAttachment(s,h);c!=null&&a.setAttachment(c)}}}this.skin=t}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const s=this.skin.getAttachment(t,e);if(s!=null)return s}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const s=this.slots;for(let r=0,a=s.length;r<a;r++){const h=s[r];if(h.data.name==t){let c=null;if(e!=null&&(c=this.getAttachment(r,e),c==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);h.setAttachment(c);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==t)return a}return null}getBounds(t,e,s){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const r=this.drawOrder;let a=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let u=0,d=r.length;u<d;u++){const m=r[u];let p=0,g=null;const _=m.getAttachment();if(_ instanceof RegionAttachment$1)p=8,g=Utils.setArraySize(s,p,0),_.computeWorldVertices(m.bone,g,0,2);else if(_ instanceof MeshAttachment$1){const y=_;p=y.worldVerticesLength,g=Utils.setArraySize(s,p,0),y.computeWorldVertices(m,0,p,g,0,2)}if(g!=null)for(let y=0,v=g.length;y<v;y+=2){const U=g[y],w=g[y+1];a=Math.min(a,U),h=Math.min(h,w),c=Math.max(c,U),o=Math.max(o,w)}}t.set(a,h),e.set(c-a,o-h)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){_Skeleton$1.deprecatedWarning1||(_Skeleton$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){_Skeleton$1.deprecatedWarning1||(_Skeleton$1.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let Skeleton$1=_Skeleton$1;Skeleton$1.deprecatedWarning1=!1;let SkeletonBounds$1=class extends SkeletonBoundsBase{},SkeletonData$1=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}},SlotData$1=class{constructor(t,e,s){if(this.color=new Color(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}},TransformConstraintData$1=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}},Skin$1=class{constructor(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const a=t.slots[r],h=a.getAttachment();if(h&&s<e.attachments.length){const c=e.attachments[s];for(const o in c){const u=c[o];if(h==u){const d=this.getAttachment(s,o);d!=null&&a.setAttachment(d);break}}}s++}}},SkeletonJson$1=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new SkeletonData$1,r=typeof t=="string"?JSON.parse(t):t,a=r.skeleton;if(a!=null&&(s.hash=a.hash,s.version=a.spine,s.width=a.width,s.height=a.height,s.fps=a.fps,s.imagesPath=a.images),r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let o=null;const u=this.getValue(c,"parent",null);if(u!=null&&(o=s.findBone(u),o==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData$1(s.bones.length,c.name,o);d.length=this.getValue(c,"length",0)*e,d.x=this.getValue(c,"x",0)*e,d.y=this.getValue(c,"y",0)*e,d.rotation=this.getValue(c,"rotation",0),d.scaleX=this.getValue(c,"scaleX",1),d.scaleY=this.getValue(c,"scaleY",1),d.shearX=this.getValue(c,"shearX",0),d.shearY=this.getValue(c,"shearY",0),d.transformMode=SkeletonJson$1.transformModeFromString(this.getValue(c,"transform","normal")),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],o=c.name,u=c.bone,d=s.findBone(u);if(d==null)throw new Error(`Slot bone not found: ${u}`);const m=new SlotData$1(s.slots.length,o,d),p=this.getValue(c,"color",null);p!=null&&m.color.setFromString(p);const g=this.getValue(c,"dark",null);g!=null&&(m.darkColor=new Color(1,1,1,1),m.darkColor.setFromString(g)),m.attachmentName=this.getValue(c,"attachment",null),m.blendMode=SkeletonJson$1.blendModeFromString(this.getValue(c,"blend","normal")),s.slots.push(m)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],o=new IkConstraintData$1(c.name);o.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`IK bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findBone(u),o.target==null)throw new Error(`IK target bone not found: ${u}`);o.bendDirection=this.getValue(c,"bendPositive",!0)?1:-1,o.mix=this.getValue(c,"mix",1),s.ikConstraints.push(o)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],o=new TransformConstraintData$1(c.name);o.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`Transform constraint bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findBone(u),o.target==null)throw new Error(`Transform constraint target bone not found: ${u}`);o.local=this.getValue(c,"local",!1),o.relative=this.getValue(c,"relative",!1),o.offsetRotation=this.getValue(c,"rotation",0),o.offsetX=this.getValue(c,"x",0)*e,o.offsetY=this.getValue(c,"y",0)*e,o.offsetScaleX=this.getValue(c,"scaleX",0),o.offsetScaleY=this.getValue(c,"scaleY",0),o.offsetShearY=this.getValue(c,"shearY",0),o.rotateMix=this.getValue(c,"rotateMix",1),o.translateMix=this.getValue(c,"translateMix",1),o.scaleMix=this.getValue(c,"scaleMix",1),o.shearMix=this.getValue(c,"shearMix",1),s.transformConstraints.push(o)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],o=new PathConstraintData$1(c.name);o.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const m=c.bones[d],p=s.findBone(m);if(p==null)throw new Error(`Transform constraint bone not found: ${m}`);o.bones.push(p)}const u=c.target;if(o.target=s.findSlot(u),o.target==null)throw new Error(`Path target slot not found: ${u}`);o.positionMode=SkeletonJson$1.positionModeFromString(this.getValue(c,"positionMode","percent")),o.spacingMode=SkeletonJson$1.spacingModeFromString(this.getValue(c,"spacingMode","length")),o.rotateMode=SkeletonJson$1.rotateModeFromString(this.getValue(c,"rotateMode","tangent")),o.offsetRotation=this.getValue(c,"rotation",0),o.position=this.getValue(c,"position",0),o.positionMode==PositionMode.Fixed&&(o.position*=e),o.spacing=this.getValue(c,"spacing",0),(o.spacingMode==SpacingMode$1.Length||o.spacingMode==SpacingMode$1.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(c,"rotateMix",1),o.translateMix=this.getValue(c,"translateMix",1),s.pathConstraints.push(o)}if(r.skins)for(const h in r.skins){const c=r.skins[h],o=new Skin$1(h);for(const u in c){const d=s.findSlotIndex(u);if(d==-1)throw new Error(`Slot not found: ${u}`);const m=c[u];for(const p in m){const g=this.readAttachment(m[p],o,d,p,s);g!=null&&o.addAttachment(d,p,g)}}s.skins.push(o),o.name=="default"&&(s.defaultSkin=o)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const o=this.linkedMeshes[h],u=o.skin==null?s.defaultSkin:s.findSkin(o.skin);if(u==null)throw new Error(`Skin not found: ${o.skin}`);const d=u.getAttachment(o.slotIndex,o.parent);if(d==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],o=new EventData$1(h);o.intValue=this.getValue(c,"int",0),o.floatValue=this.getValue(c,"float",0),o.stringValue=this.getValue(c,"string",""),o.audioPath=this.getValue(c,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(c,"volume",1),o.balance=this.getValue(c,"balance",0)),s.events.push(o)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(t,e,s,r,a){const h=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",r),u=this.attachmentLoader.newRegionAttachment(e,r,o);if(u==null)return null;u.path=o,u.x=this.getValue(t,"x",0)*h,u.y=this.getValue(t,"y",0)*h,u.scaleX=this.getValue(t,"scaleX",1),u.scaleY=this.getValue(t,"scaleY",1),u.rotation=this.getValue(t,"rotation",0),u.width=t.width*h,u.height=t.height*h;const d=this.getValue(t,"color",null);return d!=null&&u.color.setFromString(d),u}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",r),u=this.attachmentLoader.newMeshAttachment(e,r,o);if(u==null)return null;u.path=o;const d=this.getValue(t,"color",null);d!=null&&u.color.setFromString(d);const m=this.getValue(t,"parent",null);if(m!=null)return u.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new LinkedMesh$2(u,this.getValue(t,"skin",null),s,m)),u;const p=t.uvs;return this.readVertices(t,u,p.length),u.triangles=t.triangles,u.regionUVs=new Float32Array(p),u.hullLength=this.getValue(t,"hull",0)*2,u}case"path":{const o=this.attachmentLoader.newPathAttachment(e,r);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const u=t.vertexCount;this.readVertices(t,o,u<<1);const d=Utils.newArray(u/3,0);for(let p=0;p<t.lengths.length;p++)d[p]=t.lengths[p]*h;o.lengths=d;const m=this.getValue(t,"color",null);return m!=null&&o.color.setFromString(m),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,r);if(o==null)return null;o.x=this.getValue(t,"x",0)*h,o.y=this.getValue(t,"y",0)*h,o.rotation=this.getValue(t,"rotation",0);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,r);if(o==null)return null;const u=this.getValue(t,"end",null);if(u!=null){const p=a.findSlot(u);if(p==null)throw new Error(`Clipping end slot not found: ${u}`);o.endSlot=p}const d=t.vertexCount;this.readVertices(t,o,d<<1);const m=this.getValue(t,"color",null);return m!=null&&o.color.setFromString(m),o}}return null}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const a=t.vertices;if(s==a.length){const o=Utils.toFloatArray(a);if(r!=1)for(let u=0,d=a.length;u<d;u++)o[u]*=r;e.vertices=o;return}const h=new Array,c=new Array;for(let o=0,u=a.length;o<u;){const d=a[o++];c.push(d);for(let m=o+d*4;o<m;o+=4)c.push(a[o]),h.push(a[o+1]*r),h.push(a[o+2]*r),h.push(a[o+3])}e.bones=c,e.vertices=Utils.toFloatArray(h)}readAnimation(t,e,s){const r=this.scale,a=new Array;let h=0;if(t.slots)for(const o in t.slots){const u=t.slots[o],d=s.findSlotIndex(o);if(d==-1)throw new Error(`Slot not found: ${o}`);for(const m in u){const p=u[m];if(m=="attachment"){const g=new AttachmentTimeline$1(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y];g.setFrame(_++,v.time,v.name)}a.push(g),h=Math.max(h,g.frames[g.getFrameCount()-1])}else if(m=="color"){const g=new ColorTimeline(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y],U=new Color;U.setFromString(v.color||"ffffffff"),g.setFrame(_,v.time,U.r,U.g,U.b,U.a),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*ColorTimeline.ENTRIES])}else if(m=="twoColor"){const g=new TwoColorTimeline(p.length);g.slotIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y],U=new Color,w=new Color;U.setFromString(v.light),w.setFromString(v.dark),g.setFrame(_,v.time,U.r,U.g,U.b,U.a,w.r,w.g,w.b),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TwoColorTimeline.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${m} (${o})`)}}if(t.bones)for(const o in t.bones){const u=t.bones[o],d=s.findBoneIndex(o);if(d==-1)throw new Error(`Bone not found: ${o}`);for(const m in u){const p=u[m];if(m==="rotate"){const g=new RotateTimeline$1(p.length);g.boneIndex=d;let _=0;for(let y=0;y<p.length;y++){const v=p[y];g.setFrame(_,v.time,v.angle),this.readCurve(v,g,_),_++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*RotateTimeline$1.ENTRIES])}else if(m==="translate"||m==="scale"||m==="shear"){let g=null,_=1;m==="scale"?g=new ScaleTimeline$1(p.length):m==="shear"?g=new ShearTimeline$1(p.length):(g=new TranslateTimeline$1(p.length),_=r),g.boneIndex=d;let y=0;for(let v=0;v<p.length;v++){const U=p[v],w=this.getValue(U,"x",0),k=this.getValue(U,"y",0);g.setFrame(y,U.time,w*_,k*_),this.readCurve(U,g,y),y++}a.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TranslateTimeline$1.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${m} (${o})`)}}if(t.ik)for(const o in t.ik){const u=t.ik[o],d=s.findIkConstraint(o),m=new IkConstraintTimeline$1(u.length);m.ikConstraintIndex=s.ikConstraints.indexOf(d);let p=0;for(let g=0;g<u.length;g++){const _=u[g];m.setFrame(p,_.time,this.getValue(_,"mix",1),this.getValue(_,"bendPositive",!0)?1:-1,this.getValue(_,"compress",!1),this.getValue(_,"stretch",!1)),this.readCurve(_,m,p),p++}a.push(m),h=Math.max(h,m.frames[(m.getFrameCount()-1)*IkConstraintTimeline$1.ENTRIES])}if(t.transform)for(const o in t.transform){const u=t.transform[o],d=s.findTransformConstraint(o),m=new TransformConstraintTimeline$1(u.length);m.transformConstraintIndex=s.transformConstraints.indexOf(d);let p=0;for(let g=0;g<u.length;g++){const _=u[g];m.setFrame(p,_.time,this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1),this.getValue(_,"scaleMix",1),this.getValue(_,"shearMix",1)),this.readCurve(_,m,p),p++}a.push(m),h=Math.max(h,m.frames[(m.getFrameCount()-1)*TransformConstraintTimeline$1.ENTRIES])}if(t.paths)for(const o in t.paths){const u=t.paths[o],d=s.findPathConstraintIndex(o);if(d==-1)throw new Error(`Path constraint not found: ${o}`);const m=s.pathConstraints[d];for(const p in u){const g=u[p];if(p==="position"||p==="spacing"){let _=null,y=1;p==="spacing"?(_=new PathConstraintSpacingTimeline$1(g.length),(m.spacingMode==SpacingMode$1.Length||m.spacingMode==SpacingMode$1.Fixed)&&(y=r)):(_=new PathConstraintPositionTimeline$1(g.length),m.positionMode==PositionMode.Fixed&&(y=r)),_.pathConstraintIndex=d;let v=0;for(let U=0;U<g.length;U++){const w=g[U];_.setFrame(v,w.time,this.getValue(w,p,0)*y),this.readCurve(w,_,v),v++}a.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintPositionTimeline$1.ENTRIES])}else if(p==="mix"){const _=new PathConstraintMixTimeline$1(g.length);_.pathConstraintIndex=d;let y=0;for(let v=0;v<g.length;v++){const U=g[v];_.setFrame(y,U.time,this.getValue(U,"rotateMix",1),this.getValue(U,"translateMix",1)),this.readCurve(U,_,y),y++}a.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintMixTimeline$1.ENTRIES])}}}if(t.deform)for(const o in t.deform){const u=t.deform[o],d=s.findSkin(o);if(d!=null)for(const m in u){const p=u[m],g=s.findSlotIndex(m);if(g==-1)throw new Error(`Slot not found: ${p.name}`);for(const _ in p){const y=p[_],v=d.getAttachment(g,_);if(v==null)throw new Error(`Deform attachment not found: ${y.name}`);const U=v.bones!=null,w=v.vertices,k=U?w.length/3*2:w.length,N=new DeformTimeline$1(y.length);N.slotIndex=g,N.attachment=v;let W=0;for(let et=0;et<y.length;et++){const it=y[et];let ft;const mt=this.getValue(it,"vertices",null);if(mt==null)ft=U?Utils.newFloatArray(k):w;else{ft=Utils.newFloatArray(k);const xt=this.getValue(it,"offset",0);if(Utils.arrayCopy(mt,0,ft,xt,mt.length),r!=1)for(let yt=xt,vt=yt+mt.length;yt<vt;yt++)ft[yt]*=r;if(!U)for(let yt=0;yt<k;yt++)ft[yt]+=w[yt]}N.setFrame(W,it.time,ft),this.readCurve(it,N,W),W++}a.push(N),h=Math.max(h,N.frames[N.getFrameCount()-1])}}}let c=t.drawOrder;if(c==null&&(c=t.draworder),c!=null){const o=new DrawOrderTimeline$1(c.length),u=s.slots.length;let d=0;for(let m=0;m<c.length;m++){const p=c[m];let g=null;const _=this.getValue(p,"offsets",null);if(_!=null){g=Utils.newArray(u,-1);const y=Utils.newArray(u-_.length,0);let v=0,U=0;for(let w=0;w<_.length;w++){const k=_[w],N=s.findSlotIndex(k.slot);if(N==-1)throw new Error(`Slot not found: ${k.slot}`);for(;v!=N;)y[U++]=v++;g[v+k.offset]=v++}for(;v<u;)y[U++]=v++;for(let w=u-1;w>=0;w--)g[w]==-1&&(g[w]=y[--U])}o.setFrame(d++,p.time,g)}a.push(o),h=Math.max(h,o.frames[o.getFrameCount()-1])}if(t.events){const o=new EventTimeline$1(t.events.length);let u=0;for(let d=0;d<t.events.length;d++){const m=t.events[d],p=s.findEvent(m.name);if(p==null)throw new Error(`Event not found: ${m.name}`);const g=new Event$2(Utils.toSinglePrecision(m.time),p);g.intValue=this.getValue(m,"int",p.intValue),g.floatValue=this.getValue(m,"float",p.floatValue),g.stringValue=this.getValue(m,"string",p.stringValue),g.data.audioPath!=null&&(g.volume=this.getValue(m,"volume",1),g.balance=this.getValue(m,"balance",0)),o.setFrame(u++,g)}a.push(o),h=Math.max(h,o.frames[o.getFrameCount()-1])}if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$3(e,a,h))}readCurve(t,e,s){if(t.curve){if(t.curve==="stepped")e.setStepped(s);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){const r=t.curve;e.setCurve(s,r[0],r[1],r[2],r[3])}}}getValue(t,e,s){return t[e]!==void 0?t[e]:s}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return BLEND_MODES.NORMAL;if(t=="additive")return BLEND_MODES.ADD;if(t=="multiply")return BLEND_MODES.MULTIPLY;if(t=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return PositionMode.Fixed;if(t=="percent")return PositionMode.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return SpacingMode$1.Length;if(t=="fixed")return SpacingMode$1.Fixed;if(t=="percent")return SpacingMode$1.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return RotateMode.Tangent;if(t=="chain")return RotateMode.Chain;if(t=="chainscale")return RotateMode.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return TransformMode.Normal;if(t=="onlytranslation")return TransformMode.OnlyTranslation;if(t=="norotationorreflection")return TransformMode.NoRotationOrReflection;if(t=="noscale")return TransformMode.NoScale;if(t=="noscaleorreflection")return TransformMode.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},LinkedMesh$2=class{constructor(t,e,s,r){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r}},Spine$2=class extends SpineBase{createSkeleton(t){this.skeleton=new Skeleton$1(t),this.skeleton.updateWorldTransform(),this.stateData=new AnimationStateData$1(t),this.state=new AnimationState$1(this.stateData)}};const spine37=Object.freeze(Object.defineProperty({__proto__:null,Animation:Animation$3,AnimationState:AnimationState$1,AnimationStateAdapter2,AnimationStateData:AnimationStateData$1,AtlasAttachmentLoader:AtlasAttachmentLoader$1,Attachment:Attachment$1,AttachmentTimeline:AttachmentTimeline$1,Bone:Bone$1,BoneData:BoneData$1,BoundingBoxAttachment:BoundingBoxAttachment$1,ClippingAttachment:ClippingAttachment$1,ColorTimeline,CurveTimeline:CurveTimeline$1,DeformTimeline:DeformTimeline$1,DrawOrderTimeline:DrawOrderTimeline$1,Event:Event$2,EventData:EventData$1,EventQueue:EventQueue$1,EventTimeline:EventTimeline$1,EventType:EventType$1,IkConstraint:IkConstraint$1,IkConstraintData:IkConstraintData$1,IkConstraintTimeline:IkConstraintTimeline$1,JitterEffect,MeshAttachment:MeshAttachment$1,PathAttachment:PathAttachment$1,PathConstraint:PathConstraint$1,PathConstraintData:PathConstraintData$1,PathConstraintMixTimeline:PathConstraintMixTimeline$1,PathConstraintPositionTimeline:PathConstraintPositionTimeline$1,PathConstraintSpacingTimeline:PathConstraintSpacingTimeline$1,PointAttachment:PointAttachment$1,RegionAttachment:RegionAttachment$1,RotateTimeline:RotateTimeline$1,ScaleTimeline:ScaleTimeline$1,ShearTimeline:ShearTimeline$1,Skeleton:Skeleton$1,SkeletonBounds:SkeletonBounds$1,SkeletonData:SkeletonData$1,SkeletonJson:SkeletonJson$1,Skin:Skin$1,Slot:Slot$1,SlotData:SlotData$1,SpacingMode:SpacingMode$1,Spine:Spine$2,SwirlEffect,TimelineType,TrackEntry:TrackEntry$1,TransformConstraint:TransformConstraint$1,TransformConstraintData:TransformConstraintData$1,TransformConstraintTimeline:TransformConstraintTimeline$1,TranslateTimeline:TranslateTimeline$1,TwoColorTimeline,VertexAttachment:VertexAttachment$1},Symbol.toStringTag,{value:"Module"}));class Attachment{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const _VertexAttachment=class extends Attachment{constructor(n){super(n),this.id=_VertexAttachment.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(n,t){this.computeWorldVertices(n,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(n,t,e,s,r,a){e=r+(e>>1)*a;const h=n.bone.skeleton,c=n.deform;let o=this.vertices;const u=this.bones;if(!u){c.length>0&&(o=c);const g=n.bone.matrix,_=g.tx,y=g.ty,v=g.a,U=g.c,w=g.b,k=g.d;for(let N=t,W=r;W<e;N+=2,W+=a){const et=o[N],it=o[N+1];s[W]=et*v+it*U+_,s[W+1]=et*w+it*k+y}return}let d=0,m=0;for(let g=0;g<t;g+=2){const _=u[d];d+=_+1,m+=_}const p=h.bones;if(c.length==0)for(let g=r,_=m*3;g<e;g+=a){let y=0,v=0,U=u[d++];for(U+=d;d<U;d++,_+=3){const w=p[u[d]].matrix,k=o[_],N=o[_+1],W=o[_+2];y+=(k*w.a+N*w.c+w.tx)*W,v+=(k*w.b+N*w.d+w.ty)*W}s[g]=y,s[g+1]=v}else{const g=c;for(let _=r,y=m*3,v=m<<1;_<e;_+=a){let U=0,w=0,k=u[d++];for(k+=d;d<k;d++,y+=3,v+=2){const N=p[u[d]].matrix,W=o[y]+g[v],et=o[y+1]+g[v+1],it=o[y+2];U+=(W*N.a+et*N.c+N.tx)*it,w+=(W*N.b+et*N.d+N.ty)*it}s[_]=U,s[_+1]=w}}}copyTo(n){this.bones?(n.bones=new Array(this.bones.length),Utils.arrayCopy(this.bones,0,n.bones,0,this.bones.length)):n.bones=null,this.vertices&&(n.vertices=Utils.newFloatArray(this.vertices.length),Utils.arrayCopy(this.vertices,0,n.vertices,0,this.vertices.length)),n.worldVerticesLength=this.worldVerticesLength,n.timelineAttachment=this.timelineAttachment}};let VertexAttachment=_VertexAttachment;VertexAttachment.nextID=0;class BoundingBoxAttachment extends VertexAttachment{constructor(t){super(t),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}copy(){const t=new BoundingBoxAttachment(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class ClippingAttachment extends VertexAttachment{constructor(t){super(t),this.type=AttachmentType.Clipping,this.endSlot=null,this.color=new Color(.2275,.2275,.8078,1)}copy(){const t=new ClippingAttachment(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class MeshAttachment extends VertexAttachment{constructor(t,e){super(t),this.type=AttachmentType.Mesh,this.region=null,this.triangles=[],this.color=new Color(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new Color(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new MeshAttachment(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),Utils.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),Utils.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),Utils.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,s,r,a,h){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,s,r,a,h)}newLinkedMesh(){const t=new MeshAttachment(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class PathAttachment extends VertexAttachment{constructor(t){super(t),this.type=AttachmentType.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}copy(){const t=new PathAttachment(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),Utils.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class PointAttachment extends VertexAttachment{constructor(t){super(t),this.type=AttachmentType.Point,this.x=0,this.y=0,this.rotation=0,this.color=new Color(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),a=s*e.a+r*e.c,h=s*e.b+r*e.d;return Math.atan2(h,a)*MathUtils.radDeg}copy(){const t=new PointAttachment(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const _RegionAttachment=class extends Attachment{constructor(n,t){super(n),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");const n=this.region,t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,a=s+this.region.width*t,h=r+this.region.height*e,c=this.rotation*Math.PI/180,o=Math.cos(c),u=Math.sin(c),d=this.x,m=this.y,p=s*o+d,g=s*u,_=r*o+m,y=r*u,v=a*o+d,U=a*u,w=h*o+m,k=h*u,N=this.offset;N[0]=p-y,N[1]=_+g,N[2]=p-k,N[3]=w+g,N[4]=v-k,N[5]=w+U,N[6]=v-y,N[7]=_+U;const W=this.uvs;n.degrees==90?(W[2]=n.u,W[3]=n.v2,W[4]=n.u,W[5]=n.v,W[6]=n.u2,W[7]=n.v,W[0]=n.u2,W[1]=n.v2):(W[0]=n.u,W[1]=n.v2,W[2]=n.u,W[3]=n.v,W[4]=n.u2,W[5]=n.v,W[6]=n.u2,W[7]=n.v2)}computeWorldVertices(n,t,e,s){this.sequence!=null&&this.sequence.apply(n,this);const r=n.bone,a=this.offset,h=r.matrix,c=h.tx,o=h.ty,u=h.a,d=h.c,m=h.b,p=h.d;let g=0,_=0;g=a[0],_=a[1],t[e]=g*u+_*d+c,t[e+1]=g*m+_*p+o,e+=s,g=a[2],_=a[3],t[e]=g*u+_*d+c,t[e+1]=g*m+_*p+o,e+=s,g=a[4],_=a[5],t[e]=g*u+_*d+c,t[e+1]=g*m+_*p+o,e+=s,g=a[6],_=a[7],t[e]=g*u+_*d+c,t[e+1]=g*m+_*p+o}copy(){const n=new _RegionAttachment(this.name,this.path);return n.region=this.region,n.rendererObject=this.rendererObject,n.x=this.x,n.y=this.y,n.scaleX=this.scaleX,n.scaleY=this.scaleY,n.rotation=this.rotation,n.width=this.width,n.height=this.height,Utils.arrayCopy(this.uvs,0,n.uvs,0,8),Utils.arrayCopy(this.offset,0,n.offset,0,8),n.color.setFromColor(this.color),n.sequence=this.sequence!=null?this.sequence.copy():null,n}};let RegionAttachment=_RegionAttachment;RegionAttachment.X1=0;RegionAttachment.Y1=1;RegionAttachment.C1R=2;RegionAttachment.C1G=3;RegionAttachment.C1B=4;RegionAttachment.C1A=5;RegionAttachment.U1=6;RegionAttachment.V1=7;RegionAttachment.X2=8;RegionAttachment.Y2=9;RegionAttachment.C2R=10;RegionAttachment.C2G=11;RegionAttachment.C2B=12;RegionAttachment.C2A=13;RegionAttachment.U2=14;RegionAttachment.V2=15;RegionAttachment.X3=16;RegionAttachment.Y3=17;RegionAttachment.C3R=18;RegionAttachment.C3G=19;RegionAttachment.C3B=20;RegionAttachment.C3A=21;RegionAttachment.U3=22;RegionAttachment.V3=23;RegionAttachment.X4=24;RegionAttachment.Y4=25;RegionAttachment.C4R=26;RegionAttachment.C4G=27;RegionAttachment.C4B=28;RegionAttachment.C4A=29;RegionAttachment.U4=30;RegionAttachment.V4=31;const _Sequence=class{constructor(n){this.id=_Sequence.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(n)}copy(){const n=new _Sequence(this.regions.length);return Utils.arrayCopy(this.regions,0,n.regions,0,this.regions.length),n.start=this.start,n.digits=this.digits,n.setupIndex=this.setupIndex,n}apply(n,t){let e=n.sequenceIndex;e==-1&&(e=this.setupIndex),e>=this.regions.length&&(e=this.regions.length-1);const s=this.regions[e];t.region!=s&&(t.region=s)}getPath(n,t){let e=n;const s=(this.start+t).toString();for(let r=this.digits-s.length;r>0;r--)e+="0";return e+=s,e}static nextID(){return _Sequence._nextID++}};let Sequence$1=_Sequence;Sequence$1._nextID=0;var SequenceMode=(n=>(n[n.hold=0]="hold",n[n.once=1]="once",n[n.loop=2]="loop",n[n.pingpong=3]="pingpong",n[n.onceReverse=4]="onceReverse",n[n.loopReverse=5]="loopReverse",n[n.pingpongReverse=6]="pingpongReverse",n))(SequenceMode||{});const SequenceModeValues=[0,1,2,3,4,5,6];let Animation$2=class{constructor(t,e,s){if(this.timelines=[],this.timelineIds=new StringSet,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,s,r,a,h,c,o){if(!t)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const u=this.timelines;for(let d=0,m=u.length;d<m;d++)u[d].apply(t,e,s,a,h,c,o)}};const Property={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};let Timeline$1=class{constructor(t,e){this.propertyIds=e,this.frames=Utils.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const s=t.length;for(let r=1;r<s;r++)if(t[r]>e)return r-1;return s-1}static search(t,e,s){const r=t.length;for(let a=s;a<r;a+=s)if(t[a]>e)return a-s;return r-s}};class CurveTimeline extends Timeline$1{constructor(t,e,s){super(t,s),this.curves=Utils.newFloatArray(t+e*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+t*18;if(this.curves.length>e){const s=Utils.newFloatArray(e);Utils.arrayCopy(this.curves,0,s,0,e),this.curves=s}}setBezier(t,e,s,r,a,h,c,o,u,d,m){const p=this.curves;let g=this.getFrameCount()+t*18;s==0&&(p[e]=2+g);const _=(r-h*2+o)*.03,y=(a-c*2+u)*.03,v=((h-o)*3-r+d)*.006,U=((c-u)*3-a+m)*.006;let w=_*2+v,k=y*2+U,N=(h-r)*.3+_+v*.16666667,W=(c-a)*.3+y+U*.16666667,et=r+N,it=a+W;for(let ft=g+18;g<ft;g+=2)p[g]=et,p[g+1]=it,N+=w,W+=k,w+=v,k+=U,et+=N,it+=W}getBezierValue(t,e,s,r){const a=this.curves;if(a[r]>t){const u=this.frames[e],d=this.frames[e+s];return d+(t-u)/(a[r]-u)*(a[r+1]-d)}const h=r+18;for(r+=2;r<h;r+=2)if(a[r]>=t){const u=a[r-2],d=a[r-1];return d+(t-u)/(a[r]-u)*(a[r+1]-d)}e+=this.getFrameEntries();const c=a[h-2],o=a[h-1];return o+(t-c)/(this.frames[e]-c)*(this.frames[e+s]-o)}}class CurveTimeline1 extends CurveTimeline{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+1]=s}getCurveValue(t){const e=this.frames;let s=e.length-2;for(let a=2;a<=s;a+=2)if(e[a]>t){s=a-2;break}const r=this.curves[s>>1];switch(r){case 0:const a=e[s],h=e[s+1];return h+(t-a)/(e[s+2]-a)*(e[s+2+1]-h);case 1:return e[s+1]}return this.getBezierValue(t,s,1,r-2)}}class CurveTimeline2 extends CurveTimeline{constructor(t,e,s,r){super(t,e,[s,r])}getFrameEntries(){return 3}setFrame(t,e,s,r){t*=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r}}class RotateTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.rotate}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.rotation=o.data.rotation;return;case MixBlend.first:o.rotation+=(o.data.rotation-o.rotation)*a}return}let d=this.getCurveValue(s);switch(h){case MixBlend.setup:o.rotation=o.data.rotation+d*a;break;case MixBlend.first:case MixBlend.replace:d+=o.data.rotation-o.rotation;case MixBlend.add:o.rotation+=d*a}}}class TranslateTimeline extends CurveTimeline2{constructor(t,e,s){super(t,e,`${Property.x}|${s}`,`${Property.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.x=o.data.x,o.y=o.data.y;return;case MixBlend.first:o.x+=(o.data.x-o.x)*a,o.y+=(o.data.y-o.y)*a}return}let d=0,m=0;const p=Timeline$1.search(u,s,3),g=this.curves[p/3];switch(g){case 0:const _=u[p];d=u[p+1],m=u[p+2];const y=(s-_)/(u[p+3]-_);d+=(u[p+3+1]-d)*y,m+=(u[p+3+2]-m)*y;break;case 1:d=u[p+1],m=u[p+2];break;default:d=this.getBezierValue(s,p,1,g-2),m=this.getBezierValue(s,p,2,g+18-2)}switch(h){case MixBlend.setup:o.x=o.data.x+d*a,o.y=o.data.y+m*a;break;case MixBlend.first:case MixBlend.replace:o.x+=(o.data.x+d-o.x)*a,o.y+=(o.data.y+m-o.y)*a;break;case MixBlend.add:o.x+=d*a,o.y+=m*a}}}class TranslateXTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.x}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.x=o.data.x;return;case MixBlend.first:o.x+=(o.data.x-o.x)*a}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:o.x=o.data.x+d*a;break;case MixBlend.first:case MixBlend.replace:o.x+=(o.data.x+d-o.x)*a;break;case MixBlend.add:o.x+=d*a}}}class TranslateYTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.y=o.data.y;return;case MixBlend.first:o.y+=(o.data.y-o.y)*a}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:o.y=o.data.y+d*a;break;case MixBlend.first:case MixBlend.replace:o.y+=(o.data.y+d-o.y)*a;break;case MixBlend.add:o.y+=d*a}}}class ScaleTimeline extends CurveTimeline2{constructor(t,e,s){super(t,e,`${Property.scaleX}|${s}`,`${Property.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.scaleX=o.data.scaleX,o.scaleY=o.data.scaleY;return;case MixBlend.first:o.scaleX+=(o.data.scaleX-o.scaleX)*a,o.scaleY+=(o.data.scaleY-o.scaleY)*a}return}let d,m;const p=Timeline$1.search(u,s,3),g=this.curves[p/3];switch(g){case 0:const _=u[p];d=u[p+1],m=u[p+2];const y=(s-_)/(u[p+3]-_);d+=(u[p+3+1]-d)*y,m+=(u[p+3+2]-m)*y;break;case 1:d=u[p+1],m=u[p+2];break;default:d=this.getBezierValue(s,p,1,g-2),m=this.getBezierValue(s,p,2,g+18-2)}if(d*=o.data.scaleX,m*=o.data.scaleY,a==1)h==MixBlend.add?(o.scaleX+=d-o.data.scaleX,o.scaleY+=m-o.data.scaleY):(o.scaleX=d,o.scaleY=m);else{let _=0,y=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:_=o.data.scaleX,y=o.data.scaleY,o.scaleX=_+(Math.abs(d)*MathUtils.signum(_)-_)*a,o.scaleY=y+(Math.abs(m)*MathUtils.signum(y)-y)*a;break;case MixBlend.first:case MixBlend.replace:_=o.scaleX,y=o.scaleY,o.scaleX=_+(Math.abs(d)*MathUtils.signum(_)-_)*a,o.scaleY=y+(Math.abs(m)*MathUtils.signum(y)-y)*a;break;case MixBlend.add:o.scaleX+=(d-o.data.scaleX)*a,o.scaleY+=(m-o.data.scaleY)*a}else switch(h){case MixBlend.setup:_=Math.abs(o.data.scaleX)*MathUtils.signum(d),y=Math.abs(o.data.scaleY)*MathUtils.signum(m),o.scaleX=_+(d-_)*a,o.scaleY=y+(m-y)*a;break;case MixBlend.first:case MixBlend.replace:_=Math.abs(o.scaleX)*MathUtils.signum(d),y=Math.abs(o.scaleY)*MathUtils.signum(m),o.scaleX=_+(d-_)*a,o.scaleY=y+(m-y)*a;break;case MixBlend.add:o.scaleX+=(d-o.data.scaleX)*a,o.scaleY+=(m-o.data.scaleY)*a}}}}class ScaleXTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.scaleX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.scaleX=o.data.scaleX;return;case MixBlend.first:o.scaleX+=(o.data.scaleX-o.scaleX)*a}return}const d=this.getCurveValue(s)*o.data.scaleX;if(a==1)h==MixBlend.add?o.scaleX+=d-o.data.scaleX:o.scaleX=d;else{let m=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:m=o.data.scaleX,o.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*a;break;case MixBlend.first:case MixBlend.replace:m=o.scaleX,o.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*a;break;case MixBlend.add:o.scaleX+=(d-o.data.scaleX)*a}else switch(h){case MixBlend.setup:m=Math.abs(o.data.scaleX)*MathUtils.signum(d),o.scaleX=m+(d-m)*a;break;case MixBlend.first:case MixBlend.replace:m=Math.abs(o.scaleX)*MathUtils.signum(d),o.scaleX=m+(d-m)*a;break;case MixBlend.add:o.scaleX+=(d-o.data.scaleX)*a}}}}class ScaleYTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.scaleY=o.data.scaleY;return;case MixBlend.first:o.scaleY+=(o.data.scaleY-o.scaleY)*a}return}const d=this.getCurveValue(s)*o.data.scaleY;if(a==1)h==MixBlend.add?o.scaleY+=d-o.data.scaleY:o.scaleY=d;else{let m=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:m=o.data.scaleY,o.scaleY=m+(Math.abs(d)*MathUtils.signum(m)-m)*a;break;case MixBlend.first:case MixBlend.replace:m=o.scaleY,o.scaleY=m+(Math.abs(d)*MathUtils.signum(m)-m)*a;break;case MixBlend.add:o.scaleY+=(d-o.data.scaleY)*a}else switch(h){case MixBlend.setup:m=Math.abs(o.data.scaleY)*MathUtils.signum(d),o.scaleY=m+(d-m)*a;break;case MixBlend.first:case MixBlend.replace:m=Math.abs(o.scaleY)*MathUtils.signum(d),o.scaleY=m+(d-m)*a;break;case MixBlend.add:o.scaleY+=(d-o.data.scaleY)*a}}}}class ShearTimeline extends CurveTimeline2{constructor(t,e,s){super(t,e,`${Property.shearX}|${s}`,`${Property.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.shearX=o.data.shearX,o.shearY=o.data.shearY;return;case MixBlend.first:o.shearX+=(o.data.shearX-o.shearX)*a,o.shearY+=(o.data.shearY-o.shearY)*a}return}let d=0,m=0;const p=Timeline$1.search(u,s,3),g=this.curves[p/3];switch(g){case 0:const _=u[p];d=u[p+1],m=u[p+2];const y=(s-_)/(u[p+3]-_);d+=(u[p+3+1]-d)*y,m+=(u[p+3+2]-m)*y;break;case 1:d=u[p+1],m=u[p+2];break;default:d=this.getBezierValue(s,p,1,g-2),m=this.getBezierValue(s,p,2,g+18-2)}switch(h){case MixBlend.setup:o.shearX=o.data.shearX+d*a,o.shearY=o.data.shearY+m*a;break;case MixBlend.first:case MixBlend.replace:o.shearX+=(o.data.shearX+d-o.shearX)*a,o.shearY+=(o.data.shearY+m-o.shearY)*a;break;case MixBlend.add:o.shearX+=d*a,o.shearY+=m*a}}}class ShearXTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.shearX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.shearX=o.data.shearX;return;case MixBlend.first:o.shearX+=(o.data.shearX-o.shearX)*a}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:o.shearX=o.data.shearX+d*a;break;case MixBlend.first:case MixBlend.replace:o.shearX+=(o.data.shearX+d-o.shearX)*a;break;case MixBlend.add:o.shearX+=d*a}}}class ShearYTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,a,h,c){const o=t.bones[this.boneIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.shearY=o.data.shearY;return;case MixBlend.first:o.shearY+=(o.data.shearY-o.shearY)*a}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:o.shearY=o.data.shearY+d*a;break;case MixBlend.first:case MixBlend.replace:o.shearY+=(o.data.shearY+d-o.shearY)*a;break;case MixBlend.add:o.shearY+=d*a}}}class RGBATimeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.rgb}|${s}`,`${Property.alpha}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,e,s,r,a,h){t*=5,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=a,this.frames[t+4]=h}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames,d=o.color;if(s<u[0]){const U=o.data.color;switch(h){case MixBlend.setup:d.setFromColor(U);return;case MixBlend.first:d.add((U.r-d.r)*a,(U.g-d.g)*a,(U.b-d.b)*a,(U.a-d.a)*a)}return}let m=0,p=0,g=0,_=0;const y=Timeline$1.search(u,s,5),v=this.curves[y/5];switch(v){case 0:const U=u[y];m=u[y+1],p=u[y+2],g=u[y+3],_=u[y+4];const w=(s-U)/(u[y+5]-U);m+=(u[y+5+1]-m)*w,p+=(u[y+5+2]-p)*w,g+=(u[y+5+3]-g)*w,_+=(u[y+5+4]-_)*w;break;case 1:m=u[y+1],p=u[y+2],g=u[y+3],_=u[y+4];break;default:m=this.getBezierValue(s,y,1,v-2),p=this.getBezierValue(s,y,2,v+18-2),g=this.getBezierValue(s,y,3,v+18*2-2),_=this.getBezierValue(s,y,4,v+18*3-2)}a==1?d.set(m,p,g,_):(h==MixBlend.setup&&d.setFromColor(o.data.color),d.add((m-d.r)*a,(p-d.g)*a,(g-d.b)*a,(_-d.a)*a))}}class RGBTimeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.rgb}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,r,a){t<<=2,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=a}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames,d=o.color;if(s<u[0]){const v=o.data.color;switch(h){case MixBlend.setup:d.r=v.r,d.g=v.g,d.b=v.b;return;case MixBlend.first:d.r+=(v.r-d.r)*a,d.g+=(v.g-d.g)*a,d.b+=(v.b-d.b)*a}return}let m=0,p=0,g=0;const _=Timeline$1.search(u,s,4),y=this.curves[_>>2];switch(y){case 0:const v=u[_];m=u[_+1],p=u[_+2],g=u[_+3];const U=(s-v)/(u[_+4]-v);m+=(u[_+4+1]-m)*U,p+=(u[_+4+2]-p)*U,g+=(u[_+4+3]-g)*U;break;case 1:m=u[_+1],p=u[_+2],g=u[_+3];break;default:m=this.getBezierValue(s,_,1,y-2),p=this.getBezierValue(s,_,2,y+18-2),g=this.getBezierValue(s,_,3,y+18*2-2)}if(a==1)d.r=m,d.g=p,d.b=g;else{if(h==MixBlend.setup){const v=o.data.color;d.r=v.r,d.g=v.g,d.b=v.b}d.r+=(m-d.r)*a,d.g+=(p-d.g)*a,d.b+=(g-d.b)*a}}}class AlphaTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.alpha}|${s}`),this.slotIndex=0,this.slotIndex=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=o.color;if(s<this.frames[0]){const m=o.data.color;switch(h){case MixBlend.setup:u.a=m.a;return;case MixBlend.first:u.a+=(m.a-u.a)*a}return}const d=this.getCurveValue(s);a==1?u.a=d:(h==MixBlend.setup&&(u.a=o.data.color.a),u.a+=(d-u.a)*a)}}class RGBA2Timeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.rgb}|${s}`,`${Property.alpha}|${s}`,`${Property.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,e,s,r,a,h,c,o,u){t<<=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=a,this.frames[t+4]=h,this.frames[t+5]=c,this.frames[t+6]=o,this.frames[t+7]=u}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames,d=o.color,m=o.darkColor;if(s<u[0]){const W=o.data.color,et=o.data.darkColor;switch(h){case MixBlend.setup:d.setFromColor(W),m.r=et.r,m.g=et.g,m.b=et.b;return;case MixBlend.first:d.add((W.r-d.r)*a,(W.g-d.g)*a,(W.b-d.b)*a,(W.a-d.a)*a),m.r+=(et.r-m.r)*a,m.g+=(et.g-m.g)*a,m.b+=(et.b-m.b)*a}return}let p=0,g=0,_=0,y=0,v=0,U=0,w=0;const k=Timeline$1.search(u,s,8),N=this.curves[k>>3];switch(N){case 0:const W=u[k];p=u[k+1],g=u[k+2],_=u[k+3],y=u[k+4],v=u[k+5],U=u[k+6],w=u[k+7];const et=(s-W)/(u[k+8]-W);p+=(u[k+8+1]-p)*et,g+=(u[k+8+2]-g)*et,_+=(u[k+8+3]-_)*et,y+=(u[k+8+4]-y)*et,v+=(u[k+8+5]-v)*et,U+=(u[k+8+6]-U)*et,w+=(u[k+8+7]-w)*et;break;case 1:p=u[k+1],g=u[k+2],_=u[k+3],y=u[k+4],v=u[k+5],U=u[k+6],w=u[k+7];break;default:p=this.getBezierValue(s,k,1,N-2),g=this.getBezierValue(s,k,2,N+18-2),_=this.getBezierValue(s,k,3,N+18*2-2),y=this.getBezierValue(s,k,4,N+18*3-2),v=this.getBezierValue(s,k,5,N+18*4-2),U=this.getBezierValue(s,k,6,N+18*5-2),w=this.getBezierValue(s,k,7,N+18*6-2)}if(a==1)d.set(p,g,_,y),m.r=v,m.g=U,m.b=w;else{if(h==MixBlend.setup){d.setFromColor(o.data.color);const W=o.data.darkColor;m.r=W.r,m.g=W.g,m.b=W.b}d.add((p-d.r)*a,(g-d.g)*a,(_-d.b)*a,(y-d.a)*a),m.r+=(v-m.r)*a,m.g+=(U-m.g)*a,m.b+=(w-m.b)*a}}}class RGB2Timeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.rgb}|${s}`,`${Property.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,r,a,h,c,o){t*=7,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=a,this.frames[t+4]=h,this.frames[t+5]=c,this.frames[t+6]=o}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=this.frames,d=o.color,m=o.darkColor;if(s<u[0]){const N=o.data.color,W=o.data.darkColor;switch(h){case MixBlend.setup:d.r=N.r,d.g=N.g,d.b=N.b,m.r=W.r,m.g=W.g,m.b=W.b;return;case MixBlend.first:d.r+=(N.r-d.r)*a,d.g+=(N.g-d.g)*a,d.b+=(N.b-d.b)*a,m.r+=(W.r-m.r)*a,m.g+=(W.g-m.g)*a,m.b+=(W.b-m.b)*a}return}let p=0,g=0,_=0,y=0,v=0,U=0;const w=Timeline$1.search(u,s,7),k=this.curves[w/7];switch(k){case 0:const N=u[w];p=u[w+1],g=u[w+2],_=u[w+3],y=u[w+4],v=u[w+5],U=u[w+6];const W=(s-N)/(u[w+7]-N);p+=(u[w+7+1]-p)*W,g+=(u[w+7+2]-g)*W,_+=(u[w+7+3]-_)*W,y+=(u[w+7+4]-y)*W,v+=(u[w+7+5]-v)*W,U+=(u[w+7+6]-U)*W;break;case 1:p=u[w+1],g=u[w+2],_=u[w+3],y=u[w+4],v=u[w+5],U=u[w+6];break;default:p=this.getBezierValue(s,w,1,k-2),g=this.getBezierValue(s,w,2,k+18-2),_=this.getBezierValue(s,w,3,k+18*2-2),y=this.getBezierValue(s,w,4,k+18*3-2),v=this.getBezierValue(s,w,5,k+18*4-2),U=this.getBezierValue(s,w,6,k+18*5-2)}if(a==1)d.r=p,d.g=g,d.b=_,m.r=y,m.g=v,m.b=U;else{if(h==MixBlend.setup){const N=o.data.color,W=o.data.darkColor;d.r=N.r,d.g=N.g,d.b=N.b,m.r=W.r,m.g=W.g,m.b=W.b}d.r+=(p-d.r)*a,d.g+=(g-d.g)*a,d.b+=(_-d.b)*a,m.r+=(y-m.r)*a,m.g+=(v-m.g)*a,m.b+=(U-m.b)*a}}}class AttachmentTimeline extends Timeline$1{constructor(t,e){super(t,[`${Property.attachment}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(o.bone.active){if(c==MixDirection.mixOut){h==MixBlend.setup&&this.setAttachment(t,o,o.data.attachmentName);return}if(s<this.frames[0]){(h==MixBlend.setup||h==MixBlend.first)&&this.setAttachment(t,o,o.data.attachmentName);return}this.setAttachment(t,o,this.attachmentNames[Timeline$1.search1(this.frames,s)])}}setAttachment(t,e,s){e.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}}class DeformTimeline extends CurveTimeline{constructor(t,e,s,r){super(t,e,[`${Property.deform}|${s}|${r.id}`]),this.slotIndex=0,this.slotIndex=s,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.vertices[t]=s}setBezier(t,e,s,r,a,h,c,o,u,d,m){const p=this.curves;let g=this.getFrameCount()+t*18;s==0&&(p[e]=2+g);const _=(r-h*2+o)*.03,y=u*.03-c*.06,v=((h-o)*3-r+d)*.006,U=(c-u+.33333333)*.018;let w=_*2+v,k=y*2+U,N=(h-r)*.3+_+v*.16666667,W=c*.3+y+U*.16666667,et=r+N,it=W;for(let ft=g+18;g<ft;g+=2)p[g]=et,p[g+1]=it,N+=w,W+=k,w+=v,k+=U,et+=N,it+=W}getCurvePercent(t,e){const s=this.curves;let r=s[e];switch(r){case 0:const o=this.frames[e];return(t-o)/(this.frames[e+this.getFrameEntries()]-o);case 1:return 0}if(r-=2,s[r]>t){const o=this.frames[e];return s[r+1]*(t-o)/(s[r]-o)}const a=r+18;for(r+=2;r<a;r+=2)if(s[r]>=t){const o=s[r-2],u=s[r-1];return u+(t-o)/(s[r]-o)*(s[r+1]-u)}const h=s[a-2],c=s[a-1];return c+(1-c)*(t-h)/(this.frames[e+this.getFrameEntries()]-h)}apply(t,e,s,r,a,h,c){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const u=o.getAttachment();if(!u||!(u instanceof VertexAttachment)||u.timelineAttachment!=this.attachment)return;const d=o.deform;d.length==0&&(h=MixBlend.setup);const m=this.vertices,p=m[0].length,g=this.frames;if(s<g[0]){switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(a==1){d.length=0;return}d.length=p;const w=u;if(w.bones){a=1-a;for(let k=0;k<p;k++)d[k]*=a}else{const k=w.vertices;for(let N=0;N<p;N++)d[N]+=(k[N]-d[N])*a}}return}if(d.length=p,s>=g[g.length-1]){const w=m[g.length-1];if(a==1)if(h==MixBlend.add){const k=u;if(k.bones)for(let N=0;N<p;N++)d[N]+=w[N];else{const N=k.vertices;for(let W=0;W<p;W++)d[W]+=w[W]-N[W]}}else Utils.arrayCopy(w,0,d,0,p);else switch(h){case MixBlend.setup:{const N=u;if(N.bones)for(let W=0;W<p;W++)d[W]=w[W]*a;else{const W=N.vertices;for(let et=0;et<p;et++){const it=W[et];d[et]=it+(w[et]-it)*a}}break}case MixBlend.first:case MixBlend.replace:for(let N=0;N<p;N++)d[N]+=(w[N]-d[N])*a;break;case MixBlend.add:const k=u;if(k.bones)for(let N=0;N<p;N++)d[N]+=w[N]*a;else{const N=k.vertices;for(let W=0;W<p;W++)d[W]+=(w[W]-N[W])*a}}return}const _=Timeline$1.search1(g,s),y=this.getCurvePercent(s,_),v=m[_],U=m[_+1];if(a==1)if(h==MixBlend.add){const w=u;if(w.bones)for(let k=0;k<p;k++){const N=v[k];d[k]+=N+(U[k]-N)*y}else{const k=w.vertices;for(let N=0;N<p;N++){const W=v[N];d[N]+=W+(U[N]-W)*y-k[N]}}}else for(let w=0;w<p;w++){const k=v[w];d[w]=k+(U[w]-k)*y}else switch(h){case MixBlend.setup:{const k=u;if(k.bones)for(let N=0;N<p;N++){const W=v[N];d[N]=(W+(U[N]-W)*y)*a}else{const N=k.vertices;for(let W=0;W<p;W++){const et=v[W],it=N[W];d[W]=it+(et+(U[W]-et)*y-it)*a}}break}case MixBlend.first:case MixBlend.replace:for(let k=0;k<p;k++){const N=v[k];d[k]+=(N+(U[k]-N)*y-d[k])*a}break;case MixBlend.add:const w=u;if(w.bones)for(let k=0;k<p;k++){const N=v[k];d[k]+=(N+(U[k]-N)*y)*a}else{const k=w.vertices;for(let N=0;N<p;N++){const W=v[N];d[N]+=(W+(U[N]-W)*y-k[N])*a}}}}}const _EventTimeline=class extends Timeline$1{constructor(n){super(n,_EventTimeline.propertyIds),this.events=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,t){this.frames[n]=t.time,this.events[n]=t}apply(n,t,e,s,r,a,h){if(!s)return;const c=this.frames,o=this.frames.length;if(t>e)this.apply(n,t,Number.MAX_VALUE,s,r,a,h),t=-1;else if(t>=c[o-1])return;if(e<c[0])return;let u=0;if(t<c[0])u=0;else{u=Timeline$1.search1(c,t)+1;const d=c[u];for(;u>0&&c[u-1]==d;)u--}for(;u<o&&e>=c[u];u++)s.push(this.events[u])}};let EventTimeline=_EventTimeline;EventTimeline.propertyIds=[`${Property.event}`];const _DrawOrderTimeline=class extends Timeline$1{constructor(n){super(n,_DrawOrderTimeline.propertyIds),this.drawOrders=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,t,e){this.frames[n]=t,this.drawOrders[n]=e}apply(n,t,e,s,r,a,h){if(h==MixDirection.mixOut){a==MixBlend.setup&&Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}if(e<this.frames[0]){(a==MixBlend.setup||a==MixBlend.first)&&Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}const c=Timeline$1.search1(this.frames,e),o=this.drawOrders[c];if(!o)Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{const u=n.drawOrder,d=n.slots;for(let m=0,p=o.length;m<p;m++)u[m]=d[o[m]]}}};let DrawOrderTimeline=_DrawOrderTimeline;DrawOrderTimeline.propertyIds=[`${Property.drawOrder}`];class IkConstraintTimeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.ikConstraint}|${s}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=s}getFrameEntries(){return 6}setFrame(t,e,s,r,a,h,c){t*=6,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=a,this.frames[t+4]=h?1:0,this.frames[t+5]=c?1:0}apply(t,e,s,r,a,h,c){const o=t.ikConstraints[this.ikConstraintIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case MixBlend.first:o.mix+=(o.data.mix-o.mix)*a,o.softness+=(o.data.softness-o.softness)*a,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let d=0,m=0;const p=Timeline$1.search(u,s,6),g=this.curves[p/6];switch(g){case 0:const _=u[p];d=u[p+1],m=u[p+2];const y=(s-_)/(u[p+6]-_);d+=(u[p+6+1]-d)*y,m+=(u[p+6+2]-m)*y;break;case 1:d=u[p+1],m=u[p+2];break;default:d=this.getBezierValue(s,p,1,g-2),m=this.getBezierValue(s,p,2,g+18-2)}h==MixBlend.setup?(o.mix=o.data.mix+(d-o.data.mix)*a,o.softness=o.data.softness+(m-o.data.softness)*a,c==MixDirection.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=u[p+3],o.compress=u[p+4]!=0,o.stretch=u[p+5]!=0)):(o.mix+=(d-o.mix)*a,o.softness+=(m-o.softness)*a,c==MixDirection.mixIn&&(o.bendDirection=u[p+3],o.compress=u[p+4]!=0,o.stretch=u[p+5]!=0))}}class TransformConstraintTimeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.transformConstraint}|${s}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,r,a,h,c,o){const u=this.frames;t*=7,u[t]=e,u[t+1]=s,u[t+2]=r,u[t+3]=a,u[t+4]=h,u[t+5]=c,u[t+6]=o}apply(t,e,s,r,a,h,c){const o=t.transformConstraints[this.transformConstraintIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){const w=o.data;switch(h){case MixBlend.setup:o.mixRotate=w.mixRotate,o.mixX=w.mixX,o.mixY=w.mixY,o.mixScaleX=w.mixScaleX,o.mixScaleY=w.mixScaleY,o.mixShearY=w.mixShearY;return;case MixBlend.first:o.mixRotate+=(w.mixRotate-o.mixRotate)*a,o.mixX+=(w.mixX-o.mixX)*a,o.mixY+=(w.mixY-o.mixY)*a,o.mixScaleX+=(w.mixScaleX-o.mixScaleX)*a,o.mixScaleY+=(w.mixScaleY-o.mixScaleY)*a,o.mixShearY+=(w.mixShearY-o.mixShearY)*a}return}let d,m,p,g,_,y;const v=Timeline$1.search(u,s,7),U=this.curves[v/7];switch(U){case 0:const w=u[v];d=u[v+1],m=u[v+2],p=u[v+3],g=u[v+4],_=u[v+5],y=u[v+6];const k=(s-w)/(u[v+7]-w);d+=(u[v+7+1]-d)*k,m+=(u[v+7+2]-m)*k,p+=(u[v+7+3]-p)*k,g+=(u[v+7+4]-g)*k,_+=(u[v+7+5]-_)*k,y+=(u[v+7+6]-y)*k;break;case 1:d=u[v+1],m=u[v+2],p=u[v+3],g=u[v+4],_=u[v+5],y=u[v+6];break;default:d=this.getBezierValue(s,v,1,U-2),m=this.getBezierValue(s,v,2,U+18-2),p=this.getBezierValue(s,v,3,U+18*2-2),g=this.getBezierValue(s,v,4,U+18*3-2),_=this.getBezierValue(s,v,5,U+18*4-2),y=this.getBezierValue(s,v,6,U+18*5-2)}if(h==MixBlend.setup){const w=o.data;o.mixRotate=w.mixRotate+(d-w.mixRotate)*a,o.mixX=w.mixX+(m-w.mixX)*a,o.mixY=w.mixY+(p-w.mixY)*a,o.mixScaleX=w.mixScaleX+(g-w.mixScaleX)*a,o.mixScaleY=w.mixScaleY+(_-w.mixScaleY)*a,o.mixShearY=w.mixShearY+(y-w.mixShearY)*a}else o.mixRotate+=(d-o.mixRotate)*a,o.mixX+=(m-o.mixX)*a,o.mixY+=(p-o.mixY)*a,o.mixScaleX+=(g-o.mixScaleX)*a,o.mixScaleY+=(_-o.mixScaleY)*a,o.mixShearY+=(y-o.mixShearY)*a}}class PathConstraintPositionTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.pathConstraintPosition}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,r,a,h,c){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.position=o.data.position;return;case MixBlend.first:o.position+=(o.data.position-o.position)*a}return}const d=this.getCurveValue(s);h==MixBlend.setup?o.position=o.data.position+(d-o.data.position)*a:o.position+=(d-o.position)*a}}class PathConstraintSpacingTimeline extends CurveTimeline1{constructor(t,e,s){super(t,e,`${Property.pathConstraintSpacing}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,r,a,h,c){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.spacing=o.data.spacing;return;case MixBlend.first:o.spacing+=(o.data.spacing-o.spacing)*a}return}const d=this.getCurveValue(s);h==MixBlend.setup?o.spacing=o.data.spacing+(d-o.data.spacing)*a:o.spacing+=(d-o.spacing)*a}}class PathConstraintMixTimeline extends CurveTimeline{constructor(t,e,s){super(t,e,[`${Property.pathConstraintMix}|${s}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,r,a){const h=this.frames;t<<=2,h[t]=e,h[t+1]=s,h[t+2]=r,h[t+3]=a}apply(t,e,s,r,a,h,c){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,o.mixY=o.data.mixY;return;case MixBlend.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*a,o.mixX+=(o.data.mixX-o.mixX)*a,o.mixY+=(o.data.mixY-o.mixY)*a}return}let d,m,p;const g=Timeline$1.search(u,s,4),_=this.curves[g>>2];switch(_){case 0:const y=u[g];d=u[g+1],m=u[g+2],p=u[g+3];const v=(s-y)/(u[g+4]-y);d+=(u[g+4+1]-d)*v,m+=(u[g+4+2]-m)*v,p+=(u[g+4+3]-p)*v;break;case 1:d=u[g+1],m=u[g+2],p=u[g+3];break;default:d=this.getBezierValue(s,g,1,_-2),m=this.getBezierValue(s,g,2,_+18-2),p=this.getBezierValue(s,g,3,_+18*2-2)}if(h==MixBlend.setup){const y=o.data;o.mixRotate=y.mixRotate+(d-y.mixRotate)*a,o.mixX=y.mixX+(m-y.mixX)*a,o.mixY=y.mixY+(p-y.mixY)*a}else o.mixRotate+=(d-o.mixRotate)*a,o.mixX+=(m-o.mixX)*a,o.mixY+=(p-o.mixY)*a}}const _SequenceTimeline=class extends Timeline$1{constructor(n,t,e){super(n,[`${Property.sequence}|${t}|${e.sequence.id}`]),this.slotIndex=t,this.attachment=e}getFrameEntries(){return _SequenceTimeline.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(n,t,e,s,r){const a=this.frames;n*=_SequenceTimeline.ENTRIES,a[n]=t,a[n+_SequenceTimeline.MODE]=e|s<<4,a[n+_SequenceTimeline.DELAY]=r}apply(n,t,e,s,r,a,h){const c=n.slots[this.slotIndex];if(!c.bone.active)return;const o=c.attachment,u=this.attachment;if(o!=u&&(!(o instanceof VertexAttachment)||o.timelineAttachment!=u))return;const d=this.frames;if(e<d[0]){(a==MixBlend.setup||a==MixBlend.first)&&(c.sequenceIndex=-1);return}const m=Timeline$1.search(d,e,_SequenceTimeline.ENTRIES),p=d[m],g=d[m+_SequenceTimeline.MODE],_=d[m+_SequenceTimeline.DELAY];if(!this.attachment.sequence)return;let y=g>>4;const v=this.attachment.sequence.regions.length,U=SequenceModeValues[g&15];if(U!=SequenceMode.hold)switch(y+=(e-p)/_+1e-5|0,U){case SequenceMode.once:y=Math.min(v-1,y);break;case SequenceMode.loop:y%=v;break;case SequenceMode.pingpong:{const w=(v<<1)-2;y=w==0?0:y%w,y>=v&&(y=w-y);break}case SequenceMode.onceReverse:y=Math.max(v-1-y,0);break;case SequenceMode.loopReverse:y=v-1-y%v;break;case SequenceMode.pingpongReverse:{const w=(v<<1)-2;y=w==0?0:(y+v-1)%w,y>=v&&(y=w-y)}}c.sequenceIndex=y}};let SequenceTimeline=_SequenceTimeline;SequenceTimeline.ENTRIES=3;SequenceTimeline.MODE=1;SequenceTimeline.DELAY=2;const _AnimationState=class{constructor(n){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new EventQueue(this),this.propertyIDs=new StringSet,this.animationsChanged=!1,this.trackEntryPool=new Pool$1(()=>new TrackEntry),this.data=n}static emptyAnimation(){return _AnimationState._emptyAnimation}update(n){n*=this.timeScale;const t=this.tracks;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let a=n*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}let h=r.next;if(h){const c=r.trackLast-h.delay;if(c>=0){for(h.delay=0,h.trackTime+=r.timeScale==0?0:(c/r.timeScale+n)*h.timeScale,r.trackTime+=a,this.setCurrent(e,h,!0);h.mixingFrom;)h.mixTime+=n,h=h.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){t[e]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,n)){let c=r.mixingFrom;for(r.mixingFrom=null,c&&(c.mixingTo=null);c;)this.queue.end(c),c=c.mixingFrom}r.trackTime+=a}this.queue.drain()}updateMixingFrom(n,t){const e=n.mixingFrom;if(!e)return!0;const s=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,n.mixTime>0&&n.mixTime>=n.mixDuration?((e.totalAlpha==0||n.mixDuration==0)&&(n.mixingFrom=e.mixingFrom,e.mixingFrom&&(e.mixingFrom.mixingTo=n),n.interruptAlpha=e.interruptAlpha,this.queue.end(e)),s):(e.trackTime+=t*e.timeScale,n.mixTime+=t,!1)}apply(n){if(!n)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const t=this.events,e=this.tracks;let s=!1;for(let h=0,c=e.length;h<c;h++){const o=e[h];if(!o||o.delay>0)continue;s=!0;const u=h==0?MixBlend.first:o.mixBlend;let d=o.alpha;o.mixingFrom?d*=this.applyMixingFrom(o,n,u):o.trackTime>=o.trackEnd&&!o.next&&(d=0);const m=o.animationLast,p=o.getAnimationTime();let g=p,_=t;o.reverse&&(g=o.animation.duration-g,_=null);const y=o.animation.timelines,v=y.length;if(h==0&&d==1||u==MixBlend.add)for(let U=0;U<v;U++){const w=y[U];w instanceof AttachmentTimeline?this.applyAttachmentTimeline(w,n,g,u,!0):w.apply(n,m,g,_,d,u,MixDirection.mixIn)}else{const U=o.timelineMode,w=o.shortestRotation,k=!w&&o.timelinesRotation.length!=v<<1;k&&(o.timelinesRotation.length=v<<1);for(let N=0;N<v;N++){const W=y[N],et=U[N]==SUBSEQUENT?u:MixBlend.setup;!w&&W instanceof RotateTimeline?this.applyRotateTimeline(W,n,g,d,et,o.timelinesRotation,N<<1,k):W instanceof AttachmentTimeline?this.applyAttachmentTimeline(W,n,g,u,!0):W.apply(n,m,g,_,d,et,MixDirection.mixIn)}}this.queueEvents(o,p),t.length=0,o.nextAnimationLast=p,o.nextTrackLast=o.trackTime}const r=this.unkeyedState+SETUP,a=n.slots;for(let h=0,c=n.slots.length;h<c;h++){const o=a[h];if(o.attachmentState==r){const u=o.data.attachmentName;o.setAttachment(u?n.getAttachment(o.data.index,u):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(n,t,e){const s=n.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,t,e);let r=0;n.mixDuration==0?(r=1,e==MixBlend.first&&(e=MixBlend.setup)):(r=n.mixTime/n.mixDuration,r>1&&(r=1),e!=MixBlend.first&&(e=s.mixBlend));const a=r<s.attachmentThreshold,h=r<s.drawOrderThreshold,c=s.animation.timelines,o=c.length,u=s.alpha*n.interruptAlpha,d=u*(1-r),m=s.animationLast,p=s.getAnimationTime();let g=p,_=null;if(s.reverse?g=s.animation.duration-g:r<s.eventThreshold&&(_=this.events),e==MixBlend.add)for(let y=0;y<o;y++)c[y].apply(t,m,g,_,d,e,MixDirection.mixOut);else{const y=s.timelineMode,v=s.timelineHoldMix,U=s.shortestRotation,w=!U&&s.timelinesRotation.length!=o<<1;w&&(s.timelinesRotation.length=o<<1),s.totalAlpha=0;for(let k=0;k<o;k++){const N=c[k];let W=MixDirection.mixOut,et,it=0;switch(y[k]){case SUBSEQUENT:if(!h&&N instanceof DrawOrderTimeline)continue;et=e,it=d;break;case FIRST:et=MixBlend.setup,it=d;break;case HOLD_SUBSEQUENT:et=e,it=u;break;case HOLD_FIRST:et=MixBlend.setup,it=u;break;default:et=MixBlend.setup;const ft=v[k];it=u*Math.max(0,1-ft.mixTime/ft.mixDuration);break}s.totalAlpha+=it,!U&&N instanceof RotateTimeline?this.applyRotateTimeline(N,t,g,it,et,s.timelinesRotation,k<<1,w):N instanceof AttachmentTimeline?this.applyAttachmentTimeline(N,t,g,et,a):(h&&N instanceof DrawOrderTimeline&&et==MixBlend.setup&&(W=MixDirection.mixIn),N.apply(t,m,g,_,it,et,W))}}return n.mixDuration>0&&this.queueEvents(s,p),this.events.length=0,s.nextAnimationLast=p,s.nextTrackLast=s.trackTime,r}applyAttachmentTimeline(n,t,e,s,r){const a=t.slots[n.slotIndex];a.bone.active&&(e<n.frames[0]?(s==MixBlend.setup||s==MixBlend.first)&&this.setAttachment(t,a,a.data.attachmentName,r):this.setAttachment(t,a,n.attachmentNames[Timeline$1.search1(n.frames,e)],r),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+SETUP))}setAttachment(n,t,e,s){t.setAttachment(e?n.getAttachment(t.data.index,e):null),s&&(t.attachmentState=this.unkeyedState+CURRENT)}applyRotateTimeline(n,t,e,s,r,a,h,c){if(c&&(a[h]=0),s==1){n.apply(t,0,e,null,1,r,MixDirection.mixIn);return}const o=t.bones[n.boneIndex];if(!o.active)return;const u=n.frames;let d=0,m=0;if(e<u[0])switch(r){case MixBlend.setup:o.rotation=o.data.rotation;default:return;case MixBlend.first:d=o.rotation,m=o.data.rotation}else d=r==MixBlend.setup?o.data.rotation:o.rotation,m=o.data.rotation+n.getCurveValue(e);let p=0,g=m-d;if(g-=(16384-(16384.499999999996-g/360|0))*360,g==0)p=a[h];else{let _=0,y=0;c?(_=0,y=g):(_=a[h],y=a[h+1]);const v=g>0;let U=_>=0;MathUtils.signum(y)!=MathUtils.signum(g)&&Math.abs(y)<=90&&(Math.abs(_)>180&&(_+=360*MathUtils.signum(_)),U=v),p=g+_-_%360,U!=v&&(p+=360*MathUtils.signum(_)),a[h]=p}a[h+1]=g,o.rotation=d+p*s}queueEvents(n,t){const e=n.animationStart,s=n.animationEnd,r=s-e,a=n.trackLast%r,h=this.events;let c=0;const o=h.length;for(;c<o;c++){const d=h[c];if(d.time<a)break;d.time>s||this.queue.event(n,d)}let u=!1;for(n.loop?u=r==0||a>n.trackTime%r:u=t>=s&&n.animationLast<s,u&&this.queue.complete(n);c<o;c++){const d=h[c];d.time<e||this.queue.event(n,d)}}clearTracks(){const n=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=n,this.queue.drain()}clearTrack(n){if(n>=this.tracks.length)return;const t=this.tracks[n];if(!t)return;this.queue.end(t),this.clearNext(t);let e=t;for(;;){const s=e.mixingFrom;if(!s)break;this.queue.end(s),e.mixingFrom=null,e.mixingTo=null,e=s}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(n,t,e){const s=this.expandToIndex(n);this.tracks[n]=t,t.previous=null,s&&(e&&this.queue.interrupt(s),t.mixingFrom=s,s.mixingTo=t,t.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(t.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(t)}setAnimation(n,t,e=!1){const s=this.data.skeletonData.findAnimation(t);if(!s)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(n,s,e)}setAnimationWith(n,t,e=!1){if(!t)throw new Error("animation cannot be null.");let s=!0,r=this.expandToIndex(n);r&&(r.nextTrackLast==-1?(this.tracks[n]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,s=!1):this.clearNext(r));const a=this.trackEntry(n,t,e,r);return this.setCurrent(n,a,s),this.queue.drain(),a}addAnimation(n,t,e=!1,s=0){const r=this.data.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(n,r,e,s)}addAnimationWith(n,t,e=!1,s=0){if(!t)throw new Error("animation cannot be null.");let r=this.expandToIndex(n);if(r)for(;r.next;)r=r.next;const a=this.trackEntry(n,t,e,r);return r?(r.next=a,a.previous=r,s<=0&&(s+=r.getTrackComplete()-a.mixDuration)):(this.setCurrent(n,a,!0),this.queue.drain()),a.delay=s,a}setEmptyAnimation(n,t=0){const e=this.setAnimationWith(n,_AnimationState.emptyAnimation(),!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(n,t=0,e=0){const s=this.addAnimationWith(n,_AnimationState.emptyAnimation(),!1,e);return e<=0&&(s.delay+=s.mixDuration-t),s.mixDuration=t,s.trackEnd=t,s}setEmptyAnimations(n=0){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++){const r=this.tracks[e];r&&this.setEmptyAnimation(r.trackIndex,n)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(n){return n<this.tracks.length?this.tracks[n]:(Utils.ensureArrayCapacity(this.tracks,n+1,null),this.tracks.length=n+1,null)}trackEntry(n,t,e,s){const r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=n,r.animation=t,r.loop=e,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=s?this.data.getMix(s.animation,t):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=MixBlend.replace,r}clearNext(n){let t=n.next;for(;t;)this.queue.dispose(t),t=t.next;n.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const n=this.tracks;for(let t=0,e=n.length;t<e;t++){let s=n[t];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do(!s.mixingTo||s.mixBlend!=MixBlend.add)&&this.computeHold(s),s=s.mixingTo;while(s)}}}computeHold(n){const t=n.mixingTo,e=n.animation.timelines,s=n.animation.timelines.length,r=n.timelineMode;r.length=s;const a=n.timelineHoldMix;a.length=0;const h=this.propertyIDs;if(t&&t.holdPrevious){for(let c=0;c<s;c++)r[c]=h.addAll(e[c].getPropertyIds())?HOLD_FIRST:HOLD_SUBSEQUENT;return}t:for(let c=0;c<s;c++){const o=e[c],u=o.getPropertyIds();if(!h.addAll(u))r[c]=SUBSEQUENT;else if(!t||o instanceof AttachmentTimeline||o instanceof DrawOrderTimeline||o instanceof EventTimeline||!t.animation.hasTimeline(u))r[c]=FIRST;else{for(let d=t.mixingTo;d;d=d.mixingTo)if(!d.animation.hasTimeline(u)){if(n.mixDuration>0){r[c]=HOLD_MIX,a[c]=d;continue t}break}r[c]=HOLD_FIRST}}}getCurrent(n){return n>=this.tracks.length?null:this.tracks[n]}addListener(n){if(!n)throw new Error("listener cannot be null.");this.listeners.push(n)}removeListener(n){const t=this.listeners.indexOf(n);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(n,t,e){_AnimationState.deprecatedWarning1||(_AnimationState.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(n,t,e)}addAnimationByName(n,t,e,s){_AnimationState.deprecatedWarning2||(_AnimationState.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(n,t,e,s)}hasAnimation(n){return this.data.skeletonData.findAnimation(n)!==null}hasAnimationByName(n){return _AnimationState.deprecatedWarning3||(_AnimationState.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(n)}};let AnimationState=_AnimationState;AnimationState._emptyAnimation=new Animation$2("<empty>",[],0);AnimationState.deprecatedWarning1=!1;AnimationState.deprecatedWarning2=!1;AnimationState.deprecatedWarning3=!1;const _TrackEntry=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const n=this.animationEnd-this.animationStart;return n==0?this.animationStart:this.trackTime%n+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(n){this.animationLast=n,this.nextAnimationLast=n}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const n=this.animationEnd-this.animationStart;if(n!=0){if(this.loop)return n*(1+(this.trackTime/n|0));if(this.trackTime<n)return n}return this.trackTime}get time(){return _TrackEntry.deprecatedWarning1||(_TrackEntry.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(n){_TrackEntry.deprecatedWarning1||(_TrackEntry.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=n}get endTime(){return _TrackEntry.deprecatedWarning2||(_TrackEntry.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(n){_TrackEntry.deprecatedWarning2||(_TrackEntry.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=n}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let TrackEntry=_TrackEntry;TrackEntry.deprecatedWarning1=!1;TrackEntry.deprecatedWarning2=!1;class EventQueue{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(EventType.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(EventType.interrupt),this.objects.push(t)}end(t){this.objects.push(EventType.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(EventType.dispose),this.objects.push(t)}complete(t){this.objects.push(EventType.complete),this.objects.push(t)}event(t,e){this.objects.push(EventType.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){const r=t[s],a=t[s+1];switch(r){case EventType.start:a.listener&&a.listener.start&&a.listener.start(a);for(let c=0;c<e.length;c++){const o=e[c];o.start&&o.start(a)}break;case EventType.interrupt:a.listener&&a.listener.interrupt&&a.listener.interrupt(a);for(let c=0;c<e.length;c++){const o=e[c];o.interrupt&&o.interrupt(a)}break;case EventType.end:a.listener&&a.listener.end&&a.listener.end(a);for(let c=0;c<e.length;c++){const o=e[c];o.end&&o.end(a)}case EventType.dispose:a.listener&&a.listener.dispose&&a.listener.dispose(a);for(let c=0;c<e.length;c++){const o=e[c];o.dispose&&o.dispose(a)}this.animState.trackEntryPool.free(a);break;case EventType.complete:a.listener&&a.listener.complete&&a.listener.complete(a);for(let c=0;c<e.length;c++){const o=e[c];o.complete&&o.complete(a)}break;case EventType.event:const h=t[s+++2];a.listener&&a.listener.event&&a.listener.event(a,h);for(let c=0;c<e.length;c++){const o=e[c];o.event&&o.event(a,h)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var EventType=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(EventType||{});class AnimationStateAdapter{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const SUBSEQUENT=0,FIRST=1,HOLD_SUBSEQUENT=2,HOLD_FIRST=3,HOLD_MIX=4,SETUP=1,CURRENT=2;class AnimationStateData{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){const r=this.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);const a=this.skeletonData.findAnimation(e);if(!a)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,a,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=s}getMix(t,e){const s=`${t.name}.${e.name}`,r=this.animationToMixTime[s];return r===void 0?this.defaultMix:r}}class AtlasAttachmentLoader{constructor(t){this.atlas=t}loadSequence(t,e,s){const r=s.regions;for(let a=0,h=r.length;a<h;a++){const c=s.getPath(e,a),o=this.atlas.findRegion(c);if(o==null)throw new Error(`Region not found in atlas: ${c} (sequence: ${t})`);r[a]=o,r[a].renderObject=r[a]}}newRegionAttachment(t,e,s,r){const a=new RegionAttachment(e,s);if(r!=null)this.loadSequence(e,s,r);else{const h=this.atlas.findRegion(s);if(!h)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);h.renderObject=h,a.region=h}return a}newMeshAttachment(t,e,s,r){const a=new MeshAttachment(e,s);if(r!=null)this.loadSequence(e,s,r);else{const h=this.atlas.findRegion(s);if(!h)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);h.renderObject=h,a.region=h}return a}newBoundingBoxAttachment(t,e){return new BoundingBoxAttachment(e)}newPathAttachment(t,e){return new PathAttachment(e)}newPointAttachment(t,e){return new PointAttachment(e)}newClippingAttachment(t,e){return new ClippingAttachment(e)}}class Bone{constructor(t,e,s){if(this.matrix=new Matrix,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,a,h,c){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=a,this.ashearX=h,this.ashearY=c;const o=this.parent,u=this.matrix,d=this.skeleton.scaleX,m=-this.skeleton.scaleY;if(!o){const v=this.skeleton,U=s+90+c;u.a=MathUtils.cosDeg(s+h)*r*d,u.c=MathUtils.cosDeg(U)*a*d,u.b=MathUtils.sinDeg(s+h)*r*m,u.d=MathUtils.sinDeg(U)*a*m,u.tx=t*d+v.x,u.ty=e*m+v.y;return}let p=o.matrix.a,g=o.matrix.c,_=o.matrix.b,y=o.matrix.d;switch(u.tx=p*t+g*e+o.matrix.tx,u.ty=_*t+y*e+o.matrix.ty,this.data.transformMode){case TransformMode.Normal:{const v=s+90+c,U=MathUtils.cosDeg(s+h)*r,w=MathUtils.cosDeg(v)*a,k=MathUtils.sinDeg(s+h)*r,N=MathUtils.sinDeg(v)*a;u.a=p*U+g*k,u.c=p*w+g*N,u.b=_*U+y*k,u.d=_*w+y*N;return}case TransformMode.OnlyTranslation:{const v=s+90+c;u.a=MathUtils.cosDeg(s+h)*r,u.c=MathUtils.cosDeg(v)*a,u.b=MathUtils.sinDeg(s+h)*r,u.d=MathUtils.sinDeg(v)*a;break}case TransformMode.NoRotationOrReflection:{let v=p*p+_*_,U=0;v>1e-4?(v=Math.abs(p*y-g*_)/v,p/=d,_/=m,g=_*v,y=p*v,U=Math.atan2(_,p)*MathUtils.radDeg):(p=0,_=0,U=90-Math.atan2(y,g)*MathUtils.radDeg);const w=s+h-U,k=s+c-U+90,N=MathUtils.cosDeg(w)*r,W=MathUtils.cosDeg(k)*a,et=MathUtils.sinDeg(w)*r,it=MathUtils.sinDeg(k)*a;u.a=p*N-g*et,u.c=p*W-g*it,u.b=_*N+y*et,u.d=_*W+y*it;break}case TransformMode.NoScale:case TransformMode.NoScaleOrReflection:{const v=MathUtils.cosDeg(s),U=MathUtils.sinDeg(s);let w=(p*v+g*U)/d,k=(_*v+y*U)/m,N=Math.sqrt(w*w+k*k);N>1e-5&&(N=1/N),w*=N,k*=N,N=Math.sqrt(w*w+k*k),this.data.transformMode==TransformMode.NoScale&&p*y-g*_<0!=(d<0!=m<0)&&(N=-N);const W=Math.PI/2+Math.atan2(k,w),et=Math.cos(W)*N,it=Math.sin(W)*N,ft=MathUtils.cosDeg(h)*r,mt=MathUtils.cosDeg(90+c)*a,xt=MathUtils.sinDeg(h)*r,yt=MathUtils.sinDeg(90+c)*a;u.a=w*ft+et*xt,u.c=w*mt+et*yt,u.b=k*ft+it*xt,u.d=k*mt+it*yt;break}}u.a*=d,u.c*=d,u.b*=m,u.d*=m}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*MathUtils.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*MathUtils.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*MathUtils.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*MathUtils.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),a=e.tx-s.tx,h=e.ty-s.ty;this.ax=a*s.d*r-h*s.c*r,this.ay=h*s.a*r-a*s.b*r;const c=r*s.d,o=r*s.a,u=r*s.c,d=r*s.b,m=c*e.a-u*e.b,p=c*e.c-u*e.d,g=o*e.b-d*e.a,_=o*e.d-d*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(m*m+g*g),this.ascaleX>1e-4){const y=m*_-p*g;this.ascaleY=y/this.ascaleX,this.ashearY=Math.atan2(m*p+g*_,y)*MathUtils.radDeg,this.arotation=Math.atan2(g,m)*MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(p*p+_*_),this.ashearY=0,this.arotation=90-Math.atan2(_,p)*MathUtils.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=1/(s*h-r*a),o=t.x-e.tx,u=t.y-e.ty;return t.x=o*h*c-u*r*c,t.y=u*s*c-o*a*c,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*MathUtils.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=MathUtils.sinDeg(t),s=MathUtils.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*MathUtils.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,a=e.b,h=e.d,c=MathUtils.cosDeg(t),o=MathUtils.sinDeg(t);e.a=c*s-o*a,e.c=c*r-o*h,e.b=o*s+c*a,e.d=o*r+c*h}}class BoneData{constructor(t,e,s){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,this.skinRequired=!1,this.color=new Color,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}}class ConstraintData{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}}let Event$1=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class EventData{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class IkConstraint{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let r=0;r<t.bones.length;r++){const a=e.findBone(t.bones[r].name);if(!a)throw new Error(`Couldn't find bone ${t.bones[r].name}`);this.bones.push(a)}const s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=s}isActive(){return this.active}update(){if(this.mix==0)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,s,r,a,h,c){const o=t.parent.matrix;if(!o)throw new Error("IK bone must have parent.");const u=o.a;let d=o.c;const m=o.b;let p=o.d,g=-t.ashearX-t.arotation,_=0,y=0;const v=t.skeleton.scaleX,U=-t.skeleton.scaleY;switch(t.data.transformMode){case TransformMode.OnlyTranslation:_=e-t.worldX,y=s-t.worldY,y=-y;break;case TransformMode.NoRotationOrReflection:const N=Math.abs(u*p-d*m)/(u*u+m*m),W=u/v,et=m/U;d=-et*N*v,p=W*N*U,g+=Math.atan2(et,W)*MathUtils.radDeg;default:const it=e-o.tx,ft=s-o.ty,mt=u*p-d*m;_=(it*p-ft*d)/mt-t.ax,y=(ft*u-it*m)/mt-t.ay}g+=Math.atan2(y,_)*MathUtils.radDeg,t.ascaleX<0&&(g+=180),g>180?g-=360:g<-180&&(g+=360);let w=t.ascaleX,k=t.ascaleY;if(r||a){switch(t.data.transformMode){case TransformMode.NoScale:case TransformMode.NoScaleOrReflection:_=e-t.worldX,y=s-t.worldY}const N=t.data.length*w,W=Math.sqrt(_*_+y*y);if(r&&W<N||a&&W>N&&N>1e-4){const et=(W/N-1)*c+1;w*=et,h&&(k*=et)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+g*c,w,k,t.ashearX,t.ashearY)}apply2(t,e,s,r,a,h,c,o,u){const d=t.ax,m=t.ay;let p=t.ascaleX,g=t.ascaleY,_=p,y=g,v=e.ascaleX;const U=t.matrix;let w=0,k=0,N=0;p<0?(p=-p,w=180,N=-1):(w=0,N=1),g<0&&(g=-g,N=-N),v<0?(v=-v,k=180):k=0;const W=e.ax;let et=0,it=0,ft=0,mt=U.a,xt=U.c,yt=U.b,vt=U.d;const St=Math.abs(p-g)<=1e-4;!St||h?(et=0,it=mt*W+U.tx,ft=yt*W+U.ty):(et=e.ay,it=mt*W+xt*et+U.tx,ft=yt*W+vt*et+U.ty);const wt=t.parent.matrix;if(!wt)throw new Error("IK parent must itself have a parent.");mt=wt.a,xt=wt.c,yt=wt.b,vt=wt.d;const Ct=1/(mt*vt-xt*yt);let It=it-wt.tx,Pt=ft-wt.ty;const Xt=(It*vt-Pt*xt)*Ct-d,Ut=(Pt*mt-It*yt)*Ct-m,Et=Math.sqrt(Xt*Xt+Ut*Ut);let Ft=e.data.length*v,Lt,Ht;if(Et<1e-4){this.apply1(t,s,r,!1,h,!1,u),e.updateWorldTransformWith(W,et,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}It=s-wt.tx,Pt=r-wt.ty;let Wt=(It*vt-Pt*xt)*Ct-d,Zt=(Pt*mt-It*yt)*Ct-m,ee=Wt*Wt+Zt*Zt;if(o!=0){o*=p*(v+1)*.5;const Nt=Math.sqrt(ee),Yt=Nt-Et-Ft*p+o;if(Yt>0){let zt=Math.min(1,Yt/(o*2))-1;zt=(Yt-o*(1-zt*zt))/Nt,Wt-=zt*Wt,Zt-=zt*Zt,ee=Wt*Wt+Zt*Zt}}t:if(St){Ft*=p;let Nt=(ee-Et*Et-Ft*Ft)/(2*Et*Ft);Nt<-1?(Nt=-1,Ht=Math.PI*a):Nt>1?(Nt=1,Ht=0,h&&(mt=(Math.sqrt(ee)/(Et+Ft)-1)*u+1,_*=mt,c&&(y*=mt))):Ht=Math.acos(Nt)*a,mt=Et+Ft*Nt,xt=Ft*Math.sin(Ht),Lt=Math.atan2(Zt*mt-Wt*xt,Wt*mt+Zt*xt)}else{mt=p*Ft,xt=g*Ft;const Nt=mt*mt,Yt=xt*xt,zt=Math.atan2(Zt,Wt);yt=Yt*Et*Et+Nt*ee-Nt*Yt;const te=-2*Yt*Et,Qt=Yt-Nt;if(vt=te*te-4*Qt*yt,vt>=0){let he=Math.sqrt(vt);te<0&&(he=-he),he=-(te+he)*.5;const ye=he/Qt,we=yt/he,_e=Math.abs(ye)<Math.abs(we)?ye:we;if(_e*_e<=ee){Pt=Math.sqrt(ee-_e*_e)*a,Lt=zt-Math.atan2(Pt,_e),Ht=Math.atan2(Pt/g,(_e-Et)/p);break t}}let ie=MathUtils.PI,re=Et-mt,le=re*re,oe=0,ge=0,pe=Et+mt,me=pe*pe,xe=0;yt=-mt*Et/(Nt-Yt),yt>=-1&&yt<=1&&(yt=Math.acos(yt),It=mt*Math.cos(yt)+Et,Pt=xt*Math.sin(yt),vt=It*It+Pt*Pt,vt<le&&(ie=yt,le=vt,re=It,oe=Pt),vt>me&&(ge=yt,me=vt,pe=It,xe=Pt)),ee<=(le+me)*.5?(Lt=zt-Math.atan2(oe*a,re),Ht=ie*a):(Lt=zt-Math.atan2(xe*a,pe),Ht=ge*a)}const ne=Math.atan2(et,W)*N;let se=t.arotation;Lt=(Lt-ne)*MathUtils.radDeg+w-se,Lt>180?Lt-=360:Lt<-180&&(Lt+=360),t.updateWorldTransformWith(d,m,se+Lt*u,_,y,0,0),se=e.arotation,Ht=((Ht+ne)*MathUtils.radDeg-e.ashearX)*N+k-se,Ht>180?Ht-=360:Ht<-180&&(Ht+=360),e.updateWorldTransformWith(W,et,se+Ht*u,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class IkConstraintData extends ConstraintData{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class PathConstraintData extends ConstraintData{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=PositionMode.Fixed,this.spacingMode=SpacingMode.Fixed,this.rotateMode=RotateMode.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var SpacingMode=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n[n.Proportional=3]="Proportional",n))(SpacingMode||{});const _PathConstraint=class{constructor(n,t){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!n)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=n,this.bones=new Array;for(let s=0,r=n.bones.length;s<r;s++){const a=t.findBone(n.bones[s].name);if(!a)throw new Error(`Couldn't find bone ${n.bones[s].name}.`);this.bones.push(a)}const e=t.findSlot(n.target.name);if(!e)throw new Error(`Couldn't find target bone ${n.target.name}`);this.target=e,this.position=n.position,this.spacing=n.spacing,this.mixRotate=n.mixRotate,this.mixX=n.mixX,this.mixY=n.mixY}isActive(){return this.active}update(){const n=this.target.getAttachment();if(!(n instanceof PathAttachment))return;const t=this.mixRotate,e=this.mixX,s=this.mixY;if(t==0&&e==0&&s==0)return;const r=this.data,a=r.rotateMode==RotateMode.Tangent,h=r.rotateMode==RotateMode.ChainScale,c=this.bones,o=c.length,u=a?o:o+1,d=Utils.setArraySize(this.spaces,u),m=h?this.lengths=Utils.setArraySize(this.lengths,o):[],p=this.spacing;switch(r.spacingMode){case SpacingMode.Percent:if(h)for(let N=0,W=u-1;N<W;N++){const et=c[N],it=et.data.length;if(it<_PathConstraint.epsilon)m[N]=0;else{const ft=it*et.matrix.a,mt=it*et.matrix.b;m[N]=Math.sqrt(ft*ft+mt*mt)}}Utils.arrayFill(d,1,u,p);break;case SpacingMode.Proportional:let w=0;for(let N=0,W=u-1;N<W;){const et=c[N],it=et.data.length;if(it<_PathConstraint.epsilon)h&&(m[N]=0),d[++N]=p;else{const ft=it*et.matrix.a,mt=it*et.matrix.b,xt=Math.sqrt(ft*ft+mt*mt);h&&(m[N]=xt),d[++N]=xt,w+=xt}}if(w>0){w=u/w*p;for(let N=1;N<u;N++)d[N]*=w}break;default:const k=r.spacingMode==SpacingMode.Length;for(let N=0,W=u-1;N<W;){const et=c[N],it=et.data.length;if(it<_PathConstraint.epsilon)h&&(m[N]=0),d[++N]=p;else{const ft=it*et.matrix.a,mt=it*et.matrix.b,xt=Math.sqrt(ft*ft+mt*mt);h&&(m[N]=xt),d[++N]=(k?it+p:p)*xt/it}}}const g=this.computeWorldPositions(n,u,a);let _=g[0],y=g[1],v=r.offsetRotation,U=!1;if(v==0)U=r.rotateMode==RotateMode.Chain;else{U=!1;const w=this.target.bone.matrix;v*=w.a*w.d-w.b*w.c>0?MathUtils.degRad:-MathUtils.degRad}for(let w=0,k=3;w<o;w++,k+=3){const N=c[w],W=N.matrix;W.tx+=(_-W.tx)*e,W.ty+=(y-W.ty)*s;const et=g[k],it=g[k+1],ft=et-_,mt=it-y;if(h){const xt=m[w];if(xt!=0){const yt=(Math.sqrt(ft*ft+mt*mt)/xt-1)*t+1;W.a*=yt,W.b*=yt}}if(_=et,y=it,t>0){const xt=W.a,yt=W.c,vt=W.b,St=W.d;let wt=0,Ct=0,It=0;if(a?wt=g[k-1]:d[w+1]==0?wt=g[k+2]:wt=Math.atan2(mt,ft),wt-=Math.atan2(vt,xt),U){Ct=Math.cos(wt),It=Math.sin(wt);const Pt=N.data.length;_+=(Pt*(Ct*xt-It*vt)-ft)*t,y+=(Pt*(It*xt+Ct*vt)-mt)*t}else wt+=v;wt>MathUtils.PI?wt-=MathUtils.PI2:wt<-MathUtils.PI&&(wt+=MathUtils.PI2),wt*=t,Ct=Math.cos(wt),It=Math.sin(wt),W.a=Ct*xt-It*vt,W.c=Ct*yt-It*St,W.b=It*xt+Ct*vt,W.d=It*yt+Ct*St}N.updateAppliedTransform()}}computeWorldPositions(n,t,e){const s=this.target;let r=this.position;const a=this.spaces,h=Utils.setArraySize(this.positions,t*3+2);let c=this.world;const o=n.closed;let u=n.worldVerticesLength,d=u/6,m=_PathConstraint.NONE;if(!n.constantSpeed){const Pt=n.lengths;d-=o?1:2;const Xt=Pt[d];this.data.positionMode==PositionMode.Percent&&(r*=Xt);let Ut;switch(this.data.spacingMode){case SpacingMode.Percent:Ut=Xt;break;case SpacingMode.Proportional:Ut=Xt/t;break;default:Ut=1}c=Utils.setArraySize(this.world,8);for(let Et=0,Ft=0,Lt=0;Et<t;Et++,Ft+=3){const Ht=a[Et]*Ut;r+=Ht;let Wt=r;if(o)Wt%=Xt,Wt<0&&(Wt+=Xt),Lt=0;else if(Wt<0){m!=_PathConstraint.BEFORE&&(m=_PathConstraint.BEFORE,n.computeWorldVertices(s,2,4,c,0,2)),this.addBeforePosition(Wt,c,0,h,Ft);continue}else if(Wt>Xt){m!=_PathConstraint.AFTER&&(m=_PathConstraint.AFTER,n.computeWorldVertices(s,u-6,4,c,0,2)),this.addAfterPosition(Wt-Xt,c,0,h,Ft);continue}for(;;Lt++){const Zt=Pt[Lt];if(!(Wt>Zt)){if(Lt==0)Wt/=Zt;else{const ee=Pt[Lt-1];Wt=(Wt-ee)/(Zt-ee)}break}}Lt!=m&&(m=Lt,o&&Lt==d?(n.computeWorldVertices(s,u-4,4,c,0,2),n.computeWorldVertices(s,0,4,c,4,2)):n.computeWorldVertices(s,Lt*6+2,8,c,0,2)),this.addCurvePosition(Wt,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,Ft,e||Et>0&&Ht==0)}return h}o?(u+=2,c=Utils.setArraySize(this.world,u),n.computeWorldVertices(s,2,u-4,c,0,2),n.computeWorldVertices(s,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(d--,u-=4,c=Utils.setArraySize(this.world,u),n.computeWorldVertices(s,2,u,c,0,2));const p=Utils.setArraySize(this.curves,d);let g=0,_=c[0],y=c[1],v=0,U=0,w=0,k=0,N=0,W=0,et=0,it=0,ft=0,mt=0,xt=0,yt=0,vt=0,St=0;for(let Pt=0,Xt=2;Pt<d;Pt++,Xt+=6)v=c[Xt],U=c[Xt+1],w=c[Xt+2],k=c[Xt+3],N=c[Xt+4],W=c[Xt+5],et=(_-v*2+w)*.1875,it=(y-U*2+k)*.1875,ft=((v-w)*3-_+N)*.09375,mt=((U-k)*3-y+W)*.09375,xt=et*2+ft,yt=it*2+mt,vt=(v-_)*.75+et+ft*.16666667,St=(U-y)*.75+it+mt*.16666667,g+=Math.sqrt(vt*vt+St*St),vt+=xt,St+=yt,xt+=ft,yt+=mt,g+=Math.sqrt(vt*vt+St*St),vt+=xt,St+=yt,g+=Math.sqrt(vt*vt+St*St),vt+=xt+ft,St+=yt+mt,g+=Math.sqrt(vt*vt+St*St),p[Pt]=g,_=N,y=W;this.data.positionMode==PositionMode.Percent&&(r*=g);let wt;switch(this.data.spacingMode){case SpacingMode.Percent:wt=g;break;case SpacingMode.Proportional:wt=g/t;break;default:wt=1}const Ct=this.segments;let It=0;for(let Pt=0,Xt=0,Ut=0,Et=0;Pt<t;Pt++,Xt+=3){const Ft=a[Pt]*wt;r+=Ft;let Lt=r;if(o)Lt%=g,Lt<0&&(Lt+=g),Ut=0;else if(Lt<0){this.addBeforePosition(Lt,c,0,h,Xt);continue}else if(Lt>g){this.addAfterPosition(Lt-g,c,u-4,h,Xt);continue}for(;;Ut++){const Ht=p[Ut];if(!(Lt>Ht)){if(Ut==0)Lt/=Ht;else{const Wt=p[Ut-1];Lt=(Lt-Wt)/(Ht-Wt)}break}}if(Ut!=m){m=Ut;let Ht=Ut*6;for(_=c[Ht],y=c[Ht+1],v=c[Ht+2],U=c[Ht+3],w=c[Ht+4],k=c[Ht+5],N=c[Ht+6],W=c[Ht+7],et=(_-v*2+w)*.03,it=(y-U*2+k)*.03,ft=((v-w)*3-_+N)*.006,mt=((U-k)*3-y+W)*.006,xt=et*2+ft,yt=it*2+mt,vt=(v-_)*.3+et+ft*.16666667,St=(U-y)*.3+it+mt*.16666667,It=Math.sqrt(vt*vt+St*St),Ct[0]=It,Ht=1;Ht<8;Ht++)vt+=xt,St+=yt,xt+=ft,yt+=mt,It+=Math.sqrt(vt*vt+St*St),Ct[Ht]=It;vt+=xt,St+=yt,It+=Math.sqrt(vt*vt+St*St),Ct[8]=It,vt+=xt+ft,St+=yt+mt,It+=Math.sqrt(vt*vt+St*St),Ct[9]=It,Et=0}for(Lt*=It;;Et++){const Ht=Ct[Et];if(!(Lt>Ht)){if(Et==0)Lt/=Ht;else{const Wt=Ct[Et-1];Lt=Et+(Lt-Wt)/(Ht-Wt)}break}}this.addCurvePosition(Lt*.1,_,y,v,U,w,k,N,W,h,Xt,e||Pt>0&&Ft==0)}return h}addBeforePosition(n,t,e,s,r){const a=t[e],h=t[e+1],c=t[e+2]-a,o=t[e+3]-h,u=Math.atan2(o,c);s[r]=a+n*Math.cos(u),s[r+1]=h+n*Math.sin(u),s[r+2]=u}addAfterPosition(n,t,e,s,r){const a=t[e+2],h=t[e+3],c=a-t[e],o=h-t[e+1],u=Math.atan2(o,c);s[r]=a+n*Math.cos(u),s[r+1]=h+n*Math.sin(u),s[r+2]=u}addCurvePosition(n,t,e,s,r,a,h,c,o,u,d,m){if(n==0||isNaN(n)){u[d]=t,u[d+1]=e,u[d+2]=Math.atan2(r-e,s-t);return}const p=n*n,g=p*n,_=1-n,y=_*_,v=y*_,U=_*n,w=U*3,k=_*w,N=w*n,W=t*v+s*k+a*N+c*g,et=e*v+r*k+h*N+o*g;u[d]=W,u[d+1]=et,m&&(n<.001?u[d+2]=Math.atan2(r-e,s-t):u[d+2]=Math.atan2(et-(e*y+r*U*2+h*p),W-(t*y+s*U*2+a*p)))}};let PathConstraint=_PathConstraint;PathConstraint.NONE=-1;PathConstraint.BEFORE=-2;PathConstraint.AFTER=-3;PathConstraint.epsilon=1e-5;class Slot{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new Color,this.darkColor=t.darkColor?new Color:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof VertexAttachment)||!(this.attachment instanceof VertexAttachment)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class TransformConstraint{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new Vector2,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let r=0;r<t.bones.length;r++){const a=e.findBone(t.bones[r].name);if(!a)throw new Error(`Couldn't find bone ${t.bones[r].name}.`);this.bones.push(a)}const s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=s}isActive(){return this.active}update(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,a=this.mixScaleY,h=this.mixShearY,c=e!=0||s!=0,o=this.target,u=o.matrix,d=u.a,m=u.c,p=u.b,g=u.d,_=d*g-m*p>0?MathUtils.degRad:-MathUtils.degRad,y=this.data.offsetRotation*_,v=this.data.offsetShearY*_,U=this.bones;for(let w=0,k=U.length;w<k;w++){const N=U[w],W=N.matrix;if(t!=0){const et=W.a,it=W.c,ft=W.b,mt=W.d;let xt=Math.atan2(p,d)-Math.atan2(ft,et)+y;xt>MathUtils.PI?xt-=MathUtils.PI2:xt<-MathUtils.PI&&(xt+=MathUtils.PI2),xt*=t;const yt=Math.cos(xt),vt=Math.sin(xt);W.a=yt*et-vt*ft,W.c=yt*it-vt*mt,W.b=vt*et+yt*ft,W.d=vt*it+yt*mt}if(c){const et=this.temp;o.localToWorld(et.set(this.data.offsetX,this.data.offsetY)),W.tx+=(et.x-W.tx)*e,W.ty+=(et.y-W.ty)*s}if(r!=0){let et=Math.sqrt(W.a*W.a+W.b*W.b);et!=0&&(et=(et+(Math.sqrt(d*d+p*p)-et+this.data.offsetScaleX)*r)/et),W.a*=et,W.b*=et}if(a!=0){let et=Math.sqrt(W.c*W.c+W.d*W.d);et!=0&&(et=(et+(Math.sqrt(m*m+g*g)-et+this.data.offsetScaleY)*a)/et),W.c*=et,W.d*=et}if(h>0){const et=W.c,it=W.d,ft=Math.atan2(it,et);let mt=Math.atan2(g,m)-Math.atan2(p,d)-(ft-Math.atan2(W.b,W.a));mt>MathUtils.PI?mt-=MathUtils.PI2:mt<-MathUtils.PI&&(mt+=MathUtils.PI2),mt=ft+(mt+v)*h;const xt=Math.sqrt(et*et+it*it);W.c=Math.cos(mt)*xt,W.d=Math.sin(mt)*xt}N.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,a=this.mixScaleY,h=this.mixShearY,c=e!=0||s!=0,o=this.target,u=o.matrix,d=u.a,m=u.c,p=u.b,g=u.d,_=d*g-m*p>0?MathUtils.degRad:-MathUtils.degRad,y=this.data.offsetRotation*_,v=this.data.offsetShearY*_,U=this.bones;for(let w=0,k=U.length;w<k;w++){const N=U[w],W=N.matrix;if(t!=0){const et=W.a,it=W.c,ft=W.b,mt=W.d;let xt=Math.atan2(p,d)+y;xt>MathUtils.PI?xt-=MathUtils.PI2:xt<-MathUtils.PI&&(xt+=MathUtils.PI2),xt*=t;const yt=Math.cos(xt),vt=Math.sin(xt);W.a=yt*et-vt*ft,W.c=yt*it-vt*mt,W.b=vt*et+yt*ft,W.d=vt*it+yt*mt}if(c){const et=this.temp;o.localToWorld(et.set(this.data.offsetX,this.data.offsetY)),W.tx+=et.x*e,W.ty+=et.y*s}if(r!=0){const et=(Math.sqrt(d*d+p*p)-1+this.data.offsetScaleX)*r+1;W.a*=et,W.b*=et}if(a!=0){const et=(Math.sqrt(m*m+g*g)-1+this.data.offsetScaleY)*a+1;W.c*=et,W.d*=et}if(h>0){let et=Math.atan2(g,m)-Math.atan2(p,d);et>MathUtils.PI?et-=MathUtils.PI2:et<-MathUtils.PI&&(et+=MathUtils.PI2);const it=W.c,ft=W.d;et=Math.atan2(ft,it)+(et-MathUtils.PI/2+v)*h;const mt=Math.sqrt(it*it+ft*ft);W.c=Math.cos(et)*mt,W.d=Math.sin(et)*mt}N.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,a=this.mixScaleY,h=this.mixShearY,c=this.target,o=this.bones;for(let u=0,d=o.length;u<d;u++){const m=o[u];let p=m.arotation;if(t!=0){let w=c.arotation-p+this.data.offsetRotation;w-=(16384-(16384.499999999996-w/360|0))*360,p+=w*t}let g=m.ax,_=m.ay;g+=(c.ax-g+this.data.offsetX)*e,_+=(c.ay-_+this.data.offsetY)*s;let y=m.ascaleX,v=m.ascaleY;r!=0&&y!=0&&(y=(y+(c.ascaleX-y+this.data.offsetScaleX)*r)/y),a!=0&&v!=0&&(v=(v+(c.ascaleY-v+this.data.offsetScaleY)*a)/v);let U=m.ashearY;if(h!=0){let w=c.ashearY-U+this.data.offsetShearY;w-=(16384-(16384.499999999996-w/360|0))*360,U+=w*h}m.updateWorldTransformWith(g,_,p,y,v,m.ashearX,U)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,a=this.mixScaleY,h=this.mixShearY,c=this.target,o=this.bones;for(let u=0,d=o.length;u<d;u++){const m=o[u],p=m.arotation+(c.arotation+this.data.offsetRotation)*t,g=m.ax+(c.ax+this.data.offsetX)*e,_=m.ay+(c.ay+this.data.offsetY)*s,y=m.ascaleX*((c.ascaleX-1+this.data.offsetScaleX)*r+1),v=m.ascaleY*((c.ascaleY-1+this.data.offsetScaleY)*a+1),U=m.ashearY+(c.ashearY+this.data.offsetShearY)*h;m.updateWorldTransformWith(g,_,p,y,v,m.ashearX,U)}}}const _Skeleton=class{constructor(n){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!n)throw new Error("data cannot be null.");this.data=n,this.bones=new Array;for(let t=0;t<n.bones.length;t++){const e=n.bones[t];let s;if(!e.parent)s=new Bone(e,this,null);else{const r=this.bones[e.parent.index];s=new Bone(e,this,r),r.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<n.slots.length;t++){const e=n.slots[t],s=this.bones[e.boneData.index],r=new Slot(e,s);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<n.ikConstraints.length;t++){const e=n.ikConstraints[t];this.ikConstraints.push(new IkConstraint(e,this))}this.transformConstraints=new Array;for(let t=0;t<n.transformConstraints.length;t++){const e=n.transformConstraints[t];this.transformConstraints.push(new TransformConstraint(e,this))}this.pathConstraints=new Array;for(let t=0;t<n.pathConstraints.length;t++){const e=n.pathConstraints[t];this.pathConstraints.push(new PathConstraint(e,this))}this.color=new Color(1,1,1,1),this.updateCache()}updateCache(){const n=this._updateCache;n.length=0;const t=this.bones;for(let u=0,d=t.length;u<d;u++){const m=t[u];m.sorted=m.data.skinRequired,m.active=!m.sorted}if(this.skin){const u=this.skin.bones;for(let d=0,m=this.skin.bones.length;d<m;d++){let p=this.bones[u[d].index];do p.sorted=!1,p.active=!0,p=p.parent;while(p)}}const e=this.ikConstraints,s=this.transformConstraints,r=this.pathConstraints,a=e.length,h=s.length,c=r.length,o=a+h+c;t:for(let u=0;u<o;u++){for(let d=0;d<a;d++){const m=e[d];if(m.data.order==u){this.sortIkConstraint(m);continue t}}for(let d=0;d<h;d++){const m=s[d];if(m.data.order==u){this.sortTransformConstraint(m);continue t}}for(let d=0;d<c;d++){const m=r[d];if(m.data.order==u){this.sortPathConstraint(m);continue t}}}for(let u=0,d=t.length;u<d;u++)this.sortBone(t[u])}sortIkConstraint(n){if(n.active=n.target.isActive()&&(!n.data.skinRequired||this.skin&&Utils.contains(this.skin.constraints,n.data,!0)),!n.active)return;const t=n.target;this.sortBone(t);const e=n.bones,s=e[0];if(this.sortBone(s),e.length==1)this._updateCache.push(n),this.sortReset(s.children);else{const r=e[e.length-1];this.sortBone(r),this._updateCache.push(n),this.sortReset(s.children),r.sorted=!0}}sortPathConstraint(n){if(n.active=n.target.bone.isActive()&&(!n.data.skinRequired||this.skin&&Utils.contains(this.skin.constraints,n.data,!0)),!n.active)return;const t=n.target,e=t.data.index,s=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,e,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,s);for(let c=0,o=this.data.skins.length;c<o;c++)this.sortPathConstraintAttachment(this.data.skins[c],e,s);const r=t.getAttachment();r instanceof PathAttachment&&this.sortPathConstraintAttachmentWith(r,s);const a=n.bones,h=a.length;for(let c=0;c<h;c++)this.sortBone(a[c]);this._updateCache.push(n);for(let c=0;c<h;c++)this.sortReset(a[c].children);for(let c=0;c<h;c++)a[c].sorted=!0}sortTransformConstraint(n){if(n.active=n.target.isActive()&&(!n.data.skinRequired||this.skin&&Utils.contains(this.skin.constraints,n.data,!0)),!n.active)return;this.sortBone(n.target);const t=n.bones,e=t.length;if(n.data.local)for(let s=0;s<e;s++){const r=t[s];this.sortBone(r.parent),this.sortBone(r)}else for(let s=0;s<e;s++)this.sortBone(t[s]);this._updateCache.push(n);for(let s=0;s<e;s++)this.sortReset(t[s].children);for(let s=0;s<e;s++)t[s].sorted=!0}sortPathConstraintAttachment(n,t,e){const s=n.attachments[t];if(s)for(const r in s)this.sortPathConstraintAttachmentWith(s[r],e)}sortPathConstraintAttachmentWith(n,t){if(!(n instanceof PathAttachment))return;const e=n.bones;if(!e)this.sortBone(t);else{const s=this.bones;for(let r=0,a=e.length;r<a;){let h=e[r++];for(h+=r;r<h;)this.sortBone(s[e[r++]])}}}sortBone(n){if(!n||n.sorted)return;const t=n.parent;t&&this.sortBone(t),n.sorted=!0,this._updateCache.push(n)}sortReset(n){for(let t=0,e=n.length;t<e;t++){const s=n[t];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(){const n=this.bones;for(let e=0,s=n.length;e<s;e++){const r=n[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY}const t=this._updateCache;for(let e=0,s=t.length;e<s;e++)t[e].update()}updateWorldTransformWith(n){const t=this.getRootBone(),e=n.matrix.a,s=n.matrix.c,r=n.matrix.b,a=n.matrix.d;t.matrix.tx=e*this.x+s*this.y+n.worldX,t.matrix.ty=r*this.x+a*this.y+n.worldY;const h=t.rotation+90+t.shearY,c=MathUtils.cosDeg(t.rotation+t.shearX)*t.scaleX,o=MathUtils.cosDeg(h)*t.scaleY,u=MathUtils.sinDeg(t.rotation+t.shearX)*t.scaleX,d=MathUtils.sinDeg(h)*t.scaleY,m=this.scaleX,p=-this.scaleY;t.matrix.a=(e*c+s*u)*m,t.matrix.c=(e*o+s*d)*m,t.matrix.b=(r*c+a*u)*p,t.matrix.d=(r*o+a*d)*p;const g=this._updateCache;for(let _=0,y=g.length;_<y;_++){const v=g[_];v!=t&&v.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const n=this.bones;for(let r=0,a=n.length;r<a;r++)n[r].setToSetupPose();const t=this.ikConstraints;for(let r=0,a=t.length;r<a;r++){const h=t[r];h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}const e=this.transformConstraints;for(let r=0,a=e.length;r<a;r++){const h=e[r],c=h.data;h.mixRotate=c.mixRotate,h.mixX=c.mixX,h.mixY=c.mixY,h.mixScaleX=c.mixScaleX,h.mixScaleY=c.mixScaleY,h.mixShearY=c.mixShearY}const s=this.pathConstraints;for(let r=0,a=s.length;r<a;r++){const h=s[r],c=h.data;h.position=c.position,h.spacing=c.spacing,h.mixRotate=c.mixRotate,h.mixX=c.mixX,h.mixY=c.mixY}}setSlotsToSetupPose(){const n=this.slots;Utils.arrayCopy(n,0,this.drawOrder,0,n.length);for(let t=0,e=n.length;t<e;t++)n[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(n){if(!n)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findBoneIndex(n){if(!n)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,s=t.length;e<s;e++)if(t[e].data.name==n)return e;return-1}findSlot(n){if(!n)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findSlotIndex(n){if(!n)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,s=t.length;e<s;e++)if(t[e].data.name==n)return e;return-1}setSkinByName(n){const t=this.data.findSkin(n);if(!t)throw new Error(`Skin not found: ${n}`);this.setSkin(t)}setSkin(n){if(n!=this.skin){if(n)if(this.skin)n.attachAll(this,this.skin);else{const t=this.slots;for(let e=0,s=t.length;e<s;e++){const r=t[e],a=r.data.attachmentName;if(a){const h=n.getAttachment(e,a);h&&r.setAttachment(h)}}}this.skin=n,this.updateCache()}}getAttachmentByName(n,t){const e=this.data.findSlot(n);if(!e)throw new Error(`Can't find slot with name ${n}`);return this.getAttachment(e.index,t)}getAttachment(n,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){const e=this.skin.getAttachment(n,t);if(e)return e}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(n,t):null}setAttachment(n,t){if(!n)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.data.name==n){let h=null;if(t&&(h=this.getAttachment(s,t),!h))throw new Error(`Attachment not found: ${t}, for slot: ${n}`);a.setAttachment(h);return}}throw new Error(`Slot not found: ${n}`)}findIkConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findTransformConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findPathConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}getBoundsRect(){const n=new Vector2,t=new Vector2;return this.getBounds(n,t),{x:n.x,y:n.y,width:t.x,height:t.y}}getBounds(n,t,e=new Array(2)){if(!n)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");const s=this.drawOrder;let r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let o=0,u=s.length;o<u;o++){const d=s[o];if(!d.bone.active)continue;let m=0,p=null;const g=d.getAttachment();if(g instanceof RegionAttachment)m=8,p=Utils.setArraySize(e,m,0),g.computeWorldVertices(d,p,0,2);else if(g instanceof MeshAttachment){const _=g;m=_.worldVerticesLength,p=Utils.setArraySize(e,m,0),_.computeWorldVertices(d,0,m,p,0,2)}if(p)for(let _=0,y=p.length;_<y;_+=2){const v=p[_],U=p[_+1];r=Math.min(r,v),a=Math.min(a,U),h=Math.max(h,v),c=Math.max(c,U)}}n.set(r,a),t.set(h-r,c-a)}get flipX(){return this.scaleX==-1}set flipX(n){_Skeleton.deprecatedWarning1||(_Skeleton.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=n?1:-1}get flipY(){return this.scaleY==-1}set flipY(n){_Skeleton.deprecatedWarning1||(_Skeleton.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=n?1:-1}};let Skeleton=_Skeleton;Skeleton.deprecatedWarning1=!1;class SkeletonData{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.name==t)return a}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}}class SlotData{constructor(t,e,s){if(this.index=0,this.color=new Color(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=BLEND_MODES.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}}class TransformConstraintData extends ConstraintData{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class SkinEntry{constructor(t,e,s){this.slotIndex=t,this.name=e,this.attachment=s}}class Skin{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}addSkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let a=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){a=!0;break}a||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let a=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){a=!0;break}a||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let a=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){a=!0;break}a||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let a=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){a=!0;break}a||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];r.attachment&&(r.attachment instanceof MeshAttachment?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){const s=this.attachments[t];s&&delete s[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const s=this.attachments[e];if(s)for(const r in s){const a=s[r];a&&t.push(new SkinEntry(e,r,a))}}return t}getAttachmentsForSlot(t,e){const s=this.attachments[t];if(s)for(const r in s){const a=s[r];a&&e.push(new SkinEntry(t,r,a))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const a=t.slots[r],h=a.getAttachment();if(h&&s<e.attachments.length){const c=e.attachments[s];for(const o in c){const u=c[o];if(h==u){const d=this.getAttachment(s,o);d&&a.setAttachment(d);break}}}s++}}}class SkeletonBinary{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new SkeletonData;s.name="";const r=new BinaryInput(t),a=r.readInt32(),h=r.readInt32();s.hash=h==0&&a==0?null:h.toString(16)+a.toString(16),s.version=r.readString();const c=s.version.substr(0,3);if(c!=="4.0"&&c!=="4.1"){const m=`Spine 4.1 loader cant load version ${s.version}. Please configure your pixi-spine bundle`;console.error(m)}this.ver40=c==="4.0",s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat();const o=r.readBoolean();o&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());let u=0;u=r.readInt(!0);for(let m=0;m<u;m++){const p=r.readString();if(!p)throw new Error("String in string table must not be null.");r.strings.push(p)}u=r.readInt(!0);for(let m=0;m<u;m++){const p=r.readString();if(!p)throw new Error("Bone name must not be null.");const g=m==0?null:s.bones[r.readInt(!0)],_=new BoneData(m,p,g);_.rotation=r.readFloat(),_.x=r.readFloat()*e,_.y=r.readFloat()*e,_.scaleX=r.readFloat(),_.scaleY=r.readFloat(),_.shearX=r.readFloat(),_.shearY=r.readFloat(),_.length=r.readFloat()*e,_.transformMode=r.readInt(!0),_.skinRequired=r.readBoolean(),o&&Color.rgba8888ToColor(_.color,r.readInt32()),s.bones.push(_)}u=r.readInt(!0);for(let m=0;m<u;m++){const p=r.readString();if(!p)throw new Error("Slot name must not be null.");const g=s.bones[r.readInt(!0)],_=new SlotData(m,p,g);Color.rgba8888ToColor(_.color,r.readInt32());const y=r.readInt32();y!=-1&&Color.rgb888ToColor(_.darkColor=new Color,y),_.attachmentName=r.readStringRef(),_.blendMode=r.readInt(!0),s.slots.push(_)}u=r.readInt(!0);for(let m=0,p;m<u;m++){const g=r.readString();if(!g)throw new Error("IK constraint data name must not be null.");const _=new IkConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),p=r.readInt(!0);for(let y=0;y<p;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.bones[r.readInt(!0)],_.mix=r.readFloat(),_.softness=r.readFloat()*e,_.bendDirection=r.readByte(),_.compress=r.readBoolean(),_.stretch=r.readBoolean(),_.uniform=r.readBoolean(),s.ikConstraints.push(_)}u=r.readInt(!0);for(let m=0,p;m<u;m++){const g=r.readString();if(!g)throw new Error("Transform constraint data name must not be null.");const _=new TransformConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),p=r.readInt(!0);for(let y=0;y<p;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.bones[r.readInt(!0)],_.local=r.readBoolean(),_.relative=r.readBoolean(),_.offsetRotation=r.readFloat(),_.offsetX=r.readFloat()*e,_.offsetY=r.readFloat()*e,_.offsetScaleX=r.readFloat(),_.offsetScaleY=r.readFloat(),_.offsetShearY=r.readFloat(),_.mixRotate=r.readFloat(),_.mixX=r.readFloat(),_.mixY=r.readFloat(),_.mixScaleX=r.readFloat(),_.mixScaleY=r.readFloat(),_.mixShearY=r.readFloat(),s.transformConstraints.push(_)}u=r.readInt(!0);for(let m=0,p;m<u;m++){const g=r.readString();if(!g)throw new Error("Path constraint data name must not be null.");const _=new PathConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),p=r.readInt(!0);for(let y=0;y<p;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.slots[r.readInt(!0)],_.positionMode=r.readInt(!0),_.spacingMode=r.readInt(!0),_.rotateMode=r.readInt(!0),_.offsetRotation=r.readFloat(),_.position=r.readFloat(),_.positionMode==PositionMode.Fixed&&(_.position*=e),_.spacing=r.readFloat(),(_.spacingMode==SpacingMode.Length||_.spacingMode==SpacingMode.Fixed)&&(_.spacing*=e),_.mixRotate=r.readFloat(),_.mixX=r.readFloat(),_.mixY=r.readFloat(),s.pathConstraints.push(_)}const d=this.readSkin(r,s,!0,o);d&&(s.defaultSkin=d,s.skins.push(d));{let m=s.skins.length;for(Utils.setArraySize(s.skins,u=m+r.readInt(!0));m<u;m++){const p=this.readSkin(r,s,!1,o);if(!p)throw new Error("readSkin() should not have returned null.");s.skins[m]=p}}u=this.linkedMeshes.length;for(let m=0;m<u;m++){const p=this.linkedMeshes[m],g=p.skin?s.findSkin(p.skin):s.defaultSkin;if(!g)throw new Error("Not skin found for linked mesh.");if(!p.parent)throw new Error("Linked mesh parent must not be null");const _=g.getAttachment(p.slotIndex,p.parent);if(!_)throw new Error(`Parent mesh not found: ${p.parent}`);p.mesh.timelineAttachment=p.inheritTimeline?_:p.mesh,p.mesh.setParentMesh(_)}this.linkedMeshes.length=0,u=r.readInt(!0);for(let m=0;m<u;m++){const p=r.readStringRef();if(!p)throw new Error;const g=new EventData(p);g.intValue=r.readInt(!1),g.floatValue=r.readFloat(),g.stringValue=r.readString(),g.audioPath=r.readString(),g.audioPath&&(g.volume=r.readFloat(),g.balance=r.readFloat()),s.events.push(g)}u=r.readInt(!0);for(let m=0;m<u;m++){const p=r.readString();if(!p)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(r,p,s))}return s}readSkin(t,e,s,r){let a=null,h=0;if(s){if(h=t.readInt(!0),h==0)return null;a=new Skin("default")}else{const c=t.readStringRef();if(!c)throw new Error("Skin name must not be null.");a=new Skin(c),a.bones.length=t.readInt(!0);for(let o=0,u=a.bones.length;o<u;o++)a.bones[o]=e.bones[t.readInt(!0)];for(let o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let o=0,u=t.readInt(!0);o<u;o++)a.constraints.push(e.pathConstraints[t.readInt(!0)]);h=t.readInt(!0)}for(let c=0;c<h;c++){const o=t.readInt(!0);for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readStringRef();if(!m)throw new Error("Attachment name must not be null");const p=this.readAttachment(t,e,a,o,m,r);p&&a.setAttachment(o,m,p)}}return a}readAttachment(t,e,s,r,a,h){const c=this.scale;let o=t.readStringRef();switch(o||(o=a),t.readByte()){case AttachmentType.Region:{let u=t.readStringRef();const d=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat(),_=t.readFloat(),y=t.readFloat(),v=t.readFloat(),U=t.readInt32(),w=this.readSequence(t);u||(u=o);const k=this.attachmentLoader.newRegionAttachment(s,o,u,w);return k?(k.path=u,k.x=m*c,k.y=p*c,k.scaleX=g,k.scaleY=_,k.rotation=d,k.width=y*c,k.height=v*c,Color.rgba8888ToColor(k.color,U),k.sequence=w,w==null&&k.updateRegion(),k):null}case AttachmentType.BoundingBox:{const u=t.readInt(!0),d=this.readVertices(t,u),m=h?t.readInt32():0,p=this.attachmentLoader.newBoundingBoxAttachment(s,o);return p?(p.worldVerticesLength=u<<1,p.vertices=d.vertices,p.bones=d.bones,h&&Color.rgba8888ToColor(p.color,m),p):null}case AttachmentType.Mesh:{let u=t.readStringRef();const d=t.readInt32(),m=t.readInt(!0),p=this.readFloatArray(t,m<<1,1),g=this.readShortArray(t),_=this.readVertices(t,m),y=t.readInt(!0),v=this.readSequence(t);let U=[],w=0,k=0;h&&(U=this.readShortArray(t),w=t.readFloat(),k=t.readFloat()),u||(u=o);const N=this.attachmentLoader.newMeshAttachment(s,o,u,v);return N?(N.path=u,Color.rgba8888ToColor(N.color,d),N.bones=_.bones,N.vertices=_.vertices,N.worldVerticesLength=m<<1,N.triangles=g,N.regionUVs=new Float32Array(p),N.hullLength=y<<1,N.sequence=v,h&&(N.edges=U,N.width=w*c,N.height=k*c),N):null}case AttachmentType.LinkedMesh:{let u=t.readStringRef();const d=t.readInt32(),m=t.readStringRef(),p=t.readStringRef(),g=t.readBoolean(),_=this.readSequence(t);let y=0,v=0;h&&(y=t.readFloat(),v=t.readFloat()),u||(u=o);const U=this.attachmentLoader.newMeshAttachment(s,o,u,_);return U?(U.path=u,Color.rgba8888ToColor(U.color,d),U.sequence=_,h&&(U.width=y*c,U.height=v*c),this.linkedMeshes.push(new LinkedMesh$1(U,m,r,p,g)),U):null}case AttachmentType.Path:{const u=t.readBoolean(),d=t.readBoolean(),m=t.readInt(!0),p=this.readVertices(t,m),g=Utils.newArray(m/3,0);for(let v=0,U=g.length;v<U;v++)g[v]=t.readFloat()*c;const _=h?t.readInt32():0,y=this.attachmentLoader.newPathAttachment(s,o);return y?(y.closed=u,y.constantSpeed=d,y.worldVerticesLength=m<<1,y.vertices=p.vertices,y.bones=p.bones,y.lengths=g,h&&Color.rgba8888ToColor(y.color,_),y):null}case AttachmentType.Point:{const u=t.readFloat(),d=t.readFloat(),m=t.readFloat(),p=h?t.readInt32():0,g=this.attachmentLoader.newPointAttachment(s,o);return g?(g.x=d*c,g.y=m*c,g.rotation=u,h&&Color.rgba8888ToColor(g.color,p),g):null}case AttachmentType.Clipping:{const u=t.readInt(!0),d=t.readInt(!0),m=this.readVertices(t,d),p=h?t.readInt32():0,g=this.attachmentLoader.newClippingAttachment(s,o);return g?(g.endSlot=e.slots[u],g.worldVerticesLength=d<<1,g.vertices=m.vertices,g.bones=m.bones,h&&Color.rgba8888ToColor(g.color,p),g):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new Sequence$1(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?ATTACHMENT_DEFORM:t.readByte()}readVertices(t,e){const s=this.scale,r=e<<1,a=new Vertices;if(!t.readBoolean())return a.vertices=this.readFloatArray(t,r,s),a;const h=new Array,c=new Array;for(let o=0;o<e;o++){const u=t.readInt(!0);c.push(u);for(let d=0;d<u;d++)c.push(t.readInt(!0)),h.push(t.readFloat()*s),h.push(t.readFloat()*s),h.push(t.readFloat())}return a.vertices=Utils.toFloatArray(h),a.bones=c,a}readFloatArray(t,e,s){const r=new Array(e);if(s==1)for(let a=0;a<e;a++)r[a]=t.readFloat();else for(let a=0;a<e;a++)r[a]=t.readFloat()*s;return r}readShortArray(t){const e=t.readInt(!0),s=new Array(e);for(let r=0;r<e;r++)s[r]=t.readShort();return s}readAnimation(t,e,s){t.readInt(!0);const r=new Array,a=this.scale;for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){const _=t.readByte(),y=t.readInt(!0),v=y-1;switch(_){case SLOT_ATTACHMENT:{const U=new AttachmentTimeline(y,m);for(let w=0;w<y;w++)U.setFrame(w,t.readFloat(),t.readStringRef());r.push(U);break}case SLOT_RGBA:{const U=t.readInt(!0),w=new RGBATimeline(y,U,m);let k=t.readFloat(),N=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255,it=t.readUnsignedByte()/255;for(let ft=0,mt=0;w.setFrame(ft,k,N,W,et,it),ft!=v;ft++){const xt=t.readFloat(),yt=t.readUnsignedByte()/255,vt=t.readUnsignedByte()/255,St=t.readUnsignedByte()/255,wt=t.readUnsignedByte()/255;switch(t.readByte()){case CURVE_STEPPED:w.setStepped(ft);break;case CURVE_BEZIER:setBezier(t,w,mt++,ft,0,k,xt,N,yt,1),setBezier(t,w,mt++,ft,1,k,xt,W,vt,1),setBezier(t,w,mt++,ft,2,k,xt,et,St,1),setBezier(t,w,mt++,ft,3,k,xt,it,wt,1)}k=xt,N=yt,W=vt,et=St,it=wt}r.push(w);break}case SLOT_RGB:{const U=t.readInt(!0),w=new RGBTimeline(y,U,m);let k=t.readFloat(),N=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255;for(let it=0,ft=0;w.setFrame(it,k,N,W,et),it!=v;it++){const mt=t.readFloat(),xt=t.readUnsignedByte()/255,yt=t.readUnsignedByte()/255,vt=t.readUnsignedByte()/255;switch(t.readByte()){case CURVE_STEPPED:w.setStepped(it);break;case CURVE_BEZIER:setBezier(t,w,ft++,it,0,k,mt,N,xt,1),setBezier(t,w,ft++,it,1,k,mt,W,yt,1),setBezier(t,w,ft++,it,2,k,mt,et,vt,1)}k=mt,N=xt,W=yt,et=vt}r.push(w);break}case SLOT_RGBA2:{const U=t.readInt(!0),w=new RGBA2Timeline(y,U,m);let k=t.readFloat(),N=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255,it=t.readUnsignedByte()/255,ft=t.readUnsignedByte()/255,mt=t.readUnsignedByte()/255,xt=t.readUnsignedByte()/255;for(let yt=0,vt=0;w.setFrame(yt,k,N,W,et,it,ft,mt,xt),yt!=v;yt++){const St=t.readFloat(),wt=t.readUnsignedByte()/255,Ct=t.readUnsignedByte()/255,It=t.readUnsignedByte()/255,Pt=t.readUnsignedByte()/255,Xt=t.readUnsignedByte()/255,Ut=t.readUnsignedByte()/255,Et=t.readUnsignedByte()/255;switch(t.readByte()){case CURVE_STEPPED:w.setStepped(yt);break;case CURVE_BEZIER:setBezier(t,w,vt++,yt,0,k,St,N,wt,1),setBezier(t,w,vt++,yt,1,k,St,W,Ct,1),setBezier(t,w,vt++,yt,2,k,St,et,It,1),setBezier(t,w,vt++,yt,3,k,St,it,Pt,1),setBezier(t,w,vt++,yt,4,k,St,ft,Xt,1),setBezier(t,w,vt++,yt,5,k,St,mt,Ut,1),setBezier(t,w,vt++,yt,6,k,St,xt,Et,1)}k=St,N=wt,W=Ct,et=It,it=Pt,ft=Xt,mt=Ut,xt=Et}r.push(w);break}case SLOT_RGB2:{const U=t.readInt(!0),w=new RGB2Timeline(y,U,m);let k=t.readFloat(),N=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255,it=t.readUnsignedByte()/255,ft=t.readUnsignedByte()/255,mt=t.readUnsignedByte()/255;for(let xt=0,yt=0;w.setFrame(xt,k,N,W,et,it,ft,mt),xt!=v;xt++){const vt=t.readFloat(),St=t.readUnsignedByte()/255,wt=t.readUnsignedByte()/255,Ct=t.readUnsignedByte()/255,It=t.readUnsignedByte()/255,Pt=t.readUnsignedByte()/255,Xt=t.readUnsignedByte()/255;switch(t.readByte()){case CURVE_STEPPED:w.setStepped(xt);break;case CURVE_BEZIER:setBezier(t,w,yt++,xt,0,k,vt,N,St,1),setBezier(t,w,yt++,xt,1,k,vt,W,wt,1),setBezier(t,w,yt++,xt,2,k,vt,et,Ct,1),setBezier(t,w,yt++,xt,3,k,vt,it,It,1),setBezier(t,w,yt++,xt,4,k,vt,ft,Pt,1),setBezier(t,w,yt++,xt,5,k,vt,mt,Xt,1)}k=vt,N=St,W=wt,et=Ct,it=It,ft=Pt,mt=Xt}r.push(w);break}case SLOT_ALPHA:{const U=new AlphaTimeline(y,t.readInt(!0),m);let w=t.readFloat(),k=t.readUnsignedByte()/255;for(let N=0,W=0;U.setFrame(N,w,k),N!=v;N++){const et=t.readFloat(),it=t.readUnsignedByte()/255;switch(t.readByte()){case CURVE_STEPPED:U.setStepped(N);break;case CURVE_BEZIER:setBezier(t,U,W++,N,0,w,et,k,it,1)}w=et,k=it}r.push(U)}}}}for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){const _=t.readByte(),y=t.readInt(!0),v=t.readInt(!0);switch(_){case BONE_ROTATE:r.push(readTimeline1$1(t,new RotateTimeline(y,v,m),1));break;case BONE_TRANSLATE:r.push(readTimeline2$1(t,new TranslateTimeline(y,v,m),a));break;case BONE_TRANSLATEX:r.push(readTimeline1$1(t,new TranslateXTimeline(y,v,m),a));break;case BONE_TRANSLATEY:r.push(readTimeline1$1(t,new TranslateYTimeline(y,v,m),a));break;case BONE_SCALE:r.push(readTimeline2$1(t,new ScaleTimeline(y,v,m),1));break;case BONE_SCALEX:r.push(readTimeline1$1(t,new ScaleXTimeline(y,v,m),1));break;case BONE_SCALEY:r.push(readTimeline1$1(t,new ScaleYTimeline(y,v,m),1));break;case BONE_SHEAR:r.push(readTimeline2$1(t,new ShearTimeline(y,v,m),1));break;case BONE_SHEARX:r.push(readTimeline1$1(t,new ShearXTimeline(y,v,m),1));break;case BONE_SHEARY:r.push(readTimeline1$1(t,new ShearYTimeline(y,v,m),1))}}}for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readInt(!0),p=t.readInt(!0),g=p-1,_=new IkConstraintTimeline(p,t.readInt(!0),m);let y=t.readFloat(),v=t.readFloat(),U=t.readFloat()*a;for(let w=0,k=0;_.setFrame(w,y,v,U,t.readByte(),t.readBoolean(),t.readBoolean()),w!=g;w++){const N=t.readFloat(),W=t.readFloat(),et=t.readFloat()*a;switch(t.readByte()){case CURVE_STEPPED:_.setStepped(w);break;case CURVE_BEZIER:setBezier(t,_,k++,w,0,y,N,v,W,1),setBezier(t,_,k++,w,1,y,N,U,et,a)}y=N,v=W,U=et}r.push(_)}for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readInt(!0),p=t.readInt(!0),g=p-1,_=new TransformConstraintTimeline(p,t.readInt(!0),m);let y=t.readFloat(),v=t.readFloat(),U=t.readFloat(),w=t.readFloat(),k=t.readFloat(),N=t.readFloat(),W=t.readFloat();for(let et=0,it=0;_.setFrame(et,y,v,U,w,k,N,W),et!=g;et++){const ft=t.readFloat(),mt=t.readFloat(),xt=t.readFloat(),yt=t.readFloat(),vt=t.readFloat(),St=t.readFloat(),wt=t.readFloat();switch(t.readByte()){case CURVE_STEPPED:_.setStepped(et);break;case CURVE_BEZIER:setBezier(t,_,it++,et,0,y,ft,v,mt,1),setBezier(t,_,it++,et,1,y,ft,U,xt,1),setBezier(t,_,it++,et,2,y,ft,w,yt,1),setBezier(t,_,it++,et,3,y,ft,k,vt,1),setBezier(t,_,it++,et,4,y,ft,N,St,1),setBezier(t,_,it++,et,5,y,ft,W,wt,1)}y=ft,v=mt,U=xt,w=yt,k=vt,N=St,W=wt}r.push(_)}for(let u=0,d=t.readInt(!0);u<d;u++){const m=t.readInt(!0),p=s.pathConstraints[m];for(let g=0,_=t.readInt(!0);g<_;g++)switch(t.readByte()){case PATH_POSITION:r.push(readTimeline1$1(t,new PathConstraintPositionTimeline(t.readInt(!0),t.readInt(!0),m),p.positionMode==PositionMode.Fixed?a:1));break;case PATH_SPACING:r.push(readTimeline1$1(t,new PathConstraintSpacingTimeline(t.readInt(!0),t.readInt(!0),m),p.spacingMode==SpacingMode.Length||p.spacingMode==SpacingMode.Fixed?a:1));break;case PATH_MIX:const y=new PathConstraintMixTimeline(t.readInt(!0),t.readInt(!0),m);let v=t.readFloat(),U=t.readFloat(),w=t.readFloat(),k=t.readFloat();for(let N=0,W=0,et=y.getFrameCount()-1;y.setFrame(N,v,U,w,k),N!=et;N++){const it=t.readFloat(),ft=t.readFloat(),mt=t.readFloat(),xt=t.readFloat();switch(t.readByte()){case CURVE_STEPPED:y.setStepped(N);break;case CURVE_BEZIER:setBezier(t,y,W++,N,0,v,it,U,ft,1),setBezier(t,y,W++,N,1,v,it,w,mt,1),setBezier(t,y,W++,N,2,v,it,k,xt,1)}v=it,U=ft,w=mt,k=xt}r.push(y)}}for(let u=0,d=t.readInt(!0);u<d;u++){const m=s.skins[t.readInt(!0)];for(let p=0,g=t.readInt(!0);p<g;p++){const _=t.readInt(!0);for(let y=0,v=t.readInt(!0);y<v;y++){const U=t.readStringRef();if(!U)throw new Error("attachmentName must not be null.");const w=m.getAttachment(_,U),k=this.readDeformTimelineType(t),N=t.readInt(!0),W=N-1;switch(k){case ATTACHMENT_DEFORM:{const et=w,it=et.bones,ft=et.vertices,mt=it?ft.length/3*2:ft.length,xt=t.readInt(!0),yt=new DeformTimeline(N,xt,_,et);let vt=t.readFloat();for(let St=0,wt=0;;St++){let Ct,It=t.readInt(!0);if(It==0)Ct=it?Utils.newFloatArray(mt):ft;else{Ct=Utils.newFloatArray(mt);const Xt=t.readInt(!0);if(It+=Xt,a==1)for(let Ut=Xt;Ut<It;Ut++)Ct[Ut]=t.readFloat();else for(let Ut=Xt;Ut<It;Ut++)Ct[Ut]=t.readFloat()*a;if(!it)for(let Ut=0,Et=Ct.length;Ut<Et;Ut++)Ct[Ut]+=ft[Ut]}if(yt.setFrame(St,vt,Ct),St==W)break;const Pt=t.readFloat();switch(t.readByte()){case CURVE_STEPPED:yt.setStepped(St);break;case CURVE_BEZIER:setBezier(t,yt,wt++,St,0,vt,Pt,0,1,1)}vt=Pt}r.push(yt);break}case ATTACHMENT_SEQUENCE:{const et=new SequenceTimeline(N,_,w);for(let it=0;it<N;it++){const ft=t.readFloat(),mt=t.readInt32();et.setFrame(it,ft,SequenceModeValues[mt&15],mt>>4,t.readFloat())}r.push(et);break}}}}}const h=t.readInt(!0);if(h>0){const u=new DrawOrderTimeline(h),d=s.slots.length;for(let m=0;m<h;m++){const p=t.readFloat(),g=t.readInt(!0),_=Utils.newArray(d,0);for(let w=d-1;w>=0;w--)_[w]=-1;const y=Utils.newArray(d-g,0);let v=0,U=0;for(let w=0;w<g;w++){const k=t.readInt(!0);for(;v!=k;)y[U++]=v++;_[v+t.readInt(!0)]=v++}for(;v<d;)y[U++]=v++;for(let w=d-1;w>=0;w--)_[w]==-1&&(_[w]=y[--U]);u.setFrame(m,p,_)}r.push(u)}const c=t.readInt(!0);if(c>0){const u=new EventTimeline(c);for(let d=0;d<c;d++){const m=t.readFloat(),p=s.events[t.readInt(!0)],g=new Event$1(m,p);g.intValue=t.readInt(!1),g.floatValue=t.readFloat(),g.stringValue=t.readBoolean()?t.readString():p.stringValue,g.data.audioPath&&(g.volume=t.readFloat(),g.balance=t.readFloat()),u.setFrame(d,g)}r.push(u)}let o=0;for(let u=0,d=r.length;u<d;u++)o=Math.max(o,r[u].getDuration());return new Animation$2(e,r,o)}}SkeletonBinary.BlendModeValues=[BLEND_MODES.NORMAL,BLEND_MODES.ADD,BLEND_MODES.MULTIPLY,BLEND_MODES.SCREEN];let LinkedMesh$1=class{constructor(t,e,s,r,a){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=a}};class Vertices{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function readTimeline1$1(n,t,e){let s=n.readFloat(),r=n.readFloat()*e;for(let a=0,h=0,c=t.getFrameCount()-1;t.setFrame(a,s,r),a!=c;a++){const o=n.readFloat(),u=n.readFloat()*e;switch(n.readByte()){case CURVE_STEPPED:t.setStepped(a);break;case CURVE_BEZIER:setBezier(n,t,h++,a,0,s,o,r,u,e)}s=o,r=u}return t}function readTimeline2$1(n,t,e){let s=n.readFloat(),r=n.readFloat()*e,a=n.readFloat()*e;for(let h=0,c=0,o=t.getFrameCount()-1;t.setFrame(h,s,r,a),h!=o;h++){const u=n.readFloat(),d=n.readFloat()*e,m=n.readFloat()*e;switch(n.readByte()){case CURVE_STEPPED:t.setStepped(h);break;case CURVE_BEZIER:setBezier(n,t,c++,h,0,s,u,r,d,e),setBezier(n,t,c++,h,1,s,u,a,m,e)}s=u,r=d,a=m}return t}function setBezier(n,t,e,s,r,a,h,c,o,u){t.setBezier(e,s,r,a,c,n.readFloat(),n.readFloat()*u,n.readFloat(),n.readFloat()*u,h,o)}const BONE_ROTATE=0,BONE_TRANSLATE=1,BONE_TRANSLATEX=2,BONE_TRANSLATEY=3,BONE_SCALE=4,BONE_SCALEX=5,BONE_SCALEY=6,BONE_SHEAR=7,BONE_SHEARX=8,BONE_SHEARY=9,SLOT_ATTACHMENT=0,SLOT_RGBA=1,SLOT_RGB=2,SLOT_RGBA2=3,SLOT_RGB2=4,SLOT_ALPHA=5,ATTACHMENT_DEFORM=0,ATTACHMENT_SEQUENCE=1,PATH_POSITION=0,PATH_SPACING=1,PATH_MIX=2,CURVE_STEPPED=1,CURVE_BEZIER=2;class SkeletonBounds extends SkeletonBoundsBase{}class SkeletonJson{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new SkeletonData,r=typeof t=="string"?JSON.parse(t):t,a=r.skeleton;if(a){s.hash=a.hash,s.version=a.spine;const h=s.version.substr(0,3);if(h!=="4.0"&&h!=="4.1"){const c=`Spine 4.1 loader cant load version ${a.spine}. Please configure your pixi-spine bundle`;console.error(c)}s.x=a.x,s.y=a.y,s.width=a.width,s.height=a.height,s.fps=a.fps,s.imagesPath=a.images}if(r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let o=null;const u=getValue(c,"parent",null);if(u!=null&&(o=s.findBone(u),o==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData(s.bones.length,c.name,o);d.length=getValue(c,"length",0)*e,d.x=getValue(c,"x",0)*e,d.y=getValue(c,"y",0)*e,d.rotation=getValue(c,"rotation",0),d.scaleX=getValue(c,"scaleX",1),d.scaleY=getValue(c,"scaleY",1),d.shearX=getValue(c,"shearX",0),d.shearY=getValue(c,"shearY",0),d.transformMode=Utils.enumValue(TransformMode,getValue(c,"transform","Normal")),d.skinRequired=getValue(c,"skin",!1);const m=getValue(c,"color",null);m&&d.color.setFromString(m),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],o=s.findBone(c.bone);if(!o)throw new Error(`Couldn't find bone ${c.bone} for slot ${c.name}`);const u=new SlotData(s.slots.length,c.name,o),d=getValue(c,"color",null);d&&u.color.setFromString(d);const m=getValue(c,"dark",null);m&&(u.darkColor=Color.fromString(m)),u.attachmentName=getValue(c,"attachment",null),u.blendMode=SkeletonJson.blendModeFromString(getValue(c,"blend","normal")),s.slots.push(u)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],o=new IkConstraintData(c.name);o.order=getValue(c,"order",0),o.skinRequired=getValue(c,"skin",!1);for(let u=0;u<c.bones.length;u++){const d=c.bones[u],m=s.findBone(d);if(m==null)throw new Error(`IK bone not found: ${d}`);o.bones.push(m)}o.target=s.findBone(c.target),o.mix=getValue(c,"mix",1),o.softness=getValue(c,"softness",0)*e,o.bendDirection=getValue(c,"bendPositive",!0)?1:-1,o.compress=getValue(c,"compress",!1),o.stretch=getValue(c,"stretch",!1),o.uniform=getValue(c,"uniform",!1),s.ikConstraints.push(o)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],o=new TransformConstraintData(c.name);o.order=getValue(c,"order",0),o.skinRequired=getValue(c,"skin",!1);for(let m=0;m<c.bones.length;m++){const p=c.bones[m],g=s.findBone(p);if(!g)throw new Error(`Couldn't find bone ${p} for transform constraint ${c.name}.`);o.bones.push(g)}const u=c.target,d=s.findBone(u);if(!d)throw new Error(`Couldn't find target bone ${u} for transform constraint ${c.name}.`);o.target=d,o.local=getValue(c,"local",!1),o.relative=getValue(c,"relative",!1),o.offsetRotation=getValue(c,"rotation",0),o.offsetX=getValue(c,"x",0)*e,o.offsetY=getValue(c,"y",0)*e,o.offsetScaleX=getValue(c,"scaleX",0),o.offsetScaleY=getValue(c,"scaleY",0),o.offsetShearY=getValue(c,"shearY",0),o.mixRotate=getValue(c,"mixRotate",1),o.mixX=getValue(c,"mixX",1),o.mixY=getValue(c,"mixY",o.mixX),o.mixScaleX=getValue(c,"mixScaleX",1),o.mixScaleY=getValue(c,"mixScaleY",o.mixScaleX),o.mixShearY=getValue(c,"mixShearY",1),s.transformConstraints.push(o)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],o=new PathConstraintData(c.name);o.order=getValue(c,"order",0),o.skinRequired=getValue(c,"skin",!1);for(let m=0;m<c.bones.length;m++){const p=c.bones[m],g=s.findBone(p);if(!g)throw new Error(`Couldn't find bone ${p} for path constraint ${c.name}.`);o.bones.push(g)}const u=c.target,d=s.findSlot(u);if(!d)throw new Error(`Couldn't find target slot ${u} for path constraint ${c.name}.`);o.target=d,o.positionMode=Utils.enumValue(PositionMode,getValue(c,"positionMode","Percent")),o.spacingMode=Utils.enumValue(SpacingMode,getValue(c,"spacingMode","Length")),o.rotateMode=Utils.enumValue(RotateMode,getValue(c,"rotateMode","Tangent")),o.offsetRotation=getValue(c,"rotation",0),o.position=getValue(c,"position",0),o.positionMode==PositionMode.Fixed&&(o.position*=e),o.spacing=getValue(c,"spacing",0),(o.spacingMode==SpacingMode.Length||o.spacingMode==SpacingMode.Fixed)&&(o.spacing*=e),o.mixRotate=getValue(c,"mixRotate",1),o.mixX=getValue(c,"mixX",1),o.mixY=getValue(c,"mixY",o.mixX),s.pathConstraints.push(o)}if(r.skins)for(let h=0;h<r.skins.length;h++){const c=r.skins[h],o=new Skin(c.name);if(c.bones)for(let u=0;u<c.bones.length;u++){const d=c.bones[u],m=s.findBone(d);if(!m)throw new Error(`Couldn't find bone ${d} for skin ${c.name}.`);o.bones.push(m)}if(c.ik)for(let u=0;u<c.ik.length;u++){const d=c.ik[u],m=s.findIkConstraint(d);if(!m)throw new Error(`Couldn't find IK constraint ${d} for skin ${c.name}.`);o.constraints.push(m)}if(c.transform)for(let u=0;u<c.transform.length;u++){const d=c.transform[u],m=s.findTransformConstraint(d);if(!m)throw new Error(`Couldn't find transform constraint ${d} for skin ${c.name}.`);o.constraints.push(m)}if(c.path)for(let u=0;u<c.path.length;u++){const d=c.path[u],m=s.findPathConstraint(d);if(!m)throw new Error(`Couldn't find path constraint ${d} for skin ${c.name}.`);o.constraints.push(m)}for(const u in c.attachments){const d=s.findSlot(u);if(!d)throw new Error(`Couldn't find slot ${u} for skin ${c.name}.`);const m=c.attachments[u];for(const p in m){const g=this.readAttachment(m[p],o,d.index,p,s);g&&o.setAttachment(d.index,p,g)}}s.skins.push(o),o.name=="default"&&(s.defaultSkin=o)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const o=this.linkedMeshes[h],u=o.skin?s.findSkin(o.skin):s.defaultSkin;if(!u)throw new Error(`Skin not found: ${o.skin}`);const d=u.getAttachment(o.slotIndex,o.parent);if(!d)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.timelineAttachment=o.inheritTimeline?d:o.mesh,o.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],o=new EventData(h);o.intValue=getValue(c,"int",0),o.floatValue=getValue(c,"float",0),o.stringValue=getValue(c,"string",""),o.audioPath=getValue(c,"audio",null),o.audioPath&&(o.volume=getValue(c,"volume",1),o.balance=getValue(c,"balance",0)),s.events.push(o)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(t,e,s,r,a){const h=this.scale;switch(r=getValue(t,"name",r),getValue(t,"type","region")){case"region":{const c=getValue(t,"path",r),o=this.readSequence(getValue(t,"sequence",null)),u=this.attachmentLoader.newRegionAttachment(e,r,c,o);if(!u)return null;u.path=c,u.x=getValue(t,"x",0)*h,u.y=getValue(t,"y",0)*h,u.scaleX=getValue(t,"scaleX",1),u.scaleY=getValue(t,"scaleY",1),u.rotation=getValue(t,"rotation",0),u.width=t.width*h,u.height=t.height*h,u.sequence=o;const d=getValue(t,"color",null);return d&&u.color.setFromString(d),u}case"boundingbox":{const c=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!c)return null;this.readVertices(t,c,t.vertexCount<<1);const o=getValue(t,"color",null);return o&&c.color.setFromString(o),c}case"mesh":case"linkedmesh":{const c=getValue(t,"path",r),o=this.readSequence(getValue(t,"sequence",null)),u=this.attachmentLoader.newMeshAttachment(e,r,c,o);if(!u)return null;u.path=c;const d=getValue(t,"color",null);d&&u.color.setFromString(d),u.width=getValue(t,"width",0)*h,u.height=getValue(t,"height",0)*h,u.sequence=o;const m=getValue(t,"parent",null);if(m)return this.linkedMeshes.push(new LinkedMesh(u,getValue(t,"skin",null),s,m,getValue(t,"timelines",!0))),u;const p=t.uvs;return this.readVertices(t,u,p.length),u.triangles=t.triangles,u.regionUVs=new Float32Array(p),u.edges=getValue(t,"edges",null),u.hullLength=getValue(t,"hull",0)*2,u}case"path":{const c=this.attachmentLoader.newPathAttachment(e,r);if(!c)return null;c.closed=getValue(t,"closed",!1),c.constantSpeed=getValue(t,"constantSpeed",!0);const o=t.vertexCount;this.readVertices(t,c,o<<1);const u=Utils.newArray(o/3,0);for(let m=0;m<t.lengths.length;m++)u[m]=t.lengths[m]*h;c.lengths=u;const d=getValue(t,"color",null);return d&&c.color.setFromString(d),c}case"point":{const c=this.attachmentLoader.newPointAttachment(e,r);if(!c)return null;c.x=getValue(t,"x",0)*h,c.y=getValue(t,"y",0)*h,c.rotation=getValue(t,"rotation",0);const o=getValue(t,"color",null);return o&&c.color.setFromString(o),c}case"clipping":{const c=this.attachmentLoader.newClippingAttachment(e,r);if(!c)return null;const o=getValue(t,"end",null);if(o!=null){const m=a.findSlot(o);if(m==null)throw new Error(`Clipping end slot not found: ${o}`);c.endSlot=m}const u=t.vertexCount;this.readVertices(t,c,u<<1);const d=getValue(t,"color",null);return d&&c.color.setFromString(d),c}}return null}readSequence(t){if(t==null)return null;const e=new Sequence$1(getValue(t,"count",0));return e.start=getValue(t,"start",1),e.digits=getValue(t,"digits",0),e.setupIndex=getValue(t,"setup",0),e}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const a=t.vertices;if(s==a.length){const o=Utils.toFloatArray(a);if(r!=1)for(let u=0,d=a.length;u<d;u++)o[u]*=r;e.vertices=o;return}const h=new Array,c=new Array;for(let o=0,u=a.length;o<u;){const d=a[o++];c.push(d);for(let m=o+d*4;o<m;o+=4)c.push(a[o]),h.push(a[o+1]*r),h.push(a[o+2]*r),h.push(a[o+3])}e.bones=c,e.vertices=Utils.toFloatArray(h)}readAnimation(t,e,s){const r=this.scale,a=new Array;if(t.slots)for(const c in t.slots){const o=t.slots[c],u=s.findSlot(c);if(!u)throw new Error(`Slot not found: ${c}`);const d=u.index;for(const m in o){const p=o[m];if(!p)continue;const g=p.length;if(m=="attachment"){const _=new AttachmentTimeline(g,d);for(let y=0;y<g;y++){const v=p[y];_.setFrame(y,getValue(v,"time",0),getValue(v,"name",null))}a.push(_)}else if(m=="rgba"){const _=new RGBATimeline(g,g<<2,d);let y=p[0],v=getValue(y,"time",0),U=Color.fromString(y.color);for(let w=0,k=0;;w++){_.setFrame(w,v,U.r,U.g,U.b,U.a);const N=p[w+1];if(!N){_.shrink(k);break}const W=getValue(N,"time",0),et=Color.fromString(N.color),it=y.curve;it&&(k=readCurve(it,_,k,w,0,v,W,U.r,et.r,1),k=readCurve(it,_,k,w,1,v,W,U.g,et.g,1),k=readCurve(it,_,k,w,2,v,W,U.b,et.b,1),k=readCurve(it,_,k,w,3,v,W,U.a,et.a,1)),v=W,U=et,y=N}a.push(_)}else if(m=="rgb"){const _=new RGBTimeline(g,g*3,d);let y=p[0],v=getValue(y,"time",0),U=Color.fromString(y.color);for(let w=0,k=0;;w++){_.setFrame(w,v,U.r,U.g,U.b);const N=p[w+1];if(!N){_.shrink(k);break}const W=getValue(N,"time",0),et=Color.fromString(N.color),it=y.curve;it&&(k=readCurve(it,_,k,w,0,v,W,U.r,et.r,1),k=readCurve(it,_,k,w,1,v,W,U.g,et.g,1),k=readCurve(it,_,k,w,2,v,W,U.b,et.b,1)),v=W,U=et,y=N}a.push(_)}else if(m=="alpha")a.push(readTimeline1(p,new AlphaTimeline(g,g,d),0,1));else if(m=="rgba2"){const _=new RGBA2Timeline(g,g*7,d);let y=p[0],v=getValue(y,"time",0),U=Color.fromString(y.light),w=Color.fromString(y.dark);for(let k=0,N=0;;k++){_.setFrame(k,v,U.r,U.g,U.b,U.a,w.r,w.g,w.b);const W=p[k+1];if(!W){_.shrink(N);break}const et=getValue(W,"time",0),it=Color.fromString(W.light),ft=Color.fromString(W.dark),mt=y.curve;mt&&(N=readCurve(mt,_,N,k,0,v,et,U.r,it.r,1),N=readCurve(mt,_,N,k,1,v,et,U.g,it.g,1),N=readCurve(mt,_,N,k,2,v,et,U.b,it.b,1),N=readCurve(mt,_,N,k,3,v,et,U.a,it.a,1),N=readCurve(mt,_,N,k,4,v,et,w.r,ft.r,1),N=readCurve(mt,_,N,k,5,v,et,w.g,ft.g,1),N=readCurve(mt,_,N,k,6,v,et,w.b,ft.b,1)),v=et,U=it,w=ft,y=W}a.push(_)}else if(m=="rgb2"){const _=new RGB2Timeline(g,g*6,d);let y=p[0],v=getValue(y,"time",0),U=Color.fromString(y.light),w=Color.fromString(y.dark);for(let k=0,N=0;;k++){_.setFrame(k,v,U.r,U.g,U.b,w.r,w.g,w.b);const W=p[k+1];if(!W){_.shrink(N);break}const et=getValue(W,"time",0),it=Color.fromString(W.light),ft=Color.fromString(W.dark),mt=y.curve;mt&&(N=readCurve(mt,_,N,k,0,v,et,U.r,it.r,1),N=readCurve(mt,_,N,k,1,v,et,U.g,it.g,1),N=readCurve(mt,_,N,k,2,v,et,U.b,it.b,1),N=readCurve(mt,_,N,k,3,v,et,w.r,ft.r,1),N=readCurve(mt,_,N,k,4,v,et,w.g,ft.g,1),N=readCurve(mt,_,N,k,5,v,et,w.b,ft.b,1)),v=et,U=it,w=ft,y=W}a.push(_)}}}if(t.bones)for(const c in t.bones){const o=t.bones[c],u=s.findBone(c);if(!u)throw new Error(`Bone not found: ${c}`);const d=u.index;for(const m in o){const p=o[m],g=p.length;if(g!=0){if(m==="rotate")a.push(readTimeline1(p,new RotateTimeline(g,g,d),0,1));else if(m==="translate"){const _=new TranslateTimeline(g,g<<1,d);a.push(readTimeline2(p,_,"x","y",0,r))}else if(m==="translatex"){const _=new TranslateXTimeline(g,g,d);a.push(readTimeline1(p,_,0,r))}else if(m==="translatey"){const _=new TranslateYTimeline(g,g,d);a.push(readTimeline1(p,_,0,r))}else if(m==="scale"){const _=new ScaleTimeline(g,g<<1,d);a.push(readTimeline2(p,_,"x","y",1,1))}else if(m==="scalex"){const _=new ScaleXTimeline(g,g,d);a.push(readTimeline1(p,_,1,1))}else if(m==="scaley"){const _=new ScaleYTimeline(g,g,d);a.push(readTimeline1(p,_,1,1))}else if(m==="shear"){const _=new ShearTimeline(g,g<<1,d);a.push(readTimeline2(p,_,"x","y",0,1))}else if(m==="shearx"){const _=new ShearXTimeline(g,g,d);a.push(readTimeline1(p,_,0,1))}else if(m==="sheary"){const _=new ShearYTimeline(g,g,d);a.push(readTimeline1(p,_,0,1))}}}}if(t.ik)for(const c in t.ik){const o=t.ik[c];let u=o[0];if(!u)continue;const d=s.findIkConstraint(c);if(!d)throw new Error(`IK Constraint not found: ${c}`);const m=s.ikConstraints.indexOf(d),p=new IkConstraintTimeline(o.length,o.length<<1,m);let g=getValue(u,"time",0),_=getValue(u,"mix",1),y=getValue(u,"softness",0)*r;for(let v=0,U=0;;v++){p.setFrame(v,g,_,y,getValue(u,"bendPositive",!0)?1:-1,getValue(u,"compress",!1),getValue(u,"stretch",!1));const w=o[v+1];if(!w){p.shrink(U);break}const k=getValue(w,"time",0),N=getValue(w,"mix",1),W=getValue(w,"softness",0)*r,et=u.curve;et&&(U=readCurve(et,p,U,v,0,g,k,_,N,1),U=readCurve(et,p,U,v,1,g,k,y,W,r)),g=k,_=N,y=W,u=w}a.push(p)}if(t.transform)for(const c in t.transform){const o=t.transform[c];let u=o[0];if(!u)continue;const d=s.findTransformConstraint(c);if(!d)throw new Error(`Transform constraint not found: ${c}`);const m=s.transformConstraints.indexOf(d),p=new TransformConstraintTimeline(o.length,o.length*6,m);let g=getValue(u,"time",0),_=getValue(u,"mixRotate",1),y=getValue(u,"mixX",1),v=getValue(u,"mixY",y),U=getValue(u,"mixScaleX",1),w=getValue(u,"mixScaleY",U);const k=getValue(u,"mixShearY",1);for(let N=0,W=0;;N++){p.setFrame(N,g,_,y,v,U,w,k);const et=o[N+1];if(!et){p.shrink(W);break}const it=getValue(et,"time",0),ft=getValue(et,"mixRotate",1),mt=getValue(et,"mixX",1),xt=getValue(et,"mixY",mt),yt=getValue(et,"mixScaleX",1),vt=getValue(et,"mixScaleY",yt),St=getValue(et,"mixShearY",1),wt=u.curve;wt&&(W=readCurve(wt,p,W,N,0,g,it,_,ft,1),W=readCurve(wt,p,W,N,1,g,it,y,mt,1),W=readCurve(wt,p,W,N,2,g,it,v,xt,1),W=readCurve(wt,p,W,N,3,g,it,U,yt,1),W=readCurve(wt,p,W,N,4,g,it,w,vt,1),W=readCurve(wt,p,W,N,5,g,it,k,St,1)),g=it,_=ft,y=mt,v=xt,U=yt,w=vt,U=yt,u=et}a.push(p)}if(t.path)for(const c in t.path){const o=t.path[c],u=s.findPathConstraint(c);if(!u)throw new Error(`Path constraint not found: ${c}`);const d=s.pathConstraints.indexOf(u);for(const m in o){const p=o[m];let g=p[0];if(!g)continue;const _=p.length;if(m==="position"){const y=new PathConstraintPositionTimeline(_,_,d);a.push(readTimeline1(p,y,0,u.positionMode==PositionMode.Fixed?r:1))}else if(m==="spacing"){const y=new PathConstraintSpacingTimeline(_,_,d);a.push(readTimeline1(p,y,0,u.spacingMode==SpacingMode.Length||u.spacingMode==SpacingMode.Fixed?r:1))}else if(m==="mix"){const y=new PathConstraintMixTimeline(_,_*3,d);let v=getValue(g,"time",0),U=getValue(g,"mixRotate",1),w=getValue(g,"mixX",1),k=getValue(g,"mixY",w);for(let N=0,W=0;;N++){y.setFrame(N,v,U,w,k);const et=p[N+1];if(!et){y.shrink(W);break}const it=getValue(et,"time",0),ft=getValue(et,"mixRotate",1),mt=getValue(et,"mixX",1),xt=getValue(et,"mixY",mt),yt=g.curve;yt&&(W=readCurve(yt,y,W,N,0,v,it,U,ft,1),W=readCurve(yt,y,W,N,1,v,it,w,mt,1),W=readCurve(yt,y,W,N,2,v,it,k,xt,1)),v=it,U=ft,w=mt,k=xt,g=et}a.push(y)}}}if(t.deform){t.attachments={};for(const c in t.deform){const o=t.deform[c],u=t.attachments[c]={};for(const d in o){const m=o[d],p=u[d]={};for(const g in m)p[g]={deform:m[g]}}}}if(t.attachments)for(const c in t.attachments){const o=t.attachments[c],u=s.findSkin(c);if(u!=null)for(const d in o){const m=o[d],p=s.findSlot(d);if(!p)throw new Error(`Slot not found: ${d}`);const g=p.index;for(const _ in m){const y=m[_],v=u.getAttachment(g,_);for(const U in y){const w=y[U];let k=w[0];if(k){if(U=="deform"){const N=v.bones,W=v.vertices,et=N?W.length/3*2:W.length,it=new DeformTimeline(w.length,w.length,g,v);let ft=getValue(k,"time",0);for(let mt=0,xt=0;;mt++){let yt;const vt=getValue(k,"vertices",null);if(!vt)yt=N?Utils.newFloatArray(et):W;else{yt=Utils.newFloatArray(et);const It=getValue(k,"offset",0);if(Utils.arrayCopy(vt,0,yt,It,vt.length),r!=1)for(let Pt=It,Xt=Pt+vt.length;Pt<Xt;Pt++)yt[Pt]*=r;if(!N)for(let Pt=0;Pt<et;Pt++)yt[Pt]+=W[Pt]}it.setFrame(mt,ft,yt);const St=w[mt+1];if(!St){it.shrink(xt);break}const wt=getValue(St,"time",0),Ct=k.curve;Ct&&(xt=readCurve(Ct,it,xt,mt,0,ft,wt,0,1,1)),ft=wt,k=St}a.push(it)}else if(U=="sequence"){const N=new SequenceTimeline(w.length,g,v);let W=0;for(let et=0;et<w.length;et++){const it=getValue(k,"delay",W),ft=getValue(k,"time",0),mt=SequenceMode[getValue(k,"mode","hold")],xt=getValue(k,"index",0);N.setFrame(et,ft,mt,xt,it),W=it,k=w[et+1]}a.push(N)}}}}}}if(t.drawOrder){const c=new DrawOrderTimeline(t.drawOrder.length),o=s.slots.length;let u=0;for(let d=0;d<t.drawOrder.length;d++,u++){const m=t.drawOrder[d];let p=null;const g=getValue(m,"offsets",null);if(g){p=Utils.newArray(o,-1);const _=Utils.newArray(o-g.length,0);let y=0,v=0;for(let U=0;U<g.length;U++){const w=g[U],k=s.findSlot(w.slot);if(!k)throw new Error(`Slot not found: ${k}`);const N=k.index;for(;y!=N;)_[v++]=y++;p[y+w.offset]=y++}for(;y<o;)_[v++]=y++;for(let U=o-1;U>=0;U--)p[U]==-1&&(p[U]=_[--v])}c.setFrame(u,getValue(m,"time",0),p)}a.push(c)}if(t.events){const c=new EventTimeline(t.events.length);let o=0;for(let u=0;u<t.events.length;u++,o++){const d=t.events[u],m=s.findEvent(d.name);if(!m)throw new Error(`Event not found: ${d.name}`);const p=new Event$1(Utils.toSinglePrecision(getValue(d,"time",0)),m);p.intValue=getValue(d,"int",m.intValue),p.floatValue=getValue(d,"float",m.floatValue),p.stringValue=getValue(d,"string",m.stringValue),p.data.audioPath&&(p.volume=getValue(d,"volume",1),p.balance=getValue(d,"balance",0)),c.setFrame(o,p)}a.push(c)}let h=0;for(let c=0,o=a.length;c<o;c++)h=Math.max(h,a[c].getDuration());if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$2(e,a,h))}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return BLEND_MODES.NORMAL;if(t=="additive")return BLEND_MODES.ADD;if(t=="multiply")return BLEND_MODES.MULTIPLY;if(t=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class LinkedMesh{constructor(t,e,s,r,a){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=a}}function readTimeline1(n,t,e,s){let r=n[0],a=getValue(r,"time",0),h=getValue(r,"value",e)*s,c=0;for(let o=0;;o++){t.setFrame(o,a,h);const u=n[o+1];if(!u)return t.shrink(c),t;const d=getValue(u,"time",0),m=getValue(u,"value",e)*s;r.curve&&(c=readCurve(r.curve,t,c,o,0,a,d,h,m,s)),a=d,h=m,r=u}}function readTimeline2(n,t,e,s,r,a){let h=n[0],c=getValue(h,"time",0),o=getValue(h,e,r)*a,u=getValue(h,s,r)*a,d=0;for(let m=0;;m++){t.setFrame(m,c,o,u);const p=n[m+1];if(!p)return t.shrink(d),t;const g=getValue(p,"time",0),_=getValue(p,e,r)*a,y=getValue(p,s,r)*a,v=h.curve;v&&(d=readCurve(v,t,d,m,0,c,g,o,_,a),d=readCurve(v,t,d,m,1,c,g,u,y,a)),c=g,o=_,u=y,h=p}}function readCurve(n,t,e,s,r,a,h,c,o,u){if(n=="stepped")return t.setStepped(s),e;const d=r<<2,m=n[d],p=n[d+1]*u,g=n[d+2],_=n[d+3]*u;return t.setBezier(e,s,r,a,c,m,p,g,_,h,o),e+1}function getValue(n,t,e){return n[t]!==void 0?n[t]:e}let Spine$1=class extends SpineBase{createSkeleton(t){this.skeleton=new Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new AnimationStateData(t),this.state=new AnimationState(this.stateData)}};const spine41=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline,Animation:Animation$2,AnimationState,AnimationStateAdapter,AnimationStateData,AtlasAttachmentLoader,Attachment,AttachmentTimeline,Bone,BoneData,BoundingBoxAttachment,ClippingAttachment,ConstraintData,CurveTimeline,CurveTimeline1,CurveTimeline2,DeformTimeline,DrawOrderTimeline,Event:Event$1,EventData,EventQueue,EventTimeline,EventType,IkConstraint,IkConstraintData,IkConstraintTimeline,MeshAttachment,PathAttachment,PathConstraint,PathConstraintData,PathConstraintMixTimeline,PathConstraintPositionTimeline,PathConstraintSpacingTimeline,PointAttachment,RGB2Timeline,RGBA2Timeline,RGBATimeline,RGBTimeline,RegionAttachment,RotateTimeline,ScaleTimeline,ScaleXTimeline,ScaleYTimeline,Sequence:Sequence$1,SequenceMode,SequenceModeValues,SequenceTimeline,ShearTimeline,ShearXTimeline,ShearYTimeline,Skeleton,SkeletonBinary,SkeletonBounds,SkeletonData,SkeletonJson,Skin,SkinEntry,Slot,SlotData,SpacingMode,Spine:Spine$1,Timeline:Timeline$1,TrackEntry,TransformConstraint,TransformConstraintData,TransformConstraintTimeline,TranslateTimeline,TranslateXTimeline,TranslateYTimeline,VertexAttachment},Symbol.toStringTag,{value:"Module"}));var SPINE_VERSION=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.VER37=37]="VER37",n[n.VER38=38]="VER38",n[n.VER40=40]="VER40",n[n.VER41=41]="VER41",n))(SPINE_VERSION||{});function detectSpineVersion(n){const t=n.substr(0,3),e=Math.floor(Number(t)*10+.001);return t==="3.7"?37:t==="3.8"?38:t==="4.0"?40:t==="4.1"?41:e<37?37:0}class UniBinaryParser{constructor(){this.scale=1}readSkeletonData(t,e){let s=null,r=this.readVersionOldFormat(e),a=detectSpineVersion(r);if(a===SPINE_VERSION.VER38&&(s=new SkeletonBinary$1(new AtlasAttachmentLoader$2(t))),r=this.readVersionNewFormat(e),a=detectSpineVersion(r),(a===SPINE_VERSION.VER40||a===SPINE_VERSION.VER41)&&(s=new SkeletonBinary(new AtlasAttachmentLoader(t))),!s){const h=`Unsupported version of spine model ${r}, please update pixi-spine`;console.error(h)}return s.scale=this.scale,s.readSkeletonData(e)}readVersionOldFormat(t){const e=new BinaryInput(t);let s;try{e.readString(),s=e.readString()}catch{s=""}return s||""}readVersionNewFormat(t){const e=new BinaryInput(t);e.readInt32(),e.readInt32();let s;try{s=e.readString()}catch{s=""}return s||""}}class UniJsonParser{constructor(){this.scale=1}readSkeletonData(t,e){const s=e.skeleton.spine,r=detectSpineVersion(s);let a=null;if(r===SPINE_VERSION.VER37&&(a=new SkeletonJson$1(new AtlasAttachmentLoader$1(t))),r===SPINE_VERSION.VER38&&(a=new SkeletonJson$2(new AtlasAttachmentLoader$2(t))),(r===SPINE_VERSION.VER40||r===SPINE_VERSION.VER41)&&(a=new SkeletonJson(new AtlasAttachmentLoader(t))),!a){const h=`Unsupported version of spine model ${s}, please update pixi-spine`;console.error(h)}return a.scale=this.scale,a.readSkeletonData(e)}}class SpineLoader extends SpineLoaderAbstract{createBinaryParser(){return new UniBinaryParser}createJsonParser(){return new UniJsonParser}parseData(t,e,s){return{spineData:t.readSkeletonData(e,s),spineAtlas:e}}}class Spine extends SpineBase{createSkeleton(t){const e=detectSpineVersion(t.version);let s=null;if(e===SPINE_VERSION.VER37&&(s=spine37),e===SPINE_VERSION.VER38&&(s=spine38),(e===SPINE_VERSION.VER40||e===SPINE_VERSION.VER41)&&(s=spine41),!s){const r=`Cant detect version of spine model ${t.version}`;console.error(r)}this.skeleton=new s.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new s.AnimationStateData(t),this.state=new s.AnimationState(this.stateData)}}new SpineLoader().installLoader();const ACTIVE="active",ANIMATED="animated",ANIMATION_DURATION=250,ARIA_LABEL="aria-label",BLOCK="block",CLICK="click",CLOSE="close",CLOSE_TITLE="Close",DATA_HIDE="data-pop-up-hide",DATA_SHOW="data-pop-up-show",EMPTY_STRING="",ENTER="enter",ESCAPE="escape",FALSE="false",FOCUSIN="focusin",FUNCTION="function",HIDDEN="hidden",KEYDOWN="keydown",MODAL_LABEL_FALLBACK="modal",NONE="none",PREFERS_REDUCED_MOTION="(prefers-reduced-motion: reduce)",SPACE=" ",SPACE_REGEX=/\s+/g,STATIC="static",TAB="tab",TEMPLATE="template",TRUE="true",FOCUSABLE_SELECTORS=["[contenteditable]",'[tabindex="0"]:not([disabled])',"a[href]","audio[controls]","button:not([disabled])","iframe","input:not([disabled]):not([type='hidden'])","select:not([disabled])","summary","textarea:not([disabled])","video[controls]"].join(","),STYLE=`
      <style>
        *,
        *:after,
        *:before {
          box-sizing: border-box;
          margin: 0;
          padding: 0;
        }
  
        @media ${PREFERS_REDUCED_MOTION} {
          *,
          *:after,
          *:before {
            animation: none !important;
            transition: none !important;
          }
        }
  
        @keyframes SHOW-OVERLAY {
          0% {
            opacity: 0;
          }
  
          100% {
            opacity: 1;
          }
        }
  
        @keyframes SHOW-DIALOG {
          0% {
            transform: scale(0.95);
          }
  
          100% {
            transform: scale(1);
          }
        }
  
        @keyframes HIDE-OVERLAY {
          0% {
            opacity: 1;
          }
  
          100% {
            opacity: 0;
          }
        }
  
        @keyframes HIDE-DIALOG {
          0% {
            transform: scale(1);
          }
  
          100% {
            transform: scale(0.95);
          }
        }
  
        .pop-up__focus-trap {
          opacity: 0;
          overflow: hidden;
          width: 0;
          height: 0;
          position: fixed;
          top: 0;
          left: 0;
        }
  
        .pop-up__scroll {
            overflow-x: hidden;
            overflow-y: auto;
            z-index: var(--pop-up-overlay-z-index, 100000);
            width: var(--pop-up-overlay-width, 100%);
            height: var(--pop-up-overlay-height, 100%);
            position: var(--pop-up-overlay-position, fixed);
            top: var(--pop-up-overlay-top, 0px);
            right: var(--pop-up-overlay-right, 0px);
            left: var(--pop-up-overlay-left, 0px);
            border-radius: var(--pop-up-overlay-border-radius, 0px);
        }
  
        .pop-up__overlay {
            background-color: var(--pop-up-overlay-background-color, rgba(0, 0, 0, 0.5));
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: 100%;
            padding-top: var(--cta-modal-overlay-padding-top, 20px);
            padding-left: var(--cta-modal-overlay-padding-left, 20px);
            padding-right: var(--cta-modal-overlay-padding-right, 20px);
            padding-bottom: var(--cta-modal-overlay-padding-bottom, 20px);
        }
  
        .pop-up__dialog {
            background-color: var(--pop-up-dialog-background-color, #fff);
            color: var(--pop-up-dialog-color, #fff);
            border-radius: var(--pop-up-dialog-border-radius, 5px);
            box-shadow: var(--pop-up-dialog-box-shadow, 0 2px 5px 0 rgba(0, 0, 0, 0.5));
            padding-top: var(--pop-up-dialog-padding-top, 20px);
            padding-left: var(--pop-up-dialog-padding-left, 20px);
            padding-right: var(--pop-up-dialog-padding-right, 20px);
            padding-bottom: var(--pop-up-dialog-padding-bottom, 20px);
            width: var(--pop-up-dialog-width, 500px);
            max-width: 100%;
            height: var(--pop-up-dialog-height, none);
            position: var(--pop-up-dialog-position, relative);
        }
  
        [${DATA_SHOW}='true'] .pop-up__overlay {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: SHOW-OVERLAY;
        }
  
        [${DATA_SHOW}='true'] .pop-up__dialog {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: SHOW-DIALOG;
        }
  
        [${DATA_HIDE}='true'] .pop-up__overlay {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: HIDE-OVERLAY;
          opacity: 0;
        }
  
        [${DATA_HIDE}='true'] .pop-up__dialog {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: HIDE-DIALOG;
          transform: scale(0.95);
        }
  
        .pop-up__close {
          appearance: none;
          touch-action: none;
          user-select: none;
  
          border: 0;
          padding: 0;
  
          color: var(--pop-up-close-color, #fff);
          background-color: var(--pop-up-close-background-color, #000);
          border-radius: var(--pop-up-close-border-radius, 50%);
          box-shadow: var(--pop-up-close-box-shadow, 0 0 0 1px #fff);
          display: var(--pop-up-close-display, block);
  
          cursor: pointer;
          font-size: var(--pop-up-close-font-size, 23px);
          text-align: center;
  
          line-height: var(--pop-up-close-line-height, 26px);
          width: var(--pop-up-close-width, 26px);
  
          transform: translate(40%, -40%);
          position: absolute;
          top: var(--pop-up-close-line-top, 0px);
          right: var(--pop-up-close-line-right, 0px);
        }
  
        .pop-up__close:hover {
          color: var(--pop-up-close-color-hover, #000);
          background-color: var(--pop-up-close-background-color-hover, #fff);
          box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
        }
  
        @supports selector(:focus-visible) {
          .pop-up__close:focus-visible {
            color: var(--pop-up-close-color-hover, #000);
            background-color: var(--pop-up-close-background-color-hover, #fff);
            box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
          }
        }
  
        @supports not selector(:focus-visible) {
          .pop-up__close:focus {
            color: var(--pop-up-close-color-hover, #000);
            background-color: var(--pop-up-close-background-color-hover, #fff);
            box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
          }
        }
      </style>
    `,FOCUS_TRAP=`
      <span
        aria-hidden='true'
        class='cta-modal__focus-trap'
        tabindex='0'
      ></span>
    `,MODAL=`
      <slot name='button'></slot>
  
      <div class='pop-up__scroll' style='display:none'>
      ${FOCUS_TRAP}
        <div class='pop-up__overlay'>
          <div
            aria-modal='true'
            class='pop-up__dialog'
            role='dialog'
            tabindex='-1'
          >
            <button
              class='pop-up__close'
              type='button'
            >&times;</button>
  
            <slot name='modal'></slot>
          </div>
        </div>
        ${FOCUS_TRAP}
      </div>
    `,markup=[STYLE,MODAL].join(EMPTY_STRING).trim().replace(SPACE_REGEX,SPACE),template=document.createElement(TEMPLATE);template.innerHTML=markup;class PopUp extends HTMLElement{constructor(){super();gt(this,"_buttonClose");gt(this,"_heading");gt(this,"_modal");gt(this,"_modalOverlay");gt(this,"_modalScroll");gt(this,"_shadow");gt(this,"_slotForButton");gt(this,"_slotForModal");gt(this,"_activeElement",null);gt(this,"_focusTrapList");gt(this,"_isActive",!1);gt(this,"_isAnimated",!0);gt(this,"_isHideShow",!1);gt(this,"_isStatic",!1);gt(this,"_timerForHide");gt(this,"_timerForShow");this._bind(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.append(template.content.cloneNode(!0)),this._slotForButton=this.querySelector("[slot='button']"),this._slotForModal=this.querySelector("[slot='modal']"),this._heading=this.querySelector("h1, h2, h3, h4, h5, h6"),this._buttonClose=this._shadow.querySelector(".pop-up__close"),this._focusTrapList=this._shadow.querySelectorAll(".pop-up__focus-trap"),this._modal=this._shadow.querySelector(".pop-up__dialog"),this._modalOverlay=this._shadow.querySelector(".pop-up__overlay"),this._modalScroll=this._shadow.querySelector(".pop-up__scroll"),this._slotForModal||window.console.error('Required [slot="modal"] not found inside pop-up.'),this._setAnimationFlag(),this._setCloseTitle(),this._setModalLabel(),this._setStaticFlag(),this._setActiveFlag()}static get observedAttributes(){return[ACTIVE,ANIMATED,CLOSE,STATIC]}attributeChangedCallback(e,s,r){s!==r&&(e===ACTIVE&&this._setActiveFlag(),e===ANIMATED&&this._setAnimationFlag(),e===CLOSE&&this._setCloseTitle(),e===STATIC&&this._setStaticFlag())}connectedCallback(){this._addEvents()}disconnectedCallback(){this._removeEvents()}_bind(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).forEach(s=>{typeof this[s]===FUNCTION&&(this[s]=this[s].bind(this))})}_addEvents(){this._removeEvents(),document.addEventListener(FOCUSIN,this._handleFocusIn),document.addEventListener(KEYDOWN,this._handleKeyDown),this._buttonClose.addEventListener(CLICK,this._handleClickToggle),this._modalOverlay.addEventListener(CLICK,this._handleClickOverlay),this._slotForButton&&(this._slotForButton.addEventListener(CLICK,this._handleClickToggle),this._slotForButton.addEventListener(KEYDOWN,this._handleClickToggle)),this._slotForModal&&(this._slotForModal.addEventListener(CLICK,this._handleClickToggle),this._slotForModal.addEventListener(KEYDOWN,this._handleClickToggle))}_removeEvents(){document.removeEventListener(FOCUSIN,this._handleFocusIn),document.removeEventListener(KEYDOWN,this._handleKeyDown),this._buttonClose.removeEventListener(CLICK,this._handleClickToggle),this._modalOverlay.removeEventListener(CLICK,this._handleClickOverlay),this._slotForButton&&(this._slotForButton.removeEventListener(CLICK,this._handleClickToggle),this._slotForButton.removeEventListener(KEYDOWN,this._handleClickToggle)),this._slotForModal&&(this._slotForModal.removeEventListener(CLICK,this._handleClickToggle),this._slotForModal.removeEventListener(KEYDOWN,this._handleClickToggle))}_setAnimationFlag(){this._isAnimated=this.getAttribute(ANIMATED)!==FALSE}_setCloseTitle(){const e=this.getAttribute(CLOSE)||CLOSE_TITLE;this._buttonClose.title=e,this._buttonClose.setAttribute(ARIA_LABEL,e)}_setModalLabel(){let e=MODAL_LABEL_FALLBACK;this._heading&&(e=this._heading.textContent||e,e=e.trim().replace(SPACE_REGEX,SPACE)),this._modal.setAttribute(ARIA_LABEL,e)}_setActiveFlag(){const e=this.getAttribute(ACTIVE)===TRUE;this._isActive=e,this._toggleModalDisplay(()=>{this._isActive&&this._focusModal()})}_setStaticFlag(){this._isStatic=this.getAttribute(STATIC)===TRUE}_focusElement(e){window.requestAnimationFrame(()=>{typeof e.focus===FUNCTION&&e.focus()})}_focusModal(){window.requestAnimationFrame(()=>{this._modalScroll.scrollTo(0,0)})}_isOutsideModal(e){return!this._isActive||!e?!1:!(this.contains(e)||this._modal.contains(e))}_isMotionOkay(){const{matches:e}=window.matchMedia(PREFERS_REDUCED_MOTION);return this._isAnimated&&!e}_toggleModalDisplay(e){this.setAttribute(ACTIVE,this._isActive);const s=this._modalScroll.style.display===BLOCK,r=this._isMotionOkay(),a=r?ANIMATION_DURATION:0,h=window.innerWidth-document.documentElement.clientWidth,c=document.activeElement;this._isActive&&c&&(this._activeElement=c),this._isActive?(this._modalScroll.style.display=BLOCK,document.documentElement.style.overflow=HIDDEN,h&&(document.documentElement.style.paddingRight=`${h}px`),r&&(this._isHideShow=!0,this._modalScroll.setAttribute(DATA_SHOW,TRUE)),e(),this._timerForShow=window.setTimeout(()=>{clearTimeout(this._timerForShow),this._isHideShow=!1,this._modalScroll.removeAttribute(DATA_SHOW)},a)):s&&(r&&(this._isHideShow=!0,this._modalScroll.setAttribute(DATA_HIDE,TRUE)),e(),this._timerForHide=window.setTimeout(()=>{clearTimeout(this._timerForHide),this._isHideShow=!1,this._modalScroll.removeAttribute(DATA_HIDE),this._modalScroll.style.display=NONE,document.documentElement.style.overflow=EMPTY_STRING,document.documentElement.style.paddingRight=EMPTY_STRING},a))}_handleClickOverlay(e){if(this._isHideShow||this._isStatic)return;e.target.classList.contains("pop-up__overlay")&&this._handleClickToggle()}_handleClickToggle(e){let s=EMPTY_STRING,r=null;e&&(e.target&&(r=e.target),e.key&&(s=e.key,s=s.toLowerCase()));let a;r&&(r.classList.contains("pop-up__close")?a=r:typeof r.closest===FUNCTION&&(a=r.closest(".pop-up-toggle")));const h=e&&typeof e.preventDefault===FUNCTION,c=a&&h&&!s,o=a&&h&&[ENTER,SPACE].includes(s);a&&a.disabled||h&&!a||s&&!o||((o||c)&&e.preventDefault(),this._isActive=!this._isActive,this._toggleModalDisplay(()=>{this._isActive?this._focusModal():this._activeElement&&this._focusElement(this._activeElement)}))}_handleFocusIn(){if(!this._isActive)return;const e=this._shadow.activeElement||document.activeElement,s=e===this._focusTrapList[0],r=e===this._focusTrapList[1];let a=[];this._slotForModal&&(a=Array.from(this._slotForModal.querySelectorAll(FOCUSABLE_SELECTORS)));const c=Array.from(this._modal.querySelectorAll(FOCUSABLE_SELECTORS)).concat(a),o=c[0],u=c[c.length-1];s&&u?this._focusElement(u):r&&o?this._focusElement(o):this._isOutsideModal(e)&&this._focusModal()}_handleKeyDown({key:e}){this._isActive&&(e=e.toLowerCase(),e===ESCAPE&&!this._isHideShow&&!this._isStatic&&this._handleClickToggle(),e===TAB&&this._handleFocusIn())}}window.addEventListener("DOMContentLoaded",()=>{window.customElements.define("pop-up",PopUp)});class Arrow extends HTMLElement{connectedCallback(){this.innerHTML=`
        <svg width="9" height="14" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.5 13L7.5 7L1.5 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `}}customElements.define("arrow-element",Arrow);var be,ve;class TabPanel extends HTMLElement{constructor(){super();Se(this,be,0);Se(this,ve,"row");gt(this,"dom");gt(this,"shadow");this.bind(this)}bind(e){e.render=e.render.bind(e),e.attachEvents=e.attachEvents.bind(e),e.cacheDom=e.cacheDom.bind(e),e.onTabClick=e.onTabClick.bind(e),e.selectTabByIndex=e.selectTabByIndex.bind(e),e.onContentSlotChange=e.onContentSlotChange.bind(e),e.onTabSlotChange=e.onTabSlotChange.bind(e)}connectedCallback(){var e,s;this.render(),this.cacheDom(),this.attachEvents(),(e=this.dom.tabs[Te(this,be)])==null||e.classList.add("selected"),(s=this.dom.contents[Te(this,be)])==null||s.classList.add("selected")}render(){this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
                <style>
                    @keyframes SHOW-PANEL {
                        0% { opacity: 0;}
                        100% { opacity: 1;}
                    }

                    :host { 
                        display: grid;
                        grid-template-rows: 1fr 5fr;
                        gap: var(--tabs-gap, 0px); 
                        height: var(--tabs-height, 100%);
                    }
                    :host([direction="column"]) { 
                        grid-template-columns: 1fr 2fr;
                        grid-template-rows: none;
                    }
                    :host([direction="column"]) .tabs { 
                        display: grid;
                        grid-template-columns: 1fr;
                        height: 100%;
                        width: var(--tab-width, 10rem); 
                    }
                    .tabs { 
                        display: flex; 
                        flex-direction: row; 
                        flex-wrap: nowrap; 
                        gap: var(--tab-gap, 0px); 
                        height: 5rem;
                        overflow: auto;
                    }
                    .tabs ::slotted(*) { 
                        cursor: pointer; 
                        padding: var(--tab-padding, 0.5rem); 
                        user-select: none;  
                        font-size: 1.6rem;
                    }
                    .tabs ::slotted(.selected) { 
                        background: var(--tab-selected, #efefef23); 
                        border-radius: var(--tab-border-radius, 0px);
                        border-bottom: var(--tab-border-border-bottom, none);
                    }
                    .tab-contents {
                        overflow: auto;
                        height: var(--pop-up-contents-height, 100%)
                    }
                    .tab-contents ::slotted(*) { 
                        display: none; 
                        animation-name: SHOW-PANEL;
                        animation-duration: 250s;
                    }
                    .tab-contents ::slotted(.selected) { 
                        display: block; 
                        padding: 5px; 
                        font-size: 1.4rem; 
                    }
                </style>
                <div class="tabs">
                    <slot id="tab-slot" name="tab"></slot>
                </div>
                <div class="tab-contents">
                    <slot id="content-slot" name="content"></slot>
                </div>
            `}cacheDom(){this.dom={tabSlot:this.shadow.querySelector("#tab-slot"),contentSlot:this.shadow.querySelector("#content-slot")},this.dom.tabs=this.dom.tabSlot.assignedElements(),this.dom.contents=this.dom.contentSlot.assignedElements()}attachEvents(){this.dom.tabSlot.addEventListener("click",this.onTabClick),this.dom.tabSlot.addEventListener("slotchange",this.onTabSlotChange),this.dom.contentSlot.addEventListener("slotchange",this.onContentSlotChange)}onTabSlotChange(){this.dom.tabs=this.dom.tabSlot.assignedElements()}onContentSlotChange(){this.dom.contents=this.dom.contentSlot.assignedElements()}onTabClick(e){const s=e.target;if(s.slot==="tab"){const r=this.dom.tabs.indexOf(s);this.selectTabByIndex(r)}}selectTabByIndex(e){const s=this.dom.tabs[e],r=this.dom.contents[e];!s||!r||(this.dom.contents.forEach(a=>a.classList.remove("selected")),this.dom.tabs.forEach(a=>a.classList.remove("selected")),r.classList.add("selected"),s.classList.add("selected"))}attributeChangedCallback(e,s,r){s!==r&&(e==="selected-index"?this.selectedIndex=r:this[e]=r)}set selectedIndex(e){Ee(this,be,e)}get selectedIndex(){return Te(this,be)}set direction(e){Ee(this,ve,e),this.setAttribute("direction",e)}get direction(){return Te(this,ve)}}be=new WeakMap,ve=new WeakMap,gt(TabPanel,"observedAttributes",["selected-index","direction"]);window.addEventListener("DOMContentLoaded",()=>{window.customElements.define("tab-panel",TabPanel)});class ModalInfo extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const t=`
          <style>
              pop-up[id='modal-info'] {
                --pop-up-close-display: none;
                --pop-up-dialog-position: absolute;
                --pop-up-dialog-top: 120px;
                --pop-up-dialog-right: 24px;
                --pop-up-dialog-background-color: #000;
                --pop-up-dialog-border-radius: 24px;
                --pop-up-overlay-background-color: rgba(0, 0, 0, 0);
                --pop-up-dialog-width: 65rem;
                --pop-up-dialog-height: 34.5rem;
                
              }

            tab-panel[id='tabs-info'] {
              --tabs-gap: 10px;
              --tab-width: 20rem;
              --tab-padding: 2rem 1rem;
              --tabs-height: 30.5rem;
            } 

            @media screen and (max-width: 461px) {
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 0px;
              }
              pop-up[id='modal-info'] {
                --pop-up-close-display: block;
                --pop-up-dialog-width: 45rem;
                --pop-up-dialog-height: 34.5rem;
              }
            }
            @media (min-width: 461px) and (max-width: 960px) {
              tab-panel[direction="column"]{}
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 0px;
              }
              pop-up[id='modal-info'] {
                --pop-up-close-display: block;
                --pop-up-dialog-width: 55rem;
                --pop-up-dialog-height: 34.5rem;
              }
            }
            @media (min-width: 961px)  {
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 8px;
              }
              pop-up[id='modal-info'] {
                --pop-up-overlay-position: absolute;
                --pop-up-overlay-top: 120px;
                --pop-up-overlay-right: 24px;
                --pop-up-overlay-left: none;
                --pop-up-overlay-width: 65rem;
                --pop-up-overlay-height: 34.5rem;
              }

              #modal-info #tabs-info .item #arrow {
                display: block;
              }
              #modal-info #tabs-info .item:hover {
                background-color: #efefef50;
                border-radius: 8px;
              }
            }
          </style>  
        `;this.innerHTML=`
          ${t}
          <pop-up static="true" id="modal-info">
              <div class="flex" slot="modal" >
                <tab-panel id="tabs-info">
                  <div class="item" slot="tab">
                    Introduction
                  </div>
                  <div slot="content">
                    <div class="content">
                      <h1>Introduction</h1>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                    </div>
                  </div>
                  <div class="item" slot="tab">
                    How to play
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    The multiplier
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Apostar
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Cashout
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Autocash and cashout of 50%
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Another option 1
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option 2
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Another option 3
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option 4
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                </tab-panel>         
            </div>
          </pop-up>
    `}}customElements.define("modal-info",ModalInfo);var global$1,hasRequiredGlobal;function requireGlobal(){if(hasRequiredGlobal)return global$1;hasRequiredGlobal=1;var n=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return global$1=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}(),global$1}const name="websocket",description="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",contributors=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],version$1="1.0.34",repository={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage="https://github.com/theturtle32/WebSocket-Node",engines={node:">=4.0.0"},dependencies={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},devDependencies={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},config={verbose:!1},scripts={test:"tape test/unit/*.js",gulp:"gulp"},main="index",directories={lib:"./lib"},browser$1="lib/browser.js",license="Apache-2.0",require$$0={name,description,keywords,author,contributors,version:version$1,repository,homepage,engines,dependencies,devDependencies,config,scripts,main,directories,browser:browser$1,license};var version=require$$0.version,_globalThis;if(typeof globalThis=="object")_globalThis=globalThis;else try{_globalThis=requireGlobal()}catch{}finally{if(!_globalThis&&typeof window<"u"&&(_globalThis=window),!_globalThis)throw new Error("Could not determine global this")}var NativeWebSocket=_globalThis.WebSocket||_globalThis.MozWebSocket,websocket_version=version;function W3CWebSocket(n,t){var e;return t?e=new NativeWebSocket(n,t):e=new NativeWebSocket(n),e}NativeWebSocket&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(W3CWebSocket,n,{get:function(){return NativeWebSocket[n]}})});var browser={w3cwebsocket:NativeWebSocket?W3CWebSocket:null,version:websocket_version};const BACKEND_URL="wss://igaming-ws.fromsolvers.com/ws",DESKTOP_WIDTH=parseInt("1920"),DESKTOP_HEIGHT=parseInt("1080"),MULTIPLIER_REMOTE_DELAY=parseInt("300");var buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(n){var t=n.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=n.indexOf("=");e===-1&&(e=t);var s=e===t?0:4-e%4;return[e,s]}function byteLength(n){var t=getLens(n),e=t[0],s=t[1];return(e+s)*3/4-s}function _byteLength(n,t,e){return(t+e)*3/4-e}function toByteArray(n){var t,e=getLens(n),s=e[0],r=e[1],a=new Arr(_byteLength(n,s,r)),h=0,c=r>0?s-4:s,o;for(o=0;o<c;o+=4)t=revLookup[n.charCodeAt(o)]<<18|revLookup[n.charCodeAt(o+1)]<<12|revLookup[n.charCodeAt(o+2)]<<6|revLookup[n.charCodeAt(o+3)],a[h++]=t>>16&255,a[h++]=t>>8&255,a[h++]=t&255;return r===2&&(t=revLookup[n.charCodeAt(o)]<<2|revLookup[n.charCodeAt(o+1)]>>4,a[h++]=t&255),r===1&&(t=revLookup[n.charCodeAt(o)]<<10|revLookup[n.charCodeAt(o+1)]<<4|revLookup[n.charCodeAt(o+2)]>>2,a[h++]=t>>8&255,a[h++]=t&255),a}function tripletToBase64(n){return lookup[n>>18&63]+lookup[n>>12&63]+lookup[n>>6&63]+lookup[n&63]}function encodeChunk(n,t,e){for(var s,r=[],a=t;a<e;a+=3)s=(n[a]<<16&16711680)+(n[a+1]<<8&65280)+(n[a+2]&255),r.push(tripletToBase64(s));return r.join("")}function fromByteArray(n){for(var t,e=n.length,s=e%3,r=[],a=16383,h=0,c=e-s;h<c;h+=a)r.push(encodeChunk(n,h,h+a>c?c:h+a));return s===1?(t=n[e-1],r.push(lookup[t>>2]+lookup[t<<4&63]+"==")):s===2&&(t=(n[e-2]<<8)+n[e-1],r.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),r.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(n,t,e,s,r){var a,h,c=r*8-s-1,o=(1<<c)-1,u=o>>1,d=-7,m=e?r-1:0,p=e?-1:1,g=n[t+m];for(m+=p,a=g&(1<<-d)-1,g>>=-d,d+=c;d>0;a=a*256+n[t+m],m+=p,d-=8);for(h=a&(1<<-d)-1,a>>=-d,d+=s;d>0;h=h*256+n[t+m],m+=p,d-=8);if(a===0)a=1-u;else{if(a===o)return h?NaN:(g?-1:1)*(1/0);h=h+Math.pow(2,s),a=a-u}return(g?-1:1)*h*Math.pow(2,a-s)};ieee754.write=function(n,t,e,s,r,a){var h,c,o,u=a*8-r-1,d=(1<<u)-1,m=d>>1,p=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=s?0:a-1,_=s?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,h=d):(h=Math.floor(Math.log(t)/Math.LN2),t*(o=Math.pow(2,-h))<1&&(h--,o*=2),h+m>=1?t+=p/o:t+=p*Math.pow(2,1-m),t*o>=2&&(h++,o/=2),h+m>=d?(c=0,h=d):h+m>=1?(c=(t*o-1)*Math.pow(2,r),h=h+m):(c=t*Math.pow(2,m-1)*Math.pow(2,r),h=0));r>=8;n[e+g]=c&255,g+=_,c/=256,r-=8);for(h=h<<r|c,u+=r;u>0;n[e+g]=h&255,g+=_,h/=256,u-=8);n[e+g-_]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const t=base64Js,e=ieee754,s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=c,n.SlowBuffer=w,n.INSPECT_MAX_BYTES=50;const r=2147483647;n.kMaxLength=r,c.TYPED_ARRAY_SUPPORT=a(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const _t=new Uint8Array(1),st={foo:function(){return 42}};return Object.setPrototypeOf(st,Uint8Array.prototype),Object.setPrototypeOf(_t,st),_t.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function h(_t){if(_t>r)throw new RangeError('The value "'+_t+'" is invalid for option "size"');const st=new Uint8Array(_t);return Object.setPrototypeOf(st,c.prototype),st}function c(_t,st,rt){if(typeof _t=="number"){if(typeof st=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(_t)}return o(_t,st,rt)}c.poolSize=8192;function o(_t,st,rt){if(typeof _t=="string")return p(_t,st);if(ArrayBuffer.isView(_t))return _(_t);if(_t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _t);if(he(_t,ArrayBuffer)||_t&&he(_t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(_t,SharedArrayBuffer)||_t&&he(_t.buffer,SharedArrayBuffer)))return y(_t,st,rt);if(typeof _t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const bt=_t.valueOf&&_t.valueOf();if(bt!=null&&bt!==_t)return c.from(bt,st,rt);const At=v(_t);if(At)return At;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _t[Symbol.toPrimitive]=="function")return c.from(_t[Symbol.toPrimitive]("string"),st,rt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _t)}c.from=function(_t,st,rt){return o(_t,st,rt)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function u(_t){if(typeof _t!="number")throw new TypeError('"size" argument must be of type number');if(_t<0)throw new RangeError('The value "'+_t+'" is invalid for option "size"')}function d(_t,st,rt){return u(_t),_t<=0?h(_t):st!==void 0?typeof rt=="string"?h(_t).fill(st,rt):h(_t).fill(st):h(_t)}c.alloc=function(_t,st,rt){return d(_t,st,rt)};function m(_t){return u(_t),h(_t<0?0:U(_t)|0)}c.allocUnsafe=function(_t){return m(_t)},c.allocUnsafeSlow=function(_t){return m(_t)};function p(_t,st){if((typeof st!="string"||st==="")&&(st="utf8"),!c.isEncoding(st))throw new TypeError("Unknown encoding: "+st);const rt=k(_t,st)|0;let bt=h(rt);const At=bt.write(_t,st);return At!==rt&&(bt=bt.slice(0,At)),bt}function g(_t){const st=_t.length<0?0:U(_t.length)|0,rt=h(st);for(let bt=0;bt<st;bt+=1)rt[bt]=_t[bt]&255;return rt}function _(_t){if(he(_t,Uint8Array)){const st=new Uint8Array(_t);return y(st.buffer,st.byteOffset,st.byteLength)}return g(_t)}function y(_t,st,rt){if(st<0||_t.byteLength<st)throw new RangeError('"offset" is outside of buffer bounds');if(_t.byteLength<st+(rt||0))throw new RangeError('"length" is outside of buffer bounds');let bt;return st===void 0&&rt===void 0?bt=new Uint8Array(_t):rt===void 0?bt=new Uint8Array(_t,st):bt=new Uint8Array(_t,st,rt),Object.setPrototypeOf(bt,c.prototype),bt}function v(_t){if(c.isBuffer(_t)){const st=U(_t.length)|0,rt=h(st);return rt.length===0||_t.copy(rt,0,0,st),rt}if(_t.length!==void 0)return typeof _t.length!="number"||ye(_t.length)?h(0):g(_t);if(_t.type==="Buffer"&&Array.isArray(_t.data))return g(_t.data)}function U(_t){if(_t>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return _t|0}function w(_t){return+_t!=_t&&(_t=0),c.alloc(+_t)}c.isBuffer=function(st){return st!=null&&st._isBuffer===!0&&st!==c.prototype},c.compare=function(st,rt){if(he(st,Uint8Array)&&(st=c.from(st,st.offset,st.byteLength)),he(rt,Uint8Array)&&(rt=c.from(rt,rt.offset,rt.byteLength)),!c.isBuffer(st)||!c.isBuffer(rt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(st===rt)return 0;let bt=st.length,At=rt.length;for(let Vt=0,Jt=Math.min(bt,At);Vt<Jt;++Vt)if(st[Vt]!==rt[Vt]){bt=st[Vt],At=rt[Vt];break}return bt<At?-1:At<bt?1:0},c.isEncoding=function(st){switch(String(st).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(st,rt){if(!Array.isArray(st))throw new TypeError('"list" argument must be an Array of Buffers');if(st.length===0)return c.alloc(0);let bt;if(rt===void 0)for(rt=0,bt=0;bt<st.length;++bt)rt+=st[bt].length;const At=c.allocUnsafe(rt);let Vt=0;for(bt=0;bt<st.length;++bt){let Jt=st[bt];if(he(Jt,Uint8Array))Vt+Jt.length>At.length?(c.isBuffer(Jt)||(Jt=c.from(Jt)),Jt.copy(At,Vt)):Uint8Array.prototype.set.call(At,Jt,Vt);else if(c.isBuffer(Jt))Jt.copy(At,Vt);else throw new TypeError('"list" argument must be an Array of Buffers');Vt+=Jt.length}return At};function k(_t,st){if(c.isBuffer(_t))return _t.length;if(ArrayBuffer.isView(_t)||he(_t,ArrayBuffer))return _t.byteLength;if(typeof _t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _t);const rt=_t.length,bt=arguments.length>2&&arguments[2]===!0;if(!bt&&rt===0)return 0;let At=!1;for(;;)switch(st){case"ascii":case"latin1":case"binary":return rt;case"utf8":case"utf-8":return oe(_t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return rt*2;case"hex":return rt>>>1;case"base64":return me(_t).length;default:if(At)return bt?-1:oe(_t).length;st=(""+st).toLowerCase(),At=!0}}c.byteLength=k;function N(_t,st,rt){let bt=!1;if((st===void 0||st<0)&&(st=0),st>this.length||((rt===void 0||rt>this.length)&&(rt=this.length),rt<=0)||(rt>>>=0,st>>>=0,rt<=st))return"";for(_t||(_t="utf8");;)switch(_t){case"hex":return Ut(this,st,rt);case"utf8":case"utf-8":return wt(this,st,rt);case"ascii":return Pt(this,st,rt);case"latin1":case"binary":return Xt(this,st,rt);case"base64":return St(this,st,rt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Et(this,st,rt);default:if(bt)throw new TypeError("Unknown encoding: "+_t);_t=(_t+"").toLowerCase(),bt=!0}}c.prototype._isBuffer=!0;function W(_t,st,rt){const bt=_t[st];_t[st]=_t[rt],_t[rt]=bt}c.prototype.swap16=function(){const st=this.length;if(st%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let rt=0;rt<st;rt+=2)W(this,rt,rt+1);return this},c.prototype.swap32=function(){const st=this.length;if(st%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let rt=0;rt<st;rt+=4)W(this,rt,rt+3),W(this,rt+1,rt+2);return this},c.prototype.swap64=function(){const st=this.length;if(st%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let rt=0;rt<st;rt+=8)W(this,rt,rt+7),W(this,rt+1,rt+6),W(this,rt+2,rt+5),W(this,rt+3,rt+4);return this},c.prototype.toString=function(){const st=this.length;return st===0?"":arguments.length===0?wt(this,0,st):N.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(st){if(!c.isBuffer(st))throw new TypeError("Argument must be a Buffer");return this===st?!0:c.compare(this,st)===0},c.prototype.inspect=function(){let st="";const rt=n.INSPECT_MAX_BYTES;return st=this.toString("hex",0,rt).replace(/(.{2})/g,"$1 ").trim(),this.length>rt&&(st+=" ... "),"<Buffer "+st+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(st,rt,bt,At,Vt){if(he(st,Uint8Array)&&(st=c.from(st,st.offset,st.byteLength)),!c.isBuffer(st))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof st);if(rt===void 0&&(rt=0),bt===void 0&&(bt=st?st.length:0),At===void 0&&(At=0),Vt===void 0&&(Vt=this.length),rt<0||bt>st.length||At<0||Vt>this.length)throw new RangeError("out of range index");if(At>=Vt&&rt>=bt)return 0;if(At>=Vt)return-1;if(rt>=bt)return 1;if(rt>>>=0,bt>>>=0,At>>>=0,Vt>>>=0,this===st)return 0;let Jt=Vt-At,ae=bt-rt;const de=Math.min(Jt,ae),ue=this.slice(At,Vt),fe=st.slice(rt,bt);for(let ce=0;ce<de;++ce)if(ue[ce]!==fe[ce]){Jt=ue[ce],ae=fe[ce];break}return Jt<ae?-1:ae<Jt?1:0};function et(_t,st,rt,bt,At){if(_t.length===0)return-1;if(typeof rt=="string"?(bt=rt,rt=0):rt>2147483647?rt=2147483647:rt<-2147483648&&(rt=-2147483648),rt=+rt,ye(rt)&&(rt=At?0:_t.length-1),rt<0&&(rt=_t.length+rt),rt>=_t.length){if(At)return-1;rt=_t.length-1}else if(rt<0)if(At)rt=0;else return-1;if(typeof st=="string"&&(st=c.from(st,bt)),c.isBuffer(st))return st.length===0?-1:it(_t,st,rt,bt,At);if(typeof st=="number")return st=st&255,typeof Uint8Array.prototype.indexOf=="function"?At?Uint8Array.prototype.indexOf.call(_t,st,rt):Uint8Array.prototype.lastIndexOf.call(_t,st,rt):it(_t,[st],rt,bt,At);throw new TypeError("val must be string, number or Buffer")}function it(_t,st,rt,bt,At){let Vt=1,Jt=_t.length,ae=st.length;if(bt!==void 0&&(bt=String(bt).toLowerCase(),bt==="ucs2"||bt==="ucs-2"||bt==="utf16le"||bt==="utf-16le")){if(_t.length<2||st.length<2)return-1;Vt=2,Jt/=2,ae/=2,rt/=2}function de(fe,ce){return Vt===1?fe[ce]:fe.readUInt16BE(ce*Vt)}let ue;if(At){let fe=-1;for(ue=rt;ue<Jt;ue++)if(de(_t,ue)===de(st,fe===-1?0:ue-fe)){if(fe===-1&&(fe=ue),ue-fe+1===ae)return fe*Vt}else fe!==-1&&(ue-=ue-fe),fe=-1}else for(rt+ae>Jt&&(rt=Jt-ae),ue=rt;ue>=0;ue--){let fe=!0;for(let ce=0;ce<ae;ce++)if(de(_t,ue+ce)!==de(st,ce)){fe=!1;break}if(fe)return ue}return-1}c.prototype.includes=function(st,rt,bt){return this.indexOf(st,rt,bt)!==-1},c.prototype.indexOf=function(st,rt,bt){return et(this,st,rt,bt,!0)},c.prototype.lastIndexOf=function(st,rt,bt){return et(this,st,rt,bt,!1)};function ft(_t,st,rt,bt){rt=Number(rt)||0;const At=_t.length-rt;bt?(bt=Number(bt),bt>At&&(bt=At)):bt=At;const Vt=st.length;bt>Vt/2&&(bt=Vt/2);let Jt;for(Jt=0;Jt<bt;++Jt){const ae=parseInt(st.substr(Jt*2,2),16);if(ye(ae))return Jt;_t[rt+Jt]=ae}return Jt}function mt(_t,st,rt,bt){return xe(oe(st,_t.length-rt),_t,rt,bt)}function xt(_t,st,rt,bt){return xe(ge(st),_t,rt,bt)}function yt(_t,st,rt,bt){return xe(me(st),_t,rt,bt)}function vt(_t,st,rt,bt){return xe(pe(st,_t.length-rt),_t,rt,bt)}c.prototype.write=function(st,rt,bt,At){if(rt===void 0)At="utf8",bt=this.length,rt=0;else if(bt===void 0&&typeof rt=="string")At=rt,bt=this.length,rt=0;else if(isFinite(rt))rt=rt>>>0,isFinite(bt)?(bt=bt>>>0,At===void 0&&(At="utf8")):(At=bt,bt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Vt=this.length-rt;if((bt===void 0||bt>Vt)&&(bt=Vt),st.length>0&&(bt<0||rt<0)||rt>this.length)throw new RangeError("Attempt to write outside buffer bounds");At||(At="utf8");let Jt=!1;for(;;)switch(At){case"hex":return ft(this,st,rt,bt);case"utf8":case"utf-8":return mt(this,st,rt,bt);case"ascii":case"latin1":case"binary":return xt(this,st,rt,bt);case"base64":return yt(this,st,rt,bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,st,rt,bt);default:if(Jt)throw new TypeError("Unknown encoding: "+At);At=(""+At).toLowerCase(),Jt=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function St(_t,st,rt){return st===0&&rt===_t.length?t.fromByteArray(_t):t.fromByteArray(_t.slice(st,rt))}function wt(_t,st,rt){rt=Math.min(_t.length,rt);const bt=[];let At=st;for(;At<rt;){const Vt=_t[At];let Jt=null,ae=Vt>239?4:Vt>223?3:Vt>191?2:1;if(At+ae<=rt){let de,ue,fe,ce;switch(ae){case 1:Vt<128&&(Jt=Vt);break;case 2:de=_t[At+1],(de&192)===128&&(ce=(Vt&31)<<6|de&63,ce>127&&(Jt=ce));break;case 3:de=_t[At+1],ue=_t[At+2],(de&192)===128&&(ue&192)===128&&(ce=(Vt&15)<<12|(de&63)<<6|ue&63,ce>2047&&(ce<55296||ce>57343)&&(Jt=ce));break;case 4:de=_t[At+1],ue=_t[At+2],fe=_t[At+3],(de&192)===128&&(ue&192)===128&&(fe&192)===128&&(ce=(Vt&15)<<18|(de&63)<<12|(ue&63)<<6|fe&63,ce>65535&&ce<1114112&&(Jt=ce))}}Jt===null?(Jt=65533,ae=1):Jt>65535&&(Jt-=65536,bt.push(Jt>>>10&1023|55296),Jt=56320|Jt&1023),bt.push(Jt),At+=ae}return It(bt)}const Ct=4096;function It(_t){const st=_t.length;if(st<=Ct)return String.fromCharCode.apply(String,_t);let rt="",bt=0;for(;bt<st;)rt+=String.fromCharCode.apply(String,_t.slice(bt,bt+=Ct));return rt}function Pt(_t,st,rt){let bt="";rt=Math.min(_t.length,rt);for(let At=st;At<rt;++At)bt+=String.fromCharCode(_t[At]&127);return bt}function Xt(_t,st,rt){let bt="";rt=Math.min(_t.length,rt);for(let At=st;At<rt;++At)bt+=String.fromCharCode(_t[At]);return bt}function Ut(_t,st,rt){const bt=_t.length;(!st||st<0)&&(st=0),(!rt||rt<0||rt>bt)&&(rt=bt);let At="";for(let Vt=st;Vt<rt;++Vt)At+=we[_t[Vt]];return At}function Et(_t,st,rt){const bt=_t.slice(st,rt);let At="";for(let Vt=0;Vt<bt.length-1;Vt+=2)At+=String.fromCharCode(bt[Vt]+bt[Vt+1]*256);return At}c.prototype.slice=function(st,rt){const bt=this.length;st=~~st,rt=rt===void 0?bt:~~rt,st<0?(st+=bt,st<0&&(st=0)):st>bt&&(st=bt),rt<0?(rt+=bt,rt<0&&(rt=0)):rt>bt&&(rt=bt),rt<st&&(rt=st);const At=this.subarray(st,rt);return Object.setPrototypeOf(At,c.prototype),At};function Ft(_t,st,rt){if(_t%1!==0||_t<0)throw new RangeError("offset is not uint");if(_t+st>rt)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(st,rt,bt){st=st>>>0,rt=rt>>>0,bt||Ft(st,rt,this.length);let At=this[st],Vt=1,Jt=0;for(;++Jt<rt&&(Vt*=256);)At+=this[st+Jt]*Vt;return At},c.prototype.readUintBE=c.prototype.readUIntBE=function(st,rt,bt){st=st>>>0,rt=rt>>>0,bt||Ft(st,rt,this.length);let At=this[st+--rt],Vt=1;for(;rt>0&&(Vt*=256);)At+=this[st+--rt]*Vt;return At},c.prototype.readUint8=c.prototype.readUInt8=function(st,rt){return st=st>>>0,rt||Ft(st,1,this.length),this[st]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(st,rt){return st=st>>>0,rt||Ft(st,2,this.length),this[st]|this[st+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(st,rt){return st=st>>>0,rt||Ft(st,2,this.length),this[st]<<8|this[st+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),(this[st]|this[st+1]<<8|this[st+2]<<16)+this[st+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),this[st]*16777216+(this[st+1]<<16|this[st+2]<<8|this[st+3])},c.prototype.readBigUInt64LE=_e(function(st){st=st>>>0,Qt(st,"offset");const rt=this[st],bt=this[st+7];(rt===void 0||bt===void 0)&&ie(st,this.length-8);const At=rt+this[++st]*2**8+this[++st]*2**16+this[++st]*2**24,Vt=this[++st]+this[++st]*2**8+this[++st]*2**16+bt*2**24;return BigInt(At)+(BigInt(Vt)<<BigInt(32))}),c.prototype.readBigUInt64BE=_e(function(st){st=st>>>0,Qt(st,"offset");const rt=this[st],bt=this[st+7];(rt===void 0||bt===void 0)&&ie(st,this.length-8);const At=rt*2**24+this[++st]*2**16+this[++st]*2**8+this[++st],Vt=this[++st]*2**24+this[++st]*2**16+this[++st]*2**8+bt;return(BigInt(At)<<BigInt(32))+BigInt(Vt)}),c.prototype.readIntLE=function(st,rt,bt){st=st>>>0,rt=rt>>>0,bt||Ft(st,rt,this.length);let At=this[st],Vt=1,Jt=0;for(;++Jt<rt&&(Vt*=256);)At+=this[st+Jt]*Vt;return Vt*=128,At>=Vt&&(At-=Math.pow(2,8*rt)),At},c.prototype.readIntBE=function(st,rt,bt){st=st>>>0,rt=rt>>>0,bt||Ft(st,rt,this.length);let At=rt,Vt=1,Jt=this[st+--At];for(;At>0&&(Vt*=256);)Jt+=this[st+--At]*Vt;return Vt*=128,Jt>=Vt&&(Jt-=Math.pow(2,8*rt)),Jt},c.prototype.readInt8=function(st,rt){return st=st>>>0,rt||Ft(st,1,this.length),this[st]&128?(255-this[st]+1)*-1:this[st]},c.prototype.readInt16LE=function(st,rt){st=st>>>0,rt||Ft(st,2,this.length);const bt=this[st]|this[st+1]<<8;return bt&32768?bt|4294901760:bt},c.prototype.readInt16BE=function(st,rt){st=st>>>0,rt||Ft(st,2,this.length);const bt=this[st+1]|this[st]<<8;return bt&32768?bt|4294901760:bt},c.prototype.readInt32LE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),this[st]|this[st+1]<<8|this[st+2]<<16|this[st+3]<<24},c.prototype.readInt32BE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),this[st]<<24|this[st+1]<<16|this[st+2]<<8|this[st+3]},c.prototype.readBigInt64LE=_e(function(st){st=st>>>0,Qt(st,"offset");const rt=this[st],bt=this[st+7];(rt===void 0||bt===void 0)&&ie(st,this.length-8);const At=this[st+4]+this[st+5]*2**8+this[st+6]*2**16+(bt<<24);return(BigInt(At)<<BigInt(32))+BigInt(rt+this[++st]*2**8+this[++st]*2**16+this[++st]*2**24)}),c.prototype.readBigInt64BE=_e(function(st){st=st>>>0,Qt(st,"offset");const rt=this[st],bt=this[st+7];(rt===void 0||bt===void 0)&&ie(st,this.length-8);const At=(rt<<24)+this[++st]*2**16+this[++st]*2**8+this[++st];return(BigInt(At)<<BigInt(32))+BigInt(this[++st]*2**24+this[++st]*2**16+this[++st]*2**8+bt)}),c.prototype.readFloatLE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),e.read(this,st,!0,23,4)},c.prototype.readFloatBE=function(st,rt){return st=st>>>0,rt||Ft(st,4,this.length),e.read(this,st,!1,23,4)},c.prototype.readDoubleLE=function(st,rt){return st=st>>>0,rt||Ft(st,8,this.length),e.read(this,st,!0,52,8)},c.prototype.readDoubleBE=function(st,rt){return st=st>>>0,rt||Ft(st,8,this.length),e.read(this,st,!1,52,8)};function Lt(_t,st,rt,bt,At,Vt){if(!c.isBuffer(_t))throw new TypeError('"buffer" argument must be a Buffer instance');if(st>At||st<Vt)throw new RangeError('"value" argument is out of bounds');if(rt+bt>_t.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(st,rt,bt,At){if(st=+st,rt=rt>>>0,bt=bt>>>0,!At){const ae=Math.pow(2,8*bt)-1;Lt(this,st,rt,bt,ae,0)}let Vt=1,Jt=0;for(this[rt]=st&255;++Jt<bt&&(Vt*=256);)this[rt+Jt]=st/Vt&255;return rt+bt},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(st,rt,bt,At){if(st=+st,rt=rt>>>0,bt=bt>>>0,!At){const ae=Math.pow(2,8*bt)-1;Lt(this,st,rt,bt,ae,0)}let Vt=bt-1,Jt=1;for(this[rt+Vt]=st&255;--Vt>=0&&(Jt*=256);)this[rt+Vt]=st/Jt&255;return rt+bt},c.prototype.writeUint8=c.prototype.writeUInt8=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,1,255,0),this[rt]=st&255,rt+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,2,65535,0),this[rt]=st&255,this[rt+1]=st>>>8,rt+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,2,65535,0),this[rt]=st>>>8,this[rt+1]=st&255,rt+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,4,4294967295,0),this[rt+3]=st>>>24,this[rt+2]=st>>>16,this[rt+1]=st>>>8,this[rt]=st&255,rt+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,4,4294967295,0),this[rt]=st>>>24,this[rt+1]=st>>>16,this[rt+2]=st>>>8,this[rt+3]=st&255,rt+4};function Ht(_t,st,rt,bt,At){te(st,bt,At,_t,rt,7);let Vt=Number(st&BigInt(4294967295));_t[rt++]=Vt,Vt=Vt>>8,_t[rt++]=Vt,Vt=Vt>>8,_t[rt++]=Vt,Vt=Vt>>8,_t[rt++]=Vt;let Jt=Number(st>>BigInt(32)&BigInt(4294967295));return _t[rt++]=Jt,Jt=Jt>>8,_t[rt++]=Jt,Jt=Jt>>8,_t[rt++]=Jt,Jt=Jt>>8,_t[rt++]=Jt,rt}function Wt(_t,st,rt,bt,At){te(st,bt,At,_t,rt,7);let Vt=Number(st&BigInt(4294967295));_t[rt+7]=Vt,Vt=Vt>>8,_t[rt+6]=Vt,Vt=Vt>>8,_t[rt+5]=Vt,Vt=Vt>>8,_t[rt+4]=Vt;let Jt=Number(st>>BigInt(32)&BigInt(4294967295));return _t[rt+3]=Jt,Jt=Jt>>8,_t[rt+2]=Jt,Jt=Jt>>8,_t[rt+1]=Jt,Jt=Jt>>8,_t[rt]=Jt,rt+8}c.prototype.writeBigUInt64LE=_e(function(st,rt=0){return Ht(this,st,rt,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=_e(function(st,rt=0){return Wt(this,st,rt,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(st,rt,bt,At){if(st=+st,rt=rt>>>0,!At){const de=Math.pow(2,8*bt-1);Lt(this,st,rt,bt,de-1,-de)}let Vt=0,Jt=1,ae=0;for(this[rt]=st&255;++Vt<bt&&(Jt*=256);)st<0&&ae===0&&this[rt+Vt-1]!==0&&(ae=1),this[rt+Vt]=(st/Jt>>0)-ae&255;return rt+bt},c.prototype.writeIntBE=function(st,rt,bt,At){if(st=+st,rt=rt>>>0,!At){const de=Math.pow(2,8*bt-1);Lt(this,st,rt,bt,de-1,-de)}let Vt=bt-1,Jt=1,ae=0;for(this[rt+Vt]=st&255;--Vt>=0&&(Jt*=256);)st<0&&ae===0&&this[rt+Vt+1]!==0&&(ae=1),this[rt+Vt]=(st/Jt>>0)-ae&255;return rt+bt},c.prototype.writeInt8=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,1,127,-128),st<0&&(st=255+st+1),this[rt]=st&255,rt+1},c.prototype.writeInt16LE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,2,32767,-32768),this[rt]=st&255,this[rt+1]=st>>>8,rt+2},c.prototype.writeInt16BE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,2,32767,-32768),this[rt]=st>>>8,this[rt+1]=st&255,rt+2},c.prototype.writeInt32LE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,4,2147483647,-2147483648),this[rt]=st&255,this[rt+1]=st>>>8,this[rt+2]=st>>>16,this[rt+3]=st>>>24,rt+4},c.prototype.writeInt32BE=function(st,rt,bt){return st=+st,rt=rt>>>0,bt||Lt(this,st,rt,4,2147483647,-2147483648),st<0&&(st=4294967295+st+1),this[rt]=st>>>24,this[rt+1]=st>>>16,this[rt+2]=st>>>8,this[rt+3]=st&255,rt+4},c.prototype.writeBigInt64LE=_e(function(st,rt=0){return Ht(this,st,rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=_e(function(st,rt=0){return Wt(this,st,rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Zt(_t,st,rt,bt,At,Vt){if(rt+bt>_t.length)throw new RangeError("Index out of range");if(rt<0)throw new RangeError("Index out of range")}function ee(_t,st,rt,bt,At){return st=+st,rt=rt>>>0,At||Zt(_t,st,rt,4),e.write(_t,st,rt,bt,23,4),rt+4}c.prototype.writeFloatLE=function(st,rt,bt){return ee(this,st,rt,!0,bt)},c.prototype.writeFloatBE=function(st,rt,bt){return ee(this,st,rt,!1,bt)};function ne(_t,st,rt,bt,At){return st=+st,rt=rt>>>0,At||Zt(_t,st,rt,8),e.write(_t,st,rt,bt,52,8),rt+8}c.prototype.writeDoubleLE=function(st,rt,bt){return ne(this,st,rt,!0,bt)},c.prototype.writeDoubleBE=function(st,rt,bt){return ne(this,st,rt,!1,bt)},c.prototype.copy=function(st,rt,bt,At){if(!c.isBuffer(st))throw new TypeError("argument should be a Buffer");if(bt||(bt=0),!At&&At!==0&&(At=this.length),rt>=st.length&&(rt=st.length),rt||(rt=0),At>0&&At<bt&&(At=bt),At===bt||st.length===0||this.length===0)return 0;if(rt<0)throw new RangeError("targetStart out of bounds");if(bt<0||bt>=this.length)throw new RangeError("Index out of range");if(At<0)throw new RangeError("sourceEnd out of bounds");At>this.length&&(At=this.length),st.length-rt<At-bt&&(At=st.length-rt+bt);const Vt=At-bt;return this===st&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(rt,bt,At):Uint8Array.prototype.set.call(st,this.subarray(bt,At),rt),Vt},c.prototype.fill=function(st,rt,bt,At){if(typeof st=="string"){if(typeof rt=="string"?(At=rt,rt=0,bt=this.length):typeof bt=="string"&&(At=bt,bt=this.length),At!==void 0&&typeof At!="string")throw new TypeError("encoding must be a string");if(typeof At=="string"&&!c.isEncoding(At))throw new TypeError("Unknown encoding: "+At);if(st.length===1){const Jt=st.charCodeAt(0);(At==="utf8"&&Jt<128||At==="latin1")&&(st=Jt)}}else typeof st=="number"?st=st&255:typeof st=="boolean"&&(st=Number(st));if(rt<0||this.length<rt||this.length<bt)throw new RangeError("Out of range index");if(bt<=rt)return this;rt=rt>>>0,bt=bt===void 0?this.length:bt>>>0,st||(st=0);let Vt;if(typeof st=="number")for(Vt=rt;Vt<bt;++Vt)this[Vt]=st;else{const Jt=c.isBuffer(st)?st:c.from(st,At),ae=Jt.length;if(ae===0)throw new TypeError('The value "'+st+'" is invalid for argument "value"');for(Vt=0;Vt<bt-rt;++Vt)this[Vt+rt]=Jt[Vt%ae]}return this};const se={};function Nt(_t,st,rt){se[_t]=class extends rt{constructor(){super(),Object.defineProperty(this,"message",{value:st.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_t}]`,this.stack,delete this.name}get code(){return _t}set code(At){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:At,writable:!0})}toString(){return`${this.name} [${_t}]: ${this.message}`}}}Nt("ERR_BUFFER_OUT_OF_BOUNDS",function(_t){return _t?`${_t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Nt("ERR_INVALID_ARG_TYPE",function(_t,st){return`The "${_t}" argument must be of type number. Received type ${typeof st}`},TypeError),Nt("ERR_OUT_OF_RANGE",function(_t,st,rt){let bt=`The value of "${_t}" is out of range.`,At=rt;return Number.isInteger(rt)&&Math.abs(rt)>2**32?At=Yt(String(rt)):typeof rt=="bigint"&&(At=String(rt),(rt>BigInt(2)**BigInt(32)||rt<-(BigInt(2)**BigInt(32)))&&(At=Yt(At)),At+="n"),bt+=` It must be ${st}. Received ${At}`,bt},RangeError);function Yt(_t){let st="",rt=_t.length;const bt=_t[0]==="-"?1:0;for(;rt>=bt+4;rt-=3)st=`_${_t.slice(rt-3,rt)}${st}`;return`${_t.slice(0,rt)}${st}`}function zt(_t,st,rt){Qt(st,"offset"),(_t[st]===void 0||_t[st+rt]===void 0)&&ie(st,_t.length-(rt+1))}function te(_t,st,rt,bt,At,Vt){if(_t>rt||_t<st){const Jt=typeof st=="bigint"?"n":"";let ae;throw Vt>3?st===0||st===BigInt(0)?ae=`>= 0${Jt} and < 2${Jt} ** ${(Vt+1)*8}${Jt}`:ae=`>= -(2${Jt} ** ${(Vt+1)*8-1}${Jt}) and < 2 ** ${(Vt+1)*8-1}${Jt}`:ae=`>= ${st}${Jt} and <= ${rt}${Jt}`,new se.ERR_OUT_OF_RANGE("value",ae,_t)}zt(bt,At,Vt)}function Qt(_t,st){if(typeof _t!="number")throw new se.ERR_INVALID_ARG_TYPE(st,"number",_t)}function ie(_t,st,rt){throw Math.floor(_t)!==_t?(Qt(_t,rt),new se.ERR_OUT_OF_RANGE(rt||"offset","an integer",_t)):st<0?new se.ERR_BUFFER_OUT_OF_BOUNDS:new se.ERR_OUT_OF_RANGE(rt||"offset",`>= ${rt?1:0} and <= ${st}`,_t)}const re=/[^+/0-9A-Za-z-_]/g;function le(_t){if(_t=_t.split("=")[0],_t=_t.trim().replace(re,""),_t.length<2)return"";for(;_t.length%4!==0;)_t=_t+"=";return _t}function oe(_t,st){st=st||1/0;let rt;const bt=_t.length;let At=null;const Vt=[];for(let Jt=0;Jt<bt;++Jt){if(rt=_t.charCodeAt(Jt),rt>55295&&rt<57344){if(!At){if(rt>56319){(st-=3)>-1&&Vt.push(239,191,189);continue}else if(Jt+1===bt){(st-=3)>-1&&Vt.push(239,191,189);continue}At=rt;continue}if(rt<56320){(st-=3)>-1&&Vt.push(239,191,189),At=rt;continue}rt=(At-55296<<10|rt-56320)+65536}else At&&(st-=3)>-1&&Vt.push(239,191,189);if(At=null,rt<128){if((st-=1)<0)break;Vt.push(rt)}else if(rt<2048){if((st-=2)<0)break;Vt.push(rt>>6|192,rt&63|128)}else if(rt<65536){if((st-=3)<0)break;Vt.push(rt>>12|224,rt>>6&63|128,rt&63|128)}else if(rt<1114112){if((st-=4)<0)break;Vt.push(rt>>18|240,rt>>12&63|128,rt>>6&63|128,rt&63|128)}else throw new Error("Invalid code point")}return Vt}function ge(_t){const st=[];for(let rt=0;rt<_t.length;++rt)st.push(_t.charCodeAt(rt)&255);return st}function pe(_t,st){let rt,bt,At;const Vt=[];for(let Jt=0;Jt<_t.length&&!((st-=2)<0);++Jt)rt=_t.charCodeAt(Jt),bt=rt>>8,At=rt%256,Vt.push(At),Vt.push(bt);return Vt}function me(_t){return t.toByteArray(le(_t))}function xe(_t,st,rt,bt){let At;for(At=0;At<bt&&!(At+rt>=st.length||At>=_t.length);++At)st[At+rt]=_t[At];return At}function he(_t,st){return _t instanceof st||_t!=null&&_t.constructor!=null&&_t.constructor.name!=null&&_t.constructor.name===st.name}function ye(_t){return _t!==_t}const we=function(){const _t="0123456789abcdef",st=new Array(256);for(let rt=0;rt<16;++rt){const bt=rt*16;for(let At=0;At<16;++At)st[bt+At]=_t[rt]+_t[At]}return st}();function _e(_t){return typeof BigInt>"u"?Ae:_t}function Ae(){throw new Error("BigInt not supported")}})(buffer);var protobufjsExports={},protobufjs={get exports(){return protobufjsExports},set exports(n){protobufjsExports=n}},srcExports={},src={get exports(){return srcExports},set exports(n){srcExports=n}},indexLightExports={},indexLight={get exports(){return indexLightExports},set exports(n){indexLightExports=n}},indexMinimal={},minimal={},aspromise=asPromise$1;function asPromise$1(n,t){for(var e=new Array(arguments.length-1),s=0,r=2,a=!0;r<arguments.length;)e[s++]=arguments[r++];return new Promise(function(c,o){e[s]=function(d){if(a)if(a=!1,d)o(d);else{for(var m=new Array(arguments.length-1),p=0;p<m.length;)m[p++]=arguments[p];c.apply(null,m)}};try{n.apply(t||null,e)}catch(u){a&&(a=!1,o(u))}})}var base64$1={};(function(n){var t=n;t.length=function(c){var o=c.length;if(!o)return 0;for(var u=0;--o%4>1&&c.charAt(o)==="=";)++u;return Math.ceil(c.length*3)/4-u};for(var e=new Array(64),s=new Array(123),r=0;r<64;)s[e[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;t.encode=function(c,o,u){for(var d=null,m=[],p=0,g=0,_;o<u;){var y=c[o++];switch(g){case 0:m[p++]=e[y>>2],_=(y&3)<<4,g=1;break;case 1:m[p++]=e[_|y>>4],_=(y&15)<<2,g=2;break;case 2:m[p++]=e[_|y>>6],m[p++]=e[y&63],g=0;break}p>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,m)),p=0)}return g&&(m[p++]=e[_],m[p++]=61,g===1&&(m[p++]=61)),d?(p&&d.push(String.fromCharCode.apply(String,m.slice(0,p))),d.join("")):String.fromCharCode.apply(String,m.slice(0,p))};var a="invalid encoding";t.decode=function(c,o,u){for(var d=u,m=0,p,g=0;g<c.length;){var _=c.charCodeAt(g++);if(_===61&&m>1)break;if((_=s[_])===void 0)throw Error(a);switch(m){case 0:p=_,m=1;break;case 1:o[u++]=p<<2|(_&48)>>4,p=_,m=2;break;case 2:o[u++]=(p&15)<<4|(_&60)>>2,p=_,m=3;break;case 3:o[u++]=(p&3)<<6|_,m=0;break}}if(m===1)throw Error(a);return u-d},t.test=function(c){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(c)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(t,e,s){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:s||this}),this};EventEmitter.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var s=this._listeners[t],r=0;r<s.length;)s[r].fn===e?s.splice(r,1):++r;return this};EventEmitter.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var s=[],r=1;r<arguments.length;)s.push(arguments[r++]);for(r=0;r<e.length;)e[r].fn.apply(e[r++].ctx,s)}return this};var float=factory(factory);function factory(n){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),s=e[3]===128;function r(o,u,d){t[0]=o,u[d]=e[0],u[d+1]=e[1],u[d+2]=e[2],u[d+3]=e[3]}function a(o,u,d){t[0]=o,u[d]=e[3],u[d+1]=e[2],u[d+2]=e[1],u[d+3]=e[0]}n.writeFloatLE=s?r:a,n.writeFloatBE=s?a:r;function h(o,u){return e[0]=o[u],e[1]=o[u+1],e[2]=o[u+2],e[3]=o[u+3],t[0]}function c(o,u){return e[3]=o[u],e[2]=o[u+1],e[1]=o[u+2],e[0]=o[u+3],t[0]}n.readFloatLE=s?h:c,n.readFloatBE=s?c:h}():function(){function t(s,r,a,h){var c=r<0?1:0;if(c&&(r=-r),r===0)s(1/r>0?0:2147483648,a,h);else if(isNaN(r))s(2143289344,a,h);else if(r>34028234663852886e22)s((c<<31|2139095040)>>>0,a,h);else if(r<11754943508222875e-54)s((c<<31|Math.round(r/1401298464324817e-60))>>>0,a,h);else{var o=Math.floor(Math.log(r)/Math.LN2),u=Math.round(r*Math.pow(2,-o)*8388608)&8388607;s((c<<31|o+127<<23|u)>>>0,a,h)}}n.writeFloatLE=t.bind(null,writeUintLE),n.writeFloatBE=t.bind(null,writeUintBE);function e(s,r,a){var h=s(r,a),c=(h>>31)*2+1,o=h>>>23&255,u=h&8388607;return o===255?u?NaN:c*(1/0):o===0?c*1401298464324817e-60*u:c*Math.pow(2,o-150)*(u+8388608)}n.readFloatLE=e.bind(null,readUintLE),n.readFloatBE=e.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),s=e[7]===128;function r(o,u,d){t[0]=o,u[d]=e[0],u[d+1]=e[1],u[d+2]=e[2],u[d+3]=e[3],u[d+4]=e[4],u[d+5]=e[5],u[d+6]=e[6],u[d+7]=e[7]}function a(o,u,d){t[0]=o,u[d]=e[7],u[d+1]=e[6],u[d+2]=e[5],u[d+3]=e[4],u[d+4]=e[3],u[d+5]=e[2],u[d+6]=e[1],u[d+7]=e[0]}n.writeDoubleLE=s?r:a,n.writeDoubleBE=s?a:r;function h(o,u){return e[0]=o[u],e[1]=o[u+1],e[2]=o[u+2],e[3]=o[u+3],e[4]=o[u+4],e[5]=o[u+5],e[6]=o[u+6],e[7]=o[u+7],t[0]}function c(o,u){return e[7]=o[u],e[6]=o[u+1],e[5]=o[u+2],e[4]=o[u+3],e[3]=o[u+4],e[2]=o[u+5],e[1]=o[u+6],e[0]=o[u+7],t[0]}n.readDoubleLE=s?h:c,n.readDoubleBE=s?c:h}():function(){function t(s,r,a,h,c,o){var u=h<0?1:0;if(u&&(h=-h),h===0)s(0,c,o+r),s(1/h>0?0:2147483648,c,o+a);else if(isNaN(h))s(0,c,o+r),s(2146959360,c,o+a);else if(h>17976931348623157e292)s(0,c,o+r),s((u<<31|2146435072)>>>0,c,o+a);else{var d;if(h<22250738585072014e-324)d=h/5e-324,s(d>>>0,c,o+r),s((u<<31|d/4294967296)>>>0,c,o+a);else{var m=Math.floor(Math.log(h)/Math.LN2);m===1024&&(m=1023),d=h*Math.pow(2,-m),s(d*4503599627370496>>>0,c,o+r),s((u<<31|m+1023<<20|d*1048576&1048575)>>>0,c,o+a)}}}n.writeDoubleLE=t.bind(null,writeUintLE,0,4),n.writeDoubleBE=t.bind(null,writeUintBE,4,0);function e(s,r,a,h,c){var o=s(h,c+r),u=s(h,c+a),d=(u>>31)*2+1,m=u>>>20&2047,p=4294967296*(u&1048575)+o;return m===2047?p?NaN:d*(1/0):m===0?d*5e-324*p:d*Math.pow(2,m-1075)*(p+4503599627370496)}n.readDoubleLE=e.bind(null,readUintLE,0,4),n.readDoubleBE=e.bind(null,readUintBE,4,0)}(),n}function writeUintLE(n,t,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24}function writeUintBE(n,t,e){t[e]=n>>>24,t[e+1]=n>>>16&255,t[e+2]=n>>>8&255,t[e+3]=n&255}function readUintLE(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24)>>>0}function readUintBE(n,t){return(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}var inquire_1=inquire$1;function inquire$1(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}var utf8$2={};(function(n){var t=n;t.length=function(s){for(var r=0,a=0,h=0;h<s.length;++h)a=s.charCodeAt(h),a<128?r+=1:a<2048?r+=2:(a&64512)===55296&&(s.charCodeAt(h+1)&64512)===56320?(++h,r+=4):r+=3;return r},t.read=function(s,r,a){var h=a-r;if(h<1)return"";for(var c=null,o=[],u=0,d;r<a;)d=s[r++],d<128?o[u++]=d:d>191&&d<224?o[u++]=(d&31)<<6|s[r++]&63:d>239&&d<365?(d=((d&7)<<18|(s[r++]&63)<<12|(s[r++]&63)<<6|s[r++]&63)-65536,o[u++]=55296+(d>>10),o[u++]=56320+(d&1023)):o[u++]=(d&15)<<12|(s[r++]&63)<<6|s[r++]&63,u>8191&&((c||(c=[])).push(String.fromCharCode.apply(String,o)),u=0);return c?(u&&c.push(String.fromCharCode.apply(String,o.slice(0,u))),c.join("")):String.fromCharCode.apply(String,o.slice(0,u))},t.write=function(s,r,a){for(var h=a,c,o,u=0;u<s.length;++u)c=s.charCodeAt(u),c<128?r[a++]=c:c<2048?(r[a++]=c>>6|192,r[a++]=c&63|128):(c&64512)===55296&&((o=s.charCodeAt(u+1))&64512)===56320?(c=65536+((c&1023)<<10)+(o&1023),++u,r[a++]=c>>18|240,r[a++]=c>>12&63|128,r[a++]=c>>6&63|128,r[a++]=c&63|128):(r[a++]=c>>12|224,r[a++]=c>>6&63|128,r[a++]=c&63|128);return a-h}})(utf8$2);var pool_1=pool$1;function pool$1(n,t,e){var s=e||8192,r=s>>>1,a=null,h=s;return function(o){if(o<1||o>r)return n(o);h+o>s&&(a=n(s),h=0);var u=t.call(a,h,h+=o);return h&7&&(h=(h|7)+1),u}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var n=requireMinimal();function t(a,h){this.lo=a>>>0,this.hi=h>>>0}var e=t.zero=new t(0,0);e.toNumber=function(){return 0},e.zzEncode=e.zzDecode=function(){return this},e.length=function(){return 1};var s=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(h){if(h===0)return e;var c=h<0;c&&(h=-h);var o=h>>>0,u=(h-o)/4294967296>>>0;return c&&(u=~u>>>0,o=~o>>>0,++o>4294967295&&(o=0,++u>4294967295&&(u=0))),new t(o,u)},t.from=function(h){if(typeof h=="number")return t.fromNumber(h);if(n.isString(h))if(n.Long)h=n.Long.fromString(h);else return t.fromNumber(parseInt(h,10));return h.low||h.high?new t(h.low>>>0,h.high>>>0):e},t.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var c=~this.lo+1>>>0,o=~this.hi>>>0;return c||(o=o+1>>>0),-(c+o*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(h){return n.Long?new n.Long(this.lo|0,this.hi|0,Boolean(h)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(h)}};var r=String.prototype.charCodeAt;return t.fromHash=function(h){return h===s?e:new t((r.call(h,0)|r.call(h,1)<<8|r.call(h,2)<<16|r.call(h,3)<<24)>>>0,(r.call(h,4)|r.call(h,5)<<8|r.call(h,6)<<16|r.call(h,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},t.prototype.zzDecode=function(){var h=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},t.prototype.length=function(){var h=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,o=this.hi>>>24;return o===0?c===0?h<16384?h<128?1:2:h<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:o<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(n){var t=n;t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=requireLongbits(),t.isNode=Boolean(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a},t.isString=function(a){return typeof a=="string"||a instanceof String},t.isObject=function(a){return a&&typeof a=="object"},t.isset=t.isSet=function(a,h){var c=a[h];return c!=null&&a.hasOwnProperty(h)?typeof c!="object"||(Array.isArray(c)?c.length:Object.keys(c).length)>0:!1},t.Buffer=function(){try{var r=t.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(a){return typeof a=="number"?t.Buffer?t._Buffer_allocUnsafe(a):new t.Array(a):t.Buffer?t._Buffer_from(a):typeof Uint8Array>"u"?a:new Uint8Array(a)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(a){return a?t.LongBits.from(a).toHash():t.LongBits.zeroHash},t.longFromHash=function(a,h){var c=t.LongBits.fromHash(a);return t.Long?t.Long.fromBits(c.lo,c.hi,h):c.toNumber(Boolean(h))};function e(r,a,h){for(var c=Object.keys(a),o=0;o<c.length;++o)(r[c[o]]===void 0||!h)&&(r[c[o]]=a[c[o]]);return r}t.merge=e,t.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)};function s(r){function a(h,c){if(!(this instanceof a))return new a(h,c);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,a):Object.defineProperty(this,"stack",{value:new Error().stack||""}),c&&e(this,c)}return a.prototype=Object.create(Error.prototype,{constructor:{value:a,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),a}t.newError=s,t.ProtocolError=s("ProtocolError"),t.oneOfGetter=function(a){for(var h={},c=0;c<a.length;++c)h[a[c]]=1;return function(){for(var o=Object.keys(this),u=o.length-1;u>-1;--u)if(h[o[u]]===1&&this[o[u]]!==void 0&&this[o[u]]!==null)return o[u]}},t.oneOfSetter=function(a){return function(h){for(var c=0;c<a.length;++c)a[c]!==h&&delete this[a[c]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var r=t.Buffer;if(!r){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=r.from!==Uint8Array.from&&r.from||function(h,c){return new r(h,c)},t._Buffer_allocUnsafe=r.allocUnsafe||function(h){return new r(h)}}}(minimal)),minimal}var writer=Writer$1,util$7=requireMinimal(),BufferWriter$1,LongBits$1=util$7.LongBits,base64=util$7.base64,utf8$1=util$7.utf8;function Op(n,t,e){this.fn=n,this.len=t,this.next=void 0,this.val=e}function noop(){}function State(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function n(){return util$7.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function n(t){return new util$7.Array(t)};util$7.Array!==Array&&(Writer$1.alloc=util$7.pool(Writer$1.alloc,util$7.Array.prototype.subarray));Writer$1.prototype._push=function n(t,e,s){return this.tail=this.tail.next=new Op(t,e,s),this.len+=e,this};function writeByte(n,t,e){t[e]=n&255}function writeVarint32(n,t,e){for(;n>127;)t[e++]=n&127|128,n>>>=7;t[e]=n}function VarintOp(n,t){this.len=n,this.next=void 0,this.val=t}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function n(t){return this.len+=(this.tail=this.tail.next=new VarintOp((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};Writer$1.prototype.int32=function n(t){return t<0?this._push(writeVarint64,10,LongBits$1.fromNumber(t)):this.uint32(t)};Writer$1.prototype.sint32=function n(t){return this.uint32((t<<1^t>>31)>>>0)};function writeVarint64(n,t,e){for(;n.hi;)t[e++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)t[e++]=n.lo&127|128,n.lo=n.lo>>>7;t[e++]=n.lo}Writer$1.prototype.uint64=function n(t){var e=LongBits$1.from(t);return this._push(writeVarint64,e.length(),e)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function n(t){var e=LongBits$1.from(t).zzEncode();return this._push(writeVarint64,e.length(),e)};Writer$1.prototype.bool=function n(t){return this._push(writeByte,1,t?1:0)};function writeFixed32(n,t,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24}Writer$1.prototype.fixed32=function n(t){return this._push(writeFixed32,4,t>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function n(t){var e=LongBits$1.from(t);return this._push(writeFixed32,4,e.lo)._push(writeFixed32,4,e.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function n(t){return this._push(util$7.float.writeFloatLE,4,t)};Writer$1.prototype.double=function n(t){return this._push(util$7.float.writeDoubleLE,8,t)};var writeBytes=util$7.Array.prototype.set?function n(t,e,s){e.set(t,s)}:function n(t,e,s){for(var r=0;r<t.length;++r)e[s+r]=t[r]};Writer$1.prototype.bytes=function n(t){var e=t.length>>>0;if(!e)return this._push(writeByte,1,0);if(util$7.isString(t)){var s=Writer$1.alloc(e=base64.length(t));base64.decode(t,s,0),t=s}return this.uint32(e)._push(writeBytes,e,t)};Writer$1.prototype.string=function n(t){var e=utf8$1.length(t);return e?this.uint32(e)._push(utf8$1.write,e,t):this._push(writeByte,1,0)};Writer$1.prototype.fork=function n(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this};Writer$1.prototype.reset=function n(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this};Writer$1.prototype.ldelim=function n(){var t=this.head,e=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=t.next,this.tail=e,this.len+=s),this};Writer$1.prototype.finish=function n(){for(var t=this.head.next,e=this.constructor.alloc(this.len),s=0;t;)t.fn(t.val,e,s),s+=t.len,t=t.next;return e};Writer$1._configure=function(n){BufferWriter$1=n,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$6=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$6._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$6.Buffer&&util$6.Buffer.prototype instanceof Uint8Array&&util$6.Buffer.prototype.set.name==="set"?function(t,e,s){e.set(t,s)}:function(t,e,s){if(t.copy)t.copy(e,s,0,t.length);else for(var r=0;r<t.length;)e[s++]=t[r++]}};BufferWriter.prototype.bytes=function n(t){util$6.isString(t)&&(t=util$6._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(BufferWriter.writeBytesBuffer,e,t),this};function writeStringBuffer(n,t,e){n.length<40?util$6.utf8.write(n,t,e):t.utf8Write?t.utf8Write(n,e):t.write(n,e)}BufferWriter.prototype.string=function n(t){var e=util$6.Buffer.byteLength(t);return this.uint32(e),e&&this._push(writeStringBuffer,e,t),this};BufferWriter._configure();var reader=Reader$1,util$5=requireMinimal(),BufferReader$1,LongBits=util$5.LongBits,utf8=util$5.utf8;function indexOutOfRange(n,t){return RangeError("index out of range: "+n.pos+" + "+(t||1)+" > "+n.len)}function Reader$1(n){this.buf=n,this.pos=0,this.len=n.length}var create_array=typeof Uint8Array<"u"?function n(t){if(t instanceof Uint8Array||Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")}:function n(t){if(Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")},create=function n(){return util$5.Buffer?function(e){return(Reader$1.create=function(r){return util$5.Buffer.isBuffer(r)?new BufferReader$1(r):create_array(r)})(e)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$5.Array.prototype.subarray||util$5.Array.prototype.slice;Reader$1.prototype.uint32=function n(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return t}}();Reader$1.prototype.int32=function n(){return this.uint32()|0};Reader$1.prototype.sint32=function n(){var t=this.uint32();return t>>>1^-(t&1)|0};function readLongVarint(){var n=new LongBits(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,n}if(this.len-this.pos>4){for(;t<5;++t)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function n(){return this.uint32()!==0};function readFixed32_end(n,t){return(n[t-4]|n[t-3]<<8|n[t-2]<<16|n[t-1]<<24)>>>0}Reader$1.prototype.fixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var t=util$5.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Reader$1.prototype.double=function n(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var t=util$5.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Reader$1.prototype.bytes=function n(){var t=this.uint32(),e=this.pos,s=this.pos+t;if(s>this.len)throw indexOutOfRange(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,s):e===s?new this.buf.constructor(0):this._slice.call(this.buf,e,s)};Reader$1.prototype.string=function n(){var t=this.bytes();return utf8.read(t,0,t.length)};Reader$1.prototype.skip=function n(t){if(typeof t=="number"){if(this.pos+t>this.len)throw indexOutOfRange(this,t);this.pos+=t}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Reader$1._configure=function(n){BufferReader$1=n,Reader$1.create=create(),BufferReader$1._configure();var t=util$5.Long?"toLong":"toNumber";util$5.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$4=requireMinimal();function BufferReader(n){Reader.call(this,n)}BufferReader._configure=function(){util$4.Buffer&&(BufferReader.prototype._slice=util$4.Buffer.prototype.slice)};BufferReader.prototype.string=function n(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};BufferReader._configure();var rpc={},service$1=Service$1,util$3=requireMinimal();(Service$1.prototype=Object.create(util$3.EventEmitter.prototype)).constructor=Service$1;function Service$1(n,t,e){if(typeof n!="function")throw TypeError("rpcImpl must be a function");util$3.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(e)}Service$1.prototype.rpcCall=function n(t,e,s,r,a){if(!r)throw TypeError("request must be specified");var h=this;if(!a)return util$3.asPromise(n,h,t,e,s,r);if(!h.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return h.rpcImpl(t,e[h.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(o,u){if(o)return h.emit("error",o,t),a(o);if(u===null){h.end(!0);return}if(!(u instanceof s))try{u=s[h.responseDelimited?"decodeDelimited":"decode"](u)}catch(d){return h.emit("error",d,t),a(d)}return h.emit("data",u,t),a(null,u)})}catch(c){h.emit("error",c,t),setTimeout(function(){a(c)},0);return}};Service$1.prototype.end=function n(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(n){var t=n;t.Service=service$1})(rpc);var roots={};(function(n){var t=n;t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=requireMinimal(),t.rpc=rpc,t.roots=roots,t.configure=e;function e(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}e()})(indexMinimal);var utilExports={},util$2={get exports(){return utilExports},set exports(n){utilExports=n}},codegen_1=codegen;function codegen(n,t){typeof n=="string"&&(t=n,n=void 0);var e=[];function s(a){if(typeof a!="string"){var h=r();if(codegen.verbose&&console.log("codegen: "+h),h="return "+h,a){for(var c=Object.keys(a),o=new Array(c.length+1),u=new Array(c.length),d=0;d<c.length;)o[d]=c[d],u[d]=a[c[d++]];return o[d]=h,Function.apply(null,o).apply(null,u)}return Function(h)()}for(var m=new Array(arguments.length-1),p=0;p<m.length;)m[p]=arguments[++p];if(p=0,a=a.replace(/%([%dfijs])/g,function(_,y){var v=m[p++];switch(y){case"d":case"f":return String(Number(v));case"i":return String(Math.floor(v));case"j":return JSON.stringify(v);case"s":return String(v)}return"%"}),p!==m.length)throw Error("parameter count mismatch");return e.push(a),s}function r(a){return"function "+(a||t||"")+"("+(n&&n.join(",")||"")+`){
  `+e.join(`
  `)+`
}`}return s.toString=r,s}codegen.verbose=!1;var fetch_1=fetch$1,asPromise=aspromise,inquire=inquire_1,fs=inquire("fs");function fetch$1(n,t,e){return typeof t=="function"?(e=t,t={}):t||(t={}),e?!t.xhr&&fs&&fs.readFile?fs.readFile(n,function(r,a){return r&&typeof XMLHttpRequest<"u"?fetch$1.xhr(n,t,e):r?e(r):e(null,t.binary?a:a.toString("utf8"))}):fetch$1.xhr(n,t,e):asPromise(fetch$1,this,n,t)}fetch$1.xhr=function n(t,e,s){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return s(Error("status "+r.status));if(e.binary){var h=r.response;if(!h){h=[];for(var c=0;c<r.responseText.length;++c)h.push(r.responseText.charCodeAt(c)&255)}return s(null,typeof Uint8Array<"u"?new Uint8Array(h):h)}return s(null,r.responseText)}},e.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",t),r.send()};var path={};(function(n){var t=n,e=t.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},s=t.normalize=function(a){a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var h=a.split("/"),c=e(a),o="";c&&(o=h.shift()+"/");for(var u=0;u<h.length;)h[u]===".."?u>0&&h[u-1]!==".."?h.splice(--u,2):c?h.splice(u,1):++u:h[u]==="."?h.splice(u,1):++u;return o+h.join("/")};t.resolve=function(a,h,c){return c||(h=s(h)),e(h)?h:(c||(a=s(a)),(a=a.replace(/(?:\/|^)[^/]+$/,"")).length?s(a+"/"+h):h)}})(path);var types$1={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(n){var t=n,e=requireUtil(),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function r(a,h){var c=0,o={};for(h|=0;c<a.length;)o[s[c+h]]=a[c++];return o}t.basic=r([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),t.defaults=r([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",e.emptyArray,null]),t.long=r([0,0,0,1,1],7),t.mapKey=r([0,0,0,5,5,0,0,0,1,1,0,2],2),t.packed=r([1,5,0,0,0,5,5,0,0,0,1,1,0])}(types$1)),types$1}var field,hasRequiredField;function requireField(){if(hasRequiredField)return field;hasRequiredField=1,field=h;var n=requireObject();((h.prototype=Object.create(n.prototype)).constructor=h).className="Field";var t=require_enum(),e=requireTypes(),s=requireUtil(),r,a=/^required|optional|repeated$/;h.fromJSON=function(o,u){return new h(o,u.id,u.type,u.rule,u.extend,u.options,u.comment)};function h(c,o,u,d,m,p,g){if(s.isObject(d)?(g=m,p=d,d=m=void 0):s.isObject(m)&&(g=p,p=m,m=void 0),n.call(this,c,p),!s.isInteger(o)||o<0)throw TypeError("id must be a non-negative integer");if(!s.isString(u))throw TypeError("type must be a string");if(d!==void 0&&!a.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(m!==void 0&&!s.isString(m))throw TypeError("extend must be a string");d==="proto3_optional"&&(d="optional"),this.rule=d&&d!=="optional"?d:void 0,this.type=u,this.id=o,this.extend=m||void 0,this.required=d==="required",this.optional=!this.required,this.repeated=d==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=s.Long?e.long[u]!==void 0:!1,this.bytes=u==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=g}return Object.defineProperty(h.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}}),h.prototype.setOption=function(o,u,d){return o==="packed"&&(this._packed=null),n.prototype.setOption.call(this,o,u,d)},h.prototype.toJSON=function(o){var u=o?Boolean(o.keepComments):!1;return s.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",u?this.comment:void 0])},h.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=e.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof r?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof t&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof t))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var o;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,o=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,o=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=o}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof r&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},h.d=function(o,u,d,m){return typeof u=="function"?u=s.decorateType(u).name:u&&typeof u=="object"&&(u=s.decorateEnum(u).name),function(g,_){s.decorateType(g.constructor).add(new h(_,o,u,d,{default:m}))}},h._configure=function(o){r=o},field}var oneof,hasRequiredOneof;function requireOneof(){if(hasRequiredOneof)return oneof;hasRequiredOneof=1,oneof=s;var n=requireObject();((s.prototype=Object.create(n.prototype)).constructor=s).className="OneOf";var t=requireField(),e=requireUtil();function s(a,h,c,o){if(Array.isArray(h)||(c=h,h=void 0),n.call(this,a,c),!(h===void 0||Array.isArray(h)))throw TypeError("fieldNames must be an Array");this.oneof=h||[],this.fieldsArray=[],this.comment=o}s.fromJSON=function(h,c){return new s(h,c.oneof,c.options,c.comment)},s.prototype.toJSON=function(h){var c=h?Boolean(h.keepComments):!1;return e.toObject(["options",this.options,"oneof",this.oneof,"comment",c?this.comment:void 0])};function r(a){if(a.parent)for(var h=0;h<a.fieldsArray.length;++h)a.fieldsArray[h].parent||a.parent.add(a.fieldsArray[h])}return s.prototype.add=function(h){if(!(h instanceof t))throw TypeError("field must be a Field");return h.parent&&h.parent!==this.parent&&h.parent.remove(h),this.oneof.push(h.name),this.fieldsArray.push(h),h.partOf=this,r(this),this},s.prototype.remove=function(h){if(!(h instanceof t))throw TypeError("field must be a Field");var c=this.fieldsArray.indexOf(h);if(c<0)throw Error(h+" is not a member of "+this);return this.fieldsArray.splice(c,1),c=this.oneof.indexOf(h.name),c>-1&&this.oneof.splice(c,1),h.partOf=null,this},s.prototype.onAdd=function(h){n.prototype.onAdd.call(this,h);for(var c=this,o=0;o<this.oneof.length;++o){var u=h.get(this.oneof[o]);u&&!u.partOf&&(u.partOf=c,c.fieldsArray.push(u))}r(this)},s.prototype.onRemove=function(h){for(var c=0,o;c<this.fieldsArray.length;++c)(o=this.fieldsArray[c]).parent&&o.parent.remove(o);n.prototype.onRemove.call(this,h)},s.d=function(){for(var h=new Array(arguments.length),c=0;c<arguments.length;)h[c]=arguments[c++];return function(u,d){e.decorateType(u.constructor).add(new s(d,h)),Object.defineProperty(u,d,{get:e.oneOfGetter(h),set:e.oneOfSetter(h)})}},oneof}var namespace,hasRequiredNamespace;function requireNamespace(){if(hasRequiredNamespace)return namespace;hasRequiredNamespace=1,namespace=o;var n=requireObject();((o.prototype=Object.create(n.prototype)).constructor=o).className="Namespace";var t=requireField(),e=requireUtil(),s=requireOneof(),r,a,h;o.fromJSON=function(m,p){return new o(m,p.options).addJSON(p.nested)};function c(d,m){if(d&&d.length){for(var p={},g=0;g<d.length;++g)p[d[g].name]=d[g].toJSON(m);return p}}o.arrayToJSON=c,o.isReservedId=function(m,p){if(m){for(var g=0;g<m.length;++g)if(typeof m[g]!="string"&&m[g][0]<=p&&m[g][1]>p)return!0}return!1},o.isReservedName=function(m,p){if(m){for(var g=0;g<m.length;++g)if(m[g]===p)return!0}return!1};function o(d,m){n.call(this,d,m),this.nested=void 0,this._nestedArray=null}function u(d){return d._nestedArray=null,d}return Object.defineProperty(o.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=e.toArray(this.nested))}}),o.prototype.toJSON=function(m){return e.toObject(["options",this.options,"nested",c(this.nestedArray,m)])},o.prototype.addJSON=function(m){var p=this;if(m)for(var g=Object.keys(m),_=0,y;_<g.length;++_)y=m[g[_]],p.add((y.fields!==void 0?r.fromJSON:y.values!==void 0?h.fromJSON:y.methods!==void 0?a.fromJSON:y.id!==void 0?t.fromJSON:o.fromJSON)(g[_],y));return this},o.prototype.get=function(m){return this.nested&&this.nested[m]||null},o.prototype.getEnum=function(m){if(this.nested&&this.nested[m]instanceof h)return this.nested[m].values;throw Error("no such enum: "+m)},o.prototype.add=function(m){if(!(m instanceof t&&m.extend!==void 0||m instanceof r||m instanceof s||m instanceof h||m instanceof a||m instanceof o))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var p=this.get(m.name);if(p)if(p instanceof o&&m instanceof o&&!(p instanceof r||p instanceof a)){for(var g=p.nestedArray,_=0;_<g.length;++_)m.add(g[_]);this.remove(p),this.nested||(this.nested={}),m.setOptions(p.options,!0)}else throw Error("duplicate name '"+m.name+"' in "+this)}return this.nested[m.name]=m,m.onAdd(this),u(this)},o.prototype.remove=function(m){if(!(m instanceof n))throw TypeError("object must be a ReflectionObject");if(m.parent!==this)throw Error(m+" is not a member of "+this);return delete this.nested[m.name],Object.keys(this.nested).length||(this.nested=void 0),m.onRemove(this),u(this)},o.prototype.define=function(m,p){if(e.isString(m))m=m.split(".");else if(!Array.isArray(m))throw TypeError("illegal path");if(m&&m.length&&m[0]==="")throw Error("path must be relative");for(var g=this;m.length>0;){var _=m.shift();if(g.nested&&g.nested[_]){if(g=g.nested[_],!(g instanceof o))throw Error("path conflicts with non-namespace objects")}else g.add(g=new o(_))}return p&&g.addJSON(p),g},o.prototype.resolveAll=function(){for(var m=this.nestedArray,p=0;p<m.length;)m[p]instanceof o?m[p++].resolveAll():m[p++].resolve();return this.resolve()},o.prototype.lookup=function(m,p,g){if(typeof p=="boolean"?(g=p,p=void 0):p&&!Array.isArray(p)&&(p=[p]),e.isString(m)&&m.length){if(m===".")return this.root;m=m.split(".")}else if(!m.length)return this;if(m[0]==="")return this.root.lookup(m.slice(1),p);var _=this.get(m[0]);if(_){if(m.length===1){if(!p||p.indexOf(_.constructor)>-1)return _}else if(_ instanceof o&&(_=_.lookup(m.slice(1),p,!0)))return _}else for(var y=0;y<this.nestedArray.length;++y)if(this._nestedArray[y]instanceof o&&(_=this._nestedArray[y].lookup(m,p,!0)))return _;return this.parent===null||g?null:this.parent.lookup(m,p)},o.prototype.lookupType=function(m){var p=this.lookup(m,[r]);if(!p)throw Error("no such type: "+m);return p},o.prototype.lookupEnum=function(m){var p=this.lookup(m,[h]);if(!p)throw Error("no such Enum '"+m+"' in "+this);return p},o.prototype.lookupTypeOrEnum=function(m){var p=this.lookup(m,[r,h]);if(!p)throw Error("no such Type or Enum '"+m+"' in "+this);return p},o.prototype.lookupService=function(m){var p=this.lookup(m,[a]);if(!p)throw Error("no such Service '"+m+"' in "+this);return p},o._configure=function(d,m,p){r=d,a=m,h=p},namespace}var mapfield,hasRequiredMapfield;function requireMapfield(){if(hasRequiredMapfield)return mapfield;hasRequiredMapfield=1,mapfield=s;var n=requireField();((s.prototype=Object.create(n.prototype)).constructor=s).className="MapField";var t=requireTypes(),e=requireUtil();function s(r,a,h,c,o,u){if(n.call(this,r,a,c,void 0,void 0,o,u),!e.isString(h))throw TypeError("keyType must be a string");this.keyType=h,this.resolvedKeyType=null,this.map=!0}return s.fromJSON=function(a,h){return new s(a,h.id,h.keyType,h.type,h.options,h.comment)},s.prototype.toJSON=function(a){var h=a?Boolean(a.keepComments):!1;return e.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",h?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(t.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},s.d=function(a,h,c){return typeof c=="function"?c=e.decorateType(c).name:c&&typeof c=="object"&&(c=e.decorateEnum(c).name),function(u,d){e.decorateType(u.constructor).add(new s(d,a,h,c))}},mapfield}var method,hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return method;hasRequiredMethod=1,method=e;var n=requireObject();((e.prototype=Object.create(n.prototype)).constructor=e).className="Method";var t=requireUtil();function e(s,r,a,h,c,o,u,d,m){if(t.isObject(c)?(u=c,c=o=void 0):t.isObject(o)&&(u=o,o=void 0),!(r===void 0||t.isString(r)))throw TypeError("type must be a string");if(!t.isString(a))throw TypeError("requestType must be a string");if(!t.isString(h))throw TypeError("responseType must be a string");n.call(this,s,u),this.type=r||"rpc",this.requestType=a,this.requestStream=c?!0:void 0,this.responseType=h,this.responseStream=o?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=d,this.parsedOptions=m}return e.fromJSON=function(r,a){return new e(r,a.type,a.requestType,a.responseType,a.requestStream,a.responseStream,a.options,a.comment,a.parsedOptions)},e.prototype.toJSON=function(r){var a=r?Boolean(r.keepComments):!1;return t.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",a?this.comment:void 0,"parsedOptions",this.parsedOptions])},e.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))},method}var service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=r;var n=requireNamespace();((r.prototype=Object.create(n.prototype)).constructor=r).className="Service";var t=requireMethod(),e=requireUtil(),s=rpc;function r(h,c){n.call(this,h,c),this.methods={},this._methodsArray=null}r.fromJSON=function(c,o){var u=new r(c,o.options);if(o.methods)for(var d=Object.keys(o.methods),m=0;m<d.length;++m)u.add(t.fromJSON(d[m],o.methods[d[m]]));return o.nested&&u.addJSON(o.nested),u.comment=o.comment,u},r.prototype.toJSON=function(c){var o=n.prototype.toJSON.call(this,c),u=c?Boolean(c.keepComments):!1;return e.toObject(["options",o&&o.options||void 0,"methods",n.arrayToJSON(this.methodsArray,c)||{},"nested",o&&o.nested||void 0,"comment",u?this.comment:void 0])},Object.defineProperty(r.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=e.toArray(this.methods))}});function a(h){return h._methodsArray=null,h}return r.prototype.get=function(c){return this.methods[c]||n.prototype.get.call(this,c)},r.prototype.resolveAll=function(){for(var c=this.methodsArray,o=0;o<c.length;++o)c[o].resolve();return n.prototype.resolve.call(this)},r.prototype.add=function(c){if(this.get(c.name))throw Error("duplicate name '"+c.name+"' in "+this);return c instanceof t?(this.methods[c.name]=c,c.parent=this,a(this)):n.prototype.add.call(this,c)},r.prototype.remove=function(c){if(c instanceof t){if(this.methods[c.name]!==c)throw Error(c+" is not a member of "+this);return delete this.methods[c.name],c.parent=null,a(this)}return n.prototype.remove.call(this,c)},r.prototype.create=function(c,o,u){for(var d=new s.Service(c,o,u),m=0,p;m<this.methodsArray.length;++m){var g=e.lcFirst((p=this._methodsArray[m]).resolve().name).replace(/[^$\w_]/g,"");d[g]=e.codegen(["r","c"],e.isReserved(g)?g+"_":g)("return this.rpcCall(m,q,s,r,c)")({m:p,q:p.resolvedRequestType.ctor,s:p.resolvedResponseType.ctor})}return d},service}var message=Message,util$1=requireMinimal();function Message(n){if(n)for(var t=Object.keys(n),e=0;e<t.length;++e)this[t[e]]=n[t[e]]}Message.create=function n(t){return this.$type.create(t)};Message.encode=function n(t,e){return this.$type.encode(t,e)};Message.encodeDelimited=function n(t,e){return this.$type.encodeDelimited(t,e)};Message.decode=function n(t){return this.$type.decode(t)};Message.decodeDelimited=function n(t){return this.$type.decodeDelimited(t)};Message.verify=function n(t){return this.$type.verify(t)};Message.fromObject=function n(t){return this.$type.fromObject(t)};Message.toObject=function n(t,e){return this.$type.toObject(t,e)};Message.prototype.toJSON=function n(){return this.$type.toObject(this,util$1.toJSONOptions)};var decoder_1,hasRequiredDecoder;function requireDecoder(){if(hasRequiredDecoder)return decoder_1;hasRequiredDecoder=1,decoder_1=r;var n=require_enum(),t=requireTypes(),e=requireUtil();function s(a){return"missing required '"+a.name+"'"}function r(a){var h=e.codegen(["r","l"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(p){return p.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");a.group&&h("if((t&7)===4)")("break"),h("switch(t>>>3){");for(var c=0;c<a.fieldsArray.length;++c){var o=a._fieldsArray[c].resolve(),u=o.resolvedType instanceof n?"int32":o.type,d="m"+e.safeProp(o.name);h("case %i: {",o.id),o.map?(h("if(%s===util.emptyObject)",d)("%s={}",d)("var c2 = r.uint32()+r.pos"),t.defaults[o.keyType]!==void 0?h("k=%j",t.defaults[o.keyType]):h("k=null"),t.defaults[u]!==void 0?h("value=%j",t.defaults[u]):h("value=null"),h("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",o.keyType)("case 2:"),t.basic[u]===void 0?h("value=types[%i].decode(r,r.uint32())",c):h("value=r.%s()",u),h("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),t.long[o.keyType]!==void 0?h('%s[typeof k==="object"?util.longToHash(k):k]=value',d):h("%s[k]=value",d)):o.repeated?(h("if(!(%s&&%s.length))",d,d)("%s=[]",d),t.packed[u]!==void 0&&h("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",d,u)("}else"),t.basic[u]===void 0?h(o.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",d,c):h("%s.push(r.%s())",d,u)):t.basic[u]===void 0?h(o.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",d,c):h("%s=r.%s()",d,u),h("break")("}")}for(h("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var m=a._fieldsArray[c];m.required&&h("if(!m.hasOwnProperty(%j))",m.name)("throw util.ProtocolError(%j,{instance:m})",s(m))}return h("return m")}return decoder_1}var verifier_1,hasRequiredVerifier;function requireVerifier(){if(hasRequiredVerifier)return verifier_1;hasRequiredVerifier=1,verifier_1=a;var n=require_enum(),t=requireUtil();function e(h,c){return h.name+": "+c+(h.repeated&&c!=="array"?"[]":h.map&&c!=="object"?"{k:"+h.keyType+"}":"")+" expected"}function s(h,c,o,u){if(c.resolvedType)if(c.resolvedType instanceof n){h("switch(%s){",u)("default:")("return%j",e(c,"enum value"));for(var d=Object.keys(c.resolvedType.values),m=0;m<d.length;++m)h("case %i:",c.resolvedType.values[d[m]]);h("break")("}")}else h("{")("var e=types[%i].verify(%s);",o,u)("if(e)")("return%j+e",c.name+".")("}");else switch(c.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":h("if(!util.isInteger(%s))",u)("return%j",e(c,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":h("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",u,u,u,u)("return%j",e(c,"integer|Long"));break;case"float":case"double":h('if(typeof %s!=="number")',u)("return%j",e(c,"number"));break;case"bool":h('if(typeof %s!=="boolean")',u)("return%j",e(c,"boolean"));break;case"string":h("if(!util.isString(%s))",u)("return%j",e(c,"string"));break;case"bytes":h('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',u,u,u)("return%j",e(c,"buffer"));break}return h}function r(h,c,o){switch(c.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":h("if(!util.key32Re.test(%s))",o)("return%j",e(c,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":h("if(!util.key64Re.test(%s))",o)("return%j",e(c,"integer|Long key"));break;case"bool":h("if(!util.key2Re.test(%s))",o)("return%j",e(c,"boolean key"));break}return h}function a(h){var c=t.codegen(["m"],h.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),o=h.oneofsArray,u={};o.length&&c("var p={}");for(var d=0;d<h.fieldsArray.length;++d){var m=h._fieldsArray[d].resolve(),p="m"+t.safeProp(m.name);if(m.optional&&c("if(%s!=null&&m.hasOwnProperty(%j)){",p,m.name),m.map)c("if(!util.isObject(%s))",p)("return%j",e(m,"object"))("var k=Object.keys(%s)",p)("for(var i=0;i<k.length;++i){"),r(c,m,"k[i]"),s(c,m,d,p+"[k[i]]")("}");else if(m.repeated)c("if(!Array.isArray(%s))",p)("return%j",e(m,"array"))("for(var i=0;i<%s.length;++i){",p),s(c,m,d,p+"[i]")("}");else{if(m.partOf){var g=t.safeProp(m.partOf.name);u[m.partOf.name]===1&&c("if(p%s===1)",g)("return%j",m.partOf.name+": multiple values"),u[m.partOf.name]=1,c("p%s=1",g)}s(c,m,d,p)}m.optional&&c("}")}return c("return null")}return verifier_1}var converter={},hasRequiredConverter;function requireConverter(){return hasRequiredConverter||(hasRequiredConverter=1,function(n){var t=n,e=require_enum(),s=requireUtil();function r(h,c,o,u){var d=!1;if(c.resolvedType)if(c.resolvedType instanceof e){h("switch(d%s){",u);for(var m=c.resolvedType.values,p=Object.keys(m),g=0;g<p.length;++g)m[p[g]]===c.typeDefault&&!d&&(h("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',u,u,u),c.repeated||h("break"),d=!0),h("case%j:",p[g])("case %i:",m[p[g]])("m%s=%j",u,m[p[g]])("break");h("}")}else h('if(typeof d%s!=="object")',u)("throw TypeError(%j)",c.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",u,o,u);else{var _=!1;switch(c.type){case"double":case"float":h("m%s=Number(d%s)",u,u);break;case"uint32":case"fixed32":h("m%s=d%s>>>0",u,u);break;case"int32":case"sint32":case"sfixed32":h("m%s=d%s|0",u,u);break;case"uint64":_=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":h("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",u,u,_)('else if(typeof d%s==="string")',u)("m%s=parseInt(d%s,10)",u,u)('else if(typeof d%s==="number")',u)("m%s=d%s",u,u)('else if(typeof d%s==="object")',u)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",u,u,u,_?"true":"");break;case"bytes":h('if(typeof d%s==="string")',u)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",u,u,u)("else if(d%s.length >= 0)",u)("m%s=d%s",u,u);break;case"string":h("m%s=String(d%s)",u,u);break;case"bool":h("m%s=Boolean(d%s)",u,u);break}}return h}t.fromObject=function(c){var o=c.fieldsArray,u=s.codegen(["d"],c.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!o.length)return u("return new this.ctor");u("var m=new this.ctor");for(var d=0;d<o.length;++d){var m=o[d].resolve(),p=s.safeProp(m.name);m.map?(u("if(d%s){",p)('if(typeof d%s!=="object")',p)("throw TypeError(%j)",m.fullName+": object expected")("m%s={}",p)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",p),r(u,m,d,p+"[ks[i]]")("}")("}")):m.repeated?(u("if(d%s){",p)("if(!Array.isArray(d%s))",p)("throw TypeError(%j)",m.fullName+": array expected")("m%s=[]",p)("for(var i=0;i<d%s.length;++i){",p),r(u,m,d,p+"[i]")("}")("}")):(m.resolvedType instanceof e||u("if(d%s!=null){",p),r(u,m,d,p),m.resolvedType instanceof e||u("}"))}return u("return m")};function a(h,c,o,u){if(c.resolvedType)c.resolvedType instanceof e?h("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",u,o,u,u,o,u,u):h("d%s=types[%i].toObject(m%s,o)",u,o,u);else{var d=!1;switch(c.type){case"double":case"float":h("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",u,u,u,u);break;case"uint64":d=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":h('if(typeof m%s==="number")',u)("d%s=o.longs===String?String(m%s):m%s",u,u,u)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",u,u,u,u,d?"true":"",u);break;case"bytes":h("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",u,u,u,u,u);break;default:h("d%s=m%s",u,u);break}}return h}t.toObject=function(c){var o=c.fieldsArray.slice().sort(s.compareFieldsById);if(!o.length)return s.codegen()("return {}");for(var u=s.codegen(["m","o"],c.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],m=[],p=[],g=0;g<o.length;++g)o[g].partOf||(o[g].resolve().repeated?d:o[g].map?m:p).push(o[g]);if(d.length){for(u("if(o.arrays||o.defaults){"),g=0;g<d.length;++g)u("d%s=[]",s.safeProp(d[g].name));u("}")}if(m.length){for(u("if(o.objects||o.defaults){"),g=0;g<m.length;++g)u("d%s={}",s.safeProp(m[g].name));u("}")}if(p.length){for(u("if(o.defaults){"),g=0;g<p.length;++g){var _=p[g],y=s.safeProp(_.name);if(_.resolvedType instanceof e)u("d%s=o.enums===String?%j:%j",y,_.resolvedType.valuesById[_.typeDefault],_.typeDefault);else if(_.long)u("if(util.Long){")("var n=new util.Long(%i,%i,%j)",_.typeDefault.low,_.typeDefault.high,_.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",y)("}else")("d%s=o.longs===String?%j:%i",y,_.typeDefault.toString(),_.typeDefault.toNumber());else if(_.bytes){var v="["+Array.prototype.slice.call(_.typeDefault).join(",")+"]";u("if(o.bytes===String)d%s=%j",y,String.fromCharCode.apply(String,_.typeDefault))("else{")("d%s=%s",y,v)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",y,y)("}")}else u("d%s=%j",y,_.typeDefault)}u("}")}var U=!1;for(g=0;g<o.length;++g){var _=o[g],w=c._fieldsArray.indexOf(_),y=s.safeProp(_.name);_.map?(U||(U=!0,u("var ks2")),u("if(m%s&&(ks2=Object.keys(m%s)).length){",y,y)("d%s={}",y)("for(var j=0;j<ks2.length;++j){"),a(u,_,w,y+"[ks2[j]]")("}")):_.repeated?(u("if(m%s&&m%s.length){",y,y)("d%s=[]",y)("for(var j=0;j<m%s.length;++j){",y),a(u,_,w,y+"[j]")("}")):(u("if(m%s!=null&&m.hasOwnProperty(%j)){",y,_.name),a(u,_,w,y),_.partOf&&u("if(o.oneofs)")("d%s=%j",s.safeProp(_.partOf.name),_.name)),u("}")}return u("return d")}}(converter)),converter}var wrappers={};(function(n){var t=n,e=message;t[".google.protobuf.Any"]={fromObject:function(s){if(s&&s["@type"]){var r=s["@type"].substring(s["@type"].lastIndexOf("/")+1),a=this.lookup(r);if(a){var h=s["@type"].charAt(0)==="."?s["@type"].slice(1):s["@type"];return h.indexOf("/")===-1&&(h="/"+h),this.create({type_url:h,value:a.encode(a.fromObject(s)).finish()})}}return this.fromObject(s)},toObject:function(s,r){var a="type.googleapis.com/",h="",c="";if(r&&r.json&&s.type_url&&s.value){c=s.type_url.substring(s.type_url.lastIndexOf("/")+1),h=s.type_url.substring(0,s.type_url.lastIndexOf("/")+1);var o=this.lookup(c);o&&(s=o.decode(s.value))}if(!(s instanceof this.ctor)&&s instanceof e){var u=s.$type.toObject(s,r),d=s.$type.fullName[0]==="."?s.$type.fullName.slice(1):s.$type.fullName;return h===""&&(h=a),c=h+d,u["@type"]=c,u}return this.toObject(s,r)}}})(wrappers);var type,hasRequiredType;function requireType(){if(hasRequiredType)return type;hasRequiredType=1,type=y;var n=requireNamespace();((y.prototype=Object.create(n.prototype)).constructor=y).className="Type";var t=require_enum(),e=requireOneof(),s=requireField(),r=requireMapfield(),a=requireService(),h=message,c=reader,o=writer,u=requireUtil(),d=requireEncoder(),m=requireDecoder(),p=requireVerifier(),g=requireConverter(),_=wrappers;function y(U,w){n.call(this,U,w),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var U=Object.keys(this.fields),w=0;w<U.length;++w){var k=this.fields[U[w]],N=k.id;if(this._fieldsById[N])throw Error("duplicate id "+N+" in "+this);this._fieldsById[N]=k}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=u.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=u.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(U){var w=U.prototype;w instanceof h||((U.prototype=new h).constructor=U,u.merge(U.prototype,w)),U.$type=U.prototype.$type=this,u.merge(U,h,!0),this._ctor=U;for(var k=0;k<this.fieldsArray.length;++k)this._fieldsArray[k].resolve();var N={};for(k=0;k<this.oneofsArray.length;++k)N[this._oneofsArray[k].resolve().name]={get:u.oneOfGetter(this._oneofsArray[k].oneof),set:u.oneOfSetter(this._oneofsArray[k].oneof)};k&&Object.defineProperties(U.prototype,N)}}}),y.generateConstructor=function(w){for(var k=u.codegen(["p"],w.name),N=0,W;N<w.fieldsArray.length;++N)(W=w._fieldsArray[N]).map?k("this%s={}",u.safeProp(W.name)):W.repeated&&k("this%s=[]",u.safeProp(W.name));return k("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function v(U){return U._fieldsById=U._fieldsArray=U._oneofsArray=null,delete U.encode,delete U.decode,delete U.verify,U}return y.fromJSON=function(w,k){var N=new y(w,k.options);N.extensions=k.extensions,N.reserved=k.reserved;for(var W=Object.keys(k.fields),et=0;et<W.length;++et)N.add((typeof k.fields[W[et]].keyType<"u"?r.fromJSON:s.fromJSON)(W[et],k.fields[W[et]]));if(k.oneofs)for(W=Object.keys(k.oneofs),et=0;et<W.length;++et)N.add(e.fromJSON(W[et],k.oneofs[W[et]]));if(k.nested)for(W=Object.keys(k.nested),et=0;et<W.length;++et){var it=k.nested[W[et]];N.add((it.id!==void 0?s.fromJSON:it.fields!==void 0?y.fromJSON:it.values!==void 0?t.fromJSON:it.methods!==void 0?a.fromJSON:n.fromJSON)(W[et],it))}return k.extensions&&k.extensions.length&&(N.extensions=k.extensions),k.reserved&&k.reserved.length&&(N.reserved=k.reserved),k.group&&(N.group=!0),k.comment&&(N.comment=k.comment),N},y.prototype.toJSON=function(w){var k=n.prototype.toJSON.call(this,w),N=w?Boolean(w.keepComments):!1;return u.toObject(["options",k&&k.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,w),"fields",n.arrayToJSON(this.fieldsArray.filter(function(W){return!W.declaringField}),w)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",k&&k.nested||void 0,"comment",N?this.comment:void 0])},y.prototype.resolveAll=function(){for(var w=this.fieldsArray,k=0;k<w.length;)w[k++].resolve();var N=this.oneofsArray;for(k=0;k<N.length;)N[k++].resolve();return n.prototype.resolveAll.call(this)},y.prototype.get=function(w){return this.fields[w]||this.oneofs&&this.oneofs[w]||this.nested&&this.nested[w]||null},y.prototype.add=function(w){if(this.get(w.name))throw Error("duplicate name '"+w.name+"' in "+this);if(w instanceof s&&w.extend===void 0){if(this._fieldsById?this._fieldsById[w.id]:this.fieldsById[w.id])throw Error("duplicate id "+w.id+" in "+this);if(this.isReservedId(w.id))throw Error("id "+w.id+" is reserved in "+this);if(this.isReservedName(w.name))throw Error("name '"+w.name+"' is reserved in "+this);return w.parent&&w.parent.remove(w),this.fields[w.name]=w,w.message=this,w.onAdd(this),v(this)}return w instanceof e?(this.oneofs||(this.oneofs={}),this.oneofs[w.name]=w,w.onAdd(this),v(this)):n.prototype.add.call(this,w)},y.prototype.remove=function(w){if(w instanceof s&&w.extend===void 0){if(!this.fields||this.fields[w.name]!==w)throw Error(w+" is not a member of "+this);return delete this.fields[w.name],w.parent=null,w.onRemove(this),v(this)}if(w instanceof e){if(!this.oneofs||this.oneofs[w.name]!==w)throw Error(w+" is not a member of "+this);return delete this.oneofs[w.name],w.parent=null,w.onRemove(this),v(this)}return n.prototype.remove.call(this,w)},y.prototype.isReservedId=function(w){return n.isReservedId(this.reserved,w)},y.prototype.isReservedName=function(w){return n.isReservedName(this.reserved,w)},y.prototype.create=function(w){return new this.ctor(w)},y.prototype.setup=function(){for(var w=this.fullName,k=[],N=0;N<this.fieldsArray.length;++N)k.push(this._fieldsArray[N].resolve().resolvedType);this.encode=d(this)({Writer:o,types:k,util:u}),this.decode=m(this)({Reader:c,types:k,util:u}),this.verify=p(this)({types:k,util:u}),this.fromObject=g.fromObject(this)({types:k,util:u}),this.toObject=g.toObject(this)({types:k,util:u});var W=_[w];if(W){var et=Object.create(this);et.fromObject=this.fromObject,this.fromObject=W.fromObject.bind(et),et.toObject=this.toObject,this.toObject=W.toObject.bind(et)}return this},y.prototype.encode=function(w,k){return this.setup().encode(w,k)},y.prototype.encodeDelimited=function(w,k){return this.encode(w,k&&k.len?k.fork():k).ldelim()},y.prototype.decode=function(w,k){return this.setup().decode(w,k)},y.prototype.decodeDelimited=function(w){return w instanceof c||(w=c.create(w)),this.decode(w,w.uint32())},y.prototype.verify=function(w){return this.setup().verify(w)},y.prototype.fromObject=function(w){return this.setup().fromObject(w)},y.prototype.toObject=function(w,k){return this.setup().toObject(w,k)},y.d=function(w){return function(N){u.decorateType(N,w)}},type}var root,hasRequiredRoot;function requireRoot(){if(hasRequiredRoot)return root;hasRequiredRoot=1,root=o;var n=requireNamespace();((o.prototype=Object.create(n.prototype)).constructor=o).className="Root";var t=requireField(),e=require_enum(),s=requireOneof(),r=requireUtil(),a,h,c;function o(p){n.call(this,"",p),this.deferred=[],this.files=[]}o.fromJSON=function(g,_){return _||(_=new o),g.options&&_.setOptions(g.options),_.addJSON(g.nested)},o.prototype.resolvePath=r.path.resolve,o.prototype.fetch=r.fetch;function u(){}o.prototype.load=function p(g,_,y){typeof _=="function"&&(y=_,_=void 0);var v=this;if(!y)return r.asPromise(p,v,g,_);var U=y===u;function w(mt,xt){if(y){var yt=y;if(y=null,U)throw mt;yt(mt,xt)}}function k(mt){var xt=mt.lastIndexOf("google/protobuf/");if(xt>-1){var yt=mt.substring(xt);if(yt in c)return yt}return null}function N(mt,xt){try{if(r.isString(xt)&&xt.charAt(0)==="{"&&(xt=JSON.parse(xt)),!r.isString(xt))v.setOptions(xt.options).addJSON(xt.nested);else{h.filename=mt;var yt=h(xt,v,_),vt,St=0;if(yt.imports)for(;St<yt.imports.length;++St)(vt=k(yt.imports[St])||v.resolvePath(mt,yt.imports[St]))&&W(vt);if(yt.weakImports)for(St=0;St<yt.weakImports.length;++St)(vt=k(yt.weakImports[St])||v.resolvePath(mt,yt.weakImports[St]))&&W(vt,!0)}}catch(wt){w(wt)}!U&&!et&&w(null,v)}function W(mt,xt){if(mt=k(mt)||mt,!(v.files.indexOf(mt)>-1)){if(v.files.push(mt),mt in c){U?N(mt,c[mt]):(++et,setTimeout(function(){--et,N(mt,c[mt])}));return}if(U){var yt;try{yt=r.fs.readFileSync(mt).toString("utf8")}catch(vt){xt||w(vt);return}N(mt,yt)}else++et,v.fetch(mt,function(vt,St){if(--et,!!y){if(vt){xt?et||w(null,v):w(vt);return}N(mt,St)}})}}var et=0;r.isString(g)&&(g=[g]);for(var it=0,ft;it<g.length;++it)(ft=v.resolvePath("",g[it]))&&W(ft);if(U)return v;et||w(null,v)},o.prototype.loadSync=function(g,_){if(!r.isNode)throw Error("not supported");return this.load(g,_,u)},o.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(g){return"'extend "+g.extend+"' in "+g.parent.fullName}).join(", "));return n.prototype.resolveAll.call(this)};var d=/^[A-Z]/;function m(p,g){var _=g.parent.lookup(g.extend);if(_){var y=new t(g.fullName,g.id,g.type,g.rule,void 0,g.options);return _.get(y.name)||(y.declaringField=g,g.extensionField=y,_.add(y)),!0}return!1}return o.prototype._handleAdd=function(g){if(g instanceof t)g.extend!==void 0&&!g.extensionField&&(m(this,g)||this.deferred.push(g));else if(g instanceof e)d.test(g.name)&&(g.parent[g.name]=g.values);else if(!(g instanceof s)){if(g instanceof a)for(var _=0;_<this.deferred.length;)m(this,this.deferred[_])?this.deferred.splice(_,1):++_;for(var y=0;y<g.nestedArray.length;++y)this._handleAdd(g._nestedArray[y]);d.test(g.name)&&(g.parent[g.name]=g)}},o.prototype._handleRemove=function(g){if(g instanceof t){if(g.extend!==void 0)if(g.extensionField)g.extensionField.parent.remove(g.extensionField),g.extensionField=null;else{var _=this.deferred.indexOf(g);_>-1&&this.deferred.splice(_,1)}}else if(g instanceof e)d.test(g.name)&&delete g.parent[g.name];else if(g instanceof n){for(var y=0;y<g.nestedArray.length;++y)this._handleRemove(g._nestedArray[y]);d.test(g.name)&&delete g.parent[g.name]}},o._configure=function(p,g,_){a=p,h=g,c=_},root}var hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,function(n){var t=n.exports=requireMinimal(),e=roots,s,r;t.codegen=codegen_1,t.fetch=fetch_1,t.path=path,t.fs=t.inquire("fs"),t.toArray=function(d){if(d){for(var m=Object.keys(d),p=new Array(m.length),g=0;g<m.length;)p[g]=d[m[g++]];return p}return[]},t.toObject=function(d){for(var m={},p=0;p<d.length;){var g=d[p++],_=d[p++];_!==void 0&&(m[g]=_)}return m};var a=/\\/g,h=/"/g;t.isReserved=function(d){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(d)},t.safeProp=function(d){return!/^[$\w_]+$/.test(d)||t.isReserved(d)?'["'+d.replace(a,"\\\\").replace(h,'\\"')+'"]':"."+d},t.ucFirst=function(d){return d.charAt(0).toUpperCase()+d.substring(1)};var c=/_([a-z])/g;t.camelCase=function(d){return d.substring(0,1)+d.substring(1).replace(c,function(m,p){return p.toUpperCase()})},t.compareFieldsById=function(d,m){return d.id-m.id},t.decorateType=function(d,m){if(d.$type)return m&&d.$type.name!==m&&(t.decorateRoot.remove(d.$type),d.$type.name=m,t.decorateRoot.add(d.$type)),d.$type;s||(s=requireType());var p=new s(m||d.name);return t.decorateRoot.add(p),p.ctor=d,Object.defineProperty(d,"$type",{value:p,enumerable:!1}),Object.defineProperty(d.prototype,"$type",{value:p,enumerable:!1}),p};var o=0;t.decorateEnum=function(d){if(d.$type)return d.$type;r||(r=require_enum());var m=new r("Enum"+o++,d);return t.decorateRoot.add(m),Object.defineProperty(d,"$type",{value:m,enumerable:!1}),m},t.setProperty=function(d,m,p){function g(_,y,v){var U=y.shift();if(U==="__proto__")return _;if(y.length>0)_[U]=g(_[U]||{},y,v);else{var w=_[U];w&&(v=[].concat(w).concat(v)),_[U]=v}return _}if(typeof d!="object")throw TypeError("dst must be an object");if(!m)throw TypeError("path must be specified");return m=m.split("."),g(d,m,p)},Object.defineProperty(t,"decorateRoot",{get:function(){return e.decorated||(e.decorated=new(requireRoot()))}})}(util$2)),utilExports}var object,hasRequiredObject;function requireObject(){if(hasRequiredObject)return object;hasRequiredObject=1,object=e,e.className="ReflectionObject";var n=requireUtil(),t;function e(s,r){if(!n.isString(s))throw TypeError("name must be a string");if(r&&!n.isObject(r))throw TypeError("options must be an object");this.options=r,this.parsedOptions=null,this.name=s,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}return Object.defineProperties(e.prototype,{root:{get:function(){for(var s=this;s.parent!==null;)s=s.parent;return s}},fullName:{get:function(){for(var s=[this.name],r=this.parent;r;)s.unshift(r.name),r=r.parent;return s.join(".")}}}),e.prototype.toJSON=function(){throw Error()},e.prototype.onAdd=function(r){this.parent&&this.parent!==r&&this.parent.remove(this),this.parent=r,this.resolved=!1;var a=r.root;a instanceof t&&a._handleAdd(this)},e.prototype.onRemove=function(r){var a=r.root;a instanceof t&&a._handleRemove(this),this.parent=null,this.resolved=!1},e.prototype.resolve=function(){return this.resolved?this:(this.root instanceof t&&(this.resolved=!0),this)},e.prototype.getOption=function(r){if(this.options)return this.options[r]},e.prototype.setOption=function(r,a,h){return(!h||!this.options||this.options[r]===void 0)&&((this.options||(this.options={}))[r]=a),this},e.prototype.setParsedOption=function(r,a,h){this.parsedOptions||(this.parsedOptions=[]);var c=this.parsedOptions;if(h){var o=c.find(function(m){return Object.prototype.hasOwnProperty.call(m,r)});if(o){var u=o[r];n.setProperty(u,h,a)}else o={},o[r]=n.setProperty({},h,a),c.push(o)}else{var d={};d[r]=a,c.push(d)}return this},e.prototype.setOptions=function(r,a){if(r)for(var h=Object.keys(r),c=0;c<h.length;++c)this.setOption(h[c],r[h[c]],a);return this},e.prototype.toString=function(){var r=this.constructor.className,a=this.fullName;return a.length?r+" "+a:r},e._configure=function(s){t=s},object}var _enum,hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,_enum=s;var n=requireObject();((s.prototype=Object.create(n.prototype)).constructor=s).className="Enum";var t=requireNamespace(),e=requireUtil();function s(r,a,h,c,o,u){if(n.call(this,r,h),a&&typeof a!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=c,this.comments=o||{},this.valuesOptions=u,this.reserved=void 0,a)for(var d=Object.keys(a),m=0;m<d.length;++m)typeof a[d[m]]=="number"&&(this.valuesById[this.values[d[m]]=a[d[m]]]=d[m])}return s.fromJSON=function(a,h){var c=new s(a,h.values,h.options,h.comment,h.comments);return c.reserved=h.reserved,c},s.prototype.toJSON=function(a){var h=a?Boolean(a.keepComments):!1;return e.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",h?this.comment:void 0,"comments",h?this.comments:void 0])},s.prototype.add=function(a,h,c,o){if(!e.isString(a))throw TypeError("name must be a string");if(!e.isInteger(h))throw TypeError("id must be an integer");if(this.values[a]!==void 0)throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(h))throw Error("id "+h+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(this.valuesById[h]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+h+" in "+this);this.values[a]=h}else this.valuesById[this.values[a]=h]=a;return o&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[a]=o||null),this.comments[a]=c||null,this},s.prototype.remove=function(a){if(!e.isString(a))throw TypeError("name must be a string");var h=this.values[a];if(h==null)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[h],delete this.values[a],delete this.comments[a],this.valuesOptions&&delete this.valuesOptions[a],this},s.prototype.isReservedId=function(a){return t.isReservedId(this.reserved,a)},s.prototype.isReservedName=function(a){return t.isReservedName(this.reserved,a)},_enum}var encoder_1,hasRequiredEncoder;function requireEncoder(){if(hasRequiredEncoder)return encoder_1;hasRequiredEncoder=1,encoder_1=r;var n=require_enum(),t=requireTypes(),e=requireUtil();function s(a,h,c,o){return h.resolvedType.group?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,o,(h.id<<3|3)>>>0,(h.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,o,(h.id<<3|2)>>>0)}function r(a){for(var h=e.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),c,o,u=a.fieldsArray.slice().sort(e.compareFieldsById),c=0;c<u.length;++c){var d=u[c].resolve(),m=a._fieldsArray.indexOf(d),p=d.resolvedType instanceof n?"int32":d.type,g=t.basic[p];o="m"+e.safeProp(d.name),d.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",o,d.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",o)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(d.id<<3|2)>>>0,8|t.mapKey[d.keyType],d.keyType),g===void 0?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",m,o):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|g,p,o),h("}")("}")):d.repeated?(h("if(%s!=null&&%s.length){",o,o),d.packed&&t.packed[p]!==void 0?h("w.uint32(%i).fork()",(d.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",o)("w.%s(%s[i])",p,o)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",o),g===void 0?s(h,d,m,o+"[i]"):h("w.uint32(%i).%s(%s[i])",(d.id<<3|g)>>>0,p,o)),h("}")):(d.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",o,d.name),g===void 0?s(h,d,m,o):h("w.uint32(%i).%s(%s)",(d.id<<3|g)>>>0,p,o))}return h("return w")}return encoder_1}(function(n){var t=n.exports=indexMinimal;t.build="light";function e(r,a,h){return typeof a=="function"?(h=a,a=new t.Root):a||(a=new t.Root),a.load(r,h)}t.load=e;function s(r,a){return a||(a=new t.Root),a.loadSync(r)}t.loadSync=s,t.encoder=requireEncoder(),t.decoder=requireDecoder(),t.verifier=requireVerifier(),t.converter=requireConverter(),t.ReflectionObject=requireObject(),t.Namespace=requireNamespace(),t.Root=requireRoot(),t.Enum=require_enum(),t.Type=requireType(),t.Field=requireField(),t.OneOf=requireOneof(),t.MapField=requireMapfield(),t.Service=requireService(),t.Method=requireMethod(),t.Message=message,t.wrappers=wrappers,t.types=requireTypes(),t.util=requireUtil(),t.ReflectionObject._configure(t.Root),t.Namespace._configure(t.Type,t.Service,t.Enum),t.Root._configure(t.Type),t.Field._configure(t.Type)})(indexLight);var tokenize_1=tokenize$1,delimRe=/[\s{}=;:[\],'"()<>]/g,stringDoubleRe=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,stringSingleRe=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,setCommentRe=/^ *[*/]+ */,setCommentAltRe=/^\s*\*?\/*/,setCommentSplitRe=/\n/g,whitespaceRe=/\s/,unescapeRe=/\\(.?)/g,unescapeMap={0:"\0",r:"\r",n:`
`,t:"	"};function unescape$1(n){return n.replace(unescapeRe,function(t,e){switch(e){case"\\":case"":return e;default:return unescapeMap[e]||""}})}tokenize$1.unescape=unescape$1;function tokenize$1(n,t){n=n.toString();var e=0,s=n.length,r=1,a=0,h={},c=[],o=null;function u(N){return Error("illegal "+N+" (line "+r+")")}function d(){var N=o==="'"?stringSingleRe:stringDoubleRe;N.lastIndex=e-1;var W=N.exec(n);if(!W)throw u("string");return e=N.lastIndex,v(o),o=null,unescape$1(W[1])}function m(N){return n.charAt(N)}function p(N,W,et){var it={type:n.charAt(N++),lineEmpty:!1,leading:et},ft;t?ft=2:ft=3;var mt=N-ft,xt;do if(--mt<0||(xt=n.charAt(mt))===`
`){it.lineEmpty=!0;break}while(xt===" "||xt==="	");for(var yt=n.substring(N,W).split(setCommentSplitRe),vt=0;vt<yt.length;++vt)yt[vt]=yt[vt].replace(t?setCommentAltRe:setCommentRe,"").trim();it.text=yt.join(`
`).trim(),h[r]=it,a=r}function g(N){var W=_(N),et=n.substring(N,W),it=/^\s*\/{1,2}/.test(et);return it}function _(N){for(var W=N;W<s&&m(W)!==`
`;)W++;return W}function y(){if(c.length>0)return c.shift();if(o)return d();var N,W,et,it,ft,mt=e===0;do{if(e===s)return null;for(N=!1;whitespaceRe.test(et=m(e));)if(et===`
`&&(mt=!0,++r),++e===s)return null;if(m(e)==="/"){if(++e===s)throw u("comment");if(m(e)==="/")if(t){if(it=e,ft=!1,g(e)){ft=!0;do if(e=_(e),e===s||(e++,!mt))break;while(g(e))}else e=Math.min(s,_(e)+1);ft&&(p(it,e,mt),mt=!0),r++,N=!0}else{for(ft=m(it=e+1)==="/";m(++e)!==`
`;)if(e===s)return null;++e,ft&&(p(it,e-1,mt),mt=!0),++r,N=!0}else if((et=m(e))==="*"){it=e+1,ft=t||m(it)==="*";do{if(et===`
`&&++r,++e===s)throw u("comment");W=et,et=m(e)}while(W!=="*"||et!=="/");++e,ft&&(p(it,e-2,mt),mt=!0),N=!0}else return"/"}}while(N);var xt=e;delimRe.lastIndex=0;var yt=delimRe.test(m(xt++));if(!yt)for(;xt<s&&!delimRe.test(m(xt));)++xt;var vt=n.substring(e,e=xt);return(vt==='"'||vt==="'")&&(o=vt),vt}function v(N){c.push(N)}function U(){if(!c.length){var N=y();if(N===null)return null;v(N)}return c[0]}function w(N,W){var et=U(),it=et===N;if(it)return y(),!0;if(!W)throw u("token '"+et+"', '"+N+"' expected");return!1}function k(N){var W=null,et;return N===void 0?(et=h[r-1],delete h[r-1],et&&(t||et.type==="*"||et.lineEmpty)&&(W=et.leading?et.text:null)):(a<N&&U(),et=h[N],delete h[N],et&&!et.lineEmpty&&(t||et.type==="/")&&(W=et.leading?null:et.text)),W}return Object.defineProperty({next:y,peek:U,push:v,skip:w,cmnt:k},"line",{get:function(){return r}})}var parse_1=parse;parse.filename=null;parse.defaults={keepCase:!1};var tokenize=tokenize_1,Root=requireRoot(),Type=requireType(),Field=requireField(),MapField=requireMapfield(),OneOf=requireOneof(),Enum=require_enum(),Service=requireService(),Method=requireMethod(),types=requireTypes(),util=requireUtil(),base10Re=/^[1-9][0-9]*$/,base10NegRe=/^-?[1-9][0-9]*$/,base16Re=/^0[x][0-9a-fA-F]+$/,base16NegRe=/^-?0[x][0-9a-fA-F]+$/,base8Re=/^0[0-7]+$/,base8NegRe=/^-?0[0-7]+$/,numberRe=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,nameRe=/^[a-zA-Z_][a-zA-Z_0-9]*$/,typeRefRe=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,fqTypeRefRe=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function parse(n,t,e){t instanceof Root||(e=t,t=new Root),e||(e=parse.defaults);var s=e.preferTrailingComment||!1,r=tokenize(n,e.alternateCommentMode||!1),a=r.next,h=r.push,c=r.peek,o=r.skip,u=r.cmnt,d=!0,m,p,g,_,y=!1,v=t,U=e.keepCase?function(Nt){return Nt}:util.camelCase;function w(Nt,Yt,zt){var te=parse.filename;return zt||(parse.filename=null),Error("illegal "+(Yt||"token")+" '"+Nt+"' ("+(te?te+", ":"")+"line "+r.line+")")}function k(){var Nt=[],Yt;do{if((Yt=a())!=='"'&&Yt!=="'")throw w(Yt);Nt.push(a()),o(Yt),Yt=c()}while(Yt==='"'||Yt==="'");return Nt.join("")}function N(Nt){var Yt=a();switch(Yt){case"'":case'"':return h(Yt),k();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return et(Yt,!0)}catch{if(Nt&&typeRefRe.test(Yt))return Yt;throw w(Yt,"value")}}function W(Nt,Yt){var zt,te;do Yt&&((zt=c())==='"'||zt==="'")?Nt.push(k()):Nt.push([te=it(a()),o("to",!0)?it(a()):te]);while(o(",",!0));o(";")}function et(Nt,Yt){var zt=1;switch(Nt.charAt(0)==="-"&&(zt=-1,Nt=Nt.substring(1)),Nt){case"inf":case"INF":case"Inf":return zt*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(base10Re.test(Nt))return zt*parseInt(Nt,10);if(base16Re.test(Nt))return zt*parseInt(Nt,16);if(base8Re.test(Nt))return zt*parseInt(Nt,8);if(numberRe.test(Nt))return zt*parseFloat(Nt);throw w(Nt,"number",Yt)}function it(Nt,Yt){switch(Nt){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!Yt&&Nt.charAt(0)==="-")throw w(Nt,"id");if(base10NegRe.test(Nt))return parseInt(Nt,10);if(base16NegRe.test(Nt))return parseInt(Nt,16);if(base8NegRe.test(Nt))return parseInt(Nt,8);throw w(Nt,"id")}function ft(){if(m!==void 0)throw w("package");if(m=a(),!typeRefRe.test(m))throw w(m,"name");v=v.define(m),o(";")}function mt(){var Nt=c(),Yt;switch(Nt){case"weak":Yt=g||(g=[]),a();break;case"public":a();default:Yt=p||(p=[]);break}Nt=k(),o(";"),Yt.push(Nt)}function xt(){if(o("="),_=k(),y=_==="proto3",!y&&_!=="proto2")throw w(_,"syntax");o(";")}function yt(Nt,Yt){switch(Yt){case"option":return Et(Nt,Yt),o(";"),!0;case"message":return St(Nt,Yt),!0;case"enum":return Xt(Nt,Yt),!0;case"service":return Zt(Nt,Yt),!0;case"extend":return ne(Nt,Yt),!0}return!1}function vt(Nt,Yt,zt){var te=r.line;if(Nt&&(typeof Nt.comment!="string"&&(Nt.comment=u()),Nt.filename=parse.filename),o("{",!0)){for(var Qt;(Qt=a())!=="}";)Yt(Qt);o(";",!0)}else zt&&zt(),o(";"),Nt&&(typeof Nt.comment!="string"||s)&&(Nt.comment=u(te)||Nt.comment)}function St(Nt,Yt){if(!nameRe.test(Yt=a()))throw w(Yt,"type name");var zt=new Type(Yt);vt(zt,function(Qt){if(!yt(zt,Qt))switch(Qt){case"map":It(zt);break;case"required":case"repeated":wt(zt,Qt);break;case"optional":y?wt(zt,"proto3_optional"):wt(zt,"optional");break;case"oneof":Pt(zt,Qt);break;case"extensions":W(zt.extensions||(zt.extensions=[]));break;case"reserved":W(zt.reserved||(zt.reserved=[]),!0);break;default:if(!y||!typeRefRe.test(Qt))throw w(Qt);h(Qt),wt(zt,"optional");break}}),Nt.add(zt)}function wt(Nt,Yt,zt){var te=a();if(te==="group"){Ct(Nt,Yt);return}for(;te.endsWith(".")||c().startsWith(".");)te+=a();if(!typeRefRe.test(te))throw w(te,"type");var Qt=a();if(!nameRe.test(Qt))throw w(Qt,"name");Qt=U(Qt),o("=");var ie=new Field(Qt,it(a()),te,Yt,zt);if(vt(ie,function(oe){if(oe==="option")Et(ie,oe),o(";");else throw w(oe)},function(){Wt(ie)}),Yt==="proto3_optional"){var re=new OneOf("_"+Qt);ie.setOption("proto3_optional",!0),re.add(ie),Nt.add(re)}else Nt.add(ie);!y&&ie.repeated&&(types.packed[te]!==void 0||types.basic[te]===void 0)&&ie.setOption("packed",!1,!0)}function Ct(Nt,Yt){var zt=a();if(!nameRe.test(zt))throw w(zt,"name");var te=util.lcFirst(zt);zt===te&&(zt=util.ucFirst(zt)),o("=");var Qt=it(a()),ie=new Type(zt);ie.group=!0;var re=new Field(te,Qt,zt,Yt);re.filename=parse.filename,vt(ie,function(oe){switch(oe){case"option":Et(ie,oe),o(";");break;case"required":case"repeated":wt(ie,oe);break;case"optional":y?wt(ie,"proto3_optional"):wt(ie,"optional");break;case"message":St(ie,oe);break;case"enum":Xt(ie,oe);break;default:throw w(oe)}}),Nt.add(ie).add(re)}function It(Nt){o("<");var Yt=a();if(types.mapKey[Yt]===void 0)throw w(Yt,"type");o(",");var zt=a();if(!typeRefRe.test(zt))throw w(zt,"type");o(">");var te=a();if(!nameRe.test(te))throw w(te,"name");o("=");var Qt=new MapField(U(te),it(a()),Yt,zt);vt(Qt,function(re){if(re==="option")Et(Qt,re),o(";");else throw w(re)},function(){Wt(Qt)}),Nt.add(Qt)}function Pt(Nt,Yt){if(!nameRe.test(Yt=a()))throw w(Yt,"name");var zt=new OneOf(U(Yt));vt(zt,function(Qt){Qt==="option"?(Et(zt,Qt),o(";")):(h(Qt),wt(zt,"optional"))}),Nt.add(zt)}function Xt(Nt,Yt){if(!nameRe.test(Yt=a()))throw w(Yt,"name");var zt=new Enum(Yt);vt(zt,function(Qt){switch(Qt){case"option":Et(zt,Qt),o(";");break;case"reserved":W(zt.reserved||(zt.reserved=[]),!0);break;default:Ut(zt,Qt)}}),Nt.add(zt)}function Ut(Nt,Yt){if(!nameRe.test(Yt))throw w(Yt,"name");o("=");var zt=it(a(),!0),te={options:void 0};te.setOption=function(Qt,ie){this.options===void 0&&(this.options={}),this.options[Qt]=ie},vt(te,function(ie){if(ie==="option")Et(te,ie),o(";");else throw w(ie)},function(){Wt(te)}),Nt.add(Yt,zt,te.comment,te.options)}function Et(Nt,Yt){var zt=o("(",!0);if(!typeRefRe.test(Yt=a()))throw w(Yt,"name");var te=Yt,Qt=te,ie;zt&&(o(")"),te="("+te+")",Qt=te,Yt=c(),fqTypeRefRe.test(Yt)&&(ie=Yt.slice(1),te+=Yt,a())),o("=");var re=Ft(Nt,te);Ht(Nt,Qt,re,ie)}function Ft(Nt,Yt){if(o("{",!0)){for(var zt={};!o("}",!0);){if(!nameRe.test(se=a()))throw w(se,"name");var te,Qt=se;if(o(":",!0),c()==="{")te=Ft(Nt,Yt+"."+se);else if(c()==="["){te=[];var ie;if(o("[",!0)){do ie=N(!0),te.push(ie);while(o(",",!0));o("]"),typeof ie<"u"&&Lt(Nt,Yt+"."+se,ie)}}else te=N(!0),Lt(Nt,Yt+"."+se,te);var re=zt[Qt];re&&(te=[].concat(re).concat(te)),zt[Qt]=te,o(",",!0),o(";",!0)}return zt}var le=N(!0);return Lt(Nt,Yt,le),le}function Lt(Nt,Yt,zt){Nt.setOption&&Nt.setOption(Yt,zt)}function Ht(Nt,Yt,zt,te){Nt.setParsedOption&&Nt.setParsedOption(Yt,zt,te)}function Wt(Nt){if(o("[",!0)){do Et(Nt,"option");while(o(",",!0));o("]")}return Nt}function Zt(Nt,Yt){if(!nameRe.test(Yt=a()))throw w(Yt,"service name");var zt=new Service(Yt);vt(zt,function(Qt){if(!yt(zt,Qt))if(Qt==="rpc")ee(zt,Qt);else throw w(Qt)}),Nt.add(zt)}function ee(Nt,Yt){var zt=u(),te=Yt;if(!nameRe.test(Yt=a()))throw w(Yt,"name");var Qt=Yt,ie,re,le,oe;if(o("("),o("stream",!0)&&(re=!0),!typeRefRe.test(Yt=a())||(ie=Yt,o(")"),o("returns"),o("("),o("stream",!0)&&(oe=!0),!typeRefRe.test(Yt=a())))throw w(Yt);le=Yt,o(")");var ge=new Method(Qt,te,ie,le,re,oe);ge.comment=zt,vt(ge,function(me){if(me==="option")Et(ge,me),o(";");else throw w(me)}),Nt.add(ge)}function ne(Nt,Yt){if(!typeRefRe.test(Yt=a()))throw w(Yt,"reference");var zt=Yt;vt(null,function(Qt){switch(Qt){case"required":case"repeated":wt(Nt,Qt,zt);break;case"optional":y?wt(Nt,"proto3_optional",zt):wt(Nt,"optional",zt);break;default:if(!y||!typeRefRe.test(Qt))throw w(Qt);h(Qt),wt(Nt,"optional",zt);break}})}for(var se;(se=a())!==null;)switch(se){case"package":if(!d)throw w(se);ft();break;case"import":if(!d)throw w(se);mt();break;case"syntax":if(!d)throw w(se);xt();break;case"option":Et(v,se),o(";");break;default:if(yt(v,se)){d=!1;continue}throw w(se)}return parse.filename=null,{package:m,imports:p,weakImports:g,syntax:_,root:t}}var common_1=common,commonRe=/\/|\./;function common(n,t){commonRe.test(n)||(n="google/protobuf/"+n+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),common[n]=t}common("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var timeType;common("duration",{Duration:timeType={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common("timestamp",{Timestamp:timeType});common("empty",{Empty:{fields:{}}});common("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common.get=function n(t){return common[t]||null};(function(n){var t=n.exports=indexLightExports;t.build="full",t.tokenize=tokenize_1,t.parse=parse_1,t.common=common_1,t.Root._configure(t.Type,t.parse,t.common)})(src);(function(n){n.exports=srcExports})(protobufjs);const decodeResponseBody=(n,t)=>{protobufjsExports.load("assets/protos/crash_protocol.proto",function(e,s){if(e)throw e;if(s){const r=s.lookupType("crash_protocol.GenericResponse"),a=s.lookupType("crash_protocol.ErrorResponse");let h=buffer.Buffer.from(new Uint8Array(n));try{let c=r.decode(h);t(c)}catch{let o=a.decode(h);t(o)}}})},encodeRequestBody=(n,t)=>{protobufjsExports.load("assets/protos/crash_protocol.proto",function(e,s){if(e)throw e;if(s){const r=s.lookupType("crash_protocol.GenericRequest");let a=r.verify(n);if(a)throw Error(a);let h=r.encode(n).finish();t(h)}})};var BeRqEnum=(n=>(n[n.REQUEST=0]="REQUEST",n[n.PING_PONG=1]="PING_PONG",n[n.CONNECT=2]="CONNECT",n[n.GAME_START=3]="GAME_START",n[n.GAME_LOCK=4]="GAME_LOCK",n[n.GAME_PLAY=5]="GAME_PLAY",n[n.GAME_END=6]="GAME_END",n[n.CASH_OUT=7]="CASH_OUT",n[n.JOIN_GAME=8]="JOIN_GAME",n[n.LEAVE_GAME=9]="LEAVE_GAME",n[n.CONFIRM_JOIN_GAME=10]="CONFIRM_JOIN_GAME",n[n.BACKGROUND_FAN=11]="BACKGROUND_FAN",n))(BeRqEnum||{}),UserStatusEnum=(n=>(n.SPECTING="SPECTING",n.BETTING="BETTING",n.PLAYING="PLAYING",n))(UserStatusEnum||{});const CrashSpeed=6e-5;function getElapsePayout(n){let t=Math.trunc(100*Math.exp(CrashSpeed*n))/100;if(!Number.isFinite(t))throw new Error("Infinite Payout");return Math.max(t,1)}class User{constructor(){gt(this,"userId");gt(this,"budget");gt(this,"status");gt(this,"bonusBudget");gt(this,"username");gt(this,"photoURL");this.userId="",this.status=UserStatusEnum.BETTING,this.budget=0,this.bonusBudget=0,this.username="FromsolversUser123",this.photoURL="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Cute-kittens-12929201-1600-1200.jpg/1024px-Cute-kittens-12929201-1600-1200.jpg"}}const user=new User;class Game{constructor(){gt(this,"status");gt(this,"startAt");gt(this,"gameId");gt(this,"bet");gt(this,"hasWon");gt(this,"multiplier");gt(this,"remoteMultiplier");gt(this,"ready");gt(this,"observers",[]);gt(this,"remoteGameEnding",async(t,e,s)=>{this.ready=!0;const r=this.status;this.status=BeRqEnum.GAME_END,this.gameId=t,this.startAt=e,this.multiplier=s,this.notifyGameEnding(this.status!==r)});gt(this,"remoteGameStarting",async(t,e)=>{this.ready=!0;let s=this.status!==BeRqEnum.GAME_START;this.status=BeRqEnum.GAME_START,this.gameId=t,this.startAt=e,s&&(this.hasWon=!1),this.notifyGameStarting(s)});gt(this,"remoteGameLocking",async(t,e)=>{this.ready=!0;const s=this.status;this.status=BeRqEnum.GAME_LOCK,this.gameId=t,this.startAt=e,this.hasWon=!1,this.notifyGameLocking(this.status!==s)});gt(this,"remoteGamePlaying",async(t,e,s)=>{this.ready=!0;const r=this.status;this.status=BeRqEnum.GAME_PLAY,this.gameId=t,this.startAt=e,this.hasWon=!1,this.remoteMultiplier=s,this.flushMultiplier(),this.notifyGamePlaying(this.status!==r)});this.startAt=new Date,this.status=-1,this.gameId="",this.ready=!1,this.hasWon=!1,this.multiplier=1,this.remoteMultiplier=1}update(){if(this.status===BeRqEnum.GAME_PLAY){const t=this.multiplier;this.flushMultiplier(),this.multiplier!=t&&this.notifyGamePlaying(!1)}}flush(){switch(this.status){case BeRqEnum.GAME_END:{this.notifyGameEnding(!0);break}case BeRqEnum.GAME_LOCK:{this.notifyGameLocking(!0);break}case BeRqEnum.GAME_PLAY:{this.notifyGamePlaying(!0);break}case BeRqEnum.GAME_START:{this.notifyGameStarting(!0);break}}}flushMultiplier(){const t=new Date().getTime()-this.startAt.getTime()-MULTIPLIER_REMOTE_DELAY;t<Number.EPSILON?this.multiplier=1:this.multiplier=getElapsePayout(t),this.multiplier>this.remoteMultiplier&&(this.multiplier=this.remoteMultiplier)}addObserver(t){if(this.observers.includes(t))return console.log("Game: GameObserver has been added already.");this.observers.push(t)}removeObserver(t){const e=this.observers.indexOf(t);if(e===-1)return console.log("Game: Nonexistent observer.");this.observers.splice(e,1)}clear(){this.observers=[],this.status=-1,this.startAt=new Date,this.gameId="",this.ready=!1,this.hasWon=!1,this.multiplier=1,this.remoteMultiplier=1,this.bet=void 0}notifyGameEnding(t){for(const e of this.observers)e.onGameEnding(t)}notifyGameStarting(t){for(const e of this.observers)e.onGameStarting(t)}notifyGameLocking(t){for(const e of this.observers)e.onGameLocking(t)}notifyGamePlaying(t){t&&(user.status=user.status===UserStatusEnum.BETTING?UserStatusEnum.PLAYING:user.status);for(const e of this.observers)e.onGamePlaying(t)}}const game=new Game;function timestampMs(n){return n.seconds*1e3+(n.nanos?n.nanos/1e6:0)}function timestampToDate(n){const t=timestampMs(n);return new Date(t)}function dateToTimestamp(n){let t=n.getTime(),e=t%1e3;return{seconds:Math.floor(t/1e3),nanos:e*1e6}}var rngBrowserExports={},rngBrowser={get exports(){return rngBrowserExports},set exports(n){rngBrowserExports=n}},getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);rngBrowser.exports=function(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);rngBrowser.exports=function(){for(var t=0,e;t<16;t++)t&3||(e=Math.random()*4294967296),rnds[t]=e>>>((t&3)<<3)&255;return rnds}}var byteToHex=[];for(var i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid$2(n,t){var e=t||0,s=byteToHex;return[s[n[e++]],s[n[e++]],s[n[e++]],s[n[e++]],"-",s[n[e++]],s[n[e++]],"-",s[n[e++]],s[n[e++]],"-",s[n[e++]],s[n[e++]],"-",s[n[e++]],s[n[e++]],s[n[e++]],s[n[e++]],s[n[e++]],s[n[e++]]].join("")}var bytesToUuid_1=bytesToUuid$2,rng$1=rngBrowserExports,bytesToUuid$1=bytesToUuid_1,_nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1$1(n,t,e){var s=t&&e||0,r=t||[];n=n||{};var a=n.node||_nodeId,h=n.clockseq!==void 0?n.clockseq:_clockseq;if(a==null||h==null){var c=rng$1();a==null&&(a=_nodeId=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),h==null&&(h=_clockseq=(c[6]<<8|c[7])&16383)}var o=n.msecs!==void 0?n.msecs:new Date().getTime(),u=n.nsecs!==void 0?n.nsecs:_lastNSecs+1,d=o-_lastMSecs+(u-_lastNSecs)/1e4;if(d<0&&n.clockseq===void 0&&(h=h+1&16383),(d<0||o>_lastMSecs)&&n.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=o,_lastNSecs=u,_clockseq=h,o+=122192928e5;var m=((o&268435455)*1e4+u)%4294967296;r[s++]=m>>>24&255,r[s++]=m>>>16&255,r[s++]=m>>>8&255,r[s++]=m&255;var p=o/4294967296*1e4&268435455;r[s++]=p>>>8&255,r[s++]=p&255,r[s++]=p>>>24&15|16,r[s++]=p>>>16&255,r[s++]=h>>>8|128,r[s++]=h&255;for(var g=0;g<6;++g)r[s+g]=a[g];return t||bytesToUuid$1(r)}var v1_1=v1$1,rng=rngBrowserExports,bytesToUuid=bytesToUuid_1;function v4$1(n,t,e){var s=t&&e||0;typeof n=="string"&&(t=n==="binary"?new Array(16):null,n=null),n=n||{};var r=n.random||(n.rng||rng)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t)for(var a=0;a<16;++a)t[s+a]=r[a];return t||bytesToUuid(r)}var v4_1=v4$1,v1=v1_1,v4=v4_1,uuid=v4;uuid.v1=v1;uuid.v4=v4;var uuid_1=uuid;class BackendConfigs{constructor(t){gt(this,"betPrecision");gt(this,"multiplierPrecision");gt(this,"percentagePrecision");gt(this,"_minBet");gt(this,"_maxBet");gt(this,"_maxMultiplier");gt(this,"_maxProfit");this.betPrecision=(t==null?void 0:t.betPrecision)||2,this.multiplierPrecision=(t==null?void 0:t.multiplierPrecision)||2,this.percentagePrecision=(t==null?void 0:t.percentagePrecision)||2,this._minBet=(t==null?void 0:t.minBet)||1,this._maxBet=(t==null?void 0:t.maxBet)||1e4,this._maxMultiplier=(t==null?void 0:t.maxMultiplier)||1e4,this._maxProfit=(t==null?void 0:t.maxProfit)||1e7}updateConfig(t){this.betPrecision=t.betPrecision,this.multiplierPrecision=t.multiplierPrecision,this._minBet=t.minBet,this._maxBet=t.maxBet,this._maxMultiplier=t.maxMultiplier,this._maxProfit=t.maxProfit}get minBet(){return this._minBet/10**this.betPrecision}get maxBet(){return this._maxBet/10**this.betPrecision}get minMultiplier(){return 1+1/10**this.multiplierPrecision}get maxMultiplier(){return this._maxMultiplier/10**this.multiplierPrecision}get maxProfit(){return this._maxProfit/10**this.betPrecision}decodeMultiplier(t){return t/10**this.multiplierPrecision}decodeCoins(t){return t/10**this.betPrecision}decodePercentage(t){return t/10**this.percentagePrecision}encodeMultiplier(t){return Math.round(t*10**this.multiplierPrecision)}encodeCoins(t){return Math.round(t*10**this.betPrecision)}encodePercentage(t){return Math.round(t*10**this.percentagePrecision)}}const backendConfigs=new BackendConfigs,AwardData=[{username:"BrangyCastroBrangyBrangy",time:"12/03/2023 - 12:45 pm",bet:4595.2,multiplier:5.53,payout:-40.92,color:"#4201cb"},{username:"Daniel",multiplier:2.43,time:"12/03/2023 - 12:45 pm",bet:4.54,payout:100.9,color:"#303941"},{username:"Antonio",multiplier:2.42,time:"12/03/2023 - 12:45 pm",bet:4.56,payout:0,color:"#303941"},{username:"Hans",multiplier:2.44,time:"12/03/2023 - 12:45 pm",bet:4.52,payout:-100.09,color:"#007cc2"},{username:"Jesus",multiplier:2.45,time:"12/03/2023 - 12:45 pm",bet:4.56,payout:100.09,color:"#7700d4"},{username:"Holw",multiplier:2.46,time:"12/03/2023 - 12:45 pm",bet:4.54,payout:-100.09,color:"#4201cb"},{username:"BrangyC",multiplier:2.47,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#007cc2"},{username:"BrangyC",multiplier:2.48,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:0,color:"#7700d4"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:-100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:-100.09,color:"#303941"}],LeaderboardData=[{username:"BrangyCastroBrangy",multiplier:5.53,bet:100.03,win:400.92,color:"#4201cb"},{username:"Daniel",multiplier:2.43,bet:4.54,win:100.09,color:"#303941"},{username:"Antonio",multiplier:2.42,bet:4.56,win:100.09,color:"#303941"},{username:"Hans",multiplier:2.44,bet:4.52,win:100.09,color:"#007cc2"},{username:"Jesus",multiplier:2.45,bet:4.56,win:100.09,color:"#7700d4"},{username:"Holw",multiplier:2.46,bet:4.54,win:100.09,color:"#4201cb"},{username:"BrangyC",multiplier:2.47,bet:4.53,win:100.09,color:"#007cc2"},{username:"BrangyC",multiplier:2.48,bet:4.53,win:100.09,color:"#7700d4"},{username:"BrangyC",multiplier:2.49,bet:4.53,win:100.09,color:"#303941"}],i18nEN={betButtonText:"Go Bet",cancelButtonText:"Cancel",cashOutButtonText:"Cashout",automaticCurrencyCashingText:"Automatic Payment",automaticMultiplierCashingText:"Automatic Payment",gameOverLabelText:"GAME CRASHED",betClosedLabelText:"BETS CLOSED",youWinLabelText:"YOU WIN",settingsLangTitle:"Language",settingsLangSubtitle:"Adjust language of the game",settingsMusicTitle:"Game music",settingsMusicSubtitle:"Adjust Game music",settingsSoundEffectsTitle:"Game sound effects",settingsSoundEffectsSubtitle:"Adjust Game sound effects",settingsContactSupportTitle:"Contact support",settingsContactSupportSubtitle:"If you have problems with the game",settingsAnimationTitle:"Animation",settingsAnimationSubtitle:"Turn on/off",loadingMessage:"Game Brewing",loadingDoneMessage:"We're Ready",connectionLostMessage:"Connection lost, please wait a few moments",backgroundFanText:"username won",numberOfRounds:"Number of rounds",onWin:"On Win",onLoss:"On Loss",stopOnProfit:"Stop on profit",stopOnLoss:"Stop on loss",startAutoBet:"Start auto bet",decrease:"Decrease",increase:"Increase",automaticGame:"Automatic game",minimum:"Minimum",maximum:"Maximum",warningAutoBet:"It is recommended not to disable auto cash out in case you have an unstable connection.",bonus:"Bonus",bet:"Bet",nextGameLabelText:n=>`Next game in ${Math.ceil(n)}s`,stableConnectionText:n=>`Connection Stable: ${n}ms`,unstableConnectionText:n=>`Connection Untable: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,t)=>`The number of coins in the bet must be between ${n} and ${t}.`,betInvalidAmountOfAutoMultiplierMessage:(n,t)=>`The auto cash multiplier must be between ${n} and ${t}`,betInvalidAmountOfAutoProfitMessage:n=>`The auto cash profit must be between the number of coins in the bet and ${n}`,betInvalidOnWinInputMessage:"Invalid on Win Percentaje",betInvalidOnLossInputMessage:"Invalid on Loss Percentaje"},i18nES={betButtonText:"Apostar",cancelButtonText:"Cancelar",cashOutButtonText:"Cobrar",automaticCurrencyCashingText:"Cobro automático",automaticMultiplierCashingText:"Cobro automático",gameOverLabelText:"FIN DEL JUEGO",betClosedLabelText:"APUESTAS CERRADAS",youWinLabelText:"GANASTE",settingsLangTitle:"Idioma",settingsLangSubtitle:"Seleccione el idioma para el juego",settingsMusicTitle:"Música",settingsMusicSubtitle:"Ajustar la Música del juego",settingsSoundEffectsTitle:"Efectos de Sonido",settingsSoundEffectsSubtitle:"Ajustar los Efectos de Sonido del juego",settingsContactSupportTitle:"Atención al Cliente",settingsContactSupportSubtitle:"¿problemas con el juego?",settingsAnimationTitle:"Animaciones",settingsAnimationSubtitle:"Habilitar/Deshabilitar",loadingMessage:"Preparando el juego",loadingDoneMessage:"Estamos Listos",connectionLostMessage:"Conexión perdida, por favor espere unos momentos",backgroundFanText:"usuario ganó",numberOfRounds:"Número de rondas",onWin:"Al Ganar",onLoss:"Al Perder",stopOnProfit:"Parada en beneficio",stopOnLoss:"Parada por pérdida",startAutoBet:"Iniciar apuesta automática",decrease:"Disminuir",increase:"Aumentar",automaticGame:"Juego automático",minimum:"Mínimo",maximum:"Máximo",warningAutoBet:"Se recomienda no desactivar el retiro automático en caso de que tenga una conexión inestable.",bonus:"Bono",bet:"Apuesta",nextGameLabelText:n=>`Nuevo juego en ${Math.ceil(n)}s`,stableConnectionText:n=>`Conexión estable: ${n}ms`,unstableConnectionText:n=>`Conexión inestable: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,t)=>`El número de monedas en la apuesta debe estar entre ${n} y ${t}`,betInvalidAmountOfAutoMultiplierMessage:(n,t)=>`El multiplicador de cobro automático debe estar entre ${n} y ${t}`,betInvalidAmountOfAutoProfitMessage:n=>`El multiplicador de cobro automático debe estar entre el número de monedas de la apuesta y ${n}`,betInvalidOnWinInputMessage:"Invalido Porcentaje seleccionado al ganar",betInvalidOnLossInputMessage:"Invalido Porcentaje seleccionado al perder"},i18nPT={betButtonText:"Apostar",cancelButtonText:"Cancelar",cashOutButtonText:"Sacar",automaticCurrencyCashingText:"Pagamento automático",automaticMultiplierCashingText:"Pagamento automático",gameOverLabelText:"FIM DO JOGO",betClosedLabelText:"APOSTAS FECHADAS",youWinLabelText:"GANHO",settingsLangTitle:"Idioma",settingsLangSubtitle:"Selecione o idioma para o jogo",settingsMusicTitle:"Música",settingsMusicSubtitle:"Ajustar música do jogo",settingsSoundEffectsTitle:"Efeitos sonoros",settingsSoundEffectsSubtitle:"Ajustar efeitos sonoros do jogo",settingsContactSupportTitle:"Suporte ao cliente",settingsContactSupportSubtitle:"Problemas com o jogo?",settingsAnimationTitle:"Animações",settingsAnimationSubtitle:"Habilitar/Desabilitar",loadingMessage:"Preparando o jogo",loadingDoneMessage:"Estamos prontos",connectionLostMessage:"Conexão perdida, aguarde alguns instantes",backgroundFanText:"usuário ganhou",numberOfRounds:"Número de rodadas",onWin:"Sobre a vitória",onLoss:"Sobre a perda",stopOnProfit:"Parada por lucro",stopOnLoss:"Parada em caso de perda",startAutoBet:"Iniciar aposta automática",decrease:"Diminuir",increase:"Aumento",automaticGame:"Jogo automático",minimum:"Mínimo",maximum:"Máximo",warningAutoBet:"Recomenda-se não desabilitar o saque automático caso você tenha uma conexão instável.",bonus:"Bônus",bet:"Aposta",nextGameLabelText:n=>`Novo jogo em ${Math.ceil(n)}s`,stableConnectionText:n=>`Conexão estável: ${n}ms`,unstableConnectionText:n=>`Conexão instável: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,t)=>`O número de moedas na aposta deve estar entre ${n} e ${t}.`,betInvalidAmountOfAutoMultiplierMessage:(n,t)=>`O multiplicador automático de dinheiro deve estar entre ${n} e ${t}.`,betInvalidAmountOfAutoProfitMessage:n=>`O lucro em dinheiro automático deve estar entre o número de moedas na aposta e ${n}`,betInvalidOnWinInputMessage:"Invalid on Win Percentaje",betInvalidOnLossInputMessage:"Invalid on Loss Percentaje"};var Language=(n=>(n.ES="es",n.EN="en",n.PT="pt",n))(Language||{});let i18nMessage={[Language.EN.toString()]:i18nEN,[Language.ES.toString()]:i18nES,[Language.PT.toString()]:i18nPT};class I18n{constructor(t){gt(this,"_language");gt(this,"_translatedText");gt(this,"callback");this._language=t||Language.PT,this._translatedText=i18nMessage[this._language]}get language(){return this._language}set language(t){this._language!==t&&(this._language=t,this._translatedText=i18nMessage[this._language],this.callback&&this.callback(this._translatedText))}get translatedText(){return this._translatedText}}const i18n=new I18n,requestAdapter=n=>{switch(n.method){case BeRqEnum.JOIN_GAME:return n.joinParams.bet=backendConfigs.encodeCoins(n.joinParams.bet),n.joinParams.autoMultiplier&&(n.joinParams.autoMultiplier=backendConfigs.encodeMultiplier(n.joinParams.autoMultiplier)),n.joinParams.autoProfit&&(n.joinParams.autoProfit=backendConfigs.encodeCoins(n.joinParams.autoProfit)),n.joinParams.betOnWin&&(n.joinParams.betOnWin=backendConfigs.encodePercentage(n.joinParams.betOnWin),n.joinParams.betOnWin===0&&(n.joinParams.betOnWin=null)),n.joinParams.betOnLoss&&(n.joinParams.betOnLoss=backendConfigs.encodePercentage(n.joinParams.betOnLoss),n.joinParams.betOnLoss===0&&(n.joinParams.betOnLoss=null)),n.joinParams.stopOnProfit&&(n.joinParams.stopOnProfit=backendConfigs.encodeCoins(n.joinParams.stopOnProfit),n.joinParams.stopOnProfit===0&&(n.joinParams.stopOnProfit=null)),n.joinParams.stopOnLoss&&(n.joinParams.stopOnLoss=backendConfigs.encodeCoins(n.joinParams.stopOnLoss),n.joinParams.stopOnLoss===0&&(n.joinParams.stopOnLoss=null)),n;default:return n}};function playerInfoRespAdapter(n){return n.budget=backendConfigs.decodeCoins(n.budget),n.bonusBudget=backendConfigs.decodeCoins(n.bonusBudget),n.betInfo&&(n.betInfo.amount=backendConfigs.decodeCoins(n.betInfo.amount),n.betInfo.autoMultiplier&&(n.betInfo.autoMultiplier=backendConfigs.decodeMultiplier(n.betInfo.autoMultiplier)),n.betInfo.autoProfit&&(n.betInfo.autoProfit=backendConfigs.decodeCoins(n.betInfo.autoProfit)),n.betInfo.stopOnProfit&&(n.betInfo.stopOnProfit=backendConfigs.decodeCoins(n.betInfo.stopOnProfit)),n.betInfo.stopOnLoss&&(n.betInfo.stopOnLoss=backendConfigs.decodeCoins(n.betInfo.stopOnLoss)),n.betInfo.betOnWin&&(n.betInfo.betOnWin=backendConfigs.decodePercentage(n.betInfo.betOnWin)),n.betInfo.betOnLoss&&(n.betInfo.betOnLoss=backendConfigs.decodePercentage(n.betInfo.betOnLoss))),n}const responseAdapter=n=>{if("error"in n)return n;switch(n.method){case BeRqEnum.CONNECT:return backendConfigs.updateConfig(n.connectResponse.configs),n.connectResponse.playerInfo=playerInfoRespAdapter(n.connectResponse.playerInfo),n;case BeRqEnum.GAME_START:return n.gameStartResponse.lastMultipliers=n.gameStartResponse.lastMultipliers.map(t=>backendConfigs.decodeMultiplier(t)),n;case BeRqEnum.GAME_LOCK:return n.gameLockResponse.lastMultipliers=n.gameLockResponse.lastMultipliers.map(t=>backendConfigs.decodeMultiplier(t)),n;case BeRqEnum.GAME_PLAY:return n.gamePlayResponse.lastMultipliers=n.gamePlayResponse.lastMultipliers.map(t=>backendConfigs.decodeMultiplier(t)),n.gamePlayResponse.multiplier=backendConfigs.decodeMultiplier(n.gamePlayResponse.multiplier),n;case BeRqEnum.GAME_END:return n.gameEndResponse.lastMultipliers=n.gameEndResponse.lastMultipliers.map(t=>backendConfigs.decodeMultiplier(t)),n.gameEndResponse.crashMultiplier=backendConfigs.decodeMultiplier(n.gameEndResponse.crashMultiplier),n;case BeRqEnum.CASH_OUT:return n.cashOutResponse.cashOutMultiplier=backendConfigs.decodeMultiplier(n.cashOutResponse.cashOutMultiplier),n.cashOutResponse.profit=backendConfigs.decodeCoins(n.cashOutResponse.profit),n.cashOutResponse.playerInfo=playerInfoRespAdapter(n.cashOutResponse.playerInfo),n;case BeRqEnum.JOIN_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;case BeRqEnum.LEAVE_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;case BeRqEnum.BACKGROUND_FAN:return n.backgroundFanResponse.cashOutMultiplier=backendConfigs.decodeMultiplier(n.backgroundFanResponse.cashOutMultiplier),n.backgroundFanResponse.profit=backendConfigs.decodeCoins(n.backgroundFanResponse.profit),n;case BeRqEnum.CONFIRM_JOIN_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;default:return n}};function updateUserAndGame(n){user.userId=n.id,user.budget=n.budget,user.status=n.state,user.bonusBudget=n.bonusBudget,n.betInfo?game.bet={coins:n.betInfo.amount,autoMultiplier:n.betInfo.autoMultiplier||void 0,autoProfit:n.betInfo.autoProfit||void 0,auto:"autoRounds"in n.betInfo&&n.betInfo.autoRounds!==null?{autoRounds:n.betInfo.autoRounds||0,betOnWin:n.betInfo.betOnWin||0,betOnLoss:n.betInfo.betOnLoss||0,stopOnProfit:n.betInfo.stopOnProfit||0,stopOnLoss:n.betInfo.stopOnLoss||0}:void 0}:game.bet=void 0}class BackendService{constructor(){gt(this,"client");gt(this,"requestQueue");gt(this,"sentLatencyStatus");gt(this,"callbackPreviousMultipliers");gt(this,"callbackAutomaticCashOut");gt(this,"callbackBackgroundFan");gt(this,"dataAll");gt(this,"dataLeaderboard");this.requestQueue={},this.sentLatencyStatus=t=>{},this.callbackPreviousMultipliers=t=>{},this.dataAll=AwardData,this.dataLeaderboard=LeaderboardData}startConnection(t){return new Promise((e,s)=>{const r=new browser.w3cwebsocket(BACKEND_URL);r.binaryType="arraybuffer",this.client=r,r.onopen=()=>{console.log("Connection established..")},r.onerror=a=>{console.error("Socket encountered error: ",a,"Closing socket"),r.close()},r.onclose=a=>{console.log("Socket is closed.",a.reason),game.clear(),this.requestQueue={},this.sentLatencyStatus=h=>{},this.callbackPreviousMultipliers=h=>{},t()},r.onmessage=a=>{let h=typeof a.data=="string"?buffer.Buffer.from(a.data):a.data;decodeResponseBody(h,c=>{switch(c=responseAdapter(c),c.method){case BeRqEnum.BACKGROUND_FAN:if("error"in c){console.error(c);return}const o=c.backgroundFanResponse;this.callbackBackgroundFan&&o.gameId===game.gameId&&this.callbackBackgroundFan(o.profit,o.cashOutMultiplier);break;case BeRqEnum.PING_PONG:{if("error"in c){console.error(c.error);return}this.pingPong(c);break}case BeRqEnum.CONNECT:{"error"in c?s(c.error):(console.log("New connection succesfully done",c),updateUserAndGame(c.connectResponse.playerInfo),e(user.userId));break}case BeRqEnum.REQUEST:break;case BeRqEnum.GAME_END:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameEndResponse.lastMultipliers,!1);let u=timestampToDate(c.gameEndResponse.nextStateTime);game.remoteGameEnding(c.gameEndResponse.gameId,u,c.gameEndResponse.crashMultiplier);break}case BeRqEnum.GAME_LOCK:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameLockResponse.lastMultipliers,!1);let u=timestampToDate(c.gameLockResponse.nextStateTime);game.remoteGameLocking(c.gameLockResponse.gameId,u);break}case BeRqEnum.GAME_PLAY:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gamePlayResponse.lastMultipliers,!0);let u=timestampToDate(c.gamePlayResponse.startTime);game.remoteGamePlaying(c.gamePlayResponse.gameId,u,c.gamePlayResponse.multiplier);break}case BeRqEnum.GAME_START:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameStartResponse.lastMultipliers,!1);let u=timestampToDate(c.gameStartResponse.nextStateTime);game.remoteGameStarting(c.gameStartResponse.gameId,u);break}default:{if(c.transactionId in this.requestQueue){const{callback:u,payload:d}=this.requestQueue[c.transactionId];delete this.requestQueue[c.transactionId],c.method===d.method&&u(c)}else this.callbackAutomaticCashOut&&c.method===BeRqEnum.CASH_OUT&&("error"in c?console.log(c.error):(updateUserAndGame(c.cashOutResponse.playerInfo),this.callbackAutomaticCashOut(c.cashOutResponse.profit)));break}}})}})}sendMessage(t){t=requestAdapter(t),encodeRequestBody(t,e=>{this.client&&this.client.send(e.buffer.slice(e.byteOffset,e.byteOffset+e.length))})}pingPong(t){let e=t.pingPongMessage;e.lastClientTime&&(e.previousClientTime=e.lastClientTime),e.lastClientTime=dateToTimestamp(new Date);const s=timestampMs(e.lastServerTime)-timestampMs(e.previousServerTime)-e.pingPongDeltaMs,r=timestampMs(e.lastClientTime)-timestampMs(e.previousClientTime||e.lastClientTime)-e.pingPongDeltaMs,a=(s+r)/2,h=Math.round(a/2);this.sentLatencyStatus(h);let c={method:BeRqEnum.PING_PONG,transactionId:uuid_1.v4(),pingPongMessage:e};this.sendMessage(c)}bet(t,e,s,r){return new Promise((a,h)=>{let c=i18n.translatedText,o=[];(t<backendConfigs.minBet||t>backendConfigs.maxBet)&&o.push({message:c.betInvalidAmountOfCoinsMessage,args:[backendConfigs.minBet,backendConfigs.maxBet]}),e&&(e<backendConfigs.minMultiplier||e>backendConfigs.maxMultiplier)&&o.push({message:c.betInvalidAmountOfAutoMultiplierMessage,args:[backendConfigs.minMultiplier,backendConfigs.maxMultiplier]}),s&&(s<t*backendConfigs.minMultiplier||s>backendConfigs.maxProfit)&&o.push({message:c.betInvalidAmountOfAutoProfitMessage,args:[backendConfigs.maxProfit]}),r&&(r.betOnWin<-100&&o.push({message:c.betInvalidOnWinInputMessage}),r.betOnLoss<-100&&o.push({message:c.betInvalidOnLossInputMessage})),o.length>0&&h({validationErrors:o});let u={method:BeRqEnum.JOIN_GAME,transactionId:uuid_1.v4(),joinParams:{bet:t,autoMultiplier:e||null,autoProfit:s||null,autoRounds:(r==null?void 0:r.autoRounds)||null,betOnWin:(r==null?void 0:r.betOnWin)||null,betOnLoss:(r==null?void 0:r.betOnLoss)||null,stopOnProfit:(r==null?void 0:r.stopOnProfit)||null,stopOnLoss:(r==null?void 0:r.stopOnLoss)||null}};this.requestQueue[u.transactionId]={callback:d=>{var m;"error"in d?h({serverError:d.error}):(updateUserAndGame(d.playerInfoResponse),console.assert(((m=game.bet)==null?void 0:m.coins)===t),a({coins:t}))},payload:u},this.sendMessage(u)})}cancelBet(){return new Promise((t,e)=>{let s={method:BeRqEnum.LEAVE_GAME,transactionId:uuid_1.v4(),emptyParams:{}};this.sendMessage(s),this.requestQueue[s.transactionId]={callback:r=>{"error"in r?e(r.error):(updateUserAndGame(r.playerInfoResponse),console.assert(typeof game.bet>"u"),t(r.playerInfoResponse.budget))},payload:s}})}cashOut(){return new Promise((t,e)=>{let s={method:BeRqEnum.CASH_OUT,transactionId:uuid_1.v4(),emptyParams:{}};this.sendMessage(s),this.requestQueue[s.transactionId]={callback:r=>{var a;"error"in r?e(r.error):(updateUserAndGame(r.cashOutResponse.playerInfo),game.hasWon=!0,t({cashOutMultiplier:r.cashOutResponse.cashOutMultiplier,bet:((a=r.cashOutResponse.playerInfo.betInfo)==null?void 0:a.amount)||0,profit:r.cashOutResponse.profit,budget:r.cashOutResponse.playerInfo.budget}))},payload:s}})}}const backendService=new BackendService;class TableAll extends HTMLElement{constructor(){super();gt(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);gt(this,"data");this.data=backendService.dataAll;const e=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const a=document.createElement("div");a.classList.add("table-body"),s.append(r,a),e.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,e.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let e="";this.data.forEach(a=>{let h=`
                <div class="body-item">
                    <div>${a.username}</div>
                    <div>${a.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${a.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${a.color}" >
                            x${a.multiplier}
                        </div>
                    </div>
                    <div>
                        ${a.payout>0?'<label style="color: #1AA655">+ $</label>':a.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(a.payout).toFixed(2)}
                    </div>
                </div>
            `;e+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=e}renderHeader(){var r;let e="";this.cols.forEach(a=>{e+=`<div class="header-item">${a}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=e}}customElements.define("table-all",TableAll);class TableHighWins extends HTMLElement{constructor(){super();gt(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);gt(this,"data");this.data=backendService.dataAll;const e=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const a=document.createElement("div");a.classList.add("table-body"),s.append(r,a),e.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,e.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let e="";this.data.forEach(a=>{let h=`
                <div class="body-item">
                    <div>${a.username}</div>
                    <div>${a.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${a.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${a.color}" >
                            x${a.multiplier}
                        </div>
                    </div>
                    <div>
                        ${a.payout>0?'<label style="color: #1AA655">+ $</label>':a.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(a.payout).toFixed(2)}
                    </div>
                </div>
            `;e+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=e}renderHeader(){var r;let e="";this.cols.forEach(a=>{e+=`<div class="header-item">${a}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=e}}customElements.define("table-high-wins",TableHighWins);class TableLuckyWins extends HTMLElement{constructor(){super();gt(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);gt(this,"data");this.data=backendService.dataAll;const e=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const a=document.createElement("div");a.classList.add("table-body"),s.append(r,a),e.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,e.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let e="";this.data.forEach(a=>{let h=`
                <div class="body-item">
                    <div>${a.username}</div>
                    <div>${a.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${a.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${a.color}" >
                            x${a.multiplier}
                        </div>
                    </div>
                    <div>
                        ${a.payout>0?'<label style="color: #1AA655">+ $</label>':a.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(a.payout).toFixed(2)}
                    </div>
                </div>
            `;e+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=e}renderHeader(){var r;let e="";this.cols.forEach(a=>{e+=`<div class="header-item">${a}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=e}}customElements.define("table-lucky-wins",TableLuckyWins);class TableMyWagers extends HTMLElement{constructor(){super();gt(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);gt(this,"data");this.data=backendService.dataAll;const e=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const a=document.createElement("div");a.classList.add("table-body"),s.append(r,a),e.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,e.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let e="";this.data.forEach(a=>{let h=`
                <div class="body-item">
                    <div>${a.username}</div>
                    <div>${a.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${a.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${a.color}" >
                            x${a.multiplier}
                        </div>
                    </div>
                    <div>
                        ${a.payout>0?'<label style="color: #1AA655">+ $</label>':a.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(a.payout).toFixed(2)}
                    </div>
                </div>
            `;e+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=e}renderHeader(){var r;let e="";this.cols.forEach(a=>{e+=`<div class="header-item">${a}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=e}}customElements.define("table-my-wagers",TableMyWagers);class ModalAward extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const t=`
        <style>
            tab-panel[id='tabs-award'] {
                --tabs-gap: 10px;
                --tab-width: 200rem;
                --tab-padding: 2rem 1rem;
                --tabs-height: 30.5rem;
                --tab-border-border-bottom: 1px solid #168c48;
            }

            pop-up[id='modal-award'] {
                --pop-up-dialog-margin: auto;
                --pop-up-dialog-background-color: #000;
                --pop-up-dialog-border-radius: 24px;
                --pop-up-dialog-width: 90rem;
                --pop-up-dialog-height: 70rem;
                --pop-up-contents-height: 55rem;
                --pop-up-close-line-top: 40px;
                --pop-up-close-line-right: 40px;
                --pop-up-close-box-shadow: none;
                --pop-up-close-font-size: 30px;
            }
            @media screen and (max-width: 390px) {
                pop-up[id='modal-award'] {
                    --pop-up-dialog-width: 40rem;
                }    
            }
            @media (min-width: 391px) and (max-width: 730px) {
                pop-up[id='modal-award'] {
                    --pop-up-dialog-width: 50rem;
                }    
            }
        </style>    
        `;this.innerHTML=`
            ${t}
          <pop-up static="true" id="modal-award">
            <div class="flex" slot="modal">   
                <h1>Detalle</h1>
                <tab-panel id="tabs-award">
                    <div class="item" slot="tab">
                        All
                    </div>
                    <div slot="content">
                        <table-all></table-all>
                    </div>
                    <div class="item" slot="tab">
                        High Wins
                    </div>
                    <div slot="content">
                        <table-high-wins></table-high-wins>
                    </div>
                    <div class="item" slot="tab">
                        Lucky Wins
                    </div>
                    <div slot="content">
                        <table-lucky-wins></table-lucky-wins>
                    </div>
                    <div class="item" slot="tab">
                        My Wagers
                    </div>
                    <div slot="content">
                        <table-my-wagers></table-my-wagers>
                    </div>
                </tab-panel>
            </div>
          </pop-up>
    `}}customElements.define("modal-award",ModalAward);function truncateString(n,t){if(n.length<=t)return{origin:n,truncate:n};const e=n.substring(0,t);return{origin:n,truncate:`${e}...`}}class TableLeaderboard extends HTMLElement{constructor(){super();gt(this,"cols",["Username","Bet","Multiplier","Win"]);gt(this,"data");this.data=backendService.dataLeaderboard;const e=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const a=document.createElement("div");a.classList.add("table-body"),s.append(r,a),e.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.2rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .table-body {
                overflow: auto;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
                font-style: normal;
                font-weight: 500;
                font-size: 1.2rem;
                line-height: 125%;
                letter-spacing: -0.5px;
            }
            .badge-multi {
                border-radius: 1.6rem;
                padding: 0.8rem;
                width: 4rem;
                margin: auto;
            }
        `,e.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let e="";this.data.forEach(a=>{const{truncate:h}=truncateString(a.username,12);let c=`
                <div class="body-item">
                    <div>${h}</div>
                    <div>
                        $
                        ${a.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${a.color}" >
                            x${a.multiplier}
                        </div>
                    </div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${a.win.toFixed(2)}
                    </div>
                </div>
            `;e+=c});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=e}renderHeader(){var r;let e="";this.cols.forEach(a=>{e+=`<div class="header-item">${a}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=e}}customElements.define("table-leaderboard",TableLeaderboard);class ModalLeaderboard extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const t=`
            <style>
                pop-up[id='modal-leaderboard'] {
                    --pop-up-close-display: none;
                    --pop-up-dialog-position: absolute;
                    --pop-up-dialog-top: 12rem;
                    --pop-up-dialog-right: 2.4rem;
                    --pop-up-dialog-background-color: #000;
                    --pop-up-dialog-border-radius: 2.4rem;
                    --pop-up-overlay-background-color: rgba(0, 0, 0, 0);
                    --pop-up-dialog-width: 40rem;
                    --pop-up-dialog-height: 30rem;
                    
                    --pop-up-overlay-border-radius: 2.4rem;
                }
                @media screen and (max-width: 461px) {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-close-display: block;
                    }
                }
                @media (min-width: 461px) and (max-width: 960px) {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-close-display: block;
                    }
                }
                @media (min-width: 961px)  {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-overlay-position: absolute;
                        --pop-up-overlay-top: 120px;
                        --pop-up-overlay-right: 24px;
                        --pop-up-overlay-left: none;
                        --pop-up-overlay-width: 40rem;
                        --pop-up-overlay-height: 30rem;
                    }
                }
            </style>
        `;this.innerHTML=`
            ${t}
          <pop-up static="true" id="modal-leaderboard">
            <div class="flex" slot="modal">
                <div style="height: 28rem;">
                    <table-leaderboard></table-leaderboard>
                </div>
            </div>
          </pop-up>
    `}}customElements.define("modal-leaderboard",ModalLeaderboard);class AppElement extends HTMLElement{connectedCallback(){this.innerHTML=`
        <modal-info></modal-info>
        <modal-award></modal-award>
        <modal-leaderboard></modal-leaderboard>
      `}}gt(AppElement,"observedAttributes",[]);customElements.define("element-root",AppElement);const _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1;DisplayObject.prototype._cacheData=null;DisplayObject.prototype._cacheAsBitmapResolution=null;DisplayObject.prototype._cacheAsBitmapMultisample=null;class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(n){if(this._cacheAsBitmap===n)return;this._cacheAsBitmap=n;let t;n?(this._cacheData||(this._cacheData=new CacheData),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});DisplayObject.prototype._renderCached=function n(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};DisplayObject.prototype._initCachedDisplayObject=function n(t){var p,g;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const s=this.getLocalBounds(null,!0).clone();if((g=this.filters)!=null&&g.length){const _=this.filters[0].padding;s.pad(_)}s.ceil(settings$1.RESOLUTION);const r=t.renderTexture.current,a=t.renderTexture.sourceFrame.clone(),h=t.renderTexture.destinationFrame.clone(),c=t.projection.transform,o=RenderTexture.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),u=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=u,BaseTexture.addToCache(o.baseTexture,u),Texture.addToCache(o,u);const d=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:o,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=c,t.renderTexture.bind(r,a,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const m=new Sprite(o);m.transform.worldTransform=this.transform.worldTransform,m.anchor.x=-(s.x/s.width),m.anchor.y=-(s.y/s.height),m.alpha=e,m._bounds=this._bounds,this._cacheData.sprite=m,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=m.containsPoint.bind(m)};DisplayObject.prototype._renderCachedCanvas=function n(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};DisplayObject.prototype._initCachedDisplayObjectCanvas=function n(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,a=t._projTransform;e.ceil(settings$1.RESOLUTION);const h=RenderTexture.create({width:e.width,height:e.height}),c=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=c,BaseTexture.addToCache(h.baseTexture,c),Texture.addToCache(h,c);const o=_tempMatrix;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:h,clear:!0,transform:o,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const u=new Sprite(h);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=s,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};DisplayObject.prototype._calculateCachedBounds=function n(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};DisplayObject.prototype._getCachedLocalBounds=function n(){return this._cacheData.sprite.getLocalBounds(null)};DisplayObject.prototype._destroyCachedDisplayObject=function n(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};DisplayObject.prototype._cacheAsBitmapDestroy=function n(t){this.cacheAsBitmap=!1,this.destroy(t)};DisplayObject.prototype.name=null;Container.prototype.getChildByName=function n(t,e){for(let s=0,r=this.children.length;s<r;s++)if(this.children[s].name===t)return this.children[s];if(e)for(let s=0,r=this.children.length;s<r;s++){const a=this.children[s];if(!a.getChildByName)continue;const h=a.getChildByName(t,!0);if(h)return h}return null};DisplayObject.prototype.getGlobalPosition=function n(t=new Point,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var fragment$5=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class AlphaFilter extends Filter{constructor(t=1){super(defaultVertex,fragment$5,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(n){const t=GAUSSIAN_VALUES[n],e=t.length;let s=fragTemplate,r="";const a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let h;for(let c=0;c<n;c++){let o=a.replace("%index%",c.toString());h=c,c>=e&&(h=n-c-1),o=o.replace("%value%",t[h].toString()),r+=o,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}const vertTemplate=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(n,t){const e=Math.ceil(n/2);let s=vertTemplate,r="",a;t?a="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let h=0;h<n;h++){let c=a.replace("%index%",h.toString());c=c.replace("%sampleIndex%",`${h-(e-1)}.0`),r+=c,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}class BlurFilterPass extends Filter{constructor(t,e=8,s=4,r=Filter.defaultResolution,a=5){const h=generateBlurVertSource(a,t),c=generateBlurFragSource(a);super(h,c),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=s,this.blur=e}apply(t,e,s,r){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/e.width):this.uniforms.strength=1/s.height*(s.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,s,r);else{const a=t.getFilterTexture(),h=t.renderer;let c=e,o=a;this.state.blend=!1,t.applyFilter(this,c,o,CLEAR_MODES.CLEAR);for(let u=1;u<this.passes-1;u++){t.bindAndClear(c,CLEAR_MODES.BLIT),this.uniforms.uSampler=o;const d=o;o=c,c=d,h.shader.bind(this),h.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,s,r),t.returnFilterTexture(a)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class BlurFilter extends Filter{constructor(t=8,e=4,s=Filter.defaultResolution,r=5){super(),this.blurXFilter=new BlurFilterPass(!0,t,e,s,r),this.blurYFilter=new BlurFilterPass(!1,t,e,s,r),this.resolution=s,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,s,r){const a=Math.abs(this.blurXFilter.strength),h=Math.abs(this.blurYFilter.strength);if(a&&h){const c=t.getFilterTexture();this.blurXFilter.apply(t,e,c,CLEAR_MODES.CLEAR),this.blurYFilter.apply(t,c,s,r),t.returnFilterTexture(c)}else h?this.blurYFilter.apply(t,e,s,r):this.blurXFilter.apply(t,e,s,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var fragment$4=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ColorMatrixFilter extends Filter{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(defaultFilterVertex,fragment$4,t),this.alpha=1}_loadMatrix(t,e=!1){let s=t;e&&(this._multiply(s,this.uniforms.m,t),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(t,e,s){return t[0]=e[0]*s[0]+e[1]*s[5]+e[2]*s[10]+e[3]*s[15],t[1]=e[0]*s[1]+e[1]*s[6]+e[2]*s[11]+e[3]*s[16],t[2]=e[0]*s[2]+e[1]*s[7]+e[2]*s[12]+e[3]*s[17],t[3]=e[0]*s[3]+e[1]*s[8]+e[2]*s[13]+e[3]*s[18],t[4]=e[0]*s[4]+e[1]*s[9]+e[2]*s[14]+e[3]*s[19]+e[4],t[5]=e[5]*s[0]+e[6]*s[5]+e[7]*s[10]+e[8]*s[15],t[6]=e[5]*s[1]+e[6]*s[6]+e[7]*s[11]+e[8]*s[16],t[7]=e[5]*s[2]+e[6]*s[7]+e[7]*s[12]+e[8]*s[17],t[8]=e[5]*s[3]+e[6]*s[8]+e[7]*s[13]+e[8]*s[18],t[9]=e[5]*s[4]+e[6]*s[9]+e[7]*s[14]+e[8]*s[19]+e[9],t[10]=e[10]*s[0]+e[11]*s[5]+e[12]*s[10]+e[13]*s[15],t[11]=e[10]*s[1]+e[11]*s[6]+e[12]*s[11]+e[13]*s[16],t[12]=e[10]*s[2]+e[11]*s[7]+e[12]*s[12]+e[13]*s[17],t[13]=e[10]*s[3]+e[11]*s[8]+e[12]*s[13]+e[13]*s[18],t[14]=e[10]*s[4]+e[11]*s[9]+e[12]*s[14]+e[13]*s[19]+e[14],t[15]=e[15]*s[0]+e[16]*s[5]+e[17]*s[10]+e[18]*s[15],t[16]=e[15]*s[1]+e[16]*s[6]+e[17]*s[11]+e[18]*s[16],t[17]=e[15]*s[2]+e[16]*s[7]+e[17]*s[12]+e[18]*s[17],t[18]=e[15]*s[3]+e[16]*s[8]+e[17]*s[13]+e[18]*s[18],t[19]=e[15]*s[4]+e[16]*s[9]+e[17]*s[14]+e[18]*s[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}tint(t,e){const s=t>>16&255,r=t>>8&255,a=t&255,h=[s/255,0,0,0,0,0,r/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(h,e)}greyscale(t,e){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const s=Math.cos(t),r=Math.sin(t),a=Math.sqrt,h=1/3,c=a(h),o=s+(1-s)*h,u=h*(1-s)-c*r,d=h*(1-s)+c*r,m=h*(1-s)+c*r,p=s+h*(1-s),g=h*(1-s)-c*r,_=h*(1-s)-c*r,y=h*(1-s)+c*r,v=s+h*(1-s),U=[o,u,d,0,0,m,p,g,0,0,_,y,v,0,0,0,0,0,1,0];this._loadMatrix(U,e)}contrast(t,e){const s=(t||0)+1,r=-.5*(s-1),a=[s,0,0,0,r,0,s,0,0,r,0,0,s,0,r,0,0,0,1,0];this._loadMatrix(a,e)}saturate(t=0,e){const s=t*2/3+1,r=(s-1)*-.5,a=[s,r,r,0,0,r,s,r,0,0,r,r,s,0,0,0,0,0,1,0];this._loadMatrix(a,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,s,r,a){t=t||.2,e=e||.15,s=s||16770432,r=r||3375104;const h=(s>>16&255)/255,c=(s>>8&255)/255,o=(s&255)/255,u=(r>>16&255)/255,d=(r>>8&255)/255,m=(r&255)/255,p=[.3,.59,.11,0,0,h,c,o,t,0,u,d,m,e,0,h-u,c-d,o-m,0,0];this._loadMatrix(p,a)}night(t,e){t=t||.1;const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,e)}predator(t,e){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var fragment$3=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vertex$2=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class DisplacementFilter extends Filter{constructor(t,e){const s=new Matrix;t.renderable=!1,super(vertex$2,fragment$3,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=s,e==null&&(e=20),this.scale=new Point(e,e)}apply(t,e,s,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const a=this.maskSprite.worldTransform,h=Math.sqrt(a.a*a.a+a.b*a.b),c=Math.sqrt(a.c*a.c+a.d*a.d);h!==0&&c!==0&&(this.uniforms.rotation[0]=a.a/h,this.uniforms.rotation[1]=a.b/h,this.uniforms.rotation[2]=a.c/c,this.uniforms.rotation[3]=a.d/c),t.applyFilter(this,e,s,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var fragment$2=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,vertex$1=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class FXAAFilter extends Filter{constructor(){super(vertex$1,fragment$2)}}var fragment$1=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class NoiseFilter extends Filter{constructor(t=.5,e=Math.random()){super(defaultFilterVertex,fragment$1,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const filters={AlphaFilter,BlurFilter,BlurFilterPass,ColorMatrixFilter,DisplacementFilter,FXAAFilter,NoiseFilter};Object.entries(filters).forEach(([n,t])=>{Object.defineProperty(filters,n,{get(){return deprecation("7.1.0",`filters.${n} has moved to ${n}`),t}})});class FederatedEvent{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point,this.page=new Point,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,r,a){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new Point,this.movement=new Point,this.offset=new Point,this.global=new Point,this.screen=new Point}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,r,a,h,c,o,u,d,m,p,g,_,y){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const PROPAGATION_LIMIT=2048,tempHitLocation=new Point,tempLocalMapping=new Point;class EventBoundary{constructor(t){this.dispatch=new eventemitter3Exports,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((s,r)=>s.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,r=e.length;s<r;s++)e[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const s=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,tempHitLocation.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,a=s.length-1;r<a;r++)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const r=s.children;if(r)for(let a=0;a<r.length;a++)this.all(t,e,r[a]);t.currentTarget=s,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let s=0;s<PROPAGATION_LIMIT&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,s,r,a){if(!t||!t.visible||a(t,s))return null;if(t.interactiveChildren&&t.children){const h=t.children;for(let c=h.length-1;c>=0;c--){const o=h[c],u=this.hitTestRecursive(o,e||o.interactive,s,r,a);if(u){if(u.length>0&&!u[u.length-1].parent)continue;return(u.length>0||t.interactive)&&u.push(t),u}}}return e&&r(t,s)?t.interactive?[t]:[]:null}hitPruneFn(t,e){var s;if(t.hitArea&&(t.worldTransform.applyInverse(e,tempLocalMapping),!t.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var a,h;e=e??t.type;const s=`on${e}`;(h=(a=t.currentTarget)[s])==null||h.call(a,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var c,o;if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t),s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),a=this.findMountedTarget(r.overTargets);if(((c=r.overTargets)==null?void 0:c.length)>0&&a!==e.target){const u=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,u,a);if(this.dispatchEvent(d,"pointerout"),s&&this.dispatchEvent(d,"mouseout"),!e.composedPath().includes(a)){const m=this.createPointerEvent(t,"pointerleave",a);for(m.eventPhase=m.AT_TARGET;m.target&&!e.composedPath().includes(m.target);)m.currentTarget=m.target,this.notifyTarget(m),s&&this.notifyTarget(m,"mouseleave"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(d)}if(a!==e.target){const u=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(e,u);this.dispatchEvent(d,"pointerover"),s&&this.dispatchEvent(d,"mouseover");let m=a==null?void 0:a.parent;for(;m&&m!==this.rootTarget.parent&&m!==e.target;)m=m.parent;if(!m||m===this.rootTarget.parent){const g=this.clonePointerEvent(e,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==a&&g.target!==this.rootTarget.parent;)g.currentTarget=g.target,this.notifyTarget(g),s&&this.notifyTarget(g,"mouseenter"),g.target=g.target.parent;this.freeEvent(g)}this.freeEvent(d)}const h=this.moveOnAll?"all":"dispatchEvent";this[h](e,"pointermove"),this.all(e,"globalpointermove"),e.pointerType==="touch"&&(this[h](e,"touchmove"),this.all(e,"globaltouchmove")),s&&(this[h](e,"mousemove"),this.all(e,"globalmousemove"),this.cursor=(o=e.target)==null?void 0:o.cursor),r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var h;if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(h=s.target)==null?void 0:h.cursor);const a=this.clonePointerEvent(s,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),r&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(a)}mapPointerOut(t){if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),a=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(a),s&&this.dispatchEvent(a,"mouseout");const h=this.createPointerEvent(t,"pointerleave",r);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),s&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;e.overTargets=null,this.freeEvent(a),this.freeEvent(h)}this.cursor=null}mapPointerUp(t){if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const c=s.button===2;this.dispatchEvent(s,c?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),a=this.findMountedTarget(r.pressTargetsByButton[t.button]);let h=a;if(a&&!s.composedPath().includes(a)){let c=a;for(;c&&!s.composedPath().includes(c);){if(s.currentTarget=c,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const o=s.button===2;this.notifyTarget(s,o?"rightupoutside":"mouseupoutside")}c=c.parent}delete r.pressTargetsByButton[t.button],h=c}if(h){const c=this.clonePointerEvent(s,"click");c.target=h,c.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:c.target,timeStamp:e});const o=r.clicksByButton[t.button];o.target===c.target&&e-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=c.target,o.timeStamp=e,c.detail=o.clickCount,c.pointerType==="mouse"?this.dispatchEvent(c,"click"):c.pointerType==="touch"&&this.dispatchEvent(c,"tap"),this.dispatchEvent(c,"pointertap"),this.freeEvent(c)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(s){let a=s;for(;a;)r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),a=a.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof FederatedWheelEvent)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const r=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=s??this.hitTest(r.global.x,r.global.y),typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(FederatedPointerEvent);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof FederatedPointerEvent&&e instanceof FederatedPointerEvent&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof FederatedMouseEvent&&e instanceof FederatedMouseEvent&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const s=t.currentTarget._events[e];if(s)if("fn"in s)s.fn.call(s.context,t);else for(let r=0,a=s.length;r<a&&!t.propagationImmediatelyStopped;r++)s[r].fn.call(s[r].context,t)}}const MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class EventSystem{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new EventBoundary(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const s=this.cursorStyles[t];if(s)switch(typeof s){case"string":e&&(this.domElement.style.cursor=s);break;case"function":s(t);break;case"object":e&&Object.assign(this.domElement.style,s);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let s=0,r=e.length;s<r;s++){const a=e[s],h=this.bootstrapEvent(this.rootPointerEvent,a);this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let s=0,r=e.length;s<r;s++){const a=this.bootstrapEvent(this.rootPointerEvent,e[s]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const s=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let a=0,h=r.length;a<h;a++){const c=this.bootstrapEvent(this.rootPointerEvent,r[a]);c.type+=s,this.rootBoundary.mapEvent(c)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let s=0,r=e.length;s<r;s++){const a=this.bootstrapEvent(this.rootPointerEvent,e[s]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,s){let r;this.domElement.parentElement?r=this.domElement.getBoundingClientRect():r={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const a=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*a,t.y=(s-r.top)*(this.domElement.height/r.height)*a}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let s=0,r=t.changedTouches.length;s<r;s++){const a=t.changedTouches[s];typeof a.button>"u"&&(a.button=0),typeof a.buttons>"u"&&(a.buttons=1),typeof a.isPrimary>"u"&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,a.type=t.type,e.push(a)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const s=t;typeof s.isPrimary>"u"&&(s.isPrimary=!0),typeof s.width>"u"&&(s.width=1),typeof s.height>"u"&&(s.height=1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="mouse"),typeof s.pointerId>"u"&&(s.pointerId=MOUSE_POINTER_ID),typeof s.pressure>"u"&&(s.pressure=.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=TOUCH_TO_POINTER[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}EventSystem.extension={name:"events",type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem]};extensions$1.add(EventSystem);const FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(n,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;n=s?`${n}capture`:n,t=typeof t=="function"?t:t.handleEvent,this.on(n,t,r)},removeEventListener(n,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;n=s?`${n}capture`:n,t=typeof t=="function"?t:t.handleEvent,this.off(n,t,r)},dispatchEvent(n){if(!(n instanceof FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};DisplayObject.mixin(FederatedDisplayObject);const accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};DisplayObject.mixin(accessibleTarget);const KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;class AccessibilityManager{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile.tablet||isMobile.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${DIV_TOUCH_SIZE}px`,e.style.height=`${DIV_TOUCH_SIZE}px`,e.style.position="absolute",e.style.top=`${DIV_TOUCH_POS_X}px`,e.style.left=`${DIV_TOUCH_POS_Y}px`,e.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${DIV_HOOK_SIZE}px`,t.style.height=`${DIV_HOOK_SIZE}px`,t.style.position="absolute",t.style.top=`${DIV_HOOK_POS_X}px`,t.style.left=`${DIV_HOOK_POS_Y}px`,t.style.zIndex=DIV_HOOK_ZINDEX.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let s=0;s<e.length;s++)this.updateAccessibleObjects(e[s])}update(){const t=performance.now();if(isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:s,width:r,height:a}=this.renderer.view.getBoundingClientRect(),{width:h,height:c,resolution:o}=this.renderer,u=r/h*o,d=a/c*o;let m=this.div;m.style.left=`${e}px`,m.style.top=`${s}px`,m.style.width=`${h}px`,m.style.height=`${c}px`;for(let p=0;p<this.children.length;p++){const g=this.children[p];if(g.renderId!==this.renderId)g._accessibleActive=!1,removeItems(this.children,p,1),this.div.removeChild(g._accessibleDiv),this.pool.push(g._accessibleDiv),g._accessibleDiv=null,p--;else{m=g._accessibleDiv;let _=g.hitArea;const y=g.worldTransform;g.hitArea?(m.style.left=`${(y.tx+_.x*y.a)*u}px`,m.style.top=`${(y.ty+_.y*y.d)*d}px`,m.style.width=`${_.width*y.a*u}px`,m.style.height=`${_.height*y.d*d}px`):(_=g.getBounds(),this.capHitArea(_),m.style.left=`${_.x*u}px`,m.style.top=`${_.y*d}px`,m.style.width=`${_.width*u}px`,m.style.height=`${_.height*d}px`,m.title!==g.accessibleTitle&&g.accessibleTitle!==null&&(m.title=g.accessibleTitle),m.getAttribute("aria-label")!==g.accessibleHint&&g.accessibleHint!==null&&m.setAttribute("aria-label",g.accessibleHint)),(g.accessibleTitle!==m.title||g.tabIndex!==m.tabIndex)&&(m.title=g.accessibleTitle,m.tabIndex=g.tabIndex,this.debug&&this.updateDebugHTML(m))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:s}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>s&&(t.height=s-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${DIV_TOUCH_SIZE}px`,e.style.height=`${DIV_TOUCH_SIZE}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=DIV_TOUCH_ZINDEX.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:s}=t.target,r=this.renderer.events.rootBoundary,a=Object.assign(new FederatedEvent(r),{target:s});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(h=>r.dispatchEvent(a,h))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===KEY_CODE_TAB&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}AccessibilityManager.extension={name:"accessibility",type:[ExtensionType.RendererPlugin,ExtensionType.CanvasRendererPlugin]};extensions$1.add(AccessibilityManager);const _Application=class{constructor(n){this.stage=new Container,n=Object.assign({forceCanvas:!1},n),this.renderer=autoDetectRenderer(n),_Application._plugins.forEach(t=>{t.init.call(this,n)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(n,t){const e=_Application._plugins.slice(0);e.reverse(),e.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(n),this.renderer=null}};let Application=_Application;Application._plugins=[];extensions$1.handleByList(ExtensionType.Application,Application._plugins);class ResizePlugin{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,s;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:a}=this._resizeTo;e=r,s=a}this.renderer.resize(e,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ResizePlugin.extension=ExtensionType.Application;extensions$1.add(ResizePlugin);var INTERNAL_FORMATS=(n=>(n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n))(INTERNAL_FORMATS||{});const INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let storedGl,extensions;function getCompressedTextureExtensions(){extensions={s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc")}}const detectCompressedTextures={extension:{type:ExtensionType.DetectionParser,priority:2},test:async()=>{const t=settings$1.ADAPTER.createCanvas().getContext("webgl");return t?(storedGl=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async n=>{extensions||getCompressedTextureExtensions();const t=[];for(const e in extensions)extensions[e]&&t.push(e);return[...t,...n]},remove:async n=>(extensions||getCompressedTextureExtensions(),n.filter(t=>!(t in extensions)))};extensions$1.add(detectCompressedTextures);class BlobResource extends BufferResource{constructor(t,e={width:1,height:1,autoLoad:!0}){let s,r;typeof t=="string"?(s=t,r=new Uint8Array):(s=null,r=t),super(r,e),this.origin=s,this.buffer=r?new ViewableBuffer(r):null,this.origin&&e.autoLoad!==!1&&this.load(),r!=null&&r.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const s=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(s),this.buffer=new ViewableBuffer(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),this}}class CompressedTextureResource extends BlobResource{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||CompressedTextureResource._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,s){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let h=0,c=this.levels;h<c;h++){const{levelID:o,levelWidth:u,levelHeight:d,levelBuffer:m}=this._levelBuffers[h];r.compressedTexImage2D(r.TEXTURE_2D,o,this.format,u,d,0,m)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,s,r,a,h,c){const o=new Array(s);let u=t.byteOffset,d=h,m=c,p=d+r-1&~(r-1),g=m+a-1&~(a-1),_=p*g*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[e];for(let y=0;y<s;y++)o[y]={levelID:y,levelWidth:s>1?d:p,levelHeight:s>1?m:g,levelBuffer:new Uint8Array(t.buffer,u,_)},u+=_,d=d>>1||1,m=m>>1||1,p=d+r-1&~(r-1),g=m+a-1&~(a-1),_=p*g*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[e];return o}}const DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT={[FOURCC_DXT1]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[FOURCC_DXT3]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[FOURCC_DXT5]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},DXGI_TO_FORMAT={[70]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function parseDDS(n){const t=new Uint32Array(n);if(t[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");const s=new Uint32Array(n,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),r=s[DDS_FIELDS.HEIGHT],a=s[DDS_FIELDS.WIDTH],h=s[DDS_FIELDS.MIPMAP_COUNT],c=new Uint32Array(n,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),o=c[PF_FLAGS];if(o&DDPF_FOURCC){const u=c[DDS_PF_FIELDS.FOURCC];if(u!==FOURCC_DX10){const k=FOURCC_TO_FORMAT[u],N=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,W=new Uint8Array(n,N);return[new CompressedTextureResource(W,{format:k,width:a,height:r,levels:h})]}const d=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,m=new Uint32Array(t.buffer,d,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),p=m[DDS_DX10_FIELDS.DXGI_FORMAT],g=m[DDS_DX10_FIELDS.RESOURCE_DIMENSION],_=m[DDS_DX10_FIELDS.MISC_FLAG],y=m[DDS_DX10_FIELDS.ARRAY_SIZE],v=DXGI_TO_FORMAT[p];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${p}`);if(_===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(g===6)throw new Error("DDSParser does not supported 3D texture data");const U=new Array,w=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(y===1)U.push(new Uint8Array(n,w));else{const k=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[v];let N=0,W=a,et=r;for(let ft=0;ft<h;ft++){const mt=Math.max(1,W+3&-4),xt=Math.max(1,et+3&-4),yt=mt*xt*k;N+=yt,W=W>>>1,et=et>>>1}let it=w;for(let ft=0;ft<y;ft++)U.push(new Uint8Array(n,it,N)),it+=N}return U.map(k=>new CompressedTextureResource(k,{format:v,width:a,height:r,levels:h}))}throw o&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):o&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):o&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):o&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT={[TYPES.UNSIGNED_BYTE]:1,[TYPES.UNSIGNED_SHORT]:2,[TYPES.INT]:4,[TYPES.UNSIGNED_INT]:4,[TYPES.FLOAT]:4,[TYPES.HALF_FLOAT]:8},FORMATS_TO_COMPONENTS={[FORMATS.RGBA]:4,[FORMATS.RGB]:3,[FORMATS.RG]:2,[FORMATS.RED]:1,[FORMATS.LUMINANCE]:1,[FORMATS.LUMINANCE_ALPHA]:2,[FORMATS.ALPHA]:1},TYPES_TO_BYTES_PER_PIXEL={[TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[TYPES.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(n,t,e=!1){const s=new DataView(t);if(!validate(n,s))return null;const r=s.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,a=s.getUint32(KTX_FIELDS.GL_TYPE,r),h=s.getUint32(KTX_FIELDS.GL_FORMAT,r),c=s.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,r),o=s.getUint32(KTX_FIELDS.PIXEL_WIDTH,r),u=s.getUint32(KTX_FIELDS.PIXEL_HEIGHT,r)||1,d=s.getUint32(KTX_FIELDS.PIXEL_DEPTH,r)||1,m=s.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,r)||1,p=s.getUint32(KTX_FIELDS.NUMBER_OF_FACES,r),g=s.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,r),_=s.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,r);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(p!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(m!==1)throw new Error("WebGL does not support array textures");const y=4,v=4,U=o+3&-4,w=u+3&-4,k=new Array(m);let N=o*u;a===0&&(N=U*w);let W;if(a!==0?TYPES_TO_BYTES_PER_COMPONENT[a]?W=TYPES_TO_BYTES_PER_COMPONENT[a]*FORMATS_TO_COMPONENTS[h]:W=TYPES_TO_BYTES_PER_PIXEL[a]:W=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[c],W===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const et=e?parseKvData(s,_,r):null;let ft=N*W,mt=o,xt=u,yt=U,vt=w,St=FILE_HEADER_SIZE+_;for(let wt=0;wt<g;wt++){const Ct=s.getUint32(St,r);let It=St+4;for(let Pt=0;Pt<m;Pt++){let Xt=k[Pt];Xt||(Xt=k[Pt]=new Array(g)),Xt[wt]={levelID:wt,levelWidth:g>1||a!==0?mt:yt,levelHeight:g>1||a!==0?xt:vt,levelBuffer:new Uint8Array(t,It,ft)},It+=ft}St+=Ct+4,St=St%4!==0?St+4-St%4:St,mt=mt>>1||1,xt=xt>>1||1,yt=mt+y-1&~(y-1),vt=xt+v-1&~(v-1),ft=yt*vt*W}return a!==0?{uncompressed:k.map(wt=>{let Ct=wt[0].levelBuffer,It=!1;return a===TYPES.FLOAT?Ct=new Float32Array(wt[0].levelBuffer.buffer,wt[0].levelBuffer.byteOffset,wt[0].levelBuffer.byteLength/4):a===TYPES.UNSIGNED_INT?(It=!0,Ct=new Uint32Array(wt[0].levelBuffer.buffer,wt[0].levelBuffer.byteOffset,wt[0].levelBuffer.byteLength/4)):a===TYPES.INT&&(It=!0,Ct=new Int32Array(wt[0].levelBuffer.buffer,wt[0].levelBuffer.byteOffset,wt[0].levelBuffer.byteLength/4)),{resource:new BufferResource(Ct,{width:wt[0].levelWidth,height:wt[0].levelHeight}),type:a,format:It?convertFormatToInteger(h):h}}),kvData:et}:{compressed:k.map(wt=>new CompressedTextureResource(null,{format:c,width:o,height:u,levels:g,levelBuffers:wt})),kvData:et}}function validate(n,t){for(let e=0;e<FILE_IDENTIFIER.length;e++)if(t.getUint8(e)!==FILE_IDENTIFIER[e])return console.error(`${n} is not a valid *.ktx file!`),!1;return!0}function convertFormatToInteger(n){switch(n){case FORMATS.RGBA:return FORMATS.RGBA_INTEGER;case FORMATS.RGB:return FORMATS.RGB_INTEGER;case FORMATS.RG:return FORMATS.RG_INTEGER;case FORMATS.RED:return FORMATS.RED_INTEGER;default:return n}}function parseKvData(n,t,e){const s=new Map;let r=0;for(;r<t;){const a=n.getUint32(FILE_HEADER_SIZE+r,e),h=FILE_HEADER_SIZE+r+4,c=3-(a+3)%4;if(a===0||a>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let o=0;for(;o<a&&n.getUint8(h+o)!==0;o++);if(o===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(n.buffer,h,o)),d=new DataView(n.buffer,h+o+1,a-o-1);s.set(u,d),r+=4+a+c}return s}const loadDDS={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return checkExtension(n,".dds")},async load(n,t,e){const r=await(await settings$1.ADAPTER.fetch(n)).arrayBuffer(),h=parseDDS(r).map(c=>{const o=new BaseTexture(c,{mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(n),...t.data});return createTexture(o,e,n)});return h.length===1?h[0]:h},unload(n){Array.isArray(n)?n.forEach(t=>t.destroy(!0)):n.destroy(!0)}};extensions$1.add(loadDDS);const loadKTX={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return checkExtension(n,".ktx")},async load(n,t,e){const r=await(await settings$1.ADAPTER.fetch(n)).arrayBuffer(),{compressed:a,uncompressed:h,kvData:c}=parseKTX(n,r),o=a??h,u={mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(n),...t.data},d=o.map(m=>{o===h&&Object.assign(u,{type:m.type,format:m.format});const p=new BaseTexture(m,u);return p.ktxKeyValueData=c,createTexture(p,e,n)});return d.length===1?d[0]:d},unload(n){Array.isArray(n)?n.forEach(t=>t.destroy(!0)):n.destroy(!0)}};extensions$1.add(loadKTX);const resolveCompressedTextureUrl={extension:ExtensionType.ResolveParser,test:n=>{const e=n.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:n=>{var s,r;if(n.split("?")[0].split(".").pop()==="ktx"){const a=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(a.some(h=>n.endsWith(h)))return{resolution:parseFloat(((s=settings$1.RETINA_PREFIX.exec(n))==null?void 0:s[1])??"1"),format:a.find(h=>n.endsWith(h)),src:n}}return{resolution:parseFloat(((r=settings$1.RETINA_PREFIX.exec(n))==null?void 0:r[1])??"1"),format:n.split(".").pop(),src:n}}};extensions$1.add(resolveCompressedTextureUrl);const TEMP_RECT=new Rectangle,BYTES_PER_PIXEL=4,_Extract=class{constructor(n){this.renderer=n}async image(n,t,e){const s=new Image;return s.src=await this.base64(n,t,e),s}async base64(n,t,e){const s=this.canvas(n);if(s.toDataURL!==void 0)return s.toDataURL(t,e);if(s.convertToBlob!==void 0){const r=await s.convertToBlob({type:t,quality:e});return await new Promise(a=>{const h=new FileReader;h.onload=()=>a(h.result),h.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(n,t){const e=this.renderer;let s,r=!1,a,h=!1;n&&(n instanceof RenderTexture?a=n:(a=this.renderer.generateTexture(n),h=!0)),a?(s=a.baseTexture.resolution,t=t??a.frame,r=!1,e.renderTexture.bind(a)):(s=e.resolution,t||(t=TEMP_RECT,t.width=e.width,t.height=e.height),r=!0,e.renderTexture.bind(null));const c=Math.round(t.width*s),o=Math.round(t.height*s);let u=new CanvasRenderTarget(c,o,1);const d=new Uint8Array(BYTES_PER_PIXEL*c*o),m=e.gl;m.readPixels(Math.round(t.x*s),Math.round(t.y*s),c,o,m.RGBA,m.UNSIGNED_BYTE,d);const p=u.context.getImageData(0,0,c,o);if(_Extract.arrayPostDivide(d,p.data),u.context.putImageData(p,0,0),r){const g=new CanvasRenderTarget(u.width,u.height,1);g.context.scale(1,-1),g.context.drawImage(u.canvas,0,-o),u.destroy(),u=g}return h&&a.destroy(!0),u.canvas}pixels(n,t){const e=this.renderer;let s,r,a=!1;n&&(n instanceof RenderTexture?r=n:(r=this.renderer.generateTexture(n),a=!0)),r?(s=r.baseTexture.resolution,t=t??r.frame,e.renderTexture.bind(r)):(s=e.resolution,t||(t=TEMP_RECT,t.width=e.width,t.height=e.height),e.renderTexture.bind(null));const h=Math.round(t.width*s),c=Math.round(t.height*s),o=new Uint8Array(BYTES_PER_PIXEL*h*c),u=e.gl;return u.readPixels(Math.round(t.x*s),Math.round(t.y*s),h,c,u.RGBA,u.UNSIGNED_BYTE,o),a&&r.destroy(!0),_Extract.arrayPostDivide(o,o),o}destroy(){this.renderer=null}static arrayPostDivide(n,t){for(let e=0;e<n.length;e+=4){const s=t[e+3]=n[e+3];s!==0?(t[e]=Math.round(Math.min(n[e]*255/s,255)),t[e+1]=Math.round(Math.min(n[e+1]*255/s,255)),t[e+2]=Math.round(Math.min(n[e+2]*255/s,255))):(t[e]=n[e],t[e+1]=n[e+1],t[e+2]=n[e+2])}}};let Extract=_Extract;Extract.extension={name:"extract",type:ExtensionType.RendererSystem};extensions$1.add(Extract);class ParticleBuffer{constructor(t,e,s){this.geometry=new Geometry,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let a=t[r];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||TYPES.FLOAT,offset:a.offset},e[r]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Buffer(createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let h=0;h<this.dynamicProperties.length;++h){const c=this.dynamicProperties[h];c.offset=e,e+=c.size,this.dynamicStride+=c.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Buffer(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let h=0;h<this.staticProperties.length;++h){const c=this.staticProperties[h];c.offset=r,r+=c.size,this.staticStride+=c.size}const a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Buffer(this.staticData,!0,!1);for(let h=0;h<this.dynamicProperties.length;++h){const c=this.dynamicProperties[h];t.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===TYPES.UNSIGNED_BYTE,c.type,this.dynamicStride*4,c.offset*4)}for(let h=0;h<this.staticProperties.length;++h){const c=this.staticProperties[h];t.addAttribute(c.attributeName,this.staticBuffer,0,c.type===TYPES.UNSIGNED_BYTE,c.type,this.staticStride*4,c.offset*4)}}uploadDynamic(t,e,s){for(let r=0;r<this.dynamicProperties.length;r++){const a=this.dynamicProperties[r];a.uploadFunction(t,e,s,a.type===TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,s){for(let r=0;r<this.staticProperties.length;r++){const a=this.staticProperties[r];a.uploadFunction(t,e,s,a.type===TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var fragment=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ParticleRenderer extends ObjectRenderer{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Shader.from(vertex,fragment,{}),this.state=State$1.for2d()}render(t){const e=t.children,s=t._maxSize,r=t._batchSize,a=this.renderer;let h=e.length;if(h===0)return;h>s&&!t.autoResize&&(h=s);let c=t._buffers;c||(c=t._buffers=this.generateBuffers(t));const o=e[0]._texture.baseTexture,u=o.alphaMode>0;this.state.blendMode=correctBlendMode(t.blendMode,u),a.state.set(this.state);const d=a.gl,m=t.worldTransform.copyTo(this.tempMatrix);m.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=m.toArray(!0),this.shader.uniforms.uColor=premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);let p=!1;for(let g=0,_=0;g<h;g+=r,_+=1){let y=h-g;y>r&&(y=r),_>=c.length&&c.push(this._generateOneMoreBuffer(t));const v=c[_];v.uploadDynamic(e,g,y);const U=t._bufferUpdateIDs[_]||0;p=p||v._updateID<U,p&&(v._updateID=t._updateID,v.uploadStatic(e,g,y)),a.geometry.bind(v.geometry),d.drawElements(d.TRIANGLES,y*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],s=t._maxSize,r=t._batchSize,a=t._properties;for(let h=0;h<s;h+=r)e.push(new ParticleBuffer(this.properties,a,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,s=t._properties;return new ParticleBuffer(this.properties,s,e)}uploadVertices(t,e,s,r,a,h){let c=0,o=0,u=0,d=0;for(let m=0;m<s;++m){const p=t[e+m],g=p._texture,_=p.scale.x,y=p.scale.y,v=g.trim,U=g.orig;v?(o=v.x-p.anchor.x*U.width,c=o+v.width,d=v.y-p.anchor.y*U.height,u=d+v.height):(c=U.width*(1-p.anchor.x),o=U.width*-p.anchor.x,u=U.height*(1-p.anchor.y),d=U.height*-p.anchor.y),r[h]=o*_,r[h+1]=d*y,r[h+a]=c*_,r[h+a+1]=d*y,r[h+a*2]=c*_,r[h+a*2+1]=u*y,r[h+a*3]=o*_,r[h+a*3+1]=u*y,h+=a*4}}uploadPosition(t,e,s,r,a,h){for(let c=0;c<s;c++){const o=t[e+c].position;r[h]=o.x,r[h+1]=o.y,r[h+a]=o.x,r[h+a+1]=o.y,r[h+a*2]=o.x,r[h+a*2+1]=o.y,r[h+a*3]=o.x,r[h+a*3+1]=o.y,h+=a*4}}uploadRotation(t,e,s,r,a,h){for(let c=0;c<s;c++){const o=t[e+c].rotation;r[h]=o,r[h+a]=o,r[h+a*2]=o,r[h+a*3]=o,h+=a*4}}uploadUvs(t,e,s,r,a,h){for(let c=0;c<s;++c){const o=t[e+c]._texture._uvs;o?(r[h]=o.x0,r[h+1]=o.y0,r[h+a]=o.x1,r[h+a+1]=o.y1,r[h+a*2]=o.x2,r[h+a*2+1]=o.y2,r[h+a*3]=o.x3,r[h+a*3+1]=o.y3,h+=a*4):(r[h]=0,r[h+1]=0,r[h+a]=0,r[h+a+1]=0,r[h+a*2]=0,r[h+a*2+1]=0,r[h+a*3]=0,r[h+a*3+1]=0,h+=a*4)}}uploadTint(t,e,s,r,a,h){for(let c=0;c<s;++c){const o=t[e+c],u=o._texture.baseTexture.alphaMode>0,d=o.alpha,m=d<1&&u?premultiplyTint(o._tintRGB,d):o._tintRGB+(d*255<<24);r[h]=m,r[h+a]=m,r[h+a*2]=m,r[h+a*3]=m,h+=a*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ParticleRenderer.extension={name:"particle",type:ExtensionType.RendererPlugin};extensions$1.add(ParticleRenderer);var TEXT_GRADIENT=(n=>(n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",n))(TEXT_GRADIENT||{});const contextSettings={willReadFrequently:!0},_TextMetrics=class{static get experimentalLetterSpacingSupported(){let n=_TextMetrics._experimentalLetterSpacingSupported;if(n!==void 0){const t=settings$1.ADAPTER.getCanvasRenderingContext2D().prototype;n=_TextMetrics._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return n}constructor(n,t,e,s,r,a,h,c,o){this.text=n,this.style=t,this.width=e,this.height=s,this.lines=r,this.lineWidths=a,this.lineHeight=h,this.maxLineWidth=c,this.fontProperties=o}static measureText(n,t,e,s=_TextMetrics._canvas){e=e??t.wordWrap;const r=t.toFontString(),a=_TextMetrics.measureFont(r);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);const h=s.getContext("2d",contextSettings);h.font=r;const o=(e?_TextMetrics.wordWrap(n,t,s):n).split(/(?:\r\n|\r|\n)/),u=new Array(o.length);let d=0;for(let _=0;_<o.length;_++){const y=_TextMetrics._measureText(o[_],t.letterSpacing,h);u[_]=y,d=Math.max(d,y)}let m=d+t.strokeThickness;t.dropShadow&&(m+=t.dropShadowDistance);const p=t.lineHeight||a.fontSize+t.strokeThickness;let g=Math.max(p,a.fontSize+t.strokeThickness*2)+(o.length-1)*(p+t.leading);return t.dropShadow&&(g+=t.dropShadowDistance),new _TextMetrics(n,t,m,g,o,u,p+t.leading,d,a)}static _measureText(n,t,e){let s=!1;_TextMetrics.experimentalLetterSpacingSupported&&(_TextMetrics.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,s=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(n).width;return r>0&&(s?r-=t:r+=(_TextMetrics.graphemeSegmenter(n).length-1)*t),r}static wordWrap(n,t,e=_TextMetrics._canvas){const s=e.getContext("2d",contextSettings);let r=0,a="",h="";const c=Object.create(null),{letterSpacing:o,whiteSpace:u}=t,d=_TextMetrics.collapseSpaces(u),m=_TextMetrics.collapseNewlines(u);let p=!d;const g=t.wordWrapWidth+o,_=_TextMetrics.tokenize(n);for(let y=0;y<_.length;y++){let v=_[y];if(_TextMetrics.isNewline(v)){if(!m){h+=_TextMetrics.addLine(a),p=!d,a="",r=0;continue}v=" "}if(d){const w=_TextMetrics.isBreakingSpace(v),k=_TextMetrics.isBreakingSpace(a[a.length-1]);if(w&&k)continue}const U=_TextMetrics.getFromCache(v,o,c,s);if(U>g)if(a!==""&&(h+=_TextMetrics.addLine(a),a="",r=0),_TextMetrics.canBreakWords(v,t.breakWords)){const w=_TextMetrics.wordWrapSplit(v);for(let k=0;k<w.length;k++){let N=w[k],W=N,et=1;for(;w[k+et];){const ft=w[k+et];if(!_TextMetrics.canBreakChars(W,ft,v,k,t.breakWords))N+=ft;else break;W=ft,et++}k+=et-1;const it=_TextMetrics.getFromCache(N,o,c,s);it+r>g&&(h+=_TextMetrics.addLine(a),p=!1,a="",r=0),a+=N,r+=it}}else{a.length>0&&(h+=_TextMetrics.addLine(a),a="",r=0);const w=y===_.length-1;h+=_TextMetrics.addLine(v,!w),p=!1,a="",r=0}else U+r>g&&(p=!1,h+=_TextMetrics.addLine(a),a="",r=0),(a.length>0||!_TextMetrics.isBreakingSpace(v)||p)&&(a+=v,r+=U)}return h+=_TextMetrics.addLine(a,!1),h}static addLine(n,t=!0){return n=_TextMetrics.trimRight(n),n=t?`${n}
`:n,n}static getFromCache(n,t,e,s){let r=e[n];return typeof r!="number"&&(r=_TextMetrics._measureText(n,t,s)+t,e[n]=r),r}static collapseSpaces(n){return n==="normal"||n==="pre-line"}static collapseNewlines(n){return n==="normal"}static trimRight(n){if(typeof n!="string")return"";for(let t=n.length-1;t>=0;t--){const e=n[t];if(!_TextMetrics.isBreakingSpace(e))break;n=n.slice(0,-1)}return n}static isNewline(n){return typeof n!="string"?!1:_TextMetrics._newlines.includes(n.charCodeAt(0))}static isBreakingSpace(n,t){return typeof n!="string"?!1:_TextMetrics._breakingSpaces.includes(n.charCodeAt(0))}static tokenize(n){const t=[];let e="";if(typeof n!="string")return t;for(let s=0;s<n.length;s++){const r=n[s],a=n[s+1];if(_TextMetrics.isBreakingSpace(r,a)||_TextMetrics.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(n,t){return t}static canBreakChars(n,t,e,s,r){return!0}static wordWrapSplit(n){return _TextMetrics.graphemeSegmenter(n)}static measureFont(n){if(_TextMetrics._fonts[n])return _TextMetrics._fonts[n];const t={ascent:0,descent:0,fontSize:0},e=_TextMetrics._canvas,s=_TextMetrics._context;s.font=n;const r=_TextMetrics.METRICS_STRING+_TextMetrics.BASELINE_SYMBOL,a=Math.ceil(s.measureText(r).width);let h=Math.ceil(s.measureText(_TextMetrics.BASELINE_SYMBOL).width);const c=Math.ceil(_TextMetrics.HEIGHT_MULTIPLIER*h);if(h=h*_TextMetrics.BASELINE_MULTIPLIER|0,a===0||c===0)return _TextMetrics._fonts[n]=t,t;e.width=a,e.height=c,s.fillStyle="#f00",s.fillRect(0,0,a,c),s.font=n,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,h);const o=s.getImageData(0,0,a,c).data,u=o.length,d=a*4;let m=0,p=0,g=!1;for(m=0;m<h;++m){for(let _=0;_<d;_+=4)if(o[p+_]!==255){g=!0;break}if(!g)p+=d;else break}for(t.ascent=h-m,p=u-d,g=!1,m=c;m>h;--m){for(let _=0;_<d;_+=4)if(o[p+_]!==255){g=!0;break}if(!g)p-=d;else break}return t.descent=m-h,t.fontSize=t.ascent+t.descent,_TextMetrics._fonts[n]=t,t}static clearMetrics(n=""){n?delete _TextMetrics._fonts[n]:_TextMetrics._fonts={}}static get _canvas(){if(!_TextMetrics.__canvas){let n;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",contextSettings);if(e!=null&&e.measureText)return _TextMetrics.__canvas=t,t;n=settings$1.ADAPTER.createCanvas()}catch{n=settings$1.ADAPTER.createCanvas()}n.width=n.height=10,_TextMetrics.__canvas=n}return _TextMetrics.__canvas}static get _context(){return _TextMetrics.__context||(_TextMetrics.__context=_TextMetrics._canvas.getContext("2d",contextSettings)),_TextMetrics.__context}};let TextMetrics=_TextMetrics;TextMetrics.METRICS_STRING="|ÉqÅ";TextMetrics.BASELINE_SYMBOL="M";TextMetrics.BASELINE_MULTIPLIER=1.4;TextMetrics.HEIGHT_MULTIPLIER=2;TextMetrics.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return t=>[...n.segment(t)].map(e=>e.segment)}return n=>[...n]})();TextMetrics.experimentalLetterSpacing=!1;TextMetrics._fonts={};TextMetrics._newlines=[10,13];TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=class{constructor(n){this.styleID=0,this.reset(),deepCopyProperties(this,n,n)}clone(){const n={};return deepCopyProperties(n,this,_TextStyle.defaultStyle),new _TextStyle(n)}reset(){deepCopyProperties(this,_TextStyle.defaultStyle,_TextStyle.defaultStyle)}get align(){return this._align}set align(n){this._align!==n&&(this._align=n,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(n){this._breakWords!==n&&(this._breakWords=n,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(n){this._dropShadow!==n&&(this._dropShadow=n,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(n){this._dropShadowAlpha!==n&&(this._dropShadowAlpha=n,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(n){this._dropShadowAngle!==n&&(this._dropShadowAngle=n,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(n){this._dropShadowBlur!==n&&(this._dropShadowBlur=n,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(n){const t=getColor(n);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(n){this._dropShadowDistance!==n&&(this._dropShadowDistance=n,this.styleID++)}get fill(){return this._fill}set fill(n){const t=getColor(n);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(n){this._fillGradientType!==n&&(this._fillGradientType=n,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(n){areArraysEqual(this._fillGradientStops,n)||(this._fillGradientStops=n,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(n){this.fontFamily!==n&&(this._fontFamily=n,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(n){this._fontSize!==n&&(this._fontSize=n,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(n){this._fontStyle!==n&&(this._fontStyle=n,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(n){this._fontVariant!==n&&(this._fontVariant=n,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(n){this._fontWeight!==n&&(this._fontWeight=n,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(n){this._lineHeight!==n&&(this._lineHeight=n,this.styleID++)}get leading(){return this._leading}set leading(n){this._leading!==n&&(this._leading=n,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(n){this._lineJoin!==n&&(this._lineJoin=n,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(n){this._miterLimit!==n&&(this._miterLimit=n,this.styleID++)}get padding(){return this._padding}set padding(n){this._padding!==n&&(this._padding=n,this.styleID++)}get stroke(){return this._stroke}set stroke(n){const t=getColor(n);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(n){this._strokeThickness!==n&&(this._strokeThickness=n,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(n){this._textBaseline!==n&&(this._textBaseline=n,this.styleID++)}get trim(){return this._trim}set trim(n){this._trim!==n&&(this._trim=n,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(n){this._whiteSpace!==n&&(this._whiteSpace=n,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(n){this._wordWrap!==n&&(this._wordWrap=n,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(n){this._wordWrapWidth!==n&&(this._wordWrapWidth=n,this.styleID++)}toFontString(){const n=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let s=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!genericFontFamilies.includes(s)&&(s=`"${s}"`),t[e]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${n} ${t.join(",")}`}};let TextStyle=_TextStyle;TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function getSingleColor(n){return typeof n=="number"?hex2string(n):(typeof n=="string"&&n.startsWith("0x")&&(n=n.replace("0x","#")),n)}function getColor(n){if(Array.isArray(n)){for(let t=0;t<n.length;++t)n[t]=getSingleColor(n[t]);return n}else return getSingleColor(n)}function areArraysEqual(n,t){if(!Array.isArray(n)||!Array.isArray(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(n[e]!==t[e])return!1;return!0}function deepCopyProperties(n,t,e){for(const s in e)Array.isArray(t[s])?n[s]=t[s].slice():n[s]=t[s]}const defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=class extends Sprite{constructor(n,t,e){let s=!1;e||(e=settings$1.ADAPTER.createCanvas(),s=!0),e.width=3,e.height=3;const r=Texture.from(e);r.orig=new Rectangle,r.trim=new Rectangle,super(r),this._ownCanvas=s,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=_Text.defaultResolution??settings$1.RESOLUTION,this._autoResolution=_Text.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=n,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return TextMetrics.experimentalLetterSpacing}static set experimentalLetterSpacing(n){deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),TextMetrics.experimentalLetterSpacing=n}updateText(n){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&n)return;this._font=this._style.toFontString();const e=this.context,s=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=s.width,a=s.height,h=s.lines,c=s.lineHeight,o=s.lineWidths,u=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let m,p;const g=t.dropShadow?2:1;for(let _=0;_<g;++_){const y=t.dropShadow&&_===0,v=y?Math.ceil(Math.max(1,a)+t.padding*2):0,U=v*this._resolution;if(y){e.fillStyle="black",e.strokeStyle="black";const k=t.dropShadowColor,N=hex2rgb(typeof k=="number"?k:string2hex(k)),W=t.dropShadowBlur*this._resolution,et=t.dropShadowDistance*this._resolution;e.shadowColor=`rgba(${N[0]*255},${N[1]*255},${N[2]*255},${t.dropShadowAlpha})`,e.shadowBlur=W,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*et,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*et+U}else e.fillStyle=this._generateFillStyle(t,h,s),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let w=(c-d.fontSize)/2;c-d.fontSize<0&&(w=0);for(let k=0;k<h.length;k++)m=t.strokeThickness/2,p=t.strokeThickness/2+k*c+d.ascent+w,t.align==="right"?m+=u-o[k]:t.align==="center"&&(m+=(u-o[k])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(h[k],m+t.padding,p+t.padding-v,!0),t.fill&&this.drawLetterSpacing(h[k],m+t.padding,p+t.padding-v)}this.updateTexture()}drawLetterSpacing(n,t,e,s=!1){const a=this._style.letterSpacing;let h=!1;if(TextMetrics.experimentalLetterSpacingSupported&&(TextMetrics.experimentalLetterSpacing?(this.context.letterSpacing=`${a}px`,this.context.textLetterSpacing=`${a}px`,h=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),a===0||h){s?this.context.strokeText(n,t,e):this.context.fillText(n,t,e);return}let c=t;const o=TextMetrics.graphemeSegmenter(n);let u=this.context.measureText(n).width,d=0;for(let m=0;m<o.length;++m){const p=o[m];s?this.context.strokeText(p,c,e):this.context.fillText(p,c,e);let g="";for(let _=m+1;_<o.length;++_)g+=o[_];d=this.context.measureText(g).width,c+=u-d+a,u=d}}updateTexture(){const n=this.canvas;if(this._style.trim){const a=trimCanvas(n);a.data&&(n.width=a.width,n.height=a.height,this.context.putImageData(a.data,0,0))}const t=this._texture,e=this._style,s=e.trim?0:e.padding,r=t.baseTexture;t.trim.width=t._frame.width=n.width/this._resolution,t.trim.height=t._frame.height=n.height/this._resolution,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),r.setRealSize(n.width,n.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(n){this._autoResolution&&this._resolution!==n.resolution&&(this._resolution=n.resolution,this.dirty=!0),this.updateText(!0),super._render(n)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(n,t){return this.updateText(!0),this._textureID===-1&&(n=!1),super.getBounds(n,t)}getLocalBounds(n){return this.updateText(!0),super.getLocalBounds.call(this,n)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(n,t,e){const s=n.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let r;const a=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,c=this.canvas.width/this._resolution-a-h*2,o=this.canvas.height/this._resolution-a-h*2,u=s.slice(),d=n.fillGradientStops.slice();if(!d.length){const m=u.length+1;for(let p=1;p<m;++p)d.push(p/m)}if(u.unshift(s[0]),d.unshift(0),u.push(s[s.length-1]),d.push(1),n.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(c/2,h,c/2,o+h);const m=e.fontProperties.fontSize+n.strokeThickness;for(let p=0;p<t.length;p++){const g=e.lineHeight*(p-1)+m,_=e.lineHeight*p;let y=_;p>0&&g>_&&(y=(_+g)/2);const v=_+m,U=e.lineHeight*(p+1);let w=v;p+1<t.length&&U<v&&(w=(v+U)/2);const k=(w-y)/o;for(let N=0;N<u.length;N++){let W=0;typeof d[N]=="number"?W=d[N]:W=N/u.length;let et=Math.min(1,Math.max(0,y/o+W*k));et=Number(et.toFixed(5)),r.addColorStop(et,u[N])}}}else{r=this.context.createLinearGradient(h,o/2,c+h,o/2);const m=u.length+1;let p=1;for(let g=0;g<u.length;g++){let _;typeof d[g]=="number"?_=d[g]:_=p/m,r.addColorStop(_,u[g]),p++}}return r}destroy(n){typeof n=="boolean"&&(n={children:n}),n=Object.assign({},defaultDestroyOptions,n),super.destroy(n),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(n){this.updateText(!0);const t=sign(this.scale.x)||1;this.scale.x=t*n/this._texture.orig.width,this._width=n}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(n){this.updateText(!0);const t=sign(this.scale.y)||1;this.scale.y=t*n/this._texture.orig.height,this._height=n}get style(){return this._style}set style(n){n=n||{},n instanceof TextStyle?this._style=n:this._style=new TextStyle(n),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(n){n=String(n??""),this._text!==n&&(this._text=n,this.dirty=!0)}get resolution(){return this._resolution}set resolution(n){this._autoResolution=!1,this._resolution!==n&&(this._resolution=n,this.dirty=!0)}};let Text=_Text;Text.defaultAutoResolution=!0;class CountLimiter{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function findMultipleBaseTextures(n,t){var s;let e=!1;if((s=n==null?void 0:n._textures)!=null&&s.length){for(let r=0;r<n._textures.length;r++)if(n._textures[r]instanceof Texture){const a=n._textures[r].baseTexture;t.includes(a)||(t.push(a),e=!0)}}return e}function findBaseTexture(n,t){if(n.baseTexture instanceof BaseTexture){const e=n.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function findTexture(n,t){if(n._texture&&n._texture instanceof Texture){const e=n._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function drawText(n,t){return t instanceof Text?(t.updateText(!0),!0):!1}function calculateTextStyle(n,t){if(t instanceof TextStyle){const e=t.toFontString();return TextMetrics.measureFont(e),!0}return!1}function findText(n,t){if(n instanceof Text){t.includes(n.style)||t.push(n.style),t.includes(n)||t.push(n);const e=n._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function findTextStyle(n,t){return n instanceof TextStyle?(t.includes(n)||t.push(n),!0):!1}const _BasePrepare=class{constructor(n){this.limiter=new CountLimiter(_BasePrepare.uploadsPerFrame),this.renderer=n,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(n){return new Promise(t=>{n&&this.add(n),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const n=this.queue[0];let t=!1;if(n&&!n._destroyed){for(let e=0,s=this.uploadHooks.length;e<s;e++)if(this.uploadHooks[e](this.uploadHookHelper,n)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;const n=this.completes.slice(0);this.completes.length=0;for(let t=0,e=n.length;t<e;t++)n[t]()}}registerFindHook(n){return n&&this.addHooks.push(n),this}registerUploadHook(n){return n&&this.uploadHooks.push(n),this}add(n){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](n,this.queue);t++);if(n instanceof Container)for(let t=n.children.length-1;t>=0;t--)this.add(n.children[t]);return this}destroy(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let BasePrepare=_BasePrepare;BasePrepare.uploadsPerFrame=4;Object.defineProperties(settings$1,{UPLOADS_PER_FRAME:{get(){return BasePrepare.uploadsPerFrame},set(n){deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),BasePrepare.uploadsPerFrame=n}}});function uploadBaseTextures(n,t){return t instanceof BaseTexture?(t._glTextures[n.CONTEXT_UID]||n.texture.bind(t),!0):!1}function uploadGraphics(n,t){if(!(t instanceof Graphics))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:s}=e;for(let r=0;r<s.length;r++){const{texture:a}=s[r].style;a&&uploadBaseTextures(n,a.baseTexture)}return e.batchable||n.geometry.bind(e,t._resolveDirectShader(n)),!0}function findGraphics(n,t){return n instanceof Graphics?(t.push(n),!0):!1}class Prepare extends BasePrepare{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}}Prepare.extension={name:"prepare",type:ExtensionType.RendererSystem};extensions$1.add(Prepare);new Point;var gl2FragmentSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,gl2VertexSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gl1FragmentSrc=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gl1VertexSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fragmentSimpleSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const tempMat=new Matrix;class TilingSpriteRenderer extends ObjectRenderer{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new QuadUv,this.state=State$1.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,fragmentSimpleSrc,e),this.shader=t.context.webGLVersion>1?Shader.from(gl2VertexSrc,gl2FragmentSrc,e):Shader.from(gl1VertexSrc,gl1FragmentSrc,e)}render(t){const e=this.renderer,s=this.quad;let r=s.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const a=t.uvRespectAnchor?t.anchor.x:0,h=t.uvRespectAnchor?t.anchor.y:0;r=s.uvs,r[0]=r[6]=-a,r[1]=r[3]=-h,r[2]=r[4]=1-a,r[5]=r[7]=1-h,s.invalidate();const c=t._texture,o=c.baseTexture,u=o.alphaMode>0,d=t.tileTransform.localTransform,m=t.uvMatrix;let p=o.isPowerOfTwo&&c.frame.width===o.width&&c.frame.height===o.height;p&&(o._glTextures[e.CONTEXT_UID]?p=o.wrapMode!==WRAP_MODES.CLAMP:o.wrapMode===WRAP_MODES.CLAMP&&(o.wrapMode=WRAP_MODES.REPEAT));const g=p?this.simpleShader:this.shader,_=c.width,y=c.height,v=t._width,U=t._height;tempMat.set(d.a*_/v,d.b*_/U,d.c*y/v,d.d*y/U,d.tx/v,d.ty/U),tempMat.invert(),p?tempMat.prepend(m.mapCoord):(g.uniforms.uMapCoord=m.mapCoord.toArray(!0),g.uniforms.uClampFrame=m.uClampFrame,g.uniforms.uClampOffset=m.uClampOffset),g.uniforms.uTransform=tempMat.toArray(!0),g.uniforms.uColor=premultiplyTintToRgba(t.tint,t.worldAlpha,g.uniforms.uColor,u),g.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),g.uniforms.uSampler=c,e.shader.bind(g),e.geometry.bind(s),this.state.blendMode=correctBlendMode(t.blendMode,u),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}TilingSpriteRenderer.extension={name:"tilingSprite",type:ExtensionType.RendererPlugin};extensions$1.add(TilingSpriteRenderer);const _Spritesheet=class{constructor(n,t,e=null){this.linkedSheets=[],this._texture=n instanceof Texture?n:null,this.baseTexture=n instanceof BaseTexture?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const s=this.baseTexture.resource;this.resolution=this._updateResolution(e||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(n=null){const{scale:t}=this.data.meta;let e=getResolutionOfUrl(n,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(n=>{this._callback=n,this._batchIndex=0,this._frameKeys.length<=_Spritesheet.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(n){let t=n;const e=_Spritesheet.BATCH_SIZE;for(;t-n<e&&t<this._frameKeys.length;){const s=this._frameKeys[t],r=this._frames[s],a=r.frame;if(a){let h=null,c=null;const o=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,u=new Rectangle(0,0,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution);r.rotated?h=new Rectangle(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):h=new Rectangle(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(c=new Rectangle(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new Texture(this.baseTexture,h,u,c,r.rotated?2:0,r.anchor),Texture.addToCache(this.textures[s],s)}t++}}_processAnimations(){const n=this.data.animations||{};for(const t in n){this.animations[t]=[];for(let e=0;e<n[t].length;e++){const s=n[t][e];this.animations[t].push(this.textures[s])}}}_parseComplete(){const n=this._callback;this._callback=null,this._batchIndex=0,n.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_Spritesheet.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_Spritesheet.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(n=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,n&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Spritesheet=_Spritesheet;Spritesheet.BATCH_SIZE=1e3;const validImages=["jpg","png","jpeg","avif","webp"];function getCacheableAssets(n,t,e){const s={};if(n.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[r]=t.textures[r]}),!e){const r=path$1.dirname(n[0]);t.linkedSheets.forEach((a,h)=>{const c=getCacheableAssets([`${r}/${t.data.meta.related_multi_packs[h]}`],a,!0);Object.assign(s,c)})}return s}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:n=>n instanceof Spritesheet,getCacheableAssets:(n,t)=>getCacheableAssets(n,t,!1)},resolver:{test:n=>{const e=n.split("?")[0].split("."),s=e.pop(),r=e.pop();return s==="json"&&validImages.includes(r)},parse:n=>{var e;const t=n.split(".");return{resolution:parseFloat(((e=settings$1.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:t[t.length-2],src:n}}},loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},async testParse(n,t){return path$1.extname(t.src).toLowerCase()===".json"&&!!n.frames},async parse(n,t,e){var u,d;let s=path$1.dirname(t.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let r=s+n.meta.image;r=copySearchParams(r,t.src);const h=(await e.load([r]))[r],c=new Spritesheet(h.baseTexture,n,t.src);await c.parse();const o=(u=n==null?void 0:n.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(o)){const m=[];for(const g of o){if(typeof g!="string")continue;let _=s+g;(d=t.data)!=null&&d.ignoreMultiPack||(_=copySearchParams(_,t.src),m.push(e.load({src:_,data:{ignoreMultiPack:!0}})))}const p=await Promise.all(m);c.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[c].concat(c.linkedSheets.filter(_=>_!==g))})}return c},unload(n){n.destroy(!0)}}};extensions$1.add(spritesheetAsset);class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class TextFormat{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const a in e){const h=e[a].match(/^[a-z]+/gm)[0],c=e[a].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(const u in c){const d=c[u].split("="),m=d[0],p=d[1].replace(/"/gm,""),g=parseFloat(p),_=isNaN(g)?p:g;o[m]=_}s[h].push(o)}const r=new BitmapFontData;return s.info.forEach(a=>r.info.push({face:a.face,size:parseInt(a.size,10)})),s.common.forEach(a=>r.common.push({lineHeight:parseInt(a.lineHeight,10)})),s.page.forEach(a=>r.page.push({id:parseInt(a.id,10),file:a.file})),s.char.forEach(a=>r.char.push({id:parseInt(a.id,10),page:parseInt(a.page,10),x:parseInt(a.x,10),y:parseInt(a.y,10),width:parseInt(a.width,10),height:parseInt(a.height,10),xoffset:parseInt(a.xoffset,10),yoffset:parseInt(a.yoffset,10),xadvance:parseInt(a.xadvance,10)})),s.kerning.forEach(a=>r.kerning.push({first:parseInt(a.first,10),second:parseInt(a.second,10),amount:parseInt(a.amount,10)})),s.distanceField.forEach(a=>r.distanceField.push({distanceRange:parseInt(a.distanceRange,10),fieldType:a.fieldType})),r}}class XMLFormat{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new BitmapFontData,s=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),a=t.getElementsByTagName("page"),h=t.getElementsByTagName("char"),c=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField");for(let u=0;u<s.length;u++)e.info.push({face:s[u].getAttribute("face"),size:parseInt(s[u].getAttribute("size"),10)});for(let u=0;u<r.length;u++)e.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(let u=0;u<a.length;u++)e.page.push({id:parseInt(a[u].getAttribute("id"),10)||0,file:a[u].getAttribute("file")});for(let u=0;u<h.length;u++){const d=h[u];e.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<c.length;u++)e.kerning.push({first:parseInt(c[u].getAttribute("first"),10),second:parseInt(c[u].getAttribute("second"),10),amount:parseInt(c[u].getAttribute("amount"),10)});for(let u=0;u<o.length;u++)e.distanceField.push({fieldType:o[u].getAttribute("fieldType"),distanceRange:parseInt(o[u].getAttribute("distanceRange"),10)});return e}}class XMLStringFormat{static test(t){return typeof t=="string"&&t.includes("<font>")?XMLFormat.test(settings$1.ADAPTER.parseXML(t)):!1}static parse(t){return XMLFormat.parse(settings$1.ADAPTER.parseXML(t))}}const formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(n){for(let t=0;t<formats.length;t++)if(formats[t].test(n))return formats[t];return null}function generateFillStyle(n,t,e,s,r,a){const h=e.fill;if(Array.isArray(h)){if(h.length===1)return h[0]}else return h;let c;const o=e.dropShadow?e.dropShadowDistance:0,u=e.padding||0,d=n.width/s-o-u*2,m=n.height/s-o-u*2,p=h.slice(),g=e.fillGradientStops.slice();if(!g.length){const _=p.length+1;for(let y=1;y<_;++y)g.push(y/_)}if(p.unshift(h[0]),g.unshift(0),p.push(h[h.length-1]),g.push(1),e.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){c=t.createLinearGradient(d/2,u,d/2,m+u);let _=0;const v=(a.fontProperties.fontSize+e.strokeThickness)/m;for(let U=0;U<r.length;U++){const w=a.lineHeight*U;for(let k=0;k<p.length;k++){let N=0;typeof g[k]=="number"?N=g[k]:N=k/p.length;const W=w/m+N*v;let et=Math.max(_,W);et=Math.min(et,1),c.addColorStop(et,p[k]),_=et}}}else{c=t.createLinearGradient(u,m/2,d+u,m/2);const _=p.length+1;let y=1;for(let v=0;v<p.length;v++){let U;typeof g[v]=="number"?U=g[v]:U=y/_,c.addColorStop(U,p[v]),y++}}return c}function drawGlyph(n,t,e,s,r,a,h){const c=e.text,o=e.fontProperties;t.translate(s,r),t.scale(a,a);const u=h.strokeThickness/2,d=-(h.strokeThickness/2);if(t.font=h.toFontString(),t.lineWidth=h.strokeThickness,t.textBaseline=h.textBaseline,t.lineJoin=h.lineJoin,t.miterLimit=h.miterLimit,t.fillStyle=generateFillStyle(n,t,h,a,[c],e),t.strokeStyle=h.stroke,h.dropShadow){const m=h.dropShadowColor,p=hex2rgb(typeof m=="number"?m:string2hex(m)),g=h.dropShadowBlur*a,_=h.dropShadowDistance*a;t.shadowColor=`rgba(${p[0]*255},${p[1]*255},${p[2]*255},${h.dropShadowAlpha})`,t.shadowBlur=g,t.shadowOffsetX=Math.cos(h.dropShadowAngle)*_,t.shadowOffsetY=Math.sin(h.dropShadowAngle)*_}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;h.stroke&&h.strokeThickness&&t.strokeText(c,u,d+e.lineHeight-o.descent),h.fill&&t.fillText(c,u,d+e.lineHeight-o.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function extractCharCode(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}function splitTextToCharacters(n){return Array.from?Array.from(n):n.split("")}function resolveCharacters(n){typeof n=="string"&&(n=[n]);const t=[];for(let e=0,s=n.length;e<s;e++){const r=n[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const a=r[0].charCodeAt(0),h=r[1].charCodeAt(0);if(h<a)throw new Error("[BitmapFont]: Invalid character range.");for(let c=a,o=h;c<=o;c++)t.push(String.fromCharCode(c))}else t.push(...splitTextToCharacters(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const _BitmapFont=class{constructor(n,t,e){var u;const[s]=n.info,[r]=n.common,[a]=n.page,[h]=n.distanceField,c=getResolutionOfUrl(a.file),o={};this._ownsTextures=e,this.font=s.face,this.size=s.size,this.lineHeight=r.lineHeight/c,this.chars={},this.pageTextures=o;for(let d=0;d<n.page.length;d++){const{id:m,file:p}=n.page[d];o[m]=t instanceof Array?t[d]:t[p],h!=null&&h.fieldType&&h.fieldType!=="none"&&(o[m].baseTexture.alphaMode=ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,o[m].baseTexture.mipmap=MIPMAP_MODES.OFF)}for(let d=0;d<n.char.length;d++){const{id:m,page:p}=n.char[d];let{x:g,y:_,width:y,height:v,xoffset:U,yoffset:w,xadvance:k}=n.char[d];g/=c,_/=c,y/=c,v/=c,U/=c,w/=c,k/=c;const N=new Rectangle(g+o[p].frame.x/c,_+o[p].frame.y/c,y,v);this.chars[m]={xOffset:U,yOffset:w,xAdvance:k,kerning:{},texture:new Texture(o[p].baseTexture,N),page:p}}for(let d=0;d<n.kerning.length;d++){let{first:m,second:p,amount:g}=n.kerning[d];m/=c,p/=c,g/=c,this.chars[p]&&(this.chars[p].kerning[m]=g)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((u=h==null?void 0:h.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const n in this.chars)this.chars[n].texture.destroy(),this.chars[n].texture=null;for(const n in this.pageTextures)this._ownsTextures&&this.pageTextures[n].destroy(!0),this.pageTextures[n]=null;this.chars=null,this.pageTextures=null}static install(n,t,e){let s;if(n instanceof BitmapFontData)s=n;else{const a=autoDetectFormat(n);if(!a)throw new Error("Unrecognized data format for font.");s=a.parse(n)}t instanceof Texture&&(t=[t]);const r=new _BitmapFont(s,t,e);return _BitmapFont.available[r.font]=r,r}static uninstall(n){const t=_BitmapFont.available[n];if(!t)throw new Error(`No font found named '${n}'`);t.destroy(),delete _BitmapFont.available[n]}static from(n,t,e){if(!n)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:r,resolution:a,textureWidth:h,textureHeight:c,...o}=Object.assign({},_BitmapFont.defaultOptions,e),u=resolveCharacters(s),d=t instanceof TextStyle?t:new TextStyle(t),m=h,p=new BitmapFontData;p.info[0]={face:d.fontFamily,size:d.fontSize},p.common[0]={lineHeight:d.fontSize};let g=0,_=0,y,v,U,w=0;const k=[];for(let W=0;W<u.length;W++){y||(y=settings$1.ADAPTER.createCanvas(),y.width=h,y.height=c,v=y.getContext("2d"),U=new BaseTexture(y,{resolution:a,...o}),k.push(new Texture(U)),p.page.push({id:k.length-1,file:""}));const et=u[W],it=TextMetrics.measureText(et,d,!1,y),ft=it.width,mt=Math.ceil(it.height),xt=Math.ceil((d.fontStyle==="italic"?2:1)*ft);if(_>=c-mt*a){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${et}')`);--W,y=null,v=null,U=null,_=0,g=0,w=0;continue}if(w=Math.max(mt+it.fontProperties.descent,w),xt*a+g>=m){if(g===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${et}')`);--W,_+=w*a,_=Math.ceil(_),g=0,w=0;continue}drawGlyph(y,v,it,g,_,a,d);const yt=extractCharCode(it.text);p.char.push({id:yt,page:k.length-1,x:g/a,y:_/a,width:xt,height:mt,xoffset:0,yoffset:0,xadvance:ft-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),g+=(xt+2*r)*a,g=Math.ceil(g)}for(let W=0,et=u.length;W<et;W++){const it=u[W];for(let ft=0;ft<et;ft++){const mt=u[ft],xt=v.measureText(it).width,yt=v.measureText(mt).width,St=v.measureText(it+mt).width-(xt+yt);St&&p.kerning.push({first:extractCharCode(it),second:extractCharCode(mt),amount:St})}}const N=new _BitmapFont(p,k,!0);return _BitmapFont.available[n]!==void 0&&_BitmapFont.uninstall(n),_BitmapFont.available[n]=N,N}};let BitmapFont=_BitmapFont;BitmapFont.ALPHA=[["a","z"],["A","Z"]," "];BitmapFont.NUMERIC=[["0","9"]];BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];BitmapFont.ASCII=[[" ","~"]];BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC};BitmapFont.available={};var msdfFrag=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,msdfVert=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=class extends Container{constructor(n,t={}){super(),this._tint=16777215;const{align:e,tint:s,maxWidth:r,letterSpacing:a,fontName:h,fontSize:c}=Object.assign({},_BitmapText.styleDefaults,t);if(!BitmapFont.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tint=s,this._font=void 0,this._fontName=h,this._fontSize=c,this.text=n,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new ObservablePoint(()=>{this.dirty=!0},this,0,0),this._roundPixels=settings$1.ROUND_PIXELS,this.dirty=!0,this._resolution=settings$1.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var xt;const n=BitmapFont.available[this._fontName],t=this.fontSize,e=t/n.size,s=new Point,r=[],a=[],h=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",o=splitTextToCharacters(c),u=this._maxWidth*n.size/t,d=n.distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;let m=null,p=0,g=0,_=0,y=-1,v=0,U=0,w=0,k=0;for(let yt=0;yt<o.length;yt++){const vt=o[yt],St=extractCharCode(vt);if(/(?:\s)/.test(vt)&&(y=yt,v=p,k++),vt==="\r"||vt===`
`){a.push(p),h.push(-1),g=Math.max(g,p),++_,++U,s.x=0,s.y+=n.lineHeight,m=null,k=0;continue}const wt=n.chars[St];if(!wt)continue;m&&wt.kerning[m]&&(s.x+=wt.kerning[m]);const Ct=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point};Ct.texture=wt.texture,Ct.line=_,Ct.charCode=St,Ct.position.x=Math.round(s.x+wt.xOffset+this._letterSpacing/2),Ct.position.y=Math.round(s.y+wt.yOffset),Ct.prevSpaces=k,r.push(Ct),p=Ct.position.x+Math.max(wt.xAdvance-wt.xOffset,wt.texture.orig.width),s.x+=wt.xAdvance+this._letterSpacing,w=Math.max(w,wt.yOffset+wt.texture.height),m=St,y!==-1&&u>0&&s.x>u&&(++U,removeItems(r,1+y-U,1+yt-y),yt=y,y=-1,a.push(v),h.push(r.length>0?r[r.length-1].prevSpaces:0),g=Math.max(g,v),_++,s.x=0,s.y+=n.lineHeight,m=null,k=0)}const N=o[o.length-1];N!=="\r"&&N!==`
`&&(/(?:\s)/.test(N)&&(p=v),a.push(p),g=Math.max(g,p),h.push(-1));const W=[];for(let yt=0;yt<=_;yt++){let vt=0;this._align==="right"?vt=g-a[yt]:this._align==="center"?vt=(g-a[yt])/2:this._align==="justify"&&(vt=h[yt]<0?0:(g-a[yt])/h[yt]),W.push(vt)}const et=r.length,it={},ft=[],mt=this._activePagesMeshData;d.push(...mt);for(let yt=0;yt<et;yt++){const vt=r[yt].texture,St=vt.baseTexture.uid;if(!it[St]){let wt=d.pop();if(!wt){const It=new MeshGeometry;let Pt,Xt;n.distanceFieldType==="none"?(Pt=new MeshMaterial(Texture.EMPTY),Xt=BLEND_MODES.NORMAL):(Pt=new MeshMaterial(Texture.EMPTY,{program:Program.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),Xt=BLEND_MODES.NORMAL_NPM);const Ut=new Mesh(It,Pt);Ut.blendMode=Xt,wt={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ut,vertices:null,uvs:null,indices:null}}wt.index=0,wt.indexCount=0,wt.vertexCount=0,wt.uvsCount=0,wt.total=0;const{_textureCache:Ct}=this;Ct[St]=Ct[St]||new Texture(vt.baseTexture),wt.mesh.texture=Ct[St],wt.mesh.tint=this._tint,ft.push(wt),it[St]=wt}it[St].total++}for(let yt=0;yt<mt.length;yt++)ft.includes(mt[yt])||this.removeChild(mt[yt].mesh);for(let yt=0;yt<ft.length;yt++)ft[yt].mesh.parent!==this&&this.addChild(ft[yt].mesh);this._activePagesMeshData=ft;for(const yt in it){const vt=it[yt],St=vt.total;if(!(((xt=vt.indices)==null?void 0:xt.length)>6*St)||vt.vertices.length<Mesh.BATCHABLE_SIZE*2)vt.vertices=new Float32Array(4*2*St),vt.uvs=new Float32Array(4*2*St),vt.indices=new Uint16Array(6*St);else{const wt=vt.total,Ct=vt.vertices;for(let It=wt*4*2;It<Ct.length;It++)Ct[It]=0}vt.mesh.size=6*St}for(let yt=0;yt<et;yt++){const vt=r[yt];let St=vt.position.x+W[vt.line]*(this._align==="justify"?vt.prevSpaces:1);this._roundPixels&&(St=Math.round(St));const wt=St*e,Ct=vt.position.y*e,It=vt.texture,Pt=it[It.baseTexture.uid],Xt=It.frame,Ut=It._uvs,Et=Pt.index++;Pt.indices[Et*6+0]=0+Et*4,Pt.indices[Et*6+1]=1+Et*4,Pt.indices[Et*6+2]=2+Et*4,Pt.indices[Et*6+3]=0+Et*4,Pt.indices[Et*6+4]=2+Et*4,Pt.indices[Et*6+5]=3+Et*4,Pt.vertices[Et*8+0]=wt,Pt.vertices[Et*8+1]=Ct,Pt.vertices[Et*8+2]=wt+Xt.width*e,Pt.vertices[Et*8+3]=Ct,Pt.vertices[Et*8+4]=wt+Xt.width*e,Pt.vertices[Et*8+5]=Ct+Xt.height*e,Pt.vertices[Et*8+6]=wt,Pt.vertices[Et*8+7]=Ct+Xt.height*e,Pt.uvs[Et*8+0]=Ut.x0,Pt.uvs[Et*8+1]=Ut.y0,Pt.uvs[Et*8+2]=Ut.x1,Pt.uvs[Et*8+3]=Ut.y1,Pt.uvs[Et*8+4]=Ut.x2,Pt.uvs[Et*8+5]=Ut.y2,Pt.uvs[Et*8+6]=Ut.x3,Pt.uvs[Et*8+7]=Ut.y3}this._textWidth=g*e,this._textHeight=(s.y+n.lineHeight)*e;for(const yt in it){const vt=it[yt];if(this.anchor.x!==0||this.anchor.y!==0){let It=0;const Pt=this._textWidth*this.anchor.x,Xt=this._textHeight*this.anchor.y;for(let Ut=0;Ut<vt.total;Ut++)vt.vertices[It++]-=Pt,vt.vertices[It++]-=Xt,vt.vertices[It++]-=Pt,vt.vertices[It++]-=Xt,vt.vertices[It++]-=Pt,vt.vertices[It++]-=Xt,vt.vertices[It++]-=Pt,vt.vertices[It++]-=Xt}this._maxLineHeight=w*e;const St=vt.mesh.geometry.getBuffer("aVertexPosition"),wt=vt.mesh.geometry.getBuffer("aTextureCoord"),Ct=vt.mesh.geometry.getIndex();St.data=vt.vertices,wt.data=vt.uvs,Ct.data=vt.indices,St.update(),wt.update(),Ct.update()}for(let yt=0;yt<r.length;yt++)charRenderDataPool.push(r[yt]);this._font=n,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(n){this._autoResolution&&this._resolution!==n.resolution&&(this._resolution=n.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:s}=BitmapFont.available[this._fontName];if(e!=="none"){const{a:r,b:a,c:h,d:c}=this.worldTransform,o=Math.sqrt(r*r+a*a),u=Math.sqrt(h*h+c*c),d=(Math.abs(o)+Math.abs(u))/2,m=this.fontSize/s,p=n._view.resolution;for(const g of this._activePagesMeshData)g.mesh.shader.uniforms.uFWidth=d*t*m*p}super._render(n)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const n=BitmapFont.available[this._fontName];if(!n)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==n&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(n){if(this._tint!==n){this._tint=n;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=n}}get align(){return this._align}set align(n){this._align!==n&&(this._align=n,this.dirty=!0)}get fontName(){return this._fontName}set fontName(n){if(!BitmapFont.available[n])throw new Error(`Missing BitmapFont "${n}"`);this._fontName!==n&&(this._fontName=n,this.dirty=!0)}get fontSize(){return this._fontSize??BitmapFont.available[this._fontName].size}set fontSize(n){this._fontSize!==n&&(this._fontSize=n,this.dirty=!0)}get anchor(){return this._anchor}set anchor(n){typeof n=="number"?this._anchor.set(n):this._anchor.copyFrom(n)}get text(){return this._text}set text(n){n=String(n??""),this._text!==n&&(this._text=n,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(n){this._maxWidth!==n&&(this._maxWidth=n,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(n){n!==this._roundPixels&&(this._roundPixels=n,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(n){this._autoResolution=!1,this._resolution!==n&&(this._resolution=n,this.dirty=!0)}destroy(n){const{_textureCache:t}=this,s=BitmapFont.available[this._fontName].distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;s.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],s.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=Texture.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._textureCache=null,super.destroy(n)}};let BitmapText=_BitmapText;BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const validExtensions=[".xml",".fnt"],loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(n){return validExtensions.includes(path$1.extname(n).toLowerCase())},async testParse(n){return TextFormat.test(n)||XMLStringFormat.test(n)},async parse(n,t,e){const s=TextFormat.test(n)?TextFormat.parse(n):XMLStringFormat.parse(n),{src:r}=t,{page:a}=s,h=[];for(let u=0;u<a.length;++u){const d=a[u].file;let m=path$1.join(path$1.dirname(r),d);m=copySearchParams(m,r),h.push(m)}const c=await e.load(h),o=h.map(u=>c[u]);return BitmapFont.install(s,o,!0)},async load(n,t){return(await settings$1.ADAPTER.fetch(n)).text()},unload(n){n.destroy()}};extensions$1.add(loadBitmapFont);let assetsManifest={bundles:[]};const loadedBundles=[];function checkBundleExists(n){return!!assetsManifest.bundles.find(t=>t.name===n)}async function loadBundles(n){typeof n=="string"&&(n=[n]);for(const e of n)if(!checkBundleExists(e))throw new Error(`[Assets] Invalid bundle: ${e}`);const t=n.filter(e=>!loadedBundles.includes(e));t.length&&(console.log("[Assets] Load:",t.join(", ")),await Assets.loadBundle(t),loadedBundles.push(...t))}function areBundlesLoaded(n){for(const t of n)if(!loadedBundles.includes(t))return!1;return!0}async function fetchAssetsManifest(n){const e=await(await fetch(n)).json();if(!e.bundles)throw new Error("[Assets] Invalid assets manifest");return e}async function initAssets(){assetsManifest=await fetchAssetsManifest("assets/assets-manifest.json"),await Assets.init({manifest:assetsManifest,basePath:"assets"}),await loadBundles(["preload","default"]);const n=assetsManifest.bundles.map(t=>t.name);Assets.backgroundLoadBundle(n)}class Pool{constructor(t){gt(this,"ctor");gt(this,"list",[]);this.ctor=t}get(){return this.list.pop()??new this.ctor}giveBack(t){this.list.includes(t)||this.list.push(t)}}class MultiPool{constructor(){gt(this,"map",new Map)}get(t){let e=this.map.get(t);return e||(e=new Pool(t),this.map.set(t,e)),e.get()}giveBack(t){const e=this.map.get(t.constructor);e&&e.giveBack(t)}}const pool=new MultiPool;class Navigation{constructor(){gt(this,"container",new Container);gt(this,"width",0);gt(this,"height",0);gt(this,"background");gt(this,"currentScreen");gt(this,"currentPopup")}setBackground(t){this.background=new t,this.addAndShowScreen(this.background)}async addAndShowScreen(t){this.container.parent||app.stage.addChild(this.container),this.container.addChild(t),t.prepare&&t.prepare(),t.resize&&t.resize(this.width,this.height),t.update&&app.ticker.add(t.update,t),t.show&&(t.interactiveChildren=!1,await t.show(),t.interactiveChildren=!0)}async hideAndRemoveScreen(t){t.interactiveChildren=!1,t.hide&&await t.hide(),t.update&&app.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t),t.reset&&t.reset()}async showScreen(t){this.currentScreen&&(this.currentScreen.interactiveChildren=!1),t.assetBundles&&!areBundlesLoaded(t.assetBundles)&&await loadBundles(t.assetBundles),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=pool.get(t),await this.addAndShowScreen(this.currentScreen)}resize(t,e){var s,r,a,h,c,o;this.width=t,this.height=e,(r=(s=this.currentScreen)==null?void 0:s.resize)==null||r.call(s,t,e),(h=(a=this.currentPopup)==null?void 0:a.resize)==null||h.call(a,t,e),(o=(c=this.background)==null?void 0:c.resize)==null||o.call(c,t,e)}async presentPopup(t){var e,s;this.currentScreen&&await((s=(e=this.currentScreen).pause)==null?void 0:s.call(e)),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),this.currentPopup=new t,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var e,s;if(!this.currentPopup)return;const t=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(t),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(s=(e=this.currentScreen).resume)==null||s.call(e))}blur(){var t,e,s,r,a,h;(e=(t=this.currentScreen)==null?void 0:t.blur)==null||e.call(t),(r=(s=this.currentPopup)==null?void 0:s.blur)==null||r.call(s),(h=(a=this.background)==null?void 0:a.blur)==null||h.call(a)}focus(){var t,e,s,r,a,h;(e=(t=this.currentScreen)==null?void 0:t.focus)==null||e.call(t),(r=(s=this.currentPopup)==null?void 0:s.focus)==null||r.call(s),(h=(a=this.background)==null?void 0:a.focus)==null||h.call(a)}}const navigation=new Navigation;function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inheritsLoose(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.__proto__=t}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults={duration:.5,overwrite:!1,delay:0},_suppressOverwrites,_reverting$1,_context,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString=function n(t){return typeof t=="string"},_isFunction=function n(t){return typeof t=="function"},_isNumber=function n(t){return typeof t=="number"},_isUndefined=function n(t){return typeof t>"u"},_isObject=function n(t){return typeof t=="object"},_isNotFalse=function n(t){return t!==!1},_windowExists$1=function n(){return typeof window<"u"},_isFuncOrString=function n(t){return _isFunction(t)||_isString(t)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$1,_coreInitted,_doc$1,_globals={},_installScope={},_coreReady,_install=function n(t){return(_installScope=_merge(t,_globals))&&gsap},_missingPlugin=function n(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},_warn=function n(t,e){return!e&&console.warn(t)},_addGlobal=function n(t,e){return t&&(_globals[t]=e)&&_installScope&&(_installScope[t]=e)||_globals},_emptyFunc=function n(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function n(t){var e=t[0],s,r;if(_isObject(e)||_isFunction(e)||(t=[t]),!(s=(e._gsap||{}).harness)){for(r=_harnessPlugins.length;r--&&!_harnessPlugins[r].targetTest(e););s=_harnessPlugins[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new GSCache(t[r],s)))||t.splice(r,1);return t},_getCache=function n(t){return t._gsap||_harness(toArray(t))[0]._gsap},_getProperty=function n(t,e,s){return(s=t[e])&&_isFunction(s)?t[e]():_isUndefined(s)&&t.getAttribute&&t.getAttribute(e)||s},_forEachName=function n(t,e){return(t=t.split(",")).forEach(e)||t},_round=function n(t){return Math.round(t*1e5)/1e5||0},_roundPrecise=function n(t){return Math.round(t*1e7)/1e7||0},_parseRelative=function n(t,e){var s=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),s==="+"?t+r:s==="-"?t-r:s==="*"?t*r:t/r},_arrayContainsAny=function n(t,e){for(var s=e.length,r=0;t.indexOf(e[r])<0&&++r<s;);return r<s},_lazyRender=function n(){var t=_lazyTweens.length,e=_lazyTweens.slice(0),s,r;for(_lazyLookup={},_lazyTweens.length=0,s=0;s<t;s++)r=e[s],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},_lazySafeRender=function n(t,e,s,r){_lazyTweens.length&&!_reverting$1&&_lazyRender(),t.render(e,s,r||_reverting$1&&e<0&&(t._initted||t._startAt)),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function n(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(_delimitedValueExp).length<2?e:_isString(t)?t.trim():t},_passThrough=function n(t){return t},_setDefaults=function n(t,e){for(var s in e)s in t||(t[s]=e[s]);return t},_setKeyframeDefaults=function n(t){return function(e,s){for(var r in s)r in e||r==="duration"&&t||r==="ease"||(e[r]=s[r])}},_merge=function n(t,e){for(var s in e)t[s]=e[s];return t},_mergeDeep=function n(t,e){for(var s in e)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=_isObject(e[s])?n(t[s]||(t[s]={}),e[s]):e[s]);return t},_copyExcluding=function n(t,e){var s={},r;for(r in t)r in e||(s[r]=t[r]);return s},_inheritDefaults=function n(t){var e=t.parent||_globalTimeline,s=t.keyframes?_setKeyframeDefaults(_isArray(t.keyframes)):_setDefaults;if(_isNotFalse(t.inherit))for(;e;)s(t,e.vars.defaults),e=e.parent||e._dp;return t},_arraysMatch=function n(t,e){for(var s=t.length,r=s===e.length;r&&s--&&t[s]===e[s];);return s<0},_addLinkedListItem=function n(t,e,s,r,a){s===void 0&&(s="_first"),r===void 0&&(r="_last");var h=t[r],c;if(a)for(c=e[a];h&&h[a]>c;)h=h._prev;return h?(e._next=h._next,h._next=e):(e._next=t[s],t[s]=e),e._next?e._next._prev=e:t[r]=e,e._prev=h,e.parent=e._dp=t,e},_removeLinkedListItem=function n(t,e,s,r){s===void 0&&(s="_first"),r===void 0&&(r="_last");var a=e._prev,h=e._next;a?a._next=h:t[s]===e&&(t[s]=h),h?h._prev=a:t[r]===e&&(t[r]=a),e._next=e._prev=e.parent=null},_removeFromParent=function n(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},_uncache=function n(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},_recacheAncestors=function n(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},_rewindStartAt=function n(t,e,s,r){return t._startAt&&(_reverting$1?t._startAt.revert(_revertConfigNoKill):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},_hasNoPausedAncestors=function n(t){return!t||t._ts&&n(t.parent)},_elapsedCycleDuration=function n(t){return t._repeat?_animationCycle(t._tTime,t=t.duration()+t._rDelay)*t:0},_animationCycle=function n(t,e){var s=Math.floor(t/=e);return t&&s===t?s-1:s},_parentToChildTotalTime=function n(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},_setEnd=function n(t){return t._end=_roundPrecise(t._start+(t._tDur/Math.abs(t._ts||t._rts||_tinyNum)||0))},_alignPlayhead=function n(t,e){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=_roundPrecise(s._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),_setEnd(t),s._dirty||_uncache(s,t)),t},_postAddChecks=function n(t,e){var s;if((e._time||e._initted&&!e._dur)&&(s=_parentToChildTotalTime(t.rawTime(),e),(!e._dur||_clamp(0,e.totalDuration(),s)-e._tTime>_tinyNum)&&e.render(s,!0)),_uncache(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-_tinyNum}},_addToTimeline=function n(t,e,s,r){return e.parent&&_removeFromParent(e),e._start=_roundPrecise((_isNumber(s)?s:s||t!==_globalTimeline?_parsePosition(t,s,e):t._time)+e._delay),e._end=_roundPrecise(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),_addLinkedListItem(t,e,"_first","_last",t._sort?"_start":0),_isFromOrFromStart(e)||(t._recent=e),r||_postAddChecks(t,e),t._ts<0&&_alignPlayhead(t,t._tTime),t},_scrollTrigger=function n(t,e){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",e))&&_globals.ScrollTrigger.create(e,t)},_attemptInitTween=function n(t,e,s,r,a){if(_initTween(t,e,a),!t._initted)return 1;if(!s&&t._pt&&!_reverting$1&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(t),t._lazy=[a,r],1},_parentPlayheadIsBeforeStart=function n(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||n(e))},_isFromOrFromStart=function n(t){var e=t.data;return e==="isFromStart"||e==="isStart"},_renderZeroDurationTween=function n(t,e,s,r){var a=t.ratio,h=e<0||!e&&(!t._start&&_parentPlayheadIsBeforeStart(t)&&!(!t._initted&&_isFromOrFromStart(t))||(t._ts<0||t._dp._ts<0)&&!_isFromOrFromStart(t))?0:1,c=t._rDelay,o=0,u,d,m;if(c&&t._repeat&&(o=_clamp(0,t._tDur,e),d=_animationCycle(o,c),t._yoyo&&d&1&&(h=1-h),d!==_animationCycle(t._tTime,c)&&(a=1-h,t.vars.repeatRefresh&&t._initted&&t.invalidate())),h!==a||_reverting$1||r||t._zTime===_tinyNum||!e&&t._zTime){if(!t._initted&&_attemptInitTween(t,e,r,s,o))return;for(m=t._zTime,t._zTime=e||(s?_tinyNum:0),s||(s=e&&!m),t.ratio=h,t._from&&(h=1-h),t._time=0,t._tTime=o,u=t._pt;u;)u.r(h,u.d),u=u._next;e<0&&_rewindStartAt(t,e,s,!0),t._onUpdate&&!s&&_callback(t,"onUpdate"),o&&t._repeat&&!s&&t.parent&&_callback(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===h&&(h&&_removeFromParent(t,1),!s&&!_reverting$1&&(_callback(t,h?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},_findNextPauseTween=function n(t,e,s){var r;if(s>e)for(r=t._first;r&&r._start<=s;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=s;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},_setDuration=function n(t,e,s,r){var a=t._repeat,h=_roundPrecise(e)||0,c=t._tTime/t._tDur;return c&&!r&&(t._time*=h/t._dur),t._dur=h,t._tDur=a?a<0?1e10:_roundPrecise(h*(a+1)+t._rDelay*a):h,c>0&&!r&&_alignPlayhead(t,t._tTime=t._tDur*c),t.parent&&_setEnd(t),s||_uncache(t.parent,t),t},_onUpdateTotalDuration=function n(t){return t instanceof Timeline?_uncache(t):_setDuration(t,t._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition=function n(t,e,s){var r=t.labels,a=t._recent||_zeroPosition,h=t.duration()>=_bigNum$1?a.endTime(!1):t._dur,c,o,u;return _isString(e)&&(isNaN(e)||e in r)?(o=e.charAt(0),u=e.substr(-1)==="%",c=e.indexOf("="),o==="<"||o===">"?(c>=0&&(e=e.replace(/=/,"")),(o==="<"?a._start:a.endTime(a._repeat>=0))+(parseFloat(e.substr(1))||0)*(u?(c<0?a:s).totalDuration()/100:1)):c<0?(e in r||(r[e]=h),r[e]):(o=parseFloat(e.charAt(c-1)+e.substr(c+1)),u&&s&&(o=o/100*(_isArray(s)?s[0]:s).totalDuration()),c>1?n(t,e.substr(0,c-1),s)+o:h+o)):e==null?h:+e},_createTweenType=function n(t,e,s){var r=_isNumber(e[1]),a=(r?2:1)+(t<2?0:1),h=e[a],c,o;if(r&&(h.duration=e[1]),h.parent=s,t){for(c=h,o=s;o&&!("immediateRender"in c);)c=o.vars.defaults||{},o=_isNotFalse(o.vars.inherit)&&o.parent;h.immediateRender=_isNotFalse(c.immediateRender),t<2?h.runBackwards=1:h.startAt=e[a-1]}return new Tween$1(e[0],h,e[a+1])},_conditionalReturn=function n(t,e){return t||t===0?e(t):e},_clamp=function n(t,e,s){return s<t?t:s>e?e:s},getUnit=function n(t,e){return!_isString(t)||!(e=_unitExp.exec(t))?"":e[1]},clamp=function n(t,e,s){return _conditionalReturn(s,function(r){return _clamp(t,e,r)})},_slice=[].slice,_isArrayLike=function n(t,e){return t&&_isObject(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&_isObject(t[0]))&&!t.nodeType&&t!==_win$1},_flatten=function n(t,e,s){return s===void 0&&(s=[]),t.forEach(function(r){var a;return _isString(r)&&!e||_isArrayLike(r,1)?(a=s).push.apply(a,toArray(r)):s.push(r)})||s},toArray=function n(t,e,s){return _context&&!e&&_context.selector?_context.selector(t):_isString(t)&&!s&&(_coreInitted||!_wake())?_slice.call((e||_doc$1).querySelectorAll(t),0):_isArray(t)?_flatten(t,s):_isArrayLike(t)?_slice.call(t,0):t?[t]:[]},selector=function n(t){return t=toArray(t)[0]||_warn("Invalid scope")||{},function(e){var s=t.current||t.nativeElement||t;return toArray(e,s.querySelectorAll?s:s===t?_warn("Invalid scope")||_doc$1.createElement("div"):t)}},shuffle=function n(t){return t.sort(function(){return .5-Math.random()})},distribute=function n(t){if(_isFunction(t))return t;var e=_isObject(t)?t:{each:t},s=_parseEase(e.ease),r=e.from||0,a=parseFloat(e.base)||0,h={},c=r>0&&r<1,o=isNaN(r)||c,u=e.axis,d=r,m=r;return _isString(r)?d=m={center:.5,edges:.5,end:1}[r]||0:!c&&o&&(d=r[0],m=r[1]),function(p,g,_){var y=(_||e).length,v=h[y],U,w,k,N,W,et,it,ft,mt;if(!v){if(mt=e.grid==="auto"?0:(e.grid||[1,_bigNum$1])[1],!mt){for(it=-_bigNum$1;it<(it=_[mt++].getBoundingClientRect().left)&&mt<y;);mt--}for(v=h[y]=[],U=o?Math.min(mt,y)*d-.5:r%mt,w=mt===_bigNum$1?0:o?y*m/mt-.5:r/mt|0,it=0,ft=_bigNum$1,et=0;et<y;et++)k=et%mt-U,N=w-(et/mt|0),v[et]=W=u?Math.abs(u==="y"?N:k):_sqrt(k*k+N*N),W>it&&(it=W),W<ft&&(ft=W);r==="random"&&shuffle(v),v.max=it-ft,v.min=ft,v.v=y=(parseFloat(e.amount)||parseFloat(e.each)*(mt>y?y-1:u?u==="y"?y/mt:mt:Math.max(mt,y/mt))||0)*(r==="edges"?-1:1),v.b=y<0?a-y:a,v.u=getUnit(e.amount||e.each)||0,s=s&&y<0?_invertEase(s):s}return y=(v[p]-v.min)/v.max||0,_roundPrecise(v.b+(s?s(y):y)*v.v)+v.u}},_roundModifier=function n(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var r=_roundPrecise(Math.round(parseFloat(s)/t)*t*e);return(r-r%1)/e+(_isNumber(s)?0:getUnit(s))}},snap=function n(t,e){var s=_isArray(t),r,a;return!s&&_isObject(t)&&(r=s=t.radius||_bigNum$1,t.values?(t=toArray(t.values),(a=!_isNumber(t[0]))&&(r*=r)):t=_roundModifier(t.increment)),_conditionalReturn(e,s?_isFunction(t)?function(h){return a=t(h),Math.abs(a-h)<=r?a:h}:function(h){for(var c=parseFloat(a?h.x:h),o=parseFloat(a?h.y:0),u=_bigNum$1,d=0,m=t.length,p,g;m--;)a?(p=t[m].x-c,g=t[m].y-o,p=p*p+g*g):p=Math.abs(t[m]-c),p<u&&(u=p,d=m);return d=!r||u<=r?t[d]:h,a||d===h||_isNumber(h)?d:d+getUnit(h)}:_roundModifier(t))},random=function n(t,e,s,r){return _conditionalReturn(_isArray(t)?!e:s===!0?!!(s=0):!r,function(){return _isArray(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(r=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(e-t+s*.99))/s)*s*r)/r})},pipe=function n(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return function(r){return e.reduce(function(a,h){return h(a)},r)}},unitize=function n(t,e){return function(s){return t(parseFloat(s))+(e||getUnit(s))}},normalize=function n(t,e,s){return mapRange(t,e,0,1,s)},_wrapArray=function n(t,e,s){return _conditionalReturn(s,function(r){return t[~~e(r)]})},wrap=function n(t,e,s){var r=e-t;return _isArray(t)?_wrapArray(t,n(0,t.length),e):_conditionalReturn(s,function(a){return(r+(a-t)%r)%r+t})},wrapYoyo=function n(t,e,s){var r=e-t,a=r*2;return _isArray(t)?_wrapArray(t,n(0,t.length-1),e):_conditionalReturn(s,function(h){return h=(a+(h-t)%a)%a||0,t+(h>r?a-h:h)})},_replaceRandom=function n(t){for(var e=0,s="",r,a,h,c;~(r=t.indexOf("random(",e));)h=t.indexOf(")",r),c=t.charAt(r+7)==="[",a=t.substr(r+7,h-r-7).match(c?_delimitedValueExp:_strictNumExp),s+=t.substr(e,r-e)+random(c?a:+a[0],c?0:+a[1],+a[2]||1e-5),e=h+1;return s+t.substr(e,t.length-e)},mapRange=function n(t,e,s,r,a){var h=e-t,c=r-s;return _conditionalReturn(a,function(o){return s+((o-t)/h*c||0)})},interpolate=function n(t,e,s,r){var a=isNaN(t+e)?0:function(g){return(1-g)*t+g*e};if(!a){var h=_isString(t),c={},o,u,d,m,p;if(s===!0&&(r=1)&&(s=null),h)t={p:t},e={p:e};else if(_isArray(t)&&!_isArray(e)){for(d=[],m=t.length,p=m-2,u=1;u<m;u++)d.push(n(t[u-1],t[u]));m--,a=function(_){_*=m;var y=Math.min(p,~~_);return d[y](_-y)},s=e}else r||(t=_merge(_isArray(t)?[]:{},t));if(!d){for(o in e)_addPropTween.call(c,t,o,"get",e[o]);a=function(_){return _renderPropTweens(_,c)||(h?t.p:t)}}}return _conditionalReturn(s,a)},_getLabelInDirection=function n(t,e,s){var r=t.labels,a=_bigNum$1,h,c,o;for(h in r)c=r[h]-e,c<0==!!s&&c&&a>(c=Math.abs(c))&&(o=h,a=c);return o},_callback=function n(t,e,s){var r=t.vars,a=r[e],h=_context,c=t._ctx,o,u,d;if(a)return o=r[e+"Params"],u=r.callbackScope||t,s&&_lazyTweens.length&&_lazyRender(),c&&(_context=c),d=o?a.apply(u,o):a.call(u),_context=h,d},_interrupt=function n(t){return _removeFromParent(t),t.scrollTrigger&&t.scrollTrigger.kill(!!_reverting$1),t.progress()<1&&_callback(t,"onInterrupt"),t},_quickTween,_createPlugin=function n(t){t=!t.name&&t.default||t;var e=t.name,s=_isFunction(t),r=e&&!s&&t.init?function(){this._props=[]}:t,a={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},h={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),t!==r){if(_plugins[e])return;_setDefaults(r,_setDefaults(_copyExcluding(t,a),h)),_merge(r.prototype,_merge(a,_copyExcluding(t,h))),_plugins[r.prop=e]=r,t.targetTest&&(_harnessPlugins.push(r),_reservedProps[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}_addGlobal(e,r),t.register&&t.register(gsap,r,PropTween)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function n(t,e,s){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(s-e)*t*6:t<.5?s:t*3<2?e+(s-e)*(2/3-t)*6:e)*_255+.5|0},splitColor=function n(t,e,s){var r=t?_isNumber(t)?[t>>16,t>>8&_255,t&_255]:0:_colorLookup.black,a,h,c,o,u,d,m,p,g,_;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),_colorLookup[t])r=_colorLookup[t];else if(t.charAt(0)==="#"){if(t.length<6&&(a=t.charAt(1),h=t.charAt(2),c=t.charAt(3),t="#"+a+a+h+h+c+c+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&_255,r&_255,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&_255,t&_255]}else if(t.substr(0,3)==="hsl"){if(r=_=t.match(_strictNumExp),!e)o=+r[0]%360/360,u=+r[1]/100,d=+r[2]/100,h=d<=.5?d*(u+1):d+u-d*u,a=d*2-h,r.length>3&&(r[3]*=1),r[0]=_hue(o+1/3,a,h),r[1]=_hue(o,a,h),r[2]=_hue(o-1/3,a,h);else if(~t.indexOf("="))return r=t.match(_numExp),s&&r.length<4&&(r[3]=1),r}else r=t.match(_strictNumExp)||_colorLookup.transparent;r=r.map(Number)}return e&&!_&&(a=r[0]/_255,h=r[1]/_255,c=r[2]/_255,m=Math.max(a,h,c),p=Math.min(a,h,c),d=(m+p)/2,m===p?o=u=0:(g=m-p,u=d>.5?g/(2-m-p):g/(m+p),o=m===a?(h-c)/g+(h<c?6:0):m===h?(c-a)/g+2:(a-h)/g+4,o*=60),r[0]=~~(o+.5),r[1]=~~(u*100+.5),r[2]=~~(d*100+.5)),s&&r.length<4&&(r[3]=1),r},_colorOrderData=function n(t){var e=[],s=[],r=-1;return t.split(_colorExp).forEach(function(a){var h=a.match(_numWithUnitExp)||[];e.push.apply(e,h),s.push(r+=h.length+1)}),e.c=s,e},_formatColors=function n(t,e,s){var r="",a=(t+r).match(_colorExp),h=e?"hsla(":"rgba(",c=0,o,u,d,m;if(!a)return t;if(a=a.map(function(p){return(p=splitColor(p,e,1))&&h+(e?p[0]+","+p[1]+"%,"+p[2]+"%,"+p[3]:p.join(","))+")"}),s&&(d=_colorOrderData(t),o=s.c,o.join(r)!==d.c.join(r)))for(u=t.replace(_colorExp,"1").split(_numWithUnitExp),m=u.length-1;c<m;c++)r+=u[c]+(~o.indexOf(c)?a.shift()||h+"0,0,0,0)":(d.length?d:a.length?a:s).shift());if(!u)for(u=t.split(_colorExp),m=u.length-1;c<m;c++)r+=u[c]+a[c];return r+u[m]},_colorExp=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in _colorLookup)n+="|"+t+"\\b";return new RegExp(n+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function n(t){var e=t.join(" "),s;if(_colorExp.lastIndex=0,_colorExp.test(e))return s=_hslExp.test(e),t[1]=_formatColors(t[1],s),t[0]=_formatColors(t[0],s,_colorOrderData(t[1])),!0},_tickerActive,_ticker=function(){var n=Date.now,t=500,e=33,s=n(),r=s,a=1e3/240,h=a,c=[],o,u,d,m,p,g,_=function y(v){var U=n()-r,w=v===!0,k,N,W,et;if(U>t&&(s+=U-e),r+=U,W=r-s,k=W-h,(k>0||w)&&(et=++m.frame,p=W-m.time*1e3,m.time=W=W/1e3,h+=k+(k>=a?4:a-k),N=1),w||(o=u(y)),N)for(g=0;g<c.length;g++)c[g](W,p,et,v)};return m={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(v){return p/(1e3/(v||60))},wake:function(){_coreReady&&(!_coreInitted&&_windowExists$1()&&(_win$1=_coreInitted=window,_doc$1=_win$1.document||{},_globals.gsap=gsap,(_win$1.gsapVersions||(_win$1.gsapVersions=[])).push(gsap.version),_install(_installScope||_win$1.GreenSockGlobals||!_win$1.gsap&&_win$1||{}),d=_win$1.requestAnimationFrame),o&&m.sleep(),u=d||function(v){return setTimeout(v,h-m.time*1e3+1|0)},_tickerActive=1,_(2))},sleep:function(){(d?_win$1.cancelAnimationFrame:clearTimeout)(o),_tickerActive=0,u=_emptyFunc},lagSmoothing:function(v,U){t=v||1/0,e=Math.min(U||33,t)},fps:function(v){a=1e3/(v||240),h=m.time*1e3+a},add:function(v,U,w){var k=U?function(N,W,et,it){v(N,W,et,it),m.remove(k)}:v;return m.remove(v),c[w?"unshift":"push"](k),_wake(),k},remove:function(v,U){~(U=c.indexOf(v))&&c.splice(U,1)&&g>=U&&g--},_listeners:c},m}(),_wake=function n(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function n(t){for(var e={},s=t.substr(1,t.length-3).split(":"),r=s[0],a=1,h=s.length,c,o,u;a<h;a++)o=s[a],c=a!==h-1?o.lastIndexOf(","):o.length,u=o.substr(0,c),e[r]=isNaN(u)?u.replace(_quotesExp,"").trim():+u,r=o.substr(c+1).trim();return e},_valueInParentheses=function n(t){var e=t.indexOf("(")+1,s=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<s?t.indexOf(")",s+1):s)},_configEaseFromString=function n(t){var e=(t+"").split("("),s=_easeMap[e[0]];return s&&e.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[_parseObjectInString(e[1])]:_valueInParentheses(t).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(t)?_easeMap._CE("",t):s},_invertEase=function n(t){return function(e){return 1-t(1-e)}},_propagateYoyoEase=function n(t,e){for(var s=t._first,r;s;)s instanceof Timeline?n(s,e):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==e&&(s.timeline?n(s.timeline,e):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=e)),s=s._next},_parseEase=function n(t,e){return t&&(_isFunction(t)?t:_easeMap[t]||_configEaseFromString(t))||e},_insertEase=function n(t,e,s,r){s===void 0&&(s=function(o){return 1-e(1-o)}),r===void 0&&(r=function(o){return o<.5?e(o*2)/2:1-e((1-o)*2)/2});var a={easeIn:e,easeOut:s,easeInOut:r},h;return _forEachName(t,function(c){_easeMap[c]=_globals[c]=a,_easeMap[h=c.toLowerCase()]=s;for(var o in a)_easeMap[h+(o==="easeIn"?".in":o==="easeOut"?".out":".inOut")]=_easeMap[c+"."+o]=a[o]}),a},_easeInOutFromOut=function n(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},_configElastic=function n(t,e,s){var r=e>=1?e:1,a=(s||(t?.3:.45))/(e<1?e:1),h=a/_2PI*(Math.asin(1/r)||0),c=function(d){return d===1?1:r*Math.pow(2,-10*d)*_sin((d-h)*a)+1},o=t==="out"?c:t==="in"?function(u){return 1-c(1-u)}:_easeInOutFromOut(c);return a=_2PI/a,o.config=function(u,d){return n(t,u,d)},o},_configBack=function n(t,e){e===void 0&&(e=1.70158);var s=function(h){return h?--h*h*((e+1)*h+e)+1:0},r=t==="out"?s:t==="in"?function(a){return 1-s(1-a)}:_easeInOutFromOut(s);return r.config=function(a){return n(t,a)},r};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,t){var e=t<5?t+1:t;_insertEase(n+",Power"+(e-1),t?function(s){return Math.pow(s,e)}:function(s){return s},function(s){return 1-Math.pow(1-s,e)},function(s){return s<.5?Math.pow(s*2,e)/2:1-Math.pow((1-s)*2,e)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(n,t){var e=1/t,s=2*e,r=2.5*e,a=function(c){return c<e?n*c*c:c<s?n*Math.pow(c-1.5/t,2)+.75:c<r?n*(c-=2.25/t)*c+.9375:n*Math.pow(c-2.625/t,2)+.984375};_insertEase("Bounce",function(h){return 1-a(1-h)},a)})(7.5625,2.75);_insertEase("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});_insertEase("Circ",function(n){return-(_sqrt(1-n*n)-1)});_insertEase("Sine",function(n){return n===1?1:-_cos(n*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function n(t,e){t===void 0&&(t=1);var s=1/t,r=t+(e?0:1),a=e?1:0,h=1-_tinyNum;return function(c){return((r*_clamp(0,h,c)|0)+a)*s}}};_defaults.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return _callbackNames+=n+","+n+"Params,"});var GSCache=function n(t,e){this.id=_gsID++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:_getProperty,this.set=e?e.getSetter:_getSetter},Animation$1=function(){function n(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,_setDuration(this,+e.duration,1,1),this.data=e.data,_context&&(this._ctx=_context,_context.data.push(this)),_tickerActive||_ticker.wake()}var t=n.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,r){if(_wake(),!arguments.length)return this._tTime;var a=this._dp;if(a&&a.smoothChildTiming&&this._ts){for(_alignPlayhead(this,s),!a._dp||a.parent||_postAddChecks(a,this);a&&a.parent;)a.parent._time!==a._start+(a._ts>=0?a._tTime/a._ts:(a.totalDuration()-a._tTime)/-a._ts)&&a.totalTime(a._tTime,!0),a=a.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===_tinyNum||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),_lazySafeRender(this,s,r)),this},t.time=function(s,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(s?this._dur:0),r):this._time},t.totalProgress=function(s,r){return arguments.length?this.totalTime(this.totalDuration()*s,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(s,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+_elapsedCycleDuration(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(s,r){var a=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*a,r):this._repeat?_animationCycle(this._tTime,a)+1:1},t.timeScale=function(s){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-_tinyNum?0:this._rts,this.totalTime(_clamp(-this._delay,this._tDur,r),!0),_setEnd(this),_recacheAncestors(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&_addToTimeline(r,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(_isNotFalse(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var r=this.parent||this._dp;return r?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(r.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=_revertConfig);var r=_reverting$1;return _reverting$1=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),_reverting$1=r,this},t.globalTime=function(s){for(var r=this,a=arguments.length?s:r.rawTime();r;)a=r._start+a/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(s):a},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var r=this._time;return this._rDelay=s,_onUpdateTotalDuration(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,r){return this.totalTime(_parsePosition(this,s),_isNotFalse(r))},t.restart=function(s,r){return this.play().totalTime(s?-this._delay:0,_isNotFalse(r))},t.play=function(s,r){return s!=null&&this.seek(s,r),this.reversed(!1).paused(!1)},t.reverse=function(s,r){return s!=null&&this.seek(s||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(s,r){return s!=null&&this.seek(s,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-_tinyNum:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},t.isActive=function(){var s=this.parent||this._dp,r=this._start,a;return!!(!s||this._ts&&this._initted&&s.isActive()&&(a=s.rawTime(!0))>=r&&a<this.endTime(!0)-_tinyNum)},t.eventCallback=function(s,r,a){var h=this.vars;return arguments.length>1?(r?(h[s]=r,a&&(h[s+"Params"]=a),s==="onUpdate"&&(this._onUpdate=r)):delete h[s],this):h[s]},t.then=function(s){var r=this;return new Promise(function(a){var h=_isFunction(s)?s:_passThrough,c=function(){var u=r.then;r.then=null,_isFunction(h)&&(h=h(r))&&(h.then||h===r)&&(r.then=u),a(h),r.then=u};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?c():r._prom=c})},t.kill=function(){_interrupt(this)},n}();_setDefaults(Animation$1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(n){_inheritsLoose(t,n);function t(s,r){var a;return s===void 0&&(s={}),a=n.call(this,s)||this,a.labels={},a.smoothChildTiming=!!s.smoothChildTiming,a.autoRemoveChildren=!!s.autoRemoveChildren,a._sort=_isNotFalse(s.sortChildren),_globalTimeline&&_addToTimeline(s.parent||_globalTimeline,_assertThisInitialized(a),r),s.reversed&&a.reverse(),s.paused&&a.paused(!0),s.scrollTrigger&&_scrollTrigger(_assertThisInitialized(a),s.scrollTrigger),a}var e=t.prototype;return e.to=function(r,a,h){return _createTweenType(0,arguments,this),this},e.from=function(r,a,h){return _createTweenType(1,arguments,this),this},e.fromTo=function(r,a,h,c){return _createTweenType(2,arguments,this),this},e.set=function(r,a,h){return a.duration=0,a.parent=this,_inheritDefaults(a).repeatDelay||(a.repeat=0),a.immediateRender=!!a.immediateRender,new Tween$1(r,a,_parsePosition(this,h),1),this},e.call=function(r,a,h){return _addToTimeline(this,Tween$1.delayedCall(0,r,a),h)},e.staggerTo=function(r,a,h,c,o,u,d){return h.duration=a,h.stagger=h.stagger||c,h.onComplete=u,h.onCompleteParams=d,h.parent=this,new Tween$1(r,h,_parsePosition(this,o)),this},e.staggerFrom=function(r,a,h,c,o,u,d){return h.runBackwards=1,_inheritDefaults(h).immediateRender=_isNotFalse(h.immediateRender),this.staggerTo(r,a,h,c,o,u,d)},e.staggerFromTo=function(r,a,h,c,o,u,d,m){return c.startAt=h,_inheritDefaults(c).immediateRender=_isNotFalse(c.immediateRender),this.staggerTo(r,a,c,o,u,d,m)},e.render=function(r,a,h){var c=this._time,o=this._dirty?this.totalDuration():this._tDur,u=this._dur,d=r<=0?0:_roundPrecise(r),m=this._zTime<0!=r<0&&(this._initted||!u),p,g,_,y,v,U,w,k,N,W,et,it;if(this!==_globalTimeline&&d>o&&r>=0&&(d=o),d!==this._tTime||h||m){if(c!==this._time&&u&&(d+=this._time-c,r+=this._time-c),p=d,N=this._start,k=this._ts,U=!k,m&&(u||(c=this._zTime),(r||!a)&&(this._zTime=r)),this._repeat){if(et=this._yoyo,v=u+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(v*100+r,a,h);if(p=_roundPrecise(d%v),d===o?(y=this._repeat,p=u):(y=~~(d/v),y&&y===d/v&&(p=u,y--),p>u&&(p=u)),W=_animationCycle(this._tTime,v),!c&&this._tTime&&W!==y&&(W=y),et&&y&1&&(p=u-p,it=1),y!==W&&!this._lock){var ft=et&&W&1,mt=ft===(et&&y&1);if(y<W&&(ft=!ft),c=ft?0:u,this._lock=1,this.render(c||(it?0:_roundPrecise(y*v)),a,!u)._lock=0,this._tTime=d,!a&&this.parent&&_callback(this,"onRepeat"),this.vars.repeatRefresh&&!it&&(this.invalidate()._lock=1),c&&c!==this._time||U!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(u=this._dur,o=this._tDur,mt&&(this._lock=2,c=ft?u:-1e-4,this.render(c,!0),this.vars.repeatRefresh&&!it&&this.invalidate()),this._lock=0,!this._ts&&!U)return this;_propagateYoyoEase(this,it)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(w=_findNextPauseTween(this,_roundPrecise(c),_roundPrecise(p)),w&&(d-=p-(p=w._start))),this._tTime=d,this._time=p,this._act=!k,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,c=0),!c&&p&&!a&&(_callback(this,"onStart"),this._tTime!==d))return this;if(p>=c&&r>=0)for(g=this._first;g;){if(_=g._next,(g._act||p>=g._start)&&g._ts&&w!==g){if(g.parent!==this)return this.render(r,a,h);if(g.render(g._ts>0?(p-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(p-g._start)*g._ts,a,h),p!==this._time||!this._ts&&!U){w=0,_&&(d+=this._zTime=-_tinyNum);break}}g=_}else{g=this._last;for(var xt=r<0?r:p;g;){if(_=g._prev,(g._act||xt<=g._end)&&g._ts&&w!==g){if(g.parent!==this)return this.render(r,a,h);if(g.render(g._ts>0?(xt-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(xt-g._start)*g._ts,a,h||_reverting$1&&(g._initted||g._startAt)),p!==this._time||!this._ts&&!U){w=0,_&&(d+=this._zTime=xt?-_tinyNum:_tinyNum);break}}g=_}}if(w&&!a&&(this.pause(),w.render(p>=c?0:-_tinyNum)._zTime=p>=c?1:-1,this._ts))return this._start=N,_setEnd(this),this.render(r,a,h);this._onUpdate&&!a&&_callback(this,"onUpdate",!0),(d===o&&this._tTime>=this.totalDuration()||!d&&c)&&(N===this._start||Math.abs(k)!==Math.abs(this._ts))&&(this._lock||((r||!u)&&(d===o&&this._ts>0||!d&&this._ts<0)&&_removeFromParent(this,1),!a&&!(r<0&&!c)&&(d||c||!o)&&(_callback(this,d===o&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(d<o&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,a){var h=this;if(_isNumber(a)||(a=_parsePosition(this,a,r)),!(r instanceof Animation$1)){if(_isArray(r))return r.forEach(function(c){return h.add(c,a)}),this;if(_isString(r))return this.addLabel(r,a);if(_isFunction(r))r=Tween$1.delayedCall(0,r);else return this}return this!==r?_addToTimeline(this,r,a):this},e.getChildren=function(r,a,h,c){r===void 0&&(r=!0),a===void 0&&(a=!0),h===void 0&&(h=!0),c===void 0&&(c=-_bigNum$1);for(var o=[],u=this._first;u;)u._start>=c&&(u instanceof Tween$1?a&&o.push(u):(h&&o.push(u),r&&o.push.apply(o,u.getChildren(!0,a,h)))),u=u._next;return o},e.getById=function(r){for(var a=this.getChildren(1,1,1),h=a.length;h--;)if(a[h].vars.id===r)return a[h]},e.remove=function(r){return _isString(r)?this.removeLabel(r):_isFunction(r)?this.killTweensOf(r):(_removeLinkedListItem(this,r),r===this._recent&&(this._recent=this._last),_uncache(this))},e.totalTime=function(r,a){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,a),this._forcing=0,this):this._tTime},e.addLabel=function(r,a){return this.labels[r]=_parsePosition(this,a),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,a,h){var c=Tween$1.delayedCall(0,a||_emptyFunc,h);return c.data="isPause",this._hasPause=1,_addToTimeline(this,c,_parsePosition(this,r))},e.removePause=function(r){var a=this._first;for(r=_parsePosition(this,r);a;)a._start===r&&a.data==="isPause"&&_removeFromParent(a),a=a._next},e.killTweensOf=function(r,a,h){for(var c=this.getTweensOf(r,h),o=c.length;o--;)_overwritingTween!==c[o]&&c[o].kill(r,a);return this},e.getTweensOf=function(r,a){for(var h=[],c=toArray(r),o=this._first,u=_isNumber(a),d;o;)o instanceof Tween$1?_arrayContainsAny(o._targets,c)&&(u?(!_overwritingTween||o._initted&&o._ts)&&o.globalTime(0)<=a&&o.globalTime(o.totalDuration())>a:!a||o.isActive())&&h.push(o):(d=o.getTweensOf(c,a)).length&&h.push.apply(h,d),o=o._next;return h},e.tweenTo=function(r,a){a=a||{};var h=this,c=_parsePosition(h,r),o=a,u=o.startAt,d=o.onStart,m=o.onStartParams,p=o.immediateRender,g,_=Tween$1.to(h,_setDefaults({ease:a.ease||"none",lazy:!1,immediateRender:!1,time:c,overwrite:"auto",duration:a.duration||Math.abs((c-(u&&"time"in u?u.time:h._time))/h.timeScale())||_tinyNum,onStart:function(){if(h.pause(),!g){var v=a.duration||Math.abs((c-(u&&"time"in u?u.time:h._time))/h.timeScale());_._dur!==v&&_setDuration(_,v,0,1).render(_._time,!0,!0),g=1}d&&d.apply(_,m||[])}},a));return p?_.render(0):_},e.tweenFromTo=function(r,a,h){return this.tweenTo(a,_setDefaults({startAt:{time:_parsePosition(this,r)}},h))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+_tinyNum)},e.shiftChildren=function(r,a,h){h===void 0&&(h=0);for(var c=this._first,o=this.labels,u;c;)c._start>=h&&(c._start+=r,c._end+=r),c=c._next;if(a)for(u in o)o[u]>=h&&(o[u]+=r);return _uncache(this)},e.invalidate=function(r){var a=this._first;for(this._lock=0;a;)a.invalidate(r),a=a._next;return n.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var a=this._first,h;a;)h=a._next,this.remove(a),a=h;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),_uncache(this)},e.totalDuration=function(r){var a=0,h=this,c=h._last,o=_bigNum$1,u,d,m;if(arguments.length)return h.timeScale((h._repeat<0?h.duration():h.totalDuration())/(h.reversed()?-r:r));if(h._dirty){for(m=h.parent;c;)u=c._prev,c._dirty&&c.totalDuration(),d=c._start,d>o&&h._sort&&c._ts&&!h._lock?(h._lock=1,_addToTimeline(h,c,d-c._delay,1)._lock=0):o=d,d<0&&c._ts&&(a-=d,(!m&&!h._dp||m&&m.smoothChildTiming)&&(h._start+=d/h._ts,h._time-=d,h._tTime-=d),h.shiftChildren(-d,!1,-1/0),o=0),c._end>a&&c._ts&&(a=c._end),c=u;_setDuration(h,h===_globalTimeline&&h._time>a?h._time:a,1,1),h._dirty=0}return h._tDur},t.updateRoot=function(r){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(r,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var a=_globalTimeline._first;if((!a||!a._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;a&&!a._ts;)a=a._next;a||_ticker.sleep()}}},t}(Animation$1);_setDefaults(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function n(t,e,s,r,a,h,c){var o=new PropTween(this._pt,t,e,0,1,_renderComplexString,null,a),u=0,d=0,m,p,g,_,y,v,U,w;for(o.b=s,o.e=r,s+="",r+="",(U=~r.indexOf("random("))&&(r=_replaceRandom(r)),h&&(w=[s,r],h(w,t,e),s=w[0],r=w[1]),p=s.match(_complexStringNumExp)||[];m=_complexStringNumExp.exec(r);)_=m[0],y=r.substring(u,m.index),g?g=(g+1)%5:y.substr(-5)==="rgba("&&(g=1),_!==p[d++]&&(v=parseFloat(p[d-1])||0,o._pt={_next:o._pt,p:y||d===1?y:",",s:v,c:_.charAt(1)==="="?_parseRelative(v,_)-v:parseFloat(_)-v,m:g&&g<4?Math.round:0},u=_complexStringNumExp.lastIndex);return o.c=u<r.length?r.substring(u,r.length):"",o.fp=c,(_relExp.test(r)||U)&&(o.e=0),this._pt=o,o},_addPropTween=function n(t,e,s,r,a,h,c,o,u,d){_isFunction(r)&&(r=r(a||0,t,h));var m=t[e],p=s!=="get"?s:_isFunction(m)?u?t[e.indexOf("set")||!_isFunction(t["get"+e.substr(3)])?e:"get"+e.substr(3)](u):t[e]():m,g=_isFunction(m)?u?_setterFuncWithParam:_setterFunc:_setterPlain,_;if(_isString(r)&&(~r.indexOf("random(")&&(r=_replaceRandom(r)),r.charAt(1)==="="&&(_=_parseRelative(p,r)+(getUnit(p)||0),(_||_===0)&&(r=_))),!d||p!==r||_forceAllPropTweens)return!isNaN(p*r)&&r!==""?(_=new PropTween(this._pt,t,e,+p||0,r-(p||0),typeof m=="boolean"?_renderBoolean:_renderPlain,0,g),u&&(_.fp=u),c&&_.modifier(c,this,t),this._pt=_):(!m&&!(e in t)&&_missingPlugin(e,r),_addComplexStringPropTween.call(this,t,e,p,r,g,o||_config.stringFilter,u))},_processVars=function n(t,e,s,r,a){if(_isFunction(t)&&(t=_parseFuncOrString(t,a,e,s,r)),!_isObject(t)||t.style&&t.nodeType||_isArray(t)||_isTypedArray(t))return _isString(t)?_parseFuncOrString(t,a,e,s,r):t;var h={},c;for(c in t)h[c]=_parseFuncOrString(t[c],a,e,s,r);return h},_checkPlugin=function n(t,e,s,r,a,h){var c,o,u,d;if(_plugins[t]&&(c=new _plugins[t]).init(a,c.rawVars?e[t]:_processVars(e[t],r,a,h,s),s,r,h)!==!1&&(s._pt=o=new PropTween(s._pt,a,t,0,1,c.render,c,0,c.priority),s!==_quickTween))for(u=s._ptLookup[s._targets.indexOf(a)],d=c._props.length;d--;)u[c._props[d]]=o;return c},_overwritingTween,_forceAllPropTweens,_initTween=function n(t,e,s){var r=t.vars,a=r.ease,h=r.startAt,c=r.immediateRender,o=r.lazy,u=r.onUpdate,d=r.onUpdateParams,m=r.callbackScope,p=r.runBackwards,g=r.yoyoEase,_=r.keyframes,y=r.autoRevert,v=t._dur,U=t._startAt,w=t._targets,k=t.parent,N=k&&k.data==="nested"?k.vars.targets:w,W=t._overwrite==="auto"&&!_suppressOverwrites,et=t.timeline,it,ft,mt,xt,yt,vt,St,wt,Ct,It,Pt,Xt,Ut;if(et&&(!_||!a)&&(a="none"),t._ease=_parseEase(a,_defaults.ease),t._yEase=g?_invertEase(_parseEase(g===!0?a:g,_defaults.ease)):0,g&&t._yoyo&&!t._repeat&&(g=t._yEase,t._yEase=t._ease,t._ease=g),t._from=!et&&!!r.runBackwards,!et||_&&!r.stagger){if(wt=w[0]?_getCache(w[0]).harness:0,Xt=wt&&r[wt.prop],it=_copyExcluding(r,_reservedProps),U&&(U._zTime<0&&U.progress(1),e<0&&p&&c&&!y?U.render(-1,!0):U.revert(p&&v?_revertConfigNoKill:_startAtRevertConfig),U._lazy=0),h){if(_removeFromParent(t._startAt=Tween$1.set(w,_setDefaults({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:!U&&_isNotFalse(o),startAt:null,delay:0,onUpdate:u,onUpdateParams:d,callbackScope:m,stagger:0},h))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(_reverting$1||!c&&!y)&&t._startAt.revert(_revertConfigNoKill),c&&v&&e<=0&&s<=0){e&&(t._zTime=e);return}}else if(p&&v&&!U){if(e&&(c=!1),mt=_setDefaults({overwrite:!1,data:"isFromStart",lazy:c&&!U&&_isNotFalse(o),immediateRender:c,stagger:0,parent:k},it),Xt&&(mt[wt.prop]=Xt),_removeFromParent(t._startAt=Tween$1.set(w,mt)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(_reverting$1?t._startAt.revert(_revertConfigNoKill):t._startAt.render(-1,!0)),t._zTime=e,!c)n(t._startAt,_tinyNum,_tinyNum);else if(!e)return}for(t._pt=t._ptCache=0,o=v&&_isNotFalse(o)||o&&!v,ft=0;ft<w.length;ft++){if(yt=w[ft],St=yt._gsap||_harness(w)[ft]._gsap,t._ptLookup[ft]=It={},_lazyLookup[St.id]&&_lazyTweens.length&&_lazyRender(),Pt=N===w?ft:N.indexOf(yt),wt&&(Ct=new wt).init(yt,Xt||it,t,Pt,N)!==!1&&(t._pt=xt=new PropTween(t._pt,yt,Ct.name,0,1,Ct.render,Ct,0,Ct.priority),Ct._props.forEach(function(Et){It[Et]=xt}),Ct.priority&&(vt=1)),!wt||Xt)for(mt in it)_plugins[mt]&&(Ct=_checkPlugin(mt,it,t,Pt,yt,N))?Ct.priority&&(vt=1):It[mt]=xt=_addPropTween.call(t,yt,mt,"get",it[mt],Pt,N,0,r.stringFilter);t._op&&t._op[ft]&&t.kill(yt,t._op[ft]),W&&t._pt&&(_overwritingTween=t,_globalTimeline.killTweensOf(yt,It,t.globalTime(e)),Ut=!t.parent,_overwritingTween=0),t._pt&&o&&(_lazyLookup[St.id]=1)}vt&&_sortPropTweensByPriority(t),t._onInit&&t._onInit(t)}t._onUpdate=u,t._initted=(!t._op||t._pt)&&!Ut,_&&e<=0&&et.render(_bigNum$1,!0,!0)},_updatePropTweens=function n(t,e,s,r,a,h,c){var o=(t._pt&&t._ptCache||(t._ptCache={}))[e],u,d,m,p;if(!o)for(o=t._ptCache[e]=[],m=t._ptLookup,p=t._targets.length;p--;){if(u=m[p][e],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==e&&u.fp!==e;)u=u._next;if(!u)return _forceAllPropTweens=1,t.vars[e]="+=0",_initTween(t,c),_forceAllPropTweens=0,1;o.push(u)}for(p=o.length;p--;)d=o[p],u=d._pt||d,u.s=(r||r===0)&&!a?r:u.s+(r||0)+h*u.c,u.c=s-u.s,d.e&&(d.e=_round(s)+getUnit(d.e)),d.b&&(d.b=u.s+getUnit(d.b))},_addAliasesToVars=function n(t,e){var s=t[0]?_getCache(t[0]).harness:0,r=s&&s.aliases,a,h,c,o;if(!r)return e;a=_merge({},e);for(h in r)if(h in a)for(o=r[h].split(","),c=o.length;c--;)a[o[c]]=a[h];return a},_parseKeyframe=function n(t,e,s,r){var a=e.ease||r||"power1.inOut",h,c;if(_isArray(e))c=s[t]||(s[t]=[]),e.forEach(function(o,u){return c.push({t:u/(e.length-1)*100,v:o,e:a})});else for(h in e)c=s[h]||(s[h]=[]),h==="ease"||c.push({t:parseFloat(t),v:e[h],e:a})},_parseFuncOrString=function n(t,e,s,r,a){return _isFunction(t)?t.call(e,s,r,a):_isString(t)&&~t.indexOf("random(")?_replaceRandom(t):t},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return _staggerPropsToSkip[n]=1});var Tween$1=function(n){_inheritsLoose(t,n);function t(s,r,a,h){var c;typeof r=="number"&&(a.duration=r,r=a,a=null),c=n.call(this,h?r:_inheritDefaults(r))||this;var o=c.vars,u=o.duration,d=o.delay,m=o.immediateRender,p=o.stagger,g=o.overwrite,_=o.keyframes,y=o.defaults,v=o.scrollTrigger,U=o.yoyoEase,w=r.parent||_globalTimeline,k=(_isArray(s)||_isTypedArray(s)?_isNumber(s[0]):"length"in r)?[s]:toArray(s),N,W,et,it,ft,mt,xt,yt;if(c._targets=k.length?_harness(k):_warn("GSAP target "+s+" not found. https://greensock.com",!_config.nullTargetWarn)||[],c._ptLookup=[],c._overwrite=g,_||p||_isFuncOrString(u)||_isFuncOrString(d)){if(r=c.vars,N=c.timeline=new Timeline({data:"nested",defaults:y||{},targets:w&&w.data==="nested"?w.vars.targets:k}),N.kill(),N.parent=N._dp=_assertThisInitialized(c),N._start=0,p||_isFuncOrString(u)||_isFuncOrString(d)){if(it=k.length,xt=p&&distribute(p),_isObject(p))for(ft in p)~_staggerTweenProps.indexOf(ft)&&(yt||(yt={}),yt[ft]=p[ft]);for(W=0;W<it;W++)et=_copyExcluding(r,_staggerPropsToSkip),et.stagger=0,U&&(et.yoyoEase=U),yt&&_merge(et,yt),mt=k[W],et.duration=+_parseFuncOrString(u,_assertThisInitialized(c),W,mt,k),et.delay=(+_parseFuncOrString(d,_assertThisInitialized(c),W,mt,k)||0)-c._delay,!p&&it===1&&et.delay&&(c._delay=d=et.delay,c._start+=d,et.delay=0),N.to(mt,et,xt?xt(W,mt,k):0),N._ease=_easeMap.none;N.duration()?u=d=0:c.timeline=0}else if(_){_inheritDefaults(_setDefaults(N.vars.defaults,{ease:"none"})),N._ease=_parseEase(_.ease||r.ease||"none");var vt=0,St,wt,Ct;if(_isArray(_))_.forEach(function(It){return N.to(k,It,">")}),N.duration();else{et={};for(ft in _)ft==="ease"||ft==="easeEach"||_parseKeyframe(ft,_[ft],et,_.easeEach);for(ft in et)for(St=et[ft].sort(function(It,Pt){return It.t-Pt.t}),vt=0,W=0;W<St.length;W++)wt=St[W],Ct={ease:wt.e,duration:(wt.t-(W?St[W-1].t:0))/100*u},Ct[ft]=wt.v,N.to(k,Ct,vt),vt+=Ct.duration;N.duration()<u&&N.to({},{duration:u-N.duration()})}}u||c.duration(u=N.duration())}else c.timeline=0;return g===!0&&!_suppressOverwrites&&(_overwritingTween=_assertThisInitialized(c),_globalTimeline.killTweensOf(k),_overwritingTween=0),_addToTimeline(w,_assertThisInitialized(c),a),r.reversed&&c.reverse(),r.paused&&c.paused(!0),(m||!u&&!_&&c._start===_roundPrecise(w._time)&&_isNotFalse(m)&&_hasNoPausedAncestors(_assertThisInitialized(c))&&w.data!=="nested")&&(c._tTime=-_tinyNum,c.render(Math.max(0,-d)||0)),v&&_scrollTrigger(_assertThisInitialized(c),v),c}var e=t.prototype;return e.render=function(r,a,h){var c=this._time,o=this._tDur,u=this._dur,d=r<0,m=r>o-_tinyNum&&!d?o:r<_tinyNum?0:r,p,g,_,y,v,U,w,k,N;if(!u)_renderZeroDurationTween(this,r,a,h);else if(m!==this._tTime||!r||h||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==d){if(p=m,k=this.timeline,this._repeat){if(y=u+this._rDelay,this._repeat<-1&&d)return this.totalTime(y*100+r,a,h);if(p=_roundPrecise(m%y),m===o?(_=this._repeat,p=u):(_=~~(m/y),_&&_===m/y&&(p=u,_--),p>u&&(p=u)),U=this._yoyo&&_&1,U&&(N=this._yEase,p=u-p),v=_animationCycle(this._tTime,y),p===c&&!h&&this._initted)return this._tTime=m,this;_!==v&&(k&&this._yEase&&_propagateYoyoEase(k,U),this.vars.repeatRefresh&&!U&&!this._lock&&(this._lock=h=1,this.render(_roundPrecise(y*_),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,d?r:p,h,a,m))return this._tTime=0,this;if(c!==this._time)return this;if(u!==this._dur)return this.render(r,a,h)}if(this._tTime=m,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=w=(N||this._ease)(p/u),this._from&&(this.ratio=w=1-w),p&&!c&&!a&&(_callback(this,"onStart"),this._tTime!==m))return this;for(g=this._pt;g;)g.r(w,g.d),g=g._next;k&&k.render(r<0?r:!p&&U?-_tinyNum:k._dur*k._ease(p/this._dur),a,h)||this._startAt&&(this._zTime=r),this._onUpdate&&!a&&(d&&_rewindStartAt(this,r,a,h),_callback(this,"onUpdate")),this._repeat&&_!==v&&this.vars.onRepeat&&!a&&this.parent&&_callback(this,"onRepeat"),(m===this._tDur||!m)&&this._tTime===m&&(d&&!this._onUpdate&&_rewindStartAt(this,r,!0,!0),(r||!u)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&_removeFromParent(this,1),!a&&!(d&&!c)&&(m||c||U)&&(_callback(this,m===o?"onComplete":"onReverseComplete",!0),this._prom&&!(m<o&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},e.resetTo=function(r,a,h,c){_tickerActive||_ticker.wake(),this._ts||this.play();var o=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||_initTween(this,o),u=this._ease(o/this._dur),_updatePropTweens(this,r,a,h,c,u,o)?this.resetTo(r,a,h,c):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,a){if(a===void 0&&(a="all"),!r&&(!a||a==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this;if(this.timeline){var h=this.timeline.totalDuration();return this.timeline.killTweensOf(r,a,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&h!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/h,0,1),this}var c=this._targets,o=r?toArray(r):c,u=this._ptLookup,d=this._pt,m,p,g,_,y,v,U;if((!a||a==="all")&&_arraysMatch(c,o))return a==="all"&&(this._pt=0),_interrupt(this);for(m=this._op=this._op||[],a!=="all"&&(_isString(a)&&(y={},_forEachName(a,function(w){return y[w]=1}),a=y),a=_addAliasesToVars(c,a)),U=c.length;U--;)if(~o.indexOf(c[U])){p=u[U],a==="all"?(m[U]=a,_=p,g={}):(g=m[U]=m[U]||{},_=a);for(y in _)v=p&&p[y],v&&((!("kill"in v.d)||v.d.kill(y)===!0)&&_removeLinkedListItem(this,v,"_pt"),delete p[y]),g!=="all"&&(g[y]=1)}return this._initted&&!this._pt&&d&&_interrupt(this),this},t.to=function(r,a){return new t(r,a,arguments[2])},t.from=function(r,a){return _createTweenType(1,arguments)},t.delayedCall=function(r,a,h,c){return new t(a,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:a,onReverseComplete:a,onCompleteParams:h,onReverseCompleteParams:h,callbackScope:c})},t.fromTo=function(r,a,h){return _createTweenType(2,arguments)},t.set=function(r,a){return a.duration=0,a.repeatDelay||(a.repeat=0),new t(r,a)},t.killTweensOf=function(r,a,h){return _globalTimeline.killTweensOf(r,a,h)},t}(Animation$1);_setDefaults(Tween$1.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(n){Tween$1[n]=function(){var t=new Timeline,e=_slice.call(arguments,0);return e.splice(n==="staggerFromTo"?5:4,0,0),t[n].apply(t,e)}});var _setterPlain=function n(t,e,s){return t[e]=s},_setterFunc=function n(t,e,s){return t[e](s)},_setterFuncWithParam=function n(t,e,s,r){return t[e](r.fp,s)},_setterAttribute=function n(t,e,s){return t.setAttribute(e,s)},_getSetter=function n(t,e){return _isFunction(t[e])?_setterFunc:_isUndefined(t[e])&&t.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function n(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},_renderBoolean=function n(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},_renderComplexString=function n(t,e){var s=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;s;)r=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+r,s=s._next;r+=e.c}e.set(e.t,e.p,r,e)},_renderPropTweens=function n(t,e){for(var s=e._pt;s;)s.r(t,s.d),s=s._next},_addPluginModifier=function n(t,e,s,r){for(var a=this._pt,h;a;)h=a._next,a.p===r&&a.modifier(t,e,s),a=h},_killPropTweensOf=function n(t){for(var e=this._pt,s,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?_removeLinkedListItem(this,e,"_pt"):e.dep||(s=1),e=r;return!s},_setterWithModifier=function n(t,e,s,r){r.mSet(t,e,r.m.call(r.tween,s,r.mt),r)},_sortPropTweensByPriority=function n(t){for(var e=t._pt,s,r,a,h;e;){for(s=e._next,r=a;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:h)?e._prev._next=e:a=e,(e._next=r)?r._prev=e:h=e,e=s}t._pt=a},PropTween=function(){function n(e,s,r,a,h,c,o,u,d){this.t=s,this.s=a,this.c=h,this.p=r,this.r=c||_renderPlain,this.d=o||this,this.set=u||_setterPlain,this.pr=d||0,this._next=e,e&&(e._prev=this)}var t=n.prototype;return t.modifier=function(s,r,a){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=s,this.mt=a,this.tween=r},n}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return _reservedProps[n]=1});_globals.TweenMax=_globals.TweenLite=Tween$1;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners={},_emptyArray=[],_lastMediaTime=0,_dispatch=function n(t){return(_listeners[t]||_emptyArray).map(function(e){return e()})},_onMediaChange=function n(){var t=Date.now(),e=[];t-_lastMediaTime>2&&(_dispatch("matchMediaInit"),_media.forEach(function(s){var r=s.queries,a=s.conditions,h,c,o,u;for(c in r)h=_win$1.matchMedia(r[c]).matches,h&&(o=1),h!==a[c]&&(a[c]=h,u=1);u&&(s.revert(),o&&e.push(s))}),_dispatch("matchMediaRevert"),e.forEach(function(s){return s.onMatch(s)}),_lastMediaTime=t,_dispatch("matchMedia"))},Context=function(){function n(e,s){this.selector=s&&selector(s),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=n.prototype;return t.add=function(s,r,a){_isFunction(s)&&(a=r,r=s,s=_isFunction);var h=this,c=function(){var u=_context,d=h.selector,m;return u&&u!==h&&u.data.push(h),a&&(h.selector=selector(a)),_context=h,m=r.apply(h,arguments),_isFunction(m)&&h._r.push(m),_context=u,h.selector=d,h.isReverted=!1,m};return h.last=c,s===_isFunction?c(h):s?h[s]=c:c},t.ignore=function(s){var r=_context;_context=null,s(this),_context=r},t.getTweens=function(){var s=[];return this.data.forEach(function(r){return r instanceof n?s.push.apply(s,r.getTweens()):r instanceof Tween$1&&!(r.parent&&r.parent.data==="nested")&&s.push(r)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,r){var a=this;if(s){var h=this.getTweens();this.data.forEach(function(o){o.data==="isFlip"&&(o.revert(),o.getChildren(!0,!0,!1).forEach(function(u){return h.splice(h.indexOf(u),1)}))}),h.map(function(o){return{g:o.globalTime(0),t:o}}).sort(function(o,u){return u.g-o.g||-1}).forEach(function(o){return o.t.revert(s)}),this.data.forEach(function(o){return!(o instanceof Animation$1)&&o.revert&&o.revert(s)}),this._r.forEach(function(o){return o(s,a)}),this.isReverted=!0}else this.data.forEach(function(o){return o.kill&&o.kill()});if(this.clear(),r){var c=_media.indexOf(this);~c&&_media.splice(c,1)}},t.revert=function(s){this.kill(s||{})},n}(),MatchMedia=function(){function n(e){this.contexts=[],this.scope=e}var t=n.prototype;return t.add=function(s,r,a){_isObject(s)||(s={matches:s});var h=new Context(0,a||this.scope),c=h.conditions={},o,u,d;this.contexts.push(h),r=h.add("onMatch",r),h.queries=s;for(u in s)u==="all"?d=1:(o=_win$1.matchMedia(s[u]),o&&(_media.indexOf(h)<0&&_media.push(h),(c[u]=o.matches)&&(d=1),o.addListener?o.addListener(_onMediaChange):o.addEventListener("change",_onMediaChange)));return d&&r(h),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(r){return r.kill(s,!0)})},n}(),_gsap={registerPlugin:function n(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e.forEach(function(r){return _createPlugin(r)})},timeline:function n(t){return new Timeline(t)},getTweensOf:function n(t,e){return _globalTimeline.getTweensOf(t,e)},getProperty:function n(t,e,s,r){_isString(t)&&(t=toArray(t)[0]);var a=_getCache(t||{}).get,h=s?_passThrough:_numericIfPossible;return s==="native"&&(s=""),t&&(e?h((_plugins[e]&&_plugins[e].get||a)(t,e,s,r)):function(c,o,u){return h((_plugins[c]&&_plugins[c].get||a)(t,c,o,u))})},quickSetter:function n(t,e,s){if(t=toArray(t),t.length>1){var r=t.map(function(d){return gsap.quickSetter(d,e,s)}),a=r.length;return function(d){for(var m=a;m--;)r[m](d)}}t=t[0]||{};var h=_plugins[e],c=_getCache(t),o=c.harness&&(c.harness.aliases||{})[e]||e,u=h?function(d){var m=new h;_quickTween._pt=0,m.init(t,s?d+s:d,_quickTween,0,[t]),m.render(1,m),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:c.set(t,o);return h?u:function(d){return u(t,o,s?d+s:d,c,1)}},quickTo:function n(t,e,s){var r,a=gsap.to(t,_merge((r={},r[e]="+=0.1",r.paused=!0,r),s||{})),h=function(o,u,d){return a.resetTo(e,o,u,d)};return h.tween=a,h},isTweening:function n(t){return _globalTimeline.getTweensOf(t,!0).length>0},defaults:function n(t){return t&&t.ease&&(t.ease=_parseEase(t.ease,_defaults.ease)),_mergeDeep(_defaults,t||{})},config:function n(t){return _mergeDeep(_config,t||{})},registerEffect:function n(t){var e=t.name,s=t.effect,r=t.plugins,a=t.defaults,h=t.extendTimeline;(r||"").split(",").forEach(function(c){return c&&!_plugins[c]&&!_globals[c]&&_warn(e+" effect requires "+c+" plugin.")}),_effects[e]=function(c,o,u){return s(toArray(c),_setDefaults(o||{},a),u)},h&&(Timeline.prototype[e]=function(c,o,u){return this.add(_effects[e](c,_isObject(o)?o:(u=o)&&{},this),u)})},registerEase:function n(t,e){_easeMap[t]=_parseEase(e)},parseEase:function n(t,e){return arguments.length?_parseEase(t,e):_easeMap},getById:function n(t){return _globalTimeline.getById(t)},exportRoot:function n(t,e){t===void 0&&(t={});var s=new Timeline(t),r,a;for(s.smoothChildTiming=_isNotFalse(t.smoothChildTiming),_globalTimeline.remove(s),s._dp=0,s._time=s._tTime=_globalTimeline._time,r=_globalTimeline._first;r;)a=r._next,(e||!(!r._dur&&r instanceof Tween$1&&r.vars.onComplete===r._targets[0]))&&_addToTimeline(s,r,r._start-r._delay),r=a;return _addToTimeline(_globalTimeline,s,0),s},context:function n(t,e){return t?new Context(t,e):_context},matchMedia:function n(t){return new MatchMedia(t)},matchMediaRefresh:function n(){return _media.forEach(function(t){var e=t.conditions,s,r;for(r in e)e[r]&&(e[r]=!1,s=1);s&&t.revert()})||_onMediaChange()},addEventListener:function n(t,e){var s=_listeners[t]||(_listeners[t]=[]);~s.indexOf(e)||s.push(e)},removeEventListener:function n(t,e){var s=_listeners[t],r=s&&s.indexOf(e);r>=0&&s.splice(r,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween:Tween$1,Timeline,Animation:Animation$1,getCache:_getCache,_removeLinkedListItem,reverting:function n(){return _reverting$1},context:function n(t){return t&&_context&&(_context.data.push(t),t._ctx=_context),_context},suppressOverwrites:function n(t){return _suppressOverwrites=t}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return _gsap[n]=Tween$1[n]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function n(t,e){for(var s=t._pt;s&&s.p!==e&&s.op!==e&&s.fp!==e;)s=s._next;return s},_addModifiers=function n(t,e){var s=t._targets,r,a,h;for(r in e)for(a=s.length;a--;)h=t._ptLookup[a][r],h&&(h=h.d)&&(h._pt&&(h=_getPluginPropTween(h,r)),h&&h.modifier&&h.modifier(e[r],t,s[a],r))},_buildModifierPlugin=function n(t,e){return{name:t,rawVars:1,init:function(r,a,h){h._onInit=function(c){var o,u;if(_isString(a)&&(o={},_forEachName(a,function(d){return o[d]=1}),a=o),e){o={};for(u in a)o[u]=e(a[u]);a=o}_addModifiers(c,a)}}}},gsap=_gsap.registerPlugin({name:"attr",init:function n(t,e,s,r,a){var h,c,o;this.tween=s;for(h in e)o=t.getAttribute(h)||"",c=this.add(t,"setAttribute",(o||0)+"",e[h],r,a,0,0,h),c.op=h,c.b=o,this._props.push(h)},render:function n(t,e){for(var s=e._pt;s;)_reverting$1?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",init:function n(t,e){for(var s=e.length;s--;)this.add(t,s,t[s]||0,e[s],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween$1.version=Timeline.version=gsap.version="3.11.4";_coreReady=1;_windowExists$1()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _win,_doc,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists=function n(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function n(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},_renderPropWithEnd=function n(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},_renderCSSPropWithBeginning=function n(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},_renderRoundedCSSProp=function n(t,e){var s=e.s+e.c*t;e.set(e.t,e.p,~~(s+(s<0?-.5:.5))+e.u,e)},_renderNonTweeningValue=function n(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},_renderNonTweeningValueOnlyAtEnd=function n(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},_setterCSSStyle=function n(t,e,s){return t.style[e]=s},_setterCSSProp=function n(t,e,s){return t.style.setProperty(e,s)},_setterTransform=function n(t,e,s){return t._gsap[e]=s},_setterScale=function n(t,e,s){return t._gsap.scaleX=t._gsap.scaleY=s},_setterScaleWithRender=function n(t,e,s,r,a){var h=t._gsap;h.scaleX=h.scaleY=s,h.renderTransform(a,h)},_setterTransformWithRender=function n(t,e,s,r,a){var h=t._gsap;h[e]=s,h.renderTransform(a,h)},_transformProp="transform",_transformOriginProp=_transformProp+"Origin",_saveStyle=function n(t,e){var s=this,r=this.target,a=r.style;if(t in _transformProps){if(this.tfm=this.tfm||{},t!=="transform"&&(t=_propertyAliases[t]||t,~t.indexOf(",")?t.split(",").forEach(function(h){return s.tfm[h]=_get(r,h)}):this.tfm[t]=r._gsap.x?r._gsap[t]:_get(r,t)),this.props.indexOf(_transformProp)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,e,"")),t=_transformProp}(a||e)&&this.props.push(t,e,a[t])},_removeIndependentTransforms=function n(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},_revertStyle=function n(){var t=this.props,e=this.target,s=e.style,r=e._gsap,a,h;for(a=0;a<t.length;a+=3)t[a+1]?e[t[a]]=t[a+2]:t[a+2]?s[t[a]]=t[a+2]:s.removeProperty(t[a].replace(_capsExp,"-$1").toLowerCase());if(this.tfm){for(h in this.tfm)r[h]=this.tfm[h];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),a=_reverting(),a&&!a.isStart&&!s[_transformProp]&&(_removeIndependentTransforms(s),r.uncache=1)}},_getStyleSaver=function n(t,e){var s={target:t,props:[],revert:_revertStyle,save:_saveStyle};return e&&e.split(",").forEach(function(r){return s.save(r)}),s},_supports3D,_createElement=function n(t,e){var s=_doc.createElementNS?_doc.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):_doc.createElement(t);return s.style?s:_doc.createElement(t)},_getComputedProperty=function n(t,e,s){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(_capsExp,"-$1").toLowerCase())||r.getPropertyValue(e)||!s&&n(t,_checkPropPrefix(e)||e,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function n(t,e,s){var r=e||_tempDiv,a=r.style,h=5;if(t in a&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);h--&&!(_prefixes[h]+t in a););return h<0?null:(h===3?"ms":h>=0?_prefixes[h]:"")+t},_initCore=function n(){_windowExists()&&window.document&&(_win=window,_doc=_win.document,_docElement=_doc.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp=_checkPropPrefix(_transformProp),_transformOriginProp=_transformProp+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap.core.reverting,_pluginInitted=1)},_getBBoxHack=function n(t){var e=_createElement("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,r=this.nextSibling,a=this.style.cssText,h;if(_docElement.appendChild(e),e.appendChild(this),this.style.display="block",t)try{h=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(h=this._gsapBBox());return s&&(r?s.insertBefore(this,r):s.appendChild(this)),_docElement.removeChild(e),this.style.cssText=a,h},_getAttributeFallbacks=function n(t,e){for(var s=e.length;s--;)if(t.hasAttribute(e[s]))return t.getAttribute(e[s])},_getBBox=function n(t){var e;try{e=t.getBBox()}catch{e=_getBBoxHack.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===_getBBoxHack||(e=_getBBoxHack.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+_getAttributeFallbacks(t,["x","cx","x1"])||0,y:+_getAttributeFallbacks(t,["y","cy","y1"])||0,width:0,height:0}:e},_isSVG=function n(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&_getBBox(t))},_removeProperty=function n(t,e){if(e){var s=t.style;e in _transformProps&&e!==_transformOriginProp&&(e=_transformProp),s.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),s.removeProperty(e.replace(_capsExp,"-$1").toLowerCase())):s.removeAttribute(e)}},_addNonTweeningPT=function n(t,e,s,r,a,h){var c=new PropTween(t._pt,e,s,0,1,h?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return t._pt=c,c.b=r,c.e=a,t._props.push(s),c},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function n(t,e,s,r){var a=parseFloat(s)||0,h=(s+"").trim().substr((a+"").length)||"px",c=_tempDiv.style,o=_horizontalExp.test(e),u=t.tagName.toLowerCase()==="svg",d=(u?"client":"offset")+(o?"Width":"Height"),m=100,p=r==="px",g=r==="%",_,y,v,U;return r===h||!a||_nonConvertibleUnits[r]||_nonConvertibleUnits[h]?a:(h!=="px"&&!p&&(a=n(t,e,s,"px")),U=t.getCTM&&_isSVG(t),(g||h==="%")&&(_transformProps[e]||~e.indexOf("adius"))?(_=U?t.getBBox()[o?"width":"height"]:t[d],_round(g?a/_*m:a/100*_)):(c[o?"width":"height"]=m+(p?h:r),y=~e.indexOf("adius")||r==="em"&&t.appendChild&&!u?t:t.parentNode,U&&(y=(t.ownerSVGElement||{}).parentNode),(!y||y===_doc||!y.appendChild)&&(y=_doc.body),v=y._gsap,v&&g&&v.width&&o&&v.time===_ticker.time&&!v.uncache?_round(a/v.width*m):((g||h==="%")&&!_nonStandardLayouts[_getComputedProperty(y,"display")]&&(c.position=_getComputedProperty(t,"position")),y===t&&(c.position="static"),y.appendChild(_tempDiv),_=_tempDiv[d],y.removeChild(_tempDiv),c.position="absolute",o&&g&&(v=_getCache(y),v.time=_ticker.time,v.width=y[d]),_round(p?_*a/m:_&&a?m/_*a:0))))},_get=function n(t,e,s,r){var a;return _pluginInitted||_initCore(),e in _propertyAliases&&e!=="transform"&&(e=_propertyAliases[e],~e.indexOf(",")&&(e=e.split(",")[0])),_transformProps[e]&&e!=="transform"?(a=_parseTransform(t,r),a=e!=="transformOrigin"?a[e]:a.svg?a.origin:_firstTwoOnly(_getComputedProperty(t,_transformOriginProp))+" "+a.zOrigin+"px"):(a=t.style[e],(!a||a==="auto"||r||~(a+"").indexOf("calc("))&&(a=_specialProps[e]&&_specialProps[e](t,e,s)||_getComputedProperty(t,e)||_getProperty(t,e)||(e==="opacity"?1:0))),s&&!~(a+"").trim().indexOf(" ")?_convertToUnit(t,e,a,s)+s:a},_tweenComplexCSSString=function n(t,e,s,r){if(!s||s==="none"){var a=_checkPropPrefix(e,t,1),h=a&&_getComputedProperty(t,a,1);h&&h!==s?(e=a,s=h):e==="borderColor"&&(s=_getComputedProperty(t,"borderTopColor"))}var c=new PropTween(this._pt,t.style,e,0,1,_renderComplexString),o=0,u=0,d,m,p,g,_,y,v,U,w,k,N,W;if(c.b=s,c.e=r,s+="",r+="",r==="auto"&&(t.style[e]=r,r=_getComputedProperty(t,e)||r,t.style[e]=s),d=[s,r],_colorStringFilter(d),s=d[0],r=d[1],p=s.match(_numWithUnitExp)||[],W=r.match(_numWithUnitExp)||[],W.length){for(;m=_numWithUnitExp.exec(r);)v=m[0],w=r.substring(o,m.index),_?_=(_+1)%5:(w.substr(-5)==="rgba("||w.substr(-5)==="hsla(")&&(_=1),v!==(y=p[u++]||"")&&(g=parseFloat(y)||0,N=y.substr((g+"").length),v.charAt(1)==="="&&(v=_parseRelative(g,v)+N),U=parseFloat(v),k=v.substr((U+"").length),o=_numWithUnitExp.lastIndex-k.length,k||(k=k||_config.units[e]||N,o===r.length&&(r+=k,c.e+=k)),N!==k&&(g=_convertToUnit(t,e,y,k)||0),c._pt={_next:c._pt,p:w||u===1?w:",",s:g,c:U-g,m:_&&_<4||e==="zIndex"?Math.round:0});c.c=o<r.length?r.substring(o,r.length):""}else c.r=e==="display"&&r==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(r)&&(c.e=0),this._pt=c,c},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function n(t){var e=t.split(" "),s=e[0],r=e[1]||"50%";return(s==="top"||s==="bottom"||r==="left"||r==="right")&&(t=s,s=r,r=t),e[0]=_keywordToPercent[s]||s,e[1]=_keywordToPercent[r]||r,e.join(" ")},_renderClearProps=function n(t,e){if(e.tween&&e.tween._time===e.tween._dur){var s=e.t,r=s.style,a=e.u,h=s._gsap,c,o,u;if(a==="all"||a===!0)r.cssText="",o=1;else for(a=a.split(","),u=a.length;--u>-1;)c=a[u],_transformProps[c]&&(o=1,c=c==="transformOrigin"?_transformOriginProp:_transformProp),_removeProperty(s,c);o&&(_removeProperty(s,_transformProp),h&&(h.svg&&s.removeAttribute("transform"),_parseTransform(s,1),h.uncache=1,_removeIndependentTransforms(r)))}},_specialProps={clearProps:function n(t,e,s,r,a){if(a.data!=="isFromStart"){var h=t._pt=new PropTween(t._pt,e,s,0,0,_renderClearProps);return h.u=r,h.pr=-10,h.tween=a,t._props.push(s),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function n(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},_getComputedTransformMatrixAsArray=function n(t){var e=_getComputedProperty(t,_transformProp);return _isNullTransform(e)?_identity2DMatrix:e.substr(7).match(_numExp).map(_round)},_getMatrix=function n(t,e){var s=t._gsap||_getCache(t),r=t.style,a=_getComputedTransformMatrixAsArray(t),h,c,o,u;return s.svg&&t.getAttribute("transform")?(o=t.transform.baseVal.consolidate().matrix,a=[o.a,o.b,o.c,o.d,o.e,o.f],a.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:a):(a===_identity2DMatrix&&!t.offsetParent&&t!==_docElement&&!s.svg&&(o=r.display,r.display="block",h=t.parentNode,(!h||!t.offsetParent)&&(u=1,c=t.nextElementSibling,_docElement.appendChild(t)),a=_getComputedTransformMatrixAsArray(t),o?r.display=o:_removeProperty(t,"display"),u&&(c?h.insertBefore(t,c):h?h.appendChild(t):_docElement.removeChild(t))),e&&a.length>6?[a[0],a[1],a[4],a[5],a[12],a[13]]:a)},_applySVGOrigin=function n(t,e,s,r,a,h){var c=t._gsap,o=a||_getMatrix(t,!0),u=c.xOrigin||0,d=c.yOrigin||0,m=c.xOffset||0,p=c.yOffset||0,g=o[0],_=o[1],y=o[2],v=o[3],U=o[4],w=o[5],k=e.split(" "),N=parseFloat(k[0])||0,W=parseFloat(k[1])||0,et,it,ft,mt;s?o!==_identity2DMatrix&&(it=g*v-_*y)&&(ft=N*(v/it)+W*(-y/it)+(y*w-v*U)/it,mt=N*(-_/it)+W*(g/it)-(g*w-_*U)/it,N=ft,W=mt):(et=_getBBox(t),N=et.x+(~k[0].indexOf("%")?N/100*et.width:N),W=et.y+(~(k[1]||k[0]).indexOf("%")?W/100*et.height:W)),r||r!==!1&&c.smooth?(U=N-u,w=W-d,c.xOffset=m+(U*g+w*y)-U,c.yOffset=p+(U*_+w*v)-w):c.xOffset=c.yOffset=0,c.xOrigin=N,c.yOrigin=W,c.smooth=!!r,c.origin=e,c.originIsAbsolute=!!s,t.style[_transformOriginProp]="0px 0px",h&&(_addNonTweeningPT(h,c,"xOrigin",u,N),_addNonTweeningPT(h,c,"yOrigin",d,W),_addNonTweeningPT(h,c,"xOffset",m,c.xOffset),_addNonTweeningPT(h,c,"yOffset",p,c.yOffset)),t.setAttribute("data-svg-origin",N+" "+W)},_parseTransform=function n(t,e){var s=t._gsap||new GSCache(t);if("x"in s&&!e&&!s.uncache)return s;var r=t.style,a=s.scaleX<0,h="px",c="deg",o=getComputedStyle(t),u=_getComputedProperty(t,_transformOriginProp)||"0",d,m,p,g,_,y,v,U,w,k,N,W,et,it,ft,mt,xt,yt,vt,St,wt,Ct,It,Pt,Xt,Ut,Et,Ft,Lt,Ht,Wt,Zt;return d=m=p=y=v=U=w=k=N=0,g=_=1,s.svg=!!(t.getCTM&&_isSVG(t)),o.translate&&((o.translate!=="none"||o.scale!=="none"||o.rotate!=="none")&&(r[_transformProp]=(o.translate!=="none"?"translate3d("+(o.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(o.rotate!=="none"?"rotate("+o.rotate+") ":"")+(o.scale!=="none"?"scale("+o.scale.split(" ").join(",")+") ":"")+(o[_transformProp]!=="none"?o[_transformProp]:"")),r.scale=r.rotate=r.translate="none"),it=_getMatrix(t,s.svg),s.svg&&(s.uncache?(Xt=t.getBBox(),u=s.xOrigin-Xt.x+"px "+(s.yOrigin-Xt.y)+"px",Pt=""):Pt=!e&&t.getAttribute("data-svg-origin"),_applySVGOrigin(t,Pt||u,!!Pt||s.originIsAbsolute,s.smooth!==!1,it)),W=s.xOrigin||0,et=s.yOrigin||0,it!==_identity2DMatrix&&(yt=it[0],vt=it[1],St=it[2],wt=it[3],d=Ct=it[4],m=It=it[5],it.length===6?(g=Math.sqrt(yt*yt+vt*vt),_=Math.sqrt(wt*wt+St*St),y=yt||vt?_atan2(vt,yt)*_RAD2DEG:0,w=St||wt?_atan2(St,wt)*_RAD2DEG+y:0,w&&(_*=Math.abs(Math.cos(w*_DEG2RAD))),s.svg&&(d-=W-(W*yt+et*St),m-=et-(W*vt+et*wt))):(Zt=it[6],Ht=it[7],Et=it[8],Ft=it[9],Lt=it[10],Wt=it[11],d=it[12],m=it[13],p=it[14],ft=_atan2(Zt,Lt),v=ft*_RAD2DEG,ft&&(mt=Math.cos(-ft),xt=Math.sin(-ft),Pt=Ct*mt+Et*xt,Xt=It*mt+Ft*xt,Ut=Zt*mt+Lt*xt,Et=Ct*-xt+Et*mt,Ft=It*-xt+Ft*mt,Lt=Zt*-xt+Lt*mt,Wt=Ht*-xt+Wt*mt,Ct=Pt,It=Xt,Zt=Ut),ft=_atan2(-St,Lt),U=ft*_RAD2DEG,ft&&(mt=Math.cos(-ft),xt=Math.sin(-ft),Pt=yt*mt-Et*xt,Xt=vt*mt-Ft*xt,Ut=St*mt-Lt*xt,Wt=wt*xt+Wt*mt,yt=Pt,vt=Xt,St=Ut),ft=_atan2(vt,yt),y=ft*_RAD2DEG,ft&&(mt=Math.cos(ft),xt=Math.sin(ft),Pt=yt*mt+vt*xt,Xt=Ct*mt+It*xt,vt=vt*mt-yt*xt,It=It*mt-Ct*xt,yt=Pt,Ct=Xt),v&&Math.abs(v)+Math.abs(y)>359.9&&(v=y=0,U=180-U),g=_round(Math.sqrt(yt*yt+vt*vt+St*St)),_=_round(Math.sqrt(It*It+Zt*Zt)),ft=_atan2(Ct,It),w=Math.abs(ft)>2e-4?ft*_RAD2DEG:0,N=Wt?1/(Wt<0?-Wt:Wt):0),s.svg&&(Pt=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(t,_transformProp)),Pt&&t.setAttribute("transform",Pt))),Math.abs(w)>90&&Math.abs(w)<270&&(a?(g*=-1,w+=y<=0?180:-180,y+=y<=0?180:-180):(_*=-1,w+=w<=0?180:-180)),e=e||s.uncache,s.x=d-((s.xPercent=d&&(!e&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-d)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+h,s.y=m-((s.yPercent=m&&(!e&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-m)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+h,s.z=p+h,s.scaleX=_round(g),s.scaleY=_round(_),s.rotation=_round(y)+c,s.rotationX=_round(v)+c,s.rotationY=_round(U)+c,s.skewX=w+c,s.skewY=k+c,s.transformPerspective=N+h,(s.zOrigin=parseFloat(u.split(" ")[2])||0)&&(r[_transformOriginProp]=_firstTwoOnly(u)),s.xOffset=s.yOffset=0,s.force3D=_config.force3D,s.renderTransform=s.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,s.uncache=0,s},_firstTwoOnly=function n(t){return(t=t.split(" "))[0]+" "+t[1]},_addPxTranslate=function n(t,e,s){var r=getUnit(e);return _round(parseFloat(e)+parseFloat(_convertToUnit(t,"x",s+"px",r)))+r},_renderNon3DTransforms=function n(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,_renderCSSTransforms(t,e)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function n(t,e){var s=e||this,r=s.xPercent,a=s.yPercent,h=s.x,c=s.y,o=s.z,u=s.rotation,d=s.rotationY,m=s.rotationX,p=s.skewX,g=s.skewY,_=s.scaleX,y=s.scaleY,v=s.transformPerspective,U=s.force3D,w=s.target,k=s.zOrigin,N="",W=U==="auto"&&t&&t!==1||U===!0;if(k&&(m!==_zeroDeg||d!==_zeroDeg)){var et=parseFloat(d)*_DEG2RAD,it=Math.sin(et),ft=Math.cos(et),mt;et=parseFloat(m)*_DEG2RAD,mt=Math.cos(et),h=_addPxTranslate(w,h,it*mt*-k),c=_addPxTranslate(w,c,-Math.sin(et)*-k),o=_addPxTranslate(w,o,ft*mt*-k+k)}v!==_zeroPx&&(N+="perspective("+v+_endParenthesis),(r||a)&&(N+="translate("+r+"%, "+a+"%) "),(W||h!==_zeroPx||c!==_zeroPx||o!==_zeroPx)&&(N+=o!==_zeroPx||W?"translate3d("+h+", "+c+", "+o+") ":"translate("+h+", "+c+_endParenthesis),u!==_zeroDeg&&(N+="rotate("+u+_endParenthesis),d!==_zeroDeg&&(N+="rotateY("+d+_endParenthesis),m!==_zeroDeg&&(N+="rotateX("+m+_endParenthesis),(p!==_zeroDeg||g!==_zeroDeg)&&(N+="skew("+p+", "+g+_endParenthesis),(_!==1||y!==1)&&(N+="scale("+_+", "+y+_endParenthesis),w.style[_transformProp]=N||"translate(0, 0)"},_renderSVGTransforms=function n(t,e){var s=e||this,r=s.xPercent,a=s.yPercent,h=s.x,c=s.y,o=s.rotation,u=s.skewX,d=s.skewY,m=s.scaleX,p=s.scaleY,g=s.target,_=s.xOrigin,y=s.yOrigin,v=s.xOffset,U=s.yOffset,w=s.forceCSS,k=parseFloat(h),N=parseFloat(c),W,et,it,ft,mt;o=parseFloat(o),u=parseFloat(u),d=parseFloat(d),d&&(d=parseFloat(d),u+=d,o+=d),o||u?(o*=_DEG2RAD,u*=_DEG2RAD,W=Math.cos(o)*m,et=Math.sin(o)*m,it=Math.sin(o-u)*-p,ft=Math.cos(o-u)*p,u&&(d*=_DEG2RAD,mt=Math.tan(u-d),mt=Math.sqrt(1+mt*mt),it*=mt,ft*=mt,d&&(mt=Math.tan(d),mt=Math.sqrt(1+mt*mt),W*=mt,et*=mt)),W=_round(W),et=_round(et),it=_round(it),ft=_round(ft)):(W=m,ft=p,et=it=0),(k&&!~(h+"").indexOf("px")||N&&!~(c+"").indexOf("px"))&&(k=_convertToUnit(g,"x",h,"px"),N=_convertToUnit(g,"y",c,"px")),(_||y||v||U)&&(k=_round(k+_-(_*W+y*it)+v),N=_round(N+y-(_*et+y*ft)+U)),(r||a)&&(mt=g.getBBox(),k=_round(k+r/100*mt.width),N=_round(N+a/100*mt.height)),mt="matrix("+W+","+et+","+it+","+ft+","+k+","+N+")",g.setAttribute("transform",mt),w&&(g.style[_transformProp]=mt)},_addRotationalPropTween=function n(t,e,s,r,a){var h=360,c=_isString(a),o=parseFloat(a)*(c&&~a.indexOf("rad")?_RAD2DEG:1),u=o-r,d=r+u+"deg",m,p;return c&&(m=a.split("_")[1],m==="short"&&(u%=h,u!==u%(h/2)&&(u+=u<0?h:-h)),m==="cw"&&u<0?u=(u+h*_bigNum)%h-~~(u/h)*h:m==="ccw"&&u>0&&(u=(u-h*_bigNum)%h-~~(u/h)*h)),t._pt=p=new PropTween(t._pt,e,s,r,u,_renderPropWithEnd),p.e=d,p.u="deg",t._props.push(s),p},_assign=function n(t,e){for(var s in e)t[s]=e[s];return t},_addRawTransformPTs=function n(t,e,s){var r=_assign({},s._gsap),a="perspective,force3D,transformOrigin,svgOrigin",h=s.style,c,o,u,d,m,p,g,_;r.svg?(u=s.getAttribute("transform"),s.setAttribute("transform",""),h[_transformProp]=e,c=_parseTransform(s,1),_removeProperty(s,_transformProp),s.setAttribute("transform",u)):(u=getComputedStyle(s)[_transformProp],h[_transformProp]=e,c=_parseTransform(s,1),h[_transformProp]=u);for(o in _transformProps)u=r[o],d=c[o],u!==d&&a.indexOf(o)<0&&(g=getUnit(u),_=getUnit(d),m=g!==_?_convertToUnit(s,o,u,_):parseFloat(u),p=parseFloat(d),t._pt=new PropTween(t._pt,c,o,m,p-m,_renderCSSProp),t._pt.u=_||0,t._props.push(o));_assign(c,r)};_forEachName("padding,margin,Width,Radius",function(n,t){var e="Top",s="Right",r="Bottom",a="Left",h=(t<3?[e,s,r,a]:[e+a,e+s,r+s,r+a]).map(function(c){return t<2?n+c:"border"+c+n});_specialProps[t>1?"border"+n:n]=function(c,o,u,d,m){var p,g;if(arguments.length<4)return p=h.map(function(_){return _get(c,_,u)}),g=p.join(" "),g.split(p[0]).length===5?p[0]:g;p=(d+"").split(" "),g={},h.forEach(function(_,y){return g[_]=p[y]=p[y]||p[(y-1)/2|0]}),c.init(o,g,m)}});var CSSPlugin={name:"css",register:_initCore,targetTest:function n(t){return t.style&&t.nodeType},init:function n(t,e,s,r,a){var h=this._props,c=t.style,o=s.vars.startAt,u,d,m,p,g,_,y,v,U,w,k,N,W,et,it,ft;_pluginInitted||_initCore(),this.styles=this.styles||_getStyleSaver(t),ft=this.styles.props,this.tween=s;for(y in e)if(y!=="autoRound"&&(d=e[y],!(_plugins[y]&&_checkPlugin(y,e,s,r,t,a)))){if(g=typeof d,_=_specialProps[y],g==="function"&&(d=d.call(s,r,t,a),g=typeof d),g==="string"&&~d.indexOf("random(")&&(d=_replaceRandom(d)),_)_(this,t,y,d,s)&&(it=1);else if(y.substr(0,2)==="--")u=(getComputedStyle(t).getPropertyValue(y)+"").trim(),d+="",_colorExp.lastIndex=0,_colorExp.test(u)||(v=getUnit(u),U=getUnit(d)),U?v!==U&&(u=_convertToUnit(t,y,u,U)+U):v&&(d+=v),this.add(c,"setProperty",u,d,r,a,0,0,y),h.push(y),ft.push(y,0,c[y]);else if(g!=="undefined"){if(o&&y in o?(u=typeof o[y]=="function"?o[y].call(s,r,t,a):o[y],_isString(u)&&~u.indexOf("random(")&&(u=_replaceRandom(u)),getUnit(u+"")||(u+=_config.units[y]||getUnit(_get(t,y))||""),(u+"").charAt(1)==="="&&(u=_get(t,y))):u=_get(t,y),p=parseFloat(u),w=g==="string"&&d.charAt(1)==="="&&d.substr(0,2),w&&(d=d.substr(2)),m=parseFloat(d),y in _propertyAliases&&(y==="autoAlpha"&&(p===1&&_get(t,"visibility")==="hidden"&&m&&(p=0),ft.push("visibility",0,c.visibility),_addNonTweeningPT(this,c,"visibility",p?"inherit":"hidden",m?"inherit":"hidden",!m)),y!=="scale"&&y!=="transform"&&(y=_propertyAliases[y],~y.indexOf(",")&&(y=y.split(",")[0]))),k=y in _transformProps,k){if(this.styles.save(y),N||(W=t._gsap,W.renderTransform&&!e.parseTransform||_parseTransform(t,e.parseTransform),et=e.smoothOrigin!==!1&&W.smooth,N=this._pt=new PropTween(this._pt,c,_transformProp,0,1,W.renderTransform,W,0,-1),N.dep=1),y==="scale")this._pt=new PropTween(this._pt,W,"scaleY",W.scaleY,(w?_parseRelative(W.scaleY,w+m):m)-W.scaleY||0,_renderCSSProp),this._pt.u=0,h.push("scaleY",y),y+="X";else if(y==="transformOrigin"){ft.push(_transformOriginProp,0,c[_transformOriginProp]),d=_convertKeywordsToPercentages(d),W.svg?_applySVGOrigin(t,d,0,et,0,this):(U=parseFloat(d.split(" ")[2])||0,U!==W.zOrigin&&_addNonTweeningPT(this,W,"zOrigin",W.zOrigin,U),_addNonTweeningPT(this,c,y,_firstTwoOnly(u),_firstTwoOnly(d)));continue}else if(y==="svgOrigin"){_applySVGOrigin(t,d,1,et,0,this);continue}else if(y in _rotationalProperties){_addRotationalPropTween(this,W,y,p,w?_parseRelative(p,w+d):d);continue}else if(y==="smoothOrigin"){_addNonTweeningPT(this,W,"smooth",W.smooth,d);continue}else if(y==="force3D"){W[y]=d;continue}else if(y==="transform"){_addRawTransformPTs(this,d,t);continue}}else y in c||(y=_checkPropPrefix(y)||y);if(k||(m||m===0)&&(p||p===0)&&!_complexExp.test(d)&&y in c)v=(u+"").substr((p+"").length),m||(m=0),U=getUnit(d)||(y in _config.units?_config.units[y]:v),v!==U&&(p=_convertToUnit(t,y,u,U)),this._pt=new PropTween(this._pt,k?W:c,y,p,(w?_parseRelative(p,w+m):m)-p,!k&&(U==="px"||y==="zIndex")&&e.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=U||0,v!==U&&U!=="%"&&(this._pt.b=u,this._pt.r=_renderCSSPropWithBeginning);else if(y in c)_tweenComplexCSSString.call(this,t,y,u,w?w+d:d);else if(y in t)this.add(t,y,u||t[y],w?w+d:d,r,a);else if(y!=="parseTransform"){_missingPlugin(y,d);continue}k||(y in c?ft.push(y,0,c[y]):ft.push(y,1,u||t[y])),h.push(y)}}it&&_sortPropTweensByPriority(this)},render:function n(t,e){if(e.tween._time||!_reverting())for(var s=e._pt;s;)s.r(t,s.d),s=s._next;else e.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function n(t,e,s){var r=_propertyAliases[e];return r&&r.indexOf(",")<0&&(e=r),e in _transformProps&&e!==_transformOriginProp&&(t._gsap.x||_get(t,"x"))?s&&_recentSetterPlugin===s?e==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=s||{})&&(e==="scale"?_setterScaleWithRender:_setterTransformWithRender):t.style&&!_isUndefined(t.style[e])?_setterCSSStyle:~e.indexOf("-")?_setterCSSProp:_getSetter(t,e)},core:{_removeProperty,_getMatrix}};gsap.utils.checkPrefix=_checkPropPrefix;gsap.core.getStyleSaver=_getStyleSaver;(function(n,t,e,s){var r=_forEachName(n+","+t+","+e,function(a){_transformProps[a]=1});_forEachName(t,function(a){_config.units[a]="deg",_rotationalProperties[a]=1}),_propertyAliases[r[13]]=n+","+t,_forEachName(s,function(a){var h=a.split(":");_propertyAliases[h[1]]=r[h[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){_config.units[n]="px"});gsap.registerPlugin(CSSPlugin);var gsapWithCSS=gsap.registerPlugin(CSSPlugin)||gsap;gsapWithCSS.core.Tween;class Responsive{constructor(){gt(this,"isDesktop",!0)}get getIsDesktop(){return this.isDesktop}checkResponsive(t){if(t<=980){this.isDesktop=!1;return}this.isDesktop=!0}}const responsive=new Responsive;class PlayerSkin extends Container{constructor(){super();gt(this,"spine");gt(this,"container");this.container=new Container,this.addChild(this.container);const e=Assets.cache.get("common/skins/R10_Character_3QRT.skel");this.spine=new Spine(e.spineData),this.spine.autoUpdate=!0,this.spine.scale.set(.11),this.spine.x=-15,this.spine.y=260,this.container.addChild(this.spine),this.init(),this.container.pivot.y=this.container.height/2,responsive.getIsDesktop?this.scale.set(1):this.scale.set(.8)}init(){this.spine.state.setAnimation(0,"Idle_1",!0)}playFreestyle(){this.spine.state.setAnimation(0,"Idle_1",!0)}crashPlayer(){this.spine.state.setAnimation(0,"Idle_1",!0)}cashoutPlayer(){this.spine.state.setAnimation(0,"Idle_1",!1)}async show(e=!0){gsapWithCSS.killTweensOf(this.container.scale),this.visible=!0,e?(this.container.scale.set(0),await gsapWithCSS.to(this.container.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.container.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.container.scale),e?await gsapWithCSS.to(this.container.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.container.scale.set(0),this.visible=!1}}function waitFor(n=1){return new Promise(t=>{setTimeout(()=>t(),n*1e3)})}let O;function nt(n){return O=n,n}function l(){return O}let ot=0;const F=class extends eventemitter3Exports{constructor(n){super(),this.id=ot++,this.init(n)}set(n,t){if(this[n]===void 0)throw new Error(`Property with name ${n} does not exist.`);switch(n){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:n}=this._source;return n/this._duration}get paused(){return this._paused}set paused(n){this._paused=n,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(n){this._playing=!1,this._duration=n.source.duration;const t=this._source=n.source.cloneNode(!1);t.src=n.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),n.context.on("refresh",this.refresh,this),n.context.on("refreshPaused",this.refreshPaused,this),this._media=n}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(n){this._speed=n,this.refresh()}get volume(){return this._volume}set volume(n){this._volume=n,this.refresh()}get loop(){return this._loop}set loop(n){this._loop=n,this.refresh()}get muted(){return this._muted}set muted(n){this._muted=n,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(n){console.warn("HTML Audio does not support filters")}refresh(){const n=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=n.volume*(n.muted?0:1),s=t.volume*(t.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*e*s,this._source.playbackRate=this._speed*n.speed*t.speed}refreshPaused(){const n=this._media.context,t=this._media.parent,e=this._paused||t.paused||n.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(n){const{start:t,end:e,speed:s,loop:r,volume:a,muted:h}=n;e&&console.assert(e>t,"End time is before start time"),this._speed=s,this._volume=a,this._loop=!!r,this._muted=h,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-F.PADDING),this._end=Math.min(this._end+F.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),Ticker.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){Ticker.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){Ticker.shared.remove(this._onUpdate,this),this.removeAllListeners();const n=this._source;n&&(n.onended=null,n.onplay=null,n.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let E=F;E.PADDING=.1;class M extends eventemitter3Exports{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new E(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,s=this.parent;if(e.readyState===4){s.isLoaded=!0;const o=s.autoPlayStart();t&&setTimeout(()=>{t(null,s,o)},0);return}if(!s.url){t(new Error("sound.url or sound.source must be set"));return}e.src=s.url;const r=()=>{c(),s.isLoaded=!0;const o=s.autoPlayStart();t&&t(null,s,o)},a=()=>{c(),t&&t(new Error("Sound loading has been aborted"))},h=()=>{c();const o=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(o)):console.error(o)},c=()=>{e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",a),e.removeEventListener("error",h)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",a,!1),e.addEventListener("error",h,!1),e.load()}}class I{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}class f{static setParamValue(t,e){if(t.setValueAtTime){const s=l().context;t.setValueAtTime(e,s.audioContext.currentTime)}else t.value=e;return e}}let at=0;class T extends eventemitter3Exports{constructor(t){super(),this.id=at++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(s=>s).forEach(s=>s.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const s=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),a=this._volume*(this._muted?0:1);f.setParamValue(this._gain.gain,a*r*s),f.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(s=>{e.connect(s.destination),e=s}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,s=this._paused||e.paused||t.paused;s!==this._pausedReal&&(this._pausedReal=s,s?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",s))}play(t){const{start:e,end:s,speed:r,loop:a,volume:h,muted:c,filters:o}=t;s&&console.assert(s>e,"End time is before start time"),this._paused=!1;const{source:u,gain:d}=this._media.nodes.cloneBufferSource();this._source=u,this._gain=d,this._speed=r,this._volume=h,this._loop=!!a,this._muted=c,this._filters=o,this.refresh();const m=this._source.buffer.duration;this._duration=m,this._end=s,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=s,this._source.loopStart=e,this._source.start(0,e)):s?this._source.start(0,e,s-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){Ticker.shared.remove(this._updateListener,this),t&&Ticker.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),s=e-this._lastUpdate;if(s>0||t){const r=this._source.playbackRate.value;this._elapsed+=s*r,this._lastUpdate=e;const a=this._duration;let h;if(this._source.loopStart){const c=this._source.loopEnd-this._source.loopStart;h=(this._source.loopStart+this._elapsed%c)/a}else h=this._elapsed%a/a;this._progress=h,this.emit("progress",this._progress,a)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class C{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(s=>{e===null?this._input.connect(s.destination):e.connect(s.destination),e=s}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const j=class extends C{constructor(n){const t=n.audioContext,e=t.createBufferSource(),s=t.createGain(),r=t.createAnalyser();e.connect(r),r.connect(s),s.connect(n.destination),super(r,s),this.context=n,this.bufferSource=e,this.gain=s,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(j.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const n=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=n.buffer,f.setParamValue(t.playbackRate,n.playbackRate.value),t.loop=n.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let L=j;L.BUFFER_SIZE=0;class A{init(t){this.parent=t,this._nodes=new L(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new T(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,s=await settings$1.ADAPTER.fetch(e);this._decode(await s.arrayBuffer(),t)}_decode(t,e){const s=(r,a)=>{if(r)e&&e(r);else{this.parent.isLoaded=!0,this.buffer=a;const h=this.parent.autoPlayStart();e&&e(null,this.parent,h)}};t instanceof AudioBuffer?s(null,t):this.parent.context.decode(t,s)}}var ut=Object.defineProperty,G=Object.getOwnPropertySymbols,ht=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,B=(n,t,e)=>t in n?ut(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,K=(n,t)=>{for(var e in t||(t={}))ht.call(t,e)&&B(n,e,t[e]);if(G)for(var e of G(t))lt.call(t,e)&&B(n,e,t[e]);return n};const b=class{static from(n){let t={};typeof n=="string"?t.url=n:n instanceof ArrayBuffer||n instanceof AudioBuffer||n instanceof HTMLAudioElement?t.source=n:t=n,t=K({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},t),Object.freeze(t);const e=l().useLegacy?new M:new A;return new b(e,t)}constructor(n,t){this.media=n,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}get context(){return l().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(n){this._paused=n,this.refreshPaused()}get speed(){return this._speed}set speed(n){this._speed=n,this.refresh()}get filters(){return this.media.filters}set filters(n){this.media.filters=n}addSprites(n,t){if(typeof n=="object"){const s={};for(const r in n)s[r]=this.addSprites(r,n[r]);return s}console.assert(!this._sprites[n],`Alias ${n} is already taken`);const e=new I(this,t);return this._sprites[n]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(n){if(n){const t=this._sprites[n];t!==void 0&&(t.destroy(),delete this._sprites[n])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let n=this._instances.length-1;n>=0;n--)this._instances[n].stop();return this}play(n,t){let e;if(typeof n=="string"?e={sprite:n,loop:this.loop,complete:t}:typeof n=="function"?(e={},e.complete=n):e=n,e=K({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},e||{}),e.sprite){const r=e.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);const a=this._sprites[r];e.start=a.start+(e.start||0),e.end=a.end,e.speed=a.speed||1,e.loop=a.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return new Promise((r,a)=>{this.autoPlay=!0,this._autoPlayOptions=e,this._preload((h,c,o)=>{h?a(h):(e.loaded&&e.loaded(h,c,o),r(o))})});(this.singleInstance||e.singleInstance)&&this._removeInstances();const s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",()=>{e.complete&&e.complete(this),this._onComplete(s)}),s.once("stop",()=>{this._onComplete(s)}),s.play(e),s}refresh(){const n=this._instances.length;for(let t=0;t<n;t++)this._instances[t].refresh()}refreshPaused(){const n=this._instances.length;for(let t=0;t<n;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(n){this._volume=n,this.refresh()}get muted(){return this._muted}set muted(n){this._muted=n,this.refresh()}get loop(){return this._loop}set loop(n){this._loop=n,this.refresh()}_preload(n){this.media.load(n)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let n;return this.autoPlay&&(n=this.play(this._autoPlayOptions)),n}_removeInstances(){for(let n=this._instances.length-1;n>=0;n--)this._poolInstance(this._instances[n]);this._instances.length=0}_onComplete(n){if(this._instances){const t=this._instances.indexOf(n);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(n)}_createInstance(){if(b._pool.length>0){const n=b._pool.pop();return n.init(this.media),n}return this.media.create()}_poolInstance(n){n.destroy(),b._pool.indexOf(n)<0&&b._pool.push(n)}};let x=b;x._pool=[];class R extends eventemitter3Exports{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class P extends C{constructor(){const t=window,e=new P.AudioContext,s=e.createDynamicsCompressor(),r=e.createAnalyser();r.connect(s),s.connect(e.destination),super(r,s),this._ctx=e,this._offlineCtx=new P.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this._unlocked=!1,this.compressor=s,this.analyser=r,this.events=new eventemitter3Exports,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,e.state!=="running"&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const s=a=>{e(new Error((a==null?void 0:a.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,a=>{e(null,a)},s);r&&r.catch(s)}}var ct=Object.defineProperty,D=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable,q=(n,t,e)=>t in n?ct(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,V=(n,t)=>{for(var e in t||(t={}))dt.call(t,e)&&q(n,e,t[e]);if(D)for(var e of D(t))pt.call(t,e)&&q(n,e,t[e]);return n};class H{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new P),this._htmlAudioContext=new R,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return P.AudioContext!==null}add(t,e){if(typeof t=="object"){const a={};for(const h in t){const c=this._getOptions(t[h],e);a[h]=this.add(h,c)}return a}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof x)return this._sounds[t]=e,e;const s=this._getOptions(e),r=x.from(s);return this._sounds[t]=r,r}_getOptions(t,e){let s;return typeof t=="string"?s={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?s={source:t}:s=t,s=V(V({},s),e||{}),s}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const s=!!this._sounds[t];return e&&console.assert(s,`No sound matching alias '${t}'.`),s}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const s=this.find(t);return e!==void 0&&(s.volume=e),s.volume}speed(t,e){const s=this.find(t);return e!==void 0&&(s.speed=e),s.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}var $t=Object.defineProperty,z=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable,Z=(n,t,e)=>t in n?$t(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Mt=(n,t)=>{for(var e in t||(t={}))kt.call(t,e)&&Z(n,e,t[e]);if(z)for(var e of z(t))Ot.call(t,e)&&Z(n,e,t[e]);return n};const $=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],S={};function Q(n){const t=Mt({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},n||{}),e=document.createElement("audio"),s={},r=/^no$/;$.forEach(a=>{const h=e.canPlayType(`audio/${a}`).replace(r,""),c=t[a]?e.canPlayType(t[a]).replace(r,""):"";s[a]=!!h||!!c}),Object.assign(S,s)}Q();var Tt=Object.defineProperty,jt=Object.defineProperties,Gt=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable,J=(n,t,e)=>t in n?Tt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Rt=(n,t)=>{for(var e in t||(t={}))Bt.call(t,e)&&J(n,e,t[e]);if(Y)for(var e of Y(t))Kt.call(t,e)&&J(n,e,t[e]);return n},Dt=(n,t)=>jt(n,Gt(t));const X=n=>{var t,e;const s=n.src;return(e=(t=n==null?void 0:n.alias)==null?void 0:t[0])!=null?e:path$1.basename(s,path$1.extname(s))},tt={extension:ExtensionType.Asset,detection:{test:async()=>!0,add:async n=>[...n,...$.filter(t=>S[t])],remove:async n=>n.filter(t=>n.includes(t))},loader:{extension:{type:[ExtensionType.LoadParser],priority:LoaderParserPriority.High},test(n){const t=path$1.extname(n).slice(1);return!!S[t]},async load(n,t){const e=await new Promise((s,r)=>x.from(Dt(Rt({},t.data),{url:n,preload:!0,loaded(a,h){var c,o;a?r(a):s(h),(o=(c=t.data)==null?void 0:c.loaded)==null||o.call(c,a,h)}})));return l().add(X(t),e),e},async unload(n,t){l().remove(X(t))}}};extensions$1.add(tt);const qt=nt(new H);class BGM{constructor(){gt(this,"currentAlias");gt(this,"current");gt(this,"volume",1)}async play(t,e){if(this.currentAlias!==t){if(this.current){const s=this.current;gsapWithCSS.killTweensOf(s),gsapWithCSS.to(s,{volume:0,duration:1,ease:"linear"}).then(()=>{s.stop()})}this.current=qt.find(t),this.currentAlias=t,this.current.play({loop:!0,...e}),this.current.volume=0,gsapWithCSS.killTweensOf(this.current),gsapWithCSS.to(this.current,{volume:this.volume,duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(t){this.volume=t,this.current&&(this.current.volume=this.volume)}}class SFX{constructor(){gt(this,"volume",1)}play(t,e){const s=this.volume*((e==null?void 0:e.volume)??1);qt.play(t,{...e,volume:s})}getVolume(){return this.volume}setVolume(t){this.volume=t}}function setMasterVolume(n){qt.volumeAll=n,n?qt.unmuteAll():qt.muteAll()}const bgm=new BGM,sfx=new SFX;class Animation{constructor(){gt(this,"isAnimation",!0)}getAnimation(){return this.isAnimation}setAnimation(t){this.isAnimation=t}}const animation=new Animation,defaultLabelStyle={fontFamily:"Epilogue Regular",fill:16777215,align:"left"};class Label extends Text{constructor(t,e,s=!0,r){e={...defaultLabelStyle,...e},super(t,e,r),s&&this.anchor.set(.5)}}const defaultFsLogoOptions={scale:.8};class FsLogo extends Container{constructor(e={}){super();gt(this,"image");const s={...defaultFsLogoOptions,...e};this.image=Sprite.from("logo-fs"),this.image.scale.set(s.scale),this.image.anchor.set(.5),this.addChild(this.image)}}var dist={},Collector$1={};Object.defineProperty(Collector$1,"__esModule",{value:!0});Collector$1.Collector=void 0;class Collector{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}Collector$1.Collector=Collector;var CollectorArray$1={};Object.defineProperty(CollectorArray$1,"__esModule",{value:!0});CollectorArray$1.CollectorArray=void 0;const Collector_1$3=Collector$1;class CollectorArray extends Collector_1$3.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}CollectorArray$1.CollectorArray=CollectorArray;var CollectorLast$1={};Object.defineProperty(CollectorLast$1,"__esModule",{value:!0});CollectorLast$1.CollectorLast=void 0;const Collector_1$2=Collector$1;class CollectorLast extends Collector_1$2.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}CollectorLast$1.CollectorLast=CollectorLast;var CollectorUntil0$1={};Object.defineProperty(CollectorUntil0$1,"__esModule",{value:!0});CollectorUntil0$1.CollectorUntil0=void 0;const Collector_1$1=Collector$1;class CollectorUntil0 extends Collector_1$1.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}CollectorUntil0$1.CollectorUntil0=CollectorUntil0;var CollectorWhile0$1={};Object.defineProperty(CollectorWhile0$1,"__esModule",{value:!0});CollectorWhile0$1.CollectorWhile0=void 0;const Collector_1=Collector$1;class CollectorWhile0 extends Collector_1.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}CollectorWhile0$1.CollectorWhile0=CollectorWhile0;var Signal$1={},SignalConnection={};Object.defineProperty(SignalConnection,"__esModule",{value:!0});SignalConnection.SignalConnectionImpl=void 0;class SignalConnectionImpl{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}}SignalConnection.SignalConnectionImpl=SignalConnectionImpl;var SignalLink$1={};Object.defineProperty(SignalLink$1,"__esModule",{value:!0});SignalLink$1.SignalLink=void 0;class SignalLink{constructor(t=null,e=null,s=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=s}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let s=this.prev;for(;s!==this&&!(s.order<=e);)s=s.prev;const r=new SignalLink(s,s.next,e);return r.callback=t,s.next=r,r.next.prev=r,r}}SignalLink$1.SignalLink=SignalLink;Object.defineProperty(Signal$1,"__esModule",{value:!0});Signal$1.Signal=void 0;const SignalConnection_1=SignalConnection,SignalLink_1=SignalLink$1;class Signal{constructor(){this.head=new SignalLink_1.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const s=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,s.newLink=!0),new SignalConnection_1.SignalConnectionImpl(s,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let s=this.head.next;s!==this.head;s=s.next)if(s.isEnabled()&&s.callback){const r=s.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}Signal$1.Signal=Signal;var SignalConnections$1={};Object.defineProperty(SignalConnections$1,"__esModule",{value:!0});SignalConnections$1.SignalConnections=void 0;class SignalConnections{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}SignalConnections$1.SignalConnections=SignalConnections;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SignalConnections=n.Signal=n.CollectorWhile0=n.CollectorUntil0=n.CollectorLast=n.CollectorArray=n.Collector=void 0;var t=Collector$1;Object.defineProperty(n,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=CollectorArray$1;Object.defineProperty(n,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var s=CollectorLast$1;Object.defineProperty(n,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=CollectorUntil0$1;Object.defineProperty(n,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var a=CollectorWhile0$1;Object.defineProperty(n,"CollectorWhile0",{enumerable:!0,get:function(){return a.CollectorWhile0}});var h=Signal$1;Object.defineProperty(n,"Signal",{enumerable:!0,get:function(){return h.Signal}});var c=SignalConnections$1;Object.defineProperty(n,"SignalConnections",{enumerable:!0,get:function(){return c.SignalConnections}})})(dist);let Button$1=class{constructor(t){this.view=t,this.createEvents(),this.enabled=!0}down(t){}up(t){}hover(t){}press(t){}out(t){}upOut(t){}get isDown(){return this._isDown}set enabled(t){this._enabled=t,this.view.interactive=t,this.view.cursor=t?"pointer":"default",t||this._processUp()}get enabled(){return this._enabled}_processUp(t){this._isDown&&this.onUp.emit(this,t),this._isDown=!1}_processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t)),this._isDown=!1}_processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t))}_upOut(t){this.upOut(t)}_out(t){this.out(t)}createEvents(){this.onPress=new dist.Signal,this.onDown=new dist.Signal,this.onUp=new dist.Signal,this.onHover=new dist.Signal,this.onOut=new dist.Signal,this.onUpOut=new dist.Signal,this.view.on("pointerdown",t=>{this._isDown=!0,this.onDown.emit(this,t)}),this.view.on("pointerup",t=>{this._processUp(t)}),this.view.on("pointerupoutside",t=>{this._processUpOut(t)}),this.view.on("pointerout",t=>{this._processOut(t)}),this.view.on("pointertap",t=>{this._isDown=!1,this.onPress.emit(this,t),this.press(t)}),this.view.on("pointerover",t=>{this._isMouseIn=!0,this.onHover.emit(this,t)}),this.onDown.connect((t,e)=>{this.down(e)}),this.onUp.connect((t,e)=>{this.up(e)}),this.onUpOut.connect((t,e)=>{this._upOut(e)}),isMobile.any||this.onHover.connect((t,e)=>{this.hover(e)}),this.onOut.connect((t,e)=>{this._out(e)})}};function getView(n){return typeof n=="string"?Sprite.from(n):n}class Switcher extends Container{constructor(t,e,s=0){super(),this.active=0,this.innerView=new Container,this.addChild(this.innerView),this.active=s,t.map((r,a)=>{const h=getView(r);return this.innerView.addChild(h),h.visible=a===s,h}),this.onChange=new dist.Signal,e?Array.isArray(e)?this.triggerEvents=new Set(e):this.triggerEvents=new Set([e]):this.triggerEvents=new Set(["onPress"]),this.events=new Button$1(this),this.events.onPress.connect(()=>this.switch(this.nextActive,"onPress")),this.events.onDown.connect(()=>this.switch(this.nextActive,"onDown")),this.events.onUp.connect(()=>this.switch(this.nextActive,"onUp")),this.events.onHover.connect(()=>this.switch(this.nextActive,"onHover")),this.events.onOut.connect(()=>this.switch(this.nextActive,"onOut")),this.events.onUpOut.connect(()=>this.switch(this.nextActive,"onUpOut"))}get activeView(){return this.views[this.active]}get views(){return this.innerView.children}switch(t,e){if(!this.triggerEvents.has(e))return;this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const s=this.views[this.active];s.visible=!0;const r=this.views.length>2?this.active:this.active===1;this.onChange.emit(r)}forceSwitch(t){this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const e=this.views[this.active];e.visible=!0}get nextActive(){return this.active<this.views.length-1?this.active+1:0}}function removeHitBox(...n){n.forEach(t=>t&&(t.hitArea=new Rectangle))}class ProgressBar extends Container{constructor({bg:t,fill:e,fillOffset:s,progress:r}){if(super(),this.progressStart=0,this._progress=0,this.innerView=new Container,this.addChild(this.innerView),this.bg=new Container,this.bg.addChild(getView(t)),this.innerView.addChild(this.bg),e){this.fill=new Container,this.fill.addChild(getView(e));const a=(s==null?void 0:s.x)??0,h=(s==null?void 0:s.y)??0;this.fill.x=(this.bg.width-this.fill.width)/2+a,this.fill.y=(this.bg.height-this.fill.height)/2+h,this.fillMask=new Graphics,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}this.progress=r}validate(t){return t=Math.round(t),t<0?0:t>100?100:t}set progress(t){this._progress=this.validate(t);const e=this.bg.width/100*this.progressStart,s=this.bg.width/100*this._progress-e;this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(e,0,s,this.fill.height)}get progress(){return this._progress}}class SliderBase extends ProgressBar{constructor(t){super({bg:t.bg,fill:t.fill??t.bg,fillOffset:t.fillOffset}),this.dragging=0,this.min=0,this.max=100,t.slider1&&(this.slider1=this.createSlider(t.slider1),t.showValue&&(this.value1Text=new Text("",t.valueTextStyle||{fill:16777215}),this.value1Text.anchor.set(.5),this.addChild(this.value1Text))),t.slider2&&(this.slider2=this.createSlider(t.slider2),t.showValue&&(this.value2Text=new Text("",t.valueTextStyle||{fill:16777215}),this.value2Text.anchor.set(.5),this.addChild(this.value2Text))),this.min=t.min??0,this.max=t.max??100,this.activate()}activate(){this.bg.interactive=!0,this.bg.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this),this.slider1&&(this.slider1.interactive=!0,this.slider1.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),this.slider2&&(this.slider2.interactive=!0,this.slider2.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),removeHitBox(this.fill,this.value1Text,this.value2Text)}createSlider(t){const e=getView(t);e.x=e.width/2;const s=new Container;return s.addChild(e),e instanceof Sprite&&e.anchor.set(.5),s.y=this.bg.height/2,this.addChild(s),s}startUpdate(t){this.dragging=1,this.update(t)}endUpdate(){this.dragging&&(this.dragging=0)}update(t){}}function getTextView(n){return n instanceof Text?n:new Text(n)}function fitToView(n,t,e=0){let s=t.scale.x,r=t.scale.y;const a=n.width-e*2,h=n.height-e*2,c=a-Math.round(t.width),o=h-Math.round(t.height);c<0&&(s=a/(t.width*s)),o<0&&(r=h/(t.height*r)),(s<=0||r<=0)&&(t.visible=!1),t.scale.set(Math.min(s,r))}/*!
 * tweedle.js - v2.0.1
 * Compiled Tue, 20 Dec 2022 14:21:53 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let NOW;typeof self>"u"&&typeof process<"u"&&process.hrtime?NOW=function(){const n=process.hrtime();return n[0]*1e3+n[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?NOW=self.performance.now.bind(self.performance):Date.now!==void 0?NOW=Date.now:NOW=function(){return new Date().getTime()};class Group{constructor(){Group.prototype.__init.call(this),Group.prototype.__init2.call(this),Group.prototype.__init3.call(this),Group.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Group._shared||(Group._shared=new Group),Group._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=NOW}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const a=this._tweens[s[r]];a&&a.update(t,!0)==!1&&!e&&delete this._tweens[s[r]]}return!0}}const Easing={Step:{None(n){return n<.5?0:1}},Linear:{None(n){return n}},Quadratic:{In(n){return n*n},Out(n){return n*(2-n)},InOut(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In(n){return n*n*n},Out(n){return--n*n*n+1},InOut(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In(n){return n*n*n*n},Out(n){return 1- --n*n*n*n},InOut(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In(n){return n*n*n*n*n},Out(n){return--n*n*n*n*n+1},InOut(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In(n){return 1-Math.cos(n*Math.PI/2)},Out(n){return Math.sin(n*Math.PI/2)},InOut(n){return .5*(1-Math.cos(Math.PI*n))}},Exponential:{In(n){return n==0?0:Math.pow(1024,n-1)},Out(n){return n==1?1:1-Math.pow(2,-10*n)},InOut(n){return n==0?0:n==1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}},Circular:{In(n){return 1-Math.sqrt(1-n*n)},Out(n){return Math.sqrt(1- --n*n)},InOut(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In(n){return n==0?0:n==1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out(n){return n==0?0:n==1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut(n){return n==0?0:n==1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}},Back:{In(n){return n*n*((1.70158+1)*n-1.70158)},Out(n){return--n*n*((1.70158+1)*n+1.70158)+1},InOut(n){const t=2.5949095;return(n*=2)<1?.5*(n*n*((t+1)*n-t)):.5*((n-=2)*n*((t+1)*n+t)+2)}},Bounce:{In(n){return 1-Easing.Bounce.Out(1-n)},Out(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut(n){return n<.5?Easing.Bounce.In(n*2)*.5:Easing.Bounce.Out(n*2-1)*.5+.5}}},Interpolation={Geom:{Linear(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.Linear;return t<0?a(n[0],n[1],s):t>1?a(n[e],n[e-1],e-s):a(n[r],n[r+1>e?e:r+1],s-r)},Bezier(n,t){let e=0;const s=n.length-1,r=Math.pow,a=Interpolation.Utils.Bernstein;for(let h=0;h<=s;h++)e+=a(s,h)*r(1-t,s-h)*r(t,h)*n[h];return e},QuadraticBezier(n,t){let e=0;const s=n.length-1;if(t==1)return n[s];const r=Math.pow,a=Interpolation.Utils.Bernstein,h=s*t,c=Math.floor(h),o=(h-c)*.5+.5*(c%2),u=c-c%2,d=u+1,m=u+2;return e+=a(2,0)*r(1-o,2-0)*r(o,0)*n[u],e+=a(2,1)*r(1-o,2-1)*r(o,1)*n[d],e+=a(2,2)*r(1-o,2-2)*r(o,2)*n[m],e},CubicBezier(n,t){let e=0;const s=n.length-1;if(t==1)return n[s];const r=Math.pow,a=Interpolation.Utils.Bernstein,h=s*t,c=Math.floor(h),o=(h-c)*(1/3)+1/3*(c%3),u=c-c%3,d=u+1,m=u+2,p=u+3;return e+=a(3,0)*r(1-o,3-0)*r(o,0)*n[u],e+=a(3,1)*r(1-o,3-1)*r(o,1)*n[d],e+=a(3,2)*r(1-o,3-2)*r(o,2)*n[m],e+=a(3,3)*r(1-o,3-3)*r(o,3)*n[p],e},CatmullRom(n,t){const e=n.length-1;let s=e*t,r=Math.floor(s);const a=Interpolation.Utils.CatmullRom;return n[0]==n[e]?(t<0&&(r=Math.floor(s=e*(1+t))),a(n[(r-1+e)%e],n[r],n[(r+1)%e],n[(r+2)%e],s-r)):t<0?n[0]-(a(n[0],n[0],n[1],n[1],-s)-n[0]):t>1?n[e]-(a(n[e],n[e],n[e-1],n[e-1],s-e)-n[e]):a(n[r?r-1:0],n[r],n[e<r+1?e:r+1],n[e<r+2?e:r+2],s-r)}},Angle:{Radians(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.WrapLinear;return t<0?a(n[0],n[1],s,2*Math.PI):t>1?a(n[e],n[e-1],e-s,2*Math.PI):a(n[r],n[r+1>e?e:r+1],s-r,2*Math.PI)},Degrees(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.WrapLinear;return t<0?a(n[0],n[1],s,360):t>1?a(n[e],n[e-1],e-s,360):a(n[r],n[r+1>e?e:r+1],s-r,360)}},Color:{RGB(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.RGBLinear;return t<0?a(n[0],n[1],s):t>1?a(n[e],n[e-1],e-s):a(n[r],n[r+1>e?e:r+1],s-r)},HSV(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.HSVLinear;return t<0?a(n[0],n[1],s):t>1?a(n[e],n[e-1],e-s):a(n[r],n[r+1>e?e:r+1],s-r)},HCL(n,t){const e=n.length-1,s=e*t,r=Math.floor(s),a=Interpolation.Utils.HCLLinear;return t<0?a(n[0],n[1],s):t>1?a(n[e],n[e-1],e-s):a(n[r],n[r+1>e?e:r+1],s-r)}},Utils:{RGBsplit(n){const t=n>>24&255,e=n>>16&255,s=n>>8&255,r=n&255;return{a:t,r:e,g:s,b:r}},HSVsplit(n){const t=Interpolation.Utils.RGBsplit(n);t.r/=255,t.g/=255,t.b/=255;const e=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b);let r;const a=e,h=e-s,c=e==0?0:h/e;if(e==s)r=0;else{switch(e){case t.r:r=(t.g-t.b)/h+(t.g<t.b?6:0);break;case t.g:r=(t.b-t.r)/h+2;break;case t.b:r=(t.r-t.g)/h+4;break}r/=6}return{a:t.a,h:r,s:c,v:a}},HSVJoin(n){let t,e,s;const r=Math.floor(n.h*6),a=n.h*6-r,h=n.v*(1-n.s),c=n.v*(1-a*n.s),o=n.v*(1-(1-a)*n.s);switch(r%6){case 0:t=n.v,e=o,s=h;break;case 1:t=c,e=n.v,s=h;break;case 2:t=h,e=n.v,s=o;break;case 3:t=h,e=c,s=n.v;break;case 4:t=o,e=h,s=n.v;break;case 5:t=n.v,e=h,s=c;break}return n.a<<24|t<<16|e<<8|s},HCLSplit(n){const s=.530454533953517,r=Interpolation.Utils.RGBsplit(n),a={a:r.a,h:0,c:0,l:0};let h=0;const c=Math.min(r.r,Math.min(r.g,r.b)),o=Math.max(r.r,Math.max(r.g,r.b));let u=3/100;return a.c=o-c,a.c!=0&&(h=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,u*=c/o),u=Math.exp(u),a.h=(h/2-Math.min(h%1,-h%1)/6)%1,a.c*=u,a.l=Interpolation.Utils.Linear(-c,o,u)/(s*2),a},HCLJoin(n){const s=.530454533953517,r={a:n.a,r:0,g:0,b:0};if(n.l!=0){let a=n.h;const h=n.c,c=n.l*s,o=Math.exp((1-h/(2*c))*(3/100)),u=(2*c-h)/(2*o-1),d=h/o,m=(a+Math.min(2*a%1/4,-2*a%1/8))*Math.PI*2;let p;a*=6,a<=.999?(p=Math.tan(m),r.r=1,r.g=p/(1+p)):a<=1.001?(r.r=1,r.g=1):a<=2?(p=Math.tan(m),r.r=(1+p)/p,r.g=1):a<=3?(p=Math.tan(m),r.g=1,r.b=1+p):a<=3.999?(p=Math.tan(m),r.g=1/(1+p),r.b=1):a<=4.001?(r.g=0,r.b=1):a<=5?(p=Math.tan(m),r.r=-1/p,r.b=1):(p=Math.tan(m),r.r=1,r.b=-p),r.r=r.r*d+u,r.g=r.g*d+u,r.b=r.b*d+u}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(n,t,e,s){let r;return n=(n+s*Math.trunc(Math.abs(n/s)))%s,t=(t+s*Math.trunc(Math.abs(t/s)))%s,Math.abs(n-t)<=.5*s?r=Interpolation.Utils.Linear(n,t,e):(n<t?r=Interpolation.Utils.Linear(n+s,t,e):r=Interpolation.Utils.Linear(n,t+s,e),r=r%s),r},RGBLinear(n,t,e){const s=Interpolation.Utils.RGBsplit(n),r=Interpolation.Utils.RGBsplit(t),a=Interpolation.Utils.Linear(s.a,r.a,e),h=Interpolation.Utils.Linear(s.r,r.r,e),c=Interpolation.Utils.Linear(s.g,r.g,e),o=Interpolation.Utils.Linear(s.b,r.b,e);return a<<24|h<<16|c<<8|o},HSVLinear(n,t,e){const s=Interpolation.Utils.HSVsplit(n),r=Interpolation.Utils.HSVsplit(t);let a;Math.abs(s.h-r.h)<=.5?a=Interpolation.Utils.Linear(s.h,r.h,e):(s.h<r.h?a=Interpolation.Utils.Linear(s.h+1,r.h,e):a=Interpolation.Utils.Linear(s.h,r.h+1,e),a=a%1);const h=Interpolation.Utils.Linear(s.s,r.s,e),c=Interpolation.Utils.Linear(s.v,r.v,e),o=Interpolation.Utils.Linear(s.a,r.a,e);return Interpolation.Utils.HSVJoin({a:o,h:a,s:h,v:c})},HCLLinear(n,t,e){const s=Interpolation.Utils.HCLSplit(n),r=Interpolation.Utils.HCLSplit(t);let a;Math.abs(s.h-r.h)<=.5?a=Interpolation.Utils.Linear(s.h,r.h,e):(s.h<r.h?a=Interpolation.Utils.Linear(s.h+1,r.h,e):a=Interpolation.Utils.Linear(s.h,r.h+1,e),a=a%1);const h=Interpolation.Utils.Linear(s.c,r.c,e),c=Interpolation.Utils.Linear(s.l,r.l,e),o=Interpolation.Utils.Linear(s.a,r.a,e);return Interpolation.Utils.HSVJoin({a:o,h:a,s:h,v:c})},Linear(n,t,e){return(t-n)*e+n},Bernstein(n,t){const e=Interpolation.Utils.Factorial;return e(n)/e(t)/e(n-t)},Factorial:function(){const n=[1];return function(t){let e=1;if(n[t])return n[t];for(let s=t;s>1;s--)e*=s;return n[t]=e,e}}(),CatmullRom(n,t,e,s,r){const a=(e-n)*.5,h=(s-t)*.5,c=r*r,o=r*c;return(2*t-2*e+a+h)*o+(-3*t+3*e-2*a-h)*c+a*r+t}}};class Sequence{static __initStatic(){this._nextId=0}static nextId(){return Sequence._nextId++}}Sequence.__initStatic();class Tween{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=t=>!0}__init15(){this._easingFunction=Easing.Linear.None}__init16(){this._yoyoEasingFunction=void 0}__init17(){this._interpolationFunction=Interpolation.Geom.Linear}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Sequence.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Group.shared}set _group(t){this._groupRef=t}constructor(t,e){Tween.prototype.__init.call(this),Tween.prototype.__init2.call(this),Tween.prototype.__init3.call(this),Tween.prototype.__init4.call(this),Tween.prototype.__init5.call(this),Tween.prototype.__init6.call(this),Tween.prototype.__init7.call(this),Tween.prototype.__init8.call(this),Tween.prototype.__init9.call(this),Tween.prototype.__init10.call(this),Tween.prototype.__init11.call(this),Tween.prototype.__init12.call(this),Tween.prototype.__init13.call(this),Tween.prototype.__init14.call(this),Tween.prototype.__init15.call(this),Tween.prototype.__init16.call(this),Tween.prototype.__init17.call(this),Tween.prototype.__init18.call(this),Tween.prototype.__init19.call(this),Tween.prototype.__init20.call(this),Tween.prototype.__init21.call(this),Tween.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,s,r,a){for(const h in s){const c=t[h],o=Array.isArray(c),u=!Number.isNaN(Number(c)),d=o?"array":typeof c,m=d=="object",p=typeof s[h]=="object",g=!o&&Array.isArray(s[h]);d=="undefined"||d=="function"||s[h]==null||!o&&!u&&!m||((m||o||p)&&c&&!g?(typeof e[h]>"u"&&(e[h]=o?[]:{}),typeof r[h]>"u"&&(r[h]=o?[]:{}),this._setupProperties(c,e[h],s[h],r[h],a)):((typeof e[h]>"u"||a)&&(e[h]=c),(typeof r[h]>"u"||a)&&(g?r[h]=s[h].slice().reverse()[0]:r[h]=e[h]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const s=this._internalUpdate(t);return!s&&!e&&this._group.remove(this),s}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let a=Number.isFinite(r)?r%this._duration:r;Number.isNaN(a)&&(a=0);const h=Math.floor(r/this._duration);let c;if(this._reversed&&this._yoyoEasingFunction?c=this._yoyoEasingFunction(e):c=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const o=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+h),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||a<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let u=1;Number.isFinite(h)?u=this._repeatCount-o:Number.isFinite(this._repeat)&&(u=this._repeat-o);for(let d=0;d<u;d++)this._onRepeatCallback(this._object,o+1+d,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return a>0&&Number.isFinite(this._repeat)&&this._internalUpdate(a),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let o=0,u=this._chainedTweens.length;o<u;o++)this._chainedTweens[o].start(),a>0&&this._chainedTweens[o].update(a);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,s,r){for(const a in s){if(e[a]==null)continue;const h=e[a];let c=s[a];const o=Array.isArray(t[a]),u=Array.isArray(c);!o&&u?this._reversed?t[a]=this._interpolationFunction(c.concat([h]),r):t[a]=this._interpolationFunction([h].concat(c),r):typeof c=="object"&&c?this._updateProperties(t[a],h,c,r):(c=this._handleRelativeValue(h,c),typeof c=="number"&&(typeof h=="number"||typeof h=="string")&&(t[a]=Number(h)+(c-Number(h))*r,typeof h=="string"&&(t[a]=String(t[a]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const s in t){const r=!Array.isArray(t[s])&&Array.isArray(e[s]);if(typeof t[s]=="object")this._swapEndStartRepeatValues(t[s],e[s]);else{const a=t[s];if(typeof e[s]=="string")t[s]=Number(t[s])+Number(e[s]),e[s]=a;else if(r){const h=e[s].slice().reverse();t[s]=h[0],e[s]=h}else t[s]=e[s],e[s]=a}}}_moveForwardStartRepeatValues(t,e){for(const s in t)typeof e[s]=="object"?this._moveForwardStartRepeatValues(t[s],e[s]):typeof e[s]=="string"&&(t[s]=Number(t[s])+Number(e[s]))}}class FancyButton extends Container{constructor({defaultView:t,hoverView:e,pressedView:s,disabledView:r,text:a,padding:h,offset:c,textOffset:o,iconOffset:u,anchor:d,anchorX:m,anchorY:p,icon:g,animations:_}){super(),this.createViews({defaultView:t,hoverView:e,pressedView:s,disabledView:r,text:a,icon:g}),this.anchor=new ObservablePoint(this.resetViewsPositions,this),this.anchor.set(m??d??0,p??d??0),this.padding=h??0,this.offset=c,this.textOffset=o,this.iconOffset=u,_&&(this.animations=_,Ticker.shared.add(()=>Group.shared.update())),this.setState("default"),this.addEvents()}set text(t){this.textView||this.createTextView(typeof t=="number"?t.toString():t),this.textView.text=t,this.setState(this.state),this.adjustTextView(this.state)}get text(){var t;return(t=this.textView)==null?void 0:t.text}set enabled(t){this.events.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.events.enabled}setState(t){if(this.state===t)return;const e=this.getStateView(this.state),s=this.getStateView(t);e.visible=!1,s.visible=!0,this.state=t,this.setOffset(s,t,this.offset),this.adjustTextView(t),this.adjustIconView(t),this.playAnimations(t)}createTextView(t){this.textView=getTextView(t),this.textView.anchor.set(0)}createIconView(t){this.iconView=getView(t)}setOffset(t,e,s){const r=s?s[e]:{x:0,y:0},a=s==null?void 0:s.default;r?(t.x+=r.x??0,t.y+=r.y??0):a?(t.x+=a.x??0,t.y+=a.y??0):(s.x||s.y)&&(t.x+=s.x??0,t.y+=s.y??0)}getStateView(t){switch(t){case"hover":return this.hoverView??this.defaultView;case"pressed":return this.pressedView??this.defaultView;case"disabled":return this.disabledView??this.defaultView;case"default":default:return this.defaultView}}adjustTextView(t){if(!this.textView)return;const e=this.getStateView(this.state);fitToView(e,this.textView,this.padding),e.addChild(this.textView),this.textView.x=(e.width-this.textView.width)/2,this.textView.y=(e.height-this.textView.height)/2,this.setOffset(this.textView,t,this.textOffset)}adjustIconView(t){if(!this.iconView)return;const e=this.getStateView(this.state);fitToView(e,this.iconView,this.padding),e.addChild(this.iconView),this.iconView.x=e.width/2-this.iconView.width/2,this.iconView.y=e.height/2-this.iconView.height/2,this.setOffset(this.iconView,t,this.iconOffset)}resetViewsPositions(){var r,a;const t=((r=this.anchor)==null?void 0:r.x)??0,e=((a=this.anchor)==null?void 0:a.y)??0;[this.defaultView,this.hoverView,this.pressedView,this.disabledView].forEach(h=>{var c;h&&((c=h.anchor)==null||c.set(0),h.x=-h.width*t,h.y=-h.height*e)})}createViews(t){const{defaultView:e,hoverView:s,pressedView:r,disabledView:a,text:h,icon:c}=t;this.innerView=new Container,this.addChild(this.innerView),this.defaultView=getView(e),this.innerView.addChild(this.defaultView),s&&(this.hoverView=getView(s),this.innerView.addChild(this.hoverView),this.hoverView.visible=!1),r&&(this.pressedView=getView(r),this.innerView.addChild(this.pressedView),this.pressedView.visible=!1),a&&(this.disabledView=getView(a),this.innerView.addChild(this.disabledView),this.disabledView.visible=!1),h&&this.createTextView(h),c&&this.createIconView(c)}addEvents(){this.events=new Button$1(this),this.onPress=new dist.Signal,this.onDown=new dist.Signal,this.onUp=new dist.Signal,this.onHover=new dist.Signal,this.onOut=new dist.Signal,this.onUpOut=new dist.Signal,this.events.onPress.connect((t,e)=>{this.onPress.emit(this,e),this.setState("hover")}),this.events.onDown.connect((t,e)=>{this.onDown.emit(this,e),this.setState("pressed")}),this.events.onUp.connect((t,e)=>{this.onUp.emit(this,e),this.setState("hover")}),this.events.onHover.connect((t,e)=>{this.onHover.emit(this,e),this.setState("hover")}),this.events.onOut.connect((t,e)=>{this.onOut.emit(this,e),this.setState("default")}),this.events.onUpOut.connect((t,e)=>{this.onUpOut.emit(this,e),this.setState("default")})}playAnimations(t){if(this.originalInnerViewState||(this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}}),this.animations&&this.animations[t]){const e=this.animations[t];new Tween(this.innerView).to(e.props,e.duration).start()}else this.animations&&t==="default"&&new Tween(this.innerView).to(this.originalInnerViewState,100).start()}}class Input extends Container{constructor(t){super(),this.editing=!1,this.tick=0,this.activation=!1,this.options=t,this.bg=getView(t.bg),this.bg.cursor="text",this.bg.interactive=!0;const e={fill:0,align:"center"},s=new TextStyle(t.textStyle??e);if(this.inputField=new Text("",s),this.inputMask=new Graphics().beginFill(16777215).drawRect(this.padding,this.padding,this.bg.width-this.padding*2,this.bg.height-this.padding*2),this.inputField.mask=this.inputMask,this._cursor=new Sprite(Texture.WHITE),this._cursor.tint=Number(t.textStyle.fill)||0,this._cursor.anchor.set(.5),this._cursor.width=2,this._cursor.height=this.inputField.height*.8,this._cursor.alpha=0,this._cursor.mask=this.inputMask,this.placeholder=new Text(t.placeholder,s??e),this.placeholder.visible=!!t.placeholder,this.value=t.value??"",this.addChild(this.bg,this.inputField,this.placeholder,this._cursor,this.inputMask),this.align(),this.cursor="text",this.interactive=!0,this.on("pointertap",()=>this.activation=!0),isMobile.any){window.addEventListener("touchstart",()=>this.handleActivation());let r=document.getElementById("v-keyboard");r||(r=document.createElement("input"),document.body.appendChild(r),r.setAttribute("id","v-keyboard"),r.style.opacity="0"),r.oninput=()=>{let a=r.value;const h=this.options.maxLength;h&&a.length>this.options.maxLength&&(a=a.substring(0,h),r.value=a),this.value=a,this.onChange.emit(this.value)}}else window.addEventListener("click",()=>{this.handleActivation(),this.onEnter.emit(this.value)}),window.addEventListener("keydown",r=>{const a=r.key;a==="Backspace"?this._delete():a==="Escape"||a==="Enter"?(this.stopEditing(),this.onEnter.emit(this.value)):a.length===1&&this._add(a)});this.onEnter=new dist.Signal,this.onChange=new dist.Signal,Ticker.shared.add(r=>this.update(r))}_add(t){this.editing&&(this.options.maxLength&&this.value.length>=this.options.maxLength||(this.value=this.value+t,this.onChange.emit(this.value)))}_delete(){if(!this.editing||this.value.length===0)return;const t=this.value.split("");t.pop(),this.value=t.join(""),this.onChange.emit(this.value)}_startEditing(){if(this.tick=0,this.editing=!0,this.placeholder.visible=!1,this._cursor.alpha=1,isMobile.any){const t=document.getElementById("v-keyboard");t.focus(),t.click(),t.value=this.value}this.align()}handleActivation(){this.stopEditing(),this.activation&&(this._startEditing(),this.activation=!1)}stopEditing(){var t;this._cursor.alpha=0,this.editing=!1,this.inputField.text===""&&(this.placeholder.visible=!0),this.value.length===0&&(this.placeholder.visible=!0),isMobile.any&&((t=document.getElementById("v-keyboard"))==null||t.blur()),this.align()}update(t){this.editing&&(this.tick+=t*.1,this._cursor.alpha=Math.round(Math.sin(this.tick)*.5+.5))}align(){const t=this.getAlign();this.inputField.anchor.set(t,.5),this.inputField.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.inputField.y=this.bg.height/2,this.placeholder.anchor.set(t,.5),this.placeholder.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.placeholder.y=this.bg.height/2,this._cursor.x=this.getCursorPosX(),this._cursor.y=this.inputField.y}get padding(){return this.options.padding|0}getAlign(){const t=this.bg.width*.95;if(this.inputField.width+this.padding*3>t)return this.editing?1:0;switch(this.options.align){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}getCursorPosX(){switch(this.getAlign()){case 0:return this.inputField.x+this.inputField.width;case .5:return this.inputField.x+this.inputField.width*.5;case 1:return this.inputField.x;default:return 0}}set value(t){this.inputField.text=t,t.length!==0?this.placeholder.visible=!1:this.placeholder.visible=!this.editing,this.align()}get value(){return this.inputField.text}}class Layout extends Container{constructor(t){super(),this.children=[],this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.map(e=>this.addChild(e))}onChildrenChange(){var r,a,h;let t=((r=this.options)==null?void 0:r.horPadding)??0,e=((a=this.options)==null?void 0:a.vertPadding)??0;const s=((h=this.options)==null?void 0:h.elementsMargin)??0;this.children.forEach(c=>{var o;switch(!this.type&&t+c.width>=this.parent.width?(e+=s+c.height,t=((o=this.options)==null?void 0:o.horPadding)??0,c.x=t,c.y=e):(c.x=t,c.y=e),this.type){case"horizontal":t+=s+c.width;break;case"vertical":e+=s+c.height;break;default:t+=s+c.width;break}})}}class Spring{constructor(t={}){this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}class ScrollSpring{constructor(){this._spring=new Spring,this._pos=0,this.to=0}start(t,e,s){this._speed=t,this._pos=e,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const r=this.to-this._pos,a=Math.abs(r)/r,h=Math.abs(this._speed)/this._speed;a!==h?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}class SlidingNumber{constructor(t={}){this.position=0,this.constrain=!0,this.min=0,this.max=0,this.maxSpeed=400,this._offset=0,this._prev=0,this._speed=0,this._targetSpeed=0,this._speedChecker=0,this._grab=0,this.constrain=t.constrain??!0,this.maxSpeed=t.maxSpeed??400,this._ease=t.ease??new ScrollSpring}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(){this._hasStopped||(this.constrain?this._updateConstrain():this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(){const t=this.max;this.position>this.min||this.position<t||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,t)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}class Trackpad{constructor(t){this.xAxis=new SlidingNumber({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new SlidingNumber({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this._frame=new Rectangle,this._bounds=new Rectangle,this._globalPosition=new Point}pointerDown(t){this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(),this.yAxis.slide())}resize(t,e){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=e,this._dirty=!0}setBounds(t,e,s,r){this._bounds.x=t,this._bounds.width=e-t,this._bounds.y=s,this._bounds.height=r-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}class ScrollBox extends Container{constructor(t){var s;super(),this.__width=0,this.__height=0,this.freeSlot={x:0,y:0},this.isDragging=0,this.childrenInteractiveStorage=[],this.ticker=Ticker.shared,this.options=t,this.addBackground(),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,t.vertPadding||(t.vertPadding=t.padding??0),t.horPadding||(t.horPadding=t.padding??0),this.layout=new Layout({type:t.type,elementsMargin:t.elementsMargin,vertPadding:t.vertPadding,horPadding:t.horPadding}),super.addChild(this.layout),(s=t.items)!=null&&s.length&&t.items.forEach(r=>{this.addItem(r)}),this.hasBounds&&(this.addMask(),this.makeScrollable()),this.onMouseScrollBinded=this.onMouseScroll.bind(this);const e=new ScrollSpring;this._trackpad=new Trackpad({constrain:!0,yEase:e}),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.resize(),this.ticker.add(this.update,this)}get hasBounds(){return!!this.__width||!!this.__height}onChildrenChange(){}addItem(...t){var e;if(t.length>1)t.forEach(s=>this.addItem(s));else{const s=t[0];(!s.width||!s.height)&&console.error("ScrollBox item should have size"),s.x=this.freeSlot.x,s.y=this.freeSlot.y,this.layout.addChild(s),this.options.disableDynamicRendering||(s.renderable=this.isItemVisible(s));const r=((e=this.options)==null?void 0:e.elementsMargin)??0;switch(this.options.type){case"horizontal":this.freeSlot.x+=r+s.width;break;default:this.freeSlot.y+=r+s.height;break}}return this.resize(),t[0]}removeItem(t){const e=this.layout.children[t];e&&(this.layout.removeChild(e),this.resize())}isItemVisible(t){const e=this.options.type==="vertical"||!this.options.type;let s=!1;const r=this.layout;if(e){const a=t.y+r.y;a+t.height+this.options.vertPadding>=0&&a-this.options.vertPadding-this.options.elementsMargin<=this.options.height&&(s=!0)}else{const a=t.x+r.x;a+t.width>=0&&a<=this.options.width&&(s=!0)}return s}get items(){var t;return((t=this.layout)==null?void 0:t.children)??[]}addBackground(){this.background=typeof this.options.background=="string"?Sprite.from(this.options.background):new Graphics,this.addChild(this.background),this.resize()}addMask(){this.borderMask=new Graphics,super.addChild(this.borderMask),this.mask=this.borderMask,this.resize()}makeScrollable(){this.on("pointerdown",s=>{this.isDragging=1,this._trackpad.pointerDown(s.global)}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("globalpointermove",s=>{this._trackpad.pointerMove(s.global),this.isDragging&&this.disableChildrenInteractivity()});const{onMouseHover:t,onMouseOut:e}=this;this.on("mouseover",t,this).on("mouseout",e,this)}disableChildrenInteractivity(){this.items.forEach((t,e)=>{this.childrenInteractiveStorage[e]||(this.childrenInteractiveStorage[e]=t.interactive===!0),t.interactive=!1})}restoreChildrenInteractivity(){this.items.forEach((t,e)=>{const s=this.childrenInteractiveStorage[e]===!0;s&&(t.interactive=s,delete this.childrenInteractiveStorage[e])})}setInteractive(t){this.interactive=t}get layoutHeight(){return this.layout.height+this.options.vertPadding*2}get layoutWidth(){return this.layout.width+this.options.horPadding*2}resize(){if(this.renderAllItems(),this.borderMask&&(this.lastWidth!==this.layoutWidth||this.lastHeight!==this.layoutHeight)){const t=this.options.vertPadding,e=this.options.horPadding;this.options.width||(this.__width+=this.layoutWidth),this.options.height||(this.__height+=this.layoutHeight),this.borderMask.clear().lineStyle(0).beginFill(16777215).drawRoundedRect(0,0,this.__width,this.__height,this.options.radius|0),removeHitBox(this.borderMask),this.background instanceof Graphics&&typeof this.options.background=="number"&&this.background.clear().lineStyle(0).beginFill(this.options.background).drawRect(0,0,this.__width+e,this.__height+t),this.options.type==="horizontal"?this.setInteractive(this.layoutWidth>this.__width):this.setInteractive(this.layoutHeight>this.__height),this.lastWidth=this.layoutWidth,this.lastHeight=this.layoutHeight}if(this._trackpad){const t=this.borderMask.width-this.layout.width-this.options.horPadding*2,e=this.borderMask.height-this.layout.height-this.options.vertPadding*2;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(e):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(t):(this._trackpad.yAxis.max=-Math.abs(e),this._trackpad.xAxis.max=-Math.abs(t))}this.stopRenderHiddenItems()}onMouseHover(){this.renderAllItems(),document.addEventListener("mousewheel",this.onMouseScrollBinded),document.addEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseOut(){this.stopRenderHiddenItems(),document.removeEventListener("mousewheel",this.onMouseScrollBinded),document.removeEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseScroll(t){if(this.renderAllItems(),this.options.type==="horizontal"&&(typeof t.deltaX<"u"||typeof t.deltaY<"u")){const e=t.deltaY?this.layout.x-t.deltaY:this.layout.x-t.deltaX;e<0&&e+this.layoutWidth+this.options.horPadding<this.__width?this._trackpad.xAxis.value=this.__width-this.layoutWidth:e>this.options.horPadding?this._trackpad.xAxis.value=0:this._trackpad.xAxis.value=e}else if(typeof t.deltaY<"u"){const e=this.layout.y-t.deltaY;e<0&&e+this.layoutHeight+this.options.vertPadding<this.__height?this._trackpad.yAxis.value=this.__height-this.layoutHeight:e>this.options.vertPadding?this._trackpad.yAxis.value=0:this._trackpad.yAxis.value=e}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.layout.children.length-1):this.scrollTop()}scrollTop(){this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0}renderAllItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=this.isItemVisible(t)})}scrollTo(t){if(!this.interactive)return;const e=this.layout.children[t];e&&(this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-e.x-e.width-this.options.horPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-e.y-e.height-this.options.vertPadding:0)}get height(){return this.__height}get width(){return this.__width}update(){this._trackpad.update(),this.options.type==="horizontal"?this.layout.x!==this._trackpad.x?(this.renderAllItems(),this.layout.x=this._trackpad.x):this.stopRenderHiddenItems():this.layout.y!==this._trackpad.y?(this.renderAllItems(),this.layout.y=this._trackpad.y):this.stopRenderHiddenItems()}}const defaultVisibleItems=5;class Select extends Container{constructor({closedBG:t,textStyle:e,items:s,openBG:r,selected:a,selectedTextOffset:h,scrollBox:c,visibleItems:o}){super(),this.openButton=new FancyButton({defaultView:getView(t),text:new Text(s!=null&&s.items?s.items[0]:"",e),textOffset:h}),this.openButton.onPress.connect(()=>this.toggle()),this.addChild(this.openButton),this.openView=getView(r),this.openView.visible=!1,this.addChild(this.openView);const u=new Graphics().beginFill(0,1e-5).drawRect(0,0,this.openButton.width,this.openButton.height);this.closeButton=new FancyButton({defaultView:u,text:new Text(s!=null&&s.items?s.items[0]:"",e),textOffset:h}),this.closeButton.onPress.connect(()=>this.toggle()),this.openView.addChild(this.closeButton),this.scrollBox=new ScrollBox({type:"vertical",elementsMargin:0,width:this.openButton.width,height:this.openButton.height*(o??defaultVisibleItems),radius:0,padding:0,...c}),this.scrollBox.y=this.openButton.height,this.openView.addChild(this.scrollBox),c!=null&&c.offset&&(this.scrollBox.x+=c.offset.x??0,this.scrollBox.y+=c.offset.y??0),this.onSelect=new dist.Signal,this.convertItemsToButtons(s).forEach((d,m)=>{const p=d.text;m===a&&(this.openButton.text=p,this.closeButton.text=p),d.onPress.connect(()=>{this.value=m,this.onSelect.emit(m,p),this.openButton.text=p,this.closeButton.text=p,this.close()}),this.scrollBox.addItem(d)})}toggle(){this.openView.visible=!this.openView.visible,this.openButton.visible=!this.openButton.visible}open(){this.openView.visible=!0,this.openButton.visible=!1}close(){this.openView.visible=!1,this.openButton.visible=!0}convertItemsToButtons({items:t,backgroundColor:e,hoverColor:s,width:r,height:a,textStyle:h,radius:c}){const o=[];return t.forEach(u=>{const d=new Graphics().beginFill(e).drawRoundedRect(0,0,r,a,c),m=s??e,p=new Graphics().beginFill(m).drawRoundedRect(0,0,r,a,c),g=new Text(u,h),_=new FancyButton({defaultView:d,hoverView:p,text:g});o.push(_)}),o}}class Slider extends SliderBase{constructor(t){super({bg:t.bg,slider1:t.slider,fill:t.fill??"",min:t.min,max:t.max,value1:t.value,valueTextStyle:t.valueTextStyle,showValue:t.showValue,valueTextOffset:t.valueTextOffset,fillOffset:t.fillOffset}),this.onChange=new dist.Signal,this.onUpdate=new dist.Signal,this.options=t,this.value=t.value??0}get value(){return this._value1}set value(t){var e,s,r;if(t!==this._value1){if(t<this.min&&(t=this.min),t>this.max&&(t=this.max),this._value1=t,this.progress=(this.max-this.min)/100*t,this.slider1.x=(this.bg.width-this.slider1.width)/100*this.progress,this.options.showValue){this.value1Text.text=`${t}`;const a=this.slider1.x+this.slider1.width/2,h=this.slider1.y;this.value1Text.x=a+(((e=this.options.valueTextOffset)==null?void 0:e.x)??0),this.value1Text.y=h+(((s=this.options.valueTextOffset)==null?void 0:s.y)??0)}(r=this.onUpdate)==null||r.emit(this.value)}}update(t){if(!this.dragging)return;const e=t.currentTarget,{x:s}=e.parent.worldTransform.applyInverse(t.global),r=this.validate(s/this.bg.width*100);r!==this.progress&&(this.value=(this.max-this.min)/100*r)}}const defaultRoundedBoxOptions={color:0,width:350,height:600,shadow:!0,shadowColor:655397,shadowOffset:22,alpha:1,radius:34};class RoundedBox extends Container{constructor(e={}){super();gt(this,"image");gt(this,"shadow");const s={...defaultRoundedBoxOptions,...e};this.image=new NineSlicePlane(Texture.from("rounded-rectangle"),s.radius,s.radius,s.radius,s.radius),this.image.width=s.width,this.image.height=s.height,this.image.tint=s.color,this.image.alpha=s.alpha,this.image.x=-this.image.width*.5,this.image.y=-this.image.height*.5,this.addChild(this.image),s.shadow&&(this.shadow=new NineSlicePlane(Texture.from("rounded-rectangle"),34,34,34,34),this.shadow.width=s.width,this.shadow.height=s.height,this.shadow.tint=s.shadowColor,this.shadow.x=-this.shadow.width*.5,this.shadow.y=-this.shadow.height*.5+s.shadowOffset,this.addChildAt(this.shadow,0))}get boxWidth(){return this.image.width}get boxHeight(){return this.image.height}set boxWidth(e){this.image.width=e}}class Header extends Container{constructor(){super();gt(this,"container");gt(this,"bg");gt(this,"fsLogo");gt(this,"userLabel");gt(this,"image");gt(this,"balanceContainer");gt(this,"layoutUser");gt(this,"panelBaseUser");this.container=new Container,this.addChild(this.container),this.bg=new Sprite(Texture.WHITE),this.container.addChild(this.bg),this.fsLogo=new FsLogo,this.container.addChild(this.fsLogo),this.panelBaseUser=new RoundedBox({width:200,height:40,alpha:.5,shadow:!1,color:2369584}),this.container.addChild(this.panelBaseUser),this.layoutUser=new Layout({type:"horizontal",elementsMargin:-20}),this.layoutUser.x=-this.panelBaseUser.boxWidth*.5+30,this.panelBaseUser.addChild(this.layoutUser),this.userLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:12,fill:16777215},!1),this.userLabel.x=-60,this.userLabel.y=-8,this.panelBaseUser.addChild(this.userLabel),this.image=Sprite.from((user==null?void 0:user.photoURL)||"user-default"),this.image.scale.set(.8),this.image.anchor.set(.5),this.image.roundPixels=!0,this.image.height=20,this.image.width=20,this.image.x=-this.panelBaseUser.boxWidth*.5+20,this.panelBaseUser.addChild(this.image),this.balanceContainer=new Balance,this.container.addChild(this.balanceContainer);let e=setInterval(()=>{const{truncate:s}=truncateString(user.username,18);this.userLabel.text=s,this.balanceContainer.balance=user.budget.toFixed(2),this.balanceContainer.bonus=user.bonusBudget.toFixed(2),clearInterval(e)},100);responsive.getIsDesktop?this.balanceContainer.visible=!0:this.balanceContainer.visible=!1}resize(e){this.bg.width=e,this.bg.height=60,this.bg.tint=264209,this.fsLogo.x=50,this.fsLogo.y=30,this.balanceContainer.x=e-380,this.balanceContainer.y=30,this.panelBaseUser.x=e-120,this.panelBaseUser.y=30}refreshUserDetails(){this.userLabel.text=`${user.username}`,this.balanceContainer.balance=user.budget.toFixed(2),this.balanceContainer.bonus=user.bonusBudget.toFixed(2),console.log(user.bonusBudget)}}class Balance extends Container{constructor(){super();gt(this,"currencyLabel");gt(this,"currencyBonus");gt(this,"bonusText");gt(this,"balanceLabel");gt(this,"bonusLabel");gt(this,"slashLabel");gt(this,"panelBase");const e=i18n.translatedText;this.panelBase=new RoundedBox({width:280,height:40,alpha:.5,shadow:!1,color:2369584}),this.addChild(this.panelBase),this.bonusText=new Label(e.bonus,{fontFamily:"Epilogue Bold",fontSize:14,fill:16765810}),this.bonusText.x=-100,this.panelBase.addChild(this.bonusText),this.currencyBonus=new Label("$",{fontFamily:"Epilogue Bold",fontSize:14}),this.currencyBonus.x=-70,this.panelBase.addChild(this.currencyBonus),this.bonusLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14},!1),this.bonusLabel.x=-60,this.bonusLabel.y=-10,this.panelBase.addChild(this.bonusLabel),this.slashLabel=new Label("/",{fontFamily:"Epilogue Bold",fontSize:14}),this.slashLabel.x=10,this.panelBase.addChild(this.slashLabel),this.currencyLabel=new Label("$",{fontFamily:"Epilogue Bold",fontSize:14,fill:3431867}),this.currencyLabel.x=30,this.panelBase.addChild(this.currencyLabel),this.balanceLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14},!1),this.balanceLabel.x=40,this.balanceLabel.y=-10,this.panelBase.addChild(this.balanceLabel)}set balance(e){this.balanceLabel.text=e}set bonus(e){parseFloat(e)*10**backendConfigs.betPrecision<1?(this.bonusText.visible=!1,this.currencyBonus.visible=!1,this.bonusLabel.visible=!1,this.slashLabel.visible=!1,this.panelBase.boxWidth=150,this.panelBase.x=140,this.currencyLabel.x=-120,this.balanceLabel.x=-100):(this.panelBase.boxWidth=280,this.panelBase.x=0,this.currencyLabel.x=30,this.balanceLabel.x=40,this.bonusText.visible=!0,this.currencyBonus.visible=!0,this.bonusLabel.visible=!0,this.slashLabel.visible=!0),this.bonusLabel.text=e}}const defaultPlusButtonOptions={text:"",width:56,height:56,labelColor:15471969,labelFontSize:8};class PlusButton extends FancyButton{constructor(e={}){const s={...defaultPlusButtonOptions,...e},r=new NineSlicePlane(Texture.from("button-plus"),10,16,16,20);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-plus-hover"),16,16,16,20);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button-plus"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-plus-disabled"),16,16,16,20);h.width=s.width,h.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.label.y=-8,this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav"),this.label.y=-3}handleUp(){this.label.y=-8}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}}const defaultMinusButtonOptions={text:"",width:56,height:56,labelColor:15471969,labelFontSize:8};class MinusButton extends FancyButton{constructor(e={}){const s={...defaultMinusButtonOptions,...e},r=new NineSlicePlane(Texture.from("button-minus"),10,16,16,20);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-minus-hover"),16,16,16,20);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button-minus"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-minus-disabled"),16,16,16,20);h.width=s.width,h.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.label.y=-8,this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav"),this.label.y=-3}handleUp(){this.label.y=-8}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}}const defaultTextInputOptions={width:240,height:60,placeholder:"Enter text",fontSize:24,fontFamily:"Epilogue Bold",align:"center"};class TextInput extends Container{constructor(e={},s,r,a,h){const c={...defaultTextInputOptions,...e};super();gt(this,"container");gt(this,"input");gt(this,"bg");gt(this,"enabled");gt(this,"_value");gt(this,"_onEnter");gt(this,"timer");this._onEnter=r,this.container=new Container,this.addChild(this.container),this.bg=new Sprite(Texture.EMPTY),this.bg.width=c.width,this.bg.height=c.height,this.container.addChild(this.bg);let o={bg:this.bg,placeholder:c.placeholder,align:c.align,maxLength:6,textStyle:{fontFamily:c.fontFamily,fontSize:c.fontSize,fill:16777215}};this.input=new Input(o),this._value="",this.input.value="",this.enabled=!0;const u=new RegExp(`^-?\\d*(\\.\\d{0,${s}}|)$`);this.input.onChange.connect(d=>{for(;d.length>0&&d[0]=="0";)d=d.slice(1);if(d[0]==="."&&(d="0"+d),d==="-."&&(d="-0."),this.enabled&&d.match(u)){this.timer&&(clearTimeout(this.timer),this.timer=void 0);let m=+d;(d==="-"||d==="")&&a<0?(this.input.value=d,this.value=d,this._onEnter(0)):m<=h&&m>=a?(this.input.value=d,this.value=d,this._onEnter(m)):this.timer=setTimeout(()=>{this.input.value=Math.max(a,parseFloat(this._value)).toFixed(s)},3e3)}else this.input.value=this.value}),this.container.addChild(this.input)}get value(){return this._value}set value(e){this.input.value=this._value=e}}let PreviousResults$1=class{constructor(){gt(this,"results",[]);gt(this,"currentResult","")}get getResults(){return this.results}get getCurrentResult(){return this.currentResult}set setResults(t){this.results=t}set setCurrentResult(t){this.currentResult=t}};const previousResults=new PreviousResults$1,defaultIconButtonOptions={image:"",imageDisabled:"",drawWidth:50,drawHeight:50,drawRadius:100};class IconButton extends FancyButton{constructor(e={},s=!0){const r={...defaultIconButtonOptions,...e},a=Sprite.from(r.image),h=Sprite.from(r.imageDisabled||"icon-unde-disabled");super({defaultView:a,disabledView:h,anchor:.5});gt(this,"container");gt(this,"bg");gt(this,"image");gt(this,"imageDisabled");gt(this,"ripplePool",[]);this.container=new Container,this.addChild(this.container),this.bg=new Graphics,this.bg.beginFill(264209,.5),this.bg.drawRoundedRect(0,0,r.drawWidth,r.drawHeight,r.drawRadius),this.bg.visible=s,this.container.addChild(this.bg),this.image=a,this.image.interactiveChildren=!1,this.image.scale.set(.8),this.image.x=this.container.width*.25,this.image.y=this.container.height*.25,this.imageDisabled=h,this.imageDisabled.interactiveChildren=!1,this.imageDisabled.scale.set(.8),this.imageDisabled.x=this.container.width*.25,this.imageDisabled.y=this.container.height*.25,this.onHover.connect(this.handleHover.bind(this)),this.onOut.connect(this.handleOut.bind(this)),this.onDown.connect(this.handleDown.bind(this)),this.container.pivot.x=this.container.width/2,this.container.pivot.y=this.container.height/2,this.container.addChild(this.image),this.container.addChild(this.imageDisabled)}handleHover(){gsapWithCSS.to(this.scale,{x:1.2,y:1.2,duration:.2,ease:"back.out"})}handleOut(){gsapWithCSS.to(this.scale,{x:1,y:1,duration:.2,ease:"back.out"})}handleDown(){this.playRipples()}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),gsapWithCSS.killTweensOf(this.image),this.visible=!0,this.interactive=!0,e?(this.image.alpha=0,this.scale.set(1.5),gsapWithCSS.to(this.image,{alpha:1,duration:.3,ease:"linear"}),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"sine.out"})):(this.image.alpha=1,this.scale.set(1))}async hide(e=!0){this.interactive=!1,gsapWithCSS.killTweensOf(this.scale),gsapWithCSS.killTweensOf(this.image),e?(gsapWithCSS.to(this.image,{alpha:0,duration:.3,ease:"linear"}),await gsapWithCSS.to(this.scale,{x:1.5,y:1.5,duration:.3,ease:"sine.out"})):(this.image.alpha=0,this.scale.set(0)),this.visible=!1}async playRipples(e=3){for(let s=0;s<e;s++)this.playRipple(),await waitFor(.2)}async playRipple(){const e=this.ripplePool.pop()??new Sprite;gsapWithCSS.killTweensOf(e.scale),gsapWithCSS.killTweensOf(e),e.anchor.set(.5),e.scale.set(1),e.alpha=.5,this.addChild(e),gsapWithCSS.to(e.scale,{x:3,y:3,duration:.6,ease:"linear"}),await gsapWithCSS.to(e,{alpha:0,duration:.6,ease:"linear"}),this.removeChild(e),this.ripplePool.push(e)}}class HashPopup extends Container{constructor(){super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"layout");gt(this,"dateLabel");gt(this,"infoLabel");gt(this,"multiplier");gt(this,"arrowLeft");gt(this,"arrowRight");gt(this,"iconClose");gt(this,"inputHash");gt(this,"inputResult");this.bg=Sprite.from(Texture.EMPTY),this.bg.alpha=0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:440,height:330,alpha:.8,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.iconClose=new IconButton({image:"icon-close"},!1),this.iconClose.y=-this.panelBase.boxHeight*.5+25,this.iconClose.x=this.panelBase.boxWidth*.5-50,this.iconClose.onPress.connect(()=>navigation.dismissPopup()),this.panel.addChild(this.iconClose),this.dateLabel=new Label("16/05/2023 at 15:58:02",{fill:16777215,fontSize:14}),this.dateLabel.y=-this.panelBase.boxHeight*.5+25,this.panel.addChild(this.dateLabel),this.layout=new Layout({type:"horizontal",elementsMargin:25}),this.layout.pivot.x=this.layout.width/2,this.layout.x=-this.panelBase.boxWidth*.5+150,this.layout.y=-this.panelBase.boxHeight*.5+60,this.panel.addChild(this.layout),this.arrowLeft=Sprite.from("icon-arrow-down"),this.arrowLeft.angle=90,this.arrowLeft.anchor.set(.5),this.layout.addChild(this.arrowLeft),this.multiplier=new Badge({text:"5.12x",width:80,height:36,labelFontSize:12,isPivot:!1}),this.multiplier.pivot.x=this.multiplier.width/6,this.multiplier.pivot.y=this.multiplier.height/2,this.layout.addChild(this.multiplier),this.arrowRight=Sprite.from("icon-arrow-down"),this.arrowRight.angle=270,this.arrowRight.anchor.set(.5),this.layout.addChild(this.arrowRight),this.inputHash=new InputHash("Hash"),this.inputHash.x=-this.panelBase.boxWidth*.5+20,this.inputHash.y=-this.panelBase.boxHeight*.5+110,this.inputHash.resultText="774156eca98d895d3bf02da7fe0b4f87bd61749c85d82674c755409296bcceb3",this.panel.addChild(this.inputHash),this.inputResult=new InputHash("Result"),this.inputResult.x=-this.panelBase.boxWidth*.5+20,this.inputResult.y=-this.panelBase.boxHeight*.5+190,this.inputResult.resultText="result_is_2.99_drhcsnh0aztbm5pn",this.panel.addChild(this.inputResult),this.infoLabel=new Label("Mas información sobre Hash",{fill:16777215,fontSize:12}),this.infoLabel.alpha=.5,this.infoLabel.y=this.panelBase.boxHeight*.5-25,this.panel.addChild(this.infoLabel)}update(){this.multiplier.textLabel=previousResults.getCurrentResult}resize(e,s){this.bg.width=e,this.bg.height=s,responsive.getIsDesktop?(this.panel.x=e-240,this.panel.y=s-370):(this.panel.x=e/2,this.panel.y=s-370)}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.from(this.bg,{alpha:.5,duration:.2,ease:"linear"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"})}}class InputHash extends Layout{constructor(e){super({type:"vertical",elementsMargin:5});gt(this,"title");gt(this,"resuelt");gt(this,"graphics");gt(this,"iconClipboard");gt(this,"copyTooltip");gt(this,"_resueltOrigin","");this.title=new Label(e,{fill:16777215,fontSize:14},!1),this.addChild(this.title),this.graphics=new Graphics().beginFill(0,.8).lineStyle({width:1,color:1477704}).drawRoundedRect(0,0,400,40,10),this.addChild(this.graphics),this.resuelt=new Text("",{fill:16777215,fontSize:12}),this.resuelt.x=10,this.resuelt.y=this.graphics.height*.5-6,this.graphics.addChild(this.resuelt),this.iconClipboard=Sprite.from("icon-clipboard"),this.iconClipboard.anchor.set(.5),this.iconClipboard.x=this.graphics.width-20,this.iconClipboard.y=this.graphics.height*.5,this.iconClipboard.cursor="pointer",this.iconClipboard.interactive=!0,this.on("click",()=>{navigator.clipboard.writeText(this._resueltOrigin),this.showCopyTooltip(),setTimeout(()=>{this.hideCopyTooltip()},2e3)}),this.graphics.addChild(this.iconClipboard),this.copyTooltip=new Badge({text:"Copy!!!",width:60,height:30,radius:8,labelFontSize:12,isPivot:!1,isPositionLabel:!0,fill:0}),this.copyTooltip.x=this.graphics.width-60,this.copyTooltip.y=-this.graphics.height+7,this.copyTooltip.alpha=0,this.graphics.addChild(this.copyTooltip)}set resultText(e){const{truncate:s,origin:r}=truncateString(e,45);this._resueltOrigin=r,this.resuelt.text=s}async showCopyTooltip(e=!0){gsapWithCSS.killTweensOf(this.copyTooltip),e?gsapWithCSS.to(this.copyTooltip,{alpha:1,duration:.2,ease:"power4.in"}):this.alpha=1}async hideCopyTooltip(e=!0){gsapWithCSS.killTweensOf(this.copyTooltip),e?gsapWithCSS.to(this.copyTooltip,{alpha:0,duration:.2,ease:"linear"}):this.alpha=0}}const defaultBadgeOptions={text:"-",width:155,height:70,radius:15,fill:4325835,labelColor:16777215,labelFontSize:20,labelFontFamily:"Epilogue Regular",isPivot:!0,isPositionLabel:!0,onClick:!1,labelAlpha:1};class Badge extends Container{constructor(e={}){const s={...defaultBadgeOptions,...e};super();gt(this,"graphics");gt(this,"label");this.graphics=new Graphics().beginFill(s.fill).drawRoundedRect(0,0,s.width,s.height,s.radius).endFill(),s.isPivot&&(this.graphics.pivot.x=this.graphics.width/2,this.graphics.pivot.y=this.graphics.height/2),this.addChild(this.graphics),this.label=new Label(s.text,{fill:s.labelColor,fontSize:s.labelFontSize,fontFamily:s.labelFontFamily,breakWords:!0,wordWrap:!0,wordWrapWidth:s.width-20}),this.label.alpha=s.labelAlpha,s.isPositionLabel&&(this.label.x=this.graphics.width/2,this.label.y=this.graphics.height/2),this.addChild(this.label),s.onClick&&(this.interactive=!0,this.cursor="pointer",this.on("click",()=>{previousResults.setCurrentResult=this.label.text,navigation.presentPopup(HashPopup)}),this.on("tap",()=>{previousResults.setCurrentResult=this.label.text,navigation.presentPopup(HashPopup)}))}set textLabel(e){this.label.text=e}get textLabel(){return this.label.text}}var AlignIndicador=(n=>(n.CENTER="center",n.RIGHT="right",n.LEFT="left",n))(AlignIndicador||{});const defaultTooltipOptions={text:"",width:60,height:30,radius:8,labelFontSize:12,isPivot:!1,isPositionLabel:!0,fill:0,alignIndicador:"center",labelAlpha:1};class Tooltip extends Container{constructor(e={}){super();gt(this,"baseTooltip");gt(this,"graphics");const s={...defaultTooltipOptions,...e};this.alpha=0,this.baseTooltip=new Badge({text:s.text,width:s.width,height:s.height,radius:s.radius,labelFontSize:s.labelFontSize,isPivot:s.isPivot,isPositionLabel:s.isPositionLabel,fill:s.fill,labelAlpha:s.labelAlpha}),this.addChild(this.baseTooltip),this.graphics=new Graphics,this.graphics.beginFill(0),this.graphics.moveTo(10.866,16.5),this.graphics.bezierCurveTo(10.4811,17.1667,9.51888,17.1667,9.13398,16.5),this.graphics.lineTo(.473724,1.5),this.graphics.bezierCurveTo(.0888229,.83333,.569948,-187347e-11,1.33975,-180618e-11),this.graphics.lineTo(18.6603,-29197e-11),this.graphics.bezierCurveTo(19.4301,-224672e-12,19.9112,.833334,19.5263,1.5),this.graphics.lineTo(10.866,16.5),this.graphics.closePath(),this.graphics.y=s.height,s.alignIndicador==="left"&&(this.graphics.x=50),s.alignIndicador==="center"&&(this.graphics.x=s.width/2),s.alignIndicador==="right"&&(this.graphics.x=s.width-70),this.addChild(this.graphics)}async showTooltip(e=!0){gsapWithCSS.killTweensOf(this),e?gsapWithCSS.to(this,{alpha:1,duration:.2,ease:"power4.in"}):this.alpha=1}async hideTooltip(e=!0){gsapWithCSS.killTweensOf(this),e?gsapWithCSS.to(this,{alpha:0,duration:.2,ease:"linear"}):this.alpha=0}}class Bets extends Container{constructor(e,s,r,a,h,c,o){super();gt(this,"layout");gt(this,"panelBase");gt(this,"container");gt(this,"plusBtn");gt(this,"minusBtn");gt(this,"bet");gt(this,"textInput");gt(this,"dollarLabel");gt(this,"incrementer");gt(this,"_enabled");gt(this,"nDecimals");gt(this,"maxValue");gt(this,"minValue");gt(this,"tooltip");this.scale.set(.8),this.incrementer=s,this.bet=e,this.nDecimals=a,this.maxValue=c,this.minValue=h,this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:270,height:70,alpha:.5,shadow:!1}),this.container.addChild(this.panelBase),this.layout=new Layout({type:"horizontal"}),this.layout.x=-this.panelBase.boxWidth*.5+38,this.container.addChild(this.layout),this.minusBtn=new MinusButton,this.minusBtn.onPress.connect(this.decremented.bind(this)),this.layout.addChild(this.minusBtn),this.dollarLabel=new Label(r,{fontFamily:"Epilogue Bold",fontSize:24,fill:16777215}),this.layout.addChild(this.dollarLabel),this.textInput=new TextInput({placeholder:"bets",fontSize:22,width:120,height:50,align:"right"},a,u=>{this.bet=u},h,c),this.textInput.value=this.bet.toFixed(this.nDecimals),this.textInput.pivot.x=this.textInput.width*.3,this.textInput.pivot.y=this.textInput.height/2,this.textInput.on("mouseover",()=>this._enabled&&this.tooltip.showTooltip()),this.textInput.on("mouseout",()=>this.tooltip.hideTooltip()),this.layout.addChild(this.textInput),this.plusBtn=new PlusButton,this.plusBtn.onPress.connect(this.incremented.bind(this)),this.layout.addChild(this.plusBtn),this.plusBtn.enabled=!0,this.minusBtn.enabled=!0,this._enabled=!0,this.tooltip=new Tooltip({text:o,width:380,height:80,labelFontSize:22,radius:24,labelAlpha:.7}),this.tooltip.y=-130,this.tooltip.x=-200,o&&this.container.addChild(this.tooltip)}incremented(){if(this.bet+this.incrementer<=this.maxValue){let e=(this.bet+this.incrementer).toFixed(this.nDecimals);this.bet=parseFloat(e),this.textInput.value=e}else this.bet=this.maxValue,this.textInput.value=this.bet.toFixed(this.nDecimals)}decremented(){if(this.bet-this.incrementer>=this.minValue){let e=(this.bet-this.incrementer).toFixed(this.nDecimals);this.bet=parseFloat(e),this.textInput.value=e}else this.bet=this.minValue,this.textInput.value=this.bet.toFixed(this.nDecimals)}set value(e){this.bet=e,this.textInput.value=this.bet.toFixed(this.nDecimals)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.textInput.enabled=e,this.minusBtn.enabled=e,this.plusBtn.enabled=e}}const defaultLogoOptions={scale:.5};class Logo extends Container{constructor(e={}){super();gt(this,"image");gt(this,"imageScale");const s={...defaultLogoOptions,...e};this.imageScale=s.scale,this.image=Sprite.from("logo-r10-crash"),this.image.scale.set(s.scale),this.image.anchor.set(.5),this.addChild(this.image),responsive.getIsDesktop?this.scale.set(1):this.scale.set(.8)}async show(e=!0){gsapWithCSS.killTweensOf(this.image.scale),this.visible=!0,e?(this.image.scale.set(0),await gsapWithCSS.to(this.image.scale,{x:this.imageScale,y:this.imageScale,duration:.3,ease:"back.out"})):this.image.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.image.scale),e?await gsapWithCSS.to(this.image.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.image.scale.set(0),this.visible=!1}}const defaultButtonOptions={text:"",width:155,height:70,labelColor:2369584,labelFontSize:20,radius:20};class Button extends FancyButton{constructor(e={}){const s={...defaultButtonOptions,...e},r=new NineSlicePlane(Texture.from("button"),s.radius,s.radius,s.radius,s.radius);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-hover"),s.radius,s.radius,s.radius,s.radius);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button"),s.radius,s.radius,s.radius,s.radius);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-disabled"),s.radius,s.radius,s.radius,s.radius);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.scale.set(.8),this.x=38,this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(e){this.label.style.fill=e}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class AutomaticCashing extends Container{constructor(e,s,r,a,h,c,o,u,d=.45,m=0){super();gt(this,"container");gt(this,"panelBase");gt(this,"titleLabel");gt(this,"bets");gt(this,"switch");gt(this,"switchValue");gt(this,"_enabled");gt(this,"tooltip");const p=i18n.translatedText;this.scale.set(.8),this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:680,height:70,alpha:d,shadow:!1,color:m}),this.container.addChild(this.panelBase),this.switch=new Switcher([Sprite.from("switch-off"),Sprite.from("switch-on")]),this.switchValue=s,this.switch.forceSwitch(this.switchValue?1:0),this.switch.pivot.x=this.panelBase.boxWidth*.5-130,this.switch.pivot.y=this.switch.height/2,this.switch.x=-this.panelBase.boxWidth*.5+280,this.switch.onChange.connect(g=>{this._enabled?this.switchValue=typeof g=="boolean"?g:g!==0:this.switch.forceSwitch(this.switchValue?1:0)}),this.switch.scale.set(1.2),this.switch.on("mouseover",()=>this._enabled&&!this.switchValue&&this.tooltip.showTooltip()),this.switch.on("mouseout",()=>this.tooltip.hideTooltip()),this.container.addChild(this.switch),this.titleLabel=new Label(r,{fontFamily:"Epilogue Bold",fontSize:18,fill:16777215}),this.titleLabel.anchor.set(0),this.titleLabel.x=-this.panelBase.boxWidth*.5+100,this.titleLabel.y=-10,this.container.addChild(this.titleLabel),this.bets=new Bets(e,1,a,h,c,o,u),this.bets.scale.set(.6),this.bets.x=this.panelBase.boxWidth-440,this.container.addChild(this.bets),this.tooltip=new Tooltip({text:p.warningAutoBet,width:260,height:80,labelFontSize:14,radius:24,alignIndicador:AlignIndicador.LEFT,labelAlpha:.7}),this.tooltip.y=-130,this.tooltip.x=-250,this.addChild(this.tooltip),this._enabled=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.bets.enabled=e,this.container.alpha=e?1:.5}get value(){return this.switchValue}switchOff(e=0){this.switch.forceSwitch(e),this.switchValue=!1}get bet(){return this.bets.bet}updateText(e){this.titleLabel.text=e}}class ProgressBarMultiplier extends ProgressBar{constructor(e,s="1.00x",r=0){super({bg:"progressbar-bg",fill:"progressbar",progress:r});gt(this,"multiplierLabel");gt(this,"image");gt(this,"maxMultiplier");gt(this,"_maxWidth",400);gt(this,"lastFloorMultiplier");this.maxMultiplier=e,this.lastFloorMultiplier=1,this.multiplierLabel=new Label(s,{fontSize:90,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.multiplierLabel.pivot.x=this.multiplierLabel.width/2,this.multiplierLabel.anchor.x=0,this.multiplierLabel.x=this.width/2,this.multiplierLabel.y=80,this.addChild(this.multiplierLabel),this.image=Sprite.from("balon"),this.image.y=-5,this.image.x=-5,this.addChild(this.image)}set multiplier(e){const s=Math.log(e)/Math.log(this.maxMultiplier),r=this._maxWidth*s-5;this.progress=100*s,this.image.x=r>this._maxWidth?this._maxWidth:r,this.multiplierLabel.text=`${e.toFixed(2)}x`;const a=Math.floor(e);this.lastFloorMultiplier!=a&&(this.lastFloorMultiplier=a,gsapWithCSS.killTweensOf(this.multiplierLabel.scale),this.multiplierLabel.scale.set(.86),gsapWithCSS.to(this.multiplierLabel.scale,{x:1,y:1,duration:.4,ease:"back.out"}))}}class ConnectionStatus extends Container{constructor(){super();gt(this,"hasStableConnection");gt(this,"container");gt(this,"stableBg");gt(this,"unstableBg");gt(this,"unstableImage");gt(this,"stableImage");gt(this,"statusLabel");this.container=new Container,this.addChild(this.container),this.stableBg=new Graphics,this.stableBg.beginFill(1746517),this.stableBg.drawRoundedRect(0,0,230,40,10),this.stableBg.visible=!1,this.stableBg.endFill(),this.container.addChild(this.stableBg),this.unstableBg=new Graphics,this.unstableBg.beginFill(16711680),this.unstableBg.drawRoundedRect(0,0,230,40,10),this.unstableBg.visible=!1,this.unstableBg.endFill(),this.container.addChild(this.unstableBg),this.stableImage=Sprite.from("stable-connection"),this.stableImage.visible=!1,this.stableImage.scale.set(.8),this.stableImage.anchor.set(.5),this.container.addChild(this.stableImage),this.unstableImage=Sprite.from("unstable-connection"),this.unstableImage.visible=!1,this.unstableImage.scale.set(.8),this.unstableImage.anchor.set(.5),this.container.addChild(this.unstableImage),this.statusLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14,fill:16777215},!1),this.container.addChild(this.statusLabel),this.resize(),responsive.getIsDesktop?this.scale.set(1):this.scale.set(.6)}async stableConnection(e){this.statusLabel.text=i18n.translatedText.stableConnectionText(e),this.hasStableConnection!==!0&&(this.hasStableConnection=!0,this.unstableImage.visible=!1,this.unstableBg.visible=!1,this.stableImage.visible=!0,this.stableBg.visible=!0,await this.show())}async unstableConnection(e){this.statusLabel.text=i18n.translatedText.unstableConnectionText(e),this.hasStableConnection!==!1&&(this.hasStableConnection=!1,this.stableImage.visible=!1,this.stableBg.visible=!1,this.unstableImage.visible=!0,this.unstableBg.visible=!0,await this.show())}async show(e=!0){gsapWithCSS.killTweensOf(this.container.scale),this.visible=!0,e?(this.container.scale.set(0),await gsapWithCSS.to(this.container.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.container.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.container.scale),e?await gsapWithCSS.to(this.container.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.container.scale.set(0),this.visible=!1}resize(){this.stableImage.x=20,this.stableImage.y=20,this.unstableImage.x=20,this.unstableImage.y=20,this.statusLabel.x=40,this.statusLabel.y=this.height/2}}class StorageWrapper{getString(t){return localStorage.getItem(t)??void 0}setString(t,e){localStorage.setItem(t,e)}getNumber(t){const e=this.getString(t)??void 0,s=Number(e);return isNaN(s)?null:s}setNumber(t,e){this.setString(t,String(e))}getBool(t){const e=localStorage.getItem(t);if(e)return e.toLowerCase()==="true"}setBool(t,e){localStorage.setItem(t,String(e))}getObject(t){const e=this.getString(t);if(e)try{return JSON.parse(e)}catch(s){console.warn(s);return}}setObject(t,e){this.setString(t,JSON.stringify(e))}}const storage=new StorageWrapper,KEY_VOLUME_MASTER="volume-master",KEY_VOLUME_BGM="volume-bgm",KEY_VOLUME_SFX="volume-sfx",KEY_ANIMATION="animation";class UserSettings{constructor(){bgm.setVolume(this.getBgmVolume()),sfx.setVolume(this.getSfxVolume()),animation.setAnimation(this.getAnimation())}getAnimation(){return storage.getBool(KEY_ANIMATION)??!0}setAnimation(t){animation.setAnimation(t),storage.setBool(KEY_ANIMATION,t)}getMasterVolume(){return storage.getNumber(KEY_VOLUME_MASTER)??.5}setMasterVolume(t){setMasterVolume(t),storage.setNumber(KEY_VOLUME_MASTER,t)}getBgmVolume(){return storage.getNumber(KEY_VOLUME_BGM)??1}setBgmVolume(t){bgm.setVolume(t),storage.setNumber(KEY_VOLUME_BGM,t)}getSfxVolume(){return storage.getNumber(KEY_VOLUME_SFX)??1}setSfxVolume(t){sfx.setVolume(t),storage.setNumber(KEY_VOLUME_SFX,t)}}const userSettings=new UserSettings,defaultSettingHeaderOption={icon:"icon-animation",showIcon:!0,title:"",subtitle:""};class SettingHeader extends Layout{constructor(e={}){const s={...defaultSettingHeaderOption,...e};super({type:"horizontal",elementsMargin:16});gt(this,"icon");gt(this,"layout");gt(this,"title");gt(this,"subtitle");this.icon=Sprite.from(s.icon),s.showIcon&&this.addChild(this.icon),this.layout=new Layout({type:"vertical",elementsMargin:0}),this.addChild(this.layout),this.title=new Label(s.title,{align:"left",fill:16777215,fontSize:14,fontFamily:"Epilogue Bold"}),this.title.anchor.x=0,this.title.y=-50,this.layout.addChild(this.title),this.subtitle=new Label(s.subtitle,{align:"left",fill:16777215,fontSize:12}),this.subtitle.anchor.x=0,this.subtitle.y=-28,this.subtitle.alpha=.5,this.layout.addChild(this.subtitle)}}class Divider extends Container{constructor(){super();gt(this,"divider");this.divider=new Graphics().beginFill(16777215,.1).drawRoundedRect(0,0,280,1,10).beginFill(16777215).drawRoundedRect(4,4,280-4*2,1-4*2,10),this.addChild(this.divider)}}const defaultVolumeSliderOption={showDivider:!0,title:"",subtitle:"",min:-.1,max:100,value:100};class VolumeSlider extends Layout{constructor(e={},s){const r=Texture.from("icon-volume"),a=Texture.from("icon-volume-average"),h=Texture.from("icon-volume-mute"),c=240,o=2,u=10,d=4,m=9,p=1477704,g=16744993,_=1477704,y=16777215,v=new Graphics().beginFill(y,.4).drawRoundedRect(0,0,c,o,u).beginFill(y).drawRoundedRect(d,d,c-d*2,o-d*2,u),U=new Graphics().beginFill(_).drawRoundedRect(0,0,c,o,u).beginFill(g).drawRoundedRect(d,d,c-d*2,o-d*2,u),w=new Graphics().drawCircle(0,0,m).beginFill(p).drawCircle(0,0,m).endFill(),k={...defaultVolumeSliderOption,...e};super({type:"vertical",elementsMargin:10});gt(this,"layout");gt(this,"icon");gt(this,"settingHeader");gt(this,"slider");gt(this,"divider");this.settingHeader=new SettingHeader({showIcon:!1,title:k.title,subtitle:k.subtitle}),this.addChild(this.settingHeader),this.layout=new Layout({type:"horizontal",horPadding:10}),this.addChild(this.layout),this.icon=new Sprite(r),this.icon.anchor.set(.5),this.layout.addChild(this.icon),this.slider=new Slider({bg:v,fill:U,slider:w,min:k.min,max:k.max,value:k.value}),this.slider.onUpdate.connect(N=>{N<=0?this.icon.texture=h:N>0&&N<60?this.icon.texture=a:this.icon.texture=r,s(N)}),this.layout.addChild(this.slider),this.divider=new Divider,k.showDivider&&this.addChild(this.divider)}get value(){return this.slider.value}set value(e){this.slider.value=e}}const defaultSwitchAnimationOption={showDivider:!0};class SwitchAnimation extends Layout{constructor(e={}){const s={...defaultSwitchAnimationOption,...e};super({type:"vertical",elementsMargin:10});gt(this,"layout");gt(this,"switch");gt(this,"settingHeader");gt(this,"divider");let r=i18n.translatedText;this.layout=new Layout({type:"horizontal",elementsMargin:70}),this.addChild(this.layout),this.settingHeader=new SettingHeader({icon:"icon-animation",title:r.settingsAnimationTitle,subtitle:r.settingsAnimationSubtitle}),this.layout.addChild(this.settingHeader),this.switch=new Switcher([Sprite.from("switch-off"),Sprite.from("switch-on")]),this.switch.forceSwitch(Number(userSettings.getAnimation())),this.switch.onChange.connect(a=>{userSettings.setAnimation(typeof a=="boolean"?a:a!==0)}),this.switch.scale.set(1.2),this.layout.addChild(this.switch),this.divider=new Divider,s.showDivider&&this.addChild(this.divider)}updateText(){let e=i18n.translatedText;this.settingHeader.title.text=e.settingsAnimationTitle,this.settingHeader.subtitle.text=e.settingsAnimationSubtitle}}const LanguageMap={Portuguese:Language.PT,English:Language.EN,Spanish:Language.ES},defaultSelectLanguageOption={backgroundColor:0,borderColor:16777215,dropDownBackgroundColor:0,dropDownHoverColor:8092539,fontColor:16777215,fontSize:14,width:280,height:40,radius:8,itemsAmount:100};class SelectLanguage extends Layout{constructor(e,s={}){const r={...defaultSelectLanguageOption,...s};super({type:"vertical",elementsMargin:10});gt(this,"settingHeader");gt(this,"select");let a=i18n.translatedText;this.settingHeader=new SettingHeader({icon:"icon-language",title:a.settingsLangTitle,subtitle:a.settingsLangSubtitle}),this.addChild(this.settingHeader);const h={fill:r.fontColor,fontSize:r.fontSize};let c={closedBG:this.getClosedBG(r.backgroundColor,r.borderColor,r.width,r.height,r.radius),openBG:this.getOpenBG(r.dropDownBackgroundColor,r.borderColor,r.width,r.height,r.radius),textStyle:h,items:{items:Object.keys(LanguageMap),backgroundColor:r.backgroundColor,hoverColor:r.dropDownHoverColor,width:r.width,height:r.height,textStyle:{...h,dropShadowBlur:5},radius:r.radius},scrollBox:{radius:r.radius}};this.select=new Select(c),this.select.onSelect.connect((o,u)=>{i18n.language=LanguageMap[u];let d=i18n.translatedText;this.settingHeader.title.text=d.settingsLangTitle,this.settingHeader.subtitle.text=d.settingsLangSubtitle,e&&e()}),this.addChild(this.select)}getOpenBG(e,s,r,a,h){const c=new Graphics().beginFill(e).lineStyle({width:1,color:s,alpha:.2}).drawRoundedRect(0,0,r,a*5,h),o=Sprite.from("icon-arrow-down");return o.angle=180,o.anchor.set(.5),o.x=r*.9,o.y=a/2,c.addChild(o),c}getClosedBG(e,s,r,a,h){const c=new Graphics().beginFill(e,.1).lineStyle({width:1,color:s,alpha:.2}).drawRoundedRect(0,0,r,a,h),o=Sprite.from("icon-arrow-down");return o.anchor.set(.5),o.x=r*.9,o.y=a/2,c.addChild(o),c}}class SettingsPopup extends Container{constructor(){super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"layout");gt(this,"bgmSlider");gt(this,"sfxSlider");gt(this,"switchAnimation");gt(this,"selectLanguage");gt(this,"settingHeaderSupport");gt(this,"divider");gt(this,"layoutSupport");let e=i18n.translatedText;this.bg=Sprite.from(Texture.EMPTY),this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:324,height:500,alpha:.8,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.layout=new Layout({type:"vertical",elementsMargin:10}),this.layout.x=-140,this.layout.y=-this.panelBase.boxHeight*.5+30,this.panel.addChild(this.layout),this.switchAnimation=new SwitchAnimation,this.layout.addChild(this.switchAnimation),this.bgmSlider=new VolumeSlider({title:e.settingsMusicTitle,subtitle:e.settingsMusicSubtitle},r=>{userSettings.setBgmVolume(r/100)}),this.layout.addChild(this.bgmSlider),this.sfxSlider=new VolumeSlider({title:e.settingsSoundEffectsTitle,subtitle:e.settingsSoundEffectsSubtitle},r=>{userSettings.setSfxVolume(r/100)}),this.layout.addChild(this.sfxSlider),this.layoutSupport=new Layout({type:"vertical",elementsMargin:10}),this.layout.addChild(this.layoutSupport),this.settingHeaderSupport=new SettingHeader({icon:"icon-support",title:e.settingsContactSupportTitle,subtitle:e.settingsContactSupportSubtitle}),this.layoutSupport.addChild(this.settingHeaderSupport),this.divider=new Divider,this.layoutSupport.addChild(this.divider);const s=()=>{let r=i18n.translatedText;this.bgmSlider.settingHeader.title.text=r.settingsMusicTitle,this.bgmSlider.settingHeader.subtitle.text=r.settingsMusicSubtitle,this.sfxSlider.settingHeader.title.text=r.settingsSoundEffectsTitle,this.sfxSlider.settingHeader.subtitle.text=r.settingsSoundEffectsSubtitle,this.settingHeaderSupport.title.text=r.settingsContactSupportTitle,this.settingHeaderSupport.subtitle.text=r.settingsContactSupportSubtitle,this.switchAnimation.updateText()};this.selectLanguage=new SelectLanguage(s),this.layout.addChild(this.selectLanguage)}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e-200,this.panel.y=360}prepare(){this.bgmSlider.value=userSettings.getBgmVolume()*100,this.sfxSlider.value=userSettings.getSfxVolume()*100}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),this.bg.alpha=0,this.panel.pivot.y=200,gsapWithCSS.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:300,duration:.3,ease:"back.in"})}}class PanelSettingsPopup extends Container{constructor(){super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"container");gt(this,"layout");gt(this,"settings");gt(this,"expand");gt(this,"minimize");gt(this,"leaderboard");gt(this,"award");gt(this,"info");gt(this,"close");gt(this,"currentModal");this.currentModal=null,this.bg=Sprite.from(Texture.EMPTY),this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new Graphics,this.panelBase.beginFill(264209,.5),this.panelBase.drawRoundedRect(0,0,30,240,8),this.panelBase.x=-15,this.panelBase.y=-100,this.panel.addChild(this.panelBase),this.layout=new Layout({type:"vertical",elementsMargin:20}),this.layout.y=10,this.layout.x=6,this.panelBase.addChild(this.layout),this.info=new IconButton({image:"icon-info"},!1),this.info.onPress.connect(this.toggleInfo.bind(this)),this.layout.addChild(this.info),this.container=new Container,this.layout.addChild(this.container),this.expand=new IconButton({image:"icon-expand"},!1),this.expand.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.expand),this.minimize=new IconButton({image:"icon-minimize"},!1),this.minimize.visible=!1,this.minimize.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.minimize),this.settings=new IconButton({image:"icon-setting"},!1),this.settings.onPress.connect(this.toggleSettings.bind(this)),this.layout.addChild(this.settings),this.award=new IconButton({image:"icon-award"},!1),this.award.onPress.connect(this.toggleAword.bind(this)),this.layout.addChild(this.award),this.leaderboard=new IconButton({image:"icon-leaderboard"},!1),this.leaderboard.onPress.connect(this.toggleLeaderboard.bind(this)),this.layout.addChild(this.leaderboard),this.close=new IconButton({image:"icon-close"},!1),this.layout.addChild(this.close)}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e-25,this.panel.y=200}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),this.bg.alpha=0,this.panel.pivot.y=100,gsapWithCSS.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:300,duration:.3,ease:"back.in"})}toggleModal(e){const s=document.getElementById(e);if(s){this.currentModal=e;const r=s.getAttribute("active")===String(!0);s.setAttribute("active",!r)}}dismissModal(){if(!this.currentModal)return;const e=document.getElementById(this.currentModal);this.currentModal=null,e&&e.setAttribute("active","false")}handlerFullScreen(){if(document.fullscreenElement)this.minimize.visible=!1,this.expand.visible=!0,document.exitFullscreen();else{this.minimize.visible=!0,this.expand.visible=!1;const e=document.body;e==null||e.requestFullscreen()}}toggleSettings(){navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(SettingsPopup)}toggleInfo(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-info")}toggleAword(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-award")}toggleLeaderboard(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-leaderboard")}}class PanelSetting extends Container{constructor(){super();gt(this,"layout");gt(this,"container");gt(this,"settings");gt(this,"expand");gt(this,"minimize");gt(this,"leaderboard");gt(this,"award");gt(this,"info");gt(this,"close");gt(this,"grid");gt(this,"currentModal");this.currentModal=null,this.layout=new Layout({type:"horizontal",elementsMargin:40}),this.layout.visible=responsive.getIsDesktop,this.addChild(this.layout),this.info=new IconButton({image:"icon-info"},!1),this.info.onPress.connect(this.toggleInfo.bind(this)),this.layout.addChild(this.info),this.container=new Container,this.layout.addChild(this.container),this.expand=new IconButton({image:"icon-expand"},!1),this.expand.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.expand),this.minimize=new IconButton({image:"icon-minimize"},!1),this.minimize.visible=!1,this.minimize.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.minimize),this.settings=new IconButton({image:"icon-setting"},!1),this.settings.onPress.connect(this.toggleSettings.bind(this)),this.layout.addChild(this.settings),this.award=new IconButton({image:"icon-award"},!1),this.award.onPress.connect(this.toggleAword.bind(this)),this.layout.addChild(this.award),this.leaderboard=new IconButton({image:"icon-leaderboard"},!1),this.leaderboard.onPress.connect(this.toggleLeaderboard.bind(this)),this.layout.addChild(this.leaderboard),this.close=new IconButton({image:"icon-close"},!1),this.layout.addChild(this.close),this.grid=new IconButton({image:"icon-grid",drawRadius:6,drawWidth:30,drawHeight:30}),this.grid.x=15,this.grid.y=-20,this.grid.visible=!responsive.getIsDesktop,this.grid.onPress.connect(this.toggleGrid.bind(this)),this.addChild(this.grid)}toggleModal(e){const s=document.getElementById(e);if(s){this.currentModal=e;const r=s.getAttribute("active")===String(!0);s.setAttribute("active",!r)}}dismissModal(){if(!this.currentModal)return;const e=document.getElementById(this.currentModal);this.currentModal=null,e&&e.setAttribute("active","false")}handlerFullScreen(){if(document.fullscreenElement)this.minimize.visible=!1,this.expand.visible=!0,document.exitFullscreen();else{this.minimize.visible=!0,this.expand.visible=!1;const e=document.body;e==null||e.requestFullscreen()}}toggleSettings(){if(navigation.currentPopup!==void 0){navigation.dismissPopup();return}navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(SettingsPopup)}toggleInfo(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-info")}toggleAword(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-award")}toggleLeaderboard(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-leaderboard")}toggleGrid(){if(navigation.currentPopup!==void 0){navigation.dismissPopup();return}navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(PanelSettingsPopup)}}class Result extends Container{constructor(e="",s=35,r=45){super();gt(this,"container");gt(this,"layout");gt(this,"label1");gt(this,"label2");this.container=new Container,this.addChild(this.container),this.layout=new Layout({type:"vertical",elementsMargin:-8}),this.container.addChild(this.layout),this.label1=new Label(e,{fontSize:s,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.layout.addChild(this.label1),this.label2=new Label("...",{fontSize:r,fill:16765810,fontFamily:"Epilogue ExtraBold",lineJoin:"bevel",strokeThickness:6}),this.layout.addChild(this.label2)}updateText(e){this.label1.text=e}set winValue(e){this.label2.text=e}set visibleLabel(e){this.label1.visible=e,this.label2.visible=e}}const defaultButtonCancelOptions={text:"",width:155,height:70,labelColor:16777215,labelFontSize:20};class ButtonCancel extends FancyButton{constructor(e={}){const s={...defaultButtonCancelOptions,...e},r=new NineSlicePlane(Texture.from("button-cancel"),10,16,16,20);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-cancel-hover"),16,16,16,20);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button-cancel"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-disabled"),16,16,16,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.scale.set(.8),this.x=38,this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(e){this.label.style.fill=e}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}const showMultipliers=12;class PreviousResults extends Container{constructor(){super();gt(this,"scrollBox");gt(this,"multiplierBadge");gt(this,"widthBadge",100);gt(this,"heightBadge",40);gt(this,"radiusBadge",15);gt(this,"borderBadge",2);gt(this,"borderColorBadge",16777215);gt(this,"graphics");this.multiplierBadge=[];const e=responsive.getIsDesktop?.1:1;this.graphics=new Graphics().beginFill(0,e).drawRoundedRect(0,0,460,180,24).endFill(),this.graphics.pivot.x=this.graphics.width/2,this.addChild(this.graphics),this.scrollBox=new ScrollBox({elementsMargin:10,width:440,height:150,items:this.multipliers,horPadding:2,vertPadding:2}),this.scrollBox.pivot.x=this.scrollBox.width/2,this.scrollBox.pivot.y=this.scrollBox.height/2,this.scrollBox.x=this.graphics.width/2,this.scrollBox.y=this.graphics.height/2,this.graphics.addChild(this.scrollBox)}updateResults(e,s=!1){if(s){let r=Math.min(e.length,showMultipliers-1);this.multiplierBadge[0].textLabel="In Game",this.multiplierBadge[0].graphics.lineStyle(this.borderBadge,this.borderColorBadge).drawRoundedRect(0,0,this.widthBadge,this.heightBadge,this.radiusBadge);for(let a=0;a<r;a++)this.multiplierBadge[a+1].textLabel=`${e[a].toFixed(2)}x`}else{this.multiplierBadge[0].graphics.lineStyle(this.borderBadge,this.listColors[0]).drawRoundedRect(0,0,this.widthBadge,this.heightBadge,this.radiusBadge);let r=Math.min(e.length,showMultipliers);for(let a=0;a<r;a++)this.multiplierBadge[a].textLabel=`${e[a].toFixed(2)}x`}}get multipliers(){const e=[],s=this.listColors;for(let r=0;r<showMultipliers;r+=1){const a=new Badge({width:this.widthBadge,height:this.heightBadge,radius:this.radiusBadge,fill:s[r],labelFontSize:14,isPivot:!1,onClick:!0});this.multiplierBadge.push(a),e.push(a)}return e}get listColors(){return[1155406,4325835,3160385,7798996,10551501,31938,4325835,3160385,7798996,10551501,31938,4325835]}}const defaultButtonResetOptions={text:"",width:100,height:45,labelColor:16777215,labelFontSize:20};class ButtonReset extends FancyButton{constructor(e={}){const s={...defaultButtonResetOptions,...e},r=new NineSlicePlane(Texture.from("button-reset"),20,20,20,20);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-reset-hover"),20,20,20,20);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button-reset"),20,20,20,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-reset-disabled"),20,20,20,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(e){this.label.style.fill=e}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}const defaultButtonLinkOptions={text:"",width:130,height:50,labelColor:16777215,labelFontSize:20};class ButtonLink extends FancyButton{constructor(e={}){const s={...defaultButtonLinkOptions,...e},r=new NineSlicePlane(Texture.from("button-link"),20,20,20,20);r.width=s.width,r.height=s.height;const a=new NineSlicePlane(Texture.from("button-link-disabled"),20,20,20,20);a.width=s.width,a.height=s.height;const h=new NineSlicePlane(Texture.from("button-link"),20,20,20,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-link-disabled"),20,20,20,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:a,pressedView:h,disabledView:c,anchor:.5});gt(this,"label");gt(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(e){this.label.style.fill=e}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class ProblemOccurredPopup extends Container{constructor(){super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"iconReconnecting");gt(this,"titleLabel");gt(this,"subtitleLabel");gt(this,"buttonLabel");this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.5,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({color:0,width:550,height:390,shadow:!1,radius:24}),this.panelBase.filters=[new AlphaFilter(.9),new BlurFilter],this.panel.addChild(this.panelBase),this.iconReconnecting=Sprite.from("icon-problem-occurred"),this.iconReconnecting.y=-140,this.iconReconnecting.anchor.set(.5),this.panel.addChild(this.iconReconnecting),this.titleLabel=new Label("A problem occurred!",{fontFamily:"Epilogue Bold",fontSize:28}),this.titleLabel.y=-90,this.panel.addChild(this.titleLabel),this.subtitleLabel=new Label("We are currently troubleshooting, please try again.",{fontSize:16,breakWords:!0,wordWrap:!0,wordWrapWidth:400}),this.subtitleLabel.y=0,this.subtitleLabel.alpha=.7,this.panel.addChild(this.subtitleLabel),this.buttonLabel=new Label("Volver a intentar",{fontSize:20,fontFamily:"Epilogue Bold"}),this.buttonLabel.y=140,this.panel.addChild(this.buttonLabel),this.buttonLabel.interactive=!0,this.buttonLabel.cursor="pointer"}setText(e,s){this.titleLabel.text=e,this.subtitleLabel.text=s}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e/2,this.panel.y=s/2}async show(){this.bg.alpha=.8}async hide(){this.bg.alpha=0}}class AutoBetPopup extends Container{constructor(){var s,r,a,h,c;super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"layout");gt(this,"label");gt(this,"iconClose");gt(this,"automaticCashingCurrency");gt(this,"automaticCashingMultiplier");gt(this,"numberOfRounds");gt(this,"stopOnProfit");gt(this,"stopOnLoss");gt(this,"onWin");gt(this,"onLoss");gt(this,"startAutoBetButton");gt(this,"bet");gt(this,"problemOcurredPopup");gt(this,"onGameEnding",async e=>{e&&this.upd()});gt(this,"onGamePlaying",async e=>{e&&this.upd()});gt(this,"onGameStarting",async e=>{e&&this.upd()});gt(this,"onGameLocking",async e=>{e&&this.upd()});const e=i18n.translatedText;game.addObserver(this),this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.3,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:600,height:750,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.label=new Label(e.automaticGame,{fontSize:20,fontFamily:"Epilogue Bold"},!1),this.label.y=-this.panelBase.boxHeight*.5+25,this.label.x=-this.panelBase.boxWidth*.5+25,this.panel.addChild(this.label),this.iconClose=new IconButton({image:"icon-close"},!1),this.iconClose.y=-this.panelBase.boxHeight*.5+25,this.iconClose.x=this.panelBase.boxWidth*.5-50,this.iconClose.onPress.connect(()=>navigation.dismissPopup()),this.panel.addChild(this.iconClose),this.bet=new ItemBet(((s=game.bet)==null?void 0:s.coins)||1,e.bet,"$",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxBet,`${e.minimum} x1.01 / ${e.maximum} x${backendConfigs.maxMultiplier}`),this.bet.y=-this.panelBase.boxHeight*.5+120,this.panel.addChild(this.bet),this.automaticCashingMultiplier=new AutomaticCashing(((r=game.bet)==null?void 0:r.autoMultiplier)||2,!!((a=game.bet)!=null&&a.autoMultiplier),e.automaticMultiplierCashingText,"x ",backendConfigs.multiplierPrecision,backendConfigs.minMultiplier,backendConfigs.maxMultiplier,`${e.minimum} x1.01 / ${e.maximum} x${backendConfigs.maxMultiplier}`,.06,16777215),this.automaticCashingMultiplier.y=-this.panelBase.boxHeight*.5+190,this.panel.addChild(this.automaticCashingMultiplier),this.automaticCashingCurrency=new AutomaticCashing(((h=game.bet)==null?void 0:h.autoProfit)||2,!!((c=game.bet)!=null&&c.autoProfit),e.automaticCurrencyCashingText,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxProfit,`${e.maximum} $ ${backendConfigs.maxBet.toFixed(2)}`,.06,16777215),this.automaticCashingCurrency.y=-this.panelBase.boxHeight*.5+260,this.panel.addChild(this.automaticCashingCurrency),this.layout=new Layout({type:"vertical",elementsMargin:16}),this.layout.y=-this.panelBase.boxHeight*.5+330,this.panel.addChild(this.layout),this.numberOfRounds=new ItemSimple(e.numberOfRounds,0,"",1,100),this.layout.addChild(this.numberOfRounds),this.onWin=new ItemOn(e.onWin,backendConfigs.betPrecision,"%",-100,1e5),this.layout.addChild(this.onWin),this.onLoss=new ItemOn(e.onLoss,backendConfigs.betPrecision,"%",-100,1e5),this.layout.addChild(this.onLoss),this.stopOnProfit=new ItemSimple(e.stopOnProfit,backendConfigs.betPrecision,"$",0,1e5),this.layout.addChild(this.stopOnProfit),this.stopOnLoss=new ItemSimple(e.stopOnLoss,backendConfigs.betPrecision,"$",0,1e5),this.layout.addChild(this.stopOnLoss),this.startAutoBetButton=new Button({text:e.startAutoBet,width:300,radius:40}),this.upd(),this.startAutoBetButton.onPress.connect(async()=>{this.iconClose.visible=!1,this.startAutoBetButton.disabled();const o=navigation.currentScreen;if(o instanceof HomeScreen)try{await o.handlerBet(this.bet.bets.bet,this.automaticCashingMultiplier.value?this.automaticCashingMultiplier.bet:void 0,this.automaticCashingCurrency.value?this.automaticCashingCurrency.bet:void 0,{autoRounds:this.numberOfRounds.panelTextInput.bet,betOnWin:this.onWin.panelTextInput.bet*(this.onWin.isIncrease?1:-1),betOnLoss:this.onLoss.panelTextInput.bet*(this.onLoss.isIncrease?1:-1),stopOnProfit:this.stopOnProfit.panelTextInput.bet,stopOnLoss:this.stopOnLoss.panelTextInput.bet}),await navigation.dismissPopup()}catch(u){if(u!=null&&u.validationErrors){let d=u.validationErrors.map(m=>m!=null&&m.args?"- "+m.message(m.args):"- "+m.message);this.problemOcurredPopup.setText("A problem ocurred",`${d.join(`
`)}`),this.problemOcurredPopup.visible=!0}else u!=null&&u.serverError&&(this.problemOcurredPopup.setText("A problem ocurred",`${u.serverError}`),this.problemOcurredPopup.visible=!0);this.iconClose.visible=!0,game.status==BeRqEnum.GAME_START&&this.startAutoBetButton.activated()}else this.iconClose.visible=!0}),this.layout.addChild(this.startAutoBetButton),this.problemOcurredPopup=new ProblemOccurredPopup,this.problemOcurredPopup.visible=!1,this.problemOcurredPopup.buttonLabel.on("click",()=>{this.problemOcurredPopup.visible=!1}),this.addChild(this.problemOcurredPopup),responsive.getIsDesktop?this.panel.scale.set(1):this.panel.scale.set(.6)}resize(e,s){this.problemOcurredPopup.resize(e,s),this.bg.width=e,this.bg.height=s,this.panel.x=e/2,this.panel.y=s/2}upd(){game.bet?(this.bet.bets.value=game.bet.coins,game.bet.autoProfit?(this.automaticCashingCurrency.bets.value=game.bet.autoProfit,this.automaticCashingCurrency.switchOff(1)):this.automaticCashingCurrency.switchOff(0),game.bet.autoMultiplier?(this.automaticCashingMultiplier.bets.value=game.bet.autoMultiplier,this.automaticCashingMultiplier.switchOff(1)):this.automaticCashingMultiplier.switchOff(0),game.bet.auto?(this.numberOfRounds.panelTextInput.value=game.bet.auto.autoRounds,this.onWin.panelTextInput.value=Math.abs(game.bet.auto.betOnWin),this.onLoss.panelTextInput.value=Math.abs(game.bet.auto.betOnLoss),this.onWin.isIncrease=game.bet.auto.betOnWin>=0,this.onLoss.isIncrease=game.bet.auto.betOnLoss>=0,this.stopOnProfit.panelTextInput.value=game.bet.auto.stopOnProfit,this.stopOnLoss.panelTextInput.value=game.bet.auto.stopOnLoss):this.numberOfRounds.panelTextInput.value=1,this.startAutoBetButton.visible=!1):(this.startAutoBetButton.visible=!0,user.status===UserStatusEnum.SPECTING&&game.status!==BeRqEnum.GAME_LOCK?this.startAutoBetButton.activated():this.startAutoBetButton.disabled())}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.from(this.bg,{alpha:.5,duration:.2,ease:"linear"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"})}}gt(AutoBetPopup,"assetBundles",["home","common"]);class ItemBet extends Container{constructor(e,s,r,a,h,c,o){super();gt(this,"panelBaseItem");gt(this,"label");gt(this,"bets");this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(s,{fontSize:16,fontFamily:"Epilogue Bold"}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-10,this.panelBaseItem.addChild(this.label),this.bets=new Bets(e,1,r,a,h,c,o),this.bets.scale.set(.6),this.bets.x=this.panelBaseItem.width-300,this.panelBaseItem.addChild(this.bets)}}class ItemSimple extends Container{constructor(e,s,r,a,h){super();gt(this,"panelBaseItem");gt(this,"label");gt(this,"panelTextInput");this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(e,{fontSize:16,fontFamily:"Epilogue Bold"}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-10,this.panelBaseItem.addChild(this.label),this.panelTextInput=new PanelTextInput(s,r,a,h),this.panelTextInput.x=this.panelBaseItem.width-320,this.panelBaseItem.addChild(this.panelTextInput)}}class ItemOn extends Container{constructor(e,s,r,a,h){super();gt(this,"panelBaseItem");gt(this,"label");gt(this,"panelTextInput");gt(this,"decreaseEnabledBtn");gt(this,"decreaseDisabledBtn");gt(this,"increaseEnabledBtn");gt(this,"increaseDisabledBtn");const c=i18n.translatedText;this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(e,{fontSize:16,fontFamily:"Epilogue Bold",breakWords:!0,wordWrap:!0,wordWrapWidth:80}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-20,this.panelBaseItem.addChild(this.label),this.panelTextInput=new PanelTextInput(s,r,a,h),this.panelTextInput.x=this.panelBaseItem.width-600,this.panelTextInput=new PanelTextInput(s,r,a,h,o=>{this.isIncrease=o===0?null:o>0}),this.panelTextInput.x=-90,this.panelBaseItem.addChild(this.panelTextInput),this.increaseDisabledBtn=new ButtonLink({text:c.increase,labelFontSize:16}),this.increaseDisabledBtn.x=this.panelBaseItem.width-430,this.panelBaseItem.addChild(this.increaseDisabledBtn),this.increaseEnabledBtn=new ButtonReset({text:c.increase,labelFontSize:16,width:130}),this.increaseEnabledBtn.x=this.panelBaseItem.width-430,this.panelBaseItem.addChild(this.increaseEnabledBtn),this.decreaseEnabledBtn=new ButtonReset({text:c.decrease,labelFontSize:16,width:130}),this.decreaseEnabledBtn.x=this.panelBaseItem.width-290,this.panelBaseItem.addChild(this.decreaseEnabledBtn),this.decreaseDisabledBtn=new ButtonLink({text:c.decrease,labelFontSize:16}),this.decreaseDisabledBtn.x=this.panelBaseItem.width-290,this.panelBaseItem.addChild(this.decreaseDisabledBtn),this.increaseEnabledBtn.visible=!1,this.decreaseEnabledBtn.visible=!1}set isIncrease(e){e!==null?(this.increaseEnabledBtn.visible=e,this.decreaseDisabledBtn.visible=e,this.increaseDisabledBtn.visible=!e,this.decreaseEnabledBtn.visible=!e):(this.increaseEnabledBtn.visible=!1,this.decreaseDisabledBtn.visible=!0,this.increaseDisabledBtn.visible=!0,this.decreaseEnabledBtn.visible=!1)}get isIncrease(){return this.increaseDisabledBtn.visible&&this.decreaseDisabledBtn.visible?null:this.increaseEnabledBtn.visible}}class PanelBaseItem extends Container{constructor(){super();gt(this,"panelBase");this.scale.set(.8),this.panelBase=new RoundedBox({width:680,height:70,alpha:.06,shadow:!1,color:16777215}),this.addChild(this.panelBase)}}class PanelTextInput extends Container{constructor(e,s,r,a,h){super();gt(this,"layout");gt(this,"panelBase");gt(this,"container");gt(this,"textInput");gt(this,"dollarLabel");gt(this,"bet");gt(this,"nDecimals");gt(this,"onEnter");this.onEnter=h,this.scale.set(.8),this.bet=0,this.nDecimals=e,this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:250,height:60,alpha:.08,shadow:!1,color:16777215}),this.container.addChild(this.panelBase),this.layout=new Layout({type:"horizontal"}),this.layout.x=-this.panelBase.boxWidth*.5+50,this.container.addChild(this.layout),this.dollarLabel=new Label(s,{fontFamily:"Epilogue Bold",fontSize:24}),s&&this.layout.addChild(this.dollarLabel),this.textInput=new TextInput({placeholder:"bets",fontSize:22,width:350,height:50},e,c=>{this.bet=c,h&&h(c)},r,a),this.textInput.value=this.bet.toFixed(this.nDecimals),this.textInput.pivot.x=this.textInput.width*.3,this.textInput.pivot.y=this.textInput.height/2,this.layout.addChild(this.textInput)}set value(e){this.bet=e,this.textInput.value=this.bet.toFixed(this.nDecimals),this.onEnter&&this.onEnter(e)}}const defaultPreviousButtonOptions={text:"",drawWidth:25,labelColor:16777215,labelFontSize:14,radius:20};class PreviousButton extends FancyButton{constructor(e={}){const s={...defaultPreviousButtonOptions,...e},r=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),a=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),h=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),c=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth);super({defaultView:r,hoverView:a,pressedView:h,disabledView:c});gt(this,"label");gt(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set text(e){this.label.text=e}set fillDisabledLabel(e){this.label.style.fill=e}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(e=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,e?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(e=!0){gsapWithCSS.killTweensOf(this.scale),e?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class HomeScreen extends Container{constructor(){var r,a,h,c,o;super();gt(this,"playerSkin");gt(this,"nextGameLabel");gt(this,"betClosedLabel");gt(this,"gameOverLabel");gt(this,"youWinLabel");gt(this,"backgroundFanLabels");gt(this,"header");gt(this,"bets");gt(this,"logo");gt(this,"graphicsAutomaticCashing");gt(this,"automaticCashingCurrency");gt(this,"automaticCashingMultiplier");gt(this,"progressBar");gt(this,"connectionStatus");gt(this,"panelSetting");gt(this,"previousResults");gt(this,"layout");gt(this,"containerBtn");gt(this,"betButton");gt(this,"cancelButton");gt(this,"cashoutButton");gt(this,"undoButton");gt(this,"replayButton");gt(this,"previousResultButton");gt(this,"automaticCashingButton");gt(this,"problemOcurredPopup");gt(this,"onGameEnding",async e=>{if(!e)return;let s=!!game.bet;this.automaticCashingCurrency.enabled=!s,this.automaticCashingMultiplier.enabled=!s,this.bets.enabled=!s,this.betButton.hide(!1),this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!1,game.hasWon?(this.youWinLabel.visibleLabel=!0,this.gameOverLabel.winValue=`${game.multiplier.toFixed(2)}x`,this.gameOverLabel.visibleLabel=!0):(this.youWinLabel.visibleLabel=!1,this.gameOverLabel.winValue=`${game.multiplier.toFixed(2)}x`,this.gameOverLabel.visibleLabel=!0),this.playerSkin.crashPlayer(),await waitFor(1),this.playerSkin.init(),await this.logo.show()});gt(this,"onGamePlaying",async e=>{e&&(user.status===UserStatusEnum.SPECTING?(this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.automaticCashingCurrency.switchOff(),this.automaticCashingMultiplier.switchOff(),this.cancelButton.visible=!1,this.betButton.show(!0),this.betButton.activated(),this.cashoutButton.hide(!0)):user.status===UserStatusEnum.BETTING?(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!0,this.betButton.hide(!0),this.betButton.disabled(),this.cashoutButton.hide(!1)):(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!1,this.betButton.hide(!0),this.betButton.disabled(),this.cashoutButton.show(!0)),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cashoutButton.enabled=!0,this.progressBar.visible=!0,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!1,this.gameOverLabel.visibleLabel=!1,this.youWinLabel.visibleLabel=!1,await this.logo.hide(),this.playerSkin.playFreestyle()),this.progressBar.multiplier=game.multiplier});gt(this,"onGameStarting",async e=>{let s=!!game.bet;e&&(this.automaticCashingCurrency.enabled=!s,this.automaticCashingMultiplier.enabled=!s,this.bets.enabled=!s,this.undoButton.enabled=!0,this.replayButton.enabled=!0,user.status===UserStatusEnum.SPECTING?(this.cancelButton.visible=!1,this.betButton.show(!0),this.betButton.activated()):user.status===UserStatusEnum.BETTING?(this.cancelButton.visible=!0,this.betButton.visible=!1):(this.cancelButton.visible=!0,this.betButton.visible=!1),this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!0,this.betClosedLabel.visible=!1,this.gameOverLabel.visibleLabel=!1,this.youWinLabel.visibleLabel=!1,this.playerSkin.init());const r=(game.startAt.getTime()-new Date().getTime())/1e3;r>=0&&(this.nextGameLabel.text=i18n.translatedText.nextGameLabelText(r))});gt(this,"onGameLocking",async e=>{e&&(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.betButton.show(!1),this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cancelButton.visible=!1,this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!0,this.gameOverLabel.visibleLabel=!1)});gt(this,"handlerBet",async(e,s,r,a)=>{this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!1,this.betButton.visible=!0,this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0;try{if(user.budget-e<0)throw Error("Not Enough Coins");let{coins:h}=await backendService.bet(e,s,r,a);this.betButton.visible=!1,this.cancelButton.activated(),this.cancelButton.visible=!0,this.bets.value=h,this.header.refreshUserDetails(),this.bets.value=e,r?(this.automaticCashingCurrency.bets.value=r,this.automaticCashingCurrency.switchOff(1)):this.automaticCashingCurrency.switchOff(0),s?(this.automaticCashingMultiplier.bets.value=s,this.automaticCashingMultiplier.switchOff(1)):this.automaticCashingMultiplier.switchOff(0);return}catch(h){throw this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.betButton.visible=!0,this.betButton.activated(),this.undoButton.enabled=!0,this.replayButton.enabled=!0,this.cancelButton.visible=!1,h}});gt(this,"handlerCancelBet",async()=>{this.cancelButton.disabled();try{await backendService.cancelBet(),this.header.refreshUserDetails(),this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.betButton.show(!0),this.betButton.activated(),this.undoButton.enabled=!0,this.replayButton.enabled=!0,this.cancelButton.visible=!1}catch{this.cancelButton.activated()}});gt(this,"handlerCashout",async()=>{this.cashoutButton.enabled=!1;let e=await backendService.cashOut();e.profit>0&&(this.youWinLabel.winValue=`$${e.profit.toFixed(2)}`,this.youWinLabel.visibleLabel=!0,this.cancelButton.visible=!1,this.header.refreshUserDetails())});const e=i18n.translatedText;this.logo=new Logo({scale:.25}),this.addChild(this.logo),this.playerSkin=new PlayerSkin,this.addChild(this.playerSkin),this.layout=new Layout({type:"horizontal",elementsMargin:10}),this.addChild(this.layout),this.undoButton=new IconButton({image:"icon-unde",imageDisabled:"icon-unde-disabled"}),this.layout.addChild(this.undoButton),this.containerBtn=new Container,this.containerBtn.pivot.x=this.containerBtn.width/2,this.containerBtn.pivot.y=this.containerBtn.height/2,this.layout.addChild(this.containerBtn),this.betButton=new Button({text:e.betButtonText}),this.betButton.onPress.connect(()=>{this.handlerBet(this.bets.bet,this.automaticCashingMultiplier.value?this.automaticCashingMultiplier.bet:void 0,this.automaticCashingCurrency.value?this.automaticCashingCurrency.bet:void 0).then(()=>{}).catch(u=>{if(u!=null&&u.validationErrors){let d=u.validationErrors.map(m=>m!=null&&m.args?"- "+m.message(m.args):"- "+m.message);this.problemOcurredPopup.setText("A problem ocurred",`${d.join(`
`)}`),this.problemOcurredPopup.visible=!0}else u!=null&&u.serverError&&(this.problemOcurredPopup.setText("A problem ocurred",`${u.serverError}`),this.problemOcurredPopup.visible=!0)})}),this.containerBtn.addChild(this.betButton),this.cancelButton=new ButtonCancel({text:e.cancelButtonText}),this.cancelButton.onPress.connect(this.handlerCancelBet.bind(this)),this.cancelButton.visible=!1,this.containerBtn.addChild(this.cancelButton),this.cashoutButton=new Button({text:e.cashOutButtonText}),this.cashoutButton.onPress.connect(this.handlerCashout.bind(this)),this.containerBtn.addChild(this.cashoutButton),this.replayButton=new IconButton({image:"icon-replay",imageDisabled:"icon-replay-disabled"}),this.replayButton.onPress.connect(()=>navigation.presentPopup(AutoBetPopup)),this.layout.addChild(this.replayButton),this.previousResultButton=new PreviousButton({text:"G"}),this.previousResultButton.onPress.connect(()=>{this.previousResults.visible=!this.previousResults.visible}),this.addChild(this.previousResultButton),this.automaticCashingButton=new IconButton({image:"icon-tool",imageDisabled:"icon-replay-disabled"}),this.automaticCashingButton.onPress.connect(()=>{this.graphicsAutomaticCashing.visible=!this.graphicsAutomaticCashing.visible}),this.addChild(this.automaticCashingButton),this.header=new Header,this.addChild(this.header),this.bets=new Bets(((r=game.bet)==null?void 0:r.coins)||1,1,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxBet),this.addChild(this.bets);const s=responsive.getIsDesktop?.1:1;this.graphicsAutomaticCashing=new Graphics().beginFill(0,s).drawRoundedRect(0,0,480,160,24).endFill(),this.graphicsAutomaticCashing.pivot.x=this.graphicsAutomaticCashing.width/2,this.addChild(this.graphicsAutomaticCashing),this.automaticCashingCurrency=new AutomaticCashing(((a=game.bet)==null?void 0:a.autoProfit)||2,!!((h=game.bet)!=null&&h.autoProfit),e.automaticCurrencyCashingText,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxProfit,`${e.maximum} $ ${backendConfigs.maxBet.toFixed(2)}`),this.automaticCashingMultiplier=new AutomaticCashing(((c=game.bet)==null?void 0:c.autoMultiplier)||2,!!((o=game.bet)!=null&&o.autoMultiplier),e.automaticMultiplierCashingText,"x ",backendConfigs.multiplierPrecision,backendConfigs.minMultiplier,backendConfigs.maxMultiplier,`${e.minimum} x1.01 / ${e.maximum} x${backendConfigs.maxMultiplier}`),responsive.getIsDesktop?(this.previousResultButton.visible=!1,this.automaticCashingButton.visible=!1,this.graphicsAutomaticCashing.visible=!0):(this.previousResultButton.visible=!0,this.automaticCashingButton.visible=!0,this.graphicsAutomaticCashing.visible=!1),this.automaticCashingMultiplier.x=this.graphicsAutomaticCashing.width/2,this.automaticCashingMultiplier.y=40,this.automaticCashingCurrency.x=this.graphicsAutomaticCashing.width/2,this.automaticCashingCurrency.y=110,this.graphicsAutomaticCashing.addChild(this.automaticCashingCurrency),this.graphicsAutomaticCashing.addChild(this.automaticCashingMultiplier),this.progressBar=new ProgressBarMultiplier(backendConfigs.maxMultiplier),this.progressBar.pivot.x=this.progressBar.width/2,this.addChild(this.progressBar),this.nextGameLabel=new Label("",{fontSize:45,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.nextGameLabel.visible=!1,this.addChild(this.nextGameLabel),this.gameOverLabel=new Result(e.gameOverLabelText),this.gameOverLabel.visibleLabel=!1,this.addChild(this.gameOverLabel),this.backgroundFanLabels={},this.betClosedLabel=new Label(e.betClosedLabelText,{fontSize:45,fill:15887982,stroke:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.betClosedLabel.visible=!1,this.addChild(this.betClosedLabel),this.connectionStatus=new ConnectionStatus,this.connectionStatus.stableConnection(0),backendService.sentLatencyStatus=u=>{u<=100?this.connectionStatus.stableConnection(u):this.connectionStatus.unstableConnection(u)},this.addChild(this.connectionStatus),this.panelSetting=new PanelSetting,this.addChild(this.panelSetting),this.youWinLabel=new Result(e.youWinLabelText),this.youWinLabel.visibleLabel=!1,this.addChild(this.youWinLabel),this.previousResults=new PreviousResults,responsive.getIsDesktop||(this.previousResults.visible=!1),backendService.callbackPreviousMultipliers=(u,d)=>{d?this.previousResultButton.text="G":this.previousResultButton.text=`${u[0]}x`,this.previousResults.updateResults(u,d)},this.addChild(this.previousResults),backendService.callbackAutomaticCashOut=u=>{u>0&&(this.youWinLabel.winValue=`$${u.toFixed(2)}`,this.youWinLabel.visibleLabel=!0,this.cancelButton.visible=!1,this.header.refreshUserDetails())},backendService.callbackBackgroundFan=u=>{const d=new Result(i18n.translatedText.backgroundFanText,15,20);d.visibleLabel=!1,this.addChild(d),d.x=window.innerWidth*.7,d.y=window.innerHeight*.3;const m=uuid_1.v4();this.backgroundFanLabels[m]=d,d.winValue=u.toFixed(2),d.visibleLabel=!0,setTimeout(()=>{d.visibleLabel=!1,this.removeChild(d),delete this.backgroundFanLabels[m]},2e3)},game.addObserver(this),game.flush(),this.problemOcurredPopup=new ProblemOccurredPopup,this.problemOcurredPopup.visible=!1,this.problemOcurredPopup.interactive=!0,this.problemOcurredPopup.on("click",()=>{this.problemOcurredPopup.visible=!1}),this.addChild(this.problemOcurredPopup),i18n.callback=u=>{this.betButton.label.text=u.betButtonText,this.cancelButton.label.text=u.cancelButtonText,this.cashoutButton.label.text=u.cashOutButtonText,this.betClosedLabel.text=u.betClosedLabelText,this.automaticCashingCurrency.updateText(u.automaticCurrencyCashingText),this.automaticCashingMultiplier.updateText(u.automaticMultiplierCashingText),this.gameOverLabel.updateText(u.gameOverLabelText),this.youWinLabel.updateText(u.youWinLabelText),Object.values(this.backgroundFanLabels).forEach(d=>{d.updateText(u.backgroundFanText)})}}resize(e,s){this.logo.x=e*.5,this.logo.y=190,this.playerSkin.x=e/2,this.playerSkin.y=s*.76,this.layout.pivot.x=this.layout.width/2,this.layout.pivot.y=this.layout.height/2,this.layout.x=e*.5+25,this.layout.y=s-40,this.nextGameLabel.x=e*.5,this.nextGameLabel.y=s*.5,this.gameOverLabel.x=e*.5,this.gameOverLabel.y=s*.55,Object.values(this.backgroundFanLabels).forEach(r=>{r.x=e*.7,r.y=s*.3}),this.betClosedLabel.x=e*.5,this.betClosedLabel.y=s*.5,this.youWinLabel.x=e*.5,this.youWinLabel.y=s*.45,this.progressBar.x=e*.5,this.progressBar.y=120,this.header.resize(e),this.bets.x=e/2,this.bets.y=s-140,this.connectionStatus.x=10,this.connectionStatus.y=70,responsive.getIsDesktop?(this.previousResults.x=e-250,this.previousResults.y=s-200,this.graphicsAutomaticCashing.x=300,this.graphicsAutomaticCashing.y=s-180,this.panelSetting.x=e-355,this.panelSetting.y=80):(this.previousResults.x=e/2,this.previousResults.y=s-350,this.graphicsAutomaticCashing.x=e/2,this.graphicsAutomaticCashing.y=s-340,this.panelSetting.x=e-40,this.panelSetting.y=100),this.problemOcurredPopup.resize(e,s),this.previousResultButton.x=e/2+140,this.previousResultButton.y=s-140,this.automaticCashingButton.x=e/2-140,this.automaticCashingButton.y=s-140}update(){animation.getAnimation()?this.playerSkin.show(!1):this.playerSkin.hide(!1)}async show(){bgm.play("common/bgm-main.mp3",{volume:.7}),animation.getAnimation()?this.playerSkin.show(!1):this.playerSkin.hide(!1),await waitFor(.5),this.interactiveChildren=!0}async hide(){await waitFor(.1),gsapWithCSS.killTweensOf(this.playerSkin)}}gt(HomeScreen,"assetBundles",["home","common"]);class LoadScreen extends Container{constructor(){super();gt(this,"fsLogo");gt(this,"message");gt(this,"logo");this.logo=new Logo({scale:.3}),this.addChild(this.logo),this.fsLogo=new FsLogo({scale:1.2}),this.addChild(this.fsLogo),this.message=new Text(i18n.translatedText.loadingMessage,{fill:0,fontFamily:"Verdana",align:"center"}),this.message.anchor.set(.5),this.addChild(this.message)}resize(e,s){this.logo.x=e*.5,this.logo.y=s*.5,this.message.x=e*.5,this.message.y=s*.75,this.fsLogo.x=e*.5,this.fsLogo.y=s-50}async show(){gsapWithCSS.killTweensOf(this.message),this.message.alpha=1}async hide(){this.message.text=i18n.translatedText.loadingDoneMessage,gsapWithCSS.killTweensOf(this.message),await gsapWithCSS.to(this.message,{alpha:0,duration:.3,ease:"linear",delay:.5})}}gt(LoadScreen,"assetBundles",["preload"]);class BackgroundStadium extends Container{constructor(){super();gt(this,"direction",-Math.PI*.15);gt(this,"sprite");gt(this,"spriteBg");this.sprite=new Sprite(Texture.from("stadium")),console.log("width = ",this.sprite.width),this.spriteBg=new Sprite(Texture.from("bg-stadius")),this.sprite.anchor.set(.5,0),this.spriteBg.anchor.set(.5,0),this.addChild(this.sprite),this.addChild(this.spriteBg)}get width(){return this.sprite.width}get height(){return this.sprite.height}resize(e,s){this.sprite.x=.5*e,this.sprite.y=0,this.sprite.scale.set(s/this.sprite.height),this.spriteBg.x=.5*e,this.spriteBg.y=0,this.spriteBg.width=e,this.spriteBg.height=s}}class ConnectionLostPopup extends Container{constructor(){super();gt(this,"bg");gt(this,"panel");gt(this,"panelBase");gt(this,"iconReconnecting");gt(this,"title");gt(this,"subtitle");this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.3,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:450,height:250,shadow:!1,radius:24}),this.panelBase.filters=[new AlphaFilter(.6),new BlurFilter],this.panel.addChild(this.panelBase),this.iconReconnecting=Sprite.from("icon-reconnecting"),this.iconReconnecting.y=-70,this.iconReconnecting.anchor.set(.5),this.panel.addChild(this.iconReconnecting),this.title=new Label("You are reconnecting",{fontFamily:"Epilogue Bold",fontSize:28}),this.title.y=-10,this.panel.addChild(this.title),this.subtitle=new Label("Hold on a moment, we are trying to reconnect you.",{fontSize:16,breakWords:!0,wordWrap:!0,wordWrapWidth:400}),this.subtitle.y=40,this.subtitle.alpha=.7,this.panel.addChild(this.subtitle)}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e/2,this.panel.y=s/2}async show(){this.bg.alpha=.8}async hide(){this.bg.alpha=0}}const app=new Application({resolution:Math.max(window.devicePixelRatio,2),backgroundColor:16777215});function resize(){const n=DESKTOP_WIDTH,t=DESKTOP_HEIGHT;if(responsive.getIsDesktop){app.renderer.view.style.width=`${n}px`,app.renderer.view.style.height=`${t}px`,window.scrollTo(0,0);let e,s;e=document.getElementById("scaleable-container"),s=document.getElementById("game-container");let r=Math.min(e.clientWidth/s.clientWidth,e.clientHeight/s.clientHeight),a=Math.round(s.clientWidth*r),h=Math.round(s.clientHeight*r),c=a/s.clientWidth,o=h/s.clientHeight;s.style.transform=`translate(-50%, -50%) scale(${c},${o})`;const u=n,d=t;app.renderer.resize(u,d),navigation.resize(u,d)}else{const e=window.innerWidth,s=window.innerHeight,r=375,a=700,h=e<r?r/e:1.2,c=s<a?a/s:1.2,o=h>c?h:c,u=e*o,d=s*o;app.renderer.view.style.width=`${e}px`,app.renderer.view.style.height=`${s}px`,window.scrollTo(0,0);let m;m=document.getElementById("game-container"),m.style.height="100%",app.renderer.resize(u,d),navigation.resize(u,d)}}function visibilityChange(){document.hidden?(qt.pauseAll(),navigation.blur()):(qt.resumeAll(),navigation.focus())}async function initGame(){try{await backendService.startConnection(async()=>{navigation.currentScreen instanceof ConnectionLostPopup||await navigation.presentPopup(ConnectionLostPopup),await initGame()}),navigation.dismissPopup(),await navigation.showScreen(HomeScreen)}catch{await waitFor(.5),await initGame()}}async function init(){var e;app.view.id="CrashGameFS",(e=document.getElementById("pixiContainer"))==null||e.appendChild(app.view);const n=1920,t=window.innerWidth>n?n:window.innerWidth;responsive.checkResponsive(t),window.addEventListener("resize",resize),resize(),document.addEventListener("visibilitychange",visibilityChange),await initAssets(),navigation.setBackground(BackgroundStadium),await navigation.showScreen(LoadScreen),app.ticker.add(game.update,game),await initGame()}init();
