var gt=Object.defineProperty;var _t=(n,e,t)=>e in n?gt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ne=(n,e,t)=>(_t(n,typeof e!="symbol"?e+"":e,t),t),rt=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Ke=(n,e,t)=>(rt(n,e,"read from private field"),t?t.call(n):e.get(n)),et=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},it=(n,e,t,s)=>(rt(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const index="";var AttachmentType=(n=>(n[n.Region=0]="Region",n[n.BoundingBox=1]="BoundingBox",n[n.Mesh=2]="Mesh",n[n.LinkedMesh=3]="LinkedMesh",n[n.Path=4]="Path",n[n.Point=5]="Point",n[n.Clipping=6]="Clipping",n))(AttachmentType||{});class BinaryInput{constructor(e,t=new Array,s=0,r=new DataView(e.buffer)){this.strings=t,this.index=s,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const e=this.buffer.getInt16(this.index);return this.index+=2,e}readInt32(){const e=this.buffer.getInt32(this.index);return this.index+=4,e}readInt(e){let t=this.readByte(),s=t&127;return t&128&&(t=this.readByte(),s|=(t&127)<<7,t&128&&(t=this.readByte(),s|=(t&127)<<14,t&128&&(t=this.readByte(),s|=(t&127)<<21,t&128&&(t=this.readByte(),s|=(t&127)<<28)))),e?s:s>>>1^-(s&1)}readStringRef(){const e=this.readInt(!0);return e==0?null:this.strings[e-1]}readString(){let e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;let t="";for(let s=0;s<e;){const r=this.readUnsignedByte();switch(r>>4){case 12:case 13:t+=String.fromCharCode((r&31)<<6|this.readByte()&63),s+=2;break;case 14:t+=String.fromCharCode((r&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),s+=3;break;default:t+=String.fromCharCode(r),s++}}return t}readFloat(){const e=this.buffer.getFloat32(this.index);return this.index+=4,e}readBoolean(){return this.readByte()!=0}}var MixBlend=(n=>(n[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",n))(MixBlend||{}),MixDirection=(n=>(n[n.mixIn=0]="mixIn",n[n.mixOut=1]="mixOut",n))(MixDirection||{}),PositionMode=(n=>(n[n.Fixed=0]="Fixed",n[n.Percent=1]="Percent",n))(PositionMode||{}),RotateMode=(n=>(n[n.Tangent=0]="Tangent",n[n.Chain=1]="Chain",n[n.ChainScale=2]="ChainScale",n))(RotateMode||{}),TransformMode=(n=>(n[n.Normal=0]="Normal",n[n.OnlyTranslation=1]="OnlyTranslation",n[n.NoRotationOrReflection=2]="NoRotationOrReflection",n[n.NoScale=3]="NoScale",n[n.NoScaleOrReflection=4]="NoScaleOrReflection",n))(TransformMode||{}),ENV=(n=>(n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2",n))(ENV||{}),BUFFER_BITS=(n=>(n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL",n))(BUFFER_BITS||{}),BLEND_MODES=(n=>(n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR",n))(BLEND_MODES||{}),DRAW_MODES=(n=>(n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n))(DRAW_MODES||{}),FORMATS=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(FORMATS||{}),TARGETS=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(TARGETS||{}),TYPES=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(TYPES||{}),SAMPLER_TYPES=(n=>(n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT",n))(SAMPLER_TYPES||{}),SCALE_MODES=(n=>(n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR",n))(SCALE_MODES||{}),WRAP_MODES=(n=>(n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n))(WRAP_MODES||{}),MIPMAP_MODES=(n=>(n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL",n))(MIPMAP_MODES||{}),ALPHA_MODES=(n=>(n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",n))(ALPHA_MODES||{}),CLEAR_MODES=(n=>(n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT",n))(CLEAR_MODES||{}),GC_MODES=(n=>(n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",n))(GC_MODES||{}),PRECISION=(n=>(n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp",n))(PRECISION||{}),MASK_TYPES=(n=>(n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR",n))(MASK_TYPES||{}),MSAA_QUALITY=(n=>(n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH",n))(MSAA_QUALITY||{}),BUFFER_TYPE=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(BUFFER_TYPE||{});const BrowserAdapter={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")},settings$1={ADAPTER:BrowserAdapter,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function createMatch(n){return function(e){return e.test(n)}}function isMobile$1(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,s=t.split("[FBAN");typeof s[1]<"u"&&(t=s[0]),s=t.split("Twitter"),typeof s[1]<"u"&&(t=s[0]);var r=createMatch(t),o={apple:{phone:r(appleIphone)&&!r(windowsPhone),ipod:r(appleIpod),tablet:!r(appleIphone)&&(r(appleTablet)||isAppleTabletOnIos13(e))&&!r(windowsPhone),universal:r(appleUniversal),device:(r(appleIphone)||r(appleIpod)||r(appleTablet)||r(appleUniversal)||isAppleTabletOnIos13(e))&&!r(windowsPhone)},amazon:{phone:r(amazonPhone),tablet:!r(amazonPhone)&&r(amazonTablet),device:r(amazonPhone)||r(amazonTablet)},android:{phone:!r(windowsPhone)&&r(amazonPhone)||!r(windowsPhone)&&r(androidPhone),tablet:!r(windowsPhone)&&!r(amazonPhone)&&!r(androidPhone)&&(r(amazonTablet)||r(androidTablet)),device:!r(windowsPhone)&&(r(amazonPhone)||r(amazonTablet)||r(androidPhone)||r(androidTablet))||r(/\bokhttp\b/i)},windows:{phone:r(windowsPhone),tablet:r(windowsTablet),device:r(windowsPhone)||r(windowsTablet)},other:{blackberry:r(otherBlackBerry),blackberry10:r(otherBlackBerry10),opera:r(otherOpera),firefox:r(otherFirefox),chrome:r(otherChrome),device:r(otherBlackBerry)||r(otherBlackBerry10)||r(otherOpera)||r(otherFirefox)||r(otherChrome)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const isMobile=isMobile$1(globalThis.navigator);settings$1.RETINA_PREFIX=/@([0-9\.]+)x/;settings$1.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},eventemitter3Exports={},eventemitter3={get exports(){return eventemitter3Exports},set exports(n){eventemitter3Exports=n}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function r(a,u,d){this.fn=a,this.context=u,this.once=d||!1}function o(a,u,d,p,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new r(d,p||a,m),_=t?t+u:u;return a._events[_]?a._events[_].fn?a._events[_]=[a._events[_],g]:a._events[_].push(g):(a._events[_]=g,a._eventsCount++),a}function h(a,u){--a._eventsCount===0?a._events=new s:delete a._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],d,p;if(this._eventsCount===0)return u;for(p in d=this._events)e.call(d,p)&&u.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},c.prototype.listeners=function(u){var d=t?t+u:u,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,g=p.length,_=new Array(g);m<g;m++)_[m]=p[m].fn;return _},c.prototype.listenerCount=function(u){var d=t?t+u:u,p=this._events[d];return p?p.fn?1:p.length:0},c.prototype.emit=function(u,d,p,m,g,_){var y=t?t+u:u;if(!this._events[y])return!1;var v=this._events[y],N=arguments.length,w,k;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),N){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,p),!0;case 4:return v.fn.call(v.context,d,p,m),!0;case 5:return v.fn.call(v.context,d,p,m,g),!0;case 6:return v.fn.call(v.context,d,p,m,g,_),!0}for(k=1,w=new Array(N-1);k<N;k++)w[k-1]=arguments[k];v.fn.apply(v.context,w)}else{var U=v.length,ee;for(k=0;k<U;k++)switch(v[k].once&&this.removeListener(u,v[k].fn,void 0,!0),N){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,d);break;case 3:v[k].fn.call(v[k].context,d,p);break;case 4:v[k].fn.call(v[k].context,d,p,m);break;default:if(!w)for(ee=1,w=new Array(N-1);ee<N;ee++)w[ee-1]=arguments[ee];v[k].fn.apply(v[k].context,w)}}return!0},c.prototype.on=function(u,d,p){return o(this,u,d,p,!1)},c.prototype.once=function(u,d,p){return o(this,u,d,p,!0)},c.prototype.removeListener=function(u,d,p,m){var g=t?t+u:u;if(!this._events[g])return this;if(!d)return h(this,g),this;var _=this._events[g];if(_.fn)_.fn===d&&(!m||_.once)&&(!p||_.context===p)&&h(this,g);else{for(var y=0,v=[],N=_.length;y<N;y++)(_[y].fn!==d||m&&!_[y].once||p&&_[y].context!==p)&&v.push(_[y]);v.length?this._events[g]=v.length===1?v[0]:v:h(this,g)}return this},c.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&h(this,d)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,n.exports=c})(eventemitter3);var earcutExports={},earcut$1={get exports(){return earcutExports},set exports(n){earcutExports=n}};earcut$1.exports=earcut;earcutExports.default=earcut;function earcut(n,e,t){t=t||2;var s=e&&e.length,r=s?e[0]*t:n.length,o=linkedList(n,0,r,t,!0),h=[];if(!o||o.next===o.prev)return h;var c,a,u,d,p,m,g;if(s&&(o=eliminateHoles(n,e,o,t)),n.length>80*t){c=u=n[0],a=d=n[1];for(var _=t;_<r;_+=t)p=n[_],m=n[_+1],p<c&&(c=p),m<a&&(a=m),p>u&&(u=p),m>d&&(d=m);g=Math.max(u-c,d-a),g=g!==0?32767/g:0}return earcutLinked(o,h,t,c,a,g,0),h}function linkedList(n,e,t,s,r){var o,h;if(r===signedArea(n,e,t,s)>0)for(o=e;o<t;o+=s)h=insertNode(o,n[o],n[o+1],h);else for(o=t-s;o>=e;o-=s)h=insertNode(o,n[o],n[o+1],h);return h&&equals(h,h.next)&&(removeNode(h),h=h.next),h}function filterPoints(n,e){if(!n)return n;e||(e=n);var t=n,s;do if(s=!1,!t.steiner&&(equals(t,t.next)||area(t.prev,t,t.next)===0)){if(removeNode(t),t=e=t.prev,t===t.next)break;s=!0}else t=t.next;while(s||t!==e);return e}function earcutLinked(n,e,t,s,r,o,h){if(n){!h&&o&&indexCurve(n,s,r,o);for(var c=n,a,u;n.prev!==n.next;){if(a=n.prev,u=n.next,o?isEarHashed(n,s,r,o):isEar(n)){e.push(a.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),removeNode(n),n=u.next,c=u.next;continue}if(n=u,n===c){h?h===1?(n=cureLocalIntersections(filterPoints(n),e,t),earcutLinked(n,e,t,s,r,o,2)):h===2&&splitEarcut(n,e,t,s,r,o):earcutLinked(filterPoints(n),e,t,s,r,o,1);break}}}}function isEar(n){var e=n.prev,t=n,s=n.next;if(area(e,t,s)>=0)return!1;for(var r=e.x,o=t.x,h=s.x,c=e.y,a=t.y,u=s.y,d=r<o?r<h?r:h:o<h?o:h,p=c<a?c<u?c:u:a<u?a:u,m=r>o?r>h?r:h:o>h?o:h,g=c>a?c>u?c:u:a>u?a:u,_=s.next;_!==e;){if(_.x>=d&&_.x<=m&&_.y>=p&&_.y<=g&&pointInTriangle(r,c,o,a,h,u,_.x,_.y)&&area(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function isEarHashed(n,e,t,s){var r=n.prev,o=n,h=n.next;if(area(r,o,h)>=0)return!1;for(var c=r.x,a=o.x,u=h.x,d=r.y,p=o.y,m=h.y,g=c<a?c<u?c:u:a<u?a:u,_=d<p?d<m?d:m:p<m?p:m,y=c>a?c>u?c:u:a>u?a:u,v=d>p?d>m?d:m:p>m?p:m,N=zOrder(g,_,e,t,s),w=zOrder(y,v,e,t,s),k=n.prevZ,U=n.nextZ;k&&k.z>=N&&U&&U.z<=w;){if(k.x>=g&&k.x<=y&&k.y>=_&&k.y<=v&&k!==r&&k!==h&&pointInTriangle(c,d,a,p,u,m,k.x,k.y)&&area(k.prev,k,k.next)>=0||(k=k.prevZ,U.x>=g&&U.x<=y&&U.y>=_&&U.y<=v&&U!==r&&U!==h&&pointInTriangle(c,d,a,p,u,m,U.x,U.y)&&area(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;k&&k.z>=N;){if(k.x>=g&&k.x<=y&&k.y>=_&&k.y<=v&&k!==r&&k!==h&&pointInTriangle(c,d,a,p,u,m,k.x,k.y)&&area(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;U&&U.z<=w;){if(U.x>=g&&U.x<=y&&U.y>=_&&U.y<=v&&U!==r&&U!==h&&pointInTriangle(c,d,a,p,u,m,U.x,U.y)&&area(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function cureLocalIntersections(n,e,t){var s=n;do{var r=s.prev,o=s.next.next;!equals(r,o)&&intersects(r,s,s.next,o)&&locallyInside(r,o)&&locallyInside(o,r)&&(e.push(r.i/t|0),e.push(s.i/t|0),e.push(o.i/t|0),removeNode(s),removeNode(s.next),s=n=o),s=s.next}while(s!==n);return filterPoints(s)}function splitEarcut(n,e,t,s,r,o){var h=n;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&isValidDiagonal(h,c)){var a=splitPolygon(h,c);h=filterPoints(h,h.next),a=filterPoints(a,a.next),earcutLinked(h,e,t,s,r,o,0),earcutLinked(a,e,t,s,r,o,0);return}c=c.next}h=h.next}while(h!==n)}function eliminateHoles(n,e,t,s){var r=[],o,h,c,a,u;for(o=0,h=e.length;o<h;o++)c=e[o]*s,a=o<h-1?e[o+1]*s:n.length,u=linkedList(n,c,a,s,!1),u===u.next&&(u.steiner=!0),r.push(getLeftmost(u));for(r.sort(compareX),o=0;o<r.length;o++)t=eliminateHole(r[o],t);return t}function compareX(n,e){return n.x-e.x}function eliminateHole(n,e){var t=findHoleBridge(n,e);if(!t)return e;var s=splitPolygon(t,n);return filterPoints(s,s.next),filterPoints(t,t.next)}function findHoleBridge(n,e){var t=e,s=n.x,r=n.y,o=-1/0,h;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var c=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(c<=s&&c>o&&(o=c,h=t.x<t.next.x?t:t.next,c===s))return h}t=t.next}while(t!==e);if(!h)return null;var a=h,u=h.x,d=h.y,p=1/0,m;t=h;do s>=t.x&&t.x>=u&&s!==t.x&&pointInTriangle(r<d?s:o,r,u,d,r<d?o:s,r,t.x,t.y)&&(m=Math.abs(r-t.y)/(s-t.x),locallyInside(t,n)&&(m<p||m===p&&(t.x>h.x||t.x===h.x&&sectorContainsSector(h,t)))&&(h=t,p=m)),t=t.next;while(t!==a);return h}function sectorContainsSector(n,e){return area(n.prev,n,e.prev)<0&&area(e.next,n,n.next)<0}function indexCurve(n,e,t,s){var r=n;do r.z===0&&(r.z=zOrder(r.x,r.y,e,t,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,sortLinked(r)}function sortLinked(n){var e,t,s,r,o,h,c,a,u=1;do{for(t=n,n=null,o=null,h=0;t;){for(h++,s=t,c=0,e=0;e<u&&(c++,s=s.nextZ,!!s);e++);for(a=u;c>0||a>0&&s;)c!==0&&(a===0||!s||t.z<=s.z)?(r=t,t=t.nextZ,c--):(r=s,s=s.nextZ,a--),o?o.nextZ=r:n=r,r.prevZ=o,o=r;t=s}o.nextZ=null,u*=2}while(h>1);return n}function zOrder(n,e,t,s,r){return n=(n-t)*r|0,e=(e-s)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function getLeftmost(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function pointInTriangle(n,e,t,s,r,o,h,c){return(r-h)*(e-c)>=(n-h)*(o-c)&&(n-h)*(s-c)>=(t-h)*(e-c)&&(t-h)*(o-c)>=(r-h)*(s-c)}function isValidDiagonal(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!intersectsPolygon(n,e)&&(locallyInside(n,e)&&locallyInside(e,n)&&middleInside(n,e)&&(area(n.prev,n,e.prev)||area(n,e.prev,e))||equals(n,e)&&area(n.prev,n,n.next)>0&&area(e.prev,e,e.next)>0)}function area(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function equals(n,e){return n.x===e.x&&n.y===e.y}function intersects(n,e,t,s){var r=sign$1(area(n,e,t)),o=sign$1(area(n,e,s)),h=sign$1(area(t,s,n)),c=sign$1(area(t,s,e));return!!(r!==o&&h!==c||r===0&&onSegment(n,t,e)||o===0&&onSegment(n,s,e)||h===0&&onSegment(t,n,s)||c===0&&onSegment(t,e,s))}function onSegment(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function sign$1(n){return n>0?1:n<0?-1:0}function intersectsPolygon(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&intersects(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function locallyInside(n,e){return area(n.prev,n,n.next)<0?area(n,e,n.next)>=0&&area(n,n.prev,e)>=0:area(n,e,n.prev)<0||area(n,n.next,e)<0}function middleInside(n,e){var t=n,s=!1,r=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(s=!s),t=t.next;while(t!==n);return s}function splitPolygon(n,e){var t=new Node(n.i,n.x,n.y),s=new Node(e.i,e.x,e.y),r=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,s.next=t,t.prev=s,o.next=s,s.prev=o,s}function insertNode(n,e,t,s){var r=new Node(n,e,t);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function removeNode(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Node(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}earcut.deviation=function(n,e,t,s){var r=e&&e.length,o=r?e[0]*t:n.length,h=Math.abs(signedArea(n,0,o,t));if(r)for(var c=0,a=e.length;c<a;c++){var u=e[c]*t,d=c<a-1?e[c+1]*t:n.length;h-=Math.abs(signedArea(n,u,d,t))}var p=0;for(c=0;c<s.length;c+=3){var m=s[c]*t,g=s[c+1]*t,_=s[c+2]*t;p+=Math.abs((n[m]-n[_])*(n[g+1]-n[m+1])-(n[m]-n[g])*(n[_+1]-n[m+1]))}return h===0&&p===0?0:Math.abs((p-h)/h)};function signedArea(n,e,t,s){for(var r=0,o=e,h=t-s;o<t;o+=s)r+=(n[h]-n[o])*(n[o+1]+n[h+1]),h=o;return r}earcut.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},s=0,r=0;r<n.length;r++){for(var o=0;o<n[r].length;o++)for(var h=0;h<e;h++)t.vertices.push(n[r][o][h]);r>0&&(s+=n[r-1].length,t.holes.push(s))}return t};var punycodeExports={},punycode$1={get exports(){return punycodeExports},set exports(n){punycodeExports=n}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(n,e){(function(t){var s=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,o=typeof commonjsGlobal=="object"&&commonjsGlobal;(o.global===o||o.window===o||o.self===o)&&(t=o);var h,c=2147483647,a=36,u=1,d=26,p=38,m=700,g=72,_=128,y="-",v=/^xn--/,N=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},U=a-u,ee=Math.floor,ie=String.fromCharCode,se;function oe(xe){throw RangeError(k[xe])}function le(xe,Se){for(var Me=xe.length,Oe=[];Me--;)Oe[Me]=Se(xe[Me]);return Oe}function ue(xe,Se){var Me=xe.split("@"),Oe="";Me.length>1&&(Oe=Me[0]+"@",xe=Me[1]),xe=xe.replace(w,".");var Ie=xe.split("."),Fe=le(Ie,Se).join(".");return Oe+Fe}function he(xe){for(var Se=[],Me=0,Oe=xe.length,Ie,Fe;Me<Oe;)Ie=xe.charCodeAt(Me++),Ie>=55296&&Ie<=56319&&Me<Oe?(Fe=xe.charCodeAt(Me++),(Fe&64512)==56320?Se.push(((Ie&1023)<<10)+(Fe&1023)+65536):(Se.push(Ie),Me--)):Se.push(Ie);return Se}function pe(xe){return le(xe,function(Se){var Me="";return Se>65535&&(Se-=65536,Me+=ie(Se>>>10&1023|55296),Se=56320|Se&1023),Me+=ie(Se),Me}).join("")}function de(xe){return xe-48<10?xe-22:xe-65<26?xe-65:xe-97<26?xe-97:a}function fe(xe,Se){return xe+22+75*(xe<26)-((Se!=0)<<5)}function Te(xe,Se,Me){var Oe=0;for(xe=Me?ee(xe/m):xe>>1,xe+=ee(xe/Se);xe>U*d>>1;Oe+=a)xe=ee(xe/U);return ee(Oe+(U+1)*xe/(xe+p))}function Ce(xe){var Se=[],Me=xe.length,Oe,Ie=0,Fe=_,Ne=g,Ue,Be,_e,ge,ve,Ee,we,Re,Le;for(Ue=xe.lastIndexOf(y),Ue<0&&(Ue=0),Be=0;Be<Ue;++Be)xe.charCodeAt(Be)>=128&&oe("not-basic"),Se.push(xe.charCodeAt(Be));for(_e=Ue>0?Ue+1:0;_e<Me;){for(ge=Ie,ve=1,Ee=a;_e>=Me&&oe("invalid-input"),we=de(xe.charCodeAt(_e++)),(we>=a||we>ee((c-Ie)/ve))&&oe("overflow"),Ie+=we*ve,Re=Ee<=Ne?u:Ee>=Ne+d?d:Ee-Ne,!(we<Re);Ee+=a)Le=a-Re,ve>ee(c/Le)&&oe("overflow"),ve*=Le;Oe=Se.length+1,Ne=Te(Ie-ge,Oe,ge==0),ee(Ie/Oe)>c-Fe&&oe("overflow"),Fe+=ee(Ie/Oe),Ie%=Oe,Se.splice(Ie++,0,Fe)}return pe(Se)}function be(xe){var Se,Me,Oe,Ie,Fe,Ne,Ue,Be,_e,ge,ve,Ee=[],we,Re,Le,Xe;for(xe=he(xe),we=xe.length,Se=_,Me=0,Fe=g,Ne=0;Ne<we;++Ne)ve=xe[Ne],ve<128&&Ee.push(ie(ve));for(Oe=Ie=Ee.length,Ie&&Ee.push(y);Oe<we;){for(Ue=c,Ne=0;Ne<we;++Ne)ve=xe[Ne],ve>=Se&&ve<Ue&&(Ue=ve);for(Re=Oe+1,Ue-Se>ee((c-Me)/Re)&&oe("overflow"),Me+=(Ue-Se)*Re,Se=Ue,Ne=0;Ne<we;++Ne)if(ve=xe[Ne],ve<Se&&++Me>c&&oe("overflow"),ve==Se){for(Be=Me,_e=a;ge=_e<=Fe?u:_e>=Fe+d?d:_e-Fe,!(Be<ge);_e+=a)Xe=Be-ge,Le=a-ge,Ee.push(ie(fe(ge+Xe%Le,0))),Be=ee(Xe/Le);Ee.push(ie(fe(Be,0))),Fe=Te(Me,Re,Oe==Ie),Me=0,++Oe}++Me,++Se}return Ee.join("")}function Ae(xe){return ue(xe,function(Se){return v.test(Se)?Ce(Se.slice(4).toLowerCase()):Se})}function Pe(xe){return ue(xe,function(Se){return N.test(Se)?"xn--"+be(Se):Se})}if(h={version:"1.3.2",ucs2:{decode:he,encode:pe},decode:Ce,encode:be,toASCII:Pe,toUnicode:Ae},s&&r)if(n.exports==s)r.exports=h;else for(se in h)h.hasOwnProperty(se)&&(s[se]=h[se]);else t.punycode=h})(commonjsGlobal)})(punycode$1,punycodeExports);var util$9={isString:function(n){return typeof n=="string"},isObject:function(n){return typeof n=="object"&&n!==null},isNull:function(n){return n===null},isNullOrUndefined:function(n){return n==null}},querystring$1={};function hasOwnProperty(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var decode=function(n,e,t,s){e=e||"&",t=t||"=";var r={};if(typeof n!="string"||n.length===0)return r;var o=/\+/g;n=n.split(e);var h=1e3;s&&typeof s.maxKeys=="number"&&(h=s.maxKeys);var c=n.length;h>0&&c>h&&(c=h);for(var a=0;a<c;++a){var u=n[a].replace(o,"%20"),d=u.indexOf(t),p,m,g,_;d>=0?(p=u.substr(0,d),m=u.substr(d+1)):(p=u,m=""),g=decodeURIComponent(p),_=decodeURIComponent(m),hasOwnProperty(r,g)?Array.isArray(r[g])?r[g].push(_):r[g]=[r[g],_]:r[g]=_}return r},stringifyPrimitive=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}},encode=function(n,e,t,s){return e=e||"&",t=t||"=",n===null&&(n=void 0),typeof n=="object"?Object.keys(n).map(function(r){var o=encodeURIComponent(stringifyPrimitive(r))+t;return Array.isArray(n[r])?n[r].map(function(h){return o+encodeURIComponent(stringifyPrimitive(h))}).join(e):o+encodeURIComponent(stringifyPrimitive(n[r]))}).join(e):s?encodeURIComponent(stringifyPrimitive(s))+t+encodeURIComponent(stringifyPrimitive(n)):""};querystring$1.decode=querystring$1.parse=decode;querystring$1.encode=querystring$1.stringify=encode;var punycode=punycodeExports,util$8=util$9,parse$1=urlParse,resolve=urlResolve,format=urlFormat;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r",`
`,"	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=querystring$1;function urlParse(n,e,t){if(n&&util$8.isObject(n)&&n instanceof Url)return n;var s=new Url;return s.parse(n,e,t),s}Url.prototype.parse=function(n,e,t){if(!util$8.isString(n))throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var s=n.indexOf("?"),r=s!==-1&&s<n.indexOf("#")?"?":"#",o=n.split(r),h=/\\/g;o[0]=o[0].replace(h,"/"),n=o.join(r);var c=n;if(c=c.trim(),!t&&n.split("#").length===1){var a=simplePathPattern.exec(c);if(a)return this.path=c,this.href=c,this.pathname=a[1],a[2]?(this.search=a[2],e?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=protocolPattern.exec(c);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,c=c.substr(u.length)}if(t||u||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var p=c.substr(0,2)==="//";p&&!(u&&hostlessProtocol[u])&&(c=c.substr(2),this.slashes=!0)}if(!hostlessProtocol[u]&&(p||u&&!slashedProtocol[u])){for(var m=-1,g=0;g<hostEndingChars.length;g++){var _=c.indexOf(hostEndingChars[g]);_!==-1&&(m===-1||_<m)&&(m=_)}var y,v;m===-1?v=c.lastIndexOf("@"):v=c.lastIndexOf("@",m),v!==-1&&(y=c.slice(0,v),c=c.slice(v+1),this.auth=decodeURIComponent(y)),m=-1;for(var g=0;g<nonHostChars.length;g++){var _=c.indexOf(nonHostChars[g]);_!==-1&&(m===-1||_<m)&&(m=_)}m===-1&&(m=c.length),this.host=c.slice(0,m),c=c.slice(m),this.parseHost(),this.hostname=this.hostname||"";var N=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!N)for(var w=this.hostname.split(/\./),g=0,k=w.length;g<k;g++){var U=w[g];if(U&&!U.match(hostnamePartPattern)){for(var ee="",ie=0,se=U.length;ie<se;ie++)U.charCodeAt(ie)>127?ee+="x":ee+=U[ie];if(!ee.match(hostnamePartPattern)){var oe=w.slice(0,g),le=w.slice(g+1),ue=U.match(hostnamePartStart);ue&&(oe.push(ue[1]),le.unshift(ue[2])),le.length&&(c="/"+le.join(".")+c),this.hostname=oe.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),N||(this.hostname=punycode.toASCII(this.hostname));var he=this.port?":"+this.port:"",pe=this.hostname||"";this.host=pe+he,this.href+=this.host,N&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),c[0]!=="/"&&(c="/"+c))}if(!unsafeProtocol[d])for(var g=0,k=autoEscape.length;g<k;g++){var de=autoEscape[g];if(c.indexOf(de)!==-1){var fe=encodeURIComponent(de);fe===de&&(fe=escape(de)),c=c.split(de).join(fe)}}var Te=c.indexOf("#");Te!==-1&&(this.hash=c.substr(Te),c=c.slice(0,Te));var Ce=c.indexOf("?");if(Ce!==-1?(this.search=c.substr(Ce),this.query=c.substr(Ce+1),e&&(this.query=querystring.parse(this.query)),c=c.slice(0,Ce)):e&&(this.search="",this.query={}),c&&(this.pathname=c),slashedProtocol[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var he=this.pathname||"",be=this.search||"";this.path=he+be}return this.href=this.format(),this};function urlFormat(n){return util$8.isString(n)&&(n=urlParse(n)),n instanceof Url?n.format():Url.prototype.format.call(n)}Url.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",s=this.hash||"",r=!1,o="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&util$8.isObject(this.query)&&Object.keys(this.query).length&&(o=querystring.stringify(this.query));var h=this.search||o&&"?"+o||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||slashedProtocol[e])&&r!==!1?(r="//"+(r||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),h&&h.charAt(0)!=="?"&&(h="?"+h),t=t.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),h=h.replace("#","%23"),e+r+t+h+s};function urlResolve(n,e){return urlParse(n,!1,!0).resolve(e)}Url.prototype.resolve=function(n){return this.resolveObject(urlParse(n,!1,!0)).format()};Url.prototype.resolveObject=function(n){if(util$8.isString(n)){var e=new Url;e.parse(n,!1,!0),n=e}for(var t=new Url,s=Object.keys(this),r=0;r<s.length;r++){var o=s[r];t[o]=this[o]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var h=Object.keys(n),c=0;c<h.length;c++){var a=h[c];a!=="protocol"&&(t[a]=n[a])}return slashedProtocol[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!slashedProtocol[n.protocol]){for(var u=Object.keys(n),d=0;d<u.length;d++){var p=u[d];t[p]=n[p]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!hostlessProtocol[n.protocol]){for(var k=(n.pathname||"").split("/");k.length&&!(n.host=k.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),k[0]!==""&&k.unshift(""),k.length<2&&k.unshift(""),t.pathname=k.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var m=t.pathname||"",g=t.search||"";t.path=m+g}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var _=t.pathname&&t.pathname.charAt(0)==="/",y=n.host||n.pathname&&n.pathname.charAt(0)==="/",v=y||_||t.host&&n.pathname,N=v,w=t.pathname&&t.pathname.split("/")||[],k=n.pathname&&n.pathname.split("/")||[],U=t.protocol&&!slashedProtocol[t.protocol];if(U&&(t.hostname="",t.port=null,t.host&&(w[0]===""?w[0]=t.host:w.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(k[0]===""?k[0]=n.host:k.unshift(n.host)),n.host=null),v=v&&(k[0]===""||w[0]==="")),y)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,w=k;else if(k.length)w||(w=[]),w.pop(),w=w.concat(k),t.search=n.search,t.query=n.query;else if(!util$8.isNullOrUndefined(n.search)){if(U){t.hostname=t.host=w.shift();var ee=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;ee&&(t.auth=ee.shift(),t.host=t.hostname=ee.shift())}return t.search=n.search,t.query=n.query,(!util$8.isNull(t.pathname)||!util$8.isNull(t.search))&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!w.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var ie=w.slice(-1)[0],se=(t.host||n.host||w.length>1)&&(ie==="."||ie==="..")||ie==="",oe=0,le=w.length;le>=0;le--)ie=w[le],ie==="."?w.splice(le,1):ie===".."?(w.splice(le,1),oe++):oe&&(w.splice(le,1),oe--);if(!v&&!N)for(;oe--;oe)w.unshift("..");v&&w[0]!==""&&(!w[0]||w[0].charAt(0)!=="/")&&w.unshift(""),se&&w.join("/").substr(-1)!=="/"&&w.push("");var ue=w[0]===""||w[0]&&w[0].charAt(0)==="/";if(U){t.hostname=t.host=ue?"":w.length?w.shift():"";var ee=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;ee&&(t.auth=ee.shift(),t.host=t.hostname=ee.shift())}return v=v||t.host&&w.length,v&&!ue&&w.unshift(""),w.length?t.pathname=w.join("/"):(t.pathname=null,t.path=null),(!util$8.isNull(t.pathname)||!util$8.isNull(t.search))&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Url.prototype.parseHost=function(){var n=this.host,e=portPattern.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const url={parse:parse$1,format,resolve};function assertPath(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function removeUrlParams(n){return n.split("?")[0].split("#")[0]}function escapeRegExp(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(n,e,t){return n.replace(new RegExp(escapeRegExp(e),"g"),t)}function normalizeStringPosix(n,e){let t="",s=0,r=-1,o=0,h=-1;for(let c=0;c<=n.length;++c){if(c<n.length)h=n.charCodeAt(c);else{if(h===47)break;h=47}if(h===47){if(!(r===c-1||o===1))if(r!==c-1&&o===2){if(t.length<2||s!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const a=t.lastIndexOf("/");if(a!==t.length-1){a===-1?(t="",s=0):(t=t.slice(0,a),s=t.length-1-t.lastIndexOf("/")),r=c,o=0;continue}}else if(t.length===2||t.length===1){t="",s=0,r=c,o=0;continue}}e&&(t.length>0?t+="/..":t="..",s=2)}else t.length>0?t+=`/${n.slice(r+1,c)}`:t=n.slice(r+1,c),s=c-r-1;r=c,o=0}else h===46&&o!==-1?++o:o=-1}return t}const path$1={toPosix(n){return replaceAll(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},hasProtocol(n){return/^[^/:]+:\//.test(this.toPosix(n))},getProtocol(n){assertPath(n),n=this.toPosix(n);let e="";const t=/^file:\/\/\//.exec(n),s=/^[^/:]+:\/\//.exec(n),r=/^[^/:]+:\//.exec(n);if(t||s||r){const o=(t==null?void 0:t[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);e=o,n=n.slice(o.length)}return e},toAbsolute(n,e,t){if(this.isDataUrl(n))return n;const s=removeUrlParams(this.toPosix(e??settings$1.ADAPTER.getBaseUrl())),r=removeUrlParams(this.toPosix(t??this.rootname(s)));return assertPath(n),n=this.toPosix(n),n.startsWith("/")?path$1.join(r,n.slice(1)):this.isAbsolute(n)?n:this.join(s,n)},normalize(n){if(n=this.toPosix(n),assertPath(n),n.length===0)return".";let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const s=n.endsWith("/");return n=normalizeStringPosix(n,!1),n.length>0&&s&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return assertPath(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const s=n[t];if(assertPath(s),s.length>0)if(e===void 0)e=s;else{const r=n[t-1]??"";this.extname(r)?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(assertPath(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let s=-1,r=!0;const o=this.getProtocol(n),h=n;n=n.slice(o.length);for(let c=n.length-1;c>=1;--c)if(e=n.charCodeAt(c),e===47){if(!r){s=c;break}}else r=!1;return s===-1?t?"/":this.isUrl(h)?o+n:o:t&&s===1?"//":o+n.slice(0,s)},rootname(n){assertPath(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){assertPath(n),e&&assertPath(e),n=removeUrlParams(this.toPosix(n));let t=0,s=-1,r=!0,o;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let h=e.length-1,c=-1;for(o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===47){if(!r){t=o+1;break}}else c===-1&&(r=!1,c=o+1),h>=0&&(a===e.charCodeAt(h)?--h===-1&&(s=o):(h=-1,s=c))}return t===s?s=c:s===-1&&(s=n.length),n.slice(t,s)}for(o=n.length-1;o>=0;--o)if(n.charCodeAt(o)===47){if(!r){t=o+1;break}}else s===-1&&(r=!1,s=o+1);return s===-1?"":n.slice(t,s)},extname(n){assertPath(n),n=removeUrlParams(this.toPosix(n));let e=-1,t=0,s=-1,r=!0,o=0;for(let h=n.length-1;h>=0;--h){const c=n.charCodeAt(h);if(c===47){if(!r){t=h+1;break}continue}s===-1&&(r=!1,s=h+1),c===46?e===-1?e=h:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||s===-1||o===0||o===1&&e===s-1&&e===t+1?"":n.slice(e,s)},parse(n){assertPath(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=removeUrlParams(this.toPosix(n));let t=n.charCodeAt(0);const s=this.isAbsolute(n);let r;e.root=this.rootname(n),s||this.hasProtocol(n)?r=1:r=0;let o=-1,h=0,c=-1,a=!0,u=n.length-1,d=0;for(;u>=r;--u){if(t=n.charCodeAt(u),t===47){if(!a){h=u+1;break}continue}c===-1&&(a=!1,c=u+1),t===46?o===-1?o=u:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||c===-1||d===0||d===1&&o===c-1&&o===h+1?c!==-1&&(h===0&&s?e.base=e.name=n.slice(1,c):e.base=e.name=n.slice(h,c)):(h===0&&s?(e.name=n.slice(1,o),e.base=n.slice(1,c)):(e.name=n.slice(h,o),e.base=n.slice(h,c)),e.ext=n.slice(o,c)),e.dir=this.dirname(n),e},sep:"/",delimiter:":"},warnings={};function deprecation(n,e,t=3){if(warnings[e])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`):(s=s.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${n}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`),console.warn(s))),warnings[e]=!0}let supported;function isWebGLSupported(){return typeof supported>"u"&&(supported=function(){var t;const e={stencil:!0,failIfMajorPerformanceCaveat:settings$1.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!settings$1.ADAPTER.getWebGLRenderingContext())return!1;const s=settings$1.ADAPTER.createCanvas();let r=s.getContext("webgl",e)||s.getContext("experimental-webgl",e);const o=!!((t=r==null?void 0:r.getContextAttributes())!=null&&t.stencil);if(r){const h=r.getExtension("WEBGL_lose_context");h&&h.loseContext()}return r=null,o}catch{return!1}}()),supported}var aliceblue="#f0f8ff",antiquewhite="#faebd7",aqua="#00ffff",aquamarine="#7fffd4",azure="#f0ffff",beige="#f5f5dc",bisque="#ffe4c4",black="#000000",blanchedalmond="#ffebcd",blue="#0000ff",blueviolet="#8a2be2",brown="#a52a2a",burlywood="#deb887",cadetblue="#5f9ea0",chartreuse="#7fff00",chocolate="#d2691e",coral="#ff7f50",cornflowerblue="#6495ed",cornsilk="#fff8dc",crimson="#dc143c",cyan="#00ffff",darkblue="#00008b",darkcyan="#008b8b",darkgoldenrod="#b8860b",darkgray="#a9a9a9",darkgreen="#006400",darkgrey="#a9a9a9",darkkhaki="#bdb76b",darkmagenta="#8b008b",darkolivegreen="#556b2f",darkorange="#ff8c00",darkorchid="#9932cc",darkred="#8b0000",darksalmon="#e9967a",darkseagreen="#8fbc8f",darkslateblue="#483d8b",darkslategray="#2f4f4f",darkslategrey="#2f4f4f",darkturquoise="#00ced1",darkviolet="#9400d3",deeppink="#ff1493",deepskyblue="#00bfff",dimgray="#696969",dimgrey="#696969",dodgerblue="#1e90ff",firebrick="#b22222",floralwhite="#fffaf0",forestgreen="#228b22",fuchsia="#ff00ff",gainsboro="#dcdcdc",ghostwhite="#f8f8ff",goldenrod="#daa520",gold="#ffd700",gray="#808080",green="#008000",greenyellow="#adff2f",grey="#808080",honeydew="#f0fff0",hotpink="#ff69b4",indianred="#cd5c5c",indigo="#4b0082",ivory="#fffff0",khaki="#f0e68c",lavenderblush="#fff0f5",lavender="#e6e6fa",lawngreen="#7cfc00",lemonchiffon="#fffacd",lightblue="#add8e6",lightcoral="#f08080",lightcyan="#e0ffff",lightgoldenrodyellow="#fafad2",lightgray="#d3d3d3",lightgreen="#90ee90",lightgrey="#d3d3d3",lightpink="#ffb6c1",lightsalmon="#ffa07a",lightseagreen="#20b2aa",lightskyblue="#87cefa",lightslategray="#778899",lightslategrey="#778899",lightsteelblue="#b0c4de",lightyellow="#ffffe0",lime="#00ff00",limegreen="#32cd32",linen="#faf0e6",magenta="#ff00ff",maroon="#800000",mediumaquamarine="#66cdaa",mediumblue="#0000cd",mediumorchid="#ba55d3",mediumpurple="#9370db",mediumseagreen="#3cb371",mediumslateblue="#7b68ee",mediumspringgreen="#00fa9a",mediumturquoise="#48d1cc",mediumvioletred="#c71585",midnightblue="#191970",mintcream="#f5fffa",mistyrose="#ffe4e1",moccasin="#ffe4b5",navajowhite="#ffdead",navy="#000080",oldlace="#fdf5e6",olive="#808000",olivedrab="#6b8e23",orange="#ffa500",orangered="#ff4500",orchid="#da70d6",palegoldenrod="#eee8aa",palegreen="#98fb98",paleturquoise="#afeeee",palevioletred="#db7093",papayawhip="#ffefd5",peachpuff="#ffdab9",peru="#cd853f",pink="#ffc0cb",plum="#dda0dd",powderblue="#b0e0e6",purple="#800080",rebeccapurple="#663399",red="#ff0000",rosybrown="#bc8f8f",royalblue="#4169e1",saddlebrown="#8b4513",salmon="#fa8072",sandybrown="#f4a460",seagreen="#2e8b57",seashell="#fff5ee",sienna="#a0522d",silver="#c0c0c0",skyblue="#87ceeb",slateblue="#6a5acd",slategray="#708090",slategrey="#708090",snow="#fffafa",springgreen="#00ff7f",steelblue="#4682b4",tan="#d2b48c",teal="#008080",thistle="#d8bfd8",tomato="#ff6347",turquoise="#40e0d0",violet="#ee82ee",wheat="#f5deb3",white="#ffffff",whitesmoke="#f5f5f5",yellow="#ffff00",yellowgreen="#9acd32",cssColorNames={aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,goldenrod,gold,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavenderblush,lavender,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen};function hex2rgb(n,e=[]){return e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,e}function hex2string(n){let e=n.toString(16);return e="000000".substring(0,6-e.length)+e,`#${e}`}function string2hex(n){if(typeof n=="string"&&(n=cssColorNames[n.toLowerCase()]||n,n[0]==="#"&&(n=n.slice(1)),n.length===3)){const[e,t,s]=n;n=e+e+t+t+s+s}return parseInt(n,16)}function rgb2hex(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function mapPremultipliedBlendModes(){const n=[],e=[];for(let s=0;s<32;s++)n[s]=s,e[s]=s;n[BLEND_MODES.NORMAL_NPM]=BLEND_MODES.NORMAL,n[BLEND_MODES.ADD_NPM]=BLEND_MODES.ADD,n[BLEND_MODES.SCREEN_NPM]=BLEND_MODES.SCREEN,e[BLEND_MODES.NORMAL]=BLEND_MODES.NORMAL_NPM,e[BLEND_MODES.ADD]=BLEND_MODES.ADD_NPM,e[BLEND_MODES.SCREEN]=BLEND_MODES.SCREEN_NPM;const t=[];return t.push(e),t.push(n),t}const premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(n,e){return premultiplyBlendMode[e?1:0][n]}function premultiplyRgba(n,e,t,s){return t=t||new Float32Array(4),s||s===void 0?(t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e):(t[0]=n[0],t[1]=n[1],t[2]=n[2]),t[3]=e,t}function premultiplyTint(n,e){if(e===1)return(e*255<<24)+n;if(e===0)return 0;let t=n>>16&255,s=n>>8&255,r=n&255;return t=t*e+.5|0,s=s*e+.5|0,r=r*e+.5|0,(e*255<<24)+(t<<16)+(s<<8)+r}function premultiplyTintToRgba(n,e,t,s){return t=t||new Float32Array(4),t[0]=(n>>16&255)/255,t[1]=(n>>8&255)/255,t[2]=(n&255)/255,(s||s===void 0)&&(t[0]*=e,t[1]*=e,t[2]*=e),t[3]=e,t}function createIndicesForQuads(n,e=null){const t=n*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let s=0,r=0;s<t;s+=6,r+=4)e[s+0]=r+0,e[s+1]=r+1,e[s+2]=r+2,e[s+3]=r+0,e[s+4]=r+2,e[s+5]=r+3;return e}function getBufferType(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function nextPow2(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function isPow2(n){return!(n&n-1)&&!!n}function log2(n){let e=(n>65535?1:0)<<4;n>>>=e;let t=(n>255?1:0)<<3;return n>>>=t,e|=t,t=(n>15?1:0)<<2,n>>>=t,e|=t,t=(n>3?1:0)<<1,n>>>=t,e|=t,e|n>>1}function removeItems(n,e,t){const s=n.length;let r;if(e>=s||t===0)return;t=e+t>s?s-e:t;const o=s-t;for(r=e;r<o;++r)n[r]=n[r+t];n.length=o}function sign(n){return n===0?0:n<0?-1:1}let nextUid=0;function uid(){return++nextUid}const _BoundingBox=class{constructor(n,e,t,s){this.left=n,this.top=e,this.right=t,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let BoundingBox=_BoundingBox;BoundingBox.EMPTY=new _BoundingBox(0,0,0,0);const ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);class CanvasRenderTarget{constructor(e,t,s){this._canvas=settings$1.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||settings$1.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function checkRow(n,e,t){for(let s=0,r=4*t*e;s<e;++s,r+=4)if(n[r+3]!==0)return!1;return!0}function checkColumn(n,e,t,s,r){const o=4*e;for(let h=s,c=s*o+4*t;h<=r;++h,c+=o)if(n[c+3]!==0)return!1;return!0}function getCanvasBoundingBox(n){const{width:e,height:t}=n,s=n.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const o=s.getImageData(0,0,e,t).data;let h=0,c=0,a=e-1,u=t-1;for(;c<t&&checkRow(o,e,c);)++c;if(c===t)return BoundingBox.EMPTY;for(;checkRow(o,e,u);)--u;for(;checkColumn(o,e,h,c,u);)++h;for(;checkColumn(o,e,a,c,u);)--a;return++a,++u,new BoundingBox(h,c,a,u)}function trimCanvas(n){const e=getCanvasBoundingBox(n),{width:t,height:s}=e;let r=null;if(!e.isEmpty()){const o=n.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");r=o.getImageData(e.left,e.top,t,s)}return{width:t,height:s,data:r}}let tempAnchor;function determineCrossOrigin(n,e=globalThis.location){if(n.startsWith("data:"))return"";e=e||globalThis.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=n;const t=url.parse(tempAnchor.href),s=!t.port&&e.port===""||t.port===e.port;return t.hostname!==e.hostname||!s||t.protocol!==e.protocol?"anonymous":""}function getResolutionOfUrl(n,e=1){var s;const t=(s=settings$1.RETINA_PREFIX)==null?void 0:s.exec(n);return t?parseFloat(t[1]):e}var ExtensionType=(n=>(n.Renderer="renderer",n.Application="application",n.RendererSystem="renderer-webgl-system",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererSystem="renderer-canvas-system",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n))(ExtensionType||{});const normalizeExtension=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},normalizePriority=(n,e)=>normalizeExtension(n).priority??e,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(normalizeExtension).forEach(e=>{e.type.forEach(t=>{var s,r;return(r=(s=this._removeHandlers)[t])==null?void 0:r.call(s,e)})}),this},add(...n){return n.map(normalizeExtension).forEach(e=>{e.type.forEach(t=>{const s=this._addHandlers,r=this._queue;s[t]?s[t](e):(r[t]=r[t]||[],r[t].push(e))})}),this},handle(n,e,t){const s=this._addHandlers,r=this._removeHandlers;if(s[n]||r[n])throw new Error(`Extension type ${n} already has a handler`);s[n]=e,r[n]=t;const o=this._queue;return o[n]&&(o[n].forEach(h=>e(h)),delete o[n]),this},handleByMap(n,e){return this.handle(n,t=>{e[t.name]=t.ref},t=>{delete e[t.name]})},handleByList(n,e,t=-1){return this.handle(n,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((r,o)=>normalizePriority(o,t)-normalizePriority(r,t)))},s=>{const r=e.indexOf(s.ref);r!==-1&&e.splice(r,1)})}};class ViewableBuffer{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const fragTemplate$1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function checkMaxIfStatementsInShader(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);for(;;){const s=fragTemplate$1.replace(/%forloop%/gi,generateIfTestSrc(n));if(e.shaderSource(t,s),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}return n}const BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5;let State$1=class{constructor(){this.data=0,this.blendMode=BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(e){!!(this.data&1<<BLEND$1)!==e&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$1)}set offsets(e){!!(this.data&1<<OFFSET$1)!==e&&(this.data^=1<<OFFSET$1)}get culling(){return!!(this.data&1<<CULLING$1)}set culling(e){!!(this.data&1<<CULLING$1)!==e&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(e){!!(this.data&1<<DEPTH_TEST$1)!==e&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(e){!!(this.data&1<<DEPTH_MASK$1)!==e&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(e){!!(this.data&1<<WINDING$1)!==e&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==BLEND_MODES.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new State$1;return e.depthTest=!1,e.blend=!0,e}};const INSTALLED=[];function autoDetectResource(n,e){if(!n)return null;let t="";if(typeof n=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);s&&(t=s[1].toLowerCase())}for(let s=INSTALLED.length-1;s>=0;--s){const r=INSTALLED[s];if(r.test&&r.test(n,t))return new r(n,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Runner{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,s,r,o,h,c,a){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let p=0,m=d.length;p<m;p++)d[p][u](e,t,s,r,o,h,c,a);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}});class Resource{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class BufferResource extends Resource{constructor(e,t){const{width:s,height:r}=t||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=e}upload(e,t,s){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES.UNPACK);const o=t.realWidth,h=t.realHeight;return s.width===o&&s.height===h?r.texSubImage2D(t.target,0,0,0,o,h,t.format,s.type,this.data):(s.width=o,s.height=h,r.texImage2D(t.target,0,s.internalFormat,o,h,0,t.format,s.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}}const defaultBufferOptions={scaleMode:SCALE_MODES.NEAREST,format:FORMATS.RGBA,alphaMode:ALPHA_MODES.NPM},_BaseTexture=class extends eventemitter3Exports{constructor(n=null,e=null){super(),e=Object.assign({},_BaseTexture.defaultOptions,e);const{alphaMode:t,mipmap:s,anisotropicLevel:r,scaleMode:o,width:h,height:c,wrapMode:a,format:u,type:d,target:p,resolution:m,resourceOptions:g}=e;n&&!(n instanceof Resource)&&(n=autoDetectResource(n,g),n.internal=!0),this.resolution=m||settings$1.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((c||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=a,this._scaleMode=o,this.format=u,this.type=d,this.target=p,this.alphaMode=t,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&c>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(n)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(n){this._mipmap!==n&&(this._mipmap=n,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(n){this._scaleMode!==n&&(this._scaleMode=n,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(n){this._wrapMode!==n&&(this._wrapMode=n,this.dirtyStyleId++)}setStyle(n,e){let t;return n!==void 0&&n!==this.scaleMode&&(this.scaleMode=n,t=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,t=!0),t&&this.dirtyStyleId++,this}setSize(n,e,t){return t=t||this.resolution,this.setRealSize(n*t,e*t,t)}setRealSize(n,e,t){return this.resolution=t||this.resolution,this.width=Math.round(n)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(n){const e=this.resolution;return e===n?this:(this.resolution=n,this.valid&&(this.width=Math.round(this.width*e)/n,this.height=Math.round(this.height*e)/n,this.emit("update",this)),this._refreshPOT(),this)}setResource(n){if(this.resource===n)return this;if(this.resource)throw new Error("Resource can be set only once");return n.bind(this),this.resource=n,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(n){this.emit("error",this,n)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.dispose(),_BaseTexture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(n,e,t=settings$1.STRICT_TEXTURE_CACHE){const s=typeof n=="string";let r=null;if(s)r=n;else{if(!n._pixiId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";n._pixiId=`${h}_${uid()}`}r=n._pixiId}let o=BaseTextureCache[r];if(s&&t&&!o)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return o||(o=new _BaseTexture(n,e),o.cacheId=r,_BaseTexture.addToCache(o,r)),o}static fromBuffer(n,e,t,s){n=n||new Float32Array(e*t*4);const r=new BufferResource(n,{width:e,height:t}),o=n instanceof Float32Array?TYPES.FLOAT:TYPES.UNSIGNED_BYTE;return new _BaseTexture(r,Object.assign({},defaultBufferOptions,s||{width:e,height:t,type:o}))}static addToCache(n,e){e&&(n.textureCacheIds.includes(e)||n.textureCacheIds.push(e),BaseTextureCache[e]&&BaseTextureCache[e]!==n&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),BaseTextureCache[e]=n)}static removeFromCache(n){if(typeof n=="string"){const e=BaseTextureCache[n];if(e){const t=e.textureCacheIds.indexOf(n);return t>-1&&e.textureCacheIds.splice(t,1),delete BaseTextureCache[n],e}}else if(n!=null&&n.textureCacheIds){for(let e=0;e<n.textureCacheIds.length;++e)delete BaseTextureCache[n.textureCacheIds[e]];return n.textureCacheIds.length=0,n}return null}};let BaseTexture=_BaseTexture;BaseTexture.defaultOptions={mipmap:MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:SCALE_MODES.LINEAR,wrapMode:WRAP_MODES.CLAMP,alphaMode:ALPHA_MODES.UNPACK,target:TARGETS.TEXTURE_2D,format:FORMATS.RGBA,type:TYPES.UNSIGNED_BYTE};BaseTexture._globalBatch=0;class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UID$4=0;class Buffer{constructor(e,t=!0,s=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=t,this.id=UID$4++,this.disposeRunner=new Runner("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Buffer(e)}}class Attribute{constructor(e,t=0,s=!1,r=TYPES.FLOAT,o,h,c,a=1){this.buffer=e,this.size=t,this.normalized=s,this.type=r,this.stride=o,this.start=h,this.instance=c,this.divisor=a}destroy(){this.buffer=null}static from(e,t,s,r,o){return new Attribute(e,t,s,r,o)}}const map$1={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(n,e){let t=0,s=0;const r={};for(let a=0;a<n.length;a++)s+=e[a],t+=n[a].length;const o=new ArrayBuffer(t*4);let h=null,c=0;for(let a=0;a<n.length;a++){const u=e[a],d=n[a],p=getBufferType(d);r[p]||(r[p]=new map$1[p](o)),h=r[p];for(let m=0;m<d.length;m++){const g=(m/u|0)*s+c,_=m%u;h[g+_]=d[m]}c+=u}return new Float32Array(o)}const byteSizeMap$1={5126:4,5123:2,5121:1};let UID$3=0;const map={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Geometry{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=UID$3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}addAttribute(e,t,s=0,r=!1,o,h,c,a=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Buffer||(t instanceof Array&&(t=new Float32Array(t)),t=new Buffer(t));const u=e.split("|");if(u.length>1){for(let p=0;p<u.length;p++)this.addAttribute(u[p],t,s,r,o);return this}let d=this.buffers.indexOf(t);return d===-1&&(this.buffers.push(t),d=this.buffers.length-1),this.attributes[e]=new Attribute(d,s,r,o,h,c,a),this.instanced=this.instanced||a,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Buffer||(e instanceof Array&&(e=new Uint16Array(e)),e=new Buffer(e)),e.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],t=[],s=new Buffer;let r;for(r in this.attributes){const o=this.attributes[r],h=this.buffers[o.buffer];e.push(h.data),t.push(o.size*byteSizeMap$1[o.type]/4),o.buffer=0}for(s.data=interleaveTypedArrays(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Geometry;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new Buffer(this.buffers[t].data.slice(0));for(const t in this.attributes){const s=this.attributes[t];e.attributes[t]=new Attribute(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new Geometry,s=[],r=[],o=[];let h;for(let c=0;c<e.length;c++){h=e[c];for(let a=0;a<h.buffers.length;a++)r[a]=r[a]||0,r[a]+=h.buffers[a].data.length,o[a]=0}for(let c=0;c<h.buffers.length;c++)s[c]=new map[getBufferType(h.buffers[c].data)](r[c]),t.buffers[c]=new Buffer(s[c]);for(let c=0;c<e.length;c++){h=e[c];for(let a=0;a<h.buffers.length;a++)s[a].set(h.buffers[a].data,o[a]),o[a]+=h.buffers[a].data.length}if(t.attributes=h.attributes,h.indexBuffer){t.indexBuffer=t.buffers[h.buffers.indexOf(h.indexBuffer)],t.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let c=0,a=0,u=0,d=0;for(let p=0;p<h.buffers.length;p++)if(h.buffers[p]!==h.indexBuffer){d=p;break}for(const p in h.attributes){const m=h.attributes[p];(m.buffer|0)===d&&(a+=m.size*byteSizeMap$1[m.type]/4)}for(let p=0;p<e.length;p++){const m=e[p].indexBuffer.data;for(let g=0;g<m.length;g++)t.indexBuffer.data[g+u]+=c;c+=e[p].buffers[d].data.length/a,u+=m.length}}return t}}class BatchGeometry extends Geometry{constructor(e=!1){super(),this._buffer=new Buffer(null,e,!1),this._indexBuffer=new Buffer(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,TYPES.FLOAT).addIndex(this._indexBuffer)}}const PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;var SHAPES=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC",n))(SHAPES||{});class Point{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Point(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const tempPoints$1=[new Point,new Point,new Point,new Point];class Rectangle{constructor(e=0,t=0,s=0,r=0){this.x=Number(e),this.y=Number(t),this.width=Number(s),this.height=Number(r),this.type=SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const oe=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=oe)return!1;const ue=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>ue}const s=this.left,r=this.right,o=this.top,h=this.bottom;if(r<=s||h<=o)return!1;const c=tempPoints$1[0].set(e.left,e.top),a=tempPoints$1[1].set(e.left,e.bottom),u=tempPoints$1[2].set(e.right,e.top),d=tempPoints$1[3].set(e.right,e.bottom);if(u.x<=c.x||a.y<=c.y)return!1;const p=Math.sign(t.a*t.d-t.b*t.c);if(p===0||(t.apply(c,c),t.apply(a,a),t.apply(u,u),t.apply(d,d),Math.max(c.x,a.x,u.x,d.x)<=s||Math.min(c.x,a.x,u.x,d.x)>=r||Math.max(c.y,a.y,u.y,d.y)<=o||Math.min(c.y,a.y,u.y,d.y)>=h))return!1;const m=p*(a.y-c.y),g=p*(c.x-a.x),_=m*s+g*o,y=m*r+g*o,v=m*s+g*h,N=m*r+g*h;if(Math.max(_,y,v,N)<=m*c.x+g*c.y||Math.min(_,y,v,N)>=m*d.x+g*d.y)return!1;const w=p*(c.y-u.y),k=p*(u.x-c.x),U=w*s+k*o,ee=w*r+k*o,ie=w*s+k*h,se=w*r+k*h;return!(Math.max(U,ee,ie,se)<=w*c.x+k*c.y||Math.min(U,ee,ie,se)>=w*d.x+k*d.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(s-t,0),this.y=r,this.height=Math.max(o-r,0),this}ceil(e=1,t=.001){const s=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=s-this.x,this.height=r-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=s-t,this.y=r,this.height=o-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Circle{constructor(e=0,t=0,s=0){this.x=e,this.y=t,this.radius=s,this.type=SHAPES.CIRC}clone(){return new Circle(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-e,o=this.y-t;return r*=r,o*=o,r+o<=s}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ellipse{constructor(e=0,t=0,s=0,r=0){this.x=e,this.y=t,this.width=s,this.height=r,this.type=SHAPES.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let s=(e-this.x)/this.width,r=(t-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Polygon{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const s=[];for(let r=0,o=t.length;r<o;r++)s.push(t[r].x,t[r].y);t=s}this.points=t,this.type=SHAPES.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new Polygon(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let s=!1;const r=this.points.length/2;for(let o=0,h=r-1;o<r;h=o++){const c=this.points[o*2],a=this.points[o*2+1],u=this.points[h*2],d=this.points[h*2+1];a>t!=d>t&&e<(u-c)*((t-a)/(d-a))+c&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}}class RoundedRectangle{constructor(e=0,t=0,s=0,r=0,o=20){this.x=e,this.y=t,this.width=s,this.height=r,this.radius=o,this.type=SHAPES.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+s&&t<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let r=e-(this.x+s),o=t-(this.y+s);const h=s*s;if(r*r+o*o<=h||(r=e-(this.x+this.width-s),r*r+o*o<=h)||(o=t-(this.y+this.height-s),r*r+o*o<=h)||(r=e-(this.x+s),r*r+o*o<=h))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Matrix{constructor(e=1,t=0,s=0,r=1,o=0,h=0){this.array=null,this.a=e,this.b=t,this.c=s,this.d=r,this.tx=o,this.ty=h}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,s,r,o,h){return this.a=e,this.b=t,this.c=s,this.d=r,this.tx=o,this.ty=h,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const s=t||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,t){t=t||new Point;const s=e.x,r=e.y;return t.x=this.a*s+this.c*r+this.tx,t.y=this.b*s+this.d*r+this.ty,t}applyInverse(e,t){t=t||new Point;const s=1/(this.a*this.d+this.c*-this.b),r=e.x,o=e.y;return t.x=this.d*s*r+-this.c*s*o+(this.ty*this.c-this.tx*this.d)*s,t.y=this.a*s*o+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),s=Math.sin(e),r=this.a,o=this.c,h=this.tx;return this.a=r*t-this.b*s,this.b=r*s+this.b*t,this.c=o*t-this.d*s,this.d=o*s+this.d*t,this.tx=h*t-this.ty*s,this.ty=h*s+this.ty*t,this}append(e){const t=this.a,s=this.b,r=this.c,o=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*s+e.b*o,this.c=e.c*t+e.d*r,this.d=e.c*s+e.d*o,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*s+e.ty*o+this.ty,this}setTransform(e,t,s,r,o,h,c,a,u){return this.a=Math.cos(c+u)*o,this.b=Math.sin(c+u)*o,this.c=-Math.sin(c-a)*h,this.d=Math.cos(c-a)*h,this.tx=e-(s*this.a+r*this.c),this.ty=t-(s*this.b+r*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,r=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,s=this.b,r=this.c,o=this.d,h=e.pivot,c=-Math.atan2(-r,o),a=Math.atan2(s,t),u=Math.abs(c+a);return u<1e-5||Math.abs(PI_2-u)<1e-5?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=c,e.skew.y=a),e.scale.x=Math.sqrt(t*t+s*s),e.scale.y=Math.sqrt(r*r+o*o),e.position.x=this.tx+(h.x*t+h.y*r),e.position.y=this.ty+(h.x*s+h.y*o),e}invert(){const e=this.a,t=this.b,s=this.c,r=this.d,o=this.tx,h=e*r-t*s;return this.a=r/h,this.b=-t/h,this.c=-s/h,this.d=e/h,this.tx=(s*this.ty-r*o)/h,this.ty=-(e*this.ty-t*o)/h,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Matrix;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}}const ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init$1(){for(let n=0;n<16;n++){const e=[];rotationCayley.push(e);for(let t=0;t<16;t++){const s=signum(ux[n]*ux[t]+vx[n]*uy[t]),r=signum(uy[n]*ux[t]+vy[n]*uy[t]),o=signum(ux[n]*vx[t]+vx[n]*vy[t]),h=signum(uy[n]*vx[t]+vy[n]*vy[t]);for(let c=0;c<16;c++)if(ux[c]===s&&uy[c]===r&&vx[c]===o&&vy[c]===h){e.push(c);break}}}for(let n=0;n<16;n++){const e=new Matrix;e.set(ux[n],uy[n],vx[n],vy[n],0,0),rotationMatrices.push(e)}}init$1();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>ux[n],uY:n=>uy[n],vX:n=>vx[n],vY:n=>vy[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>rotationCayley[n][e],sub:(n,e)=>rotationCayley[n][groupD8.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?groupD8.S:groupD8.N:Math.abs(e)*2<=Math.abs(n)?n>0?groupD8.E:groupD8.W:e>0?n>0?groupD8.SE:groupD8.SW:n>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(n,e,t=0,s=0)=>{const r=rotationMatrices[groupD8.inv(e)];r.tx=t,r.ty=s,n.append(r)}};class ObservablePoint{constructor(e,t,s=0,r=0){this._x=s,this._y=r,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new ObservablePoint(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}const _Transform=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(n){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){const t=n.worldTransform,s=this.worldTransform;s.a=e.a*t.a+e.b*t.c,s.b=e.a*t.b+e.b*t.d,s.c=e.c*t.a+e.d*t.c,s.d=e.c*t.b+e.d*t.d,s.tx=e.tx*t.a+e.ty*t.c+t.tx,s.ty=e.tx*t.b+e.ty*t.d+t.ty,this._parentID=n._worldID,this._worldID++}}setFromMatrix(n){n.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())}};let Transform=_Transform;Transform.IDENTITY=new _Transform;var defaultFragment$2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,defaultVertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function compileShader(n,e,t){const s=n.createShader(e);return n.shaderSource(s,t),n.compileShader(s),s}function booleanArray(n){const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=!1;return e}function defaultValue(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return booleanArray(2*e);case"bvec3":return booleanArray(3*e);case"bvec4":return booleanArray(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const uniformParsers=[{test:n=>n.type==="float"&&n.size===1&&!n.isArray,code:n=>`
            if(uv["${n}"] !== ud["${n}"].value)
            {
                ud["${n}"].value = uv["${n}"]
                gl.uniform1f(ud["${n}"].location, uv["${n}"])
            }
            `},{test:(n,e)=>(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(e==null||e.castToBaseTexture!==void 0),code:n=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${n}"], t);

            if(ud["${n}"].value !== t)
            {
                ud["${n}"].value = t;
                gl.uniform1i(ud["${n}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(n,e)=>n.type==="mat3"&&n.size===1&&!n.isArray&&e.a!==void 0,code:n=>`
            gl.uniformMatrix3fv(ud["${n}"].location, false, uv["${n}"].toArray(true));
            `,codeUbo:n=>`
                var ${n}_matrix = uv.${n}.toArray(true);

                data[offset] = ${n}_matrix[0];
                data[offset+1] = ${n}_matrix[1];
                data[offset+2] = ${n}_matrix[2];
        
                data[offset + 4] = ${n}_matrix[3];
                data[offset + 5] = ${n}_matrix[4];
                data[offset + 6] = ${n}_matrix[5];
        
                data[offset + 8] = ${n}_matrix[6];
                data[offset + 9] = ${n}_matrix[7];
                data[offset + 10] = ${n}_matrix[8];
            `},{test:(n,e)=>n.type==="vec2"&&n.size===1&&!n.isArray&&e.x!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${n}"].location, v.x, v.y);
                }`,codeUbo:n=>`
                v = uv.${n};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:n=>n.type==="vec2"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${n}"].location, v[0], v[1]);
                }
            `},{test:(n,e)=>n.type==="vec4"&&n.size===1&&!n.isArray&&e.width!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${n}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:n=>n.type==="vec4"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${n}"].location, v[0], v[1], v[2], v[3])
                }`}],GLSL_TO_SINGLE_SETTERS_CACHED={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(n,e){var s;const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in n.uniforms){const o=e[r];if(!o){(s=n.uniforms[r])!=null&&s.group&&(n.uniforms[r].ubo?t.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):t.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const h=n.uniforms[r];let c=!1;for(let a=0;a<uniformParsers.length;a++)if(uniformParsers[a].test(o,h)){t.push(uniformParsers[a].code(r,h)),c=!0;break}if(!c){const u=(o.size===1&&!o.isArray?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[o.type].replace("location",`ud["${r}"].location`);t.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${u};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}const unknownContext={};let context=unknownContext;function getTestContext(){if(context===unknownContext||context!=null&&context.isContextLost()){const n=settings$1.ADAPTER.createCanvas();let e;settings$1.PREFER_ENV>=ENV.WEBGL2&&(e=n.getContext("webgl2",{})),e||(e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),context=e}return context}let maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=PRECISION.MEDIUM;const n=getTestContext();n&&n.getShaderPrecisionFormat&&(maxFragmentPrecision=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?PRECISION.HIGH:PRECISION.MEDIUM)}return maxFragmentPrecision}function logPrettyShaderError(n,e){const t=n.getShaderSource(e).split(`
`).map((u,d)=>`${d}: ${u}`),s=n.getShaderInfoLog(e),r=s.split(`
`),o={},h=r.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!o[u]?(o[u]=!0,!0):!1),c=[""];h.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,c.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const a=t.join(`
`);c[0]=a,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...c),console.groupEnd()}function logProgramError(n,e,t,s){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||logPrettyShaderError(n,t),n.getShaderParameter(s,n.COMPILE_STATUS)||logPrettyShaderError(n,s),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}const GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(n){return GLSL_TO_SIZE[n]}let GL_TABLE=null;const GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(n,e){if(!GL_TABLE){const t=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let s=0;s<t.length;++s){const r=t[s];GL_TABLE[n[r]]=GL_TO_GLSL_TYPES[r]}}return GL_TABLE[e]}function setPrecision(n,e,t){if(n.substring(0,9)!=="precision"){let s=e;return e===PRECISION.HIGH&&t!==PRECISION.HIGH&&(s=PRECISION.MEDIUM),`precision ${s} float;
${n}`}else if(t!==PRECISION.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}let UID$2=0;const nameCache={},_Program=class{constructor(n,e,t="pixi-shader",s={}){this.extra={},this.id=UID$2++,this.vertexSrc=n||_Program.defaultVertexSrc,this.fragmentSrc=e||_Program.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(t=t.replace(/\s+/g,"-"),nameCache[t]?(nameCache[t]++,t+=`-${nameCache[t]}`):nameCache[t]=1,this.vertexSrc=`#define SHADER_NAME ${t}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${t}
${this.fragmentSrc}`,this.vertexSrc=setPrecision(this.vertexSrc,_Program.defaultVertexPrecision,PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,_Program.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return defaultVertex$3}static get defaultFragmentSrc(){return defaultFragment$2}static from(n,e,t){const s=n+e;let r=ProgramCache[s];return r||(ProgramCache[s]=r=new _Program(n,e,t)),r}};let Program=_Program;Program.defaultVertexPrecision=PRECISION.HIGH;Program.defaultFragmentPrecision=isMobile.apple.device?PRECISION.HIGH:PRECISION.MEDIUM;let UID$1=0;class UniformGroup{constructor(e,t,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$1++,this.static=!!t,this.ubo=!!s,e instanceof Buffer?(this.buffer=e,this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Buffer(new Float32Array(1)),this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,s){if(!this.ubo)this.uniforms[e]=new UniformGroup(t,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,t,s){return new UniformGroup(e,t,s)}static uboFrom(e,t){return new UniformGroup(e,t??!0,!0)}}class Shader{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof UniformGroup?this.uniformGroup=t:this.uniformGroup=new UniformGroup(t):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const s in t.uniforms){const r=t.uniforms[s];if(r.group&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,s){const r=Program.from(e,t);return new Shader(r,s)}}class BatchShaderGenerator{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const s=new Int32Array(e);for(let o=0;o<e;o++)s[o]=o;this.defaultGroupCache[e]=UniformGroup.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Program(this.vertexSrc,r)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[e]};return new Shader(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`
`,t+=`
`;for(let s=0;s<e;s++)s>0&&(t+=`
else `),s<e-1&&(t+=`if(vTextureId < ${s}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}}class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function canUploadSameBuffer(){return!isMobile.apple.device}function maxRecommendedTextures(n){let e=!0;const t=settings$1.ADAPTER.getNavigator();if(isMobile.tablet||isMobile.phone){if(isMobile.apple.device){const s=t.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(e=!1)}if(isMobile.android.device){const s=t.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(e=!1)}}return e?n:4}class ObjectRenderer{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var defaultFragment$1=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,defaultVertex$2=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const _BatchRenderer=class extends ObjectRenderer{constructor(n){super(n),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State$1.for2d(),this.size=_BatchRenderer.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),n.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(n){this._defaultMaxTextures=n}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(n){this._canUploadSameBuffer=n}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return defaultVertex$2}static get defaultFragmentTemplate(){return defaultFragment$1}setShaderGenerator({vertex:n=_BatchRenderer.defaultVertexSrc,fragment:e=_BatchRenderer.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(n,e)}contextChange(){const n=this.renderer.gl;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),_BatchRenderer.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,n)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:n,_textureArrayPool:e}=_BatchRenderer,t=this.size/4,s=Math.floor(t/this.maxTextures)+1;for(;n.length<t;)n.push(new BatchDrawCall);for(;e.length<s;)e.push(new BatchTextureArray);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(n){n._texture.valid&&(this._vertexCount+n.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=n.vertexData.length/2,this._indexCount+=n.indices.length,this._bufferedTextures[this._bufferSize]=n._texture.baseTexture,this._bufferedElements[this._bufferSize++]=n)}buildTexturesAndDrawCalls(){const{_bufferedTextures:n,maxTextures:e}=this,t=_BatchRenderer._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,o=this.renderer.textureGC.count;let h=++BaseTexture._globalBatch,c=0,a=t[0],u=0;s.copyBoundTextures(r,e);for(let d=0;d<this._bufferSize;++d){const p=n[d];n[d]=null,p._batchEnabled!==h&&(a.count>=e&&(s.boundArray(a,r,h,e),this.buildDrawCalls(a,u,d),u=d,a=t[++c],++h),p._batchEnabled=h,p.touched=o,a.elements[a.count++]=p)}a.count>0&&(s.boundArray(a,r,h,e),this.buildDrawCalls(a,u,this._bufferSize),++c,++h);for(let d=0;d<r.length;d++)r[d]=null;BaseTexture._globalBatch=h}buildDrawCalls(n,e,t){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:o,vertexSize:h}=this,c=_BatchRenderer._drawCallPool;let a=this._dcIndex,u=this._aIndex,d=this._iIndex,p=c[a];p.start=this._iIndex,p.texArray=n;for(let m=e;m<t;++m){const g=s[m],_=g._texture.baseTexture,y=premultiplyBlendMode[_.alphaMode?1:0][g.blendMode];s[m]=null,e<m&&p.blend!==y&&(p.size=d-p.start,e=m,p=c[++a],p.texArray=n,p.start=d),this.packInterleavedGeometry(g,r,o,u,d),u+=g.vertexData.length/2*h,d+=g.indices.length,p.blend=y}e<t&&(p.size=d-p.start,++a),this._dcIndex=a,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(n){const e=this.renderer.texture;for(let t=0;t<n.count;t++)e.bind(n.elements[t],n.ids[t]),n.elements[t]=null;n.count=0}updateGeometry(){const{_packedGeometries:n,_attributeBuffer:e,_indexBuffer:t}=this;_BatchRenderer.canUploadSameBuffer?(n[this._flushId]._buffer.update(e.rawBinaryData),n[this._flushId]._indexBuffer.update(t),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,n[this._flushId]=new this.geometryClass),n[this._flushId]._buffer.update(e.rawBinaryData),n[this._flushId]._indexBuffer.update(t),this.renderer.geometry.bind(n[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const n=this._dcIndex,{gl:e,state:t}=this.renderer,s=_BatchRenderer._drawCallPool;let r=null;for(let o=0;o<n;o++){const{texArray:h,type:c,size:a,start:u,blend:d}=s[o];r!==h&&(r=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,t.set(this.state),e.drawElements(c,a,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),_BatchRenderer.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]&&this._packedGeometries[n].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(n){const e=nextPow2(Math.ceil(n/8)),t=log2(e),s=e*8;this._aBuffers.length<=t&&(this._iBuffers.length=t+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new ViewableBuffer(s*this.vertexSize*4)),r}getIndexBuffer(n){const e=nextPow2(Math.ceil(n/12)),t=log2(e),s=e*12;this._iBuffers.length<=t&&(this._iBuffers.length=t+1);let r=this._iBuffers[t];return r||(this._iBuffers[t]=r=new Uint16Array(s)),r}packInterleavedGeometry(n,e,t,s,r){const{uint32View:o,float32View:h}=e,c=s/this.vertexSize,a=n.uvs,u=n.indices,d=n.vertexData,p=n._texture.baseTexture._batchLocation,m=Math.min(n.worldAlpha,1),g=m<1&&n._texture.baseTexture.alphaMode?premultiplyTint(n._tintRGB,m):n._tintRGB+(m*255<<24);for(let _=0;_<d.length;_+=2)h[s++]=d[_],h[s++]=d[_+1],h[s++]=a[_],h[s++]=a[_+1],o[s++]=g,h[s++]=p;for(let _=0;_<u.length;_++)t[r++]=c+u[_]}};let BatchRenderer=_BatchRenderer;BatchRenderer.defaultBatchSize=4096;BatchRenderer.extension={name:"batch",type:ExtensionType.RendererPlugin};BatchRenderer._drawCallPool=[];BatchRenderer._textureArrayPool=[];extensions$1.add(BatchRenderer);var defaultFragment=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,defaultVertex$1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const _Filter=class extends Shader{constructor(n,e,t){const s=Program.from(n||_Filter.defaultVertexSrc,e||_Filter.defaultFragmentSrc);super(s,t),this.padding=0,this.resolution=_Filter.defaultResolution,this.multisample=_Filter.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State$1}apply(n,e,t,s,r){n.applyFilter(this,e,t,s)}get blendMode(){return this.state.blendMode}set blendMode(n){this.state.blendMode=n}get resolution(){return this._resolution}set resolution(n){this._resolution=n}static get defaultVertexSrc(){return defaultVertex$1}static get defaultFragmentSrc(){return defaultFragment}};let Filter=_Filter;Filter.defaultResolution=1;Filter.defaultMultisample=MSAA_QUALITY.NONE;class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender,e.color&&(this.color=typeof e.color=="string"?string2hex(e.color):e.color),this.alpha=e.alpha}get color(){return this._backgroundColor}set color(e){this._backgroundColor=e,this._backgroundColorString=hex2string(e),hex2rgb(e,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(e){this._backgroundColorRgba[3]=e}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}BackgroundSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"background"};extensions$1.add(BackgroundSystem);class BatchSystem{constructor(e){this.renderer=e,this.emptyRenderer=new ObjectRenderer(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:s}=this.renderer.texture;for(let r=t-1;r>=0;--r)e[r]=s[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,t,s,r){const{elements:o,ids:h,count:c}=e;let a=0;for(let u=0;u<c;u++){const d=o[u],p=d._batchLocation;if(p>=0&&p<r&&t[p]===d){h[u]=p;continue}for(;a<r;){const m=t[a];if(m&&m._batchEnabled===s&&m._batchLocation===a){a++;continue}h[u]=a,d._batchLocation=a,t[a]=d;break}}}destroy(){this.renderer=null}}BatchSystem.extension={type:ExtensionType.RendererSystem,name:"batch"};extensions$1.add(BatchSystem);let CONTEXT_UID_COUNTER=0;class ContextSystem{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,s=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:s,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let s;if(settings$1.PREFER_ENV>=ENV.WEBGL2&&(s=e.getContext("webgl2",t)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ContextSystem.extension={type:ExtensionType.RendererSystem,name:"context"};extensions$1.add(ContextSystem);class DepthResource extends BufferResource{upload(e,t,s){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES.UNPACK);const o=t.realWidth,h=t.realHeight;return s.width===o&&s.height===h?r.texSubImage2D(t.target,0,0,0,o,h,t.format,s.type,this.data):(s.width=o,s.height=h,r.texImage2D(t.target,0,s.internalFormat,o,h,0,t.format,s.type,this.data)),!0}}class Framebuffer{constructor(e,t){this.width=Math.round(e||100),this.height=Math.round(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,mipmap:MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new BaseTexture(new DepthResource(null,{width:this.width,height:this.height}),{scaleMode:SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES.OFF,format:FORMATS.DEPTH_COMPONENT,type:TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],o=r.resolution;r.setSize(e/o,t/o)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(e/s,t/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class BaseRenderTexture extends BaseTexture{constructor(e={}){if(typeof e=="number"){const t=arguments[0],s=arguments[1],r=arguments[2],o=arguments[3];e={width:t,height:s,scaleMode:r,resolution:o}}e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=MSAA_QUALITY.NONE),super(null,e),this.mipmap=MIPMAP_MODES.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class BaseImageResource extends Resource{constructor(e){const t=e,s=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;super(s,r),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,s){s===void 0&&!t.startsWith("data:")?e.crossOrigin=determineCrossOrigin(t):s!==!1&&(e.crossOrigin=typeof s=="string"?s:"anonymous")}upload(e,t,s,r){const o=e.gl,h=t.realWidth,c=t.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES.UNPACK),!this.noSubImage&&t.target===o.TEXTURE_2D&&s.width===h&&s.height===c?o.texSubImage2D(o.TEXTURE_2D,0,0,0,t.format,s.type,r):(s.width=h,s.height=c,o.texImage2D(t.target,0,s.internalFormat,t.format,s.type,r)),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;this.resize(t,s),super.update()}dispose(){this.source=null}}class ImageResource extends BaseImageResource{constructor(e,t){if(t=t||{},typeof e=="string"){const s=new Image;BaseImageResource.crossOrigin(s,e,t.crossorigin),s.src=e,e=s}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??settings$1.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((t,s)=>{const r=this.source;this.url=r.src;const o=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?t(this.process()):t(this))};r.complete&&r.src?o():(r.onload=o,r.onerror=h=>{s(h),this.onError.emit(h)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,s=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,s){if(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,s,this.bitmap),!this.preserveBitmap){let r=!0;const o=t._glTextures;for(const h in o){const c=o[h];if(c!==s&&c.dirtyId!==t.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,s){const r=t.width,o=t.height;if(s){const h=e.width/2/r,c=e.height/2/o,a=e.x/r+h,u=e.y/o+c;s=groupD8.add(s,groupD8.NW),this.x0=a+h*groupD8.uX(s),this.y0=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x1=a+h*groupD8.uX(s),this.y1=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x2=a+h*groupD8.uX(s),this.y2=u+c*groupD8.uY(s),s=groupD8.add(s,2),this.x3=a+h*groupD8.uX(s),this.y3=u+c*groupD8.uY(s)}else this.x0=e.x/r,this.y0=e.y/o,this.x1=(e.x+e.width)/r,this.y1=e.y/o,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/o,this.x3=e.x/r,this.y3=(e.y+e.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const DEFAULT_UVS=new TextureUvs;function removeAllHandlers(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}class Texture extends eventemitter3Exports{constructor(e,t,s,r,o,h){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new Rectangle(0,0,1,1)),e instanceof Texture&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=r,this.valid=!1,this._uvs=DEFAULT_UVS,this.uvMatrix=null,this.orig=s||t,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=h?new Point(h.x,h.y):new Point(0,0),this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:t}=this.baseTexture;t!=null&&t.url&&TextureCache[t.url]&&Texture.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),s=new Texture(this.baseTexture,!this.noFrame&&e,t,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(s._frame=e),s}updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},s=settings$1.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let o=null;if(r)o=e;else if(e instanceof BaseTexture){if(!e.cacheId){const c=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId=`${c}-${uid()}`,BaseTexture.addToCache(e,e.cacheId)}o=e.cacheId}else{if(!e._pixiId){const c=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${c}_${uid()}`}o=e._pixiId}let h=TextureCache[o];if(r&&s&&!h)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!h&&!(e instanceof BaseTexture)?(t.resolution||(t.resolution=getResolutionOfUrl(e)),h=new Texture(new BaseTexture(e,t)),h.baseTexture.cacheId=o,BaseTexture.addToCache(h.baseTexture,o),Texture.addToCache(h,o)):!h&&e instanceof BaseTexture&&(h=new Texture(e),Texture.addToCache(h,o)),h}static fromURL(e,t){const s=Object.assign({autoLoad:!1},t==null?void 0:t.resourceOptions),r=Texture.from(e,Object.assign({resourceOptions:s},t),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then(()=>Promise.resolve(r))}static fromBuffer(e,t,s,r){return new Texture(BaseTexture.fromBuffer(e,t,s,r))}static fromLoader(e,t,s,r){const o=new BaseTexture(e,Object.assign({scaleMode:BaseTexture.defaultOptions.scaleMode,resolution:getResolutionOfUrl(t)},r)),{resource:h}=o;h instanceof ImageResource&&(h.url=t);const c=new Texture(o);return s||(s=t),BaseTexture.addToCache(c.baseTexture,s),Texture.addToCache(c,s),s!==t&&(BaseTexture.addToCache(c.baseTexture,t),Texture.addToCache(c,t)),c.baseTexture.valid?Promise.resolve(c):new Promise(a=>{c.baseTexture.once("loaded",()=>a(c))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),TextureCache[t]&&TextureCache[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),TextureCache[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=TextureCache[e];if(t){const s=t.textureCacheIds.indexOf(e);return s>-1&&t.textureCacheIds.splice(s,1),delete TextureCache[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)TextureCache[e.textureCacheIds[t]]===e&&delete TextureCache[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:s,width:r,height:o}=e,h=t+r>this.baseTexture.width,c=s+o>this.baseTexture.height;if(h||c){const a=h&&c?"and":"or",u=`X: ${t} + ${r} = ${t+r} > ${this.baseTexture.width}`,d=`Y: ${s} + ${o} = ${s+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${a} ${d}`)}this.valid=r&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Texture._EMPTY||(Texture._EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture._EMPTY),removeAllHandlers(Texture._EMPTY.baseTexture)),Texture._EMPTY}static get WHITE(){if(!Texture._WHITE){const e=settings$1.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Texture._WHITE=new Texture(BaseTexture.from(e)),removeAllHandlers(Texture._WHITE),removeAllHandlers(Texture._WHITE.baseTexture)}return Texture._WHITE}}class RenderTexture extends Texture{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,s=!0){const r=this.baseTexture.resolution,o=Math.round(e*r)/r,h=Math.round(t*r)/r;this.valid=o>0&&h>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=h,s&&this.baseTexture.resize(o,h),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new RenderTexture(new BaseRenderTexture(e))}}class RenderTexturePool{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,s=MSAA_QUALITY.NONE){const r=new BaseRenderTexture(Object.assign({width:e,height:t,resolution:1,multisample:s},this.textureOptions));return new RenderTexture(r)}getOptimalTexture(e,t,s=1,r=MSAA_QUALITY.NONE){let o;e=Math.ceil(e*s-1e-6),t=Math.ceil(t*s-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=nextPow2(e),t=nextPow2(t),o=((e&65535)<<16|t&65535)>>>0,r>1&&(o+=r*4294967296)):o=r>1?-r:-1,this.texturePool[o]||(this.texturePool[o]=[]);let h=this.texturePool[o].pop();return h||(h=this.createTexture(e,t,r)),h.filterPoolKey=o,h.setResolution(s),h}getFilterTexture(e,t,s){const r=this.getOptimalTexture(e.width,e.height,t||e.resolution,s||MSAA_QUALITY.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const t in this.texturePool){const s=this.texturePool[t];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const s=this.texturePool[t];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}RenderTexturePool.SCREEN_KEY=-1;class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer(this.vertices),this.uvBuffer=new Buffer(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+t.width/e.width,this.uvs[3]=r,this.uvs[4]=s+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=s,this.uvs[7]=r+t.height/e.height,s=t.x,r=t.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+t.width,this.vertices[3]=r,this.vertices[4]=s+t.width,this.vertices[5]=r+t.height,this.vertices[6]=s,this.vertices[7]=r+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const tempPoints=[new Point,new Point,new Point,new Point],tempMatrix$2=new Matrix;class FilterSystem{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const s=this.renderer,r=this.defaultFilterStack,o=this.statePool.pop()||new FilterState,h=this.renderer.renderTexture;let c=t[0].resolution,a=t[0].multisample,u=t[0].padding,d=t[0].autoFit,p=t[0].legacy??!0;for(let _=1;_<t.length;_++){const y=t[_];c=Math.min(c,y.resolution),a=Math.min(a,y.multisample),u=this.useMaxPadding?Math.max(u,y.padding):u+y.padding,d=d&&y.autoFit,p=p||(y.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),r.push(o),o.resolution=c,o.multisample=a,o.legacy=p,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(u);const m=this.tempRect.copyFrom(h.sourceFrame);s.projection.transform&&this.transformAABB(tempMatrix$2.copyFrom(s.projection.transform).invert(),m),d?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,h.current?h.current.resolution:s.resolution,h.sourceFrame,h.destinationFrame,s.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,c,a),o.filters=t,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const g=this.tempRect;g.x=0,g.y=0,g.width=o.sourceFrame.width,g.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(h.sourceFrame),o.bindingDestinationFrame.copyFrom(h.destinationFrame),o.transform=s.projection.transform,s.projection.transform=null,h.bind(o.renderTexture,o.sourceFrame,g),s.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),s=t.filters;this.activeState=t;const r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;const o=r.inputSize,h=r.inputPixel,c=r.inputClamp;if(o[0]=t.destinationFrame.width,o[1]=t.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],h[0]=Math.round(o[0]*t.resolution),h[1]=Math.round(o[1]*t.resolution),h[2]=1/h[0],h[3]=1/h[1],c[0]=.5*h[2],c[1]=.5*h[3],c[2]=t.sourceFrame.width*o[2]-.5*h[2],c[3]=t.sourceFrame.height*o[3]-.5*h[3],t.legacy){const u=r.filterArea;u[0]=t.destinationFrame.width,u[1]=t.destinationFrame.height,u[2]=t.sourceFrame.x,u[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const a=e[e.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,t.renderTexture,a.renderTexture,CLEAR_MODES.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let u=t.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,t.resolution);d.filterFrame=u.filterFrame;let p=0;for(p=0;p<s.length-1;++p){p===1&&t.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,t.resolution),d.filterFrame=u.filterFrame),s[p].apply(this,u,d,CLEAR_MODES.CLEAR,t);const m=u;u=d,d=m}s[p].apply(this,u,a.renderTexture,CLEAR_MODES.BLEND,t),p>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=CLEAR_MODES.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e!=null&&e.filterFrame){const h=this.tempRect;h.x=0,h.y=0,h.width=e.filterFrame.width,h.height=e.filterFrame.height,s.bind(e,e.filterFrame,h)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=r.stateId&1||this.forceClear;(t===CLEAR_MODES.CLEAR||t===CLEAR_MODES.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,s,r){const o=this.renderer;o.state.set(e.state),this.bindAndClear(s,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(DRAW_MODES.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:o}=t._texture,h=e.set(r.width,0,0,r.height,s.x,s.y),c=t.worldTransform.copyTo(Matrix.TEMP_MATRIX);return c.invert(),h.prepend(c),h.scale(1/o.width,1/o.height),h.translate(t.anchor.x,t.anchor.y),h}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,s=1,r=MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(e,t,s,r)}getFilterTexture(e,t,s){if(typeof e=="number"){const o=e;e=t,t=o}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,s||MSAA_QUALITY.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const s=tempPoints[0],r=tempPoints[1],o=tempPoints[2],h=tempPoints[3];s.set(t.left,t.top),r.set(t.left,t.bottom),o.set(t.right,t.top),h.set(t.right,t.bottom),e.apply(s,s),e.apply(r,r),e.apply(o,o),e.apply(h,h);const c=Math.min(s.x,r.x,o.x,h.x),a=Math.min(s.y,r.y,o.y,h.y),u=Math.max(s.x,r.x,o.x,h.x),d=Math.max(s.y,r.y,o.y,h.y);t.x=c,t.y=a,t.width=u-c,t.height=d-a}roundFrame(e,t,s,r,o){if(!(e.width<=0||e.height<=0||s.width<=0||s.height<=0)){if(o){const{a:h,b:c,c:a,d:u}=o;if((Math.abs(c)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(h)>1e-4||Math.abs(u)>1e-4))return}o=o?tempMatrix$2.copyFrom(o):tempMatrix$2.identity(),o.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(o,e),e.ceil(t),this.transformAABB(o.invert(),e)}}}FilterSystem.extension={type:ExtensionType.RendererSystem,name:"filter"};extensions$1.add(FilterSystem);class GLFramebuffer{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const tempRectangle=new Rectangle;class FramebufferSystem{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY&&(t=null,s=null),t?e.drawBuffers=r=>t.drawBuffersWEBGL(r):(this.hasMRT=!1,e.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,s=0){const{gl:r}=this;if(e){const o=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==s&&(e.dirtyId++,e.dirtyFormat++,o.mipLevel=s),o.dirtyId!==e.dirtyId&&(o.dirtyId=e.dirtyId,o.dirtyFormat!==e.dirtyFormat?(o.dirtyFormat=e.dirtyFormat,o.dirtySize=e.dirtySize,this.updateFramebuffer(e,s)):o.dirtySize!==e.dirtySize&&(o.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let h=0;h<e.colorTextures.length;h++){const c=e.colorTextures[h];this.renderer.texture.unbind(c.parentTextureArray||c)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const h=t.width>>s,c=t.height>>s,a=h/t.width;this.setViewport(t.x*a,t.y*a,h,c)}else{const h=e.width>>s,c=e.height>>s;this.setViewport(0,0,h,c)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,s,r){const o=this.viewport;e=Math.round(e),t=Math.round(t),s=Math.round(s),r=Math.round(r),(o.width!==s||o.height!==r||o.x!==e||o.y!==t)&&(o.x=e,o.y=t,o.width=s,o.height=r,this.gl.viewport(e,t,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,s,r,o=BUFFER_BITS.COLOR|BUFFER_BITS.DEPTH){const{gl:h}=this;h.clearColor(e,t,s,r),h.clear(o)}initFramebuffer(e){const{gl:t}=this,s=new GLFramebuffer(t.createFramebuffer());return s.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(e),e.disposeRunner.add(this),s}resizeFramebuffer(e){const{gl:t}=this,s=e.glFramebuffers[this.CONTEXT_UID];s.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,s.stencil),s.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,s.multisample,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));const r=e.colorTextures;let o=r.length;t.drawBuffers||(o=Math.min(o,1));for(let h=0;h<o;h++){const c=r[h],a=c.parentTextureArray||c;this.renderer.texture.bind(a,0),h===0&&s.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,s.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,s.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:s}=this,r=e.glFramebuffers[this.CONTEXT_UID],o=e.colorTextures;let h=o.length;s.drawBuffers||(h=Math.min(h,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const c=[];for(let a=0;a<h;a++){const u=o[a],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),a===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+a,u.target,d._glTextures[this.CONTEXT_UID].texture,t),c.push(s.COLOR_ATTACHMENT0+a))}if(c.length>1&&s.drawBuffers(c),e.depthTexture&&this.writeDepthTexture){const u=e.depthTexture;this.renderer.texture.bind(u,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,t)}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,e.width,e.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,e.width,e.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let s=MSAA_QUALITY.NONE;if(e<=1||t===null)return s;for(let r=0;r<t.length;r++)if(t[r]<=e){s=t[r];break}return s===1&&(s=MSAA_QUALITY.NONE),s}blit(e,t,s){const{current:r,renderer:o,gl:h,CONTEXT_UID:c}=this;if(o.context.webGLVersion!==2||!r)return;const a=r.glFramebuffers[c];if(!a)return;if(!e){if(!a.msaaBuffer)return;const d=r.colorTextures[0];if(!d)return;a.blitFramebuffer||(a.blitFramebuffer=new Framebuffer(r.width,r.height),a.blitFramebuffer.addColorTexture(0,d)),e=a.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||(t=tempRectangle,t.width=r.width,t.height=r.height),s||(s=t);const u=t.width===s.width&&t.height===s.height;this.bind(e),h.bindFramebuffer(h.READ_FRAMEBUFFER,a.framebuffer),h.blitFramebuffer(t.left,t.top,t.right,t.bottom,s.left,s.top,s.right,s.bottom,h.COLOR_BUFFER_BIT,u?h.NEAREST:h.LINEAR)}disposeFramebuffer(e,t){const s=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete e.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(e);o>=0&&this.managedFramebuffers.splice(o,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&s.blitFramebuffer.dispose()}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<t.length;s++)this.disposeFramebuffer(t[s],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil)return;e.stencil=!0;const s=e.width,r=e.height,o=this.gl,h=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,h),t.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,t.multisample,o.DEPTH24_STENCIL8,s,r):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,s,r),t.stencil=h,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,h)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}}FramebufferSystem.extension={type:ExtensionType.RendererSystem,name:"framebuffer"};extensions$1.add(FramebufferSystem);const byteSizeMap={5126:4,5123:2,5121:1};class GeometrySystem{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;settings$1.PREFER_ENV===ENV.WEBGL_LEGACY&&(s=null),s?(e.createVertexArray=()=>s.createVertexArrayOES(),e.bindVertexArray=r=>s.bindVertexArrayOES(r),e.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){const s=e.getExtension("ANGLE_instanced_arrays");s?(e.vertexAttribDivisor=(r,o)=>s.vertexAttribDivisorANGLE(r,o),e.drawElementsInstanced=(r,o,h,c,a)=>s.drawElementsInstancedANGLE(r,o,h,c,a),e.drawArraysInstanced=(r,o,h,c)=>s.drawArraysInstancedANGLE(r,o,h,c)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:s}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],o=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},o=!0);const h=r[t.program.id]||this.initGeometryVao(e,t,o);this._activeGeometry=e,this._activeVao!==h&&(this._activeVao=h,this.hasVao?s.bindVertexArray(h):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let s=0;s<e.buffers.length;s++){const r=e.buffers[s];t.update(r)}}checkCompatibility(e,t){const s=e.attributes,r=t.attributeData;for(const o in r)if(!s[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(e,t){const s=e.attributes,r=t.attributeData,o=["g",e.id];for(const h in s)r[h]&&o.push(h,r[h].location);return o.join("-")}initGeometryVao(e,t,s=!0){const r=this.gl,o=this.CONTEXT_UID,h=this.renderer.buffer,c=t.program;c.glPrograms[o]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,c);const a=this.getSignature(e,c),u=e.glVertexArrayObjects[this.CONTEXT_UID];let d=u[a];if(d)return u[c.id]=d,d;const p=e.buffers,m=e.attributes,g={},_={};for(const y in p)g[y]=0,_[y]=0;for(const y in m)!m[y].size&&c.attributeData[y]?m[y].size=c.attributeData[y].size:m[y].size||console.warn(`PIXI Geometry attribute '${y}' size cannot be determined (likely the bound shader does not have the attribute)`),g[m[y].buffer]+=m[y].size*byteSizeMap[m[y].type];for(const y in m){const v=m[y],N=v.size;v.stride===void 0&&(g[v.buffer]===N*byteSizeMap[v.type]?v.stride=0:v.stride=g[v.buffer]),v.start===void 0&&(v.start=_[v.buffer],_[v.buffer]+=N*byteSizeMap[v.type])}d=r.createVertexArray(),r.bindVertexArray(d);for(let y=0;y<p.length;y++){const v=p[y];h.bind(v),s&&v._glBuffers[o].refCount++}return this.activateVao(e,c),u[c.id]=d,u[a]=d,r.bindVertexArray(null),h.unbind(BUFFER_TYPE.ARRAY_BUFFER),d}disposeGeometry(e,t){var c;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const s=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,o=e.buffers,h=(c=this.renderer)==null?void 0:c.buffer;if(e.disposeRunner.remove(this),!!s){if(h)for(let a=0;a<o.length;a++){const u=o[a]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!t&&h.dispose(o[a],t))}if(!t){for(const a in s)if(a[0]==="g"){const u=s[a];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let s=0;s<t.length;s++)this.disposeGeometry(this.managedGeometries[t[s]],e)}activateVao(e,t){const s=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,h=e.buffers,c=e.attributes;e.indexBuffer&&o.bind(e.indexBuffer);let a=null;for(const u in c){const d=c[u],p=h[d.buffer],m=p._glBuffers[r];if(t.attributeData[u]){a!==m&&(o.bind(p),a=m);const g=t.attributeData[u].location;if(s.enableVertexAttribArray(g),s.vertexAttribPointer(g,d.size,d.type||s.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)s.vertexAttribDivisor(g,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,s,r){const{gl:o}=this,h=this._activeGeometry;if(h.indexBuffer){const c=h.indexBuffer.data.BYTES_PER_ELEMENT,a=c===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;c===2||c===4&&this.canUseUInt32ElementIndex?h.instanced?o.drawElementsInstanced(e,t||h.indexBuffer.data.length,a,(s||0)*c,r||1):o.drawElements(e,t||h.indexBuffer.data.length,a,(s||0)*c):console.warn("unsupported index buffer type: uint32")}else h.instanced?o.drawArraysInstanced(e,s,t||h.getSize(),r||1):o.drawArrays(e,s,t||h.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}GeometrySystem.extension={type:ExtensionType.RendererSystem,name:"geometry"};extensions$1.add(GeometrySystem);const tempMat$1=new Matrix;class TextureMatrix{constructor(e,t){this._texture=e,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);const s=this.mapCoord;for(let r=0;r<e.length;r+=2){const o=e[r],h=e[r+1];t[r]=o*s.a+h*s.c+s.tx,t[r+1]=o*s.b+h*s.d+s.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const s=t._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=t.orig,o=t.trim;o&&(tempMat$1.set(r.width/o.width,0,0,r.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(tempMat$1));const h=t.baseTexture,c=this.uClampFrame,a=this.clampMargin/h.resolution,u=this.clampOffset;return c[0]=(t._frame.x+a+u)/h.width,c[1]=(t._frame.y+a+u)/h.height,c[2]=(t._frame.x+t._frame.width-a+u)/h.width,c[3]=(t._frame.y+t._frame.height-a+u)/h.height,this.uClampOffset[0]=u/h.realWidth,this.uClampOffset[1]=u/h.realHeight,this.isSimple=t._frame.width===h.width&&t._frame.height===h.height&&t.rotate===0,!0}}var fragment$7=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vertex$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class SpriteMaskFilter extends Filter{constructor(e,t,s){let r=null;typeof e!="string"&&t===void 0&&s===void 0&&(r=e,e=void 0,t=void 0,s=void 0),super(e||vertex$4,t||fragment$7,s),this.maskSprite=r,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,s,r){const o=this._maskSprite,h=o._texture;h.valid&&(h.uvMatrix||(h.uvMatrix=new TextureMatrix(h,0)),h.uvMatrix.update(),this.uniforms.npmAlpha=h.baseTexture.alphaMode?0:1,this.uniforms.mask=h,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(h.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=h.uvMatrix.uClampFrame,e.applyFilter(this,t,s,r))}}class MaskData{constructor(e=null){this.type=MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Filter.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class MaskSystem{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let s=t;if(!s.isMaskData){const o=this.maskDataPool.pop()||new MaskData;o.pooled=!0,o.maskObject=t,s=o}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=e,s.type!==MASK_TYPES.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.push(s);break;case MASK_TYPES.STENCIL:this.renderer.stencil.push(s);break;case MASK_TYPES.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case MASK_TYPES.COLOR:this.pushColorMask(s);break}s.type===MASK_TYPES.SPRITE&&this.maskStack.push(s)}pop(e){const t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.pop(t);break;case MASK_TYPES.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case MASK_TYPES.SPRITE:this.popSpriteMask(t);break;case MASK_TYPES.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===MASK_TYPES.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=MASK_TYPES.SCISSOR:e.type=MASK_TYPES.STENCIL:e.type=MASK_TYPES.COLOR}pushSpriteMask(e){const{maskObject:t}=e,s=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter]));const o=this.renderer,h=o.renderTexture;let c,a;if(h.current){const d=h.current;c=e.resolution||d.resolution,a=e.multisample??d.multisample}else c=e.resolution||o.resolution,a=e.multisample??o.multisample;r[0].resolution=c,r[0].multisample=a,r[0].maskSprite=t;const u=s.filterArea;s.filterArea=t.getBounds(!0),o.filter.push(s,r),s.filterArea=u,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,s=e._colorMask=t&e.colorMask;s!==t&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(e){const t=e._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==t&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}MaskSystem.extension={type:ExtensionType.RendererSystem,name:"mask"};extensions$1.add(MaskSystem);class AbstractMaskSystem{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,s=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==s&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const tempMatrix$1=new Matrix,rectPool=[],_ScissorSystem=class extends AbstractMaskSystem{constructor(n){super(n),this.glConst=settings$1.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const n=this.maskStack[this.maskStack.length-1];return n?n._scissorCounter:0}calcScissorRect(n){if(n._scissorRectLocal)return;const e=n._scissorRect,{maskObject:t}=n,{renderer:s}=this,r=s.renderTexture,o=t.getBounds(!0,rectPool.pop()??new Rectangle);this.roundFrameToPixels(o,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),e&&o.fit(e),n._scissorRectLocal=o}static isMatrixRotated(n){if(!n)return!1;const{a:e,b:t,c:s,d:r}=n;return(Math.abs(t)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4)}testScissor(n){const{maskObject:e}=n;if(!e.isFastRect||!e.isFastRect()||_ScissorSystem.isMatrixRotated(e.worldTransform)||_ScissorSystem.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(n);const t=n._scissorRectLocal;return t.width>0&&t.height>0}roundFrameToPixels(n,e,t,s,r){_ScissorSystem.isMatrixRotated(r)||(r=r?tempMatrix$1.copyFrom(r):tempMatrix$1.identity(),r.translate(-t.x,-t.y).scale(s.width/t.width,s.height/t.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,n),n.fit(s),n.x=Math.round(n.x*e),n.y=Math.round(n.y*e),n.width=Math.round(n.width*e),n.height=Math.round(n.height*e))}push(n){n._scissorRectLocal||this.calcScissorRect(n);const{gl:e}=this.renderer;n._scissorRect||e.enable(e.SCISSOR_TEST),n._scissorCounter++,n._scissorRect=n._scissorRectLocal,this._useCurrent()}pop(n){const{gl:e}=this.renderer;n&&rectPool.push(n._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const n=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=n.y:e=this.renderer.height-n.height-n.y,this.renderer.gl.scissor(n.x,e,n.width,n.height)}};let ScissorSystem=_ScissorSystem;ScissorSystem.extension={type:ExtensionType.RendererSystem,name:"scissor"};extensions$1.add(ScissorSystem);class StencilSystem extends AbstractMaskSystem{constructor(e){super(e),this.glConst=settings$1.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:s}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),e._stencilCounter++;const o=e._colorMask;o!==0&&(e._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,o!==0&&(e._colorMask=o,s.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(e){const t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(s._colorMask=r,t.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}StencilSystem.extension={type:ExtensionType.RendererSystem,name:"stencil"};extensions$1.add(StencilSystem);class PluginSystem{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(e){for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}PluginSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_plugin"};extensions$1.add(PluginSystem);class ProjectionSystem{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(e,t,s,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(e,t,s,r){const o=this.projectionMatrix,h=r?-1:1;o.identity(),o.a=1/t.width*2,o.d=h*(1/t.height*2),o.tx=-1-t.x*o.a,o.ty=-h-t.y*o.d}setTransform(e){}destroy(){this.renderer=null}}ProjectionSystem.extension={type:ExtensionType.RendererSystem,name:"projection"};extensions$1.add(ProjectionSystem);const tempTransform=new Transform;class GenerateTextureSystem{constructor(e){this.renderer=e,this._tempMatrix=new Matrix}generateTexture(e,t){const{region:s,...r}=t||{},o=s||e.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);const h=RenderTexture.create({width:o.width,height:o.height,...r});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const c=e.transform;return e.transform=tempTransform,this.renderer.render(e,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=c,h}destroy(){}}GenerateTextureSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"textureGenerator"};extensions$1.add(GenerateTextureSystem);const tempRect=new Rectangle,tempRect2=new Rectangle;class RenderTextureSystem{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}bind(e=null,t,s){const r=this.renderer;this.current=e;let o,h,c;e?(o=e.baseTexture,c=o.resolution,t||(tempRect.width=e.frame.width,tempRect.height=e.frame.height,t=tempRect),s||(tempRect2.x=e.frame.x,tempRect2.y=e.frame.y,tempRect2.width=t.width,tempRect2.height=t.height,s=tempRect2),h=o.framebuffer):(c=r.resolution,t||(tempRect.width=r._view.screen.width,tempRect.height=r._view.screen.height,t=tempRect),s||(s=tempRect,s.width=t.width,s.height=t.height));const a=this.viewportFrame;a.x=s.x*c,a.y=s.y*c,a.width=s.width*c,a.height=s.height*c,e||(a.y=r.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(h,a),this.renderer.projection.update(s,t,c,!h),e?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(s)}clear(e,t){this.current?e=e||this.current.baseTexture.clearColor:e=e||this.renderer.background.colorRgba;const s=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,o=s.width!==r.width||s.height!==r.height;if(o){let{x:h,y:c,width:a,height:u}=this.viewportFrame;h=Math.round(h),c=Math.round(c),a=Math.round(a),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,c,a,u)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}RenderTextureSystem.extension={type:ExtensionType.RendererSystem,name:"renderTexture"};extensions$1.add(RenderTextureSystem);class GLProgram{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function getAttributeData(n,e){const t={},s=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const o=e.getActiveAttrib(n,r);if(o.name.startsWith("gl_"))continue;const h=mapType(e,o.type),c={type:h,name:o.name,size:mapSize(h),location:e.getAttribLocation(n,o.name)};t[o.name]=c}return t}function getUniformData(n,e){const t={},s=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const o=e.getActiveUniform(n,r),h=o.name.replace(/\[.*?\]$/,""),c=!!o.name.match(/\[.*?\]$/),a=mapType(e,o.type);t[h]={name:h,index:r,type:a,size:o.size,isArray:c,value:defaultValue(a,o.size)}}return t}function generateProgram(n,e){var a;const t=compileShader(n,n.VERTEX_SHADER,e.vertexSrc),s=compileShader(n,n.FRAGMENT_SHADER,e.fragmentSrc),r=n.createProgram();n.attachShader(r,t),n.attachShader(r,s);const o=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(o&&(typeof n.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(r,o.names,o.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||logProgramError(n,r,t,s),e.attributeData=getAttributeData(r,n),e.uniformData=getUniformData(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const u=Object.keys(e.attributeData);u.sort((d,p)=>d>p?1:-1);for(let d=0;d<u.length;d++)e.attributeData[u[d]].location=d,n.bindAttribLocation(r,d,u[d]);n.linkProgram(r)}n.deleteShader(t),n.deleteShader(s);const h={};for(const u in e.uniformData){const d=e.uniformData[u];h[u]={location:n.getUniformLocation(r,u),value:defaultValue(d.type,d.size)}}return new GLProgram(r,h)}function uboUpdate(n,e,t,s,r){t.buffer.update(r)}const UBO_TO_SINGLE_SETTERS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function createUBOElements(n){const e=n.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let t=0,s=0,r=0;for(let o=0;o<e.length;o++){const h=e[o];if(t=GLSL_TO_STD40_SIZE[h.data.type],h.data.size>1&&(t=Math.max(t,16)*h.data.size),h.dataLen=t,s%t!==0&&s<16){const c=s%t%16;s+=c,r+=c}s+t>16?(r=Math.ceil(r/16)*16,h.offset=r,r+=t,s=t):(h.offset=r,s+=t,r+=t)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function getUBOData(n,e){const t=[];for(const s in n)e[s]&&t.push(e[s]);return t.sort((s,r)=>s.index-r.index),t}function generateUniformBufferSync(n,e){if(!n.autoManage)return{size:0,syncFunc:uboUpdate};const t=getUBOData(n.uniforms,e),{uboElements:s,size:r}=createUBOElements(t),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let h=0;h<s.length;h++){const c=s[h],a=n.uniforms[c.data.name],u=c.data.name;let d=!1;for(let p=0;p<uniformParsers.length;p++){const m=uniformParsers[p];if(m.codeUbo&&m.test(c.data,a)){o.push(`offset = ${c.offset/4};`,uniformParsers[p].codeUbo(c.data.name,a)),d=!0;break}}if(!d)if(c.data.size>1){const p=mapSize(c.data.type),m=Math.max(GLSL_TO_STD40_SIZE[c.data.type]/16,1),g=p/m,_=(4-g%4)%4;o.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${c.offset/4};

                t = 0;

                for(var i=0; i < ${c.data.size*m}; i++)
                {
                    for(var j = 0; j < ${g}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{const p=UBO_TO_SINGLE_SETTERS[c.data.type];o.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${c.offset/4};
                ${p};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let UID=0;const defaultSyncData={textureCount:0,uboCount:0};class ShaderSystem{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID++}systemCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const s=e.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),t||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(e.uniformGroup,defaultSyncData)),r}setUniforms(e){const t=this.shader.program,s=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(s.uniformData,e,this.renderer)}syncUniformGroup(e,t){const s=this.getGlProgram();(!e.static||e.dirtyId!==s.uniformDirtyGroups[e.id])&&(s.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,s,t))}syncUniforms(e,t,s){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,s)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=generateUniformsSync(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const s=this.getGlProgram();if(!e.static||e.dirtyId!==0||!s.uniformGroups[e.id]){e.dirtyId=0;const r=s.uniformGroups[e.id]||this.createSyncBufferGroup(e,s,t);e.buffer.update(),r(s.uniformData,e.uniforms,this.renderer,defaultSyncData,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,s.uniformBufferBindings[t])}createSyncBufferGroup(e,t,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const o=this.gl.getUniformBlockIndex(t.program,s);t.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const h=this.getSignature(e,this.shader.program.uniformData,"ubo");let c=this._uboCache[h];if(c||(c=this._uboCache[h]=generateUniformBufferSync(e,this.shader.program.uniformData)),e.autoManage){const a=new Float32Array(c.size/4);e.buffer.update(a)}return t.uniformGroups[e.id]=c.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,s){const r=e.uniforms,o=[`${s}-`];for(const h in r)o.push(h),t[h]&&o.push(t[h].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,s=e.program,r=generateProgram(t,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ShaderSystem.extension={type:ExtensionType.RendererSystem,name:"shader"};extensions$1.add(ShaderSystem);class StartupSystem{constructor(e){this.renderer=e}run(e){const t=this.renderer;t.emitWithCustomOptions(t.runners.init,e),e.hello&&console.log(`PixiJS 7.1.1 - ${t.rendererLogId} - https://pixijs.com`),t.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}StartupSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"startup"};extensions$1.add(StartupSystem);function mapWebGLBlendModesToPixi(n,e=[]){return e[BLEND_MODES.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.ADD]=[n.ONE,n.ONE],e[BLEND_MODES.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.NONE]=[0,0],e[BLEND_MODES.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e[BLEND_MODES.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.SRC_IN]=[n.DST_ALPHA,n.ZERO],e[BLEND_MODES.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],e[BLEND_MODES.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],e[BLEND_MODES.DST_IN]=[n.ZERO,n.SRC_ALPHA],e[BLEND_MODES.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],e[BLEND_MODES.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[BLEND_MODES.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],e}const BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_StateSystem=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new State$1,this.defaultState.blend=!0}contextChange(n){this.gl=n,this.blendModes=mapWebGLBlendModesToPixi(n),this.set(this.defaultState),this.reset()}set(n){if(n=n||this.defaultState,this.stateId!==n.data){let e=this.stateId^n.data,t=0;for(;e;)e&1&&this.map[t].call(this,!!(n.data&1<<t)),e=e>>1,t++;this.stateId=n.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,n)}forceState(n){n=n||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(n.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,n);this.stateId=n.data}setBlend(n){this.updateCheck(_StateSystem.checkBlendMode,n),this.gl[n?"enable":"disable"](this.gl.BLEND)}setOffset(n){this.updateCheck(_StateSystem.checkPolygonOffset,n),this.gl[n?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(n){this.gl[n?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(n){this.gl.depthMask(n)}setCullFace(n){this.gl[n?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(n){this.gl.frontFace(this.gl[n?"CW":"CCW"])}setBlendMode(n){if(n===this.blendMode)return;this.blendMode=n;const e=this.blendModes[n],t=this.gl;e.length===2?t.blendFunc(e[0],e[1]):t.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,t.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD))}setPolygonOffset(n,e){this.gl.polygonOffset(n,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(n,e){const t=this.checks.indexOf(n);e&&t===-1?this.checks.push(n):!e&&t!==-1&&this.checks.splice(t,1)}static checkBlendMode(n,e){n.setBlendMode(e.blendMode)}static checkPolygonOffset(n,e){n.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let StateSystem=_StateSystem;StateSystem.extension={type:ExtensionType.RendererSystem,name:"state"};extensions$1.add(StateSystem);class SystemManager extends eventemitter3Exports{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter(r=>e.systems[r]),s=[...t,...Object.keys(e.systems).filter(r=>!t.includes(r))];for(const r of s)this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(t=>{this.runners[t]=new Runner(t)})}addSystem(e,t){const s=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=s,this._systemsHash[t]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(e,t){const s=Object.keys(this._systemsHash);e.items.forEach(r=>{const o=s.find(h=>this._systemsHash[h]===r);r[e.name](t[o])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const _TextureGCSystem=class{constructor(n){this.renderer=n,this.count=0,this.checkCount=0,this.maxIdle=_TextureGCSystem.defaultMaxIdle,this.checkCountMax=_TextureGCSystem.defaultCheckCountMax,this.mode=_TextureGCSystem.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const n=this.renderer.texture,e=n.managedTextures;let t=!1;for(let s=0;s<e.length;s++){const r=e[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(n.destroyTexture(r,!0),e[s]=null,t=!0)}if(t){let s=0;for(let r=0;r<e.length;r++)e[r]!==null&&(e[s++]=e[r]);e.length=s}}unload(n){const e=this.renderer.texture,t=n._texture;t&&!t.framebuffer&&e.destroyTexture(t);for(let s=n.children.length-1;s>=0;s--)this.unload(n.children[s])}destroy(){this.renderer=null}};let TextureGCSystem=_TextureGCSystem;TextureGCSystem.defaultMode=GC_MODES.AUTO;TextureGCSystem.defaultMaxIdle=60*60;TextureGCSystem.defaultCheckCountMax=60*10;TextureGCSystem.extension={type:ExtensionType.RendererSystem,name:"textureGC"};extensions$1.add(TextureGCSystem);class GLTexture{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=TYPES.UNSIGNED_BYTE,this.internalFormat=FORMATS.RGBA,this.samplerType=0}}function mapTypeAndFormatToInternalFormat(n){let e;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?e={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:n.RGBA8,[FORMATS.RGB]:n.RGB8,[FORMATS.RG]:n.RG8,[FORMATS.RED]:n.R8,[FORMATS.RGBA_INTEGER]:n.RGBA8UI,[FORMATS.RGB_INTEGER]:n.RGB8UI,[FORMATS.RG_INTEGER]:n.RG8UI,[FORMATS.RED_INTEGER]:n.R8UI,[FORMATS.ALPHA]:n.ALPHA,[FORMATS.LUMINANCE]:n.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[TYPES.BYTE]:{[FORMATS.RGBA]:n.RGBA8_SNORM,[FORMATS.RGB]:n.RGB8_SNORM,[FORMATS.RG]:n.RG8_SNORM,[FORMATS.RED]:n.R8_SNORM,[FORMATS.RGBA_INTEGER]:n.RGBA8I,[FORMATS.RGB_INTEGER]:n.RGB8I,[FORMATS.RG_INTEGER]:n.RG8I,[FORMATS.RED_INTEGER]:n.R8I},[TYPES.UNSIGNED_SHORT]:{[FORMATS.RGBA_INTEGER]:n.RGBA16UI,[FORMATS.RGB_INTEGER]:n.RGB16UI,[FORMATS.RG_INTEGER]:n.RG16UI,[FORMATS.RED_INTEGER]:n.R16UI,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT16},[TYPES.SHORT]:{[FORMATS.RGBA_INTEGER]:n.RGBA16I,[FORMATS.RGB_INTEGER]:n.RGB16I,[FORMATS.RG_INTEGER]:n.RG16I,[FORMATS.RED_INTEGER]:n.R16I},[TYPES.UNSIGNED_INT]:{[FORMATS.RGBA_INTEGER]:n.RGBA32UI,[FORMATS.RGB_INTEGER]:n.RGB32UI,[FORMATS.RG_INTEGER]:n.RG32UI,[FORMATS.RED_INTEGER]:n.R32UI,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT24},[TYPES.INT]:{[FORMATS.RGBA_INTEGER]:n.RGBA32I,[FORMATS.RGB_INTEGER]:n.RGB32I,[FORMATS.RG_INTEGER]:n.RG32I,[FORMATS.RED_INTEGER]:n.R32I},[TYPES.FLOAT]:{[FORMATS.RGBA]:n.RGBA32F,[FORMATS.RGB]:n.RGB32F,[FORMATS.RG]:n.RG32F,[FORMATS.RED]:n.R32F,[FORMATS.DEPTH_COMPONENT]:n.DEPTH_COMPONENT32F},[TYPES.HALF_FLOAT]:{[FORMATS.RGBA]:n.RGBA16F,[FORMATS.RGB]:n.RGB16F,[FORMATS.RG]:n.RG16F,[FORMATS.RED]:n.R16F},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:n.RGB565},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:n.RGBA4},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:n.RGB5_A1},[TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[FORMATS.RGBA]:n.RGB10_A2,[FORMATS.RGBA_INTEGER]:n.RGB10_A2UI},[TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[FORMATS.RGB]:n.R11F_G11F_B10F},[TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[FORMATS.RGB]:n.RGB9_E5},[TYPES.UNSIGNED_INT_24_8]:{[FORMATS.DEPTH_STENCIL]:n.DEPTH24_STENCIL8},[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[FORMATS.DEPTH_STENCIL]:n.DEPTH32F_STENCIL8}}:e={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:n.RGBA,[FORMATS.RGB]:n.RGB,[FORMATS.ALPHA]:n.ALPHA,[FORMATS.LUMINANCE]:n.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:n.RGB},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:n.RGBA},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:n.RGBA}},e}class TextureSystem{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new GLTexture(e.createTexture());e.bindTexture(e.TEXTURE_2D,s.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=s,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new GLTexture(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(e,t=0){const{gl:s}=this;if(e=e==null?void 0:e.castToBaseTexture(),e!=null&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),s.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,s.activeTexture(s.TEXTURE0+t)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===e&&(this.currentLocation!==r&&(t.activeTexture(t.TEXTURE0+r),this.currentLocation=r),t.bindTexture(e.target,this.emptyTextures[e.target].texture),s[r]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let o=e-1;o>=0;--o){const h=t[o];h&&h._glTextures[r].samplerType!==SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(h)}}initTexture(e){const t=new GLTexture(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var s;t.internalFormat=((s=this.internalFormats[e.type])==null?void 0:s[e.format])??e.format,this.webGLVersion===2&&e.type===TYPES.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var r;const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const s=this.renderer;if(this.initTextureType(e,t),(r=e.resource)!=null&&r.upload(s,e,t))t.samplerType!==SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{const o=e.realWidth,h=e.realHeight,c=s.gl;(t.width!==o||t.height!==h||t.dirtyId<0)&&(t.width=o,t.height=h,c.texImage2D(e.target,0,t.internalFormat,o,h,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:s}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),s.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const r=this.managedTextures.indexOf(e);r!==-1&&removeItems(this.managedTextures,r,1)}}updateTextureStyle(e){var s;const t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===MIPMAP_MODES.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=WRAP_MODES.CLAMP:t.wrapMode=e.wrapMode,(s=e.resource)!=null&&s.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const s=this.gl;if(t.mipmap&&e.mipmap!==MIPMAP_MODES.ON_MANUAL&&s.generateMipmap(e.target),s.texParameteri(e.target,s.TEXTURE_WRAP_S,t.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===SCALE_MODES.LINEAR){const o=Math.min(e.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,e.scaleMode===SCALE_MODES.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}TextureSystem.extension={type:ExtensionType.RendererSystem,name:"texture"};extensions$1.add(TextureSystem);class TransformFeedbackSystem{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:s}=this,r=e._glTransformFeedbacks[s]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:s,renderer:r}=this;t&&r.shader.bind(t),s.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:s,CONTEXT_UID:r}=this,o=t.createTransformFeedback();e._glTransformFeedbacks[r]=o,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,o);for(let h=0;h<e.buffers.length;h++){const c=e.buffers[h];c&&(s.buffer.update(c),c._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,h,c._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),o}disposeTransformFeedback(e,t){const s=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let h=0;h<e.buffers.length;h++){const c=e.buffers[h];if(!c)continue;const a=c._glBuffers[this.CONTEXT_UID];a&&(a.refCount--,a.refCount===0&&!t&&o.dispose(c,t))}s&&(t||r.deleteTransformFeedback(s),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}TransformFeedbackSystem.extension={type:ExtensionType.RendererSystem,name:"transformFeedback"};extensions$1.add(TransformFeedbackSystem);class ViewSystem{constructor(e){this.renderer=e}init(e){this.screen=new Rectangle(0,0,e.width,e.height),this.element=e.view||settings$1.ADAPTER.createCanvas(),this.resolution=e.resolution||settings$1.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var t;e&&((t=this.element.parentNode)==null||t.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ViewSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_view"};extensions$1.add(ViewSystem);settings$1.PREFER_ENV=ENV.WEBGL2;settings$1.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(settings$1,{WRAP_MODE:{get(){return BaseTexture.defaultOptions.wrapMode},set(n){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),BaseTexture.defaultOptions.wrapMode=n}},SCALE_MODE:{get(){return BaseTexture.defaultOptions.scaleMode},set(n){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),BaseTexture.defaultOptions.scaleMode=n}},MIPMAP_TEXTURES:{get(){return BaseTexture.defaultOptions.mipmap},set(n){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),BaseTexture.defaultOptions.mipmap=n}},ANISOTROPIC_LEVEL:{get(){return BaseTexture.defaultOptions.anisotropicLevel},set(n){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),BaseTexture.defaultOptions.anisotropicLevel=n}},FILTER_RESOLUTION:{get(){return deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Filter.defaultResolution},set(n){Filter.defaultResolution=n}},FILTER_MULTISAMPLE:{get(){return deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Filter.defaultMultisample},set(n){Filter.defaultMultisample=n}},SPRITE_MAX_TEXTURES:{get(){return BatchRenderer.defaultMaxTextures},set(n){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),BatchRenderer.defaultMaxTextures=n}},SPRITE_BATCH_SIZE:{get(){return BatchRenderer.defaultBatchSize},set(n){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),BatchRenderer.defaultBatchSize=n}},CAN_UPLOAD_SAME_BUFFER:{get(){return BatchRenderer.canUploadSameBuffer},set(n){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),BatchRenderer.canUploadSameBuffer=n}},GC_MODE:{get(){return TextureGCSystem.defaultMode},set(n){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),TextureGCSystem.defaultMode=n}},GC_MAX_IDLE:{get(){return TextureGCSystem.defaultMaxIdle},set(n){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),TextureGCSystem.defaultMaxIdle=n}},GC_MAX_CHECK_COUNT:{get(){return TextureGCSystem.defaultCheckCountMax},set(n){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),TextureGCSystem.defaultCheckCountMax=n}},PRECISION_VERTEX:{get(){return Program.defaultVertexPrecision},set(n){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Program.defaultVertexPrecision=n}},PRECISION_FRAGMENT:{get(){return Program.defaultFragmentPrecision},set(n){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Program.defaultFragmentPrecision=n}}});var UPDATE_PRIORITY=(n=>(n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(UPDATE_PRIORITY||{});class TickerListener{constructor(e,t=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=s,this.once=r}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const _Ticker=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/_Ticker.targetFPMS,this.elapsedMS=1/_Ticker.targetFPMS,this._tick=n=>{this._requestId=null,this.started&&(this.update(n),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(n,e,t=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(n,e,t))}addOnce(n,e,t=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(n,e,t,!0))}_addListener(n){let e=this._head.next,t=this._head;if(!e)n.connect(t);else{for(;e;){if(n.priority>e.priority){n.connect(t);break}t=e,e=e.next}n.previous||n.connect(t)}return this._startIfPossible(),this}remove(n,e){let t=this._head.next;for(;t;)t.match(n,e)?t=t.destroy():t=t.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let n=0,e=this._head;for(;e=e.next;)n++;return n}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let n=this._head.next;for(;n;)n=n.destroy(!0);this._head.destroy(),this._head=null}}update(n=performance.now()){let e;if(n>this.lastTime){if(e=this.elapsedMS=n-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=n-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=n-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*_Ticker.targetFPMS;const t=this._head;let s=t.next;for(;s;)s=s.emit(this.deltaTime);t.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=n}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(n){const e=Math.min(this.maxFPS,n),t=Math.min(Math.max(0,e)/1e3,_Ticker.targetFPMS);this._maxElapsedMS=1/t}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(n){if(n===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,n);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!_Ticker._shared){const n=_Ticker._shared=new _Ticker;n.autoStart=!0,n._protected=!0}return _Ticker._shared}static get system(){if(!_Ticker._system){const n=_Ticker._system=new _Ticker;n.autoStart=!0,n._protected=!0}return _Ticker._system}};let Ticker=_Ticker;Ticker.targetFPMS=.06;Object.defineProperties(settings$1,{TARGET_FPMS:{get(){return Ticker.targetFPMS},set(n){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ticker.targetFPMS=n}}});class TickerPlugin{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ticker.shared:new Ticker,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}TickerPlugin.extension=ExtensionType.Application;extensions$1.add(TickerPlugin);const renderers=[];extensions$1.handleByList(ExtensionType.Renderer,renderers);function autoDetectRenderer(n){for(const e of renderers)if(e.test(n))return new e(n);throw new Error("Unable to auto-detect a suitable renderer.")}var $defaultVertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$defaultFilterVertex=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const defaultVertex=$defaultVertex,defaultFilterVertex=$defaultFilterVertex;class MultisampleSystem{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){const s=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,s)}else{const s=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,s)}t>=MSAA_QUALITY.HIGH?this.multisample=MSAA_QUALITY.HIGH:t>=MSAA_QUALITY.MEDIUM?this.multisample=MSAA_QUALITY.MEDIUM:t>=MSAA_QUALITY.LOW?this.multisample=MSAA_QUALITY.LOW:this.multisample=MSAA_QUALITY.NONE}destroy(){}}MultisampleSystem.extension={type:ExtensionType.RendererSystem,name:"_multisample"};extensions$1.add(MultisampleSystem);class GLBuffer{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class BufferSystem{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:s}=this,r=e._glBuffers[s]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[t]!==e){const o=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,s.bindBufferBase(s.UNIFORM_BUFFER,t,o.buffer)}}bindBufferRange(e,t,s){const{gl:r,CONTEXT_UID:o}=this;s=s||0;const h=e._glBuffers[o]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,h.buffer,s*256,256)}update(e){const{gl:t,CONTEXT_UID:s}=this,r=e._glBuffers[s]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const o=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,o)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const s=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),s&&(t||r.deleteBuffer(s.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let s=0;s<t.length;s++)this.dispose(this.managedBuffers[t[s]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:s}=this;return e._glBuffers[t]=new GLBuffer(s.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}BufferSystem.extension={type:ExtensionType.RendererSystem,name:"buffer"};extensions$1.add(BufferSystem);class ObjectRendererSystem{constructor(e){this.renderer=e}render(e,t){const s=this.renderer;let r,o,h,c;if(t&&(r=t.renderTexture,o=t.clear,h=t.transform,c=t.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=h,!s.context.isLost){if(r||(this.lastObjectRendered=e),!c){const a=e.enableTempParent();e.updateTransform(),e.disableTempParent(a)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(o??s.background.clearBeforeRender)&&s.renderTexture.clear(),e.render(s),s.batch.currentRenderer.flush(),r&&(t.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ObjectRendererSystem.extension={type:ExtensionType.RendererSystem,name:"objectRenderer"};extensions$1.add(ObjectRendererSystem);const _Renderer=class extends SystemManager{constructor(n){super(),n=Object.assign({},settings$1.RENDER_OPTIONS,n),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:_Renderer.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in n&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),n.premultipliedAlpha=n.useContextAlpha&&n.useContextAlpha!=="notMultiplied",n.backgroundAlpha=n.useContextAlpha===!1?1:n.backgroundAlpha);const t={hello:n.hello,_plugin:_Renderer.__plugins,background:{alpha:n.backgroundAlpha,color:n.background??n.backgroundColor,clearBeforeRender:n.clearBeforeRender},_view:{height:n.height,width:n.width,autoDensity:n.autoDensity,resolution:n.resolution,view:n.view},context:{antialias:n.antialias,context:n.context,powerPreference:n.powerPreference,premultipliedAlpha:n.premultipliedAlpha,preserveDrawingBuffer:n.preserveDrawingBuffer}};this.startup.run(t),this.options=n}static test(n){return n!=null&&n.forceCanvas?!1:isWebGLSupported()}render(n,e){this.objectRenderer.render(n,e)}resize(n,e){this._view.resizeView(n,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(n=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:n}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(n){this._view.resolution=n,this.runners.resolutionChange.emit(n)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(n){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=n}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(n){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=n}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(n,e){return this.textureGenerator.generateTexture(n,e)}};let Renderer=_Renderer;Renderer.extension={type:ExtensionType.Renderer,priority:1};Renderer.__plugins={};Renderer.__systems={};extensions$1.handleByMap(ExtensionType.RendererPlugin,Renderer.__plugins);extensions$1.handleByMap(ExtensionType.RendererSystem,Renderer.__systems);extensions$1.add(Renderer);class AbstractMultiResource extends Resource{constructor(e,t){const{width:s,height:r}=t||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let o=0;o<e;o++){const h=new BaseTexture;this.items.push(h),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let s=0;s<this.length;s++)e[s]&&(e[s].castToBaseTexture?this.addBaseTextureAt(e[s].castToBaseTexture(),s):e[s]instanceof Resource?this.addResourceAt(e[s],s):this.addResourceAt(autoDetectResource(e[s],t),s))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const t=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(t).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class ArrayResource extends AbstractMultiResource{constructor(e,t){const{width:s,height:r}=t||{};let o,h;Array.isArray(e)?(o=e,h=e.length):h=e,super(h,{width:s,height:r}),o&&this.initFromArray(o,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=TARGETS.TEXTURE_2D_ARRAY}upload(e,t,s){const{length:r,itemDirtyIds:o,items:h}=this,{gl:c}=e;s.dirtyId<0&&c.texImage3D(c.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,t.format,s.type,null);for(let a=0;a<r;a++){const u=h[a];o[a]<u.dirtyId&&(o[a]=u.dirtyId,u.valid&&c.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,a,u.resource.width,u.resource.height,1,t.format,s.type,u.resource.source))}return!0}}class CanvasResource extends BaseImageResource{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const _CubeResource=class extends AbstractMultiResource{constructor(n,e){const{width:t,height:s,autoLoad:r,linkBaseTexture:o}=e||{};if(n&&n.length!==_CubeResource.SIDES)throw new Error(`Invalid length. Got ${n.length}, expected 6`);super(6,{width:t,height:s});for(let h=0;h<_CubeResource.SIDES;h++)this.items[h].target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=o!==!1,n&&this.initFromArray(n,e),r!==!1&&this.load()}bind(n){super.bind(n),n.target=TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(n,e,t){if(t===void 0&&(t=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||n.parentTextureArray||Object.keys(n._glTextures).length>0)if(n.resource)this.addResourceAt(n.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else n.target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+e,n.parentTextureArray=this.baseTexture,this.items[e]=n;return n.valid&&!this.valid&&this.resize(n.realWidth,n.realHeight),this.items[e]=n,this}upload(n,e,t){const s=this.itemDirtyIds;for(let r=0;r<_CubeResource.SIDES;r++){const o=this.items[r];(s[r]<o.dirtyId||t.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(n,o,t),s[r]=o.dirtyId):s[r]<-1&&(n.gl.texImage2D(o.target,0,t.internalFormat,e.realWidth,e.realHeight,0,e.format,t.type,null),s[r]=-1))}return!0}static test(n){return Array.isArray(n)&&n.length===_CubeResource.SIDES}};let CubeResource=_CubeResource;CubeResource.SIDES=6;class ImageBitmapResource extends BaseImageResource{constructor(e,t){t=t||{};let s,r;typeof e=="string"?(s=ImageBitmapResource.EMPTY,r=e):(s=e,r=null),super(s),this.url=r,this.crossOrigin=t.crossOrigin??!0,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{const s=await settings$1.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const o=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),e(this)}catch(s){if(this.destroyed)return;t(s),this.onError.emit(s)}}),this._load)}upload(e,t,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),super.upload(e,t,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??settings$1.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}}const _SVGResource=class extends BaseImageResource{constructor(n,e){e=e||{},super(settings$1.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=n,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(n=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),n(this)},_SVGResource.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const n=new Image;BaseImageResource.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=e=>{this._resolve&&(n.onerror=null,this.onError.emit(e))},n.onload=()=>{if(!this._resolve)return;const e=n.width,t=n.height;if(!e||!t)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,r=t*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/t*e,r=this._overrideHeight||this._overrideWidth/e*t),s=Math.round(s),r=Math.round(r);const o=this.source;o.width=s,o.height=r,o._pixiId=`canvas_${uid()}`,o.getContext("2d").drawImage(n,0,0,e,t,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(n){const e=_SVGResource.SVG_SIZE.exec(n),t={};return e&&(t[e[1]]=Math.round(parseFloat(e[3])),t[e[5]]=Math.round(parseFloat(e[7]))),t}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(n,e){return e==="svg"||typeof n=="string"&&n.startsWith("data:image/svg+xml")||typeof n=="string"&&_SVGResource.SVG_XML.test(n)}};let SVGResource=_SVGResource;SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const _VideoResource=class extends BaseImageResource{constructor(n,e){if(e=e||{},!(n instanceof HTMLVideoElement)){const t=document.createElement("video");t.setAttribute("preload","auto"),t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline",""),typeof n=="string"&&(n=[n]);const s=n[0].src||n[0];BaseImageResource.crossOrigin(t,s,e.crossorigin);for(let r=0;r<n.length;++r){const o=document.createElement("source");let{src:h,mime:c}=n[r];h=h||n[r];const a=h.split("?").shift().toLowerCase(),u=a.slice(a.lastIndexOf(".")+1);c=c||_VideoResource.MIME_TYPES[u]||`video/${u}`,o.src=h,o.type=c,t.appendChild(o)}n=t}super(n),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),e.autoLoad!==!1&&this.load()}update(n=0){if(!this.destroyed){const e=Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const n=this.source;return(n.readyState===n.HAVE_ENOUGH_DATA||n.readyState===n.HAVE_FUTURE_DATA)&&n.width&&n.height&&(n.complete=!0),n.addEventListener("play",this._onPlayStart.bind(this)),n.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(n.addEventListener("canplay",this._onCanPlay),n.addEventListener("canplaythrough",this._onCanPlay),n.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,n.load())}),this._load}_onError(n){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(n)}_isSourcePlaying(){const n=this.source;return!n.paused&&!n.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const n=this.source;n.removeEventListener("canplay",this._onCanPlay),n.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(n.videoWidth,n.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&n.play()}dispose(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1);const n=this.source;n&&(n.removeEventListener("error",this._onError,!0),n.pause(),n.src="",n.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(n){n!==this._autoUpdate&&(this._autoUpdate=n,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(n){n!==this._updateFPS&&(this._updateFPS=n)}static test(n,e){return globalThis.HTMLVideoElement&&n instanceof HTMLVideoElement||_VideoResource.TYPES.includes(e)}};let VideoResource=_VideoResource;VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};INSTALLED.push(ImageBitmapResource,ImageResource,CanvasResource,VideoResource,SVGResource,BufferResource,CubeResource,ArrayResource);function filterFromString(n){switch(n.toLowerCase()){case"nearest":return TextureFilter.Nearest;case"linear":return TextureFilter.Linear;case"mipmap":return TextureFilter.MipMap;case"mipmapnearestnearest":return TextureFilter.MipMapNearestNearest;case"mipmaplinearnearest":return TextureFilter.MipMapLinearNearest;case"mipmapnearestlinear":return TextureFilter.MipMapNearestLinear;case"mipmaplinearlinear":return TextureFilter.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${n}`)}}var TextureFilter=(n=>(n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",n))(TextureFilter||{}),TextureWrap=(n=>(n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat",n))(TextureWrap||{});class TextureRegion{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const e=this.texture;return e.trim?e.trim.width:e.orig.width}get height(){const e=this.texture;return e.trim?e.trim.height:e.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const e=this.texture;return e.trim?e.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const e=this.texture;return e.trim?e.trim.y:0}get spineOffsetY(){const e=this.texture;return this.originalHeight-this.height-(e.trim?e.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class RegionFields{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class TextureAtlas{constructor(e,t,s){this.pages=new Array,this.regions=new Array,e&&this.addSpineAtlas(e,t,s)}addTexture(e,t){const s=this.pages;let r=null;for(let h=0;h<s.length;h++)if(s[h].baseTexture===t.baseTexture){r=s[h];break}if(r===null){r=new TextureAtlasPage,r.name="texturePage";const h=t.baseTexture;r.width=h.realWidth,r.height=h.realHeight,r.baseTexture=h,r.minFilter=r.magFilter=TextureFilter.Nearest,r.uWrap=TextureWrap.ClampToEdge,r.vWrap=TextureWrap.ClampToEdge,s.push(r)}const o=new TextureAtlasRegion;return o.name=e,o.page=r,o.texture=t,o.index=-1,this.regions.push(o),o}addTextureHash(e,t){for(const s in e)e.hasOwnProperty(s)&&this.addTexture(t&&s.indexOf(".")!==-1?s.substr(0,s.lastIndexOf(".")):s,e[s])}addSpineAtlas(e,t,s){return this.load(e,t,s)}load(e,t,s){if(t==null)throw new Error("textureLoader cannot be null.");const r=new TextureAtlasReader(e),o=new Array(4);let h=null;const c={};let a=null;c.size=()=>{h.width=parseInt(o[1]),h.height=parseInt(o[2])},c.format=()=>{},c.filter=()=>{h.minFilter=filterFromString(o[1]),h.magFilter=filterFromString(o[2])},c.repeat=()=>{o[1].indexOf("x")!=-1&&(h.uWrap=TextureWrap.Repeat),o[1].indexOf("y")!=-1&&(h.vWrap=TextureWrap.Repeat)},c.pma=()=>{h.pma=o[1]=="true"};const u={};u.xy=()=>{a.x=parseInt(o[1]),a.y=parseInt(o[2])},u.size=()=>{a.width=parseInt(o[1]),a.height=parseInt(o[2])},u.bounds=()=>{a.x=parseInt(o[1]),a.y=parseInt(o[2]),a.width=parseInt(o[3]),a.height=parseInt(o[4])},u.offset=()=>{a.offsetX=parseInt(o[1]),a.offsetY=parseInt(o[2])},u.orig=()=>{a.originalWidth=parseInt(o[1]),a.originalHeight=parseInt(o[2])},u.offsets=()=>{a.offsetX=parseInt(o[1]),a.offsetY=parseInt(o[2]),a.originalWidth=parseInt(o[3]),a.originalHeight=parseInt(o[4])},u.rotate=()=>{const m=o[1];let g=0;m.toLocaleLowerCase()=="true"?g=6:m.toLocaleLowerCase()=="false"?g=0:g=(720-parseFloat(m))%360/45,a.rotate=g},u.index=()=>{a.index=parseInt(o[1])};let d=r.readLine();for(;d!=null&&d.trim().length==0;)d=r.readLine();for(;!(d==null||d.trim().length==0||r.readEntry(o,d)==0);)d=r.readLine();const p=()=>{for(;;){if(d==null)return s&&s(this);if(d.trim().length==0)h=null,d=r.readLine();else if(h===null){for(h=new TextureAtlasPage,h.name=d.trim();r.readEntry(o,d=r.readLine())!=0;){const m=c[o[0]];m&&m()}this.pages.push(h),t(h.name,m=>{if(m===null)return this.pages.splice(this.pages.indexOf(h),1),s&&s(null);h.baseTexture=m,h.pma&&(m.alphaMode=ALPHA_MODES.PMA),m.valid||m.setSize(h.width,h.height),h.setFilters(),(!h.width||!h.height)&&(h.width=m.realWidth,h.height=m.realHeight,(!h.width||!h.height)&&console.log(`ERROR spine atlas page ${h.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),p()});break}else{a=new RegionFields;const m=new TextureAtlasRegion;m.name=d,m.page=h;let g=null,_=null;for(;;){const U=r.readEntry(o,d=r.readLine());if(U==0)break;const ee=u[o[0]];if(ee)ee();else{g==null&&(g=[],_=[]),g.push(o[0]);const ie=[];for(let se=0;se<U;se++)ie.push(parseInt(o[se+1]));_.push(ie)}}a.originalWidth==0&&a.originalHeight==0&&(a.originalWidth=a.width,a.originalHeight=a.height);const y=h.baseTexture.resolution;a.x/=y,a.y/=y,a.width/=y,a.height/=y,a.originalWidth/=y,a.originalHeight/=y,a.offsetX/=y,a.offsetY/=y;const v=a.rotate%4!==0,N=new Rectangle(a.x,a.y,v?a.height:a.width,v?a.width:a.height),w=new Rectangle(0,0,a.originalWidth,a.originalHeight),k=new Rectangle(a.offsetX,a.originalHeight-a.height-a.offsetY,a.width,a.height);m.texture=new Texture(m.page.baseTexture,N,w,k,a.rotate),m.index=a.index,m.texture.updateUvs(),this.regions.push(m)}}};p()}findRegion(e){for(let t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null}dispose(){for(let e=0;e<this.pages.length;e++)this.pages[e].baseTexture.dispose()}}class TextureAtlasReader{constructor(e){this.index=0,this.lines=e.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(e,t){if(t==null||(t=t.trim(),t.length==0))return 0;const s=t.indexOf(":");if(s==-1)return 0;e[0]=t.substr(0,s).trim();for(let r=1,o=s+1;;r++){const h=t.indexOf(",",o);if(h==-1)return e[r]=t.substr(o).trim(),r;if(e[r]=t.substr(o,h-o).trim(),o=h+1,r==4)return 4}}}class TextureAtlasPage{constructor(){this.minFilter=TextureFilter.Nearest,this.magFilter=TextureFilter.Nearest,this.uWrap=TextureWrap.ClampToEdge,this.vWrap=TextureWrap.ClampToEdge}setFilters(){const e=this.baseTexture,t=this.minFilter;t==TextureFilter.Linear?e.scaleMode=SCALE_MODES.LINEAR:this.minFilter==TextureFilter.Nearest?e.scaleMode=SCALE_MODES.NEAREST:(e.mipmap=MIPMAP_MODES.POW2,t==TextureFilter.MipMapNearestNearest?e.scaleMode=SCALE_MODES.NEAREST:e.scaleMode=SCALE_MODES.LINEAR)}}class TextureAtlasRegion extends TextureRegion{}class StringSet{constructor(){this.entries={},this.size=0}add(e){const t=this.entries[e];return this.entries[e]=!0,t?!1:(this.size++,!0)}addAll(e){const t=this.size;for(let s=0,r=e.length;s<r;s++)this.add(e[s]);return t!=this.size}contains(e){return this.entries[e]}clear(){this.entries={},this.size=0}}const _Color=class{constructor(n=0,e=0,t=0,s=0){this.r=n,this.g=e,this.b=t,this.a=s}set(n,e,t,s){return this.r=n,this.g=e,this.b=t,this.a=s,this.clamp()}setFromColor(n){return this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this}setFromString(n){return n=n.charAt(0)=="#"?n.substr(1):n,this.r=parseInt(n.substr(0,2),16)/255,this.g=parseInt(n.substr(2,2),16)/255,this.b=parseInt(n.substr(4,2),16)/255,this.a=n.length!=8?1:parseInt(n.substr(6,2),16)/255,this}add(n,e,t,s){return this.r+=n,this.g+=e,this.b+=t,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(n,e){n.r=((e&4278190080)>>>24)/255,n.g=((e&16711680)>>>16)/255,n.b=((e&65280)>>>8)/255,n.a=(e&255)/255}static rgb888ToColor(n,e){n.r=((e&16711680)>>>16)/255,n.g=((e&65280)>>>8)/255,n.b=(e&255)/255}static fromString(n){return new _Color().setFromString(n)}};let Color=_Color;Color.WHITE=new _Color(1,1,1,1);Color.RED=new _Color(1,0,0,1);Color.GREEN=new _Color(0,1,0,1);Color.BLUE=new _Color(0,0,1,1);Color.MAGENTA=new _Color(1,0,1,1);const _MathUtils=class{static clamp(n,e,t){return n<e?e:n>t?t:n}static cosDeg(n){return Math.cos(n*_MathUtils.degRad)}static sinDeg(n){return Math.sin(n*_MathUtils.degRad)}static signum(n){return Math.sign(n)}static toInt(n){return n>0?Math.floor(n):Math.ceil(n)}static cbrt(n){const e=Math.pow(Math.abs(n),.3333333333333333);return n<0?-e:e}static randomTriangular(n,e){return _MathUtils.randomTriangularWith(n,e,(n+e)*.5)}static randomTriangularWith(n,e,t){const s=Math.random(),r=e-n;return s<=(t-n)/r?n+Math.sqrt(s*r*(t-n)):e-Math.sqrt((1-s)*r*(e-t))}static isPowerOfTwo(n){return n&&(n&n-1)===0}};let MathUtils=_MathUtils;MathUtils.PI=3.1415927;MathUtils.PI2=_MathUtils.PI*2;MathUtils.radiansToDegrees=180/_MathUtils.PI;MathUtils.radDeg=_MathUtils.radiansToDegrees;MathUtils.degreesToRadians=_MathUtils.PI/180;MathUtils.degRad=_MathUtils.degreesToRadians;let Interpolation$1=class{apply(e,t,s){return e+(t-e)*this.applyInternal(s)}};class Pow extends Interpolation$1{constructor(e){super(),this.power=2,this.power=e}applyInternal(e){return e<=.5?Math.pow(e*2,this.power)/2:Math.pow((e-1)*2,this.power)/(this.power%2==0?-2:2)+1}}class PowOut extends Pow{applyInternal(e){return Math.pow(e-1,this.power)*(this.power%2==0?-1:1)+1}}const _Utils=class{static arrayCopy(n,e,t,s,r){for(let o=e,h=s;o<e+r;o++,h++)t[h]=n[o]}static arrayFill(n,e,t,s){for(let r=e;r<t;r++)n[r]=s}static setArraySize(n,e,t=0){const s=n.length;if(s==e)return n;if(n.length=e,s<e)for(let r=s;r<e;r++)n[r]=t;return n}static ensureArrayCapacity(n,e,t=0){return n.length>=e?n:_Utils.setArraySize(n,e,t)}static newArray(n,e){const t=new Array(n);for(let s=0;s<n;s++)t[s]=e;return t}static newFloatArray(n){if(_Utils.SUPPORTS_TYPED_ARRAYS)return new Float32Array(n);const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=0;return e}static newShortArray(n){if(_Utils.SUPPORTS_TYPED_ARRAYS)return new Int16Array(n);const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=0;return e}static toFloatArray(n){return _Utils.SUPPORTS_TYPED_ARRAYS?new Float32Array(n):n}static toSinglePrecision(n){return _Utils.SUPPORTS_TYPED_ARRAYS?Math.fround(n):n}static webkit602BugfixHelper(n,e){}static contains(n,e,t=!0){for(let s=0;s<n.length;s++)if(n[s]==e)return!0;return!1}static enumValue(n,e){return n[e[0].toUpperCase()+e.slice(1)]}};let Utils=_Utils;Utils.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";const settings={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0};class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:(e=e||new Rectangle(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:s,b:r,c:o,d:h,tx:c,ty:a}=e,u=s*t.x+o*t.y+c,d=r*t.x+h*t.y+a;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(e){let t=this.minX,s=this.minY,r=this.maxX,o=this.maxY,h=e[0],c=e[1];t=h<t?h:t,s=c<s?c:s,r=h>r?h:r,o=c>o?c:o,h=e[2],c=e[3],t=h<t?h:t,s=c<s?c:s,r=h>r?h:r,o=c>o?c:o,h=e[4],c=e[5],t=h<t?h:t,s=c<s?c:s,r=h>r?h:r,o=c>o?c:o,h=e[6],c=e[7],t=h<t?h:t,s=c<s?c:s,r=h>r?h:r,o=c>o?c:o,this.minX=t,this.minY=s,this.maxX=r,this.maxY=o}addFrame(e,t,s,r,o){this.addFrameMatrix(e.worldTransform,t,s,r,o)}addFrameMatrix(e,t,s,r,o){const h=e.a,c=e.b,a=e.c,u=e.d,d=e.tx,p=e.ty;let m=this.minX,g=this.minY,_=this.maxX,y=this.maxY,v=h*t+a*s+d,N=c*t+u*s+p;m=v<m?v:m,g=N<g?N:g,_=v>_?v:_,y=N>y?N:y,v=h*r+a*s+d,N=c*r+u*s+p,m=v<m?v:m,g=N<g?N:g,_=v>_?v:_,y=N>y?N:y,v=h*t+a*o+d,N=c*t+u*o+p,m=v<m?v:m,g=N<g?N:g,_=v>_?v:_,y=N>y?N:y,v=h*r+a*o+d,N=c*r+u*o+p,m=v<m?v:m,g=N<g?N:g,_=v>_?v:_,y=N>y?N:y,this.minX=m,this.minY=g,this.maxX=_,this.maxY=y}addVertexData(e,t,s){let r=this.minX,o=this.minY,h=this.maxX,c=this.maxY;for(let a=t;a<s;a+=2){const u=e[a],d=e[a+1];r=u<r?u:r,o=d<o?d:o,h=u>h?u:h,c=d>c?d:c}this.minX=r,this.minY=o,this.maxX=h,this.maxY=c}addVertices(e,t,s,r){this.addVerticesMatrix(e.worldTransform,t,s,r)}addVerticesMatrix(e,t,s,r,o=0,h=o){const c=e.a,a=e.b,u=e.c,d=e.d,p=e.tx,m=e.ty;let g=this.minX,_=this.minY,y=this.maxX,v=this.maxY;for(let N=s;N<r;N+=2){const w=t[N],k=t[N+1],U=c*w+u*k+p,ee=d*k+a*w+m;g=Math.min(g,U-o),y=Math.max(y,U+o),_=Math.min(_,ee-h),v=Math.max(v,ee+h)}this.minX=g,this.minY=_,this.maxX=y,this.maxY=v}addBounds(e){const t=this.minX,s=this.minY,r=this.maxX,o=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<s?e.minY:s,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>o?e.maxY:o}addBoundsMask(e,t){const s=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,o=e.maxX<t.maxX?e.maxX:t.maxX,h=e.maxY<t.maxY?e.maxY:t.maxY;if(s<=o&&r<=h){const c=this.minX,a=this.minY,u=this.maxX,d=this.maxY;this.minX=s<c?s:c,this.minY=r<a?r:a,this.maxX=o>u?o:u,this.maxY=h>d?h:d}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const s=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,o=e.maxX<t.x+t.width?e.maxX:t.x+t.width,h=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(s<=o&&r<=h){const c=this.minX,a=this.minY,u=this.maxX,d=this.maxY;this.minX=s<c?s:c,this.minY=r<a?r:a,this.maxX=o>u?o:u,this.maxY=h>d?h:d}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,s,r,o,h){e-=o,t-=h,s+=o,r+=h,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}}class DisplayObject extends eventemitter3Exports{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let s=0;s<t.length;++s){const r=t[s];Object.defineProperty(DisplayObject.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Rectangle),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);const t=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const h=this.getBounds(!1,e);return this.parent=s,this.transform=t,this._bounds=r,this._bounds.updateID+=this._boundsID-o,h}toGlobal(e,t,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,s,r){return t&&(e=t.toGlobal(e,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,s)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,t=0,s=1,r=1,o=0,h=0,c=0,a=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=s||1,this.scale.y=r||1,this.rotation=o,this.skew.x=h,this.skew.y=c,this.pivot.x=a,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*RAD_TO_DEG}set angle(e){this.transform.rotation=e*DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,t._maskRefCount===0&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount===0&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;const tempMatrix=new Matrix;function sortChildren(n,e){return n.zIndex===e.zIndex?n._lastSortedIndex-e._lastSortedIndex:n.zIndex-e.zIndex}const _Container=class extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=_Container.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(n){}addChild(...n){if(n.length>1)for(let e=0;e<n.length;e++)this.addChild(n[e]);else{const e=n[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return n[0]}addChildAt(n,e){if(e<0||e>this.children.length)throw new Error(`${n}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.splice(e,0,n),this._boundsID++,this.onChildrenChange(e),n.emit("added",this),this.emit("childAdded",n,this,e),n}swapChildren(n,e){if(n===e)return;const t=this.getChildIndex(n),s=this.getChildIndex(e);this.children[t]=e,this.children[s]=n,this.onChildrenChange(t<s?t:s)}getChildIndex(n){const e=this.children.indexOf(n);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(n,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const t=this.getChildIndex(n);removeItems(this.children,t,1),this.children.splice(e,0,n),this.onChildrenChange(e)}getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]}removeChild(...n){if(n.length>1)for(let e=0;e<n.length;e++)this.removeChild(n[e]);else{const e=n[0],t=this.children.indexOf(e);if(t===-1)return null;e.parent=null,e.transform._parentID=-1,removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t)}return n[0]}removeChildAt(n){const e=this.getChildAt(n);return e.parent=null,e.transform._parentID=-1,removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n),e}removeChildren(n=0,e=this.children.length){const t=n,s=e,r=s-t;let o;if(r>0&&r<=s){o=this.children.splice(t,r);for(let h=0;h<o.length;++h)o[h].parent=null,o[h].transform&&(o[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(n);for(let h=0;h<o.length;++h)o[h].emit("removed",this),this.emit("childRemoved",o[h],this,h);return o}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let n=!1;for(let e=0,t=this.children.length;e<t;++e){const s=this.children[e];s._lastSortedIndex=e,!n&&s.zIndex!==0&&(n=!0)}n&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let n=0,e=this.children.length;n<e;++n){const t=this.children[n];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let n=0;n<this.children.length;n++){const e=this.children[n];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(n,e=!1){const t=super.getLocalBounds(n);if(!e)for(let s=0,r=this.children.length;s<r;++s){const o=this.children[s];o.visible&&o.updateTransform()}return t}_calculateBounds(){}_renderWithCulling(n){const e=n.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let t,s;this.cullArea?(t=this.cullArea,s=this.worldTransform):this._render!==_Container.prototype._render&&(t=this.getBounds(!0));const r=n.projection.transform;if(r&&(s?(s=tempMatrix.copyFrom(s),s.prepend(r)):s=r),t&&e.intersects(t,s))this._render(n);else if(this.cullArea)return;for(let o=0,h=this.children.length;o<h;++o){const c=this.children[o],a=c.cullable;c.cullable=a||!this.cullArea,c.render(n),c.cullable=a}}render(n){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(n);else if(this.cullable)this._renderWithCulling(n);else{this._render(n);for(let t=0,s=this.children.length;t<s;++t)this.children[t].render(n)}}renderAdvanced(n){var r,o,h;const e=this.filters,t=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let c=0;c<e.length;c++)e[c].enabled&&this._enabledFilters.push(e[c])}const s=e&&((r=this._enabledFilters)==null?void 0:r.length)||t&&(!t.isMaskData||t.enabled&&(t.autoDetect||t.type!==MASK_TYPES.NONE));if(s&&n.batch.flush(),e&&((o=this._enabledFilters)!=null&&o.length)&&n.filter.push(this,this._enabledFilters),t&&n.mask.push(this,this._mask),this.cullable)this._renderWithCulling(n);else{this._render(n);for(let c=0,a=this.children.length;c<a;++c)this.children[c].render(n)}s&&n.batch.flush(),t&&n.mask.pop(this),e&&((h=this._enabledFilters)!=null&&h.length)&&n.filter.pop()}_render(n){}destroy(n){super.destroy(),this.sortDirty=!1;const e=typeof n=="boolean"?n:n==null?void 0:n.children,t=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<t.length;++s)t[s].destroy(n)}get width(){return this.scale.x*this.getLocalBounds().width}set width(n){const e=this.getLocalBounds().width;e!==0?this.scale.x=n/e:this.scale.x=1,this._width=n}get height(){return this.scale.y*this.getLocalBounds().height}set height(n){const e=this.getLocalBounds().height;e!==0?this.scale.y=n/e:this.scale.y=1,this._height=n}};let Container=_Container;Container.defaultSortableChildren=!1;Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;Object.defineProperties(settings$1,{SORTABLE_CHILDREN:{get(){return Container.defaultSortableChildren},set(n){deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Container.defaultSortableChildren=n}}});const tempPoint$1=new Point,indices=new Uint16Array([0,1,2,0,2,3]);class Sprite extends Container{constructor(e){super(),this._anchor=new ObservablePoint(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=indices,this.pluginName="batch",this.isSprite=!0,this._roundPixels=settings$1.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,s=t.a,r=t.b,o=t.c,h=t.d,c=t.tx,a=t.ty,u=this.vertexData,d=e.trim,p=e.orig,m=this._anchor;let g=0,_=0,y=0,v=0;if(d?(_=d.x-m._x*p.width,g=_+d.width,v=d.y-m._y*p.height,y=v+d.height):(_=-m._x*p.width,g=_+p.width,v=-m._y*p.height,y=v+p.height),u[0]=s*_+o*v+c,u[1]=h*v+r*_+a,u[2]=s*g+o*v+c,u[3]=h*v+r*g+a,u[4]=s*g+o*y+c,u[5]=h*y+r*g+a,u[6]=s*_+o*y+c,u[7]=h*y+r*_+a,this._roundPixels){const N=settings$1.RESOLUTION;for(let w=0;w<u.length;++w)u[w]=Math.round(u[w]*N)/N}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,s=e.orig,r=this._anchor,o=this.transform.worldTransform,h=o.a,c=o.b,a=o.c,u=o.d,d=o.tx,p=o.ty,m=-r._x*s.width,g=m+s.width,_=-r._y*s.height,y=_+s.height;t[0]=h*m+a*_+d,t[1]=u*_+c*m+p,t[2]=h*g+a*_+d,t[3]=u*_+c*g+p,t[4]=h*g+a*y+d,t[5]=u*y+c*g+p,t[6]=h*m+a*y+d,t[7]=u*y+c*m+p}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,tempPoint$1);const t=this._texture.orig.width,s=this._texture.orig.height,r=-t*this.anchor.x;let o=0;return tempPoint$1.x>=r&&tempPoint$1.x<r+t&&(o=-s*this.anchor.y,tempPoint$1.y>=o&&tempPoint$1.y<o+s)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const s=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(e,t){const s=e instanceof Texture?e:Texture.from(e,t);return new Sprite(s)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tint}set tint(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}class MeshBatchUvs{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const tempPoint=new Point,tempPolygon=new Polygon,_Mesh=class extends Container{constructor(n,e,t,s=DRAW_MODES.TRIANGLES){super(),this.geometry=n,this.shader=e,this.state=t||State$1.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=settings$1.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(n){this._geometry!==n&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=n,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(n){this.shader=n}get material(){return this.shader}set blendMode(n){this.state.blendMode=n}get blendMode(){return this.state.blendMode}set roundPixels(n){this._roundPixels!==n&&(this._transformID=-1),this._roundPixels=n}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(n){this.shader.tint=n}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(n){this.shader.texture=n}_render(n){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES.TRIANGLES&&e.length<_Mesh.BATCHABLE_SIZE*2?this._renderToBatch(n):this._renderDefault(n)}_renderDefault(n){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),n.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),n.shader.bind(e),n.state.set(this.state),n.geometry.bind(this.geometry,e),n.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(n){const e=this.geometry,t=this.shader;t.uvMatrix&&(t.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=t._tintRGB,this._texture=t.texture;const s=this.material.pluginName;n.batch.setObjectRenderer(n.plugins[s]),n.plugins[s].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,s=e._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const r=this.transform.worldTransform,o=r.a,h=r.b,c=r.c,a=r.d,u=r.tx,d=r.ty,p=this.vertexData;for(let m=0;m<p.length/2;m++){const g=t[m*2],_=t[m*2+1];p[m*2]=o*g+c*_+u,p[m*2+1]=h*g+a*_+d}if(this._roundPixels){const m=settings$1.RESOLUTION;for(let g=0;g<p.length;++g)p[g]=Math.round(p[g]*m)/m}this.vertexDirty=s}calculateUvs(){const n=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=n.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(n,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(n){if(!this.getBounds().contains(n.x,n.y))return!1;this.worldTransform.applyInverse(n,tempPoint);const e=this.geometry.getBuffer("aVertexPosition").data,t=tempPolygon.points,s=this.geometry.getIndex().data,r=s.length,o=this.drawMode===4?3:1;for(let h=0;h+2<r;h+=o){const c=s[h]*2,a=s[h+1]*2,u=s[h+2]*2;if(t[0]=e[c],t[1]=e[c+1],t[2]=e[a],t[3]=e[a+1],t[4]=e[u],t[5]=e[u+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}return!1}destroy(n){super.destroy(n),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Mesh=_Mesh;Mesh.BATCHABLE_SIZE=100;class MeshGeometry extends Geometry{constructor(e,t,s){super();const r=new Buffer(e),o=new Buffer(t,!0),h=new Buffer(s,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",o,2,!1,TYPES.FLOAT).addIndex(h),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fragment$6=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class MeshMaterial extends Shader{constructor(e,t){const s={uSampler:e,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t),t.uniforms&&Object.assign(s,t.uniforms),super(t.program||Program.from(vertex$3,fragment$6),s),this._colorDirty=!1,this.uvMatrix=new TextureMatrix(e),this.batchable=t.program===void 0,this.pluginName=t.pluginName,this.tint=t.tint,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture;premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class PlaneGeometry extends MeshGeometry{constructor(e=100,t=100,s=10,r=10){super(),this.segWidth=s,this.segHeight=r,this.width=e,this.height=t,this.build()}build(){const e=this.segWidth*this.segHeight,t=[],s=[],r=[],o=this.segWidth-1,h=this.segHeight-1,c=this.width/o,a=this.height/h;for(let d=0;d<e;d++){const p=d%this.segWidth,m=d/this.segWidth|0;t.push(p*c,m*a),s.push(p/o,m/h)}const u=o*h;for(let d=0;d<u;d++){const p=d%o,m=d/o|0,g=m*this.segWidth+p,_=m*this.segWidth+p+1,y=(m+1)*this.segWidth+p,v=(m+1)*this.segWidth+p+1;r.push(g,_,y,_,v,y)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class SimplePlane extends Mesh{constructor(e,t,s){const r=new PlaneGeometry(e.width,e.height,t,s),o=new MeshMaterial(Texture.WHITE);super(r,o),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const e=this.geometry,{width:t,height:s}=this.shader.texture;this.autoResize&&(e.width!==t||e.height!==s)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}const DEFAULT_BORDER_SIZE=10;class NineSlicePlane extends SimplePlane{constructor(e,t=DEFAULT_BORDER_SIZE,s=DEFAULT_BORDER_SIZE,r=DEFAULT_BORDER_SIZE,o=DEFAULT_BORDER_SIZE){super(Texture.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t,this._rightWidth=r,this._topHeight=s,this._bottomHeight=o,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){const e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){const e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){const e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,s=this._topHeight+this._bottomHeight,r=this._height>s?1:this._height/s;return Math.min(t,r)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){const e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;const s=1/this._origWidth,r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=s*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-s*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class SimpleMesh extends Mesh{constructor(e=Texture.EMPTY,t,s,r,o){const h=new MeshGeometry(t,s,r);h.getBuffer("aVertexPosition").static=!1;const c=new MeshMaterial(e);super(h,c,null,o),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}const buildCircle={build(n){const e=n.points;let t,s,r,o,h,c;if(n.type===SHAPES.CIRC){const _=n.shape;t=_.x,s=_.y,h=c=_.radius,r=o=0}else if(n.type===SHAPES.ELIP){const _=n.shape;t=_.x,s=_.y,h=_.width,c=_.height,r=o=0}else{const _=n.shape,y=_.width/2,v=_.height/2;t=_.x+y,s=_.y+v,h=c=Math.max(0,Math.min(_.radius,Math.min(y,v))),r=y-h,o=v-c}if(!(h>=0&&c>=0&&r>=0&&o>=0)){e.length=0;return}const a=Math.ceil(2.3*Math.sqrt(h+c)),u=a*8+(r?4:0)+(o?4:0);if(e.length=u,u===0)return;if(a===0){e.length=8,e[0]=e[6]=t+r,e[1]=e[3]=s+o,e[2]=e[4]=t-r,e[5]=e[7]=s-o;return}let d=0,p=a*4+(r?2:0)+2,m=p,g=u;{const _=r+h,y=o,v=t+_,N=t-_,w=s+y;if(e[d++]=v,e[d++]=w,e[--p]=w,e[--p]=N,o){const k=s-y;e[m++]=N,e[m++]=k,e[--g]=k,e[--g]=v}}for(let _=1;_<a;_++){const y=Math.PI/2*(_/a),v=r+Math.cos(y)*h,N=o+Math.sin(y)*c,w=t+v,k=t-v,U=s+N,ee=s-N;e[d++]=w,e[d++]=U,e[--p]=U,e[--p]=k,e[m++]=k,e[m++]=ee,e[--g]=ee,e[--g]=w}{const _=r,y=o+c,v=t+_,N=t-_,w=s+y,k=s-y;e[d++]=v,e[d++]=w,e[--g]=k,e[--g]=v,r&&(e[d++]=N,e[d++]=w,e[--g]=k,e[--g]=N)}},triangulate(n,e){const t=n.points,s=e.points,r=e.indices;if(t.length===0)return;let o=s.length/2;const h=o;let c,a;if(n.type!==SHAPES.RREC){const d=n.shape;c=d.x,a=d.y}else{const d=n.shape;c=d.x+d.width/2,a=d.y+d.height/2}const u=n.matrix;s.push(n.matrix?u.a*c+u.c*a+u.tx:c,n.matrix?u.b*c+u.d*a+u.ty:a),o++,s.push(t[0],t[1]);for(let d=2;d<t.length;d+=2)s.push(t[d],t[d+1]),r.push(o++,h,o);r.push(h+1,h,o)}};function fixOrientation(n,e=!1){const t=n.length;if(t<6)return;let s=0;for(let r=0,o=n[t-2],h=n[t-1];r<t;r+=2){const c=n[r],a=n[r+1];s+=(c-o)*(a+h),o=c,h=a}if(!e&&s>0||e&&s<=0){const r=t/2;for(let o=r+r%2;o<t;o+=2){const h=t-o-2,c=t-o-1,a=o,u=o+1;[n[h],n[a]]=[n[a],n[h]],[n[c],n[u]]=[n[u],n[c]]}}}const buildPoly={build(n){n.points=n.shape.points.slice()},triangulate(n,e){let t=n.points;const s=n.holes,r=e.points,o=e.indices;if(t.length>=6){fixOrientation(t,!1);const h=[];for(let u=0;u<s.length;u++){const d=s[u];fixOrientation(d.points,!0),h.push(t.length/2),t=t.concat(d.points)}const c=earcutExports(t,h,2);if(!c)return;const a=r.length/2;for(let u=0;u<c.length;u+=3)o.push(c[u]+a),o.push(c[u+1]+a),o.push(c[u+2]+a);for(let u=0;u<t.length;u++)r.push(t[u])}}},buildRectangle={build(n){const e=n.shape,t=e.x,s=e.y,r=e.width,o=e.height,h=n.points;h.length=0,r>=0&&o>=0&&h.push(t,s,t+r,s,t+r,s+o,t,s+o)},triangulate(n,e){const t=n.points,s=e.points;if(t.length===0)return;const r=s.length/2;s.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},buildRoundedRectangle={build(n){buildCircle.build(n)},triangulate(n,e){buildCircle.triangulate(n,e)}};var LINE_JOIN=(n=>(n.MITER="miter",n.BEVEL="bevel",n.ROUND="round",n))(LINE_JOIN||{}),LINE_CAP=(n=>(n.BUTT="butt",n.ROUND="round",n.SQUARE="square",n))(LINE_CAP||{});const curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,e=20){if(!this.adaptive||!n||isNaN(n))return e;let t=Math.ceil(n/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}};class ArcUtils{static curveTo(e,t,s,r,o,h){const c=h[h.length-2],u=h[h.length-1]-t,d=c-e,p=r-t,m=s-e,g=Math.abs(u*m-d*p);if(g<1e-8||o===0)return(h[h.length-2]!==e||h[h.length-1]!==t)&&h.push(e,t),null;const _=u*u+d*d,y=p*p+m*m,v=u*p+d*m,N=o*Math.sqrt(_)/g,w=o*Math.sqrt(y)/g,k=N*v/_,U=w*v/y,ee=N*m+w*d,ie=N*p+w*u,se=d*(w+k),oe=u*(w+k),le=m*(N+U),ue=p*(N+U),he=Math.atan2(oe-ie,se-ee),pe=Math.atan2(ue-ie,le-ee);return{cx:ee+e,cy:ie+t,radius:o,startAngle:he,endAngle:pe,anticlockwise:d*p>m*u}}static arc(e,t,s,r,o,h,c,a,u){const d=c-h,p=curves._segmentsCount(Math.abs(d)*o,Math.ceil(Math.abs(d)/PI_2)*40),m=d/(p*2),g=m*2,_=Math.cos(m),y=Math.sin(m),v=p-1,N=v%1/v;for(let w=0;w<=v;++w){const k=w+N*w,U=m+h+g*k,ee=Math.cos(U),ie=-Math.sin(U);u.push((_*ee+y*ie)*o+s,(_*-ie+y*ee)*o+r)}}}class BatchPart{constructor(){this.reset()}begin(e,t,s){this.reset(),this.style=e,this.start=t,this.attribStart=s}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class BezierUtils{static curveLength(e,t,s,r,o,h,c,a){let d=0,p=0,m=0,g=0,_=0,y=0,v=0,N=0,w=0,k=0,U=0,ee=e,ie=t;for(let se=1;se<=10;++se)p=se/10,m=p*p,g=m*p,_=1-p,y=_*_,v=y*_,N=v*e+3*y*p*s+3*_*m*o+g*c,w=v*t+3*y*p*r+3*_*m*h+g*a,k=ee-N,U=ie-w,ee=N,ie=w,d+=Math.sqrt(k*k+U*U);return d}static curveTo(e,t,s,r,o,h,c){const a=c[c.length-2],u=c[c.length-1];c.length-=2;const d=curves._segmentsCount(BezierUtils.curveLength(a,u,e,t,s,r,o,h));let p=0,m=0,g=0,_=0,y=0;c.push(a,u);for(let v=1,N=0;v<=d;++v)N=v/d,p=1-N,m=p*p,g=m*p,_=N*N,y=_*N,c.push(g*a+3*m*N*e+3*p*_*s+y*o,g*u+3*m*N*t+3*p*_*r+y*h)}}function square(n,e,t,s,r,o,h,c){const a=n-t*r,u=e-s*r,d=n+t*o,p=e+s*o;let m,g;h?(m=s,g=-t):(m=-s,g=t);const _=a+m,y=u+g,v=d+m,N=p+g;return c.push(_,y),c.push(v,N),2}function round(n,e,t,s,r,o,h,c){const a=t-n,u=s-e;let d=Math.atan2(a,u),p=Math.atan2(r-n,o-e);c&&d<p?d+=Math.PI*2:!c&&d>p&&(p+=Math.PI*2);let m=d;const g=p-d,_=Math.abs(g),y=Math.sqrt(a*a+u*u),v=(15*_*Math.sqrt(y)/Math.PI>>0)+1,N=g/v;if(m+=N,c){h.push(n,e),h.push(t,s);for(let w=1,k=m;w<v;w++,k+=N)h.push(n,e),h.push(n+Math.sin(k)*y,e+Math.cos(k)*y);h.push(n,e),h.push(r,o)}else{h.push(t,s),h.push(n,e);for(let w=1,k=m;w<v;w++,k+=N)h.push(n+Math.sin(k)*y,e+Math.cos(k)*y),h.push(n,e);h.push(r,o),h.push(n,e)}return v*2}function buildNonNativeLine(n,e){const t=n.shape;let s=n.points||t.points.slice();const r=e.closePointEps;if(s.length===0)return;const o=n.lineStyle,h=new Point(s[0],s[1]),c=new Point(s[s.length-2],s[s.length-1]),a=t.type!==SHAPES.POLY||t.closeStroke,u=Math.abs(h.x-c.x)<r&&Math.abs(h.y-c.y)<r;if(a){s=s.slice(),u&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const be=(h.x+c.x)*.5,Ae=(c.y+h.y)*.5;s.unshift(be,Ae),s.push(be,Ae)}const d=e.points,p=s.length/2;let m=s.length;const g=d.length/2,_=o.width/2,y=_*_,v=o.miterLimit*o.miterLimit;let N=s[0],w=s[1],k=s[2],U=s[3],ee=0,ie=0,se=-(w-U),oe=N-k,le=0,ue=0,he=Math.sqrt(se*se+oe*oe);se/=he,oe/=he,se*=_,oe*=_;const pe=o.alignment,de=(1-pe)*2,fe=pe*2;a||(o.cap===LINE_CAP.ROUND?m+=round(N-se*(de-fe)*.5,w-oe*(de-fe)*.5,N-se*de,w-oe*de,N+se*fe,w+oe*fe,d,!0)+2:o.cap===LINE_CAP.SQUARE&&(m+=square(N,w,se,oe,de,fe,!0,d))),d.push(N-se*de,w-oe*de),d.push(N+se*fe,w+oe*fe);for(let be=1;be<p-1;++be){N=s[(be-1)*2],w=s[(be-1)*2+1],k=s[be*2],U=s[be*2+1],ee=s[(be+1)*2],ie=s[(be+1)*2+1],se=-(w-U),oe=N-k,he=Math.sqrt(se*se+oe*oe),se/=he,oe/=he,se*=_,oe*=_,le=-(U-ie),ue=k-ee,he=Math.sqrt(le*le+ue*ue),le/=he,ue/=he,le*=_,ue*=_;const Ae=k-N,Pe=w-U,xe=k-ee,Se=ie-U,Me=Ae*xe+Pe*Se,Oe=Pe*xe-Se*Ae,Ie=Oe<0;if(Math.abs(Oe)<.001*Math.abs(Me)){d.push(k-se*de,U-oe*de),d.push(k+se*fe,U+oe*fe),Me>=0&&(o.join===LINE_JOIN.ROUND?m+=round(k,U,k-se*de,U-oe*de,k-le*de,U-ue*de,d,!1)+4:m+=2,d.push(k-le*fe,U-ue*fe),d.push(k+le*de,U+ue*de));continue}const Fe=(-se+N)*(-oe+U)-(-se+k)*(-oe+w),Ne=(-le+ee)*(-ue+U)-(-le+k)*(-ue+ie),Ue=(Ae*Ne-xe*Fe)/Oe,Be=(Se*Fe-Pe*Ne)/Oe,_e=(Ue-k)*(Ue-k)+(Be-U)*(Be-U),ge=k+(Ue-k)*de,ve=U+(Be-U)*de,Ee=k-(Ue-k)*fe,we=U-(Be-U)*fe,Re=Math.min(Ae*Ae+Pe*Pe,xe*xe+Se*Se),Le=Ie?de:fe,Xe=Re+Le*Le*y;_e<=Xe?o.join===LINE_JOIN.BEVEL||_e/y>v?(Ie?(d.push(ge,ve),d.push(k+se*fe,U+oe*fe),d.push(ge,ve),d.push(k+le*fe,U+ue*fe)):(d.push(k-se*de,U-oe*de),d.push(Ee,we),d.push(k-le*de,U-ue*de),d.push(Ee,we)),m+=2):o.join===LINE_JOIN.ROUND?Ie?(d.push(ge,ve),d.push(k+se*fe,U+oe*fe),m+=round(k,U,k+se*fe,U+oe*fe,k+le*fe,U+ue*fe,d,!0)+4,d.push(ge,ve),d.push(k+le*fe,U+ue*fe)):(d.push(k-se*de,U-oe*de),d.push(Ee,we),m+=round(k,U,k-se*de,U-oe*de,k-le*de,U-ue*de,d,!1)+4,d.push(k-le*de,U-ue*de),d.push(Ee,we)):(d.push(ge,ve),d.push(Ee,we)):(d.push(k-se*de,U-oe*de),d.push(k+se*fe,U+oe*fe),o.join===LINE_JOIN.ROUND?Ie?m+=round(k,U,k+se*fe,U+oe*fe,k+le*fe,U+ue*fe,d,!0)+2:m+=round(k,U,k-se*de,U-oe*de,k-le*de,U-ue*de,d,!1)+2:o.join===LINE_JOIN.MITER&&_e/y<=v&&(Ie?(d.push(Ee,we),d.push(Ee,we)):(d.push(ge,ve),d.push(ge,ve)),m+=2),d.push(k-le*de,U-ue*de),d.push(k+le*fe,U+ue*fe),m+=2)}N=s[(p-2)*2],w=s[(p-2)*2+1],k=s[(p-1)*2],U=s[(p-1)*2+1],se=-(w-U),oe=N-k,he=Math.sqrt(se*se+oe*oe),se/=he,oe/=he,se*=_,oe*=_,d.push(k-se*de,U-oe*de),d.push(k+se*fe,U+oe*fe),a||(o.cap===LINE_CAP.ROUND?m+=round(k-se*(de-fe)*.5,U-oe*(de-fe)*.5,k-se*de,U-oe*de,k+se*fe,U+oe*fe,d,!1)+2:o.cap===LINE_CAP.SQUARE&&(m+=square(k,U,se,oe,de,fe,!1,d)));const Te=e.indices,Ce=curves.epsilon*curves.epsilon;for(let be=g;be<m+g-2;++be)N=d[be*2],w=d[be*2+1],k=d[(be+1)*2],U=d[(be+1)*2+1],ee=d[(be+2)*2],ie=d[(be+2)*2+1],!(Math.abs(N*(U-ie)+k*(ie-w)+ee*(w-U))<Ce)&&Te.push(be,be+1,be+2)}function buildNativeLine(n,e){let t=0;const s=n.shape,r=n.points||s.points,o=s.type!==SHAPES.POLY||s.closeStroke;if(r.length===0)return;const h=e.points,c=e.indices,a=r.length/2,u=h.length/2;let d=u;for(h.push(r[0],r[1]),t=1;t<a;t++)h.push(r[t*2],r[t*2+1]),c.push(d,d+1),d++;o&&c.push(d,u)}function buildLine(n,e){n.lineStyle.native?buildNativeLine(n,e):buildNonNativeLine(n,e)}class QuadraticUtils{static curveLength(e,t,s,r,o,h){const c=e-2*s+o,a=t-2*r+h,u=2*s-2*e,d=2*r-2*t,p=4*(c*c+a*a),m=4*(c*u+a*d),g=u*u+d*d,_=2*Math.sqrt(p+m+g),y=Math.sqrt(p),v=2*p*y,N=2*Math.sqrt(g),w=m/y;return(v*_+y*m*(_-N)+(4*g*p-m*m)*Math.log((2*y+w+_)/(w+N)))/(4*v)}static curveTo(e,t,s,r,o){const h=o[o.length-2],c=o[o.length-1],a=curves._segmentsCount(QuadraticUtils.curveLength(h,c,e,t,s,r));let u=0,d=0;for(let p=1;p<=a;++p){const m=p/a;u=h+(e-h)*m,d=c+(t-c)*m,o.push(u+(e+(s-e)*m-u)*m,d+(t+(r-t)*m-d)*m)}}}const FILL_COMMANDS={[SHAPES.POLY]:buildPoly,[SHAPES.CIRC]:buildCircle,[SHAPES.ELIP]:buildCircle,[SHAPES.RECT]:buildRectangle,[SHAPES.RREC]:buildRoundedRectangle},BATCH_POOL=[],DRAW_CALL_POOL=[];class GraphicsData{constructor(e,t=null,s=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=s,this.fillStyle=t,this.matrix=r,this.type=e.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const tmpPoint=new Point,_GraphicsGeometry=class extends BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let n=0;n<this.drawCalls.length;n++)this.drawCalls[n].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[n]);this.drawCalls.length=0;for(let n=0;n<this.batches.length;n++){const e=this.batches[n];e.reset(),BATCH_POOL.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(n,e=null,t=null,s=null){const r=new GraphicsData(n,e,t,s);return this.graphicsData.push(r),this.dirty++,this}drawHole(n,e=null){if(!this.graphicsData.length)return null;const t=new GraphicsData(n,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return t.lineStyle=s.lineStyle,s.holes.push(t),this.dirty++,this}destroy(){super.destroy();for(let n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(n){const e=this.graphicsData;for(let t=0;t<e.length;++t){const s=e[t];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(n,tmpPoint):tmpPoint.copyFrom(n),s.shape.contains(tmpPoint.x,tmpPoint.y))){let r=!1;if(s.holes){for(let o=0;o<s.holes.length;o++)if(s.holes[o].shape.contains(tmpPoint.x,tmpPoint.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const n=this.uvs,e=this.graphicsData;let t=null,s=null;this.batches.length>0&&(t=this.batches[this.batches.length-1],s=t.style);for(let c=this.shapeIndex;c<e.length;c++){this.shapeIndex++;const a=e[c],u=a.fillStyle,d=a.lineStyle;FILL_COMMANDS[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(u.visible||d.visible)&&this.processHoles(a.holes);for(let m=0;m<2;m++){const g=m===0?u:d;if(!g.visible)continue;const _=g.texture.baseTexture,y=this.indices.length,v=this.points.length/2;_.wrapMode=WRAP_MODES.REPEAT,m===0?this.processFill(a):this.processLine(a);const N=this.points.length/2-v;N!==0&&(t&&!this._compareStyles(s,g)&&(t.end(y,v),t=null),t||(t=BATCH_POOL.pop()||new BatchPart,t.begin(g,y,v),this.batches.push(t),s=g),this.addUvs(this.points,n,g.texture,v,N,g.matrix))}}const r=this.indices.length,o=this.points.length/2;if(t&&t.end(r,o),this.batches.length===0){this.batchable=!0;return}const h=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(n,e){return!(!n||!e||n.texture.baseTexture!==e.texture.baseTexture||n.color+n.alpha!==e.color+e.alpha||!!n.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let n=0,e=this.graphicsData.length;n<e;n++){const t=this.graphicsData[n],s=t.fillStyle,r=t.lineStyle;if(s&&!s.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const n=this.batches;for(let e=0,t=n.length;e<t;e++){const s=n[e];for(let r=0;r<s.size;r++){const o=s.start+r;this.indicesUint16[o]=this.indicesUint16[o]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const n=this.batches;for(let e=0;e<n.length;e++)if(n[e].style.native)return!1;return this.points.length<_GraphicsGeometry.BATCHABLE_SIZE*2}buildDrawCalls(){let n=++BaseTexture._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[d]);this.drawCalls.length=0;const e=this.colors,t=this.textureIds;let s=DRAW_CALL_POOL.pop();s||(s=new BatchDrawCall,s.texArray=new BatchTextureArray),s.texArray.count=0,s.start=0,s.size=0,s.type=DRAW_MODES.TRIANGLES;let r=0,o=null,h=0,c=!1,a=DRAW_MODES.TRIANGLES,u=0;this.drawCalls.push(s);for(let d=0;d<this.batches.length;d++){const p=this.batches[d],m=8,g=p.style,_=g.texture.baseTexture;c!==!!g.native&&(c=!!g.native,a=c?DRAW_MODES.LINES:DRAW_MODES.TRIANGLES,o=null,r=m,n++),o!==_&&(o=_,_._batchEnabled!==n&&(r===m&&(n++,r=0,s.size>0&&(s=DRAW_CALL_POOL.pop(),s||(s=new BatchDrawCall,s.texArray=new BatchTextureArray),this.drawCalls.push(s)),s.start=u,s.size=0,s.texArray.count=0,s.type=a),_.touched=1,_._batchEnabled=n,_._batchLocation=r,_.wrapMode=WRAP_MODES.REPEAT,s.texArray.elements[s.texArray.count++]=_,r++)),s.size+=p.size,u+=p.size,h=_._batchLocation,this.addColors(e,g.color,g.alpha,p.attribSize,p.attribStart),this.addTextureIds(t,h,p.attribSize,p.attribStart)}BaseTexture._globalBatch=n,this.packAttributes()}packAttributes(){const n=this.points,e=this.uvs,t=this.colors,s=this.textureIds,r=new ArrayBuffer(n.length*3*4),o=new Float32Array(r),h=new Uint32Array(r);let c=0;for(let a=0;a<n.length/2;a++)o[c++]=n[a*2],o[c++]=n[a*2+1],o[c++]=e[a*2],o[c++]=e[a*2+1],h[c++]=t[a],o[c++]=s[a];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(n){n.holes.length?buildPoly.triangulate(n,this):FILL_COMMANDS[n.type].triangulate(n,this)}processLine(n){buildLine(n,this);for(let e=0;e<n.holes.length;e++)buildLine(n.holes[e],this)}processHoles(n){for(let e=0;e<n.length;e++){const t=n[e];FILL_COMMANDS[t.type].build(t),t.matrix&&this.transformPoints(t.points,t.matrix)}}calculateBounds(){const n=this._bounds;n.clear(),n.addVertexData(this.points,0,this.points.length),n.pad(this.boundsPadding,this.boundsPadding)}transformPoints(n,e){for(let t=0;t<n.length/2;t++){const s=n[t*2],r=n[t*2+1];n[t*2]=e.a*s+e.c*r+e.tx,n[t*2+1]=e.b*s+e.d*r+e.ty}}addColors(n,e,t,s,r=0){const o=(e>>16)+(e&65280)+((e&255)<<16),h=premultiplyTint(o,t);n.length=Math.max(n.length,r+s);for(let c=0;c<s;c++)n[r+c]=h}addTextureIds(n,e,t,s=0){n.length=Math.max(n.length,s+t);for(let r=0;r<t;r++)n[s+r]=e}addUvs(n,e,t,s,r,o=null){let h=0;const c=e.length,a=t.frame;for(;h<r;){let d=n[(s+h)*2],p=n[(s+h)*2+1];if(o){const m=o.a*d+o.c*p+o.tx;p=o.b*d+o.d*p+o.ty,d=m}h++,e.push(d/a.width,p/a.height)}const u=t.baseTexture;(a.width<u.width||a.height<u.height)&&this.adjustUvs(e,t,c,r)}adjustUvs(n,e,t,s){const r=e.baseTexture,o=1e-6,h=t+s*2,c=e.frame,a=c.width/r.width,u=c.height/r.height;let d=c.x/c.width,p=c.y/c.height,m=Math.floor(n[t]+o),g=Math.floor(n[t+1]+o);for(let _=t+2;_<h;_+=2)m=Math.min(m,Math.floor(n[_]+o)),g=Math.min(g,Math.floor(n[_+1]+o));d-=m,p-=g;for(let _=t;_<h;_+=2)n[_]=(n[_]+d)*a,n[_+1]=(n[_+1]+p)*u}};let GraphicsGeometry=_GraphicsGeometry;GraphicsGeometry.BATCHABLE_SIZE=100;class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new FillStyle;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}clone(){const e=new LineStyle;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const temp=new Float32Array(3),DEFAULT_SHADERS={},_Graphics=class extends Container{constructor(n=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=State$1.for2d(),this._geometry=n||new GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new _Graphics(this._geometry)}set blendMode(n){this.state.blendMode=n}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(n){this._tint=n}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(n=null,e=0,t=1,s=.5,r=!1){return typeof n=="number"&&(n={width:n,color:e,alpha:t,alignment:s,native:r}),this.lineTextureStyle(n)}lineTextureStyle(n){n=Object.assign({width:0,texture:Texture.WHITE,color:n!=null&&n.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10},n),this.currentPath&&this.startPoly();const e=n.width>0&&n.alpha>0;return e?(n.matrix&&(n.matrix=n.matrix.clone(),n.matrix.invert()),Object.assign(this._lineStyle,{visible:e},n)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const n=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(n[e-2],n[e-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(n,e){return this.startPoly(),this.currentPath.points[0]=n,this.currentPath.points[1]=e,this}lineTo(n,e){this.currentPath||this.moveTo(0,0);const t=this.currentPath.points,s=t[t.length-2],r=t[t.length-1];return(s!==n||r!==e)&&t.push(n,e),this}_initCurve(n=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[n,e]):this.moveTo(n,e)}quadraticCurveTo(n,e,t,s){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),QuadraticUtils.curveTo(n,e,t,s,r),this}bezierCurveTo(n,e,t,s,r,o){return this._initCurve(),BezierUtils.curveTo(n,e,t,s,r,o,this.currentPath.points),this}arcTo(n,e,t,s,r){this._initCurve(n,e);const o=this.currentPath.points,h=ArcUtils.curveTo(n,e,t,s,r,o);if(h){const{cx:c,cy:a,radius:u,startAngle:d,endAngle:p,anticlockwise:m}=h;this.arc(c,a,u,d,p,m)}return this}arc(n,e,t,s,r,o=!1){if(s===r)return this;if(!o&&r<=s?r+=PI_2:o&&s<=r&&(s+=PI_2),r-s===0)return this;const c=n+Math.cos(s)*t,a=e+Math.sin(s)*t,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const p=Math.abs(d[d.length-2]-c),m=Math.abs(d[d.length-1]-a);p<u&&m<u||d.push(c,a)}else this.moveTo(c,a),d=this.currentPath.points;return ArcUtils.arc(c,a,n,e,t,s,r,o,d),this}beginFill(n=0,e=1){return this.beginTextureFill({texture:Texture.WHITE,color:n,alpha:e})}beginTextureFill(n){n=Object.assign({texture:Texture.WHITE,color:16777215,alpha:1,matrix:null},n),this.currentPath&&this.startPoly();const e=n.alpha>0;return e?(n.matrix&&(n.matrix=n.matrix.clone(),n.matrix.invert()),Object.assign(this._fillStyle,{visible:e},n)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(n,e,t,s){return this.drawShape(new Rectangle(n,e,t,s))}drawRoundedRect(n,e,t,s,r){return this.drawShape(new RoundedRectangle(n,e,t,s,r))}drawCircle(n,e,t){return this.drawShape(new Circle(n,e,t))}drawEllipse(n,e,t,s){return this.drawShape(new Ellipse(n,e,t,s))}drawPolygon(...n){let e,t=!0;const s=n[0];s.points?(t=s.closeStroke,e=s.points):Array.isArray(n[0])?e=n[0]:e=n;const r=new Polygon(e);return r.closeStroke=t,this.drawShape(r),this}drawShape(n){return this._holeMode?this._geometry.drawHole(n,this._matrix):this._geometry.drawShape(n,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const n=this._geometry.graphicsData;return n.length===1&&n[0].shape.type===SHAPES.RECT&&!n[0].matrix&&!n[0].holes.length&&!(n[0].lineStyle.visible&&n[0].lineStyle.width)}_render(n){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(n)):(n.batch.flush(),this._renderDirect(n))}_populateBatches(){const n=this._geometry,e=this.blendMode,t=n.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=n.batchDirty,this.batches.length=t,this.vertexData=new Float32Array(n.points);for(let s=0;s<t;s++){const r=n.batches[s],o=r.style.color,h=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),c=new Float32Array(n.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),a=new Uint16Array(n.indicesUint16.buffer,r.start*2,r.size),u={vertexData:h,blendMode:e,indices:a,uvs:c,_batchRGB:hex2rgb(o),_tintRGB:o,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[s]=u}}_renderBatched(n){if(this.batches.length){n.batch.setObjectRenderer(n.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,t=this.batches.length;e<t;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,n.plugins[this.pluginName].render(s)}}}_renderDirect(n){const e=this._resolveDirectShader(n),t=this._geometry,s=this.tint,r=this.worldAlpha,o=e.uniforms,h=t.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(s>>16&255)/255*r,o.tint[1]=(s>>8&255)/255*r,o.tint[2]=(s&255)/255*r,o.tint[3]=r,n.shader.bind(e),n.geometry.bind(t,e),n.state.set(this.state);for(let c=0,a=h.length;c<a;c++)this._renderDrawCallDirect(n,t.drawCalls[c])}_renderDrawCallDirect(n,e){const{texArray:t,type:s,size:r,start:o}=e,h=t.count;for(let c=0;c<h;c++)n.texture.bind(t.elements[c],c);n.geometry.draw(s,r,o)}_resolveDirectShader(n){let e=this.shader;const t=this.pluginName;if(!e){if(!DEFAULT_SHADERS[t]){const{maxTextures:s}=n.plugins[t],r=new Int32Array(s);for(let c=0;c<s;c++)r[c]=c;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:r},!0)},h=n.plugins[t]._shader.program;DEFAULT_SHADERS[t]=new Shader(h,o)}e=DEFAULT_SHADERS[t]}return e}_calculateBounds(){this.finishPoly();const n=this._geometry;if(!n.graphicsData.length)return;const{minX:e,minY:t,maxX:s,maxY:r}=n.bounds;this._bounds.addFrame(this.transform,e,t,s,r)}containsPoint(n){return this.worldTransform.applyInverse(n,_Graphics._TEMP_POINT),this._geometry.containsPoint(_Graphics._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const n=hex2rgb(this.tint,temp);for(let e=0;e<this.batches.length;e++){const t=this.batches[e],s=t._batchRGB,r=n[0]*s[0]*255,o=n[1]*s[1]*255,h=n[2]*s[2]*255,c=(r<<16)+(o<<8)+(h|0);t._tintRGB=(c>>16)+(c&65280)+((c&255)<<16)}}}calculateVertices(){const n=this.transform._worldID;if(this._transformID===n)return;this._transformID=n;const e=this.transform.worldTransform,t=e.a,s=e.b,r=e.c,o=e.d,h=e.tx,c=e.ty,a=this._geometry.points,u=this.vertexData;let d=0;for(let p=0;p<a.length;p+=2){const m=a[p],g=a[p+1];u[d++]=t*m+r*g+h,u[d++]=o*g+s*m+c}}closePath(){const n=this.currentPath;return n&&(n.closeStroke=!0,this.finishPoly()),this}setMatrix(n){return this._matrix=n,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(n){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(n)}};let Graphics=_Graphics;Graphics.curves=curves;Graphics._TEMP_POINT=new Point;const tempRgb=[0,0,0];class SpineSprite extends Sprite{constructor(){super(...arguments),this.region=null,this.attachment=null}}class SpineMesh extends SimpleMesh{constructor(e,t,s,r,o){super(e,t,s,r,o),this.region=null,this.attachment=null}}const _SpineBase=class extends Container{constructor(n){if(super(),!n)throw new Error("The spineData param is required.");if(typeof n=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=n,this.createSkeleton(n),this.slotContainers=[],this.tempClipContainers=[];for(let e=0,t=this.skeleton.slots.length;e<t;e++){const s=this.skeleton.slots[e],r=s.getAttachment(),o=this.newContainer();if(this.slotContainers.push(o),this.addChild(o),this.tempClipContainers.push(null),!!r)if(r.type===AttachmentType.Region){const h=r.name,c=this.createSprite(s,r,h);s.currentSprite=c,s.currentSpriteName=h,o.addChild(c)}else if(r.type===AttachmentType.Mesh){const h=this.createMesh(s,r);s.currentMesh=h,s.currentMeshId=r.id,s.currentMeshName=r.name,o.addChild(h)}else r.type===AttachmentType.Clipping&&(this.createGraphics(s,r),o.addChild(s.clippingContainer),o.addChild(s.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(n){var e;n!=this._debug&&((e=this._debug)==null||e.unregisterSpine(this),n==null||n.registerSpine(this),this._debug=n)}get autoUpdate(){return this._autoUpdate}set autoUpdate(n){n!==this._autoUpdate&&(this._autoUpdate=n,this.updateTransform=n?_SpineBase.prototype.autoUpdateTransform:Container.prototype.updateTransform)}get tint(){return rgb2hex(this.tintRgb)}set tint(n){this.tintRgb=hex2rgb(n,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:settings.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(n){var u;const e=this.delayLimit;if(n>e&&(n=e),this.state.update(n),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const t=this.skeleton.slots,s=this.color;let r=null,o=null;s?(r=s.light,o=s.dark):r=this.tintRgb;for(let d=0,p=t.length;d<p;d++){const m=t[d],g=m.getAttachment(),_=this.slotContainers[d];if(!g){_.visible=!1;continue}let y=null;g.sequence&&g.sequence.apply(m,g);let v=g.region;const N=g.color;switch(g!=null&&g.type){case AttachmentType.Region:if(_.transform.setFromMatrix(m.bone.matrix),v=g.region,m.currentMesh&&(m.currentMesh.visible=!1,m.currentMesh=null,m.currentMeshId=void 0,m.currentMeshName=void 0),!v){m.currentSprite&&(m.currentSprite.renderable=!1);break}if(!m.currentSpriteName||m.currentSpriteName!==g.name){const U=g.name;if(m.currentSprite&&(m.currentSprite.visible=!1),m.sprites=m.sprites||{},m.sprites[U]!==void 0)m.sprites[U].visible=!0;else{const ee=this.createSprite(m,g,U);_.addChild(ee)}m.currentSprite=m.sprites[U],m.currentSpriteName=U}m.currentSprite.renderable=!0,m.hackRegion||this.setSpriteRegion(g,m.currentSprite,v),m.currentSprite.color?y=m.currentSprite.color:(tempRgb[0]=r[0]*m.color.r*N.r,tempRgb[1]=r[1]*m.color.g*N.g,tempRgb[2]=r[2]*m.color.b*N.b,m.currentSprite.tint=rgb2hex(tempRgb)),m.currentSprite.blendMode=m.blendMode;break;case AttachmentType.Mesh:if(m.currentSprite){m.currentSprite.visible=!1,m.currentSprite=null,m.currentSpriteName=void 0;const U=new Transform;U._parentID=-1,U._worldID=_.transform._worldID,_.transform=U}if(!v){m.currentMesh&&(m.currentMesh.renderable=!1);break}const k=g.id;if(m.currentMeshId===void 0||m.currentMeshId!==k){const U=k;if(m.currentMesh&&(m.currentMesh.visible=!1),m.meshes=m.meshes||{},m.meshes[U]!==void 0)m.meshes[U].visible=!0;else{const ee=this.createMesh(m,g);_.addChild(ee)}m.currentMesh=m.meshes[U],m.currentMeshName=g.name,m.currentMeshId=U}m.currentMesh.renderable=!0,g.computeWorldVerticesOld(m,m.currentMesh.vertices),m.currentMesh.color?y=m.currentMesh.color:(tempRgb[0]=r[0]*m.color.r*N.r,tempRgb[1]=r[1]*m.color.g*N.g,tempRgb[2]=r[2]*m.color.b*N.b,m.currentMesh.tint=rgb2hex(tempRgb)),m.currentMesh.blendMode=m.blendMode,m.hackRegion||this.setMeshRegion(g,m.currentMesh,v);break;case AttachmentType.Clipping:m.currentGraphics||(this.createGraphics(m,g),_.addChild(m.clippingContainer),_.addChild(m.currentGraphics)),this.updateGraphics(m,g),_.alpha=1,_.visible=!0;continue;default:_.visible=!1;continue}if(_.visible=!0,y){let w=m.color.r*N.r,k=m.color.g*N.g,U=m.color.b*N.b;y.setLight(r[0]*w+o[0]*(1-w),r[1]*k+o[1]*(1-k),r[2]*U+o[2]*(1-U)),m.darkColor?(w=m.darkColor.r,k=m.darkColor.g,U=m.darkColor.b):(w=0,k=0,U=0),y.setDark(r[0]*w+o[0]*(1-w),r[1]*k+o[1]*(1-k),r[2]*U+o[2]*(1-U))}_.alpha=m.color.a}const h=this.skeleton.drawOrder;let c=null,a=null;for(let d=0,p=h.length;d<p;d++){const m=t[h[d].data.index],g=this.slotContainers[h[d].data.index];if(a||g.parent!==null&&g.parent!==this&&(g.parent.removeChild(g),g.parent=this),m.currentGraphics&&m.getAttachment())a=m.clippingContainer,c=m.getAttachment(),a.children.length=0,this.children[d]=g,c.endSlot===m.data&&(c.endSlot=null);else if(a){let _=this.tempClipContainers[d];_||(_=this.tempClipContainers[d]=this.newContainer(),_.visible=!1),this.children[d]=_,g.parent=null,a.addChild(g),c.endSlot==m.data&&(a.renderable=!0,a=null,c=null)}else this.children[d]=g}(u=this._debug)==null||u.renderDebug(this)}setSpriteRegion(n,e,t){e.attachment===n&&e.region===t||(e.region=t,e.attachment=n,e.texture=t.texture,e.rotation=n.rotation*MathUtils.degRad,e.position.x=n.x,e.position.y=n.y,e.alpha=n.color.a,t.size?(e.scale.x=t.size.width/t.originalWidth,e.scale.y=-t.size.height/t.originalHeight):(e.scale.x=n.scaleX*n.width/t.originalWidth,e.scale.y=-n.scaleY*n.height/t.originalHeight))}setMeshRegion(n,e,t){e.attachment===n&&e.region===t||(e.region=t,e.attachment=n,e.texture=t.texture,t.texture.updateUvs(),e.uvBuffer.update(n.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const n=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(n)}Container.prototype.updateTransform.call(this)}createSprite(n,e,t){let s=e.region;n.hackAttachment===e&&(s=n.hackRegion);const r=s?s.texture:null,o=this.newSprite(r);return o.anchor.set(.5),s&&this.setSpriteRegion(e,o,e.region),n.sprites=n.sprites||{},n.sprites[t]=o,o}createMesh(n,e){let t=e.region;n.hackAttachment===e&&(t=n.hackRegion,n.hackAttachment=null,n.hackRegion=null);const s=this.newMesh(t?t.texture:null,new Float32Array(e.regionUVs.length),e.regionUVs,new Uint16Array(e.triangles),DRAW_MODES.TRIANGLES);return typeof s._canvasPadding<"u"&&(s._canvasPadding=1.5),s.alpha=e.color.a,s.region=e.region,t&&this.setMeshRegion(e,s,t),n.meshes=n.meshes||{},n.meshes[e.id]=s,s}createGraphics(n,e){const t=this.newGraphics(),s=new Polygon([]);return t.clear(),t.beginFill(16777215,1),t.drawPolygon(s),t.renderable=!1,n.currentGraphics=t,n.clippingContainer=this.newContainer(),n.clippingContainer.mask=n.currentGraphics,t}updateGraphics(n,e){const t=n.currentGraphics.geometry,s=t.graphicsData[0].shape.points,r=e.worldVerticesLength;s.length=r,e.computeWorldVertices(n,0,r,s,0,2),t.invalidate()}hackTextureBySlotIndex(n,e=null,t=null){const s=this.skeleton.slots[n];if(!s)return!1;const r=s.getAttachment();let o=r.region;return e?(o=new TextureRegion,o.texture=e,o.size=t,s.hackRegion=o,s.hackAttachment=r):(s.hackRegion=null,s.hackAttachment=null),s.currentSprite?this.setSpriteRegion(r,s.currentSprite,o):s.currentMesh&&this.setMeshRegion(r,s.currentMesh,o),!0}hackTextureBySlotName(n,e=null,t=null){const s=this.skeleton.findSlotIndex(n);return s==-1?!1:this.hackTextureBySlotIndex(s,e,t)}hackTextureAttachment(n,e,t,s=null){const r=this.skeleton.findSlotIndex(n),o=this.skeleton.getAttachmentByName(n,e);o.region.texture=t;const h=this.skeleton.slots[r];if(!h)return!1;const c=h.getAttachment();if(e===c.name){let a=o.region;return t?(a=new TextureRegion,a.texture=t,a.size=s,h.hackRegion=a,h.hackAttachment=c):(h.hackRegion=null,h.hackAttachment=null),h.currentSprite&&h.currentSprite.region!=a?(this.setSpriteRegion(c,h.currentSprite,a),h.currentSprite.region=a):h.currentMesh&&h.currentMesh.region!=a&&this.setMeshRegion(c,h.currentMesh,a),!0}return!1}newContainer(){return new Container}newSprite(n){return new SpineSprite(n)}newGraphics(){return new Graphics}newMesh(n,e,t,s,r){return new SpineMesh(n,e,t,s,r)}transformHack(){return 1}hackAttachmentGroups(n,e,t){if(!n)return;const s=[],r=[];for(let o=0,h=this.skeleton.slots.length;o<h;o++){const c=this.skeleton.slots[o],a=c.currentSpriteName||c.currentMeshName||"",u=c.currentSprite||c.currentMesh;a.endsWith(n)?(u.parentGroup=e,r.push(u)):t&&u&&(u.parentGroup=t,s.push(u))}return[s,r]}destroy(n){this.debug=null;for(let e=0,t=this.skeleton.slots.length;e<t;e++){const s=this.skeleton.slots[e];for(const r in s.meshes)s.meshes[r].destroy(n);s.meshes=null;for(const r in s.sprites)s.sprites[r].destroy(n);s.sprites=null}for(let e=0,t=this.slotContainers.length;e<t;e++)this.slotContainers[e].destroy(n);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(n)}};let SpineBase=_SpineBase;SpineBase.clippingPolygon=[];Object.defineProperty(SpineBase.prototype,"visible",{get(){return this._visible},set(n){n!==this._visible&&(this._visible=n,n&&(this.lastTime=0))}});const assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions$1.handle(ExtensionType.Asset,n=>{const e=n.ref;Object.entries(assetKeyMap).filter(([t])=>!!e[t]).forEach(([t,s])=>extensions$1.add(Object.assign(e[t],{extension:e[t].extension??s})))},n=>{const e=n.ref;Object.keys(assetKeyMap).filter(t=>!!e[t]).forEach(t=>extensions$1.remove(e[t]))});class BackgroundLoader{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<t;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function checkDataUrl(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function checkExtension(n,e){const t=n.split("?")[0],s=path$1.extname(t).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const convertToList=(n,e)=>(Array.isArray(n)||(n=[n]),e?n.map(t=>typeof t=="string"?e(t):t):n),copySearchParams=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n};function processX(n,e,t,s,r){const o=e[t];for(let h=0;h<o.length;h++){const c=o[h];t<e.length-1?processX(n.replace(s[t],c),e,t+1,s,r):r.push(n.replace(s[t],c))}}function createStringVariations(n){const e=/\{(.*?)\}/g,t=n.match(e),s=[];if(t){const r=[];t.forEach(o=>{const h=o.substring(1,o.length-1).split(",");r.push(h)}),processX(n,r,0,t,s)}else s.push(n);return s}const isSingleItem=n=>!Array.isArray(n);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const s=convertToList(e);let r;for(let c=0;c<this.parsers.length;c++){const a=this.parsers[c];if(a.test(t)){r=a.getCacheableAssets(s,t);break}}r||(r={},s.forEach(c=>{r[c]=t}));const o=Object.keys(r),h={cacheKeys:o,keys:s};if(s.forEach(c=>{this._cacheMap.set(c,h)}),o.forEach(c=>{this._cache.has(c)&&this._cache.get(c)!==t&&console.warn("[Cache] already has key:",c),this._cache.set(c,r[c])}),t instanceof Texture){const c=t;s.forEach(a=>{c.baseTexture!==Texture.EMPTY.baseTexture&&BaseTexture.addToCache(c.baseTexture,a),Texture.addToCache(c,a)})}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(r=>{this._cache.delete(r)}),t.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Cache=new CacheClass;class Loader{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(e,t){const s={promise:null,parser:null};return s.promise=(async()=>{var o,h;let r=null;for(let c=0;c<this.parsers.length;c++){const a=this.parsers[c];if(a.load&&((o=a.test)!=null&&o.call(a,e,t,this))){r=await a.load(e,t,this),s.parser=a;break}}if(!s.parser)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let c=0;c<this.parsers.length;c++){const a=this.parsers[c];a.parse&&a.parse&&await((h=a.testParse)==null?void 0:h.call(a,r,t,this))&&(r=await a.parse(r,t,this)||r,s.parser=a)}return r})(),s}async load(e,t){let s=0;const r={},o=isSingleItem(e),h=convertToList(e,u=>({src:u})),c=h.length,a=h.map(async u=>{const d=path$1.toAbsolute(u.src);if(!r[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),r[u.src]=await this.promiseCache[d].promise,t&&t(++s/c)}catch(p){throw delete this.promiseCache[d],delete r[u.src],new Error(`[Loader.load] Failed to load ${d}.
${p}`)}});return await Promise.all(a),o?r[h[0].src]:r}async unload(e){const s=convertToList(e,r=>({src:r})).map(async r=>{var c,a;const o=path$1.toAbsolute(r.src),h=this.promiseCache[o];if(h){const u=await h.promise;(a=(c=h.parser)==null?void 0:c.unload)==null||a.call(c,u,r,this),delete this.promiseCache[o]}});await Promise.all(s)}get parsers(){return this._parsers}}var LoaderParserPriority=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(LoaderParserPriority||{});const loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return path$1.extname(n).toLowerCase()===".json"},async load(n){return await(await settings$1.ADAPTER.fetch(n)).json()}};extensions$1.add(loadJson);const loadTxt={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return path$1.extname(n).toLowerCase()===".txt"},async load(n){return await(await settings$1.ADAPTER.fetch(n)).text()}};extensions$1.add(loadTxt);const validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"];function getFontFamilyName(n){const e=path$1.extname(n);return path$1.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}const loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(n){return checkDataUrl(n,validFontMIMEs)||checkExtension(n,validFontExtensions)},async load(n,e){var s,r,o;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const t=settings$1.ADAPTER.getFontFaceSet();if(t){const h=[],c=((s=e.data)==null?void 0:s.family)??getFontFamilyName(n),a=((o=(r=e.data)==null?void 0:r.weights)==null?void 0:o.filter(d=>validWeights.includes(d)))??["normal"],u=e.data??{};for(let d=0;d<a.length;d++){const p=a[d],m=new FontFace(c,`url(${encodeURI(n)})`,{...u,weight:p});await m.load(),t.add(m),h.push(m)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(e=>settings$1.ADAPTER.getFontFaceSet().delete(e))}};extensions$1.add(loadWebFont);let UUID=0,MAX_WORKERS;const WHITE_PNG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",checkImageBitmapCode={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${WHITE_PNG}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},workerCode={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let workerURL;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const t=URL.createObjectURL(new Blob([checkImageBitmapCode.code],{type:"application/javascript"})),s=new Worker(t);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(t),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){MAX_WORKERS===void 0&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<MAX_WORKERS&&(workerURL||(workerURL=URL.createObjectURL(new Blob([workerCode.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(workerURL),e.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const s=new Promise((r,o)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:o})});return this.next(),s}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),s=t.id;this.resolveHash[UUID]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:UUID++,id:s})}}const WorkerManager=new WorkerManagerClass;function createTexture(n,e,t){const s=new Texture(n);return s.baseTexture.on("dispose",()=>{delete e.promiseCache[t]}),s}const validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(n){const e=await settings$1.ADAPTER.fetch(n);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const loadTextures={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{preferWorkers:!0},test(n){return checkDataUrl(n,validImageMIMEs)||checkExtension(n,validImageExtensions)},async load(n,e,t){let s=null;globalThis.createImageBitmap?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?s=await WorkerManager.loadImageBitmap(n):s=await loadImageBitmap(n):s=await new Promise(o=>{s=new Image,s.crossOrigin="anonymous",s.src=n,s.complete?o(s):s.onload=()=>{o(s)}});const r=new BaseTexture(s,{resolution:getResolutionOfUrl(n),...e.data});return r.resource.src=n,createTexture(r,t,n)},unload(n){n.destroy(!0)}};extensions$1.add(loadTextures);const loadSVG={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return path$1.extname(n).toLowerCase()===".svg"},async testParse(n){return SVGResource.test(n)},async parse(n,e,t){var h,c,a;const s=new SVGResource(n,(h=e==null?void 0:e.data)==null?void 0:h.resourceOptions),r=new BaseTexture(s,{resolution:getResolutionOfUrl(n),...e==null?void 0:e.data});r.resource.src=n;const o=createTexture(r,t,n);return(a=(c=e==null?void 0:e.data)==null?void 0:c.resourceOptions)!=null&&a.autoLoad||await s.load(),o},async load(n,e){return(await settings$1.ADAPTER.fetch(n)).text()},unload:loadTextures.unload};extensions$1.add(loadSVG);class Resolver{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(e,t)=>`${e}${this._bundleIdConnector}${t}`,this._extractAssetIdFromBundle=(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const s=[];Array.isArray(t)?t.forEach(r=>{if(typeof r.name=="string"){const o=this._createBundleAssetId(e,r.name);s.push(o),this.add([r.name,o],r.srcs,r.data)}else{const o=r.name.map(h=>this._createBundleAssetId(e,h));o.forEach(h=>{s.push(h)}),this.add([...r.name,...o],r.srcs)}}):Object.keys(t).forEach(r=>{s.push(this._createBundleAssetId(e,r)),this.add([r,this._createBundleAssetId(e,r)],t[r])}),this._bundles[e]=s}add(e,t,s){const r=convertToList(e);r.forEach(h=>{this._assetMap[h]&&console.warn(`[Resolver] already has key: ${h} overwriting`)}),Array.isArray(t)||(typeof t=="string"?t=createStringVariations(t):t=[t]);const o=t.map(h=>{let c=h;if(typeof h=="string"){let a=!1;for(let u=0;u<this._parsers.length;u++){const d=this._parsers[u];if(d.test(h)){c=d.parse(h),a=!0;break}}a||(c={src:h})}return c.format||(c.format=c.src.split(".").pop()),c.alias||(c.alias=r),(this._basePath||this._rootPath)&&(c.src=path$1.toAbsolute(c.src,this._basePath,this._rootPath)),c.src=this._appendDefaultSearchParams(c.src),c.data=c.data??s,c});r.forEach(h=>{this._assetMap[h]=o})}resolveBundle(e){const t=isSingleItem(e);e=convertToList(e);const s={};return e.forEach(r=>{const o=this._bundles[r];if(o){const h=this.resolve(o),c={};for(const a in h){const u=h[a];c[this._extractAssetIdFromBundle(r,a)]=u}s[r]=c}}),t?s[e[0]]:s}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const s={};for(const r in t)s[r]=t[r].src;return s}return t.src}resolve(e){const t=isSingleItem(e);e=convertToList(e);const s={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let o=this._assetMap[r];const h=this._getPreferredOrder(o),c=o[0];h==null||h.priority.forEach(a=>{h.params[a].forEach(u=>{const d=o.filter(p=>p[a]?p[a]===u:!1);d.length&&(o=d)})}),this._resolverHash[r]=o[0]??c}else{let o=r;(this._basePath||this._rootPath)&&(o=path$1.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[r]={src:o}}s[r]=this._resolverHash[r]}),t?s[e[0]]:s}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const s=e[0],r=this._preferredOrder.find(o=>o.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}}class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var o,h,c;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const t=((o=e.texturePreference)==null?void 0:o.resolution)??1,s=typeof t=="number"?[t]:t;let r=[];if((h=e.texturePreference)!=null&&h.format){const a=(c=e.texturePreference)==null?void 0:c.format;r=typeof a=="string"?[a]:a;for(const u of this._detections)await u.test()||(r=await u.remove(r))}else for(const a of this._detections)await a.test()&&(r=await a.add(r));this.resolver.prefer({params:{format:r,resolution:s}})}add(e,t,s){this.resolver.add(e,t,s)}async load(e,t){this._initialized||await this.init();const s=isSingleItem(e),r=convertToList(e).map(c=>typeof c!="string"?(this.resolver.add(c.src,c),c.src):c),o=this.resolver.resolve(r),h=await this._mapLoadToResolve(o,t);return s?h[r[0]]:h}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const r=this.resolver.resolveBundle(e),o={},h=Object.keys(r);let c=0,a=0;const u=()=>{t==null||t(++c/a)},d=h.map(p=>{const m=r[p];return a+=Object.keys(m).length,this._mapLoadToResolve(m,u).then(g=>{o[p]=g})});return await Promise.all(d),s?o[e[0]]:o}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Cache.get(e);const t={};for(let s=0;s<e.length;s++)t[s]=Cache.get(e[s]);return t}async _mapLoadToResolve(e,t){const s=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const o=await this.loader.load(s,t);this._backgroundLoader.active=!0;const h={};return s.forEach((c,a)=>{const u=o[c.src],d=[c.src];c.alias&&d.push(...c.alias),h[r[a]]=u,Cache.set(d,u)}),h}async unload(e){this._initialized||await this.init();const t=convertToList(e).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(t);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=convertToList(e);const t=this.resolver.resolveBundle(e),s=Object.keys(t).map(r=>this._unloadFromResolved(t[r]));await Promise.all(s)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(s=>{Cache.remove(s.src)}),await this.loader.unload(t)}get detections(){return this._detections}get preferWorkers(){return loadTextures.config.preferWorkers}set preferWorkers(e){loadTextures.config.preferWorkers=e}}const Assets=new AssetsClass;extensions$1.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections);const cacheTextureArray={extension:ExtensionType.CacheParser,test:n=>Array.isArray(n)&&n.every(e=>e instanceof Texture),getCacheableAssets:(n,e)=>{const t={};return n.forEach(s=>{e.forEach((r,o)=>{t[s+(o===0?"":o+1)]=r})}),t}};extensions$1.add(cacheTextureArray);const detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const n="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",e=await settings$1.ADAPTER.fetch(n).then(t=>t.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")};extensions$1.add(detectAvif);const detectWebp={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",e=await settings$1.ADAPTER.fetch(n).then(t=>t.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")};extensions$1.add(detectWebp);const imageFormats=["png","jpg","jpeg"],detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...imageFormats],remove:async n=>n.filter(e=>!imageFormats.includes(e))};extensions$1.add(detectDefaults);const resolveTextureUrl={extension:ExtensionType.ResolveParser,test:loadTextures.test,parse:n=>{var e;return{resolution:parseFloat(((e=settings$1.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:n.split(".").pop(),src:n}}};extensions$1.add(resolveTextureUrl);const spineTextureAtlasLoader={extension:ExtensionType.Asset,loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(n){return checkExtension(n,".atlas")},async load(n){return await(await settings$1.ADAPTER.fetch(n)).text()},testParse(n,e){const t=checkExtension(e.src,".atlas"),s=typeof n=="string";return Promise.resolve(t&&s)},async parse(n,e,t){const s=e.data;let r=path$1.dirname(e.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let o=null,h=null;const c=new Promise((d,p)=>{o=d,h=p});let a;const u=d=>{d||h(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),o(a)};if(s.image||s.images){const d=Object.assign(s.image?{default:s.image}:{},s.images);a=new TextureAtlas(n,(p,m)=>{const g=d[p]||d.default;g&&g.baseTexture?m(g.baseTexture):m(g)},u)}else a=new TextureAtlas(n,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(t,r,s.imageMetadata),u);return await c},unload(n){n.dispose()}}},makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject=(n,e,t)=>async(s,r)=>{const o=path$1.join(...e.split(path$1.sep),s),h=await n.load({src:o,data:t});r(h.baseTexture)};extensions$1.add(spineTextureAtlasLoader);function isJson(n){return n.hasOwnProperty("bones")}function isBuffer(n){return n instanceof ArrayBuffer}class SpineLoaderAbstract{constructor(){}installLoader(){const e=this,t={extension:ExtensionType.Asset,loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(s){return checkExtension(s,".skel")},async load(s){return await(await settings$1.ADAPTER.fetch(s)).arrayBuffer()},testParse(s,r){var a;const o=checkExtension(r.src,".json")&&isJson(s),h=checkExtension(r.src,".skel")&&isBuffer(s),c=((a=r.data)==null?void 0:a.spineAtlas)===!1;return Promise.resolve(o&&!c||h)},async parse(s,r,o){const h=path$1.extname(r.src).toLowerCase(),c=path$1.basename(r.src,h);let a=path$1.dirname(r.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");const u=checkExtension(r.src,".json")&&isJson(s);let d=null,p=s;u?d=e.createJsonParser():(d=e.createBinaryParser(),p=new Uint8Array(s));const m=r.data||{},g=(m==null?void 0:m.spineSkeletonScale)??null;g&&(d.scale=g);const _=m.spineAtlas;if(_&&_.pages)return e.parseData(d,_,p);const y=m.atlasRawData;if(y){let w=null,k=null;const U=new Promise((se,oe)=>{w=se,k=oe}),ee=new TextureAtlas(y,makeSpineTextureAtlasLoaderFunctionFromPixiLoaderObject(o,a,m.imageMetadata),se=>{se||k(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),w(ee)}),ie=await U;return e.parseData(d,ie,p)}let v=m.spineAtlasFile;v||(v=`${a+c}.atlas`);const N=await o.load({src:v,data:m,alias:m.spineAtlasAlias});return e.parseData(d,N,p)}}};return extensions$1.add(t),t}}let Attachment$2=class{constructor(e){if(e==null)throw new Error("name cannot be null.");this.name=e}};const _VertexAttachment$2=class extends Attachment$2{constructor(e){super(e),this.id=(_VertexAttachment$2.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(e,t){this.computeWorldVertices(e,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(e,t,s,r,o,h){s=o+(s>>1)*h;const c=e.bone.skeleton,a=e.deform;let u=this.vertices;const d=this.bones;if(d==null){a.length>0&&(u=a);const _=e.bone.matrix,y=_.tx,v=_.ty,N=_.a,w=_.c,k=_.b,U=_.d;for(let ee=t,ie=o;ie<s;ee+=2,ie+=h){const se=u[ee],oe=u[ee+1];r[ie]=se*N+oe*w+y,r[ie+1]=se*k+oe*U+v}return}let p=0,m=0;for(let _=0;_<t;_+=2){const y=d[p];p+=y+1,m+=y}const g=c.bones;if(a.length==0)for(let _=o,y=m*3;_<s;_+=h){let v=0,N=0,w=d[p++];for(w+=p;p<w;p++,y+=3){const k=g[d[p]].matrix,U=u[y],ee=u[y+1],ie=u[y+2];v+=(U*k.a+ee*k.c+k.tx)*ie,N+=(U*k.b+ee*k.d+k.ty)*ie}r[_]=v,r[_+1]=N}else{const _=a;for(let y=o,v=m*3,N=m<<1;y<s;y+=h){let w=0,k=0,U=d[p++];for(U+=p;p<U;p++,v+=3,N+=2){const ee=g[d[p]].matrix,ie=u[v]+_[N],se=u[v+1]+_[N+1],oe=u[v+2];w+=(ie*ee.a+se*ee.c+ee.tx)*oe,k+=(ie*ee.b+se*ee.d+ee.ty)*oe}r[y]=w,r[y+1]=k}}}copyTo(e){this.bones!=null?(e.bones=new Array(this.bones.length),Utils.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices!=null?(e.vertices=Utils.newFloatArray(this.vertices.length),Utils.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment}};let VertexAttachment$2=_VertexAttachment$2;VertexAttachment$2.nextID=0;let BoundingBoxAttachment$2=class extends VertexAttachment$2{constructor(e){super(e),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}copy(){const e=new BoundingBoxAttachment$2(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}},ClippingAttachment$2=class extends VertexAttachment$2{constructor(e){super(e),this.type=AttachmentType.Clipping,this.color=new Color(.2275,.2275,.8078,1)}copy(){const e=new ClippingAttachment$2(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}},MeshAttachment$2=class extends VertexAttachment$2{constructor(e){super(e),this.type=AttachmentType.Mesh,this.color=new Color(1,1,1,1),this.tempColor=new Color(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e!=null&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();const e=new MeshAttachment$2(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Float32Array(this.regionUVs.length),Utils.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.triangles=new Array(this.triangles.length),Utils.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,this.edges!=null&&(e.edges=new Array(this.edges.length),Utils.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}newLinkedMesh(){const e=new MeshAttachment$2(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),e.deformAttachment=this.deformAttachment,e.setParentMesh(this.parentMesh!=null?this.parentMesh:this),e}},PathAttachment$2=class extends VertexAttachment$2{constructor(e){super(e),this.type=AttachmentType.Path,this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}copy(){const e=new PathAttachment$2(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Utils.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}},PointAttachment$2=class extends VertexAttachment$2{constructor(e){super(e),this.type=AttachmentType.Point,this.color=new Color(.38,.94,0,1)}computeWorldPosition(e,t){const s=e.matrix;return t.x=this.x*s.a+this.y*s.c+e.worldX,t.y=this.x*s.b+this.y*s.d+e.worldY,t}computeWorldRotation(e){const t=e.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),o=s*t.a+r*t.c,h=s*t.b+r*t.d;return Math.atan2(h,o)*MathUtils.radDeg}copy(){const e=new PointAttachment$2(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}},Slot$1=class{constructor(e,t){if(this.deform=new Array,e==null)throw new Error("data cannot be null.");if(t==null)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new Color,this.darkColor=e.darkColor==null?null:new Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(e){this.attachment!=e&&(this.attachment=e,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(e){this.attachmentTime=this.bone.skeleton.time-e}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const _RegionAttachment$2=class extends Attachment$2{constructor(e){super(e),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1)}updateOffset(){const e=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*e,r=-this.height/2*this.scaleY+this.region.offsetY*t,o=s+this.region.width*e,h=r+this.region.height*t,c=this.rotation*Math.PI/180,a=Math.cos(c),u=Math.sin(c),d=s*a+this.x,p=s*u,m=r*a+this.y,g=r*u,_=o*a+this.x,y=o*u,v=h*a+this.y,N=h*u,w=this.offset;w[_RegionAttachment$2.OX1]=d-g,w[_RegionAttachment$2.OY1]=m+p,w[_RegionAttachment$2.OX2]=d-N,w[_RegionAttachment$2.OY2]=v+p,w[_RegionAttachment$2.OX3]=_-N,w[_RegionAttachment$2.OY3]=v+y,w[_RegionAttachment$2.OX4]=_-g,w[_RegionAttachment$2.OY4]=m+y}setRegion(e){this.region=e;const t=this.uvs;e.rotate?(t[2]=e.u,t[3]=e.v2,t[4]=e.u,t[5]=e.v,t[6]=e.u2,t[7]=e.v,t[0]=e.u2,t[1]=e.v2):(t[0]=e.u,t[1]=e.v2,t[2]=e.u,t[3]=e.v,t[4]=e.u2,t[5]=e.v,t[6]=e.u2,t[7]=e.v2)}computeWorldVertices(e,t,s,r){const o=this.offset,h=e instanceof Slot$1?e.bone.matrix:e.matrix,c=h.tx,a=h.ty,u=h.a,d=h.c,p=h.b,m=h.d;let g=0,_=0;g=o[_RegionAttachment$2.OX1],_=o[_RegionAttachment$2.OY1],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$2.OX2],_=o[_RegionAttachment$2.OY2],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$2.OX3],_=o[_RegionAttachment$2.OY3],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$2.OX4],_=o[_RegionAttachment$2.OY4],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a}copy(){const e=new _RegionAttachment$2(this.name);return e.region=this.region,e.rendererObject=this.rendererObject,e.path=this.path,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,Utils.arrayCopy(this.uvs,0,e.uvs,0,8),Utils.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e}};let RegionAttachment$2=_RegionAttachment$2;RegionAttachment$2.OX1=0;RegionAttachment$2.OY1=1;RegionAttachment$2.OX2=2;RegionAttachment$2.OY2=3;RegionAttachment$2.OX3=4;RegionAttachment$2.OY3=5;RegionAttachment$2.OX4=6;RegionAttachment$2.OY4=7;RegionAttachment$2.X1=0;RegionAttachment$2.Y1=1;RegionAttachment$2.C1R=2;RegionAttachment$2.C1G=3;RegionAttachment$2.C1B=4;RegionAttachment$2.C1A=5;RegionAttachment$2.U1=6;RegionAttachment$2.V1=7;RegionAttachment$2.X2=8;RegionAttachment$2.Y2=9;RegionAttachment$2.C2R=10;RegionAttachment$2.C2G=11;RegionAttachment$2.C2B=12;RegionAttachment$2.C2A=13;RegionAttachment$2.U2=14;RegionAttachment$2.V2=15;RegionAttachment$2.X3=16;RegionAttachment$2.Y3=17;RegionAttachment$2.C3R=18;RegionAttachment$2.C3G=19;RegionAttachment$2.C3B=20;RegionAttachment$2.C3A=21;RegionAttachment$2.U3=22;RegionAttachment$2.V3=23;RegionAttachment$2.X4=24;RegionAttachment$2.Y4=25;RegionAttachment$2.C4R=26;RegionAttachment$2.C4G=27;RegionAttachment$2.C4B=28;RegionAttachment$2.C4A=29;RegionAttachment$2.U4=30;RegionAttachment$2.V4=31;new PowOut(2);let Animation$4=class{constructor(e,t,s){if(e==null)throw new Error("name cannot be null.");if(t==null)throw new Error("timelines cannot be null.");this.name=e,this.timelines=t,this.timelineIds=[];for(let r=0;r<t.length;r++)this.timelineIds[t[r].getPropertyId()]=!0;this.duration=s}hasTimeline(e){return this.timelineIds[e]==!0}apply(e,t,s,r,o,h,c,a){if(e==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,t>0&&(t%=this.duration));const u=this.timelines;for(let d=0,p=u.length;d<p;d++)u[d].apply(e,t,s,o,h,c,a)}static binarySearch(e,t,s=1){let r=0,o=e.length/s-2;if(o==0)return s;let h=o>>>1;for(;;){if(e[(h+1)*s]<=t?r=h+1:o=h,r==o)return(r+1)*s;h=r+o>>>1}}static linearSearch(e,t,s){for(let r=0,o=e.length-s;r<=o;r+=s)if(e[r]>t)return r;return-1}};const _CurveTimeline$1=class{constructor(e){if(e<=0)throw new Error(`frameCount must be > 0: ${e}`);this.curves=Utils.newFloatArray((e-1)*_CurveTimeline$1.BEZIER_SIZE)}getFrameCount(){return this.curves.length/_CurveTimeline$1.BEZIER_SIZE+1}setLinear(e){this.curves[e*_CurveTimeline$1.BEZIER_SIZE]=_CurveTimeline$1.LINEAR}setStepped(e){this.curves[e*_CurveTimeline$1.BEZIER_SIZE]=_CurveTimeline$1.STEPPED}getCurveType(e){const t=e*_CurveTimeline$1.BEZIER_SIZE;if(t==this.curves.length)return _CurveTimeline$1.LINEAR;const s=this.curves[t];return s==_CurveTimeline$1.LINEAR?_CurveTimeline$1.LINEAR:s==_CurveTimeline$1.STEPPED?_CurveTimeline$1.STEPPED:_CurveTimeline$1.BEZIER}setCurve(e,t,s,r,o){const h=(-t*2+r)*.03,c=(-s*2+o)*.03,a=((t-r)*3+1)*.006,u=((s-o)*3+1)*.006;let d=h*2+a,p=c*2+u,m=t*.3+h+a*.16666667,g=s*.3+c+u*.16666667,_=e*_CurveTimeline$1.BEZIER_SIZE;const y=this.curves;y[_++]=_CurveTimeline$1.BEZIER;let v=m,N=g;for(let w=_+_CurveTimeline$1.BEZIER_SIZE-1;_<w;_+=2)y[_]=v,y[_+1]=N,m+=d,g+=p,d+=a,p+=u,v+=m,N+=g}getCurvePercent(e,t){t=MathUtils.clamp(t,0,1);const s=this.curves;let r=e*_CurveTimeline$1.BEZIER_SIZE;const o=s[r];if(o==_CurveTimeline$1.LINEAR)return t;if(o==_CurveTimeline$1.STEPPED)return 0;r++;let h=0;for(let a=r,u=r+_CurveTimeline$1.BEZIER_SIZE-1;r<u;r+=2)if(h=s[r],h>=t){let d,p;return r==a?(d=0,p=0):(d=s[r-2],p=s[r-1]),p+(s[r+1]-p)*(t-d)/(h-d)}const c=s[r-1];return c+(1-c)*(t-h)/(1-h)}};let CurveTimeline$2=_CurveTimeline$1;CurveTimeline$2.LINEAR=0;CurveTimeline$2.STEPPED=1;CurveTimeline$2.BEZIER=2;CurveTimeline$2.BEZIER_SIZE=10*2-1;const _RotateTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(e,t,s){e<<=1,this.frames[e]=t,this.frames[e+_RotateTimeline$1.ROTATION]=s}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.rotation=u.data.rotation;return;case MixBlend.first:const y=u.data.rotation-u.rotation;u.rotation+=(y-(16384-(16384.499999999996-y/360|0))*360)*o}return}if(s>=a[a.length-_RotateTimeline$1.ENTRIES]){let y=a[a.length+_RotateTimeline$1.PREV_ROTATION];switch(h){case MixBlend.setup:u.rotation=u.data.rotation+y*o;break;case MixBlend.first:case MixBlend.replace:y+=u.data.rotation-u.rotation,y-=(16384-(16384.499999999996-y/360|0))*360;case MixBlend.add:u.rotation+=y*o}return}const d=Animation$4.binarySearch(a,s,_RotateTimeline$1.ENTRIES),p=a[d+_RotateTimeline$1.PREV_ROTATION],m=a[d],g=this.getCurvePercent((d>>1)-1,1-(s-m)/(a[d+_RotateTimeline$1.PREV_TIME]-m));let _=a[d+_RotateTimeline$1.ROTATION]-p;switch(_=p+(_-(16384-(16384.499999999996-_/360|0))*360)*g,h){case MixBlend.setup:u.rotation=u.data.rotation+(_-(16384-(16384.499999999996-_/360|0))*360)*o;break;case MixBlend.first:case MixBlend.replace:_+=u.data.rotation-u.rotation;case MixBlend.add:u.rotation+=(_-(16384-(16384.499999999996-_/360|0))*360)*o}}};let RotateTimeline$2=_RotateTimeline$1;RotateTimeline$2.ENTRIES=2;RotateTimeline$2.PREV_TIME=-2;RotateTimeline$2.PREV_ROTATION=-1;RotateTimeline$2.ROTATION=1;const _TranslateTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_TranslateTimeline$1.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(e,t,s,r){e*=_TranslateTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_TranslateTimeline$1.X]=s,this.frames[e+_TranslateTimeline$1.Y]=r}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.x=u.data.x,u.y=u.data.y;return;case MixBlend.first:u.x+=(u.data.x-u.x)*o,u.y+=(u.data.y-u.y)*o}return}let d=0,p=0;if(s>=a[a.length-_TranslateTimeline$1.ENTRIES])d=a[a.length+_TranslateTimeline$1.PREV_X],p=a[a.length+_TranslateTimeline$1.PREV_Y];else{const m=Animation$4.binarySearch(a,s,_TranslateTimeline$1.ENTRIES);d=a[m+_TranslateTimeline$1.PREV_X],p=a[m+_TranslateTimeline$1.PREV_Y];const g=a[m],_=this.getCurvePercent(m/_TranslateTimeline$1.ENTRIES-1,1-(s-g)/(a[m+_TranslateTimeline$1.PREV_TIME]-g));d+=(a[m+_TranslateTimeline$1.X]-d)*_,p+=(a[m+_TranslateTimeline$1.Y]-p)*_}switch(h){case MixBlend.setup:u.x=u.data.x+d*o,u.y=u.data.y+p*o;break;case MixBlend.first:case MixBlend.replace:u.x+=(u.data.x+d-u.x)*o,u.y+=(u.data.y+p-u.y)*o;break;case MixBlend.add:u.x+=d*o,u.y+=p*o}}};let TranslateTimeline$2=_TranslateTimeline$1;TranslateTimeline$2.ENTRIES=3;TranslateTimeline$2.PREV_TIME=-3;TranslateTimeline$2.PREV_X=-2;TranslateTimeline$2.PREV_Y=-1;TranslateTimeline$2.X=1;TranslateTimeline$2.Y=2;let ScaleTimeline$2=class extends TranslateTimeline$2{constructor(e){super(e)}getPropertyId(){return(2<<24)+this.boneIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.scaleX=u.data.scaleX,u.scaleY=u.data.scaleY;return;case MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*o,u.scaleY+=(u.data.scaleY-u.scaleY)*o}return}let d=0,p=0;if(s>=a[a.length-ScaleTimeline$2.ENTRIES])d=a[a.length+ScaleTimeline$2.PREV_X]*u.data.scaleX,p=a[a.length+ScaleTimeline$2.PREV_Y]*u.data.scaleY;else{const m=Animation$4.binarySearch(a,s,ScaleTimeline$2.ENTRIES);d=a[m+ScaleTimeline$2.PREV_X],p=a[m+ScaleTimeline$2.PREV_Y];const g=a[m],_=this.getCurvePercent(m/ScaleTimeline$2.ENTRIES-1,1-(s-g)/(a[m+ScaleTimeline$2.PREV_TIME]-g));d=(d+(a[m+ScaleTimeline$2.X]-d)*_)*u.data.scaleX,p=(p+(a[m+ScaleTimeline$2.Y]-p)*_)*u.data.scaleY}if(o==1)h==MixBlend.add?(u.scaleX+=d-u.data.scaleX,u.scaleY+=p-u.data.scaleY):(u.scaleX=d,u.scaleY=p);else{let m=0,g=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:m=u.data.scaleX,g=u.data.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-g)*o;break;case MixBlend.first:case MixBlend.replace:m=u.scaleX,g=u.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-g)*o;break;case MixBlend.add:m=u.scaleX,g=u.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-u.data.scaleX)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-u.data.scaleY)*o}else switch(h){case MixBlend.setup:m=Math.abs(u.data.scaleX)*MathUtils.signum(d),g=Math.abs(u.data.scaleY)*MathUtils.signum(p),u.scaleX=m+(d-m)*o,u.scaleY=g+(p-g)*o;break;case MixBlend.first:case MixBlend.replace:m=Math.abs(u.scaleX)*MathUtils.signum(d),g=Math.abs(u.scaleY)*MathUtils.signum(p),u.scaleX=m+(d-m)*o,u.scaleY=g+(p-g)*o;break;case MixBlend.add:m=MathUtils.signum(d),g=MathUtils.signum(p),u.scaleX=Math.abs(u.scaleX)*m+(d-Math.abs(u.data.scaleX)*m)*o,u.scaleY=Math.abs(u.scaleY)*g+(p-Math.abs(u.data.scaleY)*g)*o}}}},ShearTimeline$2=class extends TranslateTimeline$2{constructor(e){super(e)}getPropertyId(){return(3<<24)+this.boneIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.shearX=u.data.shearX,u.shearY=u.data.shearY;return;case MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*o,u.shearY+=(u.data.shearY-u.shearY)*o}return}let d=0,p=0;if(s>=a[a.length-ShearTimeline$2.ENTRIES])d=a[a.length+ShearTimeline$2.PREV_X],p=a[a.length+ShearTimeline$2.PREV_Y];else{const m=Animation$4.binarySearch(a,s,ShearTimeline$2.ENTRIES);d=a[m+ShearTimeline$2.PREV_X],p=a[m+ShearTimeline$2.PREV_Y];const g=a[m],_=this.getCurvePercent(m/ShearTimeline$2.ENTRIES-1,1-(s-g)/(a[m+ShearTimeline$2.PREV_TIME]-g));d=d+(a[m+ShearTimeline$2.X]-d)*_,p=p+(a[m+ShearTimeline$2.Y]-p)*_}switch(h){case MixBlend.setup:u.shearX=u.data.shearX+d*o,u.shearY=u.data.shearY+p*o;break;case MixBlend.first:case MixBlend.replace:u.shearX+=(u.data.shearX+d-u.shearX)*o,u.shearY+=(u.data.shearY+p-u.shearY)*o;break;case MixBlend.add:u.shearX+=d*o,u.shearY+=p*o}}};const _ColorTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_ColorTimeline$1.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(e,t,s,r,o,h){e*=_ColorTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_ColorTimeline$1.R]=s,this.frames[e+_ColorTimeline$1.G]=r,this.frames[e+_ColorTimeline$1.B]=o,this.frames[e+_ColorTimeline$1.A]=h}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.color.setFromColor(a.data.color);return;case MixBlend.first:const _=a.color,y=a.data.color;_.add((y.r-_.r)*o,(y.g-_.g)*o,(y.b-_.b)*o,(y.a-_.a)*o)}return}let d=0,p=0,m=0,g=0;if(s>=u[u.length-_ColorTimeline$1.ENTRIES]){const _=u.length;d=u[_+_ColorTimeline$1.PREV_R],p=u[_+_ColorTimeline$1.PREV_G],m=u[_+_ColorTimeline$1.PREV_B],g=u[_+_ColorTimeline$1.PREV_A]}else{const _=Animation$4.binarySearch(u,s,_ColorTimeline$1.ENTRIES);d=u[_+_ColorTimeline$1.PREV_R],p=u[_+_ColorTimeline$1.PREV_G],m=u[_+_ColorTimeline$1.PREV_B],g=u[_+_ColorTimeline$1.PREV_A];const y=u[_],v=this.getCurvePercent(_/_ColorTimeline$1.ENTRIES-1,1-(s-y)/(u[_+_ColorTimeline$1.PREV_TIME]-y));d+=(u[_+_ColorTimeline$1.R]-d)*v,p+=(u[_+_ColorTimeline$1.G]-p)*v,m+=(u[_+_ColorTimeline$1.B]-m)*v,g+=(u[_+_ColorTimeline$1.A]-g)*v}if(o==1)a.color.set(d,p,m,g);else{const _=a.color;h==MixBlend.setup&&_.setFromColor(a.data.color),_.add((d-_.r)*o,(p-_.g)*o,(m-_.b)*o,(g-_.a)*o)}}};let ColorTimeline$1=_ColorTimeline$1;ColorTimeline$1.ENTRIES=5;ColorTimeline$1.PREV_TIME=-5;ColorTimeline$1.PREV_R=-4;ColorTimeline$1.PREV_G=-3;ColorTimeline$1.PREV_B=-2;ColorTimeline$1.PREV_A=-1;ColorTimeline$1.R=1;ColorTimeline$1.G=2;ColorTimeline$1.B=3;ColorTimeline$1.A=4;const _TwoColorTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_TwoColorTimeline$1.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(e,t,s,r,o,h,c,a,u){e*=_TwoColorTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_TwoColorTimeline$1.R]=s,this.frames[e+_TwoColorTimeline$1.G]=r,this.frames[e+_TwoColorTimeline$1.B]=o,this.frames[e+_TwoColorTimeline$1.A]=h,this.frames[e+_TwoColorTimeline$1.R2]=c,this.frames[e+_TwoColorTimeline$1.G2]=a,this.frames[e+_TwoColorTimeline$1.B2]=u}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.color.setFromColor(a.data.color),a.darkColor.setFromColor(a.data.darkColor);return;case MixBlend.first:const N=a.color,w=a.darkColor,k=a.data.color,U=a.data.darkColor;N.add((k.r-N.r)*o,(k.g-N.g)*o,(k.b-N.b)*o,(k.a-N.a)*o),w.add((U.r-w.r)*o,(U.g-w.g)*o,(U.b-w.b)*o,0)}return}let d=0,p=0,m=0,g=0,_=0,y=0,v=0;if(s>=u[u.length-_TwoColorTimeline$1.ENTRIES]){const N=u.length;d=u[N+_TwoColorTimeline$1.PREV_R],p=u[N+_TwoColorTimeline$1.PREV_G],m=u[N+_TwoColorTimeline$1.PREV_B],g=u[N+_TwoColorTimeline$1.PREV_A],_=u[N+_TwoColorTimeline$1.PREV_R2],y=u[N+_TwoColorTimeline$1.PREV_G2],v=u[N+_TwoColorTimeline$1.PREV_B2]}else{const N=Animation$4.binarySearch(u,s,_TwoColorTimeline$1.ENTRIES);d=u[N+_TwoColorTimeline$1.PREV_R],p=u[N+_TwoColorTimeline$1.PREV_G],m=u[N+_TwoColorTimeline$1.PREV_B],g=u[N+_TwoColorTimeline$1.PREV_A],_=u[N+_TwoColorTimeline$1.PREV_R2],y=u[N+_TwoColorTimeline$1.PREV_G2],v=u[N+_TwoColorTimeline$1.PREV_B2];const w=u[N],k=this.getCurvePercent(N/_TwoColorTimeline$1.ENTRIES-1,1-(s-w)/(u[N+_TwoColorTimeline$1.PREV_TIME]-w));d+=(u[N+_TwoColorTimeline$1.R]-d)*k,p+=(u[N+_TwoColorTimeline$1.G]-p)*k,m+=(u[N+_TwoColorTimeline$1.B]-m)*k,g+=(u[N+_TwoColorTimeline$1.A]-g)*k,_+=(u[N+_TwoColorTimeline$1.R2]-_)*k,y+=(u[N+_TwoColorTimeline$1.G2]-y)*k,v+=(u[N+_TwoColorTimeline$1.B2]-v)*k}if(o==1)a.color.set(d,p,m,g),a.darkColor.set(_,y,v,1);else{const N=a.color,w=a.darkColor;h==MixBlend.setup&&(N.setFromColor(a.data.color),w.setFromColor(a.data.darkColor)),N.add((d-N.r)*o,(p-N.g)*o,(m-N.b)*o,(g-N.a)*o),w.add((_-w.r)*o,(y-w.g)*o,(v-w.b)*o,0)}}};let TwoColorTimeline$1=_TwoColorTimeline$1;TwoColorTimeline$1.ENTRIES=8;TwoColorTimeline$1.PREV_TIME=-8;TwoColorTimeline$1.PREV_R=-7;TwoColorTimeline$1.PREV_G=-6;TwoColorTimeline$1.PREV_B=-5;TwoColorTimeline$1.PREV_A=-4;TwoColorTimeline$1.PREV_R2=-3;TwoColorTimeline$1.PREV_G2=-2;TwoColorTimeline$1.PREV_B2=-1;TwoColorTimeline$1.R=1;TwoColorTimeline$1.G=2;TwoColorTimeline$1.B=3;TwoColorTimeline$1.A=4;TwoColorTimeline$1.R2=5;TwoColorTimeline$1.G2=6;TwoColorTimeline$1.B2=7;let AttachmentTimeline$2=class{constructor(e){this.frames=Utils.newFloatArray(e),this.attachmentNames=new Array(e)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.attachmentNames[e]=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;if(c==MixDirection.mixOut){h==MixBlend.setup&&this.setAttachment(e,a,a.data.attachmentName);return}const u=this.frames;if(s<u[0]){(h==MixBlend.setup||h==MixBlend.first)&&this.setAttachment(e,a,a.data.attachmentName);return}let d=0;s>=u[u.length-1]?d=u.length-1:d=Animation$4.binarySearch(u,s,1)-1;const p=this.attachmentNames[d];e.slots[this.slotIndex].setAttachment(p==null?null:e.getAttachment(this.slotIndex,p))}setAttachment(e,t,s){t.setAttachment(s==null?null:e.getAttachment(this.slotIndex,s))}},zeros$1=null,DeformTimeline$2=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e),this.frameVertices=new Array(e),zeros$1==null&&(zeros$1=Utils.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(e,t,s){this.frames[e]=t,this.frameVertices[e]=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=a.getAttachment();if(!(u instanceof VertexAttachment$2)||u.deformAttachment!=this.attachment)return;const d=a.deform;d.length==0&&(h=MixBlend.setup);const p=this.frameVertices,m=p[0].length,g=this.frames;if(s<g[0]){const U=u;switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(o==1){d.length=0;break}const ee=Utils.setArraySize(d,m);if(U.bones==null){const ie=U.vertices;for(let se=0;se<m;se++)ee[se]+=(ie[se]-ee[se])*o}else{o=1-o;for(let ie=0;ie<m;ie++)ee[ie]*=o}}return}const _=Utils.setArraySize(d,m);if(s>=g[g.length-1]){const U=p[g.length-1];if(o==1)if(h==MixBlend.add){const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++)_[se]+=U[se]-ie[se]}else for(let ie=0;ie<m;ie++)_[ie]+=U[ie]}else Utils.arrayCopy(U,0,_,0,m);else switch(h){case MixBlend.setup:{const ie=u;if(ie.bones==null){const se=ie.vertices;for(let oe=0;oe<m;oe++){const le=se[oe];_[oe]=le+(U[oe]-le)*o}}else for(let se=0;se<m;se++)_[se]=U[se]*o;break}case MixBlend.first:case MixBlend.replace:for(let ie=0;ie<m;ie++)_[ie]+=(U[ie]-_[ie])*o;break;case MixBlend.add:const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++)_[se]+=(U[se]-ie[se])*o}else for(let ie=0;ie<m;ie++)_[ie]+=U[ie]*o}return}const y=Animation$4.binarySearch(g,s),v=p[y-1],N=p[y],w=g[y],k=this.getCurvePercent(y-1,1-(s-w)/(g[y-1]-w));if(o==1)if(h==MixBlend.add){const U=u;if(U.bones==null){const ee=U.vertices;for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]+=se+(N[ie]-se)*k-ee[ie]}}else for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=ie+(N[ee]-ie)*k}}else for(let U=0;U<m;U++){const ee=v[U];_[U]=ee+(N[U]-ee)*k}else switch(h){case MixBlend.setup:{const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++){const oe=v[se],le=ie[se];_[se]=le+(oe+(N[se]-oe)*k-le)*o}}else for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]=(se+(N[ie]-se)*k)*o}break}case MixBlend.first:case MixBlend.replace:for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=(ie+(N[ee]-ie)*k-_[ee])*o}break;case MixBlend.add:const U=u;if(U.bones==null){const ee=U.vertices;for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]+=(se+(N[ie]-se)*k-ee[ie])*o}}else for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=(ie+(N[ee]-ie)*k)*o}}}},EventTimeline$2=class{constructor(e){this.frames=Utils.newFloatArray(e),this.events=new Array(e)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(e,t){this.frames[e]=t.time,this.events[e]=t}apply(e,t,s,r,o,h,c){if(r==null)return;const a=this.frames,u=this.frames.length;if(t>s)this.apply(e,t,Number.MAX_VALUE,r,o,h,c),t=-1;else if(t>=a[u-1])return;if(s<a[0])return;let d=0;if(t<a[0])d=0;else{d=Animation$4.binarySearch(a,t);const p=a[d];for(;d>0&&a[d-1]==p;)d--}for(;d<u&&s>=a[d];d++)r.push(this.events[d])}},DrawOrderTimeline$2=class{constructor(e){this.frames=Utils.newFloatArray(e),this.drawOrders=new Array(e)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.drawOrders[e]=s}apply(e,t,s,r,o,h,c){const a=e.drawOrder,u=e.slots;if(c==MixDirection.mixOut&&h==MixBlend.setup){Utils.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}const d=this.frames;if(s<d[0]){(h==MixBlend.setup||h==MixBlend.first)&&Utils.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}let p=0;s>=d[d.length-1]?p=d.length-1:p=Animation$4.binarySearch(d,s)-1;const m=this.drawOrders[p];if(m==null)Utils.arrayCopy(u,0,a,0,u.length);else for(let g=0,_=m.length;g<_;g++)a[g]=u[m[g]]}};const _IkConstraintTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_IkConstraintTimeline$1.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(e,t,s,r,o,h,c){e*=_IkConstraintTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_IkConstraintTimeline$1.MIX]=s,this.frames[e+_IkConstraintTimeline$1.SOFTNESS]=r,this.frames[e+_IkConstraintTimeline$1.BEND_DIRECTION]=o,this.frames[e+_IkConstraintTimeline$1.COMPRESS]=h?1:0,this.frames[e+_IkConstraintTimeline$1.STRETCH]=c?1:0}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.ikConstraints[this.ikConstraintIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.mix=u.data.mix,u.softness=u.data.softness,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch;return;case MixBlend.first:u.mix+=(u.data.mix-u.mix)*o,u.softness+=(u.data.softness-u.softness)*o,u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch}return}if(s>=a[a.length-_IkConstraintTimeline$1.ENTRIES]){h==MixBlend.setup?(u.mix=u.data.mix+(a[a.length+_IkConstraintTimeline$1.PREV_MIX]-u.data.mix)*o,u.softness=u.data.softness+(a[a.length+_IkConstraintTimeline$1.PREV_SOFTNESS]-u.data.softness)*o,c==MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=a[a.length+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=a[a.length+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=a[a.length+_IkConstraintTimeline$1.PREV_STRETCH]!=0)):(u.mix+=(a[a.length+_IkConstraintTimeline$1.PREV_MIX]-u.mix)*o,u.softness+=(a[a.length+_IkConstraintTimeline$1.PREV_SOFTNESS]-u.softness)*o,c==MixDirection.mixIn&&(u.bendDirection=a[a.length+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=a[a.length+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=a[a.length+_IkConstraintTimeline$1.PREV_STRETCH]!=0));return}const d=Animation$4.binarySearch(a,s,_IkConstraintTimeline$1.ENTRIES),p=a[d+_IkConstraintTimeline$1.PREV_MIX],m=a[d+_IkConstraintTimeline$1.PREV_SOFTNESS],g=a[d],_=this.getCurvePercent(d/_IkConstraintTimeline$1.ENTRIES-1,1-(s-g)/(a[d+_IkConstraintTimeline$1.PREV_TIME]-g));h==MixBlend.setup?(u.mix=u.data.mix+(p+(a[d+_IkConstraintTimeline$1.MIX]-p)*_-u.data.mix)*o,u.softness=u.data.softness+(m+(a[d+_IkConstraintTimeline$1.SOFTNESS]-m)*_-u.data.softness)*o,c==MixDirection.mixOut?(u.bendDirection=u.data.bendDirection,u.compress=u.data.compress,u.stretch=u.data.stretch):(u.bendDirection=a[d+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=a[d+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=a[d+_IkConstraintTimeline$1.PREV_STRETCH]!=0)):(u.mix+=(p+(a[d+_IkConstraintTimeline$1.MIX]-p)*_-u.mix)*o,u.softness+=(m+(a[d+_IkConstraintTimeline$1.SOFTNESS]-m)*_-u.softness)*o,c==MixDirection.mixIn&&(u.bendDirection=a[d+_IkConstraintTimeline$1.PREV_BEND_DIRECTION],u.compress=a[d+_IkConstraintTimeline$1.PREV_COMPRESS]!=0,u.stretch=a[d+_IkConstraintTimeline$1.PREV_STRETCH]!=0))}};let IkConstraintTimeline$2=_IkConstraintTimeline$1;IkConstraintTimeline$2.ENTRIES=6;IkConstraintTimeline$2.PREV_TIME=-6;IkConstraintTimeline$2.PREV_MIX=-5;IkConstraintTimeline$2.PREV_SOFTNESS=-4;IkConstraintTimeline$2.PREV_BEND_DIRECTION=-3;IkConstraintTimeline$2.PREV_COMPRESS=-2;IkConstraintTimeline$2.PREV_STRETCH=-1;IkConstraintTimeline$2.MIX=1;IkConstraintTimeline$2.SOFTNESS=2;IkConstraintTimeline$2.BEND_DIRECTION=3;IkConstraintTimeline$2.COMPRESS=4;IkConstraintTimeline$2.STRETCH=5;const _TransformConstraintTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_TransformConstraintTimeline$1.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(e,t,s,r,o,h){e*=_TransformConstraintTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_TransformConstraintTimeline$1.ROTATE]=s,this.frames[e+_TransformConstraintTimeline$1.TRANSLATE]=r,this.frames[e+_TransformConstraintTimeline$1.SCALE]=o,this.frames[e+_TransformConstraintTimeline$1.SHEAR]=h}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.transformConstraints[this.transformConstraintIndex];if(!u.active)return;if(s<a[0]){const _=u.data;switch(h){case MixBlend.setup:u.rotateMix=_.rotateMix,u.translateMix=_.translateMix,u.scaleMix=_.scaleMix,u.shearMix=_.shearMix;return;case MixBlend.first:u.rotateMix+=(_.rotateMix-u.rotateMix)*o,u.translateMix+=(_.translateMix-u.translateMix)*o,u.scaleMix+=(_.scaleMix-u.scaleMix)*o,u.shearMix+=(_.shearMix-u.shearMix)*o}return}let d=0,p=0,m=0,g=0;if(s>=a[a.length-_TransformConstraintTimeline$1.ENTRIES]){const _=a.length;d=a[_+_TransformConstraintTimeline$1.PREV_ROTATE],p=a[_+_TransformConstraintTimeline$1.PREV_TRANSLATE],m=a[_+_TransformConstraintTimeline$1.PREV_SCALE],g=a[_+_TransformConstraintTimeline$1.PREV_SHEAR]}else{const _=Animation$4.binarySearch(a,s,_TransformConstraintTimeline$1.ENTRIES);d=a[_+_TransformConstraintTimeline$1.PREV_ROTATE],p=a[_+_TransformConstraintTimeline$1.PREV_TRANSLATE],m=a[_+_TransformConstraintTimeline$1.PREV_SCALE],g=a[_+_TransformConstraintTimeline$1.PREV_SHEAR];const y=a[_],v=this.getCurvePercent(_/_TransformConstraintTimeline$1.ENTRIES-1,1-(s-y)/(a[_+_TransformConstraintTimeline$1.PREV_TIME]-y));d+=(a[_+_TransformConstraintTimeline$1.ROTATE]-d)*v,p+=(a[_+_TransformConstraintTimeline$1.TRANSLATE]-p)*v,m+=(a[_+_TransformConstraintTimeline$1.SCALE]-m)*v,g+=(a[_+_TransformConstraintTimeline$1.SHEAR]-g)*v}if(h==MixBlend.setup){const _=u.data;u.rotateMix=_.rotateMix+(d-_.rotateMix)*o,u.translateMix=_.translateMix+(p-_.translateMix)*o,u.scaleMix=_.scaleMix+(m-_.scaleMix)*o,u.shearMix=_.shearMix+(g-_.shearMix)*o}else u.rotateMix+=(d-u.rotateMix)*o,u.translateMix+=(p-u.translateMix)*o,u.scaleMix+=(m-u.scaleMix)*o,u.shearMix+=(g-u.shearMix)*o}};let TransformConstraintTimeline$2=_TransformConstraintTimeline$1;TransformConstraintTimeline$2.ENTRIES=5;TransformConstraintTimeline$2.PREV_TIME=-5;TransformConstraintTimeline$2.PREV_ROTATE=-4;TransformConstraintTimeline$2.PREV_TRANSLATE=-3;TransformConstraintTimeline$2.PREV_SCALE=-2;TransformConstraintTimeline$2.PREV_SHEAR=-1;TransformConstraintTimeline$2.ROTATE=1;TransformConstraintTimeline$2.TRANSLATE=2;TransformConstraintTimeline$2.SCALE=3;TransformConstraintTimeline$2.SHEAR=4;const _PathConstraintPositionTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_PathConstraintPositionTimeline$1.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(e,t,s){e*=_PathConstraintPositionTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_PathConstraintPositionTimeline$1.VALUE]=s}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.position=u.data.position;return;case MixBlend.first:u.position+=(u.data.position-u.position)*o}return}let d=0;if(s>=a[a.length-_PathConstraintPositionTimeline$1.ENTRIES])d=a[a.length+_PathConstraintPositionTimeline$1.PREV_VALUE];else{const p=Animation$4.binarySearch(a,s,_PathConstraintPositionTimeline$1.ENTRIES);d=a[p+_PathConstraintPositionTimeline$1.PREV_VALUE];const m=a[p],g=this.getCurvePercent(p/_PathConstraintPositionTimeline$1.ENTRIES-1,1-(s-m)/(a[p+_PathConstraintPositionTimeline$1.PREV_TIME]-m));d+=(a[p+_PathConstraintPositionTimeline$1.VALUE]-d)*g}h==MixBlend.setup?u.position=u.data.position+(d-u.data.position)*o:u.position+=(d-u.position)*o}};let PathConstraintPositionTimeline$2=_PathConstraintPositionTimeline$1;PathConstraintPositionTimeline$2.ENTRIES=2;PathConstraintPositionTimeline$2.PREV_TIME=-2;PathConstraintPositionTimeline$2.PREV_VALUE=-1;PathConstraintPositionTimeline$2.VALUE=1;let PathConstraintSpacingTimeline$2=class extends PathConstraintPositionTimeline$2{constructor(e){super(e)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.spacing=u.data.spacing;return;case MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*o}return}let d=0;if(s>=a[a.length-PathConstraintSpacingTimeline$2.ENTRIES])d=a[a.length+PathConstraintSpacingTimeline$2.PREV_VALUE];else{const p=Animation$4.binarySearch(a,s,PathConstraintSpacingTimeline$2.ENTRIES);d=a[p+PathConstraintSpacingTimeline$2.PREV_VALUE];const m=a[p],g=this.getCurvePercent(p/PathConstraintSpacingTimeline$2.ENTRIES-1,1-(s-m)/(a[p+PathConstraintSpacingTimeline$2.PREV_TIME]-m));d+=(a[p+PathConstraintSpacingTimeline$2.VALUE]-d)*g}h==MixBlend.setup?u.spacing=u.data.spacing+(d-u.data.spacing)*o:u.spacing+=(d-u.spacing)*o}};const _PathConstraintMixTimeline$1=class extends CurveTimeline$2{constructor(e){super(e),this.frames=Utils.newFloatArray(e*_PathConstraintMixTimeline$1.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(e,t,s,r){e*=_PathConstraintMixTimeline$1.ENTRIES,this.frames[e]=t,this.frames[e+_PathConstraintMixTimeline$1.ROTATE]=s,this.frames[e+_PathConstraintMixTimeline$1.TRANSLATE]=r}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(!u.active)return;if(s<a[0]){switch(h){case MixBlend.setup:u.rotateMix=u.data.rotateMix,u.translateMix=u.data.translateMix;return;case MixBlend.first:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*o,u.translateMix+=(u.data.translateMix-u.translateMix)*o}return}let d=0,p=0;if(s>=a[a.length-_PathConstraintMixTimeline$1.ENTRIES])d=a[a.length+_PathConstraintMixTimeline$1.PREV_ROTATE],p=a[a.length+_PathConstraintMixTimeline$1.PREV_TRANSLATE];else{const m=Animation$4.binarySearch(a,s,_PathConstraintMixTimeline$1.ENTRIES);d=a[m+_PathConstraintMixTimeline$1.PREV_ROTATE],p=a[m+_PathConstraintMixTimeline$1.PREV_TRANSLATE];const g=a[m],_=this.getCurvePercent(m/_PathConstraintMixTimeline$1.ENTRIES-1,1-(s-g)/(a[m+_PathConstraintMixTimeline$1.PREV_TIME]-g));d+=(a[m+_PathConstraintMixTimeline$1.ROTATE]-d)*_,p+=(a[m+_PathConstraintMixTimeline$1.TRANSLATE]-p)*_}h==MixBlend.setup?(u.rotateMix=u.data.rotateMix+(d-u.data.rotateMix)*o,u.translateMix=u.data.translateMix+(p-u.data.translateMix)*o):(u.rotateMix+=(d-u.rotateMix)*o,u.translateMix+=(p-u.translateMix)*o)}};let PathConstraintMixTimeline$2=_PathConstraintMixTimeline$1;PathConstraintMixTimeline$2.ENTRIES=3;PathConstraintMixTimeline$2.PREV_TIME=-3;PathConstraintMixTimeline$2.PREV_ROTATE=-2;PathConstraintMixTimeline$2.PREV_TRANSLATE=-1;PathConstraintMixTimeline$2.ROTATE=1;PathConstraintMixTimeline$2.TRANSLATE=2;new Animation$4("<empty>",[],0);let AtlasAttachmentLoader$2=class{constructor(e){this.atlas=e}newRegionAttachment(e,t,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${t})`);const o=new RegionAttachment$2(t);return o.region=r,o}newMeshAttachment(e,t,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${t})`);const o=new MeshAttachment$2(t);return o.region=r,o}newBoundingBoxAttachment(e,t){return new BoundingBoxAttachment$2(t)}newPathAttachment(e,t){return new PathAttachment$2(t)}newPointAttachment(e,t){return new PointAttachment$2(t)}newClippingAttachment(e,t){return new ClippingAttachment$2(t)}},BoneData$2=class{constructor(e,t,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,this.skinRequired=!1,this.color=new Color,e<0)throw new Error("index must be >= 0.");if(t==null)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=s}},ConstraintData$1=class{constructor(e,t,s){this.name=e,this.order=t,this.skinRequired=s}},Event$3=class{constructor(e,t){if(t==null)throw new Error("data cannot be null.");this.time=e,this.data=t}},EventData$2=class{constructor(e){this.name=e}},IkConstraintData$2=class extends ConstraintData$1{constructor(e){super(e,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},PathConstraintData$2=class extends ConstraintData$1{constructor(e){super(e,0,!1),this.bones=new Array}};var SpacingMode$2=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(SpacingMode$2||{});let SkeletonData$2=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(e){if(e==null)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findBoneIndex(e){if(e==null)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSlot(e){if(e==null)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findSlotIndex(e){if(e==null)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSkin(e){if(e==null)throw new Error("skinName cannot be null.");const t=this.skins;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findEvent(e){if(e==null)throw new Error("eventDataName cannot be null.");const t=this.events;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findAnimation(e){if(e==null)throw new Error("animationName cannot be null.");const t=this.animations;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findIkConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findTransformConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraintIndex(e){if(e==null)throw new Error("pathConstraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}},SlotData$2=class{constructor(e,t,s){if(this.color=new Color(1,1,1,1),e<0)throw new Error("index must be >= 0.");if(t==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=s}},TransformConstraintData$2=class extends ConstraintData$1{constructor(e){super(e,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},SkinEntry$1=class{constructor(e,t,s){this.slotIndex=e,this.name=t,this.attachment=s}},Skin$2=class{constructor(e){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,e==null)throw new Error("name cannot be null.");this.name=e}setAttachment(e,t,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;e>=r.length&&(r.length=e+1),r[e]||(r[e]={}),r[e][t]=s}addSkin(e){for(let s=0;s<e.bones.length;s++){const r=e.bones[s];let o=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){const r=e.constraints[s];let o=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){o=!0;break}o||this.constraints.push(r)}const t=e.getAttachments();for(let s=0;s<t.length;s++){const r=t[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(e){for(let s=0;s<e.bones.length;s++){const r=e.bones[s];let o=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){const r=e.constraints[s];let o=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){o=!0;break}o||this.constraints.push(r)}const t=e.getAttachments();for(let s=0;s<t.length;s++){const r=t[s];r.attachment!=null&&(r.attachment instanceof MeshAttachment$2?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(e,t){const s=this.attachments[e];return s?s[t]:null}removeAttachment(e,t){const s=this.attachments[e];s&&(s[t]=null)}getAttachments(){const e=new Array;for(let t=0;t<this.attachments.length;t++){const s=this.attachments[t];if(s)for(const r in s){const o=s[r];o&&e.push(new SkinEntry$1(t,r,o))}}return e}getAttachmentsForSlot(e,t){const s=this.attachments[e];if(s)for(const r in s){const o=s[r];o&&t.push(new SkinEntry$1(e,r,o))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,t){let s=0;for(let r=0;r<e.slots.length;r++){const o=e.slots[r],h=o.getAttachment();if(h&&s<t.attachments.length){const c=t.attachments[s];for(const a in c){const u=c[a];if(h==u){const d=this.getAttachment(s,a);d!=null&&o.setAttachment(d);break}}}s++}}};const _SkeletonBinary=class{constructor(n){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=n}readSkeletonData(n){const e=this.scale,t=new SkeletonData$2;t.name="";const s=new BinaryInput(n);t.hash=s.readString(),t.version=s.readString(),t.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),t.x=s.readFloat(),t.y=s.readFloat(),t.width=s.readFloat(),t.height=s.readFloat();const r=s.readBoolean();r&&(t.fps=s.readFloat(),t.imagesPath=s.readString(),t.audioPath=s.readString());let o=0;o=s.readInt(!0);for(let c=0;c<o;c++)s.strings.push(s.readString());o=s.readInt(!0);for(let c=0;c<o;c++){const a=s.readString(),u=c==0?null:t.bones[s.readInt(!0)],d=new BoneData$2(c,a,u);d.rotation=s.readFloat(),d.x=s.readFloat()*e,d.y=s.readFloat()*e,d.scaleX=s.readFloat(),d.scaleY=s.readFloat(),d.shearX=s.readFloat(),d.shearY=s.readFloat(),d.length=s.readFloat()*e,d.transformMode=_SkeletonBinary.TransformModeValues[s.readInt(!0)],d.skinRequired=s.readBoolean(),r&&Color.rgba8888ToColor(d.color,s.readInt32()),t.bones.push(d)}o=s.readInt(!0);for(let c=0;c<o;c++){const a=s.readString(),u=t.bones[s.readInt(!0)],d=new SlotData$2(c,a,u);Color.rgba8888ToColor(d.color,s.readInt32());const p=s.readInt32();p!=-1&&Color.rgb888ToColor(d.darkColor=new Color,p),d.attachmentName=s.readStringRef(),d.blendMode=_SkeletonBinary.BlendModeValues[s.readInt(!0)],t.slots.push(d)}o=s.readInt(!0);for(let c=0,a;c<o;c++){const u=new IkConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let d=0;d<a;d++)u.bones.push(t.bones[s.readInt(!0)]);u.target=t.bones[s.readInt(!0)],u.mix=s.readFloat(),u.softness=s.readFloat()*e,u.bendDirection=s.readByte(),u.compress=s.readBoolean(),u.stretch=s.readBoolean(),u.uniform=s.readBoolean(),t.ikConstraints.push(u)}o=s.readInt(!0);for(let c=0,a;c<o;c++){const u=new TransformConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let d=0;d<a;d++)u.bones.push(t.bones[s.readInt(!0)]);u.target=t.bones[s.readInt(!0)],u.local=s.readBoolean(),u.relative=s.readBoolean(),u.offsetRotation=s.readFloat(),u.offsetX=s.readFloat()*e,u.offsetY=s.readFloat()*e,u.offsetScaleX=s.readFloat(),u.offsetScaleY=s.readFloat(),u.offsetShearY=s.readFloat(),u.rotateMix=s.readFloat(),u.translateMix=s.readFloat(),u.scaleMix=s.readFloat(),u.shearMix=s.readFloat(),t.transformConstraints.push(u)}o=s.readInt(!0);for(let c=0,a;c<o;c++){const u=new PathConstraintData$2(s.readString());u.order=s.readInt(!0),u.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let d=0;d<a;d++)u.bones.push(t.bones[s.readInt(!0)]);u.target=t.slots[s.readInt(!0)],u.positionMode=_SkeletonBinary.PositionModeValues[s.readInt(!0)],u.spacingMode=_SkeletonBinary.SpacingModeValues[s.readInt(!0)],u.rotateMode=_SkeletonBinary.RotateModeValues[s.readInt(!0)],u.offsetRotation=s.readFloat(),u.position=s.readFloat(),u.positionMode==PositionMode.Fixed&&(u.position*=e),u.spacing=s.readFloat(),(u.spacingMode==SpacingMode$2.Length||u.spacingMode==SpacingMode$2.Fixed)&&(u.spacing*=e),u.rotateMix=s.readFloat(),u.translateMix=s.readFloat(),t.pathConstraints.push(u)}const h=this.readSkin(s,t,!0,r);h!=null&&(t.defaultSkin=h,t.skins.push(h));{let c=t.skins.length;for(Utils.setArraySize(t.skins,o=c+s.readInt(!0));c<o;c++)t.skins[c]=this.readSkin(s,t,!1,r)}o=this.linkedMeshes.length;for(let c=0;c<o;c++){const a=this.linkedMeshes[c],u=a.skin==null?t.defaultSkin:t.findSkin(a.skin);if(u==null)throw new Error(`Skin not found: ${a.skin}`);const d=u.getAttachment(a.slotIndex,a.parent);if(d==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.deformAttachment=a.inheritDeform?d:a.mesh,a.mesh.setParentMesh(d)}this.linkedMeshes.length=0,o=s.readInt(!0);for(let c=0;c<o;c++){const a=new EventData$2(s.readStringRef());a.intValue=s.readInt(!1),a.floatValue=s.readFloat(),a.stringValue=s.readString(),a.audioPath=s.readString(),a.audioPath!=null&&(a.volume=s.readFloat(),a.balance=s.readFloat()),t.events.push(a)}o=s.readInt(!0);for(let c=0;c<o;c++)t.animations.push(this.readAnimation(s,s.readString(),t));return t}readSkin(n,e,t,s){let r=null,o=0;if(t){if(o=n.readInt(!0),o==0)return null;r=new Skin$2("default")}else{r=new Skin$2(n.readStringRef()),r.bones.length=n.readInt(!0);for(let h=0,c=r.bones.length;h<c;h++)r.bones[h]=e.bones[n.readInt(!0)];for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(e.ikConstraints[n.readInt(!0)]);for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(e.transformConstraints[n.readInt(!0)]);for(let h=0,c=n.readInt(!0);h<c;h++)r.constraints.push(e.pathConstraints[n.readInt(!0)]);o=n.readInt(!0)}for(let h=0;h<o;h++){const c=n.readInt(!0);for(let a=0,u=n.readInt(!0);a<u;a++){const d=n.readStringRef(),p=this.readAttachment(n,e,r,c,d,s);p!=null&&r.setAttachment(c,d,p)}}return r}readAttachment(n,e,t,s,r,o){const h=this.scale;let c=n.readStringRef();c==null&&(c=r);const a=n.readByte();switch(_SkeletonBinary.AttachmentTypeValues[a]){case AttachmentType.Region:{let d=n.readStringRef();const p=n.readFloat(),m=n.readFloat(),g=n.readFloat(),_=n.readFloat(),y=n.readFloat(),v=n.readFloat(),N=n.readFloat(),w=n.readInt32();d==null&&(d=c);const k=this.attachmentLoader.newRegionAttachment(t,c,d);return k==null?null:(k.path=d,k.x=m*h,k.y=g*h,k.scaleX=_,k.scaleY=y,k.rotation=p,k.width=v*h,k.height=N*h,Color.rgba8888ToColor(k.color,w),k)}case AttachmentType.BoundingBox:{const d=n.readInt(!0),p=this.readVertices(n,d),m=o?n.readInt32():0,g=this.attachmentLoader.newBoundingBoxAttachment(t,c);return g==null?null:(g.worldVerticesLength=d<<1,g.vertices=p.vertices,g.bones=p.bones,o&&Color.rgba8888ToColor(g.color,m),g)}case AttachmentType.Mesh:{let d=n.readStringRef();const p=n.readInt32(),m=n.readInt(!0),g=this.readFloatArray(n,m<<1,1),_=this.readShortArray(n),y=this.readVertices(n,m),v=n.readInt(!0);let N=null,w=0,k=0;o&&(N=this.readShortArray(n),w=n.readFloat(),k=n.readFloat()),d==null&&(d=c);const U=this.attachmentLoader.newMeshAttachment(t,c,d);return U==null?null:(U.path=d,Color.rgba8888ToColor(U.color,p),U.bones=y.bones,U.vertices=y.vertices,U.worldVerticesLength=m<<1,U.triangles=_,U.regionUVs=new Float32Array(g),U.hullLength=v<<1,o&&(U.edges=N,U.width=w*h,U.height=k*h),U)}case AttachmentType.LinkedMesh:{let d=n.readStringRef();const p=n.readInt32(),m=n.readStringRef(),g=n.readStringRef(),_=n.readBoolean();let y=0,v=0;o&&(y=n.readFloat(),v=n.readFloat()),d==null&&(d=c);const N=this.attachmentLoader.newMeshAttachment(t,c,d);return N==null?null:(N.path=d,Color.rgba8888ToColor(N.color,p),o&&(N.width=y*h,N.height=v*h),this.linkedMeshes.push(new LinkedMesh$4(N,m,s,g,_)),N)}case AttachmentType.Path:{const d=n.readBoolean(),p=n.readBoolean(),m=n.readInt(!0),g=this.readVertices(n,m),_=Utils.newArray(m/3,0);for(let N=0,w=_.length;N<w;N++)_[N]=n.readFloat()*h;const y=o?n.readInt32():0,v=this.attachmentLoader.newPathAttachment(t,c);return v==null?null:(v.closed=d,v.constantSpeed=p,v.worldVerticesLength=m<<1,v.vertices=g.vertices,v.bones=g.bones,v.lengths=_,o&&Color.rgba8888ToColor(v.color,y),v)}case AttachmentType.Point:{const d=n.readFloat(),p=n.readFloat(),m=n.readFloat(),g=o?n.readInt32():0,_=this.attachmentLoader.newPointAttachment(t,c);return _==null?null:(_.x=p*h,_.y=m*h,_.rotation=d,o&&Color.rgba8888ToColor(_.color,g),_)}case AttachmentType.Clipping:{const d=n.readInt(!0),p=n.readInt(!0),m=this.readVertices(n,p),g=o?n.readInt32():0,_=this.attachmentLoader.newClippingAttachment(t,c);return _==null?null:(_.endSlot=e.slots[d],_.worldVerticesLength=p<<1,_.vertices=m.vertices,_.bones=m.bones,o&&Color.rgba8888ToColor(_.color,g),_)}}return null}readVertices(n,e){const t=e<<1,s=new Vertices$1,r=this.scale;if(!n.readBoolean())return s.vertices=this.readFloatArray(n,t,r),s;const o=new Array,h=new Array;for(let c=0;c<e;c++){const a=n.readInt(!0);h.push(a);for(let u=0;u<a;u++)h.push(n.readInt(!0)),o.push(n.readFloat()*r),o.push(n.readFloat()*r),o.push(n.readFloat())}return s.vertices=Utils.toFloatArray(o),s.bones=h,s}readFloatArray(n,e,t){const s=new Array(e);if(t==1)for(let r=0;r<e;r++)s[r]=n.readFloat();else for(let r=0;r<e;r++)s[r]=n.readFloat()*t;return s}readShortArray(n){const e=n.readInt(!0),t=new Array(e);for(let s=0;s<e;s++)t[s]=n.readShort();return t}readAnimation(n,e,t){const s=new Array,r=this.scale;let o=0;const h=new Color,c=new Color;for(let d=0,p=n.readInt(!0);d<p;d++){const m=n.readInt(!0);for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readByte(),v=n.readInt(!0);switch(y){case _SkeletonBinary.SLOT_ATTACHMENT:{const N=new AttachmentTimeline$2(v);N.slotIndex=m;for(let w=0;w<v;w++)N.setFrame(w,n.readFloat(),n.readStringRef());s.push(N),o=Math.max(o,N.frames[v-1]);break}case _SkeletonBinary.SLOT_COLOR:{const N=new ColorTimeline$1(v);N.slotIndex=m;for(let w=0;w<v;w++){const k=n.readFloat();Color.rgba8888ToColor(h,n.readInt32()),N.setFrame(w,k,h.r,h.g,h.b,h.a),w<v-1&&this.readCurve(n,w,N)}s.push(N),o=Math.max(o,N.frames[(v-1)*ColorTimeline$1.ENTRIES]);break}case _SkeletonBinary.SLOT_TWO_COLOR:{const N=new TwoColorTimeline$1(v);N.slotIndex=m;for(let w=0;w<v;w++){const k=n.readFloat();Color.rgba8888ToColor(h,n.readInt32()),Color.rgb888ToColor(c,n.readInt32()),N.setFrame(w,k,h.r,h.g,h.b,h.a,c.r,c.g,c.b),w<v-1&&this.readCurve(n,w,N)}s.push(N),o=Math.max(o,N.frames[(v-1)*TwoColorTimeline$1.ENTRIES]);break}}}}for(let d=0,p=n.readInt(!0);d<p;d++){const m=n.readInt(!0);for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readByte(),v=n.readInt(!0);switch(y){case _SkeletonBinary.BONE_ROTATE:{const N=new RotateTimeline$2(v);N.boneIndex=m;for(let w=0;w<v;w++)N.setFrame(w,n.readFloat(),n.readFloat()),w<v-1&&this.readCurve(n,w,N);s.push(N),o=Math.max(o,N.frames[(v-1)*RotateTimeline$2.ENTRIES]);break}case _SkeletonBinary.BONE_TRANSLATE:case _SkeletonBinary.BONE_SCALE:case _SkeletonBinary.BONE_SHEAR:{let N,w=1;y==_SkeletonBinary.BONE_SCALE?N=new ScaleTimeline$2(v):y==_SkeletonBinary.BONE_SHEAR?N=new ShearTimeline$2(v):(N=new TranslateTimeline$2(v),w=r),N.boneIndex=m;for(let k=0;k<v;k++)N.setFrame(k,n.readFloat(),n.readFloat()*w,n.readFloat()*w),k<v-1&&this.readCurve(n,k,N);s.push(N),o=Math.max(o,N.frames[(v-1)*TranslateTimeline$2.ENTRIES]);break}}}}for(let d=0,p=n.readInt(!0);d<p;d++){const m=n.readInt(!0),g=n.readInt(!0),_=new IkConstraintTimeline$2(g);_.ikConstraintIndex=m;for(let y=0;y<g;y++)_.setFrame(y,n.readFloat(),n.readFloat(),n.readFloat()*r,n.readByte(),n.readBoolean(),n.readBoolean()),y<g-1&&this.readCurve(n,y,_);s.push(_),o=Math.max(o,_.frames[(g-1)*IkConstraintTimeline$2.ENTRIES])}for(let d=0,p=n.readInt(!0);d<p;d++){const m=n.readInt(!0),g=n.readInt(!0),_=new TransformConstraintTimeline$2(g);_.transformConstraintIndex=m;for(let y=0;y<g;y++)_.setFrame(y,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat()),y<g-1&&this.readCurve(n,y,_);s.push(_),o=Math.max(o,_.frames[(g-1)*TransformConstraintTimeline$2.ENTRIES])}for(let d=0,p=n.readInt(!0);d<p;d++){const m=n.readInt(!0),g=t.pathConstraints[m];for(let _=0,y=n.readInt(!0);_<y;_++){const v=n.readByte(),N=n.readInt(!0);switch(v){case _SkeletonBinary.PATH_POSITION:case _SkeletonBinary.PATH_SPACING:{let w,k=1;v==_SkeletonBinary.PATH_SPACING?(w=new PathConstraintSpacingTimeline$2(N),(g.spacingMode==SpacingMode$2.Length||g.spacingMode==SpacingMode$2.Fixed)&&(k=r)):(w=new PathConstraintPositionTimeline$2(N),g.positionMode==PositionMode.Fixed&&(k=r)),w.pathConstraintIndex=m;for(let U=0;U<N;U++)w.setFrame(U,n.readFloat(),n.readFloat()*k),U<N-1&&this.readCurve(n,U,w);s.push(w),o=Math.max(o,w.frames[(N-1)*PathConstraintPositionTimeline$2.ENTRIES]);break}case _SkeletonBinary.PATH_MIX:{const w=new PathConstraintMixTimeline$2(N);w.pathConstraintIndex=m;for(let k=0;k<N;k++)w.setFrame(k,n.readFloat(),n.readFloat(),n.readFloat()),k<N-1&&this.readCurve(n,k,w);s.push(w),o=Math.max(o,w.frames[(N-1)*PathConstraintMixTimeline$2.ENTRIES]);break}}}}for(let d=0,p=n.readInt(!0);d<p;d++){const m=t.skins[n.readInt(!0)];for(let g=0,_=n.readInt(!0);g<_;g++){const y=n.readInt(!0);for(let v=0,N=n.readInt(!0);v<N;v++){const w=m.getAttachment(y,n.readStringRef()),k=w.bones!=null,U=w.vertices,ee=k?U.length/3*2:U.length,ie=n.readInt(!0),se=new DeformTimeline$2(ie);se.slotIndex=y,se.attachment=w;for(let oe=0;oe<ie;oe++){const le=n.readFloat();let ue,he=n.readInt(!0);if(he==0)ue=k?Utils.newFloatArray(ee):U;else{ue=Utils.newFloatArray(ee);const pe=n.readInt(!0);if(he+=pe,r==1)for(let de=pe;de<he;de++)ue[de]=n.readFloat();else for(let de=pe;de<he;de++)ue[de]=n.readFloat()*r;if(!k)for(let de=0,fe=ue.length;de<fe;de++)ue[de]+=U[de]}se.setFrame(oe,le,ue),oe<ie-1&&this.readCurve(n,oe,se)}s.push(se),o=Math.max(o,se.frames[ie-1])}}}const a=n.readInt(!0);if(a>0){const d=new DrawOrderTimeline$2(a),p=t.slots.length;for(let m=0;m<a;m++){const g=n.readFloat(),_=n.readInt(!0),y=Utils.newArray(p,0);for(let k=p-1;k>=0;k--)y[k]=-1;const v=Utils.newArray(p-_,0);let N=0,w=0;for(let k=0;k<_;k++){const U=n.readInt(!0);for(;N!=U;)v[w++]=N++;y[N+n.readInt(!0)]=N++}for(;N<p;)v[w++]=N++;for(let k=p-1;k>=0;k--)y[k]==-1&&(y[k]=v[--w]);d.setFrame(m,g,y)}s.push(d),o=Math.max(o,d.frames[a-1])}const u=n.readInt(!0);if(u>0){const d=new EventTimeline$2(u);for(let p=0;p<u;p++){const m=n.readFloat(),g=t.events[n.readInt(!0)],_=new Event$3(m,g);_.intValue=n.readInt(!1),_.floatValue=n.readFloat(),_.stringValue=n.readBoolean()?n.readString():g.stringValue,_.data.audioPath!=null&&(_.volume=n.readFloat(),_.balance=n.readFloat()),d.setFrame(p,_)}s.push(d),o=Math.max(o,d.frames[u-1])}return new Animation$4(e,s,o)}readCurve(n,e,t){switch(n.readByte()){case _SkeletonBinary.CURVE_STEPPED:t.setStepped(e);break;case _SkeletonBinary.CURVE_BEZIER:this.setCurve(t,e,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat());break}}setCurve(n,e,t,s,r,o){n.setCurve(e,t,s,r,o)}};let SkeletonBinary$1=_SkeletonBinary;SkeletonBinary$1.AttachmentTypeValues=[0,1,2,3,4,5,6];SkeletonBinary$1.TransformModeValues=[TransformMode.Normal,TransformMode.OnlyTranslation,TransformMode.NoRotationOrReflection,TransformMode.NoScale,TransformMode.NoScaleOrReflection];SkeletonBinary$1.PositionModeValues=[PositionMode.Fixed,PositionMode.Percent];SkeletonBinary$1.SpacingModeValues=[SpacingMode$2.Length,SpacingMode$2.Fixed,SpacingMode$2.Percent];SkeletonBinary$1.RotateModeValues=[RotateMode.Tangent,RotateMode.Chain,RotateMode.ChainScale];SkeletonBinary$1.BlendModeValues=[BLEND_MODES.NORMAL,BLEND_MODES.ADD,BLEND_MODES.MULTIPLY,BLEND_MODES.SCREEN];SkeletonBinary$1.BONE_ROTATE=0;SkeletonBinary$1.BONE_TRANSLATE=1;SkeletonBinary$1.BONE_SCALE=2;SkeletonBinary$1.BONE_SHEAR=3;SkeletonBinary$1.SLOT_ATTACHMENT=0;SkeletonBinary$1.SLOT_COLOR=1;SkeletonBinary$1.SLOT_TWO_COLOR=2;SkeletonBinary$1.PATH_POSITION=0;SkeletonBinary$1.PATH_SPACING=1;SkeletonBinary$1.PATH_MIX=2;SkeletonBinary$1.CURVE_LINEAR=0;SkeletonBinary$1.CURVE_STEPPED=1;SkeletonBinary$1.CURVE_BEZIER=2;let LinkedMesh$4=class{constructor(e,t,s,r,o){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=r,this.inheritDeform=o}},Vertices$1=class{constructor(e=null,t=null){this.bones=e,this.vertices=t}},SkeletonJson$2=class{constructor(e){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}readSkeletonData(e){const t=this.scale,s=new SkeletonData$2,r=typeof e=="string"?JSON.parse(e):e,o=r.skeleton;if(o!=null){if(s.hash=o.hash,s.version=o.spine,s.version.substr(0,3)!=="3.8"){const h=`Spine 3.8 loader cant load version ${o.spine}. Please configure your pixi-spine bundle`;console.error(h)}s.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),s.x=o.x,s.y=o.y,s.width=o.width,s.height=o.height,s.fps=o.fps,s.imagesPath=o.images}if(r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let a=null;const u=this.getValue(c,"parent",null);if(u!=null&&(a=s.findBone(u),a==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData$2(s.bones.length,c.name,a);d.length=this.getValue(c,"length",0)*t,d.x=this.getValue(c,"x",0)*t,d.y=this.getValue(c,"y",0)*t,d.rotation=this.getValue(c,"rotation",0),d.scaleX=this.getValue(c,"scaleX",1),d.scaleY=this.getValue(c,"scaleY",1),d.shearX=this.getValue(c,"shearX",0),d.shearY=this.getValue(c,"shearY",0),d.transformMode=SkeletonJson$2.transformModeFromString(this.getValue(c,"transform","normal")),d.skinRequired=this.getValue(c,"skin",!1),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],a=c.name,u=c.bone,d=s.findBone(u);if(d==null)throw new Error(`Slot bone not found: ${u}`);const p=new SlotData$2(s.slots.length,a,d),m=this.getValue(c,"color",null);m!=null&&p.color.setFromString(m);const g=this.getValue(c,"dark",null);g!=null&&(p.darkColor=new Color(1,1,1,1),p.darkColor.setFromString(g)),p.attachmentName=this.getValue(c,"attachment",null),p.blendMode=SkeletonJson$2.blendModeFromString(this.getValue(c,"blend","normal")),s.slots.push(p)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],a=new IkConstraintData$2(c.name);a.order=this.getValue(c,"order",0),a.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`IK bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findBone(u),a.target==null)throw new Error(`IK target bone not found: ${u}`);a.mix=this.getValue(c,"mix",1),a.softness=this.getValue(c,"softness",0)*t,a.bendDirection=this.getValue(c,"bendPositive",!0)?1:-1,a.compress=this.getValue(c,"compress",!1),a.stretch=this.getValue(c,"stretch",!1),a.uniform=this.getValue(c,"uniform",!1),s.ikConstraints.push(a)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],a=new TransformConstraintData$2(c.name);a.order=this.getValue(c,"order",0),a.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`Transform constraint bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findBone(u),a.target==null)throw new Error(`Transform constraint target bone not found: ${u}`);a.local=this.getValue(c,"local",!1),a.relative=this.getValue(c,"relative",!1),a.offsetRotation=this.getValue(c,"rotation",0),a.offsetX=this.getValue(c,"x",0)*t,a.offsetY=this.getValue(c,"y",0)*t,a.offsetScaleX=this.getValue(c,"scaleX",0),a.offsetScaleY=this.getValue(c,"scaleY",0),a.offsetShearY=this.getValue(c,"shearY",0),a.rotateMix=this.getValue(c,"rotateMix",1),a.translateMix=this.getValue(c,"translateMix",1),a.scaleMix=this.getValue(c,"scaleMix",1),a.shearMix=this.getValue(c,"shearMix",1),s.transformConstraints.push(a)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],a=new PathConstraintData$2(c.name);a.order=this.getValue(c,"order",0),a.skinRequired=this.getValue(c,"skin",!1);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`Transform constraint bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findSlot(u),a.target==null)throw new Error(`Path target slot not found: ${u}`);a.positionMode=SkeletonJson$2.positionModeFromString(this.getValue(c,"positionMode","percent")),a.spacingMode=SkeletonJson$2.spacingModeFromString(this.getValue(c,"spacingMode","length")),a.rotateMode=SkeletonJson$2.rotateModeFromString(this.getValue(c,"rotateMode","tangent")),a.offsetRotation=this.getValue(c,"rotation",0),a.position=this.getValue(c,"position",0),a.positionMode==PositionMode.Fixed&&(a.position*=t),a.spacing=this.getValue(c,"spacing",0),(a.spacingMode==SpacingMode$2.Length||a.spacingMode==SpacingMode$2.Fixed)&&(a.spacing*=t),a.rotateMix=this.getValue(c,"rotateMix",1),a.translateMix=this.getValue(c,"translateMix",1),s.pathConstraints.push(a)}if(r.skins)for(let h=0;h<r.skins.length;h++){const c=r.skins[h],a=new Skin$2(c.name);if(c.bones)for(let u=0;u<c.bones.length;u++){const d=s.findBone(c.bones[u]);if(d==null)throw new Error(`Skin bone not found: ${c.bones[h]}`);a.bones.push(d)}if(c.ik)for(let u=0;u<c.ik.length;u++){const d=s.findIkConstraint(c.ik[u]);if(d==null)throw new Error(`Skin IK constraint not found: ${c.ik[h]}`);a.constraints.push(d)}if(c.transform)for(let u=0;u<c.transform.length;u++){const d=s.findTransformConstraint(c.transform[u]);if(d==null)throw new Error(`Skin transform constraint not found: ${c.transform[h]}`);a.constraints.push(d)}if(c.path)for(let u=0;u<c.path.length;u++){const d=s.findPathConstraint(c.path[u]);if(d==null)throw new Error(`Skin path constraint not found: ${c.path[h]}`);a.constraints.push(d)}for(const u in c.attachments){const d=s.findSlot(u);if(d==null)throw new Error(`Slot not found: ${u}`);const p=c.attachments[u];for(const m in p){const g=this.readAttachment(p[m],a,d.index,m,s);g!=null&&a.setAttachment(d.index,m,g)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const a=this.linkedMeshes[h],u=a.skin==null?s.defaultSkin:s.findSkin(a.skin);if(u==null)throw new Error(`Skin not found: ${a.skin}`);const d=u.getAttachment(a.slotIndex,a.parent);if(d==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.deformAttachment=a.inheritDeform?d:a.mesh,a.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],a=new EventData$2(h);a.intValue=this.getValue(c,"int",0),a.floatValue=this.getValue(c,"float",0),a.stringValue=this.getValue(c,"string",""),a.audioPath=this.getValue(c,"audio",null),a.audioPath!=null&&(a.volume=this.getValue(c,"volume",1),a.balance=this.getValue(c,"balance",0)),s.events.push(a)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(e,t,s,r,o){const h=this.scale;switch(r=this.getValue(e,"name",r),this.getValue(e,"type","region")){case"region":{const a=this.getValue(e,"path",r),u=this.attachmentLoader.newRegionAttachment(t,r,a);if(u==null)return null;u.path=a,u.x=this.getValue(e,"x",0)*h,u.y=this.getValue(e,"y",0)*h,u.scaleX=this.getValue(e,"scaleX",1),u.scaleY=this.getValue(e,"scaleY",1),u.rotation=this.getValue(e,"rotation",0),u.width=e.width*h,u.height=e.height*h;const d=this.getValue(e,"color",null);return d!=null&&u.color.setFromString(d),u}case"boundingbox":{const a=this.attachmentLoader.newBoundingBoxAttachment(t,r);if(a==null)return null;this.readVertices(e,a,e.vertexCount<<1);const u=this.getValue(e,"color",null);return u!=null&&a.color.setFromString(u),a}case"mesh":case"linkedmesh":{const a=this.getValue(e,"path",r),u=this.attachmentLoader.newMeshAttachment(t,r,a);if(u==null)return null;u.path=a;const d=this.getValue(e,"color",null);d!=null&&u.color.setFromString(d),u.width=this.getValue(e,"width",0)*h,u.height=this.getValue(e,"height",0)*h;const p=this.getValue(e,"parent",null);if(p!=null)return this.linkedMeshes.push(new LinkedMesh$3(u,this.getValue(e,"skin",null),s,p,this.getValue(e,"deform",!0))),u;const m=e.uvs;return this.readVertices(e,u,m.length),u.triangles=e.triangles,u.regionUVs=new Float32Array(m),u.edges=this.getValue(e,"edges",null),u.hullLength=this.getValue(e,"hull",0)*2,u}case"path":{const a=this.attachmentLoader.newPathAttachment(t,r);if(a==null)return null;a.closed=this.getValue(e,"closed",!1),a.constantSpeed=this.getValue(e,"constantSpeed",!0);const u=e.vertexCount;this.readVertices(e,a,u<<1);const d=Utils.newArray(u/3,0);for(let m=0;m<e.lengths.length;m++)d[m]=e.lengths[m]*h;a.lengths=d;const p=this.getValue(e,"color",null);return p!=null&&a.color.setFromString(p),a}case"point":{const a=this.attachmentLoader.newPointAttachment(t,r);if(a==null)return null;a.x=this.getValue(e,"x",0)*h,a.y=this.getValue(e,"y",0)*h,a.rotation=this.getValue(e,"rotation",0);const u=this.getValue(e,"color",null);return u!=null&&a.color.setFromString(u),a}case"clipping":{const a=this.attachmentLoader.newClippingAttachment(t,r);if(a==null)return null;const u=this.getValue(e,"end",null);if(u!=null){const m=o.findSlot(u);if(m==null)throw new Error(`Clipping end slot not found: ${u}`);a.endSlot=m}const d=e.vertexCount;this.readVertices(e,a,d<<1);const p=this.getValue(e,"color",null);return p!=null&&a.color.setFromString(p),a}}return null}readVertices(e,t,s){const r=this.scale;t.worldVerticesLength=s;const o=e.vertices;if(s==o.length){const a=Utils.toFloatArray(o);if(r!=1)for(let u=0,d=o.length;u<d;u++)a[u]*=r;t.vertices=a;return}const h=new Array,c=new Array;for(let a=0,u=o.length;a<u;){const d=o[a++];c.push(d);for(let p=a+d*4;a<p;a+=4)c.push(o[a]),h.push(o[a+1]*r),h.push(o[a+2]*r),h.push(o[a+3])}t.bones=c,t.vertices=Utils.toFloatArray(h)}readAnimation(e,t,s){const r=this.scale,o=new Array;let h=0;if(e.slots)for(const a in e.slots){const u=e.slots[a],d=s.findSlotIndex(a);if(d==-1)throw new Error(`Slot not found: ${a}`);for(const p in u){const m=u[p];if(p=="attachment"){const g=new AttachmentTimeline$2(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y];g.setFrame(_++,this.getValue(v,"time",0),v.name)}o.push(g),h=Math.max(h,g.frames[g.getFrameCount()-1])}else if(p=="color"){const g=new ColorTimeline$1(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y],N=new Color;N.setFromString(v.color||"ffffffff"),g.setFrame(_,this.getValue(v,"time",0),N.r,N.g,N.b,N.a),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*ColorTimeline$1.ENTRIES])}else if(p=="twoColor"){const g=new TwoColorTimeline$1(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y],N=new Color,w=new Color;N.setFromString(v.light),w.setFromString(v.dark),g.setFrame(_,this.getValue(v,"time",0),N.r,N.g,N.b,N.a,w.r,w.g,w.b),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TwoColorTimeline$1.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${p} (${a})`)}}if(e.bones)for(const a in e.bones){const u=e.bones[a],d=s.findBoneIndex(a);if(d==-1)throw new Error(`Bone not found: ${a}`);for(const p in u){const m=u[p];if(p==="rotate"){const g=new RotateTimeline$2(m.length);g.boneIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y];g.setFrame(_,this.getValue(v,"time",0),this.getValue(v,"angle",0)),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*RotateTimeline$2.ENTRIES])}else if(p==="translate"||p==="scale"||p==="shear"){let g=null,_=1,y=0;p==="scale"?(g=new ScaleTimeline$2(m.length),y=1):p==="shear"?g=new ShearTimeline$2(m.length):(g=new TranslateTimeline$2(m.length),_=r),g.boneIndex=d;let v=0;for(let N=0;N<m.length;N++){const w=m[N],k=this.getValue(w,"x",y),U=this.getValue(w,"y",y);g.setFrame(v,this.getValue(w,"time",0),k*_,U*_),this.readCurve(w,g,v),v++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TranslateTimeline$2.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${p} (${a})`)}}if(e.ik)for(const a in e.ik){const u=e.ik[a],d=s.findIkConstraint(a),p=new IkConstraintTimeline$2(u.length);p.ikConstraintIndex=s.ikConstraints.indexOf(d);let m=0;for(let g=0;g<u.length;g++){const _=u[g];p.setFrame(m,this.getValue(_,"time",0),this.getValue(_,"mix",1),this.getValue(_,"softness",0)*r,this.getValue(_,"bendPositive",!0)?1:-1,this.getValue(_,"compress",!1),this.getValue(_,"stretch",!1)),this.readCurve(_,p,m),m++}o.push(p),h=Math.max(h,p.frames[(p.getFrameCount()-1)*IkConstraintTimeline$2.ENTRIES])}if(e.transform)for(const a in e.transform){const u=e.transform[a],d=s.findTransformConstraint(a),p=new TransformConstraintTimeline$2(u.length);p.transformConstraintIndex=s.transformConstraints.indexOf(d);let m=0;for(let g=0;g<u.length;g++){const _=u[g];p.setFrame(m,this.getValue(_,"time",0),this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1),this.getValue(_,"scaleMix",1),this.getValue(_,"shearMix",1)),this.readCurve(_,p,m),m++}o.push(p),h=Math.max(h,p.frames[(p.getFrameCount()-1)*TransformConstraintTimeline$2.ENTRIES])}if(e.path)for(const a in e.path){const u=e.path[a],d=s.findPathConstraintIndex(a);if(d==-1)throw new Error(`Path constraint not found: ${a}`);const p=s.pathConstraints[d];for(const m in u){const g=u[m];if(m==="position"||m==="spacing"){let _=null,y=1;m==="spacing"?(_=new PathConstraintSpacingTimeline$2(g.length),(p.spacingMode==SpacingMode$2.Length||p.spacingMode==SpacingMode$2.Fixed)&&(y=r)):(_=new PathConstraintPositionTimeline$2(g.length),p.positionMode==PositionMode.Fixed&&(y=r)),_.pathConstraintIndex=d;let v=0;for(let N=0;N<g.length;N++){const w=g[N];_.setFrame(v,this.getValue(w,"time",0),this.getValue(w,m,0)*y),this.readCurve(w,_,v),v++}o.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintPositionTimeline$2.ENTRIES])}else if(m==="mix"){const _=new PathConstraintMixTimeline$2(g.length);_.pathConstraintIndex=d;let y=0;for(let v=0;v<g.length;v++){const N=g[v];_.setFrame(y,this.getValue(N,"time",0),this.getValue(N,"rotateMix",1),this.getValue(N,"translateMix",1)),this.readCurve(N,_,y),y++}o.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintMixTimeline$2.ENTRIES])}}}if(e.deform)for(const a in e.deform){const u=e.deform[a],d=s.findSkin(a);if(d!=null)for(const p in u){const m=u[p],g=s.findSlotIndex(p);if(g==-1)throw new Error(`Slot not found: ${m.name}`);for(const _ in m){const y=m[_],v=d.getAttachment(g,_);if(v==null)throw new Error(`Deform attachment not found: ${y.name}`);const N=v.bones!=null,w=v.vertices,k=N?w.length/3*2:w.length,U=new DeformTimeline$2(y.length);U.slotIndex=g,U.attachment=v;let ee=0;for(let ie=0;ie<y.length;ie++){const se=y[ie];let oe;const le=this.getValue(se,"vertices",null);if(le==null)oe=N?Utils.newFloatArray(k):w;else{oe=Utils.newFloatArray(k);const ue=this.getValue(se,"offset",0);if(Utils.arrayCopy(le,0,oe,ue,le.length),r!=1)for(let he=ue,pe=he+le.length;he<pe;he++)oe[he]*=r;if(!N)for(let he=0;he<k;he++)oe[he]+=w[he]}U.setFrame(ee,this.getValue(se,"time",0),oe),this.readCurve(se,U,ee),ee++}o.push(U),h=Math.max(h,U.frames[U.getFrameCount()-1])}}}let c=e.drawOrder;if(c==null&&(c=e.draworder),c!=null){const a=new DrawOrderTimeline$2(c.length),u=s.slots.length;let d=0;for(let p=0;p<c.length;p++){const m=c[p];let g=null;const _=this.getValue(m,"offsets",null);if(_!=null){g=Utils.newArray(u,-1);const y=Utils.newArray(u-_.length,0);let v=0,N=0;for(let w=0;w<_.length;w++){const k=_[w],U=s.findSlotIndex(k.slot);if(U==-1)throw new Error(`Slot not found: ${k.slot}`);for(;v!=U;)y[N++]=v++;g[v+k.offset]=v++}for(;v<u;)y[N++]=v++;for(let w=u-1;w>=0;w--)g[w]==-1&&(g[w]=y[--N])}a.setFrame(d++,this.getValue(m,"time",0),g)}o.push(a),h=Math.max(h,a.frames[a.getFrameCount()-1])}if(e.events){const a=new EventTimeline$2(e.events.length);let u=0;for(let d=0;d<e.events.length;d++){const p=e.events[d],m=s.findEvent(p.name);if(m==null)throw new Error(`Event not found: ${p.name}`);const g=new Event$3(Utils.toSinglePrecision(this.getValue(p,"time",0)),m);g.intValue=this.getValue(p,"int",m.intValue),g.floatValue=this.getValue(p,"float",m.floatValue),g.stringValue=this.getValue(p,"string",m.stringValue),g.data.audioPath!=null&&(g.volume=this.getValue(p,"volume",1),g.balance=this.getValue(p,"balance",0)),a.setFrame(u++,g)}o.push(a),h=Math.max(h,a.frames[a.getFrameCount()-1])}if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$4(t,o,h))}readCurve(e,t,s){if(e.hasOwnProperty("curve"))if(e.curve==="stepped")t.setStepped(s);else{const r=e.curve;t.setCurve(s,r,this.getValue(e,"c2",0),this.getValue(e,"c3",1),this.getValue(e,"c4",1))}}getValue(e,t,s){return e[t]!==void 0?e[t]:s}static blendModeFromString(e){if(e=e.toLowerCase(),e=="normal")return BLEND_MODES.NORMAL;if(e=="additive")return BLEND_MODES.ADD;if(e=="multiply")return BLEND_MODES.MULTIPLY;if(e=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${e}`)}static positionModeFromString(e){if(e=e.toLowerCase(),e=="fixed")return PositionMode.Fixed;if(e=="percent")return PositionMode.Percent;throw new Error(`Unknown position mode: ${e}`)}static spacingModeFromString(e){if(e=e.toLowerCase(),e=="length")return SpacingMode$2.Length;if(e=="fixed")return SpacingMode$2.Fixed;if(e=="percent")return SpacingMode$2.Percent;throw new Error(`Unknown position mode: ${e}`)}static rotateModeFromString(e){if(e=e.toLowerCase(),e=="tangent")return RotateMode.Tangent;if(e=="chain")return RotateMode.Chain;if(e=="chainscale")return RotateMode.ChainScale;throw new Error(`Unknown rotate mode: ${e}`)}static transformModeFromString(e){if(e=e.toLowerCase(),e=="normal")return TransformMode.Normal;if(e=="onlytranslation")return TransformMode.OnlyTranslation;if(e=="norotationorreflection")return TransformMode.NoRotationOrReflection;if(e=="noscale")return TransformMode.NoScale;if(e=="noscaleorreflection")return TransformMode.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${e}`)}},LinkedMesh$3=class{constructor(e,t,s,r,o){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=r,this.inheritDeform=o}},Attachment$1=class{constructor(e){if(e==null)throw new Error("name cannot be null.");this.name=e}};const _VertexAttachment$1=class extends Attachment$1{constructor(e){super(e),this.id=(_VertexAttachment$1.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(e,t){this.computeWorldVertices(e,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(e,t,s,r,o,h){s=o+(s>>1)*h;const c=e.bone.skeleton,a=e.attachmentVertices;let u=this.vertices;const d=this.bones;if(d==null){a.length>0&&(u=a);const _=e.bone.matrix,y=_.tx,v=_.ty,N=_.a,w=_.c,k=_.b,U=_.d;for(let ee=t,ie=o;ie<s;ee+=2,ie+=h){const se=u[ee],oe=u[ee+1];r[ie]=se*N+oe*w+y,r[ie+1]=se*k+oe*U+v}return}let p=0,m=0;for(let _=0;_<t;_+=2){const y=d[p];p+=y+1,m+=y}const g=c.bones;if(a.length==0)for(let _=o,y=m*3;_<s;_+=h){let v=0,N=0,w=d[p++];for(w+=p;p<w;p++,y+=3){const k=g[d[p]].matrix,U=u[y],ee=u[y+1],ie=u[y+2];v+=(U*k.a+ee*k.c+k.tx)*ie,N+=(U*k.b+ee*k.d+k.ty)*ie}r[_]=v,r[_+1]=N}else{const _=a;for(let y=o,v=m*3,N=m<<1;y<s;y+=h){let w=0,k=0,U=d[p++];for(U+=p;p<U;p++,v+=3,N+=2){const ee=g[d[p]].matrix,ie=u[v]+_[N],se=u[v+1]+_[N+1],oe=u[v+2];w+=(ie*ee.a+se*ee.c+ee.tx)*oe,k+=(ie*ee.b+se*ee.d+ee.ty)*oe}r[y]=w,r[y+1]=k}}}applyDeform(e){return this==e}};let VertexAttachment$1=_VertexAttachment$1;VertexAttachment$1.nextID=0;let BoundingBoxAttachment$1=class extends VertexAttachment$1{constructor(e){super(e),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}},ClippingAttachment$1=class extends VertexAttachment$1{constructor(e){super(e),this.type=AttachmentType.Clipping,this.color=new Color(.2275,.2275,.8078,1)}},MeshAttachment$1=class extends VertexAttachment$1{constructor(e){super(e),this.type=AttachmentType.Mesh,this.color=new Color(1,1,1,1),this.inheritDeform=!1,this.tempColor=new Color(0,0,0,0)}applyDeform(e){return this==e||this.inheritDeform&&this.parentMesh==e}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e!=null&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}},PathAttachment$1=class extends VertexAttachment$1{constructor(e){super(e),this.type=AttachmentType.Path,this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}},PointAttachment$1=class extends VertexAttachment$1{constructor(e){super(e),this.type=AttachmentType.Point,this.color=new Color(.38,.94,0,1)}computeWorldPosition(e,t){const s=e.matrix;return t.x=this.x*s.a+this.y*s.c+e.worldX,t.y=this.x*s.b+this.y*s.d+e.worldY,t}computeWorldRotation(e){const t=e.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),o=s*t.a+r*t.c,h=s*t.b+r*t.d;return Math.atan2(h,o)*MathUtils.radDeg}};class Slot{constructor(e,t){if(this.attachmentVertices=new Array,e==null)throw new Error("data cannot be null.");if(t==null)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new Color,this.darkColor=e.darkColor==null?null:new Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(e){this.attachment!=e&&(this.attachment=e,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(e){this.attachmentTime=this.bone.skeleton.time-e}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}}const _RegionAttachment$1=class extends Attachment$1{constructor(e){super(e),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1)}updateOffset(){const e=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*e,r=-this.height/2*this.scaleY+this.region.offsetY*t,o=s+this.region.width*e,h=r+this.region.height*t,c=this.rotation*Math.PI/180,a=Math.cos(c),u=Math.sin(c),d=s*a+this.x,p=s*u,m=r*a+this.y,g=r*u,_=o*a+this.x,y=o*u,v=h*a+this.y,N=h*u,w=this.offset;w[_RegionAttachment$1.OX1]=d-g,w[_RegionAttachment$1.OY1]=m+p,w[_RegionAttachment$1.OX2]=d-N,w[_RegionAttachment$1.OY2]=v+p,w[_RegionAttachment$1.OX3]=_-N,w[_RegionAttachment$1.OY3]=v+y,w[_RegionAttachment$1.OX4]=_-g,w[_RegionAttachment$1.OY4]=m+y}setRegion(e){this.region=e;const t=this.uvs;e.rotate?(t[2]=e.u,t[3]=e.v2,t[4]=e.u,t[5]=e.v,t[6]=e.u2,t[7]=e.v,t[0]=e.u2,t[1]=e.v2):(t[0]=e.u,t[1]=e.v2,t[2]=e.u,t[3]=e.v,t[4]=e.u2,t[5]=e.v,t[6]=e.u2,t[7]=e.v2)}computeWorldVertices(e,t,s,r){const o=this.offset,h=e instanceof Slot?e.bone.matrix:e.matrix,c=h.tx,a=h.ty,u=h.a,d=h.c,p=h.b,m=h.d;let g=0,_=0;g=o[_RegionAttachment$1.OX1],_=o[_RegionAttachment$1.OY1],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$1.OX2],_=o[_RegionAttachment$1.OY2],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$1.OX3],_=o[_RegionAttachment$1.OY3],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a,s+=r,g=o[_RegionAttachment$1.OX4],_=o[_RegionAttachment$1.OY4],t[s]=g*u+_*d+c,t[s+1]=g*p+_*m+a}};let RegionAttachment$1=_RegionAttachment$1;RegionAttachment$1.OX1=0;RegionAttachment$1.OY1=1;RegionAttachment$1.OX2=2;RegionAttachment$1.OY2=3;RegionAttachment$1.OX3=4;RegionAttachment$1.OY3=5;RegionAttachment$1.OX4=6;RegionAttachment$1.OY4=7;RegionAttachment$1.X1=0;RegionAttachment$1.Y1=1;RegionAttachment$1.C1R=2;RegionAttachment$1.C1G=3;RegionAttachment$1.C1B=4;RegionAttachment$1.C1A=5;RegionAttachment$1.U1=6;RegionAttachment$1.V1=7;RegionAttachment$1.X2=8;RegionAttachment$1.Y2=9;RegionAttachment$1.C2R=10;RegionAttachment$1.C2G=11;RegionAttachment$1.C2B=12;RegionAttachment$1.C2A=13;RegionAttachment$1.U2=14;RegionAttachment$1.V2=15;RegionAttachment$1.X3=16;RegionAttachment$1.Y3=17;RegionAttachment$1.C3R=18;RegionAttachment$1.C3G=19;RegionAttachment$1.C3B=20;RegionAttachment$1.C3A=21;RegionAttachment$1.U3=22;RegionAttachment$1.V3=23;RegionAttachment$1.X4=24;RegionAttachment$1.Y4=25;RegionAttachment$1.C4R=26;RegionAttachment$1.C4G=27;RegionAttachment$1.C4B=28;RegionAttachment$1.C4A=29;RegionAttachment$1.U4=30;RegionAttachment$1.V4=31;new PowOut(2);let Animation$3=class{constructor(e,t,s){if(e==null)throw new Error("name cannot be null.");if(t==null)throw new Error("timelines cannot be null.");this.name=e,this.timelines=t,this.duration=s}apply(e,t,s,r,o,h,c,a){if(e==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,t>0&&(t%=this.duration));const u=this.timelines;for(let d=0,p=u.length;d<p;d++)u[d].apply(e,t,s,o,h,c,a)}static binarySearch(e,t,s=1){let r=0,o=e.length/s-2;if(o==0)return s;let h=o>>>1;for(;;){if(e[(h+1)*s]<=t?r=h+1:o=h,r==o)return(r+1)*s;h=r+o>>>1}}static linearSearch(e,t,s){for(let r=0,o=e.length-s;r<=o;r+=s)if(e[r]>t)return r;return-1}};const _CurveTimeline=class{constructor(n){if(n<=0)throw new Error(`frameCount must be > 0: ${n}`);this.curves=Utils.newFloatArray((n-1)*_CurveTimeline.BEZIER_SIZE)}getFrameCount(){return this.curves.length/_CurveTimeline.BEZIER_SIZE+1}setLinear(n){this.curves[n*_CurveTimeline.BEZIER_SIZE]=_CurveTimeline.LINEAR}setStepped(n){this.curves[n*_CurveTimeline.BEZIER_SIZE]=_CurveTimeline.STEPPED}getCurveType(n){const e=n*_CurveTimeline.BEZIER_SIZE;if(e==this.curves.length)return _CurveTimeline.LINEAR;const t=this.curves[e];return t==_CurveTimeline.LINEAR?_CurveTimeline.LINEAR:t==_CurveTimeline.STEPPED?_CurveTimeline.STEPPED:_CurveTimeline.BEZIER}setCurve(n,e,t,s,r){const o=(-e*2+s)*.03,h=(-t*2+r)*.03,c=((e-s)*3+1)*.006,a=((t-r)*3+1)*.006;let u=o*2+c,d=h*2+a,p=e*.3+o+c*.16666667,m=t*.3+h+a*.16666667,g=n*_CurveTimeline.BEZIER_SIZE;const _=this.curves;_[g++]=_CurveTimeline.BEZIER;let y=p,v=m;for(let N=g+_CurveTimeline.BEZIER_SIZE-1;g<N;g+=2)_[g]=y,_[g+1]=v,p+=u,m+=d,u+=c,d+=a,y+=p,v+=m}getCurvePercent(n,e){e=MathUtils.clamp(e,0,1);const t=this.curves;let s=n*_CurveTimeline.BEZIER_SIZE;const r=t[s];if(r==_CurveTimeline.LINEAR)return e;if(r==_CurveTimeline.STEPPED)return 0;s++;let o=0;for(let c=s,a=s+_CurveTimeline.BEZIER_SIZE-1;s<a;s+=2)if(o=t[s],o>=e){let u,d;return s==c?(u=0,d=0):(u=t[s-2],d=t[s-1]),d+(t[s+1]-d)*(e-u)/(o-u)}const h=t[s-1];return h+(1-h)*(e-o)/(1-o)}};let CurveTimeline$1=_CurveTimeline;CurveTimeline$1.LINEAR=0;CurveTimeline$1.STEPPED=1;CurveTimeline$1.BEZIER=2;CurveTimeline$1.BEZIER_SIZE=10*2-1;const _RotateTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(n,e,t){n<<=1,this.frames[n]=e,this.frames[n+_RotateTimeline.ROTATION]=t}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.bones[this.boneIndex];if(t<c[0]){switch(o){case MixBlend.setup:a.rotation=a.data.rotation;return;case MixBlend.first:const _=a.data.rotation-a.rotation;a.rotation+=(_-(16384-(16384.499999999996-_/360|0))*360)*r}return}if(t>=c[c.length-_RotateTimeline.ENTRIES]){let _=c[c.length+_RotateTimeline.PREV_ROTATION];switch(o){case MixBlend.setup:a.rotation=a.data.rotation+_*r;break;case MixBlend.first:case MixBlend.replace:_+=a.data.rotation-a.rotation,_-=(16384-(16384.499999999996-_/360|0))*360;case MixBlend.add:a.rotation+=_*r}return}const u=Animation$3.binarySearch(c,t,_RotateTimeline.ENTRIES),d=c[u+_RotateTimeline.PREV_ROTATION],p=c[u],m=this.getCurvePercent((u>>1)-1,1-(t-p)/(c[u+_RotateTimeline.PREV_TIME]-p));let g=c[u+_RotateTimeline.ROTATION]-d;switch(g=d+(g-(16384-(16384.499999999996-g/360|0))*360)*m,o){case MixBlend.setup:a.rotation=a.data.rotation+(g-(16384-(16384.499999999996-g/360|0))*360)*r;break;case MixBlend.first:case MixBlend.replace:g+=a.data.rotation-a.rotation;case MixBlend.add:a.rotation+=(g-(16384-(16384.499999999996-g/360|0))*360)*r}}};let RotateTimeline$1=_RotateTimeline;RotateTimeline$1.ENTRIES=2;RotateTimeline$1.PREV_TIME=-2;RotateTimeline$1.PREV_ROTATION=-1;RotateTimeline$1.ROTATION=1;const _TranslateTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TranslateTimeline.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(n,e,t,s){n*=_TranslateTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_TranslateTimeline.X]=t,this.frames[n+_TranslateTimeline.Y]=s}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.bones[this.boneIndex];if(t<c[0]){switch(o){case MixBlend.setup:a.x=a.data.x,a.y=a.data.y;return;case MixBlend.first:a.x+=(a.data.x-a.x)*r,a.y+=(a.data.y-a.y)*r}return}let u=0,d=0;if(t>=c[c.length-_TranslateTimeline.ENTRIES])u=c[c.length+_TranslateTimeline.PREV_X],d=c[c.length+_TranslateTimeline.PREV_Y];else{const p=Animation$3.binarySearch(c,t,_TranslateTimeline.ENTRIES);u=c[p+_TranslateTimeline.PREV_X],d=c[p+_TranslateTimeline.PREV_Y];const m=c[p],g=this.getCurvePercent(p/_TranslateTimeline.ENTRIES-1,1-(t-m)/(c[p+_TranslateTimeline.PREV_TIME]-m));u+=(c[p+_TranslateTimeline.X]-u)*g,d+=(c[p+_TranslateTimeline.Y]-d)*g}switch(o){case MixBlend.setup:a.x=a.data.x+u*r,a.y=a.data.y+d*r;break;case MixBlend.first:case MixBlend.replace:a.x+=(a.data.x+u-a.x)*r,a.y+=(a.data.y+d-a.y)*r;break;case MixBlend.add:a.x+=u*r,a.y+=d*r}}};let TranslateTimeline$1=_TranslateTimeline;TranslateTimeline$1.ENTRIES=3;TranslateTimeline$1.PREV_TIME=-3;TranslateTimeline$1.PREV_X=-2;TranslateTimeline$1.PREV_Y=-1;TranslateTimeline$1.X=1;TranslateTimeline$1.Y=2;let ScaleTimeline$1=class extends TranslateTimeline$1{constructor(e){super(e)}getPropertyId(){return(2<<24)+this.boneIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(s<a[0]){switch(h){case MixBlend.setup:u.scaleX=u.data.scaleX,u.scaleY=u.data.scaleY;return;case MixBlend.first:u.scaleX+=(u.data.scaleX-u.scaleX)*o,u.scaleY+=(u.data.scaleY-u.scaleY)*o}return}let d=0,p=0;if(s>=a[a.length-ScaleTimeline$1.ENTRIES])d=a[a.length+ScaleTimeline$1.PREV_X]*u.data.scaleX,p=a[a.length+ScaleTimeline$1.PREV_Y]*u.data.scaleY;else{const m=Animation$3.binarySearch(a,s,ScaleTimeline$1.ENTRIES);d=a[m+ScaleTimeline$1.PREV_X],p=a[m+ScaleTimeline$1.PREV_Y];const g=a[m],_=this.getCurvePercent(m/ScaleTimeline$1.ENTRIES-1,1-(s-g)/(a[m+ScaleTimeline$1.PREV_TIME]-g));d=(d+(a[m+ScaleTimeline$1.X]-d)*_)*u.data.scaleX,p=(p+(a[m+ScaleTimeline$1.Y]-p)*_)*u.data.scaleY}if(o==1)h==MixBlend.add?(u.scaleX+=d-u.data.scaleX,u.scaleY+=p-u.data.scaleY):(u.scaleX=d,u.scaleY=p);else{let m=0,g=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:m=u.data.scaleX,g=u.data.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-g)*o;break;case MixBlend.first:case MixBlend.replace:m=u.scaleX,g=u.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-m)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-g)*o;break;case MixBlend.add:m=u.scaleX,g=u.scaleY,u.scaleX=m+(Math.abs(d)*MathUtils.signum(m)-u.data.scaleX)*o,u.scaleY=g+(Math.abs(p)*MathUtils.signum(g)-u.data.scaleY)*o}else switch(h){case MixBlend.setup:m=Math.abs(u.data.scaleX)*MathUtils.signum(d),g=Math.abs(u.data.scaleY)*MathUtils.signum(p),u.scaleX=m+(d-m)*o,u.scaleY=g+(p-g)*o;break;case MixBlend.first:case MixBlend.replace:m=Math.abs(u.scaleX)*MathUtils.signum(d),g=Math.abs(u.scaleY)*MathUtils.signum(p),u.scaleX=m+(d-m)*o,u.scaleY=g+(p-g)*o;break;case MixBlend.add:m=MathUtils.signum(d),g=MathUtils.signum(p),u.scaleX=Math.abs(u.scaleX)*m+(d-Math.abs(u.data.scaleX)*m)*o,u.scaleY=Math.abs(u.scaleY)*g+(p-Math.abs(u.data.scaleY)*g)*o}}}},ShearTimeline$1=class extends TranslateTimeline$1{constructor(e){super(e)}getPropertyId(){return(3<<24)+this.boneIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.bones[this.boneIndex];if(s<a[0]){switch(h){case MixBlend.setup:u.shearX=u.data.shearX,u.shearY=u.data.shearY;return;case MixBlend.first:u.shearX+=(u.data.shearX-u.shearX)*o,u.shearY+=(u.data.shearY-u.shearY)*o}return}let d=0,p=0;if(s>=a[a.length-ShearTimeline$1.ENTRIES])d=a[a.length+ShearTimeline$1.PREV_X],p=a[a.length+ShearTimeline$1.PREV_Y];else{const m=Animation$3.binarySearch(a,s,ShearTimeline$1.ENTRIES);d=a[m+ShearTimeline$1.PREV_X],p=a[m+ShearTimeline$1.PREV_Y];const g=a[m],_=this.getCurvePercent(m/ShearTimeline$1.ENTRIES-1,1-(s-g)/(a[m+ShearTimeline$1.PREV_TIME]-g));d=d+(a[m+ShearTimeline$1.X]-d)*_,p=p+(a[m+ShearTimeline$1.Y]-p)*_}switch(h){case MixBlend.setup:u.shearX=u.data.shearX+d*o,u.shearY=u.data.shearY+p*o;break;case MixBlend.first:case MixBlend.replace:u.shearX+=(u.data.shearX+d-u.shearX)*o,u.shearY+=(u.data.shearY+p-u.shearY)*o;break;case MixBlend.add:u.shearX+=d*o,u.shearY+=p*o}}};const _ColorTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_ColorTimeline.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(n,e,t,s,r,o){n*=_ColorTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_ColorTimeline.R]=t,this.frames[n+_ColorTimeline.G]=s,this.frames[n+_ColorTimeline.B]=r,this.frames[n+_ColorTimeline.A]=o}apply(n,e,t,s,r,o,h){const c=n.slots[this.slotIndex],a=this.frames;if(t<a[0]){switch(o){case MixBlend.setup:c.color.setFromColor(c.data.color);return;case MixBlend.first:const g=c.color,_=c.data.color;g.add((_.r-g.r)*r,(_.g-g.g)*r,(_.b-g.b)*r,(_.a-g.a)*r)}return}let u=0,d=0,p=0,m=0;if(t>=a[a.length-_ColorTimeline.ENTRIES]){const g=a.length;u=a[g+_ColorTimeline.PREV_R],d=a[g+_ColorTimeline.PREV_G],p=a[g+_ColorTimeline.PREV_B],m=a[g+_ColorTimeline.PREV_A]}else{const g=Animation$3.binarySearch(a,t,_ColorTimeline.ENTRIES);u=a[g+_ColorTimeline.PREV_R],d=a[g+_ColorTimeline.PREV_G],p=a[g+_ColorTimeline.PREV_B],m=a[g+_ColorTimeline.PREV_A];const _=a[g],y=this.getCurvePercent(g/_ColorTimeline.ENTRIES-1,1-(t-_)/(a[g+_ColorTimeline.PREV_TIME]-_));u+=(a[g+_ColorTimeline.R]-u)*y,d+=(a[g+_ColorTimeline.G]-d)*y,p+=(a[g+_ColorTimeline.B]-p)*y,m+=(a[g+_ColorTimeline.A]-m)*y}if(r==1)c.color.set(u,d,p,m);else{const g=c.color;o==MixBlend.setup&&g.setFromColor(c.data.color),g.add((u-g.r)*r,(d-g.g)*r,(p-g.b)*r,(m-g.a)*r)}}};let ColorTimeline=_ColorTimeline;ColorTimeline.ENTRIES=5;ColorTimeline.PREV_TIME=-5;ColorTimeline.PREV_R=-4;ColorTimeline.PREV_G=-3;ColorTimeline.PREV_B=-2;ColorTimeline.PREV_A=-1;ColorTimeline.R=1;ColorTimeline.G=2;ColorTimeline.B=3;ColorTimeline.A=4;const _TwoColorTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TwoColorTimeline.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(n,e,t,s,r,o,h,c,a){n*=_TwoColorTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_TwoColorTimeline.R]=t,this.frames[n+_TwoColorTimeline.G]=s,this.frames[n+_TwoColorTimeline.B]=r,this.frames[n+_TwoColorTimeline.A]=o,this.frames[n+_TwoColorTimeline.R2]=h,this.frames[n+_TwoColorTimeline.G2]=c,this.frames[n+_TwoColorTimeline.B2]=a}apply(n,e,t,s,r,o,h){const c=n.slots[this.slotIndex],a=this.frames;if(t<a[0]){switch(o){case MixBlend.setup:c.color.setFromColor(c.data.color),c.darkColor.setFromColor(c.data.darkColor);return;case MixBlend.first:const v=c.color,N=c.darkColor,w=c.data.color,k=c.data.darkColor;v.add((w.r-v.r)*r,(w.g-v.g)*r,(w.b-v.b)*r,(w.a-v.a)*r),N.add((k.r-N.r)*r,(k.g-N.g)*r,(k.b-N.b)*r,0)}return}let u=0,d=0,p=0,m=0,g=0,_=0,y=0;if(t>=a[a.length-_TwoColorTimeline.ENTRIES]){const v=a.length;u=a[v+_TwoColorTimeline.PREV_R],d=a[v+_TwoColorTimeline.PREV_G],p=a[v+_TwoColorTimeline.PREV_B],m=a[v+_TwoColorTimeline.PREV_A],g=a[v+_TwoColorTimeline.PREV_R2],_=a[v+_TwoColorTimeline.PREV_G2],y=a[v+_TwoColorTimeline.PREV_B2]}else{const v=Animation$3.binarySearch(a,t,_TwoColorTimeline.ENTRIES);u=a[v+_TwoColorTimeline.PREV_R],d=a[v+_TwoColorTimeline.PREV_G],p=a[v+_TwoColorTimeline.PREV_B],m=a[v+_TwoColorTimeline.PREV_A],g=a[v+_TwoColorTimeline.PREV_R2],_=a[v+_TwoColorTimeline.PREV_G2],y=a[v+_TwoColorTimeline.PREV_B2];const N=a[v],w=this.getCurvePercent(v/_TwoColorTimeline.ENTRIES-1,1-(t-N)/(a[v+_TwoColorTimeline.PREV_TIME]-N));u+=(a[v+_TwoColorTimeline.R]-u)*w,d+=(a[v+_TwoColorTimeline.G]-d)*w,p+=(a[v+_TwoColorTimeline.B]-p)*w,m+=(a[v+_TwoColorTimeline.A]-m)*w,g+=(a[v+_TwoColorTimeline.R2]-g)*w,_+=(a[v+_TwoColorTimeline.G2]-_)*w,y+=(a[v+_TwoColorTimeline.B2]-y)*w}if(r==1)c.color.set(u,d,p,m),c.darkColor.set(g,_,y,1);else{const v=c.color,N=c.darkColor;o==MixBlend.setup&&(v.setFromColor(c.data.color),N.setFromColor(c.data.darkColor)),v.add((u-v.r)*r,(d-v.g)*r,(p-v.b)*r,(m-v.a)*r),N.add((g-N.r)*r,(_-N.g)*r,(y-N.b)*r,0)}}};let TwoColorTimeline=_TwoColorTimeline;TwoColorTimeline.ENTRIES=8;TwoColorTimeline.PREV_TIME=-8;TwoColorTimeline.PREV_R=-7;TwoColorTimeline.PREV_G=-6;TwoColorTimeline.PREV_B=-5;TwoColorTimeline.PREV_A=-4;TwoColorTimeline.PREV_R2=-3;TwoColorTimeline.PREV_G2=-2;TwoColorTimeline.PREV_B2=-1;TwoColorTimeline.R=1;TwoColorTimeline.G=2;TwoColorTimeline.B=3;TwoColorTimeline.A=4;TwoColorTimeline.R2=5;TwoColorTimeline.G2=6;TwoColorTimeline.B2=7;let AttachmentTimeline$1=class{constructor(e){this.frames=Utils.newFloatArray(e),this.attachmentNames=new Array(e)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.attachmentNames[e]=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(c==MixDirection.mixOut&&h==MixBlend.setup){const m=a.data.attachmentName;a.setAttachment(m==null?null:e.getAttachment(this.slotIndex,m));return}const u=this.frames;if(s<u[0]){if(h==MixBlend.setup||h==MixBlend.first){const m=a.data.attachmentName;a.setAttachment(m==null?null:e.getAttachment(this.slotIndex,m))}return}let d=0;s>=u[u.length-1]?d=u.length-1:d=Animation$3.binarySearch(u,s,1)-1;const p=this.attachmentNames[d];e.slots[this.slotIndex].setAttachment(p==null?null:e.getAttachment(this.slotIndex,p))}},zeros=null,DeformTimeline$1=class extends CurveTimeline$1{constructor(e){super(e),this.frames=Utils.newFloatArray(e),this.frameVertices=new Array(e),zeros==null&&(zeros=Utils.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(e,t,s){this.frames[e]=t,this.frameVertices[e]=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex],u=a.getAttachment();if(!(u instanceof VertexAttachment$1)||!u.applyDeform(this.attachment))return;const d=a.attachmentVertices;d.length==0&&(h=MixBlend.setup);const p=this.frameVertices,m=p[0].length,g=this.frames;if(s<g[0]){const U=u;switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(o==1){d.length=0;break}const ee=Utils.setArraySize(d,m);if(U.bones==null){const ie=U.vertices;for(let se=0;se<m;se++)ee[se]+=(ie[se]-ee[se])*o}else{o=1-o;for(let ie=0;ie<m;ie++)ee[ie]*=o}}return}const _=Utils.setArraySize(d,m);if(s>=g[g.length-1]){const U=p[g.length-1];if(o==1)if(h==MixBlend.add){const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++)_[se]+=U[se]-ie[se]}else for(let ie=0;ie<m;ie++)_[ie]+=U[ie]}else Utils.arrayCopy(U,0,_,0,m);else switch(h){case MixBlend.setup:{const ie=u;if(ie.bones==null){const se=ie.vertices;for(let oe=0;oe<m;oe++){const le=se[oe];_[oe]=le+(U[oe]-le)*o}}else for(let se=0;se<m;se++)_[se]=U[se]*o;break}case MixBlend.first:case MixBlend.replace:for(let ie=0;ie<m;ie++)_[ie]+=(U[ie]-_[ie])*o;case MixBlend.add:const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++)_[se]+=(U[se]-ie[se])*o}else for(let ie=0;ie<m;ie++)_[ie]+=U[ie]*o}return}const y=Animation$3.binarySearch(g,s),v=p[y-1],N=p[y],w=g[y],k=this.getCurvePercent(y-1,1-(s-w)/(g[y-1]-w));if(o==1)if(h==MixBlend.add){const U=u;if(U.bones==null){const ee=U.vertices;for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]+=se+(N[ie]-se)*k-ee[ie]}}else for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=ie+(N[ee]-ie)*k}}else for(let U=0;U<m;U++){const ee=v[U];_[U]=ee+(N[U]-ee)*k}else switch(h){case MixBlend.setup:{const ee=u;if(ee.bones==null){const ie=ee.vertices;for(let se=0;se<m;se++){const oe=v[se],le=ie[se];_[se]=le+(oe+(N[se]-oe)*k-le)*o}}else for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]=(se+(N[ie]-se)*k)*o}break}case MixBlend.first:case MixBlend.replace:for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=(ie+(N[ee]-ie)*k-_[ee])*o}break;case MixBlend.add:const U=u;if(U.bones==null){const ee=U.vertices;for(let ie=0;ie<m;ie++){const se=v[ie];_[ie]+=(se+(N[ie]-se)*k-ee[ie])*o}}else for(let ee=0;ee<m;ee++){const ie=v[ee];_[ee]+=(ie+(N[ee]-ie)*k)*o}}}},EventTimeline$1=class{constructor(e){this.frames=Utils.newFloatArray(e),this.events=new Array(e)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(e,t){this.frames[e]=t.time,this.events[e]=t}apply(e,t,s,r,o,h,c){if(r==null)return;const a=this.frames,u=this.frames.length;if(t>s)this.apply(e,t,Number.MAX_VALUE,r,o,h,c),t=-1;else if(t>=a[u-1])return;if(s<a[0])return;let d=0;if(t<a[0])d=0;else{d=Animation$3.binarySearch(a,t);const p=a[d];for(;d>0&&a[d-1]==p;)d--}for(;d<u&&s>=a[d];d++)r.push(this.events[d])}},DrawOrderTimeline$1=class{constructor(e){this.frames=Utils.newFloatArray(e),this.drawOrders=new Array(e)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.drawOrders[e]=s}apply(e,t,s,r,o,h,c){const a=e.drawOrder,u=e.slots;if(c==MixDirection.mixOut&&h==MixBlend.setup){Utils.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}const d=this.frames;if(s<d[0]){(h==MixBlend.setup||h==MixBlend.first)&&Utils.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}let p=0;s>=d[d.length-1]?p=d.length-1:p=Animation$3.binarySearch(d,s)-1;const m=this.drawOrders[p];if(m==null)Utils.arrayCopy(u,0,a,0,u.length);else for(let g=0,_=m.length;g<_;g++)a[g]=u[m[g]]}};const _IkConstraintTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_IkConstraintTimeline.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(n,e,t,s,r,o){n*=_IkConstraintTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_IkConstraintTimeline.MIX]=t,this.frames[n+_IkConstraintTimeline.BEND_DIRECTION]=s,this.frames[n+_IkConstraintTimeline.COMPRESS]=r?1:0,this.frames[n+_IkConstraintTimeline.STRETCH]=o?1:0}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.ikConstraints[this.ikConstraintIndex];if(t<c[0]){switch(o){case MixBlend.setup:a.mix=a.data.mix,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch;return;case MixBlend.first:a.mix+=(a.data.mix-a.mix)*r,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}if(t>=c[c.length-_IkConstraintTimeline.ENTRIES]){o==MixBlend.setup?(a.mix=a.data.mix+(c[c.length+_IkConstraintTimeline.PREV_MIX]-a.data.mix)*r,h==MixDirection.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=c[c.length+_IkConstraintTimeline.PREV_BEND_DIRECTION],a.compress=c[c.length+_IkConstraintTimeline.PREV_COMPRESS]!=0,a.stretch=c[c.length+_IkConstraintTimeline.PREV_STRETCH]!=0)):(a.mix+=(c[c.length+_IkConstraintTimeline.PREV_MIX]-a.mix)*r,h==MixDirection.mixIn&&(a.bendDirection=c[c.length+_IkConstraintTimeline.PREV_BEND_DIRECTION],a.compress=c[c.length+_IkConstraintTimeline.PREV_COMPRESS]!=0,a.stretch=c[c.length+_IkConstraintTimeline.PREV_STRETCH]!=0));return}const u=Animation$3.binarySearch(c,t,_IkConstraintTimeline.ENTRIES),d=c[u+_IkConstraintTimeline.PREV_MIX],p=c[u],m=this.getCurvePercent(u/_IkConstraintTimeline.ENTRIES-1,1-(t-p)/(c[u+_IkConstraintTimeline.PREV_TIME]-p));o==MixBlend.setup?(a.mix=a.data.mix+(d+(c[u+_IkConstraintTimeline.MIX]-d)*m-a.data.mix)*r,h==MixDirection.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=c[u+_IkConstraintTimeline.PREV_BEND_DIRECTION],a.compress=c[u+_IkConstraintTimeline.PREV_COMPRESS]!=0,a.stretch=c[u+_IkConstraintTimeline.PREV_STRETCH]!=0)):(a.mix+=(d+(c[u+_IkConstraintTimeline.MIX]-d)*m-a.mix)*r,h==MixDirection.mixIn&&(a.bendDirection=c[u+_IkConstraintTimeline.PREV_BEND_DIRECTION],a.compress=c[u+_IkConstraintTimeline.PREV_COMPRESS]!=0,a.stretch=c[u+_IkConstraintTimeline.PREV_STRETCH]!=0))}};let IkConstraintTimeline$1=_IkConstraintTimeline;IkConstraintTimeline$1.ENTRIES=5;IkConstraintTimeline$1.PREV_TIME=-5;IkConstraintTimeline$1.PREV_MIX=-4;IkConstraintTimeline$1.PREV_BEND_DIRECTION=-3;IkConstraintTimeline$1.PREV_COMPRESS=-2;IkConstraintTimeline$1.PREV_STRETCH=-1;IkConstraintTimeline$1.MIX=1;IkConstraintTimeline$1.BEND_DIRECTION=2;IkConstraintTimeline$1.COMPRESS=3;IkConstraintTimeline$1.STRETCH=4;const _TransformConstraintTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_TransformConstraintTimeline.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(n,e,t,s,r,o){n*=_TransformConstraintTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_TransformConstraintTimeline.ROTATE]=t,this.frames[n+_TransformConstraintTimeline.TRANSLATE]=s,this.frames[n+_TransformConstraintTimeline.SCALE]=r,this.frames[n+_TransformConstraintTimeline.SHEAR]=o}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.transformConstraints[this.transformConstraintIndex];if(t<c[0]){const g=a.data;switch(o){case MixBlend.setup:a.rotateMix=g.rotateMix,a.translateMix=g.translateMix,a.scaleMix=g.scaleMix,a.shearMix=g.shearMix;return;case MixBlend.first:a.rotateMix+=(g.rotateMix-a.rotateMix)*r,a.translateMix+=(g.translateMix-a.translateMix)*r,a.scaleMix+=(g.scaleMix-a.scaleMix)*r,a.shearMix+=(g.shearMix-a.shearMix)*r}return}let u=0,d=0,p=0,m=0;if(t>=c[c.length-_TransformConstraintTimeline.ENTRIES]){const g=c.length;u=c[g+_TransformConstraintTimeline.PREV_ROTATE],d=c[g+_TransformConstraintTimeline.PREV_TRANSLATE],p=c[g+_TransformConstraintTimeline.PREV_SCALE],m=c[g+_TransformConstraintTimeline.PREV_SHEAR]}else{const g=Animation$3.binarySearch(c,t,_TransformConstraintTimeline.ENTRIES);u=c[g+_TransformConstraintTimeline.PREV_ROTATE],d=c[g+_TransformConstraintTimeline.PREV_TRANSLATE],p=c[g+_TransformConstraintTimeline.PREV_SCALE],m=c[g+_TransformConstraintTimeline.PREV_SHEAR];const _=c[g],y=this.getCurvePercent(g/_TransformConstraintTimeline.ENTRIES-1,1-(t-_)/(c[g+_TransformConstraintTimeline.PREV_TIME]-_));u+=(c[g+_TransformConstraintTimeline.ROTATE]-u)*y,d+=(c[g+_TransformConstraintTimeline.TRANSLATE]-d)*y,p+=(c[g+_TransformConstraintTimeline.SCALE]-p)*y,m+=(c[g+_TransformConstraintTimeline.SHEAR]-m)*y}if(o==MixBlend.setup){const g=a.data;a.rotateMix=g.rotateMix+(u-g.rotateMix)*r,a.translateMix=g.translateMix+(d-g.translateMix)*r,a.scaleMix=g.scaleMix+(p-g.scaleMix)*r,a.shearMix=g.shearMix+(m-g.shearMix)*r}else a.rotateMix+=(u-a.rotateMix)*r,a.translateMix+=(d-a.translateMix)*r,a.scaleMix+=(p-a.scaleMix)*r,a.shearMix+=(m-a.shearMix)*r}};let TransformConstraintTimeline$1=_TransformConstraintTimeline;TransformConstraintTimeline$1.ENTRIES=5;TransformConstraintTimeline$1.PREV_TIME=-5;TransformConstraintTimeline$1.PREV_ROTATE=-4;TransformConstraintTimeline$1.PREV_TRANSLATE=-3;TransformConstraintTimeline$1.PREV_SCALE=-2;TransformConstraintTimeline$1.PREV_SHEAR=-1;TransformConstraintTimeline$1.ROTATE=1;TransformConstraintTimeline$1.TRANSLATE=2;TransformConstraintTimeline$1.SCALE=3;TransformConstraintTimeline$1.SHEAR=4;const _PathConstraintPositionTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_PathConstraintPositionTimeline.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(n,e,t){n*=_PathConstraintPositionTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_PathConstraintPositionTimeline.VALUE]=t}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.pathConstraints[this.pathConstraintIndex];if(t<c[0]){switch(o){case MixBlend.setup:a.position=a.data.position;return;case MixBlend.first:a.position+=(a.data.position-a.position)*r}return}let u=0;if(t>=c[c.length-_PathConstraintPositionTimeline.ENTRIES])u=c[c.length+_PathConstraintPositionTimeline.PREV_VALUE];else{const d=Animation$3.binarySearch(c,t,_PathConstraintPositionTimeline.ENTRIES);u=c[d+_PathConstraintPositionTimeline.PREV_VALUE];const p=c[d],m=this.getCurvePercent(d/_PathConstraintPositionTimeline.ENTRIES-1,1-(t-p)/(c[d+_PathConstraintPositionTimeline.PREV_TIME]-p));u+=(c[d+_PathConstraintPositionTimeline.VALUE]-u)*m}o==MixBlend.setup?a.position=a.data.position+(u-a.data.position)*r:a.position+=(u-a.position)*r}};let PathConstraintPositionTimeline$1=_PathConstraintPositionTimeline;PathConstraintPositionTimeline$1.ENTRIES=2;PathConstraintPositionTimeline$1.PREV_TIME=-2;PathConstraintPositionTimeline$1.PREV_VALUE=-1;PathConstraintPositionTimeline$1.VALUE=1;let PathConstraintSpacingTimeline$1=class extends PathConstraintPositionTimeline$1{constructor(e){super(e)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(e,t,s,r,o,h,c){const a=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(s<a[0]){switch(h){case MixBlend.setup:u.spacing=u.data.spacing;return;case MixBlend.first:u.spacing+=(u.data.spacing-u.spacing)*o}return}let d=0;if(s>=a[a.length-PathConstraintSpacingTimeline$1.ENTRIES])d=a[a.length+PathConstraintSpacingTimeline$1.PREV_VALUE];else{const p=Animation$3.binarySearch(a,s,PathConstraintSpacingTimeline$1.ENTRIES);d=a[p+PathConstraintSpacingTimeline$1.PREV_VALUE];const m=a[p],g=this.getCurvePercent(p/PathConstraintSpacingTimeline$1.ENTRIES-1,1-(s-m)/(a[p+PathConstraintSpacingTimeline$1.PREV_TIME]-m));d+=(a[p+PathConstraintSpacingTimeline$1.VALUE]-d)*g}h==MixBlend.setup?u.spacing=u.data.spacing+(d-u.data.spacing)*o:u.spacing+=(d-u.spacing)*o}};const _PathConstraintMixTimeline=class extends CurveTimeline$1{constructor(n){super(n),this.frames=Utils.newFloatArray(n*_PathConstraintMixTimeline.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(n,e,t,s){n*=_PathConstraintMixTimeline.ENTRIES,this.frames[n]=e,this.frames[n+_PathConstraintMixTimeline.ROTATE]=t,this.frames[n+_PathConstraintMixTimeline.TRANSLATE]=s}apply(n,e,t,s,r,o,h){const c=this.frames,a=n.pathConstraints[this.pathConstraintIndex];if(t<c[0]){switch(o){case MixBlend.setup:a.rotateMix=a.data.rotateMix,a.translateMix=a.data.translateMix;return;case MixBlend.first:a.rotateMix+=(a.data.rotateMix-a.rotateMix)*r,a.translateMix+=(a.data.translateMix-a.translateMix)*r}return}let u=0,d=0;if(t>=c[c.length-_PathConstraintMixTimeline.ENTRIES])u=c[c.length+_PathConstraintMixTimeline.PREV_ROTATE],d=c[c.length+_PathConstraintMixTimeline.PREV_TRANSLATE];else{const p=Animation$3.binarySearch(c,t,_PathConstraintMixTimeline.ENTRIES);u=c[p+_PathConstraintMixTimeline.PREV_ROTATE],d=c[p+_PathConstraintMixTimeline.PREV_TRANSLATE];const m=c[p],g=this.getCurvePercent(p/_PathConstraintMixTimeline.ENTRIES-1,1-(t-m)/(c[p+_PathConstraintMixTimeline.PREV_TIME]-m));u+=(c[p+_PathConstraintMixTimeline.ROTATE]-u)*g,d+=(c[p+_PathConstraintMixTimeline.TRANSLATE]-d)*g}o==MixBlend.setup?(a.rotateMix=a.data.rotateMix+(u-a.data.rotateMix)*r,a.translateMix=a.data.translateMix+(d-a.data.translateMix)*r):(a.rotateMix+=(u-a.rotateMix)*r,a.translateMix+=(d-a.translateMix)*r)}};let PathConstraintMixTimeline$1=_PathConstraintMixTimeline;PathConstraintMixTimeline$1.ENTRIES=3;PathConstraintMixTimeline$1.PREV_TIME=-3;PathConstraintMixTimeline$1.PREV_ROTATE=-2;PathConstraintMixTimeline$1.PREV_TRANSLATE=-1;PathConstraintMixTimeline$1.ROTATE=1;PathConstraintMixTimeline$1.TRANSLATE=2;new Animation$3("<empty>",[],0);let AtlasAttachmentLoader$1=class{constructor(e){this.atlas=e}newRegionAttachment(e,t,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${t})`);const o=new RegionAttachment$1(t);return o.region=r,o}newMeshAttachment(e,t,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${t})`);const o=new MeshAttachment$1(t);return o.region=r,o}newBoundingBoxAttachment(e,t){return new BoundingBoxAttachment$1(t)}newPathAttachment(e,t){return new PathAttachment$1(t)}newPointAttachment(e,t){return new PointAttachment$1(t)}newClippingAttachment(e,t){return new ClippingAttachment$1(t)}},BoneData$1=class{constructor(e,t,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,e<0)throw new Error("index must be >= 0.");if(t==null)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=s}},Event$2=class{constructor(e,t){if(t==null)throw new Error("data cannot be null.");this.time=e,this.data=t}},EventData$1=class{constructor(e){this.name=e}},IkConstraintData$1=class{constructor(e){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=e}},PathConstraintData$1=class{constructor(e){this.order=0,this.bones=new Array,this.name=e}};var SpacingMode$1=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(SpacingMode$1||{});let SkeletonData$1=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(e){if(e==null)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findBoneIndex(e){if(e==null)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSlot(e){if(e==null)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findSlotIndex(e){if(e==null)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSkin(e){if(e==null)throw new Error("skinName cannot be null.");const t=this.skins;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findEvent(e){if(e==null)throw new Error("eventDataName cannot be null.");const t=this.events;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findAnimation(e){if(e==null)throw new Error("animationName cannot be null.");const t=this.animations;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findIkConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findTransformConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraintIndex(e){if(e==null)throw new Error("pathConstraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}},SlotData$1=class{constructor(e,t,s){if(this.color=new Color(1,1,1,1),e<0)throw new Error("index must be >= 0.");if(t==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=s}},TransformConstraintData$1=class{constructor(e){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,e==null)throw new Error("name cannot be null.");this.name=e}},Skin$1=class{constructor(e){if(this.attachments=new Array,e==null)throw new Error("name cannot be null.");this.name=e}addAttachment(e,t,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;e>=r.length&&(r.length=e+1),r[e]||(r[e]={}),r[e][t]=s}getAttachment(e,t){const s=this.attachments[e];return s?s[t]:null}attachAll(e,t){let s=0;for(let r=0;r<e.slots.length;r++){const o=e.slots[r],h=o.getAttachment();if(h&&s<t.attachments.length){const c=t.attachments[s];for(const a in c){const u=c[a];if(h==u){const d=this.getAttachment(s,a);d!=null&&o.setAttachment(d);break}}}s++}}},SkeletonJson$1=class{constructor(e){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}readSkeletonData(e){const t=this.scale,s=new SkeletonData$1,r=typeof e=="string"?JSON.parse(e):e,o=r.skeleton;if(o!=null&&(s.hash=o.hash,s.version=o.spine,s.width=o.width,s.height=o.height,s.fps=o.fps,s.imagesPath=o.images),r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let a=null;const u=this.getValue(c,"parent",null);if(u!=null&&(a=s.findBone(u),a==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData$1(s.bones.length,c.name,a);d.length=this.getValue(c,"length",0)*t,d.x=this.getValue(c,"x",0)*t,d.y=this.getValue(c,"y",0)*t,d.rotation=this.getValue(c,"rotation",0),d.scaleX=this.getValue(c,"scaleX",1),d.scaleY=this.getValue(c,"scaleY",1),d.shearX=this.getValue(c,"shearX",0),d.shearY=this.getValue(c,"shearY",0),d.transformMode=SkeletonJson$1.transformModeFromString(this.getValue(c,"transform","normal")),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],a=c.name,u=c.bone,d=s.findBone(u);if(d==null)throw new Error(`Slot bone not found: ${u}`);const p=new SlotData$1(s.slots.length,a,d),m=this.getValue(c,"color",null);m!=null&&p.color.setFromString(m);const g=this.getValue(c,"dark",null);g!=null&&(p.darkColor=new Color(1,1,1,1),p.darkColor.setFromString(g)),p.attachmentName=this.getValue(c,"attachment",null),p.blendMode=SkeletonJson$1.blendModeFromString(this.getValue(c,"blend","normal")),s.slots.push(p)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],a=new IkConstraintData$1(c.name);a.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`IK bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findBone(u),a.target==null)throw new Error(`IK target bone not found: ${u}`);a.bendDirection=this.getValue(c,"bendPositive",!0)?1:-1,a.mix=this.getValue(c,"mix",1),s.ikConstraints.push(a)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],a=new TransformConstraintData$1(c.name);a.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`Transform constraint bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findBone(u),a.target==null)throw new Error(`Transform constraint target bone not found: ${u}`);a.local=this.getValue(c,"local",!1),a.relative=this.getValue(c,"relative",!1),a.offsetRotation=this.getValue(c,"rotation",0),a.offsetX=this.getValue(c,"x",0)*t,a.offsetY=this.getValue(c,"y",0)*t,a.offsetScaleX=this.getValue(c,"scaleX",0),a.offsetScaleY=this.getValue(c,"scaleY",0),a.offsetShearY=this.getValue(c,"shearY",0),a.rotateMix=this.getValue(c,"rotateMix",1),a.translateMix=this.getValue(c,"translateMix",1),a.scaleMix=this.getValue(c,"scaleMix",1),a.shearMix=this.getValue(c,"shearMix",1),s.transformConstraints.push(a)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],a=new PathConstraintData$1(c.name);a.order=this.getValue(c,"order",0);for(let d=0;d<c.bones.length;d++){const p=c.bones[d],m=s.findBone(p);if(m==null)throw new Error(`Transform constraint bone not found: ${p}`);a.bones.push(m)}const u=c.target;if(a.target=s.findSlot(u),a.target==null)throw new Error(`Path target slot not found: ${u}`);a.positionMode=SkeletonJson$1.positionModeFromString(this.getValue(c,"positionMode","percent")),a.spacingMode=SkeletonJson$1.spacingModeFromString(this.getValue(c,"spacingMode","length")),a.rotateMode=SkeletonJson$1.rotateModeFromString(this.getValue(c,"rotateMode","tangent")),a.offsetRotation=this.getValue(c,"rotation",0),a.position=this.getValue(c,"position",0),a.positionMode==PositionMode.Fixed&&(a.position*=t),a.spacing=this.getValue(c,"spacing",0),(a.spacingMode==SpacingMode$1.Length||a.spacingMode==SpacingMode$1.Fixed)&&(a.spacing*=t),a.rotateMix=this.getValue(c,"rotateMix",1),a.translateMix=this.getValue(c,"translateMix",1),s.pathConstraints.push(a)}if(r.skins)for(const h in r.skins){const c=r.skins[h],a=new Skin$1(h);for(const u in c){const d=s.findSlotIndex(u);if(d==-1)throw new Error(`Slot not found: ${u}`);const p=c[u];for(const m in p){const g=this.readAttachment(p[m],a,d,m,s);g!=null&&a.addAttachment(d,m,g)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const a=this.linkedMeshes[h],u=a.skin==null?s.defaultSkin:s.findSkin(a.skin);if(u==null)throw new Error(`Skin not found: ${a.skin}`);const d=u.getAttachment(a.slotIndex,a.parent);if(d==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],a=new EventData$1(h);a.intValue=this.getValue(c,"int",0),a.floatValue=this.getValue(c,"float",0),a.stringValue=this.getValue(c,"string",""),a.audioPath=this.getValue(c,"audio",null),a.audioPath!=null&&(a.volume=this.getValue(c,"volume",1),a.balance=this.getValue(c,"balance",0)),s.events.push(a)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(e,t,s,r,o){const h=this.scale;switch(r=this.getValue(e,"name",r),this.getValue(e,"type","region")){case"region":{const a=this.getValue(e,"path",r),u=this.attachmentLoader.newRegionAttachment(t,r,a);if(u==null)return null;u.path=a,u.x=this.getValue(e,"x",0)*h,u.y=this.getValue(e,"y",0)*h,u.scaleX=this.getValue(e,"scaleX",1),u.scaleY=this.getValue(e,"scaleY",1),u.rotation=this.getValue(e,"rotation",0),u.width=e.width*h,u.height=e.height*h;const d=this.getValue(e,"color",null);return d!=null&&u.color.setFromString(d),u}case"boundingbox":{const a=this.attachmentLoader.newBoundingBoxAttachment(t,r);if(a==null)return null;this.readVertices(e,a,e.vertexCount<<1);const u=this.getValue(e,"color",null);return u!=null&&a.color.setFromString(u),a}case"mesh":case"linkedmesh":{const a=this.getValue(e,"path",r),u=this.attachmentLoader.newMeshAttachment(t,r,a);if(u==null)return null;u.path=a;const d=this.getValue(e,"color",null);d!=null&&u.color.setFromString(d);const p=this.getValue(e,"parent",null);if(p!=null)return u.inheritDeform=this.getValue(e,"deform",!0),this.linkedMeshes.push(new LinkedMesh$2(u,this.getValue(e,"skin",null),s,p)),u;const m=e.uvs;return this.readVertices(e,u,m.length),u.triangles=e.triangles,u.regionUVs=new Float32Array(m),u.hullLength=this.getValue(e,"hull",0)*2,u}case"path":{const a=this.attachmentLoader.newPathAttachment(t,r);if(a==null)return null;a.closed=this.getValue(e,"closed",!1),a.constantSpeed=this.getValue(e,"constantSpeed",!0);const u=e.vertexCount;this.readVertices(e,a,u<<1);const d=Utils.newArray(u/3,0);for(let m=0;m<e.lengths.length;m++)d[m]=e.lengths[m]*h;a.lengths=d;const p=this.getValue(e,"color",null);return p!=null&&a.color.setFromString(p),a}case"point":{const a=this.attachmentLoader.newPointAttachment(t,r);if(a==null)return null;a.x=this.getValue(e,"x",0)*h,a.y=this.getValue(e,"y",0)*h,a.rotation=this.getValue(e,"rotation",0);const u=this.getValue(e,"color",null);return u!=null&&a.color.setFromString(u),a}case"clipping":{const a=this.attachmentLoader.newClippingAttachment(t,r);if(a==null)return null;const u=this.getValue(e,"end",null);if(u!=null){const m=o.findSlot(u);if(m==null)throw new Error(`Clipping end slot not found: ${u}`);a.endSlot=m}const d=e.vertexCount;this.readVertices(e,a,d<<1);const p=this.getValue(e,"color",null);return p!=null&&a.color.setFromString(p),a}}return null}readVertices(e,t,s){const r=this.scale;t.worldVerticesLength=s;const o=e.vertices;if(s==o.length){const a=Utils.toFloatArray(o);if(r!=1)for(let u=0,d=o.length;u<d;u++)a[u]*=r;t.vertices=a;return}const h=new Array,c=new Array;for(let a=0,u=o.length;a<u;){const d=o[a++];c.push(d);for(let p=a+d*4;a<p;a+=4)c.push(o[a]),h.push(o[a+1]*r),h.push(o[a+2]*r),h.push(o[a+3])}t.bones=c,t.vertices=Utils.toFloatArray(h)}readAnimation(e,t,s){const r=this.scale,o=new Array;let h=0;if(e.slots)for(const a in e.slots){const u=e.slots[a],d=s.findSlotIndex(a);if(d==-1)throw new Error(`Slot not found: ${a}`);for(const p in u){const m=u[p];if(p=="attachment"){const g=new AttachmentTimeline$1(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y];g.setFrame(_++,v.time,v.name)}o.push(g),h=Math.max(h,g.frames[g.getFrameCount()-1])}else if(p=="color"){const g=new ColorTimeline(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y],N=new Color;N.setFromString(v.color||"ffffffff"),g.setFrame(_,v.time,N.r,N.g,N.b,N.a),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*ColorTimeline.ENTRIES])}else if(p=="twoColor"){const g=new TwoColorTimeline(m.length);g.slotIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y],N=new Color,w=new Color;N.setFromString(v.light),w.setFromString(v.dark),g.setFrame(_,v.time,N.r,N.g,N.b,N.a,w.r,w.g,w.b),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TwoColorTimeline.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${p} (${a})`)}}if(e.bones)for(const a in e.bones){const u=e.bones[a],d=s.findBoneIndex(a);if(d==-1)throw new Error(`Bone not found: ${a}`);for(const p in u){const m=u[p];if(p==="rotate"){const g=new RotateTimeline$1(m.length);g.boneIndex=d;let _=0;for(let y=0;y<m.length;y++){const v=m[y];g.setFrame(_,v.time,v.angle),this.readCurve(v,g,_),_++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*RotateTimeline$1.ENTRIES])}else if(p==="translate"||p==="scale"||p==="shear"){let g=null,_=1;p==="scale"?g=new ScaleTimeline$1(m.length):p==="shear"?g=new ShearTimeline$1(m.length):(g=new TranslateTimeline$1(m.length),_=r),g.boneIndex=d;let y=0;for(let v=0;v<m.length;v++){const N=m[v],w=this.getValue(N,"x",0),k=this.getValue(N,"y",0);g.setFrame(y,N.time,w*_,k*_),this.readCurve(N,g,y),y++}o.push(g),h=Math.max(h,g.frames[(g.getFrameCount()-1)*TranslateTimeline$1.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${p} (${a})`)}}if(e.ik)for(const a in e.ik){const u=e.ik[a],d=s.findIkConstraint(a),p=new IkConstraintTimeline$1(u.length);p.ikConstraintIndex=s.ikConstraints.indexOf(d);let m=0;for(let g=0;g<u.length;g++){const _=u[g];p.setFrame(m,_.time,this.getValue(_,"mix",1),this.getValue(_,"bendPositive",!0)?1:-1,this.getValue(_,"compress",!1),this.getValue(_,"stretch",!1)),this.readCurve(_,p,m),m++}o.push(p),h=Math.max(h,p.frames[(p.getFrameCount()-1)*IkConstraintTimeline$1.ENTRIES])}if(e.transform)for(const a in e.transform){const u=e.transform[a],d=s.findTransformConstraint(a),p=new TransformConstraintTimeline$1(u.length);p.transformConstraintIndex=s.transformConstraints.indexOf(d);let m=0;for(let g=0;g<u.length;g++){const _=u[g];p.setFrame(m,_.time,this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1),this.getValue(_,"scaleMix",1),this.getValue(_,"shearMix",1)),this.readCurve(_,p,m),m++}o.push(p),h=Math.max(h,p.frames[(p.getFrameCount()-1)*TransformConstraintTimeline$1.ENTRIES])}if(e.paths)for(const a in e.paths){const u=e.paths[a],d=s.findPathConstraintIndex(a);if(d==-1)throw new Error(`Path constraint not found: ${a}`);const p=s.pathConstraints[d];for(const m in u){const g=u[m];if(m==="position"||m==="spacing"){let _=null,y=1;m==="spacing"?(_=new PathConstraintSpacingTimeline$1(g.length),(p.spacingMode==SpacingMode$1.Length||p.spacingMode==SpacingMode$1.Fixed)&&(y=r)):(_=new PathConstraintPositionTimeline$1(g.length),p.positionMode==PositionMode.Fixed&&(y=r)),_.pathConstraintIndex=d;let v=0;for(let N=0;N<g.length;N++){const w=g[N];_.setFrame(v,w.time,this.getValue(w,m,0)*y),this.readCurve(w,_,v),v++}o.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintPositionTimeline$1.ENTRIES])}else if(m==="mix"){const _=new PathConstraintMixTimeline$1(g.length);_.pathConstraintIndex=d;let y=0;for(let v=0;v<g.length;v++){const N=g[v];_.setFrame(y,N.time,this.getValue(N,"rotateMix",1),this.getValue(N,"translateMix",1)),this.readCurve(N,_,y),y++}o.push(_),h=Math.max(h,_.frames[(_.getFrameCount()-1)*PathConstraintMixTimeline$1.ENTRIES])}}}if(e.deform)for(const a in e.deform){const u=e.deform[a],d=s.findSkin(a);if(d!=null)for(const p in u){const m=u[p],g=s.findSlotIndex(p);if(g==-1)throw new Error(`Slot not found: ${m.name}`);for(const _ in m){const y=m[_],v=d.getAttachment(g,_);if(v==null)throw new Error(`Deform attachment not found: ${y.name}`);const N=v.bones!=null,w=v.vertices,k=N?w.length/3*2:w.length,U=new DeformTimeline$1(y.length);U.slotIndex=g,U.attachment=v;let ee=0;for(let ie=0;ie<y.length;ie++){const se=y[ie];let oe;const le=this.getValue(se,"vertices",null);if(le==null)oe=N?Utils.newFloatArray(k):w;else{oe=Utils.newFloatArray(k);const ue=this.getValue(se,"offset",0);if(Utils.arrayCopy(le,0,oe,ue,le.length),r!=1)for(let he=ue,pe=he+le.length;he<pe;he++)oe[he]*=r;if(!N)for(let he=0;he<k;he++)oe[he]+=w[he]}U.setFrame(ee,se.time,oe),this.readCurve(se,U,ee),ee++}o.push(U),h=Math.max(h,U.frames[U.getFrameCount()-1])}}}let c=e.drawOrder;if(c==null&&(c=e.draworder),c!=null){const a=new DrawOrderTimeline$1(c.length),u=s.slots.length;let d=0;for(let p=0;p<c.length;p++){const m=c[p];let g=null;const _=this.getValue(m,"offsets",null);if(_!=null){g=Utils.newArray(u,-1);const y=Utils.newArray(u-_.length,0);let v=0,N=0;for(let w=0;w<_.length;w++){const k=_[w],U=s.findSlotIndex(k.slot);if(U==-1)throw new Error(`Slot not found: ${k.slot}`);for(;v!=U;)y[N++]=v++;g[v+k.offset]=v++}for(;v<u;)y[N++]=v++;for(let w=u-1;w>=0;w--)g[w]==-1&&(g[w]=y[--N])}a.setFrame(d++,m.time,g)}o.push(a),h=Math.max(h,a.frames[a.getFrameCount()-1])}if(e.events){const a=new EventTimeline$1(e.events.length);let u=0;for(let d=0;d<e.events.length;d++){const p=e.events[d],m=s.findEvent(p.name);if(m==null)throw new Error(`Event not found: ${p.name}`);const g=new Event$2(Utils.toSinglePrecision(p.time),m);g.intValue=this.getValue(p,"int",m.intValue),g.floatValue=this.getValue(p,"float",m.floatValue),g.stringValue=this.getValue(p,"string",m.stringValue),g.data.audioPath!=null&&(g.volume=this.getValue(p,"volume",1),g.balance=this.getValue(p,"balance",0)),a.setFrame(u++,g)}o.push(a),h=Math.max(h,a.frames[a.getFrameCount()-1])}if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$3(t,o,h))}readCurve(e,t,s){if(e.curve){if(e.curve==="stepped")t.setStepped(s);else if(Object.prototype.toString.call(e.curve)==="[object Array]"){const r=e.curve;t.setCurve(s,r[0],r[1],r[2],r[3])}}}getValue(e,t,s){return e[t]!==void 0?e[t]:s}static blendModeFromString(e){if(e=e.toLowerCase(),e=="normal")return BLEND_MODES.NORMAL;if(e=="additive")return BLEND_MODES.ADD;if(e=="multiply")return BLEND_MODES.MULTIPLY;if(e=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${e}`)}static positionModeFromString(e){if(e=e.toLowerCase(),e=="fixed")return PositionMode.Fixed;if(e=="percent")return PositionMode.Percent;throw new Error(`Unknown position mode: ${e}`)}static spacingModeFromString(e){if(e=e.toLowerCase(),e=="length")return SpacingMode$1.Length;if(e=="fixed")return SpacingMode$1.Fixed;if(e=="percent")return SpacingMode$1.Percent;throw new Error(`Unknown position mode: ${e}`)}static rotateModeFromString(e){if(e=e.toLowerCase(),e=="tangent")return RotateMode.Tangent;if(e=="chain")return RotateMode.Chain;if(e=="chainscale")return RotateMode.ChainScale;throw new Error(`Unknown rotate mode: ${e}`)}static transformModeFromString(e){if(e=e.toLowerCase(),e=="normal")return TransformMode.Normal;if(e=="onlytranslation")return TransformMode.OnlyTranslation;if(e=="norotationorreflection")return TransformMode.NoRotationOrReflection;if(e=="noscale")return TransformMode.NoScale;if(e=="noscaleorreflection")return TransformMode.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${e}`)}},LinkedMesh$2=class{constructor(e,t,s,r){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=r}};class Attachment{constructor(e){if(!e)throw new Error("name cannot be null.");this.name=e}}const _VertexAttachment=class extends Attachment{constructor(n){super(n),this.id=_VertexAttachment.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(n,e){this.computeWorldVertices(n,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(n,e,t,s,r,o){t=r+(t>>1)*o;const h=n.bone.skeleton,c=n.deform;let a=this.vertices;const u=this.bones;if(!u){c.length>0&&(a=c);const g=n.bone.matrix,_=g.tx,y=g.ty,v=g.a,N=g.c,w=g.b,k=g.d;for(let U=e,ee=r;ee<t;U+=2,ee+=o){const ie=a[U],se=a[U+1];s[ee]=ie*v+se*N+_,s[ee+1]=ie*w+se*k+y}return}let d=0,p=0;for(let g=0;g<e;g+=2){const _=u[d];d+=_+1,p+=_}const m=h.bones;if(c.length==0)for(let g=r,_=p*3;g<t;g+=o){let y=0,v=0,N=u[d++];for(N+=d;d<N;d++,_+=3){const w=m[u[d]].matrix,k=a[_],U=a[_+1],ee=a[_+2];y+=(k*w.a+U*w.c+w.tx)*ee,v+=(k*w.b+U*w.d+w.ty)*ee}s[g]=y,s[g+1]=v}else{const g=c;for(let _=r,y=p*3,v=p<<1;_<t;_+=o){let N=0,w=0,k=u[d++];for(k+=d;d<k;d++,y+=3,v+=2){const U=m[u[d]].matrix,ee=a[y]+g[v],ie=a[y+1]+g[v+1],se=a[y+2];N+=(ee*U.a+ie*U.c+U.tx)*se,w+=(ee*U.b+ie*U.d+U.ty)*se}s[_]=N,s[_+1]=w}}}copyTo(n){this.bones?(n.bones=new Array(this.bones.length),Utils.arrayCopy(this.bones,0,n.bones,0,this.bones.length)):n.bones=null,this.vertices&&(n.vertices=Utils.newFloatArray(this.vertices.length),Utils.arrayCopy(this.vertices,0,n.vertices,0,this.vertices.length)),n.worldVerticesLength=this.worldVerticesLength,n.timelineAttachment=this.timelineAttachment}};let VertexAttachment=_VertexAttachment;VertexAttachment.nextID=0;class BoundingBoxAttachment extends VertexAttachment{constructor(e){super(e),this.type=AttachmentType.BoundingBox,this.color=new Color(1,1,1,1)}copy(){const e=new BoundingBoxAttachment(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}}class ClippingAttachment extends VertexAttachment{constructor(e){super(e),this.type=AttachmentType.Clipping,this.endSlot=null,this.color=new Color(.2275,.2275,.8078,1)}copy(){const e=new ClippingAttachment(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}}class MeshAttachment extends VertexAttachment{constructor(e,t){super(e),this.type=AttachmentType.Mesh,this.region=null,this.triangles=[],this.color=new Color(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new Color(0,0,0,0),this.path=t}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const e=new MeshAttachment(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Float32Array(this.regionUVs.length),Utils.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.triangles=new Array(this.triangles.length),Utils.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),Utils.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}computeWorldVertices(e,t,s,r,o,h){this.sequence!=null&&this.sequence.apply(e,this),super.computeWorldVertices(e,t,s,r,o,h)}newLinkedMesh(){const e=new MeshAttachment(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),e}}class PathAttachment extends VertexAttachment{constructor(e){super(e),this.type=AttachmentType.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new Color(1,1,1,1)}copy(){const e=new PathAttachment(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Utils.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}}class PointAttachment extends VertexAttachment{constructor(e){super(e),this.type=AttachmentType.Point,this.x=0,this.y=0,this.rotation=0,this.color=new Color(.38,.94,0,1)}computeWorldPosition(e,t){const s=e.matrix;return t.x=this.x*s.a+this.y*s.c+e.worldX,t.y=this.x*s.b+this.y*s.d+e.worldY,t}computeWorldRotation(e){const t=e.matrix,s=MathUtils.cosDeg(this.rotation),r=MathUtils.sinDeg(this.rotation),o=s*t.a+r*t.c,h=s*t.b+r*t.d;return Math.atan2(h,o)*MathUtils.radDeg}copy(){const e=new PointAttachment(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}}const _RegionAttachment=class extends Attachment{constructor(n,e){super(n),this.type=AttachmentType.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Color(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=Utils.newFloatArray(8),this.uvs=Utils.newFloatArray(8),this.tempColor=new Color(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");const n=this.region,e=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*e,r=-this.height/2*this.scaleY+this.region.offsetY*t,o=s+this.region.width*e,h=r+this.region.height*t,c=this.rotation*Math.PI/180,a=Math.cos(c),u=Math.sin(c),d=this.x,p=this.y,m=s*a+d,g=s*u,_=r*a+p,y=r*u,v=o*a+d,N=o*u,w=h*a+p,k=h*u,U=this.offset;U[0]=m-y,U[1]=_+g,U[2]=m-k,U[3]=w+g,U[4]=v-k,U[5]=w+N,U[6]=v-y,U[7]=_+N;const ee=this.uvs;n.degrees==90?(ee[2]=n.u,ee[3]=n.v2,ee[4]=n.u,ee[5]=n.v,ee[6]=n.u2,ee[7]=n.v,ee[0]=n.u2,ee[1]=n.v2):(ee[0]=n.u,ee[1]=n.v2,ee[2]=n.u,ee[3]=n.v,ee[4]=n.u2,ee[5]=n.v,ee[6]=n.u2,ee[7]=n.v2)}computeWorldVertices(n,e,t,s){this.sequence!=null&&this.sequence.apply(n,this);const r=n.bone,o=this.offset,h=r.matrix,c=h.tx,a=h.ty,u=h.a,d=h.c,p=h.b,m=h.d;let g=0,_=0;g=o[0],_=o[1],e[t]=g*u+_*d+c,e[t+1]=g*p+_*m+a,t+=s,g=o[2],_=o[3],e[t]=g*u+_*d+c,e[t+1]=g*p+_*m+a,t+=s,g=o[4],_=o[5],e[t]=g*u+_*d+c,e[t+1]=g*p+_*m+a,t+=s,g=o[6],_=o[7],e[t]=g*u+_*d+c,e[t+1]=g*p+_*m+a}copy(){const n=new _RegionAttachment(this.name,this.path);return n.region=this.region,n.rendererObject=this.rendererObject,n.x=this.x,n.y=this.y,n.scaleX=this.scaleX,n.scaleY=this.scaleY,n.rotation=this.rotation,n.width=this.width,n.height=this.height,Utils.arrayCopy(this.uvs,0,n.uvs,0,8),Utils.arrayCopy(this.offset,0,n.offset,0,8),n.color.setFromColor(this.color),n.sequence=this.sequence!=null?this.sequence.copy():null,n}};let RegionAttachment=_RegionAttachment;RegionAttachment.X1=0;RegionAttachment.Y1=1;RegionAttachment.C1R=2;RegionAttachment.C1G=3;RegionAttachment.C1B=4;RegionAttachment.C1A=5;RegionAttachment.U1=6;RegionAttachment.V1=7;RegionAttachment.X2=8;RegionAttachment.Y2=9;RegionAttachment.C2R=10;RegionAttachment.C2G=11;RegionAttachment.C2B=12;RegionAttachment.C2A=13;RegionAttachment.U2=14;RegionAttachment.V2=15;RegionAttachment.X3=16;RegionAttachment.Y3=17;RegionAttachment.C3R=18;RegionAttachment.C3G=19;RegionAttachment.C3B=20;RegionAttachment.C3A=21;RegionAttachment.U3=22;RegionAttachment.V3=23;RegionAttachment.X4=24;RegionAttachment.Y4=25;RegionAttachment.C4R=26;RegionAttachment.C4G=27;RegionAttachment.C4B=28;RegionAttachment.C4A=29;RegionAttachment.U4=30;RegionAttachment.V4=31;const _Sequence=class{constructor(n){this.id=_Sequence.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(n)}copy(){const n=new _Sequence(this.regions.length);return Utils.arrayCopy(this.regions,0,n.regions,0,this.regions.length),n.start=this.start,n.digits=this.digits,n.setupIndex=this.setupIndex,n}apply(n,e){let t=n.sequenceIndex;t==-1&&(t=this.setupIndex),t>=this.regions.length&&(t=this.regions.length-1);const s=this.regions[t];e.region!=s&&(e.region=s)}getPath(n,e){let t=n;const s=(this.start+e).toString();for(let r=this.digits-s.length;r>0;r--)t+="0";return t+=s,t}static nextID(){return _Sequence._nextID++}};let Sequence$1=_Sequence;Sequence$1._nextID=0;var SequenceMode=(n=>(n[n.hold=0]="hold",n[n.once=1]="once",n[n.loop=2]="loop",n[n.pingpong=3]="pingpong",n[n.onceReverse=4]="onceReverse",n[n.loopReverse=5]="loopReverse",n[n.pingpongReverse=6]="pingpongReverse",n))(SequenceMode||{});const SequenceModeValues=[0,1,2,3,4,5,6];let Animation$2=class{constructor(e,t,s){if(this.timelines=[],this.timelineIds=new StringSet,!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=s}setTimelines(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(let t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(e,t,s,r,o,h,c,a){if(!e)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,t>0&&(t%=this.duration));const u=this.timelines;for(let d=0,p=u.length;d<p;d++)u[d].apply(e,t,s,o,h,c,a)}};const Property={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};let Timeline$1=class{constructor(e,t){this.propertyIds=t,this.frames=Utils.newFloatArray(e*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(e,t){const s=e.length;for(let r=1;r<s;r++)if(e[r]>t)return r-1;return s-1}static search(e,t,s){const r=e.length;for(let o=s;o<r;o+=s)if(e[o]>t)return o-s;return r-s}};class CurveTimeline extends Timeline$1{constructor(e,t,s){super(e,s),this.curves=Utils.newFloatArray(e+t*18),this.curves[e-1]=1}setLinear(e){this.curves[e]=0}setStepped(e){this.curves[e]=1}shrink(e){const t=this.getFrameCount()+e*18;if(this.curves.length>t){const s=Utils.newFloatArray(t);Utils.arrayCopy(this.curves,0,s,0,t),this.curves=s}}setBezier(e,t,s,r,o,h,c,a,u,d,p){const m=this.curves;let g=this.getFrameCount()+e*18;s==0&&(m[t]=2+g);const _=(r-h*2+a)*.03,y=(o-c*2+u)*.03,v=((h-a)*3-r+d)*.006,N=((c-u)*3-o+p)*.006;let w=_*2+v,k=y*2+N,U=(h-r)*.3+_+v*.16666667,ee=(c-o)*.3+y+N*.16666667,ie=r+U,se=o+ee;for(let oe=g+18;g<oe;g+=2)m[g]=ie,m[g+1]=se,U+=w,ee+=k,w+=v,k+=N,ie+=U,se+=ee}getBezierValue(e,t,s,r){const o=this.curves;if(o[r]>e){const u=this.frames[t],d=this.frames[t+s];return d+(e-u)/(o[r]-u)*(o[r+1]-d)}const h=r+18;for(r+=2;r<h;r+=2)if(o[r]>=e){const u=o[r-2],d=o[r-1];return d+(e-u)/(o[r]-u)*(o[r+1]-d)}t+=this.getFrameEntries();const c=o[h-2],a=o[h-1];return a+(e-c)/(this.frames[t]-c)*(this.frames[t+s]-a)}}class CurveTimeline1 extends CurveTimeline{constructor(e,t,s){super(e,t,[s])}getFrameEntries(){return 2}setFrame(e,t,s){e<<=1,this.frames[e]=t,this.frames[e+1]=s}getCurveValue(e){const t=this.frames;let s=t.length-2;for(let o=2;o<=s;o+=2)if(t[o]>e){s=o-2;break}const r=this.curves[s>>1];switch(r){case 0:const o=t[s],h=t[s+1];return h+(e-o)/(t[s+2]-o)*(t[s+2+1]-h);case 1:return t[s+1]}return this.getBezierValue(e,s,1,r-2)}}class CurveTimeline2 extends CurveTimeline{constructor(e,t,s,r){super(e,t,[s,r])}getFrameEntries(){return 3}setFrame(e,t,s,r){e*=3,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r}}class RotateTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.rotate}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.rotation=a.data.rotation;return;case MixBlend.first:a.rotation+=(a.data.rotation-a.rotation)*o}return}let d=this.getCurveValue(s);switch(h){case MixBlend.setup:a.rotation=a.data.rotation+d*o;break;case MixBlend.first:case MixBlend.replace:d+=a.data.rotation-a.rotation;case MixBlend.add:a.rotation+=d*o}}}class TranslateTimeline extends CurveTimeline2{constructor(e,t,s){super(e,t,`${Property.x}|${s}`,`${Property.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.x=a.data.x,a.y=a.data.y;return;case MixBlend.first:a.x+=(a.data.x-a.x)*o,a.y+=(a.data.y-a.y)*o}return}let d=0,p=0;const m=Timeline$1.search(u,s,3),g=this.curves[m/3];switch(g){case 0:const _=u[m];d=u[m+1],p=u[m+2];const y=(s-_)/(u[m+3]-_);d+=(u[m+3+1]-d)*y,p+=(u[m+3+2]-p)*y;break;case 1:d=u[m+1],p=u[m+2];break;default:d=this.getBezierValue(s,m,1,g-2),p=this.getBezierValue(s,m,2,g+18-2)}switch(h){case MixBlend.setup:a.x=a.data.x+d*o,a.y=a.data.y+p*o;break;case MixBlend.first:case MixBlend.replace:a.x+=(a.data.x+d-a.x)*o,a.y+=(a.data.y+p-a.y)*o;break;case MixBlend.add:a.x+=d*o,a.y+=p*o}}}class TranslateXTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.x}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.x=a.data.x;return;case MixBlend.first:a.x+=(a.data.x-a.x)*o}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:a.x=a.data.x+d*o;break;case MixBlend.first:case MixBlend.replace:a.x+=(a.data.x+d-a.x)*o;break;case MixBlend.add:a.x+=d*o}}}class TranslateYTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.y=a.data.y;return;case MixBlend.first:a.y+=(a.data.y-a.y)*o}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:a.y=a.data.y+d*o;break;case MixBlend.first:case MixBlend.replace:a.y+=(a.data.y+d-a.y)*o;break;case MixBlend.add:a.y+=d*o}}}class ScaleTimeline extends CurveTimeline2{constructor(e,t,s){super(e,t,`${Property.scaleX}|${s}`,`${Property.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.scaleX=a.data.scaleX,a.scaleY=a.data.scaleY;return;case MixBlend.first:a.scaleX+=(a.data.scaleX-a.scaleX)*o,a.scaleY+=(a.data.scaleY-a.scaleY)*o}return}let d,p;const m=Timeline$1.search(u,s,3),g=this.curves[m/3];switch(g){case 0:const _=u[m];d=u[m+1],p=u[m+2];const y=(s-_)/(u[m+3]-_);d+=(u[m+3+1]-d)*y,p+=(u[m+3+2]-p)*y;break;case 1:d=u[m+1],p=u[m+2];break;default:d=this.getBezierValue(s,m,1,g-2),p=this.getBezierValue(s,m,2,g+18-2)}if(d*=a.data.scaleX,p*=a.data.scaleY,o==1)h==MixBlend.add?(a.scaleX+=d-a.data.scaleX,a.scaleY+=p-a.data.scaleY):(a.scaleX=d,a.scaleY=p);else{let _=0,y=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:_=a.data.scaleX,y=a.data.scaleY,a.scaleX=_+(Math.abs(d)*MathUtils.signum(_)-_)*o,a.scaleY=y+(Math.abs(p)*MathUtils.signum(y)-y)*o;break;case MixBlend.first:case MixBlend.replace:_=a.scaleX,y=a.scaleY,a.scaleX=_+(Math.abs(d)*MathUtils.signum(_)-_)*o,a.scaleY=y+(Math.abs(p)*MathUtils.signum(y)-y)*o;break;case MixBlend.add:a.scaleX+=(d-a.data.scaleX)*o,a.scaleY+=(p-a.data.scaleY)*o}else switch(h){case MixBlend.setup:_=Math.abs(a.data.scaleX)*MathUtils.signum(d),y=Math.abs(a.data.scaleY)*MathUtils.signum(p),a.scaleX=_+(d-_)*o,a.scaleY=y+(p-y)*o;break;case MixBlend.first:case MixBlend.replace:_=Math.abs(a.scaleX)*MathUtils.signum(d),y=Math.abs(a.scaleY)*MathUtils.signum(p),a.scaleX=_+(d-_)*o,a.scaleY=y+(p-y)*o;break;case MixBlend.add:a.scaleX+=(d-a.data.scaleX)*o,a.scaleY+=(p-a.data.scaleY)*o}}}}class ScaleXTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.scaleX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.scaleX=a.data.scaleX;return;case MixBlend.first:a.scaleX+=(a.data.scaleX-a.scaleX)*o}return}const d=this.getCurveValue(s)*a.data.scaleX;if(o==1)h==MixBlend.add?a.scaleX+=d-a.data.scaleX:a.scaleX=d;else{let p=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:p=a.data.scaleX,a.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*o;break;case MixBlend.first:case MixBlend.replace:p=a.scaleX,a.scaleX=p+(Math.abs(d)*MathUtils.signum(p)-p)*o;break;case MixBlend.add:a.scaleX+=(d-a.data.scaleX)*o}else switch(h){case MixBlend.setup:p=Math.abs(a.data.scaleX)*MathUtils.signum(d),a.scaleX=p+(d-p)*o;break;case MixBlend.first:case MixBlend.replace:p=Math.abs(a.scaleX)*MathUtils.signum(d),a.scaleX=p+(d-p)*o;break;case MixBlend.add:a.scaleX+=(d-a.data.scaleX)*o}}}}class ScaleYTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.scaleY=a.data.scaleY;return;case MixBlend.first:a.scaleY+=(a.data.scaleY-a.scaleY)*o}return}const d=this.getCurveValue(s)*a.data.scaleY;if(o==1)h==MixBlend.add?a.scaleY+=d-a.data.scaleY:a.scaleY=d;else{let p=0;if(c==MixDirection.mixOut)switch(h){case MixBlend.setup:p=a.data.scaleY,a.scaleY=p+(Math.abs(d)*MathUtils.signum(p)-p)*o;break;case MixBlend.first:case MixBlend.replace:p=a.scaleY,a.scaleY=p+(Math.abs(d)*MathUtils.signum(p)-p)*o;break;case MixBlend.add:a.scaleY+=(d-a.data.scaleY)*o}else switch(h){case MixBlend.setup:p=Math.abs(a.data.scaleY)*MathUtils.signum(d),a.scaleY=p+(d-p)*o;break;case MixBlend.first:case MixBlend.replace:p=Math.abs(a.scaleY)*MathUtils.signum(d),a.scaleY=p+(d-p)*o;break;case MixBlend.add:a.scaleY+=(d-a.data.scaleY)*o}}}}class ShearTimeline extends CurveTimeline2{constructor(e,t,s){super(e,t,`${Property.shearX}|${s}`,`${Property.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.shearX=a.data.shearX,a.shearY=a.data.shearY;return;case MixBlend.first:a.shearX+=(a.data.shearX-a.shearX)*o,a.shearY+=(a.data.shearY-a.shearY)*o}return}let d=0,p=0;const m=Timeline$1.search(u,s,3),g=this.curves[m/3];switch(g){case 0:const _=u[m];d=u[m+1],p=u[m+2];const y=(s-_)/(u[m+3]-_);d+=(u[m+3+1]-d)*y,p+=(u[m+3+2]-p)*y;break;case 1:d=u[m+1],p=u[m+2];break;default:d=this.getBezierValue(s,m,1,g-2),p=this.getBezierValue(s,m,2,g+18-2)}switch(h){case MixBlend.setup:a.shearX=a.data.shearX+d*o,a.shearY=a.data.shearY+p*o;break;case MixBlend.first:case MixBlend.replace:a.shearX+=(a.data.shearX+d-a.shearX)*o,a.shearY+=(a.data.shearY+p-a.shearY)*o;break;case MixBlend.add:a.shearX+=d*o,a.shearY+=p*o}}}class ShearXTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.shearX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.shearX=a.data.shearX;return;case MixBlend.first:a.shearX+=(a.data.shearX-a.shearX)*o}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:a.shearX=a.data.shearX+d*o;break;case MixBlend.first:case MixBlend.replace:a.shearX+=(a.data.shearX+d-a.shearX)*o;break;case MixBlend.add:a.shearX+=d*o}}}class ShearYTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(e,t,s,r,o,h,c){const a=e.bones[this.boneIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.shearY=a.data.shearY;return;case MixBlend.first:a.shearY+=(a.data.shearY-a.shearY)*o}return}const d=this.getCurveValue(s);switch(h){case MixBlend.setup:a.shearY=a.data.shearY+d*o;break;case MixBlend.first:case MixBlend.replace:a.shearY+=(a.data.shearY+d-a.shearY)*o;break;case MixBlend.add:a.shearY+=d*o}}}class RGBATimeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.rgb}|${s}`,`${Property.alpha}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 5}setFrame(e,t,s,r,o,h){e*=5,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=h}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames,d=a.color;if(s<u[0]){const N=a.data.color;switch(h){case MixBlend.setup:d.setFromColor(N);return;case MixBlend.first:d.add((N.r-d.r)*o,(N.g-d.g)*o,(N.b-d.b)*o,(N.a-d.a)*o)}return}let p=0,m=0,g=0,_=0;const y=Timeline$1.search(u,s,5),v=this.curves[y/5];switch(v){case 0:const N=u[y];p=u[y+1],m=u[y+2],g=u[y+3],_=u[y+4];const w=(s-N)/(u[y+5]-N);p+=(u[y+5+1]-p)*w,m+=(u[y+5+2]-m)*w,g+=(u[y+5+3]-g)*w,_+=(u[y+5+4]-_)*w;break;case 1:p=u[y+1],m=u[y+2],g=u[y+3],_=u[y+4];break;default:p=this.getBezierValue(s,y,1,v-2),m=this.getBezierValue(s,y,2,v+18-2),g=this.getBezierValue(s,y,3,v+18*2-2),_=this.getBezierValue(s,y,4,v+18*3-2)}o==1?d.set(p,m,g,_):(h==MixBlend.setup&&d.setFromColor(a.data.color),d.add((p-d.r)*o,(m-d.g)*o,(g-d.b)*o,(_-d.a)*o))}}class RGBTimeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.rgb}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 4}setFrame(e,t,s,r,o){e<<=2,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames,d=a.color;if(s<u[0]){const v=a.data.color;switch(h){case MixBlend.setup:d.r=v.r,d.g=v.g,d.b=v.b;return;case MixBlend.first:d.r+=(v.r-d.r)*o,d.g+=(v.g-d.g)*o,d.b+=(v.b-d.b)*o}return}let p=0,m=0,g=0;const _=Timeline$1.search(u,s,4),y=this.curves[_>>2];switch(y){case 0:const v=u[_];p=u[_+1],m=u[_+2],g=u[_+3];const N=(s-v)/(u[_+4]-v);p+=(u[_+4+1]-p)*N,m+=(u[_+4+2]-m)*N,g+=(u[_+4+3]-g)*N;break;case 1:p=u[_+1],m=u[_+2],g=u[_+3];break;default:p=this.getBezierValue(s,_,1,y-2),m=this.getBezierValue(s,_,2,y+18-2),g=this.getBezierValue(s,_,3,y+18*2-2)}if(o==1)d.r=p,d.g=m,d.b=g;else{if(h==MixBlend.setup){const v=a.data.color;d.r=v.r,d.g=v.g,d.b=v.b}d.r+=(p-d.r)*o,d.g+=(m-d.g)*o,d.b+=(g-d.b)*o}}}class AlphaTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.alpha}|${s}`),this.slotIndex=0,this.slotIndex=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=a.color;if(s<this.frames[0]){const p=a.data.color;switch(h){case MixBlend.setup:u.a=p.a;return;case MixBlend.first:u.a+=(p.a-u.a)*o}return}const d=this.getCurveValue(s);o==1?u.a=d:(h==MixBlend.setup&&(u.a=a.data.color.a),u.a+=(d-u.a)*o)}}class RGBA2Timeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.rgb}|${s}`,`${Property.alpha}|${s}`,`${Property.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 8}setFrame(e,t,s,r,o,h,c,a,u){e<<=3,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=h,this.frames[e+5]=c,this.frames[e+6]=a,this.frames[e+7]=u}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames,d=a.color,p=a.darkColor;if(s<u[0]){const ee=a.data.color,ie=a.data.darkColor;switch(h){case MixBlend.setup:d.setFromColor(ee),p.r=ie.r,p.g=ie.g,p.b=ie.b;return;case MixBlend.first:d.add((ee.r-d.r)*o,(ee.g-d.g)*o,(ee.b-d.b)*o,(ee.a-d.a)*o),p.r+=(ie.r-p.r)*o,p.g+=(ie.g-p.g)*o,p.b+=(ie.b-p.b)*o}return}let m=0,g=0,_=0,y=0,v=0,N=0,w=0;const k=Timeline$1.search(u,s,8),U=this.curves[k>>3];switch(U){case 0:const ee=u[k];m=u[k+1],g=u[k+2],_=u[k+3],y=u[k+4],v=u[k+5],N=u[k+6],w=u[k+7];const ie=(s-ee)/(u[k+8]-ee);m+=(u[k+8+1]-m)*ie,g+=(u[k+8+2]-g)*ie,_+=(u[k+8+3]-_)*ie,y+=(u[k+8+4]-y)*ie,v+=(u[k+8+5]-v)*ie,N+=(u[k+8+6]-N)*ie,w+=(u[k+8+7]-w)*ie;break;case 1:m=u[k+1],g=u[k+2],_=u[k+3],y=u[k+4],v=u[k+5],N=u[k+6],w=u[k+7];break;default:m=this.getBezierValue(s,k,1,U-2),g=this.getBezierValue(s,k,2,U+18-2),_=this.getBezierValue(s,k,3,U+18*2-2),y=this.getBezierValue(s,k,4,U+18*3-2),v=this.getBezierValue(s,k,5,U+18*4-2),N=this.getBezierValue(s,k,6,U+18*5-2),w=this.getBezierValue(s,k,7,U+18*6-2)}if(o==1)d.set(m,g,_,y),p.r=v,p.g=N,p.b=w;else{if(h==MixBlend.setup){d.setFromColor(a.data.color);const ee=a.data.darkColor;p.r=ee.r,p.g=ee.g,p.b=ee.b}d.add((m-d.r)*o,(g-d.g)*o,(_-d.b)*o,(y-d.a)*o),p.r+=(v-p.r)*o,p.g+=(N-p.g)*o,p.b+=(w-p.b)*o}}}class RGB2Timeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.rgb}|${s}`,`${Property.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 7}setFrame(e,t,s,r,o,h,c,a){e*=7,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=h,this.frames[e+5]=c,this.frames[e+6]=a}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=this.frames,d=a.color,p=a.darkColor;if(s<u[0]){const U=a.data.color,ee=a.data.darkColor;switch(h){case MixBlend.setup:d.r=U.r,d.g=U.g,d.b=U.b,p.r=ee.r,p.g=ee.g,p.b=ee.b;return;case MixBlend.first:d.r+=(U.r-d.r)*o,d.g+=(U.g-d.g)*o,d.b+=(U.b-d.b)*o,p.r+=(ee.r-p.r)*o,p.g+=(ee.g-p.g)*o,p.b+=(ee.b-p.b)*o}return}let m=0,g=0,_=0,y=0,v=0,N=0;const w=Timeline$1.search(u,s,7),k=this.curves[w/7];switch(k){case 0:const U=u[w];m=u[w+1],g=u[w+2],_=u[w+3],y=u[w+4],v=u[w+5],N=u[w+6];const ee=(s-U)/(u[w+7]-U);m+=(u[w+7+1]-m)*ee,g+=(u[w+7+2]-g)*ee,_+=(u[w+7+3]-_)*ee,y+=(u[w+7+4]-y)*ee,v+=(u[w+7+5]-v)*ee,N+=(u[w+7+6]-N)*ee;break;case 1:m=u[w+1],g=u[w+2],_=u[w+3],y=u[w+4],v=u[w+5],N=u[w+6];break;default:m=this.getBezierValue(s,w,1,k-2),g=this.getBezierValue(s,w,2,k+18-2),_=this.getBezierValue(s,w,3,k+18*2-2),y=this.getBezierValue(s,w,4,k+18*3-2),v=this.getBezierValue(s,w,5,k+18*4-2),N=this.getBezierValue(s,w,6,k+18*5-2)}if(o==1)d.r=m,d.g=g,d.b=_,p.r=y,p.g=v,p.b=N;else{if(h==MixBlend.setup){const U=a.data.color,ee=a.data.darkColor;d.r=U.r,d.g=U.g,d.b=U.b,p.r=ee.r,p.g=ee.g,p.b=ee.b}d.r+=(m-d.r)*o,d.g+=(g-d.g)*o,d.b+=(_-d.b)*o,p.r+=(y-p.r)*o,p.g+=(v-p.g)*o,p.b+=(N-p.b)*o}}}class AttachmentTimeline extends Timeline$1{constructor(e,t){super(e,[`${Property.attachment}|${t}`]),this.slotIndex=0,this.slotIndex=t,this.attachmentNames=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.attachmentNames[e]=s}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(a.bone.active){if(c==MixDirection.mixOut){h==MixBlend.setup&&this.setAttachment(e,a,a.data.attachmentName);return}if(s<this.frames[0]){(h==MixBlend.setup||h==MixBlend.first)&&this.setAttachment(e,a,a.data.attachmentName);return}this.setAttachment(e,a,this.attachmentNames[Timeline$1.search1(this.frames,s)])}}setAttachment(e,t,s){t.setAttachment(s?e.getAttachment(this.slotIndex,s):null)}}class DeformTimeline extends CurveTimeline{constructor(e,t,s,r){super(e,t,[`${Property.deform}|${s}|${r.id}`]),this.slotIndex=0,this.slotIndex=s,this.attachment=r,this.vertices=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,t,s){this.frames[e]=t,this.vertices[e]=s}setBezier(e,t,s,r,o,h,c,a,u,d,p){const m=this.curves;let g=this.getFrameCount()+e*18;s==0&&(m[t]=2+g);const _=(r-h*2+a)*.03,y=u*.03-c*.06,v=((h-a)*3-r+d)*.006,N=(c-u+.33333333)*.018;let w=_*2+v,k=y*2+N,U=(h-r)*.3+_+v*.16666667,ee=c*.3+y+N*.16666667,ie=r+U,se=ee;for(let oe=g+18;g<oe;g+=2)m[g]=ie,m[g+1]=se,U+=w,ee+=k,w+=v,k+=N,ie+=U,se+=ee}getCurvePercent(e,t){const s=this.curves;let r=s[t];switch(r){case 0:const a=this.frames[t];return(e-a)/(this.frames[t+this.getFrameEntries()]-a);case 1:return 0}if(r-=2,s[r]>e){const a=this.frames[t];return s[r+1]*(e-a)/(s[r]-a)}const o=r+18;for(r+=2;r<o;r+=2)if(s[r]>=e){const a=s[r-2],u=s[r-1];return u+(e-a)/(s[r]-a)*(s[r+1]-u)}const h=s[o-2],c=s[o-1];return c+(1-c)*(e-h)/(this.frames[t+this.getFrameEntries()]-h)}apply(e,t,s,r,o,h,c){const a=e.slots[this.slotIndex];if(!a.bone.active)return;const u=a.getAttachment();if(!u||!(u instanceof VertexAttachment)||u.timelineAttachment!=this.attachment)return;const d=a.deform;d.length==0&&(h=MixBlend.setup);const p=this.vertices,m=p[0].length,g=this.frames;if(s<g[0]){switch(h){case MixBlend.setup:d.length=0;return;case MixBlend.first:if(o==1){d.length=0;return}d.length=m;const w=u;if(w.bones){o=1-o;for(let k=0;k<m;k++)d[k]*=o}else{const k=w.vertices;for(let U=0;U<m;U++)d[U]+=(k[U]-d[U])*o}}return}if(d.length=m,s>=g[g.length-1]){const w=p[g.length-1];if(o==1)if(h==MixBlend.add){const k=u;if(k.bones)for(let U=0;U<m;U++)d[U]+=w[U];else{const U=k.vertices;for(let ee=0;ee<m;ee++)d[ee]+=w[ee]-U[ee]}}else Utils.arrayCopy(w,0,d,0,m);else switch(h){case MixBlend.setup:{const U=u;if(U.bones)for(let ee=0;ee<m;ee++)d[ee]=w[ee]*o;else{const ee=U.vertices;for(let ie=0;ie<m;ie++){const se=ee[ie];d[ie]=se+(w[ie]-se)*o}}break}case MixBlend.first:case MixBlend.replace:for(let U=0;U<m;U++)d[U]+=(w[U]-d[U])*o;break;case MixBlend.add:const k=u;if(k.bones)for(let U=0;U<m;U++)d[U]+=w[U]*o;else{const U=k.vertices;for(let ee=0;ee<m;ee++)d[ee]+=(w[ee]-U[ee])*o}}return}const _=Timeline$1.search1(g,s),y=this.getCurvePercent(s,_),v=p[_],N=p[_+1];if(o==1)if(h==MixBlend.add){const w=u;if(w.bones)for(let k=0;k<m;k++){const U=v[k];d[k]+=U+(N[k]-U)*y}else{const k=w.vertices;for(let U=0;U<m;U++){const ee=v[U];d[U]+=ee+(N[U]-ee)*y-k[U]}}}else for(let w=0;w<m;w++){const k=v[w];d[w]=k+(N[w]-k)*y}else switch(h){case MixBlend.setup:{const k=u;if(k.bones)for(let U=0;U<m;U++){const ee=v[U];d[U]=(ee+(N[U]-ee)*y)*o}else{const U=k.vertices;for(let ee=0;ee<m;ee++){const ie=v[ee],se=U[ee];d[ee]=se+(ie+(N[ee]-ie)*y-se)*o}}break}case MixBlend.first:case MixBlend.replace:for(let k=0;k<m;k++){const U=v[k];d[k]+=(U+(N[k]-U)*y-d[k])*o}break;case MixBlend.add:const w=u;if(w.bones)for(let k=0;k<m;k++){const U=v[k];d[k]+=(U+(N[k]-U)*y)*o}else{const k=w.vertices;for(let U=0;U<m;U++){const ee=v[U];d[U]+=(ee+(N[U]-ee)*y-k[U])*o}}}}}const _EventTimeline=class extends Timeline$1{constructor(n){super(n,_EventTimeline.propertyIds),this.events=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,e){this.frames[n]=e.time,this.events[n]=e}apply(n,e,t,s,r,o,h){if(!s)return;const c=this.frames,a=this.frames.length;if(e>t)this.apply(n,e,Number.MAX_VALUE,s,r,o,h),e=-1;else if(e>=c[a-1])return;if(t<c[0])return;let u=0;if(e<c[0])u=0;else{u=Timeline$1.search1(c,e)+1;const d=c[u];for(;u>0&&c[u-1]==d;)u--}for(;u<a&&t>=c[u];u++)s.push(this.events[u])}};let EventTimeline=_EventTimeline;EventTimeline.propertyIds=[`${Property.event}`];const _DrawOrderTimeline=class extends Timeline$1{constructor(n){super(n,_DrawOrderTimeline.propertyIds),this.drawOrders=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,e,t){this.frames[n]=e,this.drawOrders[n]=t}apply(n,e,t,s,r,o,h){if(h==MixDirection.mixOut){o==MixBlend.setup&&Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}if(t<this.frames[0]){(o==MixBlend.setup||o==MixBlend.first)&&Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}const c=Timeline$1.search1(this.frames,t),a=this.drawOrders[c];if(!a)Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{const u=n.drawOrder,d=n.slots;for(let p=0,m=a.length;p<m;p++)u[p]=d[a[p]]}}};let DrawOrderTimeline=_DrawOrderTimeline;DrawOrderTimeline.propertyIds=[`${Property.drawOrder}`];class IkConstraintTimeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.ikConstraint}|${s}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=s}getFrameEntries(){return 6}setFrame(e,t,s,r,o,h,c){e*=6,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=h?1:0,this.frames[e+5]=c?1:0}apply(e,t,s,r,o,h,c){const a=e.ikConstraints[this.ikConstraintIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch;return;case MixBlend.first:a.mix+=(a.data.mix-a.mix)*o,a.softness+=(a.data.softness-a.softness)*o,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}let d=0,p=0;const m=Timeline$1.search(u,s,6),g=this.curves[m/6];switch(g){case 0:const _=u[m];d=u[m+1],p=u[m+2];const y=(s-_)/(u[m+6]-_);d+=(u[m+6+1]-d)*y,p+=(u[m+6+2]-p)*y;break;case 1:d=u[m+1],p=u[m+2];break;default:d=this.getBezierValue(s,m,1,g-2),p=this.getBezierValue(s,m,2,g+18-2)}h==MixBlend.setup?(a.mix=a.data.mix+(d-a.data.mix)*o,a.softness=a.data.softness+(p-a.data.softness)*o,c==MixDirection.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=u[m+3],a.compress=u[m+4]!=0,a.stretch=u[m+5]!=0)):(a.mix+=(d-a.mix)*o,a.softness+=(p-a.softness)*o,c==MixDirection.mixIn&&(a.bendDirection=u[m+3],a.compress=u[m+4]!=0,a.stretch=u[m+5]!=0))}}class TransformConstraintTimeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.transformConstraint}|${s}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=s}getFrameEntries(){return 7}setFrame(e,t,s,r,o,h,c,a){const u=this.frames;e*=7,u[e]=t,u[e+1]=s,u[e+2]=r,u[e+3]=o,u[e+4]=h,u[e+5]=c,u[e+6]=a}apply(e,t,s,r,o,h,c){const a=e.transformConstraints[this.transformConstraintIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){const w=a.data;switch(h){case MixBlend.setup:a.mixRotate=w.mixRotate,a.mixX=w.mixX,a.mixY=w.mixY,a.mixScaleX=w.mixScaleX,a.mixScaleY=w.mixScaleY,a.mixShearY=w.mixShearY;return;case MixBlend.first:a.mixRotate+=(w.mixRotate-a.mixRotate)*o,a.mixX+=(w.mixX-a.mixX)*o,a.mixY+=(w.mixY-a.mixY)*o,a.mixScaleX+=(w.mixScaleX-a.mixScaleX)*o,a.mixScaleY+=(w.mixScaleY-a.mixScaleY)*o,a.mixShearY+=(w.mixShearY-a.mixShearY)*o}return}let d,p,m,g,_,y;const v=Timeline$1.search(u,s,7),N=this.curves[v/7];switch(N){case 0:const w=u[v];d=u[v+1],p=u[v+2],m=u[v+3],g=u[v+4],_=u[v+5],y=u[v+6];const k=(s-w)/(u[v+7]-w);d+=(u[v+7+1]-d)*k,p+=(u[v+7+2]-p)*k,m+=(u[v+7+3]-m)*k,g+=(u[v+7+4]-g)*k,_+=(u[v+7+5]-_)*k,y+=(u[v+7+6]-y)*k;break;case 1:d=u[v+1],p=u[v+2],m=u[v+3],g=u[v+4],_=u[v+5],y=u[v+6];break;default:d=this.getBezierValue(s,v,1,N-2),p=this.getBezierValue(s,v,2,N+18-2),m=this.getBezierValue(s,v,3,N+18*2-2),g=this.getBezierValue(s,v,4,N+18*3-2),_=this.getBezierValue(s,v,5,N+18*4-2),y=this.getBezierValue(s,v,6,N+18*5-2)}if(h==MixBlend.setup){const w=a.data;a.mixRotate=w.mixRotate+(d-w.mixRotate)*o,a.mixX=w.mixX+(p-w.mixX)*o,a.mixY=w.mixY+(m-w.mixY)*o,a.mixScaleX=w.mixScaleX+(g-w.mixScaleX)*o,a.mixScaleY=w.mixScaleY+(_-w.mixScaleY)*o,a.mixShearY=w.mixShearY+(y-w.mixShearY)*o}else a.mixRotate+=(d-a.mixRotate)*o,a.mixX+=(p-a.mixX)*o,a.mixY+=(m-a.mixY)*o,a.mixScaleX+=(g-a.mixScaleX)*o,a.mixScaleY+=(_-a.mixScaleY)*o,a.mixShearY+=(y-a.mixShearY)*o}}class PathConstraintPositionTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.pathConstraintPosition}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(e,t,s,r,o,h,c){const a=e.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.position=a.data.position;return;case MixBlend.first:a.position+=(a.data.position-a.position)*o}return}const d=this.getCurveValue(s);h==MixBlend.setup?a.position=a.data.position+(d-a.data.position)*o:a.position+=(d-a.position)*o}}class PathConstraintSpacingTimeline extends CurveTimeline1{constructor(e,t,s){super(e,t,`${Property.pathConstraintSpacing}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(e,t,s,r,o,h,c){const a=e.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.spacing=a.data.spacing;return;case MixBlend.first:a.spacing+=(a.data.spacing-a.spacing)*o}return}const d=this.getCurveValue(s);h==MixBlend.setup?a.spacing=a.data.spacing+(d-a.data.spacing)*o:a.spacing+=(d-a.spacing)*o}}class PathConstraintMixTimeline extends CurveTimeline{constructor(e,t,s){super(e,t,[`${Property.pathConstraintMix}|${s}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=s}getFrameEntries(){return 4}setFrame(e,t,s,r,o){const h=this.frames;e<<=2,h[e]=t,h[e+1]=s,h[e+2]=r,h[e+3]=o}apply(e,t,s,r,o,h,c){const a=e.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const u=this.frames;if(s<u[0]){switch(h){case MixBlend.setup:a.mixRotate=a.data.mixRotate,a.mixX=a.data.mixX,a.mixY=a.data.mixY;return;case MixBlend.first:a.mixRotate+=(a.data.mixRotate-a.mixRotate)*o,a.mixX+=(a.data.mixX-a.mixX)*o,a.mixY+=(a.data.mixY-a.mixY)*o}return}let d,p,m;const g=Timeline$1.search(u,s,4),_=this.curves[g>>2];switch(_){case 0:const y=u[g];d=u[g+1],p=u[g+2],m=u[g+3];const v=(s-y)/(u[g+4]-y);d+=(u[g+4+1]-d)*v,p+=(u[g+4+2]-p)*v,m+=(u[g+4+3]-m)*v;break;case 1:d=u[g+1],p=u[g+2],m=u[g+3];break;default:d=this.getBezierValue(s,g,1,_-2),p=this.getBezierValue(s,g,2,_+18-2),m=this.getBezierValue(s,g,3,_+18*2-2)}if(h==MixBlend.setup){const y=a.data;a.mixRotate=y.mixRotate+(d-y.mixRotate)*o,a.mixX=y.mixX+(p-y.mixX)*o,a.mixY=y.mixY+(m-y.mixY)*o}else a.mixRotate+=(d-a.mixRotate)*o,a.mixX+=(p-a.mixX)*o,a.mixY+=(m-a.mixY)*o}}const _SequenceTimeline=class extends Timeline$1{constructor(n,e,t){super(n,[`${Property.sequence}|${e}|${t.sequence.id}`]),this.slotIndex=e,this.attachment=t}getFrameEntries(){return _SequenceTimeline.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(n,e,t,s,r){const o=this.frames;n*=_SequenceTimeline.ENTRIES,o[n]=e,o[n+_SequenceTimeline.MODE]=t|s<<4,o[n+_SequenceTimeline.DELAY]=r}apply(n,e,t,s,r,o,h){const c=n.slots[this.slotIndex];if(!c.bone.active)return;const a=c.attachment,u=this.attachment;if(a!=u&&(!(a instanceof VertexAttachment)||a.timelineAttachment!=u))return;const d=this.frames;if(t<d[0]){(o==MixBlend.setup||o==MixBlend.first)&&(c.sequenceIndex=-1);return}const p=Timeline$1.search(d,t,_SequenceTimeline.ENTRIES),m=d[p],g=d[p+_SequenceTimeline.MODE],_=d[p+_SequenceTimeline.DELAY];if(!this.attachment.sequence)return;let y=g>>4;const v=this.attachment.sequence.regions.length,N=SequenceModeValues[g&15];if(N!=SequenceMode.hold)switch(y+=(t-m)/_+1e-5|0,N){case SequenceMode.once:y=Math.min(v-1,y);break;case SequenceMode.loop:y%=v;break;case SequenceMode.pingpong:{const w=(v<<1)-2;y=w==0?0:y%w,y>=v&&(y=w-y);break}case SequenceMode.onceReverse:y=Math.max(v-1-y,0);break;case SequenceMode.loopReverse:y=v-1-y%v;break;case SequenceMode.pingpongReverse:{const w=(v<<1)-2;y=w==0?0:(y+v-1)%w,y>=v&&(y=w-y)}}c.sequenceIndex=y}};let SequenceTimeline=_SequenceTimeline;SequenceTimeline.ENTRIES=3;SequenceTimeline.MODE=1;SequenceTimeline.DELAY=2;new Animation$2("<empty>",[],0);class AtlasAttachmentLoader{constructor(e){this.atlas=e}loadSequence(e,t,s){const r=s.regions;for(let o=0,h=r.length;o<h;o++){const c=s.getPath(t,o),a=this.atlas.findRegion(c);if(a==null)throw new Error(`Region not found in atlas: ${c} (sequence: ${e})`);r[o]=a,r[o].renderObject=r[o]}}newRegionAttachment(e,t,s,r){const o=new RegionAttachment(t,s);if(r!=null)this.loadSequence(t,s,r);else{const h=this.atlas.findRegion(s);if(!h)throw new Error(`Region not found in atlas: ${s} (region attachment: ${t})`);h.renderObject=h,o.region=h}return o}newMeshAttachment(e,t,s,r){const o=new MeshAttachment(t,s);if(r!=null)this.loadSequence(t,s,r);else{const h=this.atlas.findRegion(s);if(!h)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${t})`);h.renderObject=h,o.region=h}return o}newBoundingBoxAttachment(e,t){return new BoundingBoxAttachment(t)}newPathAttachment(e,t){return new PathAttachment(t)}newPointAttachment(e,t){return new PointAttachment(t)}newClippingAttachment(e,t){return new ClippingAttachment(t)}}class BoneData{constructor(e,t,s){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,this.skinRequired=!1,this.color=new Color,e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=s}}class ConstraintData{constructor(e,t,s){this.name=e,this.order=t,this.skinRequired=s}}let Event$1=class{constructor(e,t){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!t)throw new Error("data cannot be null.");this.time=e,this.data=t}};class EventData{constructor(e){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=e}}class IkConstraintData extends ConstraintData{constructor(e){super(e,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class PathConstraintData extends ConstraintData{constructor(e){super(e,0,!1),this.bones=new Array,this._target=null,this.positionMode=PositionMode.Fixed,this.spacingMode=SpacingMode.Fixed,this.rotateMode=RotateMode.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var SpacingMode=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n[n.Proportional=3]="Proportional",n))(SpacingMode||{});class SkeletonData{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(e){if(!e)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findBoneIndex(e){if(!e)throw new Error("boneName cannot be null.");const t=this.bones;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSlot(e){if(!e)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findSlotIndex(e){if(!e)throw new Error("slotName cannot be null.");const t=this.slots;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}findSkin(e){if(!e)throw new Error("skinName cannot be null.");const t=this.skins;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findEvent(e){if(!e)throw new Error("eventDataName cannot be null.");const t=this.events;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findAnimation(e){if(!e)throw new Error("animationName cannot be null.");const t=this.animations;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.name==e)return o}return null}findPathConstraintIndex(e){if(e==null)throw new Error("pathConstraintName cannot be null.");const t=this.pathConstraints;for(let s=0,r=t.length;s<r;s++)if(t[s].name==e)return s;return-1}}class SlotData{constructor(e,t,s){if(this.index=0,this.color=new Color(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=BLEND_MODES.NORMAL,e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=s}}class TransformConstraintData extends ConstraintData{constructor(e){super(e,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class SkinEntry{constructor(e,t,s){this.slotIndex=e,this.name=t,this.attachment=s}}class Skin{constructor(e){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!e)throw new Error("name cannot be null.");this.name=e}setAttachment(e,t,s){if(!s)throw new Error("attachment cannot be null.");const r=this.attachments;e>=r.length&&(r.length=e+1),r[e]||(r[e]={}),r[e][t]=s}addSkin(e){for(let s=0;s<e.bones.length;s++){const r=e.bones[s];let o=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){const r=e.constraints[s];let o=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){o=!0;break}o||this.constraints.push(r)}const t=e.getAttachments();for(let s=0;s<t.length;s++){const r=t[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(e){for(let s=0;s<e.bones.length;s++){const r=e.bones[s];let o=!1;for(let h=0;h<this.bones.length;h++)if(this.bones[h]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){const r=e.constraints[s];let o=!1;for(let h=0;h<this.constraints.length;h++)if(this.constraints[h]==r){o=!0;break}o||this.constraints.push(r)}const t=e.getAttachments();for(let s=0;s<t.length;s++){const r=t[s];r.attachment&&(r.attachment instanceof MeshAttachment?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(e,t){const s=this.attachments[e];return s?s[t]:null}removeAttachment(e,t){const s=this.attachments[e];s&&delete s[t]}getAttachments(){const e=new Array;for(let t=0;t<this.attachments.length;t++){const s=this.attachments[t];if(s)for(const r in s){const o=s[r];o&&e.push(new SkinEntry(t,r,o))}}return e}getAttachmentsForSlot(e,t){const s=this.attachments[e];if(s)for(const r in s){const o=s[r];o&&t.push(new SkinEntry(e,r,o))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,t){let s=0;for(let r=0;r<e.slots.length;r++){const o=e.slots[r],h=o.getAttachment();if(h&&s<t.attachments.length){const c=t.attachments[s];for(const a in c){const u=c[a];if(h==u){const d=this.getAttachment(s,a);d&&o.setAttachment(d);break}}}s++}}}class SkeletonBinary{constructor(e){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}readSkeletonData(e){const t=this.scale,s=new SkeletonData;s.name="";const r=new BinaryInput(e),o=r.readInt32(),h=r.readInt32();s.hash=h==0&&o==0?null:h.toString(16)+o.toString(16),s.version=r.readString();const c=s.version.substr(0,3);if(c!=="4.0"&&c!=="4.1"){const p=`Spine 4.1 loader cant load version ${s.version}. Please configure your pixi-spine bundle`;console.error(p)}this.ver40=c==="4.0",s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat();const a=r.readBoolean();a&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());let u=0;u=r.readInt(!0);for(let p=0;p<u;p++){const m=r.readString();if(!m)throw new Error("String in string table must not be null.");r.strings.push(m)}u=r.readInt(!0);for(let p=0;p<u;p++){const m=r.readString();if(!m)throw new Error("Bone name must not be null.");const g=p==0?null:s.bones[r.readInt(!0)],_=new BoneData(p,m,g);_.rotation=r.readFloat(),_.x=r.readFloat()*t,_.y=r.readFloat()*t,_.scaleX=r.readFloat(),_.scaleY=r.readFloat(),_.shearX=r.readFloat(),_.shearY=r.readFloat(),_.length=r.readFloat()*t,_.transformMode=r.readInt(!0),_.skinRequired=r.readBoolean(),a&&Color.rgba8888ToColor(_.color,r.readInt32()),s.bones.push(_)}u=r.readInt(!0);for(let p=0;p<u;p++){const m=r.readString();if(!m)throw new Error("Slot name must not be null.");const g=s.bones[r.readInt(!0)],_=new SlotData(p,m,g);Color.rgba8888ToColor(_.color,r.readInt32());const y=r.readInt32();y!=-1&&Color.rgb888ToColor(_.darkColor=new Color,y),_.attachmentName=r.readStringRef(),_.blendMode=r.readInt(!0),s.slots.push(_)}u=r.readInt(!0);for(let p=0,m;p<u;p++){const g=r.readString();if(!g)throw new Error("IK constraint data name must not be null.");const _=new IkConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),m=r.readInt(!0);for(let y=0;y<m;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.bones[r.readInt(!0)],_.mix=r.readFloat(),_.softness=r.readFloat()*t,_.bendDirection=r.readByte(),_.compress=r.readBoolean(),_.stretch=r.readBoolean(),_.uniform=r.readBoolean(),s.ikConstraints.push(_)}u=r.readInt(!0);for(let p=0,m;p<u;p++){const g=r.readString();if(!g)throw new Error("Transform constraint data name must not be null.");const _=new TransformConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),m=r.readInt(!0);for(let y=0;y<m;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.bones[r.readInt(!0)],_.local=r.readBoolean(),_.relative=r.readBoolean(),_.offsetRotation=r.readFloat(),_.offsetX=r.readFloat()*t,_.offsetY=r.readFloat()*t,_.offsetScaleX=r.readFloat(),_.offsetScaleY=r.readFloat(),_.offsetShearY=r.readFloat(),_.mixRotate=r.readFloat(),_.mixX=r.readFloat(),_.mixY=r.readFloat(),_.mixScaleX=r.readFloat(),_.mixScaleY=r.readFloat(),_.mixShearY=r.readFloat(),s.transformConstraints.push(_)}u=r.readInt(!0);for(let p=0,m;p<u;p++){const g=r.readString();if(!g)throw new Error("Path constraint data name must not be null.");const _=new PathConstraintData(g);_.order=r.readInt(!0),_.skinRequired=r.readBoolean(),m=r.readInt(!0);for(let y=0;y<m;y++)_.bones.push(s.bones[r.readInt(!0)]);_.target=s.slots[r.readInt(!0)],_.positionMode=r.readInt(!0),_.spacingMode=r.readInt(!0),_.rotateMode=r.readInt(!0),_.offsetRotation=r.readFloat(),_.position=r.readFloat(),_.positionMode==PositionMode.Fixed&&(_.position*=t),_.spacing=r.readFloat(),(_.spacingMode==SpacingMode.Length||_.spacingMode==SpacingMode.Fixed)&&(_.spacing*=t),_.mixRotate=r.readFloat(),_.mixX=r.readFloat(),_.mixY=r.readFloat(),s.pathConstraints.push(_)}const d=this.readSkin(r,s,!0,a);d&&(s.defaultSkin=d,s.skins.push(d));{let p=s.skins.length;for(Utils.setArraySize(s.skins,u=p+r.readInt(!0));p<u;p++){const m=this.readSkin(r,s,!1,a);if(!m)throw new Error("readSkin() should not have returned null.");s.skins[p]=m}}u=this.linkedMeshes.length;for(let p=0;p<u;p++){const m=this.linkedMeshes[p],g=m.skin?s.findSkin(m.skin):s.defaultSkin;if(!g)throw new Error("Not skin found for linked mesh.");if(!m.parent)throw new Error("Linked mesh parent must not be null");const _=g.getAttachment(m.slotIndex,m.parent);if(!_)throw new Error(`Parent mesh not found: ${m.parent}`);m.mesh.timelineAttachment=m.inheritTimeline?_:m.mesh,m.mesh.setParentMesh(_)}this.linkedMeshes.length=0,u=r.readInt(!0);for(let p=0;p<u;p++){const m=r.readStringRef();if(!m)throw new Error;const g=new EventData(m);g.intValue=r.readInt(!1),g.floatValue=r.readFloat(),g.stringValue=r.readString(),g.audioPath=r.readString(),g.audioPath&&(g.volume=r.readFloat(),g.balance=r.readFloat()),s.events.push(g)}u=r.readInt(!0);for(let p=0;p<u;p++){const m=r.readString();if(!m)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(r,m,s))}return s}readSkin(e,t,s,r){let o=null,h=0;if(s){if(h=e.readInt(!0),h==0)return null;o=new Skin("default")}else{const c=e.readStringRef();if(!c)throw new Error("Skin name must not be null.");o=new Skin(c),o.bones.length=e.readInt(!0);for(let a=0,u=o.bones.length;a<u;a++)o.bones[a]=t.bones[e.readInt(!0)];for(let a=0,u=e.readInt(!0);a<u;a++)o.constraints.push(t.ikConstraints[e.readInt(!0)]);for(let a=0,u=e.readInt(!0);a<u;a++)o.constraints.push(t.transformConstraints[e.readInt(!0)]);for(let a=0,u=e.readInt(!0);a<u;a++)o.constraints.push(t.pathConstraints[e.readInt(!0)]);h=e.readInt(!0)}for(let c=0;c<h;c++){const a=e.readInt(!0);for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readStringRef();if(!p)throw new Error("Attachment name must not be null");const m=this.readAttachment(e,t,o,a,p,r);m&&o.setAttachment(a,p,m)}}return o}readAttachment(e,t,s,r,o,h){const c=this.scale;let a=e.readStringRef();switch(a||(a=o),e.readByte()){case AttachmentType.Region:{let u=e.readStringRef();const d=e.readFloat(),p=e.readFloat(),m=e.readFloat(),g=e.readFloat(),_=e.readFloat(),y=e.readFloat(),v=e.readFloat(),N=e.readInt32(),w=this.readSequence(e);u||(u=a);const k=this.attachmentLoader.newRegionAttachment(s,a,u,w);return k?(k.path=u,k.x=p*c,k.y=m*c,k.scaleX=g,k.scaleY=_,k.rotation=d,k.width=y*c,k.height=v*c,Color.rgba8888ToColor(k.color,N),k.sequence=w,w==null&&k.updateRegion(),k):null}case AttachmentType.BoundingBox:{const u=e.readInt(!0),d=this.readVertices(e,u),p=h?e.readInt32():0,m=this.attachmentLoader.newBoundingBoxAttachment(s,a);return m?(m.worldVerticesLength=u<<1,m.vertices=d.vertices,m.bones=d.bones,h&&Color.rgba8888ToColor(m.color,p),m):null}case AttachmentType.Mesh:{let u=e.readStringRef();const d=e.readInt32(),p=e.readInt(!0),m=this.readFloatArray(e,p<<1,1),g=this.readShortArray(e),_=this.readVertices(e,p),y=e.readInt(!0),v=this.readSequence(e);let N=[],w=0,k=0;h&&(N=this.readShortArray(e),w=e.readFloat(),k=e.readFloat()),u||(u=a);const U=this.attachmentLoader.newMeshAttachment(s,a,u,v);return U?(U.path=u,Color.rgba8888ToColor(U.color,d),U.bones=_.bones,U.vertices=_.vertices,U.worldVerticesLength=p<<1,U.triangles=g,U.regionUVs=new Float32Array(m),U.hullLength=y<<1,U.sequence=v,h&&(U.edges=N,U.width=w*c,U.height=k*c),U):null}case AttachmentType.LinkedMesh:{let u=e.readStringRef();const d=e.readInt32(),p=e.readStringRef(),m=e.readStringRef(),g=e.readBoolean(),_=this.readSequence(e);let y=0,v=0;h&&(y=e.readFloat(),v=e.readFloat()),u||(u=a);const N=this.attachmentLoader.newMeshAttachment(s,a,u,_);return N?(N.path=u,Color.rgba8888ToColor(N.color,d),N.sequence=_,h&&(N.width=y*c,N.height=v*c),this.linkedMeshes.push(new LinkedMesh$1(N,p,r,m,g)),N):null}case AttachmentType.Path:{const u=e.readBoolean(),d=e.readBoolean(),p=e.readInt(!0),m=this.readVertices(e,p),g=Utils.newArray(p/3,0);for(let v=0,N=g.length;v<N;v++)g[v]=e.readFloat()*c;const _=h?e.readInt32():0,y=this.attachmentLoader.newPathAttachment(s,a);return y?(y.closed=u,y.constantSpeed=d,y.worldVerticesLength=p<<1,y.vertices=m.vertices,y.bones=m.bones,y.lengths=g,h&&Color.rgba8888ToColor(y.color,_),y):null}case AttachmentType.Point:{const u=e.readFloat(),d=e.readFloat(),p=e.readFloat(),m=h?e.readInt32():0,g=this.attachmentLoader.newPointAttachment(s,a);return g?(g.x=d*c,g.y=p*c,g.rotation=u,h&&Color.rgba8888ToColor(g.color,m),g):null}case AttachmentType.Clipping:{const u=e.readInt(!0),d=e.readInt(!0),p=this.readVertices(e,d),m=h?e.readInt32():0,g=this.attachmentLoader.newClippingAttachment(s,a);return g?(g.endSlot=t.slots[u],g.worldVerticesLength=d<<1,g.vertices=p.vertices,g.bones=p.bones,h&&Color.rgba8888ToColor(g.color,m),g):null}}return null}readSequence(e){if(this.ver40||!e.readBoolean())return null;const t=new Sequence$1(e.readInt(!0));return t.start=e.readInt(!0),t.digits=e.readInt(!0),t.setupIndex=e.readInt(!0),t}readDeformTimelineType(e){return this.ver40?ATTACHMENT_DEFORM:e.readByte()}readVertices(e,t){const s=this.scale,r=t<<1,o=new Vertices;if(!e.readBoolean())return o.vertices=this.readFloatArray(e,r,s),o;const h=new Array,c=new Array;for(let a=0;a<t;a++){const u=e.readInt(!0);c.push(u);for(let d=0;d<u;d++)c.push(e.readInt(!0)),h.push(e.readFloat()*s),h.push(e.readFloat()*s),h.push(e.readFloat())}return o.vertices=Utils.toFloatArray(h),o.bones=c,o}readFloatArray(e,t,s){const r=new Array(t);if(s==1)for(let o=0;o<t;o++)r[o]=e.readFloat();else for(let o=0;o<t;o++)r[o]=e.readFloat()*s;return r}readShortArray(e){const t=e.readInt(!0),s=new Array(t);for(let r=0;r<t;r++)s[r]=e.readShort();return s}readAnimation(e,t,s){e.readInt(!0);const r=new Array,o=this.scale;for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readInt(!0);for(let m=0,g=e.readInt(!0);m<g;m++){const _=e.readByte(),y=e.readInt(!0),v=y-1;switch(_){case SLOT_ATTACHMENT:{const N=new AttachmentTimeline(y,p);for(let w=0;w<y;w++)N.setFrame(w,e.readFloat(),e.readStringRef());r.push(N);break}case SLOT_RGBA:{const N=e.readInt(!0),w=new RGBATimeline(y,N,p);let k=e.readFloat(),U=e.readUnsignedByte()/255,ee=e.readUnsignedByte()/255,ie=e.readUnsignedByte()/255,se=e.readUnsignedByte()/255;for(let oe=0,le=0;w.setFrame(oe,k,U,ee,ie,se),oe!=v;oe++){const ue=e.readFloat(),he=e.readUnsignedByte()/255,pe=e.readUnsignedByte()/255,de=e.readUnsignedByte()/255,fe=e.readUnsignedByte()/255;switch(e.readByte()){case CURVE_STEPPED:w.setStepped(oe);break;case CURVE_BEZIER:setBezier(e,w,le++,oe,0,k,ue,U,he,1),setBezier(e,w,le++,oe,1,k,ue,ee,pe,1),setBezier(e,w,le++,oe,2,k,ue,ie,de,1),setBezier(e,w,le++,oe,3,k,ue,se,fe,1)}k=ue,U=he,ee=pe,ie=de,se=fe}r.push(w);break}case SLOT_RGB:{const N=e.readInt(!0),w=new RGBTimeline(y,N,p);let k=e.readFloat(),U=e.readUnsignedByte()/255,ee=e.readUnsignedByte()/255,ie=e.readUnsignedByte()/255;for(let se=0,oe=0;w.setFrame(se,k,U,ee,ie),se!=v;se++){const le=e.readFloat(),ue=e.readUnsignedByte()/255,he=e.readUnsignedByte()/255,pe=e.readUnsignedByte()/255;switch(e.readByte()){case CURVE_STEPPED:w.setStepped(se);break;case CURVE_BEZIER:setBezier(e,w,oe++,se,0,k,le,U,ue,1),setBezier(e,w,oe++,se,1,k,le,ee,he,1),setBezier(e,w,oe++,se,2,k,le,ie,pe,1)}k=le,U=ue,ee=he,ie=pe}r.push(w);break}case SLOT_RGBA2:{const N=e.readInt(!0),w=new RGBA2Timeline(y,N,p);let k=e.readFloat(),U=e.readUnsignedByte()/255,ee=e.readUnsignedByte()/255,ie=e.readUnsignedByte()/255,se=e.readUnsignedByte()/255,oe=e.readUnsignedByte()/255,le=e.readUnsignedByte()/255,ue=e.readUnsignedByte()/255;for(let he=0,pe=0;w.setFrame(he,k,U,ee,ie,se,oe,le,ue),he!=v;he++){const de=e.readFloat(),fe=e.readUnsignedByte()/255,Te=e.readUnsignedByte()/255,Ce=e.readUnsignedByte()/255,be=e.readUnsignedByte()/255,Ae=e.readUnsignedByte()/255,Pe=e.readUnsignedByte()/255,xe=e.readUnsignedByte()/255;switch(e.readByte()){case CURVE_STEPPED:w.setStepped(he);break;case CURVE_BEZIER:setBezier(e,w,pe++,he,0,k,de,U,fe,1),setBezier(e,w,pe++,he,1,k,de,ee,Te,1),setBezier(e,w,pe++,he,2,k,de,ie,Ce,1),setBezier(e,w,pe++,he,3,k,de,se,be,1),setBezier(e,w,pe++,he,4,k,de,oe,Ae,1),setBezier(e,w,pe++,he,5,k,de,le,Pe,1),setBezier(e,w,pe++,he,6,k,de,ue,xe,1)}k=de,U=fe,ee=Te,ie=Ce,se=be,oe=Ae,le=Pe,ue=xe}r.push(w);break}case SLOT_RGB2:{const N=e.readInt(!0),w=new RGB2Timeline(y,N,p);let k=e.readFloat(),U=e.readUnsignedByte()/255,ee=e.readUnsignedByte()/255,ie=e.readUnsignedByte()/255,se=e.readUnsignedByte()/255,oe=e.readUnsignedByte()/255,le=e.readUnsignedByte()/255;for(let ue=0,he=0;w.setFrame(ue,k,U,ee,ie,se,oe,le),ue!=v;ue++){const pe=e.readFloat(),de=e.readUnsignedByte()/255,fe=e.readUnsignedByte()/255,Te=e.readUnsignedByte()/255,Ce=e.readUnsignedByte()/255,be=e.readUnsignedByte()/255,Ae=e.readUnsignedByte()/255;switch(e.readByte()){case CURVE_STEPPED:w.setStepped(ue);break;case CURVE_BEZIER:setBezier(e,w,he++,ue,0,k,pe,U,de,1),setBezier(e,w,he++,ue,1,k,pe,ee,fe,1),setBezier(e,w,he++,ue,2,k,pe,ie,Te,1),setBezier(e,w,he++,ue,3,k,pe,se,Ce,1),setBezier(e,w,he++,ue,4,k,pe,oe,be,1),setBezier(e,w,he++,ue,5,k,pe,le,Ae,1)}k=pe,U=de,ee=fe,ie=Te,se=Ce,oe=be,le=Ae}r.push(w);break}case SLOT_ALPHA:{const N=new AlphaTimeline(y,e.readInt(!0),p);let w=e.readFloat(),k=e.readUnsignedByte()/255;for(let U=0,ee=0;N.setFrame(U,w,k),U!=v;U++){const ie=e.readFloat(),se=e.readUnsignedByte()/255;switch(e.readByte()){case CURVE_STEPPED:N.setStepped(U);break;case CURVE_BEZIER:setBezier(e,N,ee++,U,0,w,ie,k,se,1)}w=ie,k=se}r.push(N)}}}}for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readInt(!0);for(let m=0,g=e.readInt(!0);m<g;m++){const _=e.readByte(),y=e.readInt(!0),v=e.readInt(!0);switch(_){case BONE_ROTATE:r.push(readTimeline1$1(e,new RotateTimeline(y,v,p),1));break;case BONE_TRANSLATE:r.push(readTimeline2$1(e,new TranslateTimeline(y,v,p),o));break;case BONE_TRANSLATEX:r.push(readTimeline1$1(e,new TranslateXTimeline(y,v,p),o));break;case BONE_TRANSLATEY:r.push(readTimeline1$1(e,new TranslateYTimeline(y,v,p),o));break;case BONE_SCALE:r.push(readTimeline2$1(e,new ScaleTimeline(y,v,p),1));break;case BONE_SCALEX:r.push(readTimeline1$1(e,new ScaleXTimeline(y,v,p),1));break;case BONE_SCALEY:r.push(readTimeline1$1(e,new ScaleYTimeline(y,v,p),1));break;case BONE_SHEAR:r.push(readTimeline2$1(e,new ShearTimeline(y,v,p),1));break;case BONE_SHEARX:r.push(readTimeline1$1(e,new ShearXTimeline(y,v,p),1));break;case BONE_SHEARY:r.push(readTimeline1$1(e,new ShearYTimeline(y,v,p),1))}}}for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readInt(!0),m=e.readInt(!0),g=m-1,_=new IkConstraintTimeline(m,e.readInt(!0),p);let y=e.readFloat(),v=e.readFloat(),N=e.readFloat()*o;for(let w=0,k=0;_.setFrame(w,y,v,N,e.readByte(),e.readBoolean(),e.readBoolean()),w!=g;w++){const U=e.readFloat(),ee=e.readFloat(),ie=e.readFloat()*o;switch(e.readByte()){case CURVE_STEPPED:_.setStepped(w);break;case CURVE_BEZIER:setBezier(e,_,k++,w,0,y,U,v,ee,1),setBezier(e,_,k++,w,1,y,U,N,ie,o)}y=U,v=ee,N=ie}r.push(_)}for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readInt(!0),m=e.readInt(!0),g=m-1,_=new TransformConstraintTimeline(m,e.readInt(!0),p);let y=e.readFloat(),v=e.readFloat(),N=e.readFloat(),w=e.readFloat(),k=e.readFloat(),U=e.readFloat(),ee=e.readFloat();for(let ie=0,se=0;_.setFrame(ie,y,v,N,w,k,U,ee),ie!=g;ie++){const oe=e.readFloat(),le=e.readFloat(),ue=e.readFloat(),he=e.readFloat(),pe=e.readFloat(),de=e.readFloat(),fe=e.readFloat();switch(e.readByte()){case CURVE_STEPPED:_.setStepped(ie);break;case CURVE_BEZIER:setBezier(e,_,se++,ie,0,y,oe,v,le,1),setBezier(e,_,se++,ie,1,y,oe,N,ue,1),setBezier(e,_,se++,ie,2,y,oe,w,he,1),setBezier(e,_,se++,ie,3,y,oe,k,pe,1),setBezier(e,_,se++,ie,4,y,oe,U,de,1),setBezier(e,_,se++,ie,5,y,oe,ee,fe,1)}y=oe,v=le,N=ue,w=he,k=pe,U=de,ee=fe}r.push(_)}for(let u=0,d=e.readInt(!0);u<d;u++){const p=e.readInt(!0),m=s.pathConstraints[p];for(let g=0,_=e.readInt(!0);g<_;g++)switch(e.readByte()){case PATH_POSITION:r.push(readTimeline1$1(e,new PathConstraintPositionTimeline(e.readInt(!0),e.readInt(!0),p),m.positionMode==PositionMode.Fixed?o:1));break;case PATH_SPACING:r.push(readTimeline1$1(e,new PathConstraintSpacingTimeline(e.readInt(!0),e.readInt(!0),p),m.spacingMode==SpacingMode.Length||m.spacingMode==SpacingMode.Fixed?o:1));break;case PATH_MIX:const y=new PathConstraintMixTimeline(e.readInt(!0),e.readInt(!0),p);let v=e.readFloat(),N=e.readFloat(),w=e.readFloat(),k=e.readFloat();for(let U=0,ee=0,ie=y.getFrameCount()-1;y.setFrame(U,v,N,w,k),U!=ie;U++){const se=e.readFloat(),oe=e.readFloat(),le=e.readFloat(),ue=e.readFloat();switch(e.readByte()){case CURVE_STEPPED:y.setStepped(U);break;case CURVE_BEZIER:setBezier(e,y,ee++,U,0,v,se,N,oe,1),setBezier(e,y,ee++,U,1,v,se,w,le,1),setBezier(e,y,ee++,U,2,v,se,k,ue,1)}v=se,N=oe,w=le,k=ue}r.push(y)}}for(let u=0,d=e.readInt(!0);u<d;u++){const p=s.skins[e.readInt(!0)];for(let m=0,g=e.readInt(!0);m<g;m++){const _=e.readInt(!0);for(let y=0,v=e.readInt(!0);y<v;y++){const N=e.readStringRef();if(!N)throw new Error("attachmentName must not be null.");const w=p.getAttachment(_,N),k=this.readDeformTimelineType(e),U=e.readInt(!0),ee=U-1;switch(k){case ATTACHMENT_DEFORM:{const ie=w,se=ie.bones,oe=ie.vertices,le=se?oe.length/3*2:oe.length,ue=e.readInt(!0),he=new DeformTimeline(U,ue,_,ie);let pe=e.readFloat();for(let de=0,fe=0;;de++){let Te,Ce=e.readInt(!0);if(Ce==0)Te=se?Utils.newFloatArray(le):oe;else{Te=Utils.newFloatArray(le);const Ae=e.readInt(!0);if(Ce+=Ae,o==1)for(let Pe=Ae;Pe<Ce;Pe++)Te[Pe]=e.readFloat();else for(let Pe=Ae;Pe<Ce;Pe++)Te[Pe]=e.readFloat()*o;if(!se)for(let Pe=0,xe=Te.length;Pe<xe;Pe++)Te[Pe]+=oe[Pe]}if(he.setFrame(de,pe,Te),de==ee)break;const be=e.readFloat();switch(e.readByte()){case CURVE_STEPPED:he.setStepped(de);break;case CURVE_BEZIER:setBezier(e,he,fe++,de,0,pe,be,0,1,1)}pe=be}r.push(he);break}case ATTACHMENT_SEQUENCE:{const ie=new SequenceTimeline(U,_,w);for(let se=0;se<U;se++){const oe=e.readFloat(),le=e.readInt32();ie.setFrame(se,oe,SequenceModeValues[le&15],le>>4,e.readFloat())}r.push(ie);break}}}}}const h=e.readInt(!0);if(h>0){const u=new DrawOrderTimeline(h),d=s.slots.length;for(let p=0;p<h;p++){const m=e.readFloat(),g=e.readInt(!0),_=Utils.newArray(d,0);for(let w=d-1;w>=0;w--)_[w]=-1;const y=Utils.newArray(d-g,0);let v=0,N=0;for(let w=0;w<g;w++){const k=e.readInt(!0);for(;v!=k;)y[N++]=v++;_[v+e.readInt(!0)]=v++}for(;v<d;)y[N++]=v++;for(let w=d-1;w>=0;w--)_[w]==-1&&(_[w]=y[--N]);u.setFrame(p,m,_)}r.push(u)}const c=e.readInt(!0);if(c>0){const u=new EventTimeline(c);for(let d=0;d<c;d++){const p=e.readFloat(),m=s.events[e.readInt(!0)],g=new Event$1(p,m);g.intValue=e.readInt(!1),g.floatValue=e.readFloat(),g.stringValue=e.readBoolean()?e.readString():m.stringValue,g.data.audioPath&&(g.volume=e.readFloat(),g.balance=e.readFloat()),u.setFrame(d,g)}r.push(u)}let a=0;for(let u=0,d=r.length;u<d;u++)a=Math.max(a,r[u].getDuration());return new Animation$2(t,r,a)}}SkeletonBinary.BlendModeValues=[BLEND_MODES.NORMAL,BLEND_MODES.ADD,BLEND_MODES.MULTIPLY,BLEND_MODES.SCREEN];let LinkedMesh$1=class{constructor(e,t,s,r,o){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=r,this.inheritTimeline=o}};class Vertices{constructor(e=null,t=null){this.bones=e,this.vertices=t}}function readTimeline1$1(n,e,t){let s=n.readFloat(),r=n.readFloat()*t;for(let o=0,h=0,c=e.getFrameCount()-1;e.setFrame(o,s,r),o!=c;o++){const a=n.readFloat(),u=n.readFloat()*t;switch(n.readByte()){case CURVE_STEPPED:e.setStepped(o);break;case CURVE_BEZIER:setBezier(n,e,h++,o,0,s,a,r,u,t)}s=a,r=u}return e}function readTimeline2$1(n,e,t){let s=n.readFloat(),r=n.readFloat()*t,o=n.readFloat()*t;for(let h=0,c=0,a=e.getFrameCount()-1;e.setFrame(h,s,r,o),h!=a;h++){const u=n.readFloat(),d=n.readFloat()*t,p=n.readFloat()*t;switch(n.readByte()){case CURVE_STEPPED:e.setStepped(h);break;case CURVE_BEZIER:setBezier(n,e,c++,h,0,s,u,r,d,t),setBezier(n,e,c++,h,1,s,u,o,p,t)}s=u,r=d,o=p}return e}function setBezier(n,e,t,s,r,o,h,c,a,u){e.setBezier(t,s,r,o,c,n.readFloat(),n.readFloat()*u,n.readFloat(),n.readFloat()*u,h,a)}const BONE_ROTATE=0,BONE_TRANSLATE=1,BONE_TRANSLATEX=2,BONE_TRANSLATEY=3,BONE_SCALE=4,BONE_SCALEX=5,BONE_SCALEY=6,BONE_SHEAR=7,BONE_SHEARX=8,BONE_SHEARY=9,SLOT_ATTACHMENT=0,SLOT_RGBA=1,SLOT_RGB=2,SLOT_RGBA2=3,SLOT_RGB2=4,SLOT_ALPHA=5,ATTACHMENT_DEFORM=0,ATTACHMENT_SEQUENCE=1,PATH_POSITION=0,PATH_SPACING=1,PATH_MIX=2,CURVE_STEPPED=1,CURVE_BEZIER=2;class SkeletonJson{constructor(e){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}readSkeletonData(e){const t=this.scale,s=new SkeletonData,r=typeof e=="string"?JSON.parse(e):e,o=r.skeleton;if(o){s.hash=o.hash,s.version=o.spine;const h=s.version.substr(0,3);if(h!=="4.0"&&h!=="4.1"){const c=`Spine 4.1 loader cant load version ${o.spine}. Please configure your pixi-spine bundle`;console.error(c)}s.x=o.x,s.y=o.y,s.width=o.width,s.height=o.height,s.fps=o.fps,s.imagesPath=o.images}if(r.bones)for(let h=0;h<r.bones.length;h++){const c=r.bones[h];let a=null;const u=getValue(c,"parent",null);if(u!=null&&(a=s.findBone(u),a==null))throw new Error(`Parent bone not found: ${u}`);const d=new BoneData(s.bones.length,c.name,a);d.length=getValue(c,"length",0)*t,d.x=getValue(c,"x",0)*t,d.y=getValue(c,"y",0)*t,d.rotation=getValue(c,"rotation",0),d.scaleX=getValue(c,"scaleX",1),d.scaleY=getValue(c,"scaleY",1),d.shearX=getValue(c,"shearX",0),d.shearY=getValue(c,"shearY",0),d.transformMode=Utils.enumValue(TransformMode,getValue(c,"transform","Normal")),d.skinRequired=getValue(c,"skin",!1);const p=getValue(c,"color",null);p&&d.color.setFromString(p),s.bones.push(d)}if(r.slots)for(let h=0;h<r.slots.length;h++){const c=r.slots[h],a=s.findBone(c.bone);if(!a)throw new Error(`Couldn't find bone ${c.bone} for slot ${c.name}`);const u=new SlotData(s.slots.length,c.name,a),d=getValue(c,"color",null);d&&u.color.setFromString(d);const p=getValue(c,"dark",null);p&&(u.darkColor=Color.fromString(p)),u.attachmentName=getValue(c,"attachment",null),u.blendMode=SkeletonJson.blendModeFromString(getValue(c,"blend","normal")),s.slots.push(u)}if(r.ik)for(let h=0;h<r.ik.length;h++){const c=r.ik[h],a=new IkConstraintData(c.name);a.order=getValue(c,"order",0),a.skinRequired=getValue(c,"skin",!1);for(let u=0;u<c.bones.length;u++){const d=c.bones[u],p=s.findBone(d);if(p==null)throw new Error(`IK bone not found: ${d}`);a.bones.push(p)}a.target=s.findBone(c.target),a.mix=getValue(c,"mix",1),a.softness=getValue(c,"softness",0)*t,a.bendDirection=getValue(c,"bendPositive",!0)?1:-1,a.compress=getValue(c,"compress",!1),a.stretch=getValue(c,"stretch",!1),a.uniform=getValue(c,"uniform",!1),s.ikConstraints.push(a)}if(r.transform)for(let h=0;h<r.transform.length;h++){const c=r.transform[h],a=new TransformConstraintData(c.name);a.order=getValue(c,"order",0),a.skinRequired=getValue(c,"skin",!1);for(let p=0;p<c.bones.length;p++){const m=c.bones[p],g=s.findBone(m);if(!g)throw new Error(`Couldn't find bone ${m} for transform constraint ${c.name}.`);a.bones.push(g)}const u=c.target,d=s.findBone(u);if(!d)throw new Error(`Couldn't find target bone ${u} for transform constraint ${c.name}.`);a.target=d,a.local=getValue(c,"local",!1),a.relative=getValue(c,"relative",!1),a.offsetRotation=getValue(c,"rotation",0),a.offsetX=getValue(c,"x",0)*t,a.offsetY=getValue(c,"y",0)*t,a.offsetScaleX=getValue(c,"scaleX",0),a.offsetScaleY=getValue(c,"scaleY",0),a.offsetShearY=getValue(c,"shearY",0),a.mixRotate=getValue(c,"mixRotate",1),a.mixX=getValue(c,"mixX",1),a.mixY=getValue(c,"mixY",a.mixX),a.mixScaleX=getValue(c,"mixScaleX",1),a.mixScaleY=getValue(c,"mixScaleY",a.mixScaleX),a.mixShearY=getValue(c,"mixShearY",1),s.transformConstraints.push(a)}if(r.path)for(let h=0;h<r.path.length;h++){const c=r.path[h],a=new PathConstraintData(c.name);a.order=getValue(c,"order",0),a.skinRequired=getValue(c,"skin",!1);for(let p=0;p<c.bones.length;p++){const m=c.bones[p],g=s.findBone(m);if(!g)throw new Error(`Couldn't find bone ${m} for path constraint ${c.name}.`);a.bones.push(g)}const u=c.target,d=s.findSlot(u);if(!d)throw new Error(`Couldn't find target slot ${u} for path constraint ${c.name}.`);a.target=d,a.positionMode=Utils.enumValue(PositionMode,getValue(c,"positionMode","Percent")),a.spacingMode=Utils.enumValue(SpacingMode,getValue(c,"spacingMode","Length")),a.rotateMode=Utils.enumValue(RotateMode,getValue(c,"rotateMode","Tangent")),a.offsetRotation=getValue(c,"rotation",0),a.position=getValue(c,"position",0),a.positionMode==PositionMode.Fixed&&(a.position*=t),a.spacing=getValue(c,"spacing",0),(a.spacingMode==SpacingMode.Length||a.spacingMode==SpacingMode.Fixed)&&(a.spacing*=t),a.mixRotate=getValue(c,"mixRotate",1),a.mixX=getValue(c,"mixX",1),a.mixY=getValue(c,"mixY",a.mixX),s.pathConstraints.push(a)}if(r.skins)for(let h=0;h<r.skins.length;h++){const c=r.skins[h],a=new Skin(c.name);if(c.bones)for(let u=0;u<c.bones.length;u++){const d=c.bones[u],p=s.findBone(d);if(!p)throw new Error(`Couldn't find bone ${d} for skin ${c.name}.`);a.bones.push(p)}if(c.ik)for(let u=0;u<c.ik.length;u++){const d=c.ik[u],p=s.findIkConstraint(d);if(!p)throw new Error(`Couldn't find IK constraint ${d} for skin ${c.name}.`);a.constraints.push(p)}if(c.transform)for(let u=0;u<c.transform.length;u++){const d=c.transform[u],p=s.findTransformConstraint(d);if(!p)throw new Error(`Couldn't find transform constraint ${d} for skin ${c.name}.`);a.constraints.push(p)}if(c.path)for(let u=0;u<c.path.length;u++){const d=c.path[u],p=s.findPathConstraint(d);if(!p)throw new Error(`Couldn't find path constraint ${d} for skin ${c.name}.`);a.constraints.push(p)}for(const u in c.attachments){const d=s.findSlot(u);if(!d)throw new Error(`Couldn't find slot ${u} for skin ${c.name}.`);const p=c.attachments[u];for(const m in p){const g=this.readAttachment(p[m],a,d.index,m,s);g&&a.setAttachment(d.index,m,g)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let h=0,c=this.linkedMeshes.length;h<c;h++){const a=this.linkedMeshes[h],u=a.skin?s.findSkin(a.skin):s.defaultSkin;if(!u)throw new Error(`Skin not found: ${a.skin}`);const d=u.getAttachment(a.slotIndex,a.parent);if(!d)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.timelineAttachment=a.inheritTimeline?d:a.mesh,a.mesh.setParentMesh(d)}if(this.linkedMeshes.length=0,r.events)for(const h in r.events){const c=r.events[h],a=new EventData(h);a.intValue=getValue(c,"int",0),a.floatValue=getValue(c,"float",0),a.stringValue=getValue(c,"string",""),a.audioPath=getValue(c,"audio",null),a.audioPath&&(a.volume=getValue(c,"volume",1),a.balance=getValue(c,"balance",0)),s.events.push(a)}if(r.animations)for(const h in r.animations){const c=r.animations[h];this.readAnimation(c,h,s)}return s}readAttachment(e,t,s,r,o){const h=this.scale;switch(r=getValue(e,"name",r),getValue(e,"type","region")){case"region":{const c=getValue(e,"path",r),a=this.readSequence(getValue(e,"sequence",null)),u=this.attachmentLoader.newRegionAttachment(t,r,c,a);if(!u)return null;u.path=c,u.x=getValue(e,"x",0)*h,u.y=getValue(e,"y",0)*h,u.scaleX=getValue(e,"scaleX",1),u.scaleY=getValue(e,"scaleY",1),u.rotation=getValue(e,"rotation",0),u.width=e.width*h,u.height=e.height*h,u.sequence=a;const d=getValue(e,"color",null);return d&&u.color.setFromString(d),u}case"boundingbox":{const c=this.attachmentLoader.newBoundingBoxAttachment(t,r);if(!c)return null;this.readVertices(e,c,e.vertexCount<<1);const a=getValue(e,"color",null);return a&&c.color.setFromString(a),c}case"mesh":case"linkedmesh":{const c=getValue(e,"path",r),a=this.readSequence(getValue(e,"sequence",null)),u=this.attachmentLoader.newMeshAttachment(t,r,c,a);if(!u)return null;u.path=c;const d=getValue(e,"color",null);d&&u.color.setFromString(d),u.width=getValue(e,"width",0)*h,u.height=getValue(e,"height",0)*h,u.sequence=a;const p=getValue(e,"parent",null);if(p)return this.linkedMeshes.push(new LinkedMesh(u,getValue(e,"skin",null),s,p,getValue(e,"timelines",!0))),u;const m=e.uvs;return this.readVertices(e,u,m.length),u.triangles=e.triangles,u.regionUVs=new Float32Array(m),u.edges=getValue(e,"edges",null),u.hullLength=getValue(e,"hull",0)*2,u}case"path":{const c=this.attachmentLoader.newPathAttachment(t,r);if(!c)return null;c.closed=getValue(e,"closed",!1),c.constantSpeed=getValue(e,"constantSpeed",!0);const a=e.vertexCount;this.readVertices(e,c,a<<1);const u=Utils.newArray(a/3,0);for(let p=0;p<e.lengths.length;p++)u[p]=e.lengths[p]*h;c.lengths=u;const d=getValue(e,"color",null);return d&&c.color.setFromString(d),c}case"point":{const c=this.attachmentLoader.newPointAttachment(t,r);if(!c)return null;c.x=getValue(e,"x",0)*h,c.y=getValue(e,"y",0)*h,c.rotation=getValue(e,"rotation",0);const a=getValue(e,"color",null);return a&&c.color.setFromString(a),c}case"clipping":{const c=this.attachmentLoader.newClippingAttachment(t,r);if(!c)return null;const a=getValue(e,"end",null);if(a!=null){const p=o.findSlot(a);if(p==null)throw new Error(`Clipping end slot not found: ${a}`);c.endSlot=p}const u=e.vertexCount;this.readVertices(e,c,u<<1);const d=getValue(e,"color",null);return d&&c.color.setFromString(d),c}}return null}readSequence(e){if(e==null)return null;const t=new Sequence$1(getValue(e,"count",0));return t.start=getValue(e,"start",1),t.digits=getValue(e,"digits",0),t.setupIndex=getValue(e,"setup",0),t}readVertices(e,t,s){const r=this.scale;t.worldVerticesLength=s;const o=e.vertices;if(s==o.length){const a=Utils.toFloatArray(o);if(r!=1)for(let u=0,d=o.length;u<d;u++)a[u]*=r;t.vertices=a;return}const h=new Array,c=new Array;for(let a=0,u=o.length;a<u;){const d=o[a++];c.push(d);for(let p=a+d*4;a<p;a+=4)c.push(o[a]),h.push(o[a+1]*r),h.push(o[a+2]*r),h.push(o[a+3])}t.bones=c,t.vertices=Utils.toFloatArray(h)}readAnimation(e,t,s){const r=this.scale,o=new Array;if(e.slots)for(const c in e.slots){const a=e.slots[c],u=s.findSlot(c);if(!u)throw new Error(`Slot not found: ${c}`);const d=u.index;for(const p in a){const m=a[p];if(!m)continue;const g=m.length;if(p=="attachment"){const _=new AttachmentTimeline(g,d);for(let y=0;y<g;y++){const v=m[y];_.setFrame(y,getValue(v,"time",0),getValue(v,"name",null))}o.push(_)}else if(p=="rgba"){const _=new RGBATimeline(g,g<<2,d);let y=m[0],v=getValue(y,"time",0),N=Color.fromString(y.color);for(let w=0,k=0;;w++){_.setFrame(w,v,N.r,N.g,N.b,N.a);const U=m[w+1];if(!U){_.shrink(k);break}const ee=getValue(U,"time",0),ie=Color.fromString(U.color),se=y.curve;se&&(k=readCurve(se,_,k,w,0,v,ee,N.r,ie.r,1),k=readCurve(se,_,k,w,1,v,ee,N.g,ie.g,1),k=readCurve(se,_,k,w,2,v,ee,N.b,ie.b,1),k=readCurve(se,_,k,w,3,v,ee,N.a,ie.a,1)),v=ee,N=ie,y=U}o.push(_)}else if(p=="rgb"){const _=new RGBTimeline(g,g*3,d);let y=m[0],v=getValue(y,"time",0),N=Color.fromString(y.color);for(let w=0,k=0;;w++){_.setFrame(w,v,N.r,N.g,N.b);const U=m[w+1];if(!U){_.shrink(k);break}const ee=getValue(U,"time",0),ie=Color.fromString(U.color),se=y.curve;se&&(k=readCurve(se,_,k,w,0,v,ee,N.r,ie.r,1),k=readCurve(se,_,k,w,1,v,ee,N.g,ie.g,1),k=readCurve(se,_,k,w,2,v,ee,N.b,ie.b,1)),v=ee,N=ie,y=U}o.push(_)}else if(p=="alpha")o.push(readTimeline1(m,new AlphaTimeline(g,g,d),0,1));else if(p=="rgba2"){const _=new RGBA2Timeline(g,g*7,d);let y=m[0],v=getValue(y,"time",0),N=Color.fromString(y.light),w=Color.fromString(y.dark);for(let k=0,U=0;;k++){_.setFrame(k,v,N.r,N.g,N.b,N.a,w.r,w.g,w.b);const ee=m[k+1];if(!ee){_.shrink(U);break}const ie=getValue(ee,"time",0),se=Color.fromString(ee.light),oe=Color.fromString(ee.dark),le=y.curve;le&&(U=readCurve(le,_,U,k,0,v,ie,N.r,se.r,1),U=readCurve(le,_,U,k,1,v,ie,N.g,se.g,1),U=readCurve(le,_,U,k,2,v,ie,N.b,se.b,1),U=readCurve(le,_,U,k,3,v,ie,N.a,se.a,1),U=readCurve(le,_,U,k,4,v,ie,w.r,oe.r,1),U=readCurve(le,_,U,k,5,v,ie,w.g,oe.g,1),U=readCurve(le,_,U,k,6,v,ie,w.b,oe.b,1)),v=ie,N=se,w=oe,y=ee}o.push(_)}else if(p=="rgb2"){const _=new RGB2Timeline(g,g*6,d);let y=m[0],v=getValue(y,"time",0),N=Color.fromString(y.light),w=Color.fromString(y.dark);for(let k=0,U=0;;k++){_.setFrame(k,v,N.r,N.g,N.b,w.r,w.g,w.b);const ee=m[k+1];if(!ee){_.shrink(U);break}const ie=getValue(ee,"time",0),se=Color.fromString(ee.light),oe=Color.fromString(ee.dark),le=y.curve;le&&(U=readCurve(le,_,U,k,0,v,ie,N.r,se.r,1),U=readCurve(le,_,U,k,1,v,ie,N.g,se.g,1),U=readCurve(le,_,U,k,2,v,ie,N.b,se.b,1),U=readCurve(le,_,U,k,3,v,ie,w.r,oe.r,1),U=readCurve(le,_,U,k,4,v,ie,w.g,oe.g,1),U=readCurve(le,_,U,k,5,v,ie,w.b,oe.b,1)),v=ie,N=se,w=oe,y=ee}o.push(_)}}}if(e.bones)for(const c in e.bones){const a=e.bones[c],u=s.findBone(c);if(!u)throw new Error(`Bone not found: ${c}`);const d=u.index;for(const p in a){const m=a[p],g=m.length;if(g!=0){if(p==="rotate")o.push(readTimeline1(m,new RotateTimeline(g,g,d),0,1));else if(p==="translate"){const _=new TranslateTimeline(g,g<<1,d);o.push(readTimeline2(m,_,"x","y",0,r))}else if(p==="translatex"){const _=new TranslateXTimeline(g,g,d);o.push(readTimeline1(m,_,0,r))}else if(p==="translatey"){const _=new TranslateYTimeline(g,g,d);o.push(readTimeline1(m,_,0,r))}else if(p==="scale"){const _=new ScaleTimeline(g,g<<1,d);o.push(readTimeline2(m,_,"x","y",1,1))}else if(p==="scalex"){const _=new ScaleXTimeline(g,g,d);o.push(readTimeline1(m,_,1,1))}else if(p==="scaley"){const _=new ScaleYTimeline(g,g,d);o.push(readTimeline1(m,_,1,1))}else if(p==="shear"){const _=new ShearTimeline(g,g<<1,d);o.push(readTimeline2(m,_,"x","y",0,1))}else if(p==="shearx"){const _=new ShearXTimeline(g,g,d);o.push(readTimeline1(m,_,0,1))}else if(p==="sheary"){const _=new ShearYTimeline(g,g,d);o.push(readTimeline1(m,_,0,1))}}}}if(e.ik)for(const c in e.ik){const a=e.ik[c];let u=a[0];if(!u)continue;const d=s.findIkConstraint(c);if(!d)throw new Error(`IK Constraint not found: ${c}`);const p=s.ikConstraints.indexOf(d),m=new IkConstraintTimeline(a.length,a.length<<1,p);let g=getValue(u,"time",0),_=getValue(u,"mix",1),y=getValue(u,"softness",0)*r;for(let v=0,N=0;;v++){m.setFrame(v,g,_,y,getValue(u,"bendPositive",!0)?1:-1,getValue(u,"compress",!1),getValue(u,"stretch",!1));const w=a[v+1];if(!w){m.shrink(N);break}const k=getValue(w,"time",0),U=getValue(w,"mix",1),ee=getValue(w,"softness",0)*r,ie=u.curve;ie&&(N=readCurve(ie,m,N,v,0,g,k,_,U,1),N=readCurve(ie,m,N,v,1,g,k,y,ee,r)),g=k,_=U,y=ee,u=w}o.push(m)}if(e.transform)for(const c in e.transform){const a=e.transform[c];let u=a[0];if(!u)continue;const d=s.findTransformConstraint(c);if(!d)throw new Error(`Transform constraint not found: ${c}`);const p=s.transformConstraints.indexOf(d),m=new TransformConstraintTimeline(a.length,a.length*6,p);let g=getValue(u,"time",0),_=getValue(u,"mixRotate",1),y=getValue(u,"mixX",1),v=getValue(u,"mixY",y),N=getValue(u,"mixScaleX",1),w=getValue(u,"mixScaleY",N);const k=getValue(u,"mixShearY",1);for(let U=0,ee=0;;U++){m.setFrame(U,g,_,y,v,N,w,k);const ie=a[U+1];if(!ie){m.shrink(ee);break}const se=getValue(ie,"time",0),oe=getValue(ie,"mixRotate",1),le=getValue(ie,"mixX",1),ue=getValue(ie,"mixY",le),he=getValue(ie,"mixScaleX",1),pe=getValue(ie,"mixScaleY",he),de=getValue(ie,"mixShearY",1),fe=u.curve;fe&&(ee=readCurve(fe,m,ee,U,0,g,se,_,oe,1),ee=readCurve(fe,m,ee,U,1,g,se,y,le,1),ee=readCurve(fe,m,ee,U,2,g,se,v,ue,1),ee=readCurve(fe,m,ee,U,3,g,se,N,he,1),ee=readCurve(fe,m,ee,U,4,g,se,w,pe,1),ee=readCurve(fe,m,ee,U,5,g,se,k,de,1)),g=se,_=oe,y=le,v=ue,N=he,w=pe,N=he,u=ie}o.push(m)}if(e.path)for(const c in e.path){const a=e.path[c],u=s.findPathConstraint(c);if(!u)throw new Error(`Path constraint not found: ${c}`);const d=s.pathConstraints.indexOf(u);for(const p in a){const m=a[p];let g=m[0];if(!g)continue;const _=m.length;if(p==="position"){const y=new PathConstraintPositionTimeline(_,_,d);o.push(readTimeline1(m,y,0,u.positionMode==PositionMode.Fixed?r:1))}else if(p==="spacing"){const y=new PathConstraintSpacingTimeline(_,_,d);o.push(readTimeline1(m,y,0,u.spacingMode==SpacingMode.Length||u.spacingMode==SpacingMode.Fixed?r:1))}else if(p==="mix"){const y=new PathConstraintMixTimeline(_,_*3,d);let v=getValue(g,"time",0),N=getValue(g,"mixRotate",1),w=getValue(g,"mixX",1),k=getValue(g,"mixY",w);for(let U=0,ee=0;;U++){y.setFrame(U,v,N,w,k);const ie=m[U+1];if(!ie){y.shrink(ee);break}const se=getValue(ie,"time",0),oe=getValue(ie,"mixRotate",1),le=getValue(ie,"mixX",1),ue=getValue(ie,"mixY",le),he=g.curve;he&&(ee=readCurve(he,y,ee,U,0,v,se,N,oe,1),ee=readCurve(he,y,ee,U,1,v,se,w,le,1),ee=readCurve(he,y,ee,U,2,v,se,k,ue,1)),v=se,N=oe,w=le,k=ue,g=ie}o.push(y)}}}if(e.deform){e.attachments={};for(const c in e.deform){const a=e.deform[c],u=e.attachments[c]={};for(const d in a){const p=a[d],m=u[d]={};for(const g in p)m[g]={deform:p[g]}}}}if(e.attachments)for(const c in e.attachments){const a=e.attachments[c],u=s.findSkin(c);if(u!=null)for(const d in a){const p=a[d],m=s.findSlot(d);if(!m)throw new Error(`Slot not found: ${d}`);const g=m.index;for(const _ in p){const y=p[_],v=u.getAttachment(g,_);for(const N in y){const w=y[N];let k=w[0];if(k){if(N=="deform"){const U=v.bones,ee=v.vertices,ie=U?ee.length/3*2:ee.length,se=new DeformTimeline(w.length,w.length,g,v);let oe=getValue(k,"time",0);for(let le=0,ue=0;;le++){let he;const pe=getValue(k,"vertices",null);if(!pe)he=U?Utils.newFloatArray(ie):ee;else{he=Utils.newFloatArray(ie);const Ce=getValue(k,"offset",0);if(Utils.arrayCopy(pe,0,he,Ce,pe.length),r!=1)for(let be=Ce,Ae=be+pe.length;be<Ae;be++)he[be]*=r;if(!U)for(let be=0;be<ie;be++)he[be]+=ee[be]}se.setFrame(le,oe,he);const de=w[le+1];if(!de){se.shrink(ue);break}const fe=getValue(de,"time",0),Te=k.curve;Te&&(ue=readCurve(Te,se,ue,le,0,oe,fe,0,1,1)),oe=fe,k=de}o.push(se)}else if(N=="sequence"){const U=new SequenceTimeline(w.length,g,v);let ee=0;for(let ie=0;ie<w.length;ie++){const se=getValue(k,"delay",ee),oe=getValue(k,"time",0),le=SequenceMode[getValue(k,"mode","hold")],ue=getValue(k,"index",0);U.setFrame(ie,oe,le,ue,se),ee=se,k=w[ie+1]}o.push(U)}}}}}}if(e.drawOrder){const c=new DrawOrderTimeline(e.drawOrder.length),a=s.slots.length;let u=0;for(let d=0;d<e.drawOrder.length;d++,u++){const p=e.drawOrder[d];let m=null;const g=getValue(p,"offsets",null);if(g){m=Utils.newArray(a,-1);const _=Utils.newArray(a-g.length,0);let y=0,v=0;for(let N=0;N<g.length;N++){const w=g[N],k=s.findSlot(w.slot);if(!k)throw new Error(`Slot not found: ${k}`);const U=k.index;for(;y!=U;)_[v++]=y++;m[y+w.offset]=y++}for(;y<a;)_[v++]=y++;for(let N=a-1;N>=0;N--)m[N]==-1&&(m[N]=_[--v])}c.setFrame(u,getValue(p,"time",0),m)}o.push(c)}if(e.events){const c=new EventTimeline(e.events.length);let a=0;for(let u=0;u<e.events.length;u++,a++){const d=e.events[u],p=s.findEvent(d.name);if(!p)throw new Error(`Event not found: ${d.name}`);const m=new Event$1(Utils.toSinglePrecision(getValue(d,"time",0)),p);m.intValue=getValue(d,"int",p.intValue),m.floatValue=getValue(d,"float",p.floatValue),m.stringValue=getValue(d,"string",p.stringValue),m.data.audioPath&&(m.volume=getValue(d,"volume",1),m.balance=getValue(d,"balance",0)),c.setFrame(a,m)}o.push(c)}let h=0;for(let c=0,a=o.length;c<a;c++)h=Math.max(h,o[c].getDuration());if(isNaN(h))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Animation$2(t,o,h))}static blendModeFromString(e){if(e=e.toLowerCase(),e=="normal")return BLEND_MODES.NORMAL;if(e=="additive")return BLEND_MODES.ADD;if(e=="multiply")return BLEND_MODES.MULTIPLY;if(e=="screen")return BLEND_MODES.SCREEN;throw new Error(`Unknown blend mode: ${e}`)}}class LinkedMesh{constructor(e,t,s,r,o){this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=r,this.inheritTimeline=o}}function readTimeline1(n,e,t,s){let r=n[0],o=getValue(r,"time",0),h=getValue(r,"value",t)*s,c=0;for(let a=0;;a++){e.setFrame(a,o,h);const u=n[a+1];if(!u)return e.shrink(c),e;const d=getValue(u,"time",0),p=getValue(u,"value",t)*s;r.curve&&(c=readCurve(r.curve,e,c,a,0,o,d,h,p,s)),o=d,h=p,r=u}}function readTimeline2(n,e,t,s,r,o){let h=n[0],c=getValue(h,"time",0),a=getValue(h,t,r)*o,u=getValue(h,s,r)*o,d=0;for(let p=0;;p++){e.setFrame(p,c,a,u);const m=n[p+1];if(!m)return e.shrink(d),e;const g=getValue(m,"time",0),_=getValue(m,t,r)*o,y=getValue(m,s,r)*o,v=h.curve;v&&(d=readCurve(v,e,d,p,0,c,g,a,_,o),d=readCurve(v,e,d,p,1,c,g,u,y,o)),c=g,a=_,u=y,h=m}}function readCurve(n,e,t,s,r,o,h,c,a,u){if(n=="stepped")return e.setStepped(s),t;const d=r<<2,p=n[d],m=n[d+1]*u,g=n[d+2],_=n[d+3]*u;return e.setBezier(t,s,r,o,c,p,m,g,_,h,a),t+1}function getValue(n,e,t){return n[e]!==void 0?n[e]:t}var SPINE_VERSION=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.VER37=37]="VER37",n[n.VER38=38]="VER38",n[n.VER40=40]="VER40",n[n.VER41=41]="VER41",n))(SPINE_VERSION||{});function detectSpineVersion(n){const e=n.substr(0,3),t=Math.floor(Number(e)*10+.001);return e==="3.7"?37:e==="3.8"?38:e==="4.0"?40:e==="4.1"?41:t<37?37:0}class UniBinaryParser{constructor(){this.scale=1}readSkeletonData(e,t){let s=null,r=this.readVersionOldFormat(t),o=detectSpineVersion(r);if(o===SPINE_VERSION.VER38&&(s=new SkeletonBinary$1(new AtlasAttachmentLoader$2(e))),r=this.readVersionNewFormat(t),o=detectSpineVersion(r),(o===SPINE_VERSION.VER40||o===SPINE_VERSION.VER41)&&(s=new SkeletonBinary(new AtlasAttachmentLoader(e))),!s){const h=`Unsupported version of spine model ${r}, please update pixi-spine`;console.error(h)}return s.scale=this.scale,s.readSkeletonData(t)}readVersionOldFormat(e){const t=new BinaryInput(e);let s;try{t.readString(),s=t.readString()}catch{s=""}return s||""}readVersionNewFormat(e){const t=new BinaryInput(e);t.readInt32(),t.readInt32();let s;try{s=t.readString()}catch{s=""}return s||""}}class UniJsonParser{constructor(){this.scale=1}readSkeletonData(e,t){const s=t.skeleton.spine,r=detectSpineVersion(s);let o=null;if(r===SPINE_VERSION.VER37&&(o=new SkeletonJson$1(new AtlasAttachmentLoader$1(e))),r===SPINE_VERSION.VER38&&(o=new SkeletonJson$2(new AtlasAttachmentLoader$2(e))),(r===SPINE_VERSION.VER40||r===SPINE_VERSION.VER41)&&(o=new SkeletonJson(new AtlasAttachmentLoader(e))),!o){const h=`Unsupported version of spine model ${s}, please update pixi-spine`;console.error(h)}return o.scale=this.scale,o.readSkeletonData(t)}}class SpineLoader extends SpineLoaderAbstract{createBinaryParser(){return new UniBinaryParser}createJsonParser(){return new UniJsonParser}parseData(e,t,s){return{spineData:e.readSkeletonData(t,s),spineAtlas:t}}}new SpineLoader().installLoader();const ACTIVE="active",ANIMATED="animated",ANIMATION_DURATION=250,ARIA_LABEL="aria-label",BLOCK="block",CLICK="click",CLOSE="close",CLOSE_TITLE="Close",DATA_HIDE="data-pop-up-hide",DATA_SHOW="data-pop-up-show",EMPTY_STRING="",ENTER="enter",ESCAPE="escape",FALSE="false",FOCUSIN="focusin",FUNCTION="function",HIDDEN="hidden",KEYDOWN="keydown",MODAL_LABEL_FALLBACK="modal",NONE="none",PREFERS_REDUCED_MOTION="(prefers-reduced-motion: reduce)",SPACE=" ",SPACE_REGEX=/\s+/g,STATIC="static",TAB="tab",TEMPLATE="template",TRUE="true",FOCUSABLE_SELECTORS=["[contenteditable]",'[tabindex="0"]:not([disabled])',"a[href]","audio[controls]","button:not([disabled])","iframe","input:not([disabled]):not([type='hidden'])","select:not([disabled])","summary","textarea:not([disabled])","video[controls]"].join(","),STYLE=`
      <style>
        *,
        *:after,
        *:before {
          box-sizing: border-box;
          margin: 0;
          padding: 0;
        }
  
        @media ${PREFERS_REDUCED_MOTION} {
          *,
          *:after,
          *:before {
            animation: none !important;
            transition: none !important;
          }
        }
  
        @keyframes SHOW-OVERLAY {
          0% {
            opacity: 0;
          }
  
          100% {
            opacity: 1;
          }
        }
  
        @keyframes SHOW-DIALOG {
          0% {
            transform: scale(0.95);
          }
  
          100% {
            transform: scale(1);
          }
        }
  
        @keyframes HIDE-OVERLAY {
          0% {
            opacity: 1;
          }
  
          100% {
            opacity: 0;
          }
        }
  
        @keyframes HIDE-DIALOG {
          0% {
            transform: scale(1);
          }
  
          100% {
            transform: scale(0.95);
          }
        }
  
        .pop-up__focus-trap {
          opacity: 0;
          overflow: hidden;
          width: 0;
          height: 0;
          position: fixed;
          top: 0;
          left: 0;
        }
  
        .pop-up__scroll {
            overflow-x: hidden;
            overflow-y: auto;
            z-index: var(--pop-up-overlay-z-index, 100000);
            width: var(--pop-up-overlay-width, 100%);
            height: var(--pop-up-overlay-height, 100%);
            position: var(--pop-up-overlay-position, fixed);
            top: var(--pop-up-overlay-top, 0px);
            right: var(--pop-up-overlay-right, 0px);
            left: var(--pop-up-overlay-left, 0px);
            border-radius: var(--pop-up-overlay-border-radius, 0px);
        }
  
        .pop-up__overlay {
            background-color: var(--pop-up-overlay-background-color, rgba(0, 0, 0, 0.5));
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: 100%;
            padding-top: var(--cta-modal-overlay-padding-top, 20px);
            padding-left: var(--cta-modal-overlay-padding-left, 20px);
            padding-right: var(--cta-modal-overlay-padding-right, 20px);
            padding-bottom: var(--cta-modal-overlay-padding-bottom, 20px);
        }
  
        .pop-up__dialog {
            background-color: var(--pop-up-dialog-background-color, #fff);
            color: var(--pop-up-dialog-color, #fff);
            border-radius: var(--pop-up-dialog-border-radius, 5px);
            box-shadow: var(--pop-up-dialog-box-shadow, 0 2px 5px 0 rgba(0, 0, 0, 0.5));
            padding-top: var(--pop-up-dialog-padding-top, 20px);
            padding-left: var(--pop-up-dialog-padding-left, 20px);
            padding-right: var(--pop-up-dialog-padding-right, 20px);
            padding-bottom: var(--pop-up-dialog-padding-bottom, 20px);
            width: var(--pop-up-dialog-width, 500px);
            max-width: 100%;
            height: var(--pop-up-dialog-height, none);
            position: var(--pop-up-dialog-position, relative);
        }
  
        [${DATA_SHOW}='true'] .pop-up__overlay {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: SHOW-OVERLAY;
        }
  
        [${DATA_SHOW}='true'] .pop-up__dialog {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: SHOW-DIALOG;
        }
  
        [${DATA_HIDE}='true'] .pop-up__overlay {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: HIDE-OVERLAY;
          opacity: 0;
        }
  
        [${DATA_HIDE}='true'] .pop-up__dialog {
          animation-duration: ${ANIMATION_DURATION}ms;
          animation-name: HIDE-DIALOG;
          transform: scale(0.95);
        }
  
        .pop-up__close {
          appearance: none;
          touch-action: none;
          user-select: none;
  
          border: 0;
          padding: 0;
  
          color: var(--pop-up-close-color, #fff);
          background-color: var(--pop-up-close-background-color, #000);
          border-radius: var(--pop-up-close-border-radius, 50%);
          box-shadow: var(--pop-up-close-box-shadow, 0 0 0 1px #fff);
          display: var(--pop-up-close-display, block);
  
          cursor: pointer;
          font-size: var(--pop-up-close-font-size, 23px);
          text-align: center;
  
          line-height: var(--pop-up-close-line-height, 26px);
          width: var(--pop-up-close-width, 26px);
  
          transform: translate(40%, -40%);
          position: absolute;
          top: var(--pop-up-close-line-top, 0px);
          right: var(--pop-up-close-line-right, 0px);
        }
  
        .pop-up__close:hover {
          color: var(--pop-up-close-color-hover, #000);
          background-color: var(--pop-up-close-background-color-hover, #fff);
          box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
        }
  
        @supports selector(:focus-visible) {
          .pop-up__close:focus-visible {
            color: var(--pop-up-close-color-hover, #000);
            background-color: var(--pop-up-close-background-color-hover, #fff);
            box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
          }
        }
  
        @supports not selector(:focus-visible) {
          .pop-up__close:focus {
            color: var(--pop-up-close-color-hover, #000);
            background-color: var(--pop-up-close-background-color-hover, #fff);
            box-shadow: var(--pop-up-close-box-shadow-hover, 0 0 0 1px #000);
          }
        }
      </style>
    `,FOCUS_TRAP=`
      <span
        aria-hidden='true'
        class='cta-modal__focus-trap'
        tabindex='0'
      ></span>
    `,MODAL=`
      <slot name='button'></slot>
  
      <div class='pop-up__scroll' style='display:none'>
      ${FOCUS_TRAP}
        <div class='pop-up__overlay'>
          <div
            aria-modal='true'
            class='pop-up__dialog'
            role='dialog'
            tabindex='-1'
          >
            <button
              class='pop-up__close'
              type='button'
            >&times;</button>
  
            <slot name='modal'></slot>
          </div>
        </div>
        ${FOCUS_TRAP}
      </div>
    `,markup=[STYLE,MODAL].join(EMPTY_STRING).trim().replace(SPACE_REGEX,SPACE),template=document.createElement(TEMPLATE);template.innerHTML=markup;class PopUp extends HTMLElement{constructor(){super();ne(this,"_buttonClose");ne(this,"_heading");ne(this,"_modal");ne(this,"_modalOverlay");ne(this,"_modalScroll");ne(this,"_shadow");ne(this,"_slotForButton");ne(this,"_slotForModal");ne(this,"_activeElement",null);ne(this,"_focusTrapList");ne(this,"_isActive",!1);ne(this,"_isAnimated",!0);ne(this,"_isHideShow",!1);ne(this,"_isStatic",!1);ne(this,"_timerForHide");ne(this,"_timerForShow");this._bind(),this._shadow=this.attachShadow({mode:"closed"}),this._shadow.append(template.content.cloneNode(!0)),this._slotForButton=this.querySelector("[slot='button']"),this._slotForModal=this.querySelector("[slot='modal']"),this._heading=this.querySelector("h1, h2, h3, h4, h5, h6"),this._buttonClose=this._shadow.querySelector(".pop-up__close"),this._focusTrapList=this._shadow.querySelectorAll(".pop-up__focus-trap"),this._modal=this._shadow.querySelector(".pop-up__dialog"),this._modalOverlay=this._shadow.querySelector(".pop-up__overlay"),this._modalScroll=this._shadow.querySelector(".pop-up__scroll"),this._slotForModal||window.console.error('Required [slot="modal"] not found inside pop-up.'),this._setAnimationFlag(),this._setCloseTitle(),this._setModalLabel(),this._setStaticFlag(),this._setActiveFlag()}static get observedAttributes(){return[ACTIVE,ANIMATED,CLOSE,STATIC]}attributeChangedCallback(t,s,r){s!==r&&(t===ACTIVE&&this._setActiveFlag(),t===ANIMATED&&this._setAnimationFlag(),t===CLOSE&&this._setCloseTitle(),t===STATIC&&this._setStaticFlag())}connectedCallback(){this._addEvents()}disconnectedCallback(){this._removeEvents()}_bind(){Object.getOwnPropertyNames(Object.getPrototypeOf(this)).forEach(s=>{typeof this[s]===FUNCTION&&(this[s]=this[s].bind(this))})}_addEvents(){this._removeEvents(),document.addEventListener(FOCUSIN,this._handleFocusIn),document.addEventListener(KEYDOWN,this._handleKeyDown),this._buttonClose.addEventListener(CLICK,this._handleClickToggle),this._modalOverlay.addEventListener(CLICK,this._handleClickOverlay),this._slotForButton&&(this._slotForButton.addEventListener(CLICK,this._handleClickToggle),this._slotForButton.addEventListener(KEYDOWN,this._handleClickToggle)),this._slotForModal&&(this._slotForModal.addEventListener(CLICK,this._handleClickToggle),this._slotForModal.addEventListener(KEYDOWN,this._handleClickToggle))}_removeEvents(){document.removeEventListener(FOCUSIN,this._handleFocusIn),document.removeEventListener(KEYDOWN,this._handleKeyDown),this._buttonClose.removeEventListener(CLICK,this._handleClickToggle),this._modalOverlay.removeEventListener(CLICK,this._handleClickOverlay),this._slotForButton&&(this._slotForButton.removeEventListener(CLICK,this._handleClickToggle),this._slotForButton.removeEventListener(KEYDOWN,this._handleClickToggle)),this._slotForModal&&(this._slotForModal.removeEventListener(CLICK,this._handleClickToggle),this._slotForModal.removeEventListener(KEYDOWN,this._handleClickToggle))}_setAnimationFlag(){this._isAnimated=this.getAttribute(ANIMATED)!==FALSE}_setCloseTitle(){const t=this.getAttribute(CLOSE)||CLOSE_TITLE;this._buttonClose.title=t,this._buttonClose.setAttribute(ARIA_LABEL,t)}_setModalLabel(){let t=MODAL_LABEL_FALLBACK;this._heading&&(t=this._heading.textContent||t,t=t.trim().replace(SPACE_REGEX,SPACE)),this._modal.setAttribute(ARIA_LABEL,t)}_setActiveFlag(){const t=this.getAttribute(ACTIVE)===TRUE;this._isActive=t,this._toggleModalDisplay(()=>{this._isActive&&this._focusModal()})}_setStaticFlag(){this._isStatic=this.getAttribute(STATIC)===TRUE}_focusElement(t){window.requestAnimationFrame(()=>{typeof t.focus===FUNCTION&&t.focus()})}_focusModal(){window.requestAnimationFrame(()=>{this._modalScroll.scrollTo(0,0)})}_isOutsideModal(t){return!this._isActive||!t?!1:!(this.contains(t)||this._modal.contains(t))}_isMotionOkay(){const{matches:t}=window.matchMedia(PREFERS_REDUCED_MOTION);return this._isAnimated&&!t}_toggleModalDisplay(t){this.setAttribute(ACTIVE,this._isActive);const s=this._modalScroll.style.display===BLOCK,r=this._isMotionOkay(),o=r?ANIMATION_DURATION:0,h=window.innerWidth-document.documentElement.clientWidth,c=document.activeElement;this._isActive&&c&&(this._activeElement=c),this._isActive?(this._modalScroll.style.display=BLOCK,document.documentElement.style.overflow=HIDDEN,h&&(document.documentElement.style.paddingRight=`${h}px`),r&&(this._isHideShow=!0,this._modalScroll.setAttribute(DATA_SHOW,TRUE)),t(),this._timerForShow=window.setTimeout(()=>{clearTimeout(this._timerForShow),this._isHideShow=!1,this._modalScroll.removeAttribute(DATA_SHOW)},o)):s&&(r&&(this._isHideShow=!0,this._modalScroll.setAttribute(DATA_HIDE,TRUE)),t(),this._timerForHide=window.setTimeout(()=>{clearTimeout(this._timerForHide),this._isHideShow=!1,this._modalScroll.removeAttribute(DATA_HIDE),this._modalScroll.style.display=NONE,document.documentElement.style.overflow=EMPTY_STRING,document.documentElement.style.paddingRight=EMPTY_STRING},o))}_handleClickOverlay(t){if(this._isHideShow||this._isStatic)return;t.target.classList.contains("pop-up__overlay")&&this._handleClickToggle()}_handleClickToggle(t){let s=EMPTY_STRING,r=null;t&&(t.target&&(r=t.target),t.key&&(s=t.key,s=s.toLowerCase()));let o;r&&(r.classList.contains("pop-up__close")?o=r:typeof r.closest===FUNCTION&&(o=r.closest(".pop-up-toggle")));const h=t&&typeof t.preventDefault===FUNCTION,c=o&&h&&!s,a=o&&h&&[ENTER,SPACE].includes(s);o&&o.disabled||h&&!o||s&&!a||((a||c)&&t.preventDefault(),this._isActive=!this._isActive,this._toggleModalDisplay(()=>{this._isActive?this._focusModal():this._activeElement&&this._focusElement(this._activeElement)}))}_handleFocusIn(){if(!this._isActive)return;const t=this._shadow.activeElement||document.activeElement,s=t===this._focusTrapList[0],r=t===this._focusTrapList[1];let o=[];this._slotForModal&&(o=Array.from(this._slotForModal.querySelectorAll(FOCUSABLE_SELECTORS)));const c=Array.from(this._modal.querySelectorAll(FOCUSABLE_SELECTORS)).concat(o),a=c[0],u=c[c.length-1];s&&u?this._focusElement(u):r&&a?this._focusElement(a):this._isOutsideModal(t)&&this._focusModal()}_handleKeyDown({key:t}){this._isActive&&(t=t.toLowerCase(),t===ESCAPE&&!this._isHideShow&&!this._isStatic&&this._handleClickToggle(),t===TAB&&this._handleFocusIn())}}window.addEventListener("DOMContentLoaded",()=>{window.customElements.define("pop-up",PopUp)});class Arrow extends HTMLElement{connectedCallback(){this.innerHTML=`
        <svg width="9" height="14" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.5 13L7.5 7L1.5 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `}}customElements.define("arrow-element",Arrow);var We,Ze;class TabPanel extends HTMLElement{constructor(){super();et(this,We,0);et(this,Ze,"row");ne(this,"dom");ne(this,"shadow");this.bind(this)}bind(t){t.render=t.render.bind(t),t.attachEvents=t.attachEvents.bind(t),t.cacheDom=t.cacheDom.bind(t),t.onTabClick=t.onTabClick.bind(t),t.selectTabByIndex=t.selectTabByIndex.bind(t),t.onContentSlotChange=t.onContentSlotChange.bind(t),t.onTabSlotChange=t.onTabSlotChange.bind(t)}connectedCallback(){var t,s;this.render(),this.cacheDom(),this.attachEvents(),(t=this.dom.tabs[Ke(this,We)])==null||t.classList.add("selected"),(s=this.dom.contents[Ke(this,We)])==null||s.classList.add("selected")}render(){this.shadow=this.attachShadow({mode:"open"}),this.shadow.innerHTML=`
                <style>
                    @keyframes SHOW-PANEL {
                        0% { opacity: 0;}
                        100% { opacity: 1;}
                    }

                    :host { 
                        display: grid;
                        grid-template-rows: 1fr 5fr;
                        gap: var(--tabs-gap, 0px); 
                        height: var(--tabs-height, 100%);
                    }
                    :host([direction="column"]) { 
                        grid-template-columns: 1fr 2fr;
                        grid-template-rows: none;
                    }
                    :host([direction="column"]) .tabs { 
                        display: grid;
                        grid-template-columns: 1fr;
                        height: 100%;
                        width: var(--tab-width, 10rem); 
                    }
                    .tabs { 
                        display: flex; 
                        flex-direction: row; 
                        flex-wrap: nowrap; 
                        gap: var(--tab-gap, 0px); 
                        height: 5rem;
                        overflow: auto;
                    }
                    .tabs ::slotted(*) { 
                        cursor: pointer; 
                        padding: var(--tab-padding, 0.5rem); 
                        user-select: none;  
                        font-size: 1.6rem;
                    }
                    .tabs ::slotted(.selected) { 
                        background: var(--tab-selected, #efefef23); 
                        border-radius: var(--tab-border-radius, 0px);
                        border-bottom: var(--tab-border-border-bottom, none);
                    }
                    .tab-contents {
                        overflow: auto;
                        height: var(--pop-up-contents-height, 100%)
                    }
                    .tab-contents ::slotted(*) { 
                        display: none; 
                        animation-name: SHOW-PANEL;
                        animation-duration: 250s;
                    }
                    .tab-contents ::slotted(.selected) { 
                        display: block; 
                        padding: 5px; 
                        font-size: 1.4rem; 
                    }
                </style>
                <div class="tabs">
                    <slot id="tab-slot" name="tab"></slot>
                </div>
                <div class="tab-contents">
                    <slot id="content-slot" name="content"></slot>
                </div>
            `}cacheDom(){this.dom={tabSlot:this.shadow.querySelector("#tab-slot"),contentSlot:this.shadow.querySelector("#content-slot")},this.dom.tabs=this.dom.tabSlot.assignedElements(),this.dom.contents=this.dom.contentSlot.assignedElements()}attachEvents(){this.dom.tabSlot.addEventListener("click",this.onTabClick),this.dom.tabSlot.addEventListener("slotchange",this.onTabSlotChange),this.dom.contentSlot.addEventListener("slotchange",this.onContentSlotChange)}onTabSlotChange(){this.dom.tabs=this.dom.tabSlot.assignedElements()}onContentSlotChange(){this.dom.contents=this.dom.contentSlot.assignedElements()}onTabClick(t){const s=t.target;if(s.slot==="tab"){const r=this.dom.tabs.indexOf(s);this.selectTabByIndex(r)}}selectTabByIndex(t){const s=this.dom.tabs[t],r=this.dom.contents[t];!s||!r||(this.dom.contents.forEach(o=>o.classList.remove("selected")),this.dom.tabs.forEach(o=>o.classList.remove("selected")),r.classList.add("selected"),s.classList.add("selected"))}attributeChangedCallback(t,s,r){s!==r&&(t==="selected-index"?this.selectedIndex=r:this[t]=r)}set selectedIndex(t){it(this,We,t)}get selectedIndex(){return Ke(this,We)}set direction(t){it(this,Ze,t),this.setAttribute("direction",t)}get direction(){return Ke(this,Ze)}}We=new WeakMap,Ze=new WeakMap,ne(TabPanel,"observedAttributes",["selected-index","direction"]);window.addEventListener("DOMContentLoaded",()=>{window.customElements.define("tab-panel",TabPanel)});class ModalInfo extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const e=`
          <style>
              pop-up[id='modal-info'] {
                --pop-up-close-display: none;
                --pop-up-dialog-position: absolute;
                --pop-up-dialog-top: 120px;
                --pop-up-dialog-right: 24px;
                --pop-up-dialog-background-color: #000;
                --pop-up-dialog-border-radius: 24px;
                --pop-up-overlay-background-color: rgba(0, 0, 0, 0);
                --pop-up-dialog-width: 65rem;
                --pop-up-dialog-height: 34.5rem;
                
              }

            tab-panel[id='tabs-info'] {
              --tabs-gap: 10px;
              --tab-width: 20rem;
              --tab-padding: 2rem 1rem;
              --tabs-height: 30.5rem;
            } 

            @media screen and (max-width: 461px) {
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 0px;
              }
              pop-up[id='modal-info'] {
                --pop-up-close-display: block;
                --pop-up-dialog-width: 45rem;
                --pop-up-dialog-height: 34.5rem;
              }
            }
            @media (min-width: 461px) and (max-width: 960px) {
              tab-panel[direction="column"]{}
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 0px;
              }
              pop-up[id='modal-info'] {
                --pop-up-close-display: block;
                --pop-up-dialog-width: 55rem;
                --pop-up-dialog-height: 34.5rem;
              }
            }
            @media (min-width: 961px)  {
              tab-panel[id='tabs-info'] {
                --tab-border-border-bottom: 1px solid #168c48;
                --tab-border-radius: 8px;
              }
              pop-up[id='modal-info'] {
                --pop-up-overlay-position: absolute;
                --pop-up-overlay-top: 120px;
                --pop-up-overlay-right: 24px;
                --pop-up-overlay-left: none;
                --pop-up-overlay-width: 65rem;
                --pop-up-overlay-height: 34.5rem;
              }

              #modal-info #tabs-info .item #arrow {
                display: block;
              }
              #modal-info #tabs-info .item:hover {
                background-color: #efefef50;
                border-radius: 8px;
              }
            }
          </style>  
        `;this.innerHTML=`
          ${e}
          <pop-up static="true" id="modal-info">
              <div class="flex" slot="modal" >
                <tab-panel id="tabs-info">
                  <div class="item" slot="tab">
                    Introduction
                  </div>
                  <div slot="content">
                    <div class="content">
                      <h1>Introduction</h1>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                      <p>
                        Bacon ipsum dolor amet buffalo chicken pastrami pork. Fatback flank picanha spare ribs chuck alcatra. Spare ribs pork
                        loin sausage t-bone burgdoggen pastrami. Spare ribs kevin beef ribs alcatra ham hock turkey ribeye, prosciutto strip
                        steak bacon venison shank tri-tip landjaeger beef.
                      </p>
                    </div>
                  </div>
                  <div class="item" slot="tab">
                    How to play
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    The multiplier
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Apostar
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Cashout
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Autocash and cashout of 50%
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Another option 1
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option 2
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                  <div class="item" slot="tab">
                    Another option 3
                  </div>
                  <div slot="content">
                    Integer ac est vel enim bibendum tempus. Aenean dignissim a augue laoreet elementum. Vivamus sit amet facilisis ipsum,
                    id fringilla tortor. Integer vitae est ultricies, 
                  </div>
                  <div class="item" slot="tab">
                    Another option 4
                  </div>
                  <div slot="content">
                    Veggies es bonus vobis, proinde vos postulo essum magis kohlrabi welsh onion daikon amaranth tatsoi tomatillo melon
                    azuki bean garlic. 
                  </div>
                </tab-panel>         
            </div>
          </pop-up>
    `}}customElements.define("modal-info",ModalInfo);var global$1,hasRequiredGlobal;function requireGlobal(){if(hasRequiredGlobal)return global$1;hasRequiredGlobal=1;var n=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return global$1=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}(),global$1}const name="websocket",description="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",contributors=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],version$1="1.0.34",repository={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage="https://github.com/theturtle32/WebSocket-Node",engines={node:">=4.0.0"},dependencies={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},devDependencies={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},config={verbose:!1},scripts={test:"tape test/unit/*.js",gulp:"gulp"},main="index",directories={lib:"./lib"},browser$1="lib/browser.js",license="Apache-2.0",require$$0={name,description,keywords,author,contributors,version:version$1,repository,homepage,engines,dependencies,devDependencies,config,scripts,main,directories,browser:browser$1,license};var version=require$$0.version,_globalThis;if(typeof globalThis=="object")_globalThis=globalThis;else try{_globalThis=requireGlobal()}catch{}finally{if(!_globalThis&&typeof window<"u"&&(_globalThis=window),!_globalThis)throw new Error("Could not determine global this")}var NativeWebSocket=_globalThis.WebSocket||_globalThis.MozWebSocket,websocket_version=version;function W3CWebSocket(n,e){var t;return e?t=new NativeWebSocket(n,e):t=new NativeWebSocket(n),t}NativeWebSocket&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(W3CWebSocket,n,{get:function(){return NativeWebSocket[n]}})});var browser={w3cwebsocket:NativeWebSocket?W3CWebSocket:null,version:websocket_version};const BACKEND_URL="wss://igaming-ws.fromsolvers.com/ws",DESKTOP_WIDTH=parseInt("1920"),DESKTOP_HEIGHT=parseInt("1080"),MULTIPLIER_REMOTE_DELAY=parseInt("300");var buffer={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var s=t===e?0:4-t%4;return[t,s]}function byteLength(n){var e=getLens(n),t=e[0],s=e[1];return(t+s)*3/4-s}function _byteLength(n,e,t){return(e+t)*3/4-t}function toByteArray(n){var e,t=getLens(n),s=t[0],r=t[1],o=new Arr(_byteLength(n,s,r)),h=0,c=r>0?s-4:s,a;for(a=0;a<c;a+=4)e=revLookup[n.charCodeAt(a)]<<18|revLookup[n.charCodeAt(a+1)]<<12|revLookup[n.charCodeAt(a+2)]<<6|revLookup[n.charCodeAt(a+3)],o[h++]=e>>16&255,o[h++]=e>>8&255,o[h++]=e&255;return r===2&&(e=revLookup[n.charCodeAt(a)]<<2|revLookup[n.charCodeAt(a+1)]>>4,o[h++]=e&255),r===1&&(e=revLookup[n.charCodeAt(a)]<<10|revLookup[n.charCodeAt(a+1)]<<4|revLookup[n.charCodeAt(a+2)]>>2,o[h++]=e>>8&255,o[h++]=e&255),o}function tripletToBase64(n){return lookup[n>>18&63]+lookup[n>>12&63]+lookup[n>>6&63]+lookup[n&63]}function encodeChunk(n,e,t){for(var s,r=[],o=e;o<t;o+=3)s=(n[o]<<16&16711680)+(n[o+1]<<8&65280)+(n[o+2]&255),r.push(tripletToBase64(s));return r.join("")}function fromByteArray(n){for(var e,t=n.length,s=t%3,r=[],o=16383,h=0,c=t-s;h<c;h+=o)r.push(encodeChunk(n,h,h+o>c?c:h+o));return s===1?(e=n[t-1],r.push(lookup[e>>2]+lookup[e<<4&63]+"==")):s===2&&(e=(n[t-2]<<8)+n[t-1],r.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),r.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(n,e,t,s,r){var o,h,c=r*8-s-1,a=(1<<c)-1,u=a>>1,d=-7,p=t?r-1:0,m=t?-1:1,g=n[e+p];for(p+=m,o=g&(1<<-d)-1,g>>=-d,d+=c;d>0;o=o*256+n[e+p],p+=m,d-=8);for(h=o&(1<<-d)-1,o>>=-d,d+=s;d>0;h=h*256+n[e+p],p+=m,d-=8);if(o===0)o=1-u;else{if(o===a)return h?NaN:(g?-1:1)*(1/0);h=h+Math.pow(2,s),o=o-u}return(g?-1:1)*h*Math.pow(2,o-s)};ieee754.write=function(n,e,t,s,r,o){var h,c,a,u=o*8-r-1,d=(1<<u)-1,p=d>>1,m=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=s?0:o-1,_=s?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,h=d):(h=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-h))<1&&(h--,a*=2),h+p>=1?e+=m/a:e+=m*Math.pow(2,1-p),e*a>=2&&(h++,a/=2),h+p>=d?(c=0,h=d):h+p>=1?(c=(e*a-1)*Math.pow(2,r),h=h+p):(c=e*Math.pow(2,p-1)*Math.pow(2,r),h=0));r>=8;n[t+g]=c&255,g+=_,c/=256,r-=8);for(h=h<<r|c,u+=r;u>0;n[t+g]=h&255,g+=_,h/=256,u-=8);n[t+g-_]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=base64Js,t=ieee754,s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=c,n.SlowBuffer=w,n.INSPECT_MAX_BYTES=50;const r=2147483647;n.kMaxLength=r,c.TYPED_ARRAY_SUPPORT=o(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const re=new Uint8Array(1),W={foo:function(){return 42}};return Object.setPrototypeOf(W,Uint8Array.prototype),Object.setPrototypeOf(re,W),re.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function h(re){if(re>r)throw new RangeError('The value "'+re+'" is invalid for option "size"');const W=new Uint8Array(re);return Object.setPrototypeOf(W,c.prototype),W}function c(re,W,te){if(typeof re=="number"){if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(re)}return a(re,W,te)}c.poolSize=8192;function a(re,W,te){if(typeof re=="string")return m(re,W);if(ArrayBuffer.isView(re))return _(re);if(re==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof re);if(Ye(re,ArrayBuffer)||re&&Ye(re.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ye(re,SharedArrayBuffer)||re&&Ye(re.buffer,SharedArrayBuffer)))return y(re,W,te);if(typeof re=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ae=re.valueOf&&re.valueOf();if(ae!=null&&ae!==re)return c.from(ae,W,te);const ce=v(re);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof re[Symbol.toPrimitive]=="function")return c.from(re[Symbol.toPrimitive]("string"),W,te);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof re)}c.from=function(re,W,te){return a(re,W,te)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function u(re){if(typeof re!="number")throw new TypeError('"size" argument must be of type number');if(re<0)throw new RangeError('The value "'+re+'" is invalid for option "size"')}function d(re,W,te){return u(re),re<=0?h(re):W!==void 0?typeof te=="string"?h(re).fill(W,te):h(re).fill(W):h(re)}c.alloc=function(re,W,te){return d(re,W,te)};function p(re){return u(re),h(re<0?0:N(re)|0)}c.allocUnsafe=function(re){return p(re)},c.allocUnsafeSlow=function(re){return p(re)};function m(re,W){if((typeof W!="string"||W==="")&&(W="utf8"),!c.isEncoding(W))throw new TypeError("Unknown encoding: "+W);const te=k(re,W)|0;let ae=h(te);const ce=ae.write(re,W);return ce!==te&&(ae=ae.slice(0,ce)),ae}function g(re){const W=re.length<0?0:N(re.length)|0,te=h(W);for(let ae=0;ae<W;ae+=1)te[ae]=re[ae]&255;return te}function _(re){if(Ye(re,Uint8Array)){const W=new Uint8Array(re);return y(W.buffer,W.byteOffset,W.byteLength)}return g(re)}function y(re,W,te){if(W<0||re.byteLength<W)throw new RangeError('"offset" is outside of buffer bounds');if(re.byteLength<W+(te||0))throw new RangeError('"length" is outside of buffer bounds');let ae;return W===void 0&&te===void 0?ae=new Uint8Array(re):te===void 0?ae=new Uint8Array(re,W):ae=new Uint8Array(re,W,te),Object.setPrototypeOf(ae,c.prototype),ae}function v(re){if(c.isBuffer(re)){const W=N(re.length)|0,te=h(W);return te.length===0||re.copy(te,0,0,W),te}if(re.length!==void 0)return typeof re.length!="number"||Qe(re.length)?h(0):g(re);if(re.type==="Buffer"&&Array.isArray(re.data))return g(re.data)}function N(re){if(re>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return re|0}function w(re){return+re!=re&&(re=0),c.alloc(+re)}c.isBuffer=function(W){return W!=null&&W._isBuffer===!0&&W!==c.prototype},c.compare=function(W,te){if(Ye(W,Uint8Array)&&(W=c.from(W,W.offset,W.byteLength)),Ye(te,Uint8Array)&&(te=c.from(te,te.offset,te.byteLength)),!c.isBuffer(W)||!c.isBuffer(te))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(W===te)return 0;let ae=W.length,ce=te.length;for(let me=0,ye=Math.min(ae,ce);me<ye;++me)if(W[me]!==te[me]){ae=W[me],ce=te[me];break}return ae<ce?-1:ce<ae?1:0},c.isEncoding=function(W){switch(String(W).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(W,te){if(!Array.isArray(W))throw new TypeError('"list" argument must be an Array of Buffers');if(W.length===0)return c.alloc(0);let ae;if(te===void 0)for(te=0,ae=0;ae<W.length;++ae)te+=W[ae].length;const ce=c.allocUnsafe(te);let me=0;for(ae=0;ae<W.length;++ae){let ye=W[ae];if(Ye(ye,Uint8Array))me+ye.length>ce.length?(c.isBuffer(ye)||(ye=c.from(ye)),ye.copy(ce,me)):Uint8Array.prototype.set.call(ce,ye,me);else if(c.isBuffer(ye))ye.copy(ce,me);else throw new TypeError('"list" argument must be an Array of Buffers');me+=ye.length}return ce};function k(re,W){if(c.isBuffer(re))return re.length;if(ArrayBuffer.isView(re)||Ye(re,ArrayBuffer))return re.byteLength;if(typeof re!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof re);const te=re.length,ae=arguments.length>2&&arguments[2]===!0;if(!ae&&te===0)return 0;let ce=!1;for(;;)switch(W){case"ascii":case"latin1":case"binary":return te;case"utf8":case"utf-8":return He(re).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te*2;case"hex":return te>>>1;case"base64":return qe(re).length;default:if(ce)return ae?-1:He(re).length;W=(""+W).toLowerCase(),ce=!0}}c.byteLength=k;function U(re,W,te){let ae=!1;if((W===void 0||W<0)&&(W=0),W>this.length||((te===void 0||te>this.length)&&(te=this.length),te<=0)||(te>>>=0,W>>>=0,te<=W))return"";for(re||(re="utf8");;)switch(re){case"hex":return Pe(this,W,te);case"utf8":case"utf-8":return fe(this,W,te);case"ascii":return be(this,W,te);case"latin1":case"binary":return Ae(this,W,te);case"base64":return de(this,W,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xe(this,W,te);default:if(ae)throw new TypeError("Unknown encoding: "+re);re=(re+"").toLowerCase(),ae=!0}}c.prototype._isBuffer=!0;function ee(re,W,te){const ae=re[W];re[W]=re[te],re[te]=ae}c.prototype.swap16=function(){const W=this.length;if(W%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let te=0;te<W;te+=2)ee(this,te,te+1);return this},c.prototype.swap32=function(){const W=this.length;if(W%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let te=0;te<W;te+=4)ee(this,te,te+3),ee(this,te+1,te+2);return this},c.prototype.swap64=function(){const W=this.length;if(W%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let te=0;te<W;te+=8)ee(this,te,te+7),ee(this,te+1,te+6),ee(this,te+2,te+5),ee(this,te+3,te+4);return this},c.prototype.toString=function(){const W=this.length;return W===0?"":arguments.length===0?fe(this,0,W):U.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(W){if(!c.isBuffer(W))throw new TypeError("Argument must be a Buffer");return this===W?!0:c.compare(this,W)===0},c.prototype.inspect=function(){let W="";const te=n.INSPECT_MAX_BYTES;return W=this.toString("hex",0,te).replace(/(.{2})/g,"$1 ").trim(),this.length>te&&(W+=" ... "),"<Buffer "+W+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(W,te,ae,ce,me){if(Ye(W,Uint8Array)&&(W=c.from(W,W.offset,W.byteLength)),!c.isBuffer(W))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof W);if(te===void 0&&(te=0),ae===void 0&&(ae=W?W.length:0),ce===void 0&&(ce=0),me===void 0&&(me=this.length),te<0||ae>W.length||ce<0||me>this.length)throw new RangeError("out of range index");if(ce>=me&&te>=ae)return 0;if(ce>=me)return-1;if(te>=ae)return 1;if(te>>>=0,ae>>>=0,ce>>>=0,me>>>=0,this===W)return 0;let ye=me-ce,ke=ae-te;const Ve=Math.min(ye,ke),$e=this.slice(ce,me),Ge=W.slice(te,ae);for(let De=0;De<Ve;++De)if($e[De]!==Ge[De]){ye=$e[De],ke=Ge[De];break}return ye<ke?-1:ke<ye?1:0};function ie(re,W,te,ae,ce){if(re.length===0)return-1;if(typeof te=="string"?(ae=te,te=0):te>2147483647?te=2147483647:te<-2147483648&&(te=-2147483648),te=+te,Qe(te)&&(te=ce?0:re.length-1),te<0&&(te=re.length+te),te>=re.length){if(ce)return-1;te=re.length-1}else if(te<0)if(ce)te=0;else return-1;if(typeof W=="string"&&(W=c.from(W,ae)),c.isBuffer(W))return W.length===0?-1:se(re,W,te,ae,ce);if(typeof W=="number")return W=W&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(re,W,te):Uint8Array.prototype.lastIndexOf.call(re,W,te):se(re,[W],te,ae,ce);throw new TypeError("val must be string, number or Buffer")}function se(re,W,te,ae,ce){let me=1,ye=re.length,ke=W.length;if(ae!==void 0&&(ae=String(ae).toLowerCase(),ae==="ucs2"||ae==="ucs-2"||ae==="utf16le"||ae==="utf-16le")){if(re.length<2||W.length<2)return-1;me=2,ye/=2,ke/=2,te/=2}function Ve(Ge,De){return me===1?Ge[De]:Ge.readUInt16BE(De*me)}let $e;if(ce){let Ge=-1;for($e=te;$e<ye;$e++)if(Ve(re,$e)===Ve(W,Ge===-1?0:$e-Ge)){if(Ge===-1&&(Ge=$e),$e-Ge+1===ke)return Ge*me}else Ge!==-1&&($e-=$e-Ge),Ge=-1}else for(te+ke>ye&&(te=ye-ke),$e=te;$e>=0;$e--){let Ge=!0;for(let De=0;De<ke;De++)if(Ve(re,$e+De)!==Ve(W,De)){Ge=!1;break}if(Ge)return $e}return-1}c.prototype.includes=function(W,te,ae){return this.indexOf(W,te,ae)!==-1},c.prototype.indexOf=function(W,te,ae){return ie(this,W,te,ae,!0)},c.prototype.lastIndexOf=function(W,te,ae){return ie(this,W,te,ae,!1)};function oe(re,W,te,ae){te=Number(te)||0;const ce=re.length-te;ae?(ae=Number(ae),ae>ce&&(ae=ce)):ae=ce;const me=W.length;ae>me/2&&(ae=me/2);let ye;for(ye=0;ye<ae;++ye){const ke=parseInt(W.substr(ye*2,2),16);if(Qe(ke))return ye;re[te+ye]=ke}return ye}function le(re,W,te,ae){return Je(He(W,re.length-te),re,te,ae)}function ue(re,W,te,ae){return Je(je(W),re,te,ae)}function he(re,W,te,ae){return Je(qe(W),re,te,ae)}function pe(re,W,te,ae){return Je(st(W,re.length-te),re,te,ae)}c.prototype.write=function(W,te,ae,ce){if(te===void 0)ce="utf8",ae=this.length,te=0;else if(ae===void 0&&typeof te=="string")ce=te,ae=this.length,te=0;else if(isFinite(te))te=te>>>0,isFinite(ae)?(ae=ae>>>0,ce===void 0&&(ce="utf8")):(ce=ae,ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const me=this.length-te;if((ae===void 0||ae>me)&&(ae=me),W.length>0&&(ae<0||te<0)||te>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");let ye=!1;for(;;)switch(ce){case"hex":return oe(this,W,te,ae);case"utf8":case"utf-8":return le(this,W,te,ae);case"ascii":case"latin1":case"binary":return ue(this,W,te,ae);case"base64":return he(this,W,te,ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pe(this,W,te,ae);default:if(ye)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),ye=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function de(re,W,te){return W===0&&te===re.length?e.fromByteArray(re):e.fromByteArray(re.slice(W,te))}function fe(re,W,te){te=Math.min(re.length,te);const ae=[];let ce=W;for(;ce<te;){const me=re[ce];let ye=null,ke=me>239?4:me>223?3:me>191?2:1;if(ce+ke<=te){let Ve,$e,Ge,De;switch(ke){case 1:me<128&&(ye=me);break;case 2:Ve=re[ce+1],(Ve&192)===128&&(De=(me&31)<<6|Ve&63,De>127&&(ye=De));break;case 3:Ve=re[ce+1],$e=re[ce+2],(Ve&192)===128&&($e&192)===128&&(De=(me&15)<<12|(Ve&63)<<6|$e&63,De>2047&&(De<55296||De>57343)&&(ye=De));break;case 4:Ve=re[ce+1],$e=re[ce+2],Ge=re[ce+3],(Ve&192)===128&&($e&192)===128&&(Ge&192)===128&&(De=(me&15)<<18|(Ve&63)<<12|($e&63)<<6|Ge&63,De>65535&&De<1114112&&(ye=De))}}ye===null?(ye=65533,ke=1):ye>65535&&(ye-=65536,ae.push(ye>>>10&1023|55296),ye=56320|ye&1023),ae.push(ye),ce+=ke}return Ce(ae)}const Te=4096;function Ce(re){const W=re.length;if(W<=Te)return String.fromCharCode.apply(String,re);let te="",ae=0;for(;ae<W;)te+=String.fromCharCode.apply(String,re.slice(ae,ae+=Te));return te}function be(re,W,te){let ae="";te=Math.min(re.length,te);for(let ce=W;ce<te;++ce)ae+=String.fromCharCode(re[ce]&127);return ae}function Ae(re,W,te){let ae="";te=Math.min(re.length,te);for(let ce=W;ce<te;++ce)ae+=String.fromCharCode(re[ce]);return ae}function Pe(re,W,te){const ae=re.length;(!W||W<0)&&(W=0),(!te||te<0||te>ae)&&(te=ae);let ce="";for(let me=W;me<te;++me)ce+=ft[re[me]];return ce}function xe(re,W,te){const ae=re.slice(W,te);let ce="";for(let me=0;me<ae.length-1;me+=2)ce+=String.fromCharCode(ae[me]+ae[me+1]*256);return ce}c.prototype.slice=function(W,te){const ae=this.length;W=~~W,te=te===void 0?ae:~~te,W<0?(W+=ae,W<0&&(W=0)):W>ae&&(W=ae),te<0?(te+=ae,te<0&&(te=0)):te>ae&&(te=ae),te<W&&(te=W);const ce=this.subarray(W,te);return Object.setPrototypeOf(ce,c.prototype),ce};function Se(re,W,te){if(re%1!==0||re<0)throw new RangeError("offset is not uint");if(re+W>te)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(W,te,ae){W=W>>>0,te=te>>>0,ae||Se(W,te,this.length);let ce=this[W],me=1,ye=0;for(;++ye<te&&(me*=256);)ce+=this[W+ye]*me;return ce},c.prototype.readUintBE=c.prototype.readUIntBE=function(W,te,ae){W=W>>>0,te=te>>>0,ae||Se(W,te,this.length);let ce=this[W+--te],me=1;for(;te>0&&(me*=256);)ce+=this[W+--te]*me;return ce},c.prototype.readUint8=c.prototype.readUInt8=function(W,te){return W=W>>>0,te||Se(W,1,this.length),this[W]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(W,te){return W=W>>>0,te||Se(W,2,this.length),this[W]|this[W+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(W,te){return W=W>>>0,te||Se(W,2,this.length),this[W]<<8|this[W+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),(this[W]|this[W+1]<<8|this[W+2]<<16)+this[W+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),this[W]*16777216+(this[W+1]<<16|this[W+2]<<8|this[W+3])},c.prototype.readBigUInt64LE=ze(function(W){W=W>>>0,we(W,"offset");const te=this[W],ae=this[W+7];(te===void 0||ae===void 0)&&Re(W,this.length-8);const ce=te+this[++W]*2**8+this[++W]*2**16+this[++W]*2**24,me=this[++W]+this[++W]*2**8+this[++W]*2**16+ae*2**24;return BigInt(ce)+(BigInt(me)<<BigInt(32))}),c.prototype.readBigUInt64BE=ze(function(W){W=W>>>0,we(W,"offset");const te=this[W],ae=this[W+7];(te===void 0||ae===void 0)&&Re(W,this.length-8);const ce=te*2**24+this[++W]*2**16+this[++W]*2**8+this[++W],me=this[++W]*2**24+this[++W]*2**16+this[++W]*2**8+ae;return(BigInt(ce)<<BigInt(32))+BigInt(me)}),c.prototype.readIntLE=function(W,te,ae){W=W>>>0,te=te>>>0,ae||Se(W,te,this.length);let ce=this[W],me=1,ye=0;for(;++ye<te&&(me*=256);)ce+=this[W+ye]*me;return me*=128,ce>=me&&(ce-=Math.pow(2,8*te)),ce},c.prototype.readIntBE=function(W,te,ae){W=W>>>0,te=te>>>0,ae||Se(W,te,this.length);let ce=te,me=1,ye=this[W+--ce];for(;ce>0&&(me*=256);)ye+=this[W+--ce]*me;return me*=128,ye>=me&&(ye-=Math.pow(2,8*te)),ye},c.prototype.readInt8=function(W,te){return W=W>>>0,te||Se(W,1,this.length),this[W]&128?(255-this[W]+1)*-1:this[W]},c.prototype.readInt16LE=function(W,te){W=W>>>0,te||Se(W,2,this.length);const ae=this[W]|this[W+1]<<8;return ae&32768?ae|4294901760:ae},c.prototype.readInt16BE=function(W,te){W=W>>>0,te||Se(W,2,this.length);const ae=this[W+1]|this[W]<<8;return ae&32768?ae|4294901760:ae},c.prototype.readInt32LE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),this[W]|this[W+1]<<8|this[W+2]<<16|this[W+3]<<24},c.prototype.readInt32BE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),this[W]<<24|this[W+1]<<16|this[W+2]<<8|this[W+3]},c.prototype.readBigInt64LE=ze(function(W){W=W>>>0,we(W,"offset");const te=this[W],ae=this[W+7];(te===void 0||ae===void 0)&&Re(W,this.length-8);const ce=this[W+4]+this[W+5]*2**8+this[W+6]*2**16+(ae<<24);return(BigInt(ce)<<BigInt(32))+BigInt(te+this[++W]*2**8+this[++W]*2**16+this[++W]*2**24)}),c.prototype.readBigInt64BE=ze(function(W){W=W>>>0,we(W,"offset");const te=this[W],ae=this[W+7];(te===void 0||ae===void 0)&&Re(W,this.length-8);const ce=(te<<24)+this[++W]*2**16+this[++W]*2**8+this[++W];return(BigInt(ce)<<BigInt(32))+BigInt(this[++W]*2**24+this[++W]*2**16+this[++W]*2**8+ae)}),c.prototype.readFloatLE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),t.read(this,W,!0,23,4)},c.prototype.readFloatBE=function(W,te){return W=W>>>0,te||Se(W,4,this.length),t.read(this,W,!1,23,4)},c.prototype.readDoubleLE=function(W,te){return W=W>>>0,te||Se(W,8,this.length),t.read(this,W,!0,52,8)},c.prototype.readDoubleBE=function(W,te){return W=W>>>0,te||Se(W,8,this.length),t.read(this,W,!1,52,8)};function Me(re,W,te,ae,ce,me){if(!c.isBuffer(re))throw new TypeError('"buffer" argument must be a Buffer instance');if(W>ce||W<me)throw new RangeError('"value" argument is out of bounds');if(te+ae>re.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(W,te,ae,ce){if(W=+W,te=te>>>0,ae=ae>>>0,!ce){const ke=Math.pow(2,8*ae)-1;Me(this,W,te,ae,ke,0)}let me=1,ye=0;for(this[te]=W&255;++ye<ae&&(me*=256);)this[te+ye]=W/me&255;return te+ae},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(W,te,ae,ce){if(W=+W,te=te>>>0,ae=ae>>>0,!ce){const ke=Math.pow(2,8*ae)-1;Me(this,W,te,ae,ke,0)}let me=ae-1,ye=1;for(this[te+me]=W&255;--me>=0&&(ye*=256);)this[te+me]=W/ye&255;return te+ae},c.prototype.writeUint8=c.prototype.writeUInt8=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,1,255,0),this[te]=W&255,te+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,2,65535,0),this[te]=W&255,this[te+1]=W>>>8,te+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,2,65535,0),this[te]=W>>>8,this[te+1]=W&255,te+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,4,4294967295,0),this[te+3]=W>>>24,this[te+2]=W>>>16,this[te+1]=W>>>8,this[te]=W&255,te+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,4,4294967295,0),this[te]=W>>>24,this[te+1]=W>>>16,this[te+2]=W>>>8,this[te+3]=W&255,te+4};function Oe(re,W,te,ae,ce){Ee(W,ae,ce,re,te,7);let me=Number(W&BigInt(4294967295));re[te++]=me,me=me>>8,re[te++]=me,me=me>>8,re[te++]=me,me=me>>8,re[te++]=me;let ye=Number(W>>BigInt(32)&BigInt(4294967295));return re[te++]=ye,ye=ye>>8,re[te++]=ye,ye=ye>>8,re[te++]=ye,ye=ye>>8,re[te++]=ye,te}function Ie(re,W,te,ae,ce){Ee(W,ae,ce,re,te,7);let me=Number(W&BigInt(4294967295));re[te+7]=me,me=me>>8,re[te+6]=me,me=me>>8,re[te+5]=me,me=me>>8,re[te+4]=me;let ye=Number(W>>BigInt(32)&BigInt(4294967295));return re[te+3]=ye,ye=ye>>8,re[te+2]=ye,ye=ye>>8,re[te+1]=ye,ye=ye>>8,re[te]=ye,te+8}c.prototype.writeBigUInt64LE=ze(function(W,te=0){return Oe(this,W,te,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=ze(function(W,te=0){return Ie(this,W,te,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(W,te,ae,ce){if(W=+W,te=te>>>0,!ce){const Ve=Math.pow(2,8*ae-1);Me(this,W,te,ae,Ve-1,-Ve)}let me=0,ye=1,ke=0;for(this[te]=W&255;++me<ae&&(ye*=256);)W<0&&ke===0&&this[te+me-1]!==0&&(ke=1),this[te+me]=(W/ye>>0)-ke&255;return te+ae},c.prototype.writeIntBE=function(W,te,ae,ce){if(W=+W,te=te>>>0,!ce){const Ve=Math.pow(2,8*ae-1);Me(this,W,te,ae,Ve-1,-Ve)}let me=ae-1,ye=1,ke=0;for(this[te+me]=W&255;--me>=0&&(ye*=256);)W<0&&ke===0&&this[te+me+1]!==0&&(ke=1),this[te+me]=(W/ye>>0)-ke&255;return te+ae},c.prototype.writeInt8=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,1,127,-128),W<0&&(W=255+W+1),this[te]=W&255,te+1},c.prototype.writeInt16LE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,2,32767,-32768),this[te]=W&255,this[te+1]=W>>>8,te+2},c.prototype.writeInt16BE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,2,32767,-32768),this[te]=W>>>8,this[te+1]=W&255,te+2},c.prototype.writeInt32LE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,4,2147483647,-2147483648),this[te]=W&255,this[te+1]=W>>>8,this[te+2]=W>>>16,this[te+3]=W>>>24,te+4},c.prototype.writeInt32BE=function(W,te,ae){return W=+W,te=te>>>0,ae||Me(this,W,te,4,2147483647,-2147483648),W<0&&(W=4294967295+W+1),this[te]=W>>>24,this[te+1]=W>>>16,this[te+2]=W>>>8,this[te+3]=W&255,te+4},c.prototype.writeBigInt64LE=ze(function(W,te=0){return Oe(this,W,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=ze(function(W,te=0){return Ie(this,W,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Fe(re,W,te,ae,ce,me){if(te+ae>re.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("Index out of range")}function Ne(re,W,te,ae,ce){return W=+W,te=te>>>0,ce||Fe(re,W,te,4),t.write(re,W,te,ae,23,4),te+4}c.prototype.writeFloatLE=function(W,te,ae){return Ne(this,W,te,!0,ae)},c.prototype.writeFloatBE=function(W,te,ae){return Ne(this,W,te,!1,ae)};function Ue(re,W,te,ae,ce){return W=+W,te=te>>>0,ce||Fe(re,W,te,8),t.write(re,W,te,ae,52,8),te+8}c.prototype.writeDoubleLE=function(W,te,ae){return Ue(this,W,te,!0,ae)},c.prototype.writeDoubleBE=function(W,te,ae){return Ue(this,W,te,!1,ae)},c.prototype.copy=function(W,te,ae,ce){if(!c.isBuffer(W))throw new TypeError("argument should be a Buffer");if(ae||(ae=0),!ce&&ce!==0&&(ce=this.length),te>=W.length&&(te=W.length),te||(te=0),ce>0&&ce<ae&&(ce=ae),ce===ae||W.length===0||this.length===0)return 0;if(te<0)throw new RangeError("targetStart out of bounds");if(ae<0||ae>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),W.length-te<ce-ae&&(ce=W.length-te+ae);const me=ce-ae;return this===W&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(te,ae,ce):Uint8Array.prototype.set.call(W,this.subarray(ae,ce),te),me},c.prototype.fill=function(W,te,ae,ce){if(typeof W=="string"){if(typeof te=="string"?(ce=te,te=0,ae=this.length):typeof ae=="string"&&(ce=ae,ae=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!c.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(W.length===1){const ye=W.charCodeAt(0);(ce==="utf8"&&ye<128||ce==="latin1")&&(W=ye)}}else typeof W=="number"?W=W&255:typeof W=="boolean"&&(W=Number(W));if(te<0||this.length<te||this.length<ae)throw new RangeError("Out of range index");if(ae<=te)return this;te=te>>>0,ae=ae===void 0?this.length:ae>>>0,W||(W=0);let me;if(typeof W=="number")for(me=te;me<ae;++me)this[me]=W;else{const ye=c.isBuffer(W)?W:c.from(W,ce),ke=ye.length;if(ke===0)throw new TypeError('The value "'+W+'" is invalid for argument "value"');for(me=0;me<ae-te;++me)this[me+te]=ye[me%ke]}return this};const Be={};function _e(re,W,te){Be[re]=class extends te{constructor(){super(),Object.defineProperty(this,"message",{value:W.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${re}]`,this.stack,delete this.name}get code(){return re}set code(ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ce,writable:!0})}toString(){return`${this.name} [${re}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(re){return re?`${re} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_e("ERR_INVALID_ARG_TYPE",function(re,W){return`The "${re}" argument must be of type number. Received type ${typeof W}`},TypeError),_e("ERR_OUT_OF_RANGE",function(re,W,te){let ae=`The value of "${re}" is out of range.`,ce=te;return Number.isInteger(te)&&Math.abs(te)>2**32?ce=ge(String(te)):typeof te=="bigint"&&(ce=String(te),(te>BigInt(2)**BigInt(32)||te<-(BigInt(2)**BigInt(32)))&&(ce=ge(ce)),ce+="n"),ae+=` It must be ${W}. Received ${ce}`,ae},RangeError);function ge(re){let W="",te=re.length;const ae=re[0]==="-"?1:0;for(;te>=ae+4;te-=3)W=`_${re.slice(te-3,te)}${W}`;return`${re.slice(0,te)}${W}`}function ve(re,W,te){we(W,"offset"),(re[W]===void 0||re[W+te]===void 0)&&Re(W,re.length-(te+1))}function Ee(re,W,te,ae,ce,me){if(re>te||re<W){const ye=typeof W=="bigint"?"n":"";let ke;throw me>3?W===0||W===BigInt(0)?ke=`>= 0${ye} and < 2${ye} ** ${(me+1)*8}${ye}`:ke=`>= -(2${ye} ** ${(me+1)*8-1}${ye}) and < 2 ** ${(me+1)*8-1}${ye}`:ke=`>= ${W}${ye} and <= ${te}${ye}`,new Be.ERR_OUT_OF_RANGE("value",ke,re)}ve(ae,ce,me)}function we(re,W){if(typeof re!="number")throw new Be.ERR_INVALID_ARG_TYPE(W,"number",re)}function Re(re,W,te){throw Math.floor(re)!==re?(we(re,te),new Be.ERR_OUT_OF_RANGE(te||"offset","an integer",re)):W<0?new Be.ERR_BUFFER_OUT_OF_BOUNDS:new Be.ERR_OUT_OF_RANGE(te||"offset",`>= ${te?1:0} and <= ${W}`,re)}const Le=/[^+/0-9A-Za-z-_]/g;function Xe(re){if(re=re.split("=")[0],re=re.trim().replace(Le,""),re.length<2)return"";for(;re.length%4!==0;)re=re+"=";return re}function He(re,W){W=W||1/0;let te;const ae=re.length;let ce=null;const me=[];for(let ye=0;ye<ae;++ye){if(te=re.charCodeAt(ye),te>55295&&te<57344){if(!ce){if(te>56319){(W-=3)>-1&&me.push(239,191,189);continue}else if(ye+1===ae){(W-=3)>-1&&me.push(239,191,189);continue}ce=te;continue}if(te<56320){(W-=3)>-1&&me.push(239,191,189),ce=te;continue}te=(ce-55296<<10|te-56320)+65536}else ce&&(W-=3)>-1&&me.push(239,191,189);if(ce=null,te<128){if((W-=1)<0)break;me.push(te)}else if(te<2048){if((W-=2)<0)break;me.push(te>>6|192,te&63|128)}else if(te<65536){if((W-=3)<0)break;me.push(te>>12|224,te>>6&63|128,te&63|128)}else if(te<1114112){if((W-=4)<0)break;me.push(te>>18|240,te>>12&63|128,te>>6&63|128,te&63|128)}else throw new Error("Invalid code point")}return me}function je(re){const W=[];for(let te=0;te<re.length;++te)W.push(re.charCodeAt(te)&255);return W}function st(re,W){let te,ae,ce;const me=[];for(let ye=0;ye<re.length&&!((W-=2)<0);++ye)te=re.charCodeAt(ye),ae=te>>8,ce=te%256,me.push(ce),me.push(ae);return me}function qe(re){return e.toByteArray(Xe(re))}function Je(re,W,te,ae){let ce;for(ce=0;ce<ae&&!(ce+te>=W.length||ce>=re.length);++ce)W[ce+te]=re[ce];return ce}function Ye(re,W){return re instanceof W||re!=null&&re.constructor!=null&&re.constructor.name!=null&&re.constructor.name===W.name}function Qe(re){return re!==re}const ft=function(){const re="0123456789abcdef",W=new Array(256);for(let te=0;te<16;++te){const ae=te*16;for(let ce=0;ce<16;++ce)W[ae+ce]=re[te]+re[ce]}return W}();function ze(re){return typeof BigInt>"u"?mt:re}function mt(){throw new Error("BigInt not supported")}})(buffer);var protobufjsExports={},protobufjs={get exports(){return protobufjsExports},set exports(n){protobufjsExports=n}},srcExports={},src={get exports(){return srcExports},set exports(n){srcExports=n}},indexLightExports={},indexLight={get exports(){return indexLightExports},set exports(n){indexLightExports=n}},indexMinimal={},minimal={},aspromise=asPromise$1;function asPromise$1(n,e){for(var t=new Array(arguments.length-1),s=0,r=2,o=!0;r<arguments.length;)t[s++]=arguments[r++];return new Promise(function(c,a){t[s]=function(d){if(o)if(o=!1,d)a(d);else{for(var p=new Array(arguments.length-1),m=0;m<p.length;)p[m++]=arguments[m];c.apply(null,p)}};try{n.apply(e||null,t)}catch(u){o&&(o=!1,a(u))}})}var base64$1={};(function(n){var e=n;e.length=function(c){var a=c.length;if(!a)return 0;for(var u=0;--a%4>1&&c.charAt(a)==="=";)++u;return Math.ceil(c.length*3)/4-u};for(var t=new Array(64),s=new Array(123),r=0;r<64;)s[t[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;e.encode=function(c,a,u){for(var d=null,p=[],m=0,g=0,_;a<u;){var y=c[a++];switch(g){case 0:p[m++]=t[y>>2],_=(y&3)<<4,g=1;break;case 1:p[m++]=t[_|y>>4],_=(y&15)<<2,g=2;break;case 2:p[m++]=t[_|y>>6],p[m++]=t[y&63],g=0;break}m>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,p)),m=0)}return g&&(p[m++]=t[_],p[m++]=61,g===1&&(p[m++]=61)),d?(m&&d.push(String.fromCharCode.apply(String,p.slice(0,m))),d.join("")):String.fromCharCode.apply(String,p.slice(0,m))};var o="invalid encoding";e.decode=function(c,a,u){for(var d=u,p=0,m,g=0;g<c.length;){var _=c.charCodeAt(g++);if(_===61&&p>1)break;if((_=s[_])===void 0)throw Error(o);switch(p){case 0:m=_,p=1;break;case 1:a[u++]=m<<2|(_&48)>>4,m=_,p=2;break;case 2:a[u++]=(m&15)<<4|(_&60)>>2,m=_,p=3;break;case 3:a[u++]=(m&3)<<6|_,p=0;break}}if(p===1)throw Error(o);return u-d},e.test=function(c){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(c)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,s){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:s||this}),this};EventEmitter.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var s=this._listeners[e],r=0;r<s.length;)s[r].fn===t?s.splice(r,1):++r;return this};EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var s=[],r=1;r<arguments.length;)s.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,s)}return this};var float=factory(factory);function factory(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),s=t[3]===128;function r(a,u,d){e[0]=a,u[d]=t[0],u[d+1]=t[1],u[d+2]=t[2],u[d+3]=t[3]}function o(a,u,d){e[0]=a,u[d]=t[3],u[d+1]=t[2],u[d+2]=t[1],u[d+3]=t[0]}n.writeFloatLE=s?r:o,n.writeFloatBE=s?o:r;function h(a,u){return t[0]=a[u],t[1]=a[u+1],t[2]=a[u+2],t[3]=a[u+3],e[0]}function c(a,u){return t[3]=a[u],t[2]=a[u+1],t[1]=a[u+2],t[0]=a[u+3],e[0]}n.readFloatLE=s?h:c,n.readFloatBE=s?c:h}():function(){function e(s,r,o,h){var c=r<0?1:0;if(c&&(r=-r),r===0)s(1/r>0?0:2147483648,o,h);else if(isNaN(r))s(2143289344,o,h);else if(r>34028234663852886e22)s((c<<31|2139095040)>>>0,o,h);else if(r<11754943508222875e-54)s((c<<31|Math.round(r/1401298464324817e-60))>>>0,o,h);else{var a=Math.floor(Math.log(r)/Math.LN2),u=Math.round(r*Math.pow(2,-a)*8388608)&8388607;s((c<<31|a+127<<23|u)>>>0,o,h)}}n.writeFloatLE=e.bind(null,writeUintLE),n.writeFloatBE=e.bind(null,writeUintBE);function t(s,r,o){var h=s(r,o),c=(h>>31)*2+1,a=h>>>23&255,u=h&8388607;return a===255?u?NaN:c*(1/0):a===0?c*1401298464324817e-60*u:c*Math.pow(2,a-150)*(u+8388608)}n.readFloatLE=t.bind(null,readUintLE),n.readFloatBE=t.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),s=t[7]===128;function r(a,u,d){e[0]=a,u[d]=t[0],u[d+1]=t[1],u[d+2]=t[2],u[d+3]=t[3],u[d+4]=t[4],u[d+5]=t[5],u[d+6]=t[6],u[d+7]=t[7]}function o(a,u,d){e[0]=a,u[d]=t[7],u[d+1]=t[6],u[d+2]=t[5],u[d+3]=t[4],u[d+4]=t[3],u[d+5]=t[2],u[d+6]=t[1],u[d+7]=t[0]}n.writeDoubleLE=s?r:o,n.writeDoubleBE=s?o:r;function h(a,u){return t[0]=a[u],t[1]=a[u+1],t[2]=a[u+2],t[3]=a[u+3],t[4]=a[u+4],t[5]=a[u+5],t[6]=a[u+6],t[7]=a[u+7],e[0]}function c(a,u){return t[7]=a[u],t[6]=a[u+1],t[5]=a[u+2],t[4]=a[u+3],t[3]=a[u+4],t[2]=a[u+5],t[1]=a[u+6],t[0]=a[u+7],e[0]}n.readDoubleLE=s?h:c,n.readDoubleBE=s?c:h}():function(){function e(s,r,o,h,c,a){var u=h<0?1:0;if(u&&(h=-h),h===0)s(0,c,a+r),s(1/h>0?0:2147483648,c,a+o);else if(isNaN(h))s(0,c,a+r),s(2146959360,c,a+o);else if(h>17976931348623157e292)s(0,c,a+r),s((u<<31|2146435072)>>>0,c,a+o);else{var d;if(h<22250738585072014e-324)d=h/5e-324,s(d>>>0,c,a+r),s((u<<31|d/4294967296)>>>0,c,a+o);else{var p=Math.floor(Math.log(h)/Math.LN2);p===1024&&(p=1023),d=h*Math.pow(2,-p),s(d*4503599627370496>>>0,c,a+r),s((u<<31|p+1023<<20|d*1048576&1048575)>>>0,c,a+o)}}}n.writeDoubleLE=e.bind(null,writeUintLE,0,4),n.writeDoubleBE=e.bind(null,writeUintBE,4,0);function t(s,r,o,h,c){var a=s(h,c+r),u=s(h,c+o),d=(u>>31)*2+1,p=u>>>20&2047,m=4294967296*(u&1048575)+a;return p===2047?m?NaN:d*(1/0):p===0?d*5e-324*m:d*Math.pow(2,p-1075)*(m+4503599627370496)}n.readDoubleLE=t.bind(null,readUintLE,0,4),n.readDoubleBE=t.bind(null,readUintBE,4,0)}(),n}function writeUintLE(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function writeUintBE(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function readUintLE(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function readUintBE(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}var inquire_1=inquire$1;function inquire$1(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}var utf8$2={};(function(n){var e=n;e.length=function(s){for(var r=0,o=0,h=0;h<s.length;++h)o=s.charCodeAt(h),o<128?r+=1:o<2048?r+=2:(o&64512)===55296&&(s.charCodeAt(h+1)&64512)===56320?(++h,r+=4):r+=3;return r},e.read=function(s,r,o){var h=o-r;if(h<1)return"";for(var c=null,a=[],u=0,d;r<o;)d=s[r++],d<128?a[u++]=d:d>191&&d<224?a[u++]=(d&31)<<6|s[r++]&63:d>239&&d<365?(d=((d&7)<<18|(s[r++]&63)<<12|(s[r++]&63)<<6|s[r++]&63)-65536,a[u++]=55296+(d>>10),a[u++]=56320+(d&1023)):a[u++]=(d&15)<<12|(s[r++]&63)<<6|s[r++]&63,u>8191&&((c||(c=[])).push(String.fromCharCode.apply(String,a)),u=0);return c?(u&&c.push(String.fromCharCode.apply(String,a.slice(0,u))),c.join("")):String.fromCharCode.apply(String,a.slice(0,u))},e.write=function(s,r,o){for(var h=o,c,a,u=0;u<s.length;++u)c=s.charCodeAt(u),c<128?r[o++]=c:c<2048?(r[o++]=c>>6|192,r[o++]=c&63|128):(c&64512)===55296&&((a=s.charCodeAt(u+1))&64512)===56320?(c=65536+((c&1023)<<10)+(a&1023),++u,r[o++]=c>>18|240,r[o++]=c>>12&63|128,r[o++]=c>>6&63|128,r[o++]=c&63|128):(r[o++]=c>>12|224,r[o++]=c>>6&63|128,r[o++]=c&63|128);return o-h}})(utf8$2);var pool_1=pool$1;function pool$1(n,e,t){var s=t||8192,r=s>>>1,o=null,h=s;return function(a){if(a<1||a>r)return n(a);h+a>s&&(o=n(s),h=0);var u=e.call(o,h,h+=a);return h&7&&(h=(h|7)+1),u}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=e;var n=requireMinimal();function e(o,h){this.lo=o>>>0,this.hi=h>>>0}var t=e.zero=new e(0,0);t.toNumber=function(){return 0},t.zzEncode=t.zzDecode=function(){return this},t.length=function(){return 1};var s=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(h){if(h===0)return t;var c=h<0;c&&(h=-h);var a=h>>>0,u=(h-a)/4294967296>>>0;return c&&(u=~u>>>0,a=~a>>>0,++a>4294967295&&(a=0,++u>4294967295&&(u=0))),new e(a,u)},e.from=function(h){if(typeof h=="number")return e.fromNumber(h);if(n.isString(h))if(n.Long)h=n.Long.fromString(h);else return e.fromNumber(parseInt(h,10));return h.low||h.high?new e(h.low>>>0,h.high>>>0):t},e.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var c=~this.lo+1>>>0,a=~this.hi>>>0;return c||(a=a+1>>>0),-(c+a*4294967296)}return this.lo+this.hi*4294967296},e.prototype.toLong=function(h){return n.Long?new n.Long(this.lo|0,this.hi|0,Boolean(h)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(h)}};var r=String.prototype.charCodeAt;return e.fromHash=function(h){return h===s?t:new e((r.call(h,0)|r.call(h,1)<<8|r.call(h,2)<<16|r.call(h,3)<<24)>>>0,(r.call(h,4)|r.call(h,5)<<8|r.call(h,6)<<16|r.call(h,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},e.prototype.zzDecode=function(){var h=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},e.prototype.length=function(){var h=this.lo,c=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return a===0?c===0?h<16384?h<128?1:2:h<2097152?3:4:c<16384?c<128?5:6:c<2097152?7:8:a<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(n){var e=n;e.asPromise=aspromise,e.base64=base64$1,e.EventEmitter=eventemitter,e.float=float,e.inquire=inquire_1,e.utf8=utf8$2,e.pool=pool_1,e.LongBits=requireLongbits(),e.isNode=Boolean(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},e.isString=function(o){return typeof o=="string"||o instanceof String},e.isObject=function(o){return o&&typeof o=="object"},e.isset=e.isSet=function(o,h){var c=o[h];return c!=null&&o.hasOwnProperty(h)?typeof c!="object"||(Array.isArray(c)?c.length:Object.keys(c).length)>0:!1},e.Buffer=function(){try{var r=e.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(o){return typeof o=="number"?e.Buffer?e._Buffer_allocUnsafe(o):new e.Array(o):e.Buffer?e._Buffer_from(o):typeof Uint8Array>"u"?o:new Uint8Array(o)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(o){return o?e.LongBits.from(o).toHash():e.LongBits.zeroHash},e.longFromHash=function(o,h){var c=e.LongBits.fromHash(o);return e.Long?e.Long.fromBits(c.lo,c.hi,h):c.toNumber(Boolean(h))};function t(r,o,h){for(var c=Object.keys(o),a=0;a<c.length;++a)(r[c[a]]===void 0||!h)&&(r[c[a]]=o[c[a]]);return r}e.merge=t,e.lcFirst=function(o){return o.charAt(0).toLowerCase()+o.substring(1)};function s(r){function o(h,c){if(!(this instanceof o))return new o(h,c);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),c&&t(this,c)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}e.newError=s,e.ProtocolError=s("ProtocolError"),e.oneOfGetter=function(o){for(var h={},c=0;c<o.length;++c)h[o[c]]=1;return function(){for(var a=Object.keys(this),u=a.length-1;u>-1;--u)if(h[a[u]]===1&&this[a[u]]!==void 0&&this[a[u]]!==null)return a[u]}},e.oneOfSetter=function(o){return function(h){for(var c=0;c<o.length;++c)o[c]!==h&&delete this[o[c]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var r=e.Buffer;if(!r){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=r.from!==Uint8Array.from&&r.from||function(h,c){return new r(h,c)},e._Buffer_allocUnsafe=r.allocUnsafe||function(h){return new r(h)}}}(minimal)),minimal}var writer=Writer$1,util$7=requireMinimal(),BufferWriter$1,LongBits$1=util$7.LongBits,base64=util$7.base64,utf8$1=util$7.utf8;function Op(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function noop(){}function State(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function n(){return util$7.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function n(e){return new util$7.Array(e)};util$7.Array!==Array&&(Writer$1.alloc=util$7.pool(Writer$1.alloc,util$7.Array.prototype.subarray));Writer$1.prototype._push=function n(e,t,s){return this.tail=this.tail.next=new Op(e,t,s),this.len+=t,this};function writeByte(n,e,t){e[t]=n&255}function writeVarint32(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function VarintOp(n,e){this.len=n,this.next=void 0,this.val=e}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function n(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Writer$1.prototype.int32=function n(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)};Writer$1.prototype.sint32=function n(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}Writer$1.prototype.uint64=function n(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function n(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)};Writer$1.prototype.bool=function n(e){return this._push(writeByte,1,e?1:0)};function writeFixed32(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}Writer$1.prototype.fixed32=function n(e){return this._push(writeFixed32,4,e>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function n(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function n(e){return this._push(util$7.float.writeFloatLE,4,e)};Writer$1.prototype.double=function n(e){return this._push(util$7.float.writeDoubleLE,8,e)};var writeBytes=util$7.Array.prototype.set?function n(e,t,s){t.set(e,s)}:function n(e,t,s){for(var r=0;r<e.length;++r)t[s+r]=e[r]};Writer$1.prototype.bytes=function n(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$7.isString(e)){var s=Writer$1.alloc(t=base64.length(e));base64.decode(e,s,0),e=s}return this.uint32(t)._push(writeBytes,t,e)};Writer$1.prototype.string=function n(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)};Writer$1.prototype.fork=function n(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this};Writer$1.prototype.reset=function n(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this};Writer$1.prototype.ldelim=function n(){var e=this.head,t=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=t,this.len+=s),this};Writer$1.prototype.finish=function n(){for(var e=this.head.next,t=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,t,s),s+=e.len,e=e.next;return t};Writer$1._configure=function(n){BufferWriter$1=n,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$6=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$6._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$6.Buffer&&util$6.Buffer.prototype instanceof Uint8Array&&util$6.Buffer.prototype.set.name==="set"?function(e,t,s){t.set(e,s)}:function(e,t,s){if(e.copy)e.copy(t,s,0,e.length);else for(var r=0;r<e.length;)t[s++]=e[r++]}};BufferWriter.prototype.bytes=function n(e){util$6.isString(e)&&(e=util$6._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this};function writeStringBuffer(n,e,t){n.length<40?util$6.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}BufferWriter.prototype.string=function n(e){var t=util$6.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};BufferWriter._configure();var reader=Reader$1,util$5=requireMinimal(),BufferReader$1,LongBits=util$5.LongBits,utf8=util$5.utf8;function indexOutOfRange(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Reader$1(n){this.buf=n,this.pos=0,this.len=n.length}var create_array=typeof Uint8Array<"u"?function n(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function n(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create=function n(){return util$5.Buffer?function(t){return(Reader$1.create=function(r){return util$5.Buffer.isBuffer(r)?new BufferReader$1(r):create_array(r)})(t)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$5.Array.prototype.subarray||util$5.Array.prototype.slice;Reader$1.prototype.uint32=function n(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}}();Reader$1.prototype.int32=function n(){return this.uint32()|0};Reader$1.prototype.sint32=function n(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint(){var n=new LongBits(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function n(){return this.uint32()!==0};function readFixed32_end(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Reader$1.prototype.fixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$5.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Reader$1.prototype.double=function n(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$5.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Reader$1.prototype.bytes=function n(){var e=this.uint32(),t=this.pos,s=this.pos+e;if(s>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,s):t===s?new this.buf.constructor(0):this._slice.call(this.buf,t,s)};Reader$1.prototype.string=function n(){var e=this.bytes();return utf8.read(e,0,e.length)};Reader$1.prototype.skip=function n(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Reader$1._configure=function(n){BufferReader$1=n,Reader$1.create=create(),BufferReader$1._configure();var e=util$5.Long?"toLong":"toNumber";util$5.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[e](!1)},uint64:function(){return readLongVarint.call(this)[e](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64.call(this)[e](!0)},sfixed64:function(){return readFixed64.call(this)[e](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$4=requireMinimal();function BufferReader(n){Reader.call(this,n)}BufferReader._configure=function(){util$4.Buffer&&(BufferReader.prototype._slice=util$4.Buffer.prototype.slice)};BufferReader.prototype.string=function n(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader._configure();var rpc={},service$1=Service$1,util$3=requireMinimal();(Service$1.prototype=Object.create(util$3.EventEmitter.prototype)).constructor=Service$1;function Service$1(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");util$3.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}Service$1.prototype.rpcCall=function n(e,t,s,r,o){if(!r)throw TypeError("request must be specified");var h=this;if(!o)return util$3.asPromise(n,h,e,t,s,r);if(!h.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return h.rpcImpl(e,t[h.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(a,u){if(a)return h.emit("error",a,e),o(a);if(u===null){h.end(!0);return}if(!(u instanceof s))try{u=s[h.responseDelimited?"decodeDelimited":"decode"](u)}catch(d){return h.emit("error",d,e),o(d)}return h.emit("data",u,e),o(null,u)})}catch(c){h.emit("error",c,e),setTimeout(function(){o(c)},0);return}};Service$1.prototype.end=function n(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(n){var e=n;e.Service=service$1})(rpc);var roots={};(function(n){var e=n;e.build="minimal",e.Writer=writer,e.BufferWriter=writer_buffer,e.Reader=reader,e.BufferReader=reader_buffer,e.util=requireMinimal(),e.rpc=rpc,e.roots=roots,e.configure=t;function t(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}t()})(indexMinimal);var utilExports={},util$2={get exports(){return utilExports},set exports(n){utilExports=n}},codegen_1=codegen;function codegen(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function s(o){if(typeof o!="string"){var h=r();if(codegen.verbose&&console.log("codegen: "+h),h="return "+h,o){for(var c=Object.keys(o),a=new Array(c.length+1),u=new Array(c.length),d=0;d<c.length;)a[d]=c[d],u[d]=o[c[d++]];return a[d]=h,Function.apply(null,a).apply(null,u)}return Function(h)()}for(var p=new Array(arguments.length-1),m=0;m<p.length;)p[m]=arguments[++m];if(m=0,o=o.replace(/%([%dfijs])/g,function(_,y){var v=p[m++];switch(y){case"d":case"f":return String(Number(v));case"i":return String(Math.floor(v));case"j":return JSON.stringify(v);case"s":return String(v)}return"%"}),m!==p.length)throw Error("parameter count mismatch");return t.push(o),s}function r(o){return"function "+(o||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return s.toString=r,s}codegen.verbose=!1;var fetch_1=fetch$1,asPromise=aspromise,inquire=inquire_1,fs=inquire("fs");function fetch$1(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&fs&&fs.readFile?fs.readFile(n,function(r,o){return r&&typeof XMLHttpRequest<"u"?fetch$1.xhr(n,e,t):r?t(r):t(null,e.binary?o:o.toString("utf8"))}):fetch$1.xhr(n,e,t):asPromise(fetch$1,this,n,e)}fetch$1.xhr=function n(e,t,s){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return s(Error("status "+r.status));if(t.binary){var h=r.response;if(!h){h=[];for(var c=0;c<r.responseText.length;++c)h.push(r.responseText.charCodeAt(c)&255)}return s(null,typeof Uint8Array<"u"?new Uint8Array(h):h)}return s(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()};var path={};(function(n){var e=n,t=e.isAbsolute=function(o){return/^(?:\/|\w+:)/.test(o)},s=e.normalize=function(o){o=o.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var h=o.split("/"),c=t(o),a="";c&&(a=h.shift()+"/");for(var u=0;u<h.length;)h[u]===".."?u>0&&h[u-1]!==".."?h.splice(--u,2):c?h.splice(u,1):++u:h[u]==="."?h.splice(u,1):++u;return a+h.join("/")};e.resolve=function(o,h,c){return c||(h=s(h)),t(h)?h:(c||(o=s(o)),(o=o.replace(/(?:\/|^)[^/]+$/,"")).length?s(o+"/"+h):h)}})(path);var types$1={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(n){var e=n,t=requireUtil(),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function r(o,h){var c=0,a={};for(h|=0;c<o.length;)a[s[c+h]]=o[c++];return a}e.basic=r([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),e.defaults=r([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",t.emptyArray,null]),e.long=r([0,0,0,1,1],7),e.mapKey=r([0,0,0,5,5,0,0,0,1,1,0,2],2),e.packed=r([1,5,0,0,0,5,5,0,0,0,1,1,0])}(types$1)),types$1}var field,hasRequiredField;function requireField(){if(hasRequiredField)return field;hasRequiredField=1,field=h;var n=requireObject();((h.prototype=Object.create(n.prototype)).constructor=h).className="Field";var e=require_enum(),t=requireTypes(),s=requireUtil(),r,o=/^required|optional|repeated$/;h.fromJSON=function(a,u){return new h(a,u.id,u.type,u.rule,u.extend,u.options,u.comment)};function h(c,a,u,d,p,m,g){if(s.isObject(d)?(g=p,m=d,d=p=void 0):s.isObject(p)&&(g=m,m=p,p=void 0),n.call(this,c,m),!s.isInteger(a)||a<0)throw TypeError("id must be a non-negative integer");if(!s.isString(u))throw TypeError("type must be a string");if(d!==void 0&&!o.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(p!==void 0&&!s.isString(p))throw TypeError("extend must be a string");d==="proto3_optional"&&(d="optional"),this.rule=d&&d!=="optional"?d:void 0,this.type=u,this.id=a,this.extend=p||void 0,this.required=d==="required",this.optional=!this.required,this.repeated=d==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=s.Long?t.long[u]!==void 0:!1,this.bytes=u==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=g}return Object.defineProperty(h.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}}),h.prototype.setOption=function(a,u,d){return a==="packed"&&(this._packed=null),n.prototype.setOption.call(this,a,u,d)},h.prototype.toJSON=function(a){var u=a?Boolean(a.keepComments):!1;return s.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",u?this.comment:void 0])},h.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=t.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof r?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof e&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof e))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var a;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,a=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,a=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof r&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},h.d=function(a,u,d,p){return typeof u=="function"?u=s.decorateType(u).name:u&&typeof u=="object"&&(u=s.decorateEnum(u).name),function(g,_){s.decorateType(g.constructor).add(new h(_,a,u,d,{default:p}))}},h._configure=function(a){r=a},field}var oneof,hasRequiredOneof;function requireOneof(){if(hasRequiredOneof)return oneof;hasRequiredOneof=1,oneof=s;var n=requireObject();((s.prototype=Object.create(n.prototype)).constructor=s).className="OneOf";var e=requireField(),t=requireUtil();function s(o,h,c,a){if(Array.isArray(h)||(c=h,h=void 0),n.call(this,o,c),!(h===void 0||Array.isArray(h)))throw TypeError("fieldNames must be an Array");this.oneof=h||[],this.fieldsArray=[],this.comment=a}s.fromJSON=function(h,c){return new s(h,c.oneof,c.options,c.comment)},s.prototype.toJSON=function(h){var c=h?Boolean(h.keepComments):!1;return t.toObject(["options",this.options,"oneof",this.oneof,"comment",c?this.comment:void 0])};function r(o){if(o.parent)for(var h=0;h<o.fieldsArray.length;++h)o.fieldsArray[h].parent||o.parent.add(o.fieldsArray[h])}return s.prototype.add=function(h){if(!(h instanceof e))throw TypeError("field must be a Field");return h.parent&&h.parent!==this.parent&&h.parent.remove(h),this.oneof.push(h.name),this.fieldsArray.push(h),h.partOf=this,r(this),this},s.prototype.remove=function(h){if(!(h instanceof e))throw TypeError("field must be a Field");var c=this.fieldsArray.indexOf(h);if(c<0)throw Error(h+" is not a member of "+this);return this.fieldsArray.splice(c,1),c=this.oneof.indexOf(h.name),c>-1&&this.oneof.splice(c,1),h.partOf=null,this},s.prototype.onAdd=function(h){n.prototype.onAdd.call(this,h);for(var c=this,a=0;a<this.oneof.length;++a){var u=h.get(this.oneof[a]);u&&!u.partOf&&(u.partOf=c,c.fieldsArray.push(u))}r(this)},s.prototype.onRemove=function(h){for(var c=0,a;c<this.fieldsArray.length;++c)(a=this.fieldsArray[c]).parent&&a.parent.remove(a);n.prototype.onRemove.call(this,h)},s.d=function(){for(var h=new Array(arguments.length),c=0;c<arguments.length;)h[c]=arguments[c++];return function(u,d){t.decorateType(u.constructor).add(new s(d,h)),Object.defineProperty(u,d,{get:t.oneOfGetter(h),set:t.oneOfSetter(h)})}},oneof}var namespace,hasRequiredNamespace;function requireNamespace(){if(hasRequiredNamespace)return namespace;hasRequiredNamespace=1,namespace=a;var n=requireObject();((a.prototype=Object.create(n.prototype)).constructor=a).className="Namespace";var e=requireField(),t=requireUtil(),s=requireOneof(),r,o,h;a.fromJSON=function(p,m){return new a(p,m.options).addJSON(m.nested)};function c(d,p){if(d&&d.length){for(var m={},g=0;g<d.length;++g)m[d[g].name]=d[g].toJSON(p);return m}}a.arrayToJSON=c,a.isReservedId=function(p,m){if(p){for(var g=0;g<p.length;++g)if(typeof p[g]!="string"&&p[g][0]<=m&&p[g][1]>m)return!0}return!1},a.isReservedName=function(p,m){if(p){for(var g=0;g<p.length;++g)if(p[g]===m)return!0}return!1};function a(d,p){n.call(this,d,p),this.nested=void 0,this._nestedArray=null}function u(d){return d._nestedArray=null,d}return Object.defineProperty(a.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=t.toArray(this.nested))}}),a.prototype.toJSON=function(p){return t.toObject(["options",this.options,"nested",c(this.nestedArray,p)])},a.prototype.addJSON=function(p){var m=this;if(p)for(var g=Object.keys(p),_=0,y;_<g.length;++_)y=p[g[_]],m.add((y.fields!==void 0?r.fromJSON:y.values!==void 0?h.fromJSON:y.methods!==void 0?o.fromJSON:y.id!==void 0?e.fromJSON:a.fromJSON)(g[_],y));return this},a.prototype.get=function(p){return this.nested&&this.nested[p]||null},a.prototype.getEnum=function(p){if(this.nested&&this.nested[p]instanceof h)return this.nested[p].values;throw Error("no such enum: "+p)},a.prototype.add=function(p){if(!(p instanceof e&&p.extend!==void 0||p instanceof r||p instanceof s||p instanceof h||p instanceof o||p instanceof a))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var m=this.get(p.name);if(m)if(m instanceof a&&p instanceof a&&!(m instanceof r||m instanceof o)){for(var g=m.nestedArray,_=0;_<g.length;++_)p.add(g[_]);this.remove(m),this.nested||(this.nested={}),p.setOptions(m.options,!0)}else throw Error("duplicate name '"+p.name+"' in "+this)}return this.nested[p.name]=p,p.onAdd(this),u(this)},a.prototype.remove=function(p){if(!(p instanceof n))throw TypeError("object must be a ReflectionObject");if(p.parent!==this)throw Error(p+" is not a member of "+this);return delete this.nested[p.name],Object.keys(this.nested).length||(this.nested=void 0),p.onRemove(this),u(this)},a.prototype.define=function(p,m){if(t.isString(p))p=p.split(".");else if(!Array.isArray(p))throw TypeError("illegal path");if(p&&p.length&&p[0]==="")throw Error("path must be relative");for(var g=this;p.length>0;){var _=p.shift();if(g.nested&&g.nested[_]){if(g=g.nested[_],!(g instanceof a))throw Error("path conflicts with non-namespace objects")}else g.add(g=new a(_))}return m&&g.addJSON(m),g},a.prototype.resolveAll=function(){for(var p=this.nestedArray,m=0;m<p.length;)p[m]instanceof a?p[m++].resolveAll():p[m++].resolve();return this.resolve()},a.prototype.lookup=function(p,m,g){if(typeof m=="boolean"?(g=m,m=void 0):m&&!Array.isArray(m)&&(m=[m]),t.isString(p)&&p.length){if(p===".")return this.root;p=p.split(".")}else if(!p.length)return this;if(p[0]==="")return this.root.lookup(p.slice(1),m);var _=this.get(p[0]);if(_){if(p.length===1){if(!m||m.indexOf(_.constructor)>-1)return _}else if(_ instanceof a&&(_=_.lookup(p.slice(1),m,!0)))return _}else for(var y=0;y<this.nestedArray.length;++y)if(this._nestedArray[y]instanceof a&&(_=this._nestedArray[y].lookup(p,m,!0)))return _;return this.parent===null||g?null:this.parent.lookup(p,m)},a.prototype.lookupType=function(p){var m=this.lookup(p,[r]);if(!m)throw Error("no such type: "+p);return m},a.prototype.lookupEnum=function(p){var m=this.lookup(p,[h]);if(!m)throw Error("no such Enum '"+p+"' in "+this);return m},a.prototype.lookupTypeOrEnum=function(p){var m=this.lookup(p,[r,h]);if(!m)throw Error("no such Type or Enum '"+p+"' in "+this);return m},a.prototype.lookupService=function(p){var m=this.lookup(p,[o]);if(!m)throw Error("no such Service '"+p+"' in "+this);return m},a._configure=function(d,p,m){r=d,o=p,h=m},namespace}var mapfield,hasRequiredMapfield;function requireMapfield(){if(hasRequiredMapfield)return mapfield;hasRequiredMapfield=1,mapfield=s;var n=requireField();((s.prototype=Object.create(n.prototype)).constructor=s).className="MapField";var e=requireTypes(),t=requireUtil();function s(r,o,h,c,a,u){if(n.call(this,r,o,c,void 0,void 0,a,u),!t.isString(h))throw TypeError("keyType must be a string");this.keyType=h,this.resolvedKeyType=null,this.map=!0}return s.fromJSON=function(o,h){return new s(o,h.id,h.keyType,h.type,h.options,h.comment)},s.prototype.toJSON=function(o){var h=o?Boolean(o.keepComments):!1;return t.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",h?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(e.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},s.d=function(o,h,c){return typeof c=="function"?c=t.decorateType(c).name:c&&typeof c=="object"&&(c=t.decorateEnum(c).name),function(u,d){t.decorateType(u.constructor).add(new s(d,o,h,c))}},mapfield}var method,hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return method;hasRequiredMethod=1,method=t;var n=requireObject();((t.prototype=Object.create(n.prototype)).constructor=t).className="Method";var e=requireUtil();function t(s,r,o,h,c,a,u,d,p){if(e.isObject(c)?(u=c,c=a=void 0):e.isObject(a)&&(u=a,a=void 0),!(r===void 0||e.isString(r)))throw TypeError("type must be a string");if(!e.isString(o))throw TypeError("requestType must be a string");if(!e.isString(h))throw TypeError("responseType must be a string");n.call(this,s,u),this.type=r||"rpc",this.requestType=o,this.requestStream=c?!0:void 0,this.responseType=h,this.responseStream=a?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=d,this.parsedOptions=p}return t.fromJSON=function(r,o){return new t(r,o.type,o.requestType,o.responseType,o.requestStream,o.responseStream,o.options,o.comment,o.parsedOptions)},t.prototype.toJSON=function(r){var o=r?Boolean(r.keepComments):!1;return e.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",o?this.comment:void 0,"parsedOptions",this.parsedOptions])},t.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))},method}var service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=r;var n=requireNamespace();((r.prototype=Object.create(n.prototype)).constructor=r).className="Service";var e=requireMethod(),t=requireUtil(),s=rpc;function r(h,c){n.call(this,h,c),this.methods={},this._methodsArray=null}r.fromJSON=function(c,a){var u=new r(c,a.options);if(a.methods)for(var d=Object.keys(a.methods),p=0;p<d.length;++p)u.add(e.fromJSON(d[p],a.methods[d[p]]));return a.nested&&u.addJSON(a.nested),u.comment=a.comment,u},r.prototype.toJSON=function(c){var a=n.prototype.toJSON.call(this,c),u=c?Boolean(c.keepComments):!1;return t.toObject(["options",a&&a.options||void 0,"methods",n.arrayToJSON(this.methodsArray,c)||{},"nested",a&&a.nested||void 0,"comment",u?this.comment:void 0])},Object.defineProperty(r.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=t.toArray(this.methods))}});function o(h){return h._methodsArray=null,h}return r.prototype.get=function(c){return this.methods[c]||n.prototype.get.call(this,c)},r.prototype.resolveAll=function(){for(var c=this.methodsArray,a=0;a<c.length;++a)c[a].resolve();return n.prototype.resolve.call(this)},r.prototype.add=function(c){if(this.get(c.name))throw Error("duplicate name '"+c.name+"' in "+this);return c instanceof e?(this.methods[c.name]=c,c.parent=this,o(this)):n.prototype.add.call(this,c)},r.prototype.remove=function(c){if(c instanceof e){if(this.methods[c.name]!==c)throw Error(c+" is not a member of "+this);return delete this.methods[c.name],c.parent=null,o(this)}return n.prototype.remove.call(this,c)},r.prototype.create=function(c,a,u){for(var d=new s.Service(c,a,u),p=0,m;p<this.methodsArray.length;++p){var g=t.lcFirst((m=this._methodsArray[p]).resolve().name).replace(/[^$\w_]/g,"");d[g]=t.codegen(["r","c"],t.isReserved(g)?g+"_":g)("return this.rpcCall(m,q,s,r,c)")({m,q:m.resolvedRequestType.ctor,s:m.resolvedResponseType.ctor})}return d},service}var message=Message,util$1=requireMinimal();function Message(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}Message.create=function n(e){return this.$type.create(e)};Message.encode=function n(e,t){return this.$type.encode(e,t)};Message.encodeDelimited=function n(e,t){return this.$type.encodeDelimited(e,t)};Message.decode=function n(e){return this.$type.decode(e)};Message.decodeDelimited=function n(e){return this.$type.decodeDelimited(e)};Message.verify=function n(e){return this.$type.verify(e)};Message.fromObject=function n(e){return this.$type.fromObject(e)};Message.toObject=function n(e,t){return this.$type.toObject(e,t)};Message.prototype.toJSON=function n(){return this.$type.toObject(this,util$1.toJSONOptions)};var decoder_1,hasRequiredDecoder;function requireDecoder(){if(hasRequiredDecoder)return decoder_1;hasRequiredDecoder=1,decoder_1=r;var n=require_enum(),e=requireTypes(),t=requireUtil();function s(o){return"missing required '"+o.name+"'"}function r(o){var h=t.codegen(["r","l"],o.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(o.fieldsArray.filter(function(m){return m.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");o.group&&h("if((t&7)===4)")("break"),h("switch(t>>>3){");for(var c=0;c<o.fieldsArray.length;++c){var a=o._fieldsArray[c].resolve(),u=a.resolvedType instanceof n?"int32":a.type,d="m"+t.safeProp(a.name);h("case %i: {",a.id),a.map?(h("if(%s===util.emptyObject)",d)("%s={}",d)("var c2 = r.uint32()+r.pos"),e.defaults[a.keyType]!==void 0?h("k=%j",e.defaults[a.keyType]):h("k=null"),e.defaults[u]!==void 0?h("value=%j",e.defaults[u]):h("value=null"),h("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:"),e.basic[u]===void 0?h("value=types[%i].decode(r,r.uint32())",c):h("value=r.%s()",u),h("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),e.long[a.keyType]!==void 0?h('%s[typeof k==="object"?util.longToHash(k):k]=value',d):h("%s[k]=value",d)):a.repeated?(h("if(!(%s&&%s.length))",d,d)("%s=[]",d),e.packed[u]!==void 0&&h("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",d,u)("}else"),e.basic[u]===void 0?h(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",d,c):h("%s.push(r.%s())",d,u)):e.basic[u]===void 0?h(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",d,c):h("%s=r.%s()",d,u),h("break")("}")}for(h("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<o._fieldsArray.length;++c){var p=o._fieldsArray[c];p.required&&h("if(!m.hasOwnProperty(%j))",p.name)("throw util.ProtocolError(%j,{instance:m})",s(p))}return h("return m")}return decoder_1}var verifier_1,hasRequiredVerifier;function requireVerifier(){if(hasRequiredVerifier)return verifier_1;hasRequiredVerifier=1,verifier_1=o;var n=require_enum(),e=requireUtil();function t(h,c){return h.name+": "+c+(h.repeated&&c!=="array"?"[]":h.map&&c!=="object"?"{k:"+h.keyType+"}":"")+" expected"}function s(h,c,a,u){if(c.resolvedType)if(c.resolvedType instanceof n){h("switch(%s){",u)("default:")("return%j",t(c,"enum value"));for(var d=Object.keys(c.resolvedType.values),p=0;p<d.length;++p)h("case %i:",c.resolvedType.values[d[p]]);h("break")("}")}else h("{")("var e=types[%i].verify(%s);",a,u)("if(e)")("return%j+e",c.name+".")("}");else switch(c.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":h("if(!util.isInteger(%s))",u)("return%j",t(c,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":h("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",u,u,u,u)("return%j",t(c,"integer|Long"));break;case"float":case"double":h('if(typeof %s!=="number")',u)("return%j",t(c,"number"));break;case"bool":h('if(typeof %s!=="boolean")',u)("return%j",t(c,"boolean"));break;case"string":h("if(!util.isString(%s))",u)("return%j",t(c,"string"));break;case"bytes":h('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',u,u,u)("return%j",t(c,"buffer"));break}return h}function r(h,c,a){switch(c.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":h("if(!util.key32Re.test(%s))",a)("return%j",t(c,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":h("if(!util.key64Re.test(%s))",a)("return%j",t(c,"integer|Long key"));break;case"bool":h("if(!util.key2Re.test(%s))",a)("return%j",t(c,"boolean key"));break}return h}function o(h){var c=e.codegen(["m"],h.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),a=h.oneofsArray,u={};a.length&&c("var p={}");for(var d=0;d<h.fieldsArray.length;++d){var p=h._fieldsArray[d].resolve(),m="m"+e.safeProp(p.name);if(p.optional&&c("if(%s!=null&&m.hasOwnProperty(%j)){",m,p.name),p.map)c("if(!util.isObject(%s))",m)("return%j",t(p,"object"))("var k=Object.keys(%s)",m)("for(var i=0;i<k.length;++i){"),r(c,p,"k[i]"),s(c,p,d,m+"[k[i]]")("}");else if(p.repeated)c("if(!Array.isArray(%s))",m)("return%j",t(p,"array"))("for(var i=0;i<%s.length;++i){",m),s(c,p,d,m+"[i]")("}");else{if(p.partOf){var g=e.safeProp(p.partOf.name);u[p.partOf.name]===1&&c("if(p%s===1)",g)("return%j",p.partOf.name+": multiple values"),u[p.partOf.name]=1,c("p%s=1",g)}s(c,p,d,m)}p.optional&&c("}")}return c("return null")}return verifier_1}var converter={},hasRequiredConverter;function requireConverter(){return hasRequiredConverter||(hasRequiredConverter=1,function(n){var e=n,t=require_enum(),s=requireUtil();function r(h,c,a,u){var d=!1;if(c.resolvedType)if(c.resolvedType instanceof t){h("switch(d%s){",u);for(var p=c.resolvedType.values,m=Object.keys(p),g=0;g<m.length;++g)p[m[g]]===c.typeDefault&&!d&&(h("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',u,u,u),c.repeated||h("break"),d=!0),h("case%j:",m[g])("case %i:",p[m[g]])("m%s=%j",u,p[m[g]])("break");h("}")}else h('if(typeof d%s!=="object")',u)("throw TypeError(%j)",c.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",u,a,u);else{var _=!1;switch(c.type){case"double":case"float":h("m%s=Number(d%s)",u,u);break;case"uint32":case"fixed32":h("m%s=d%s>>>0",u,u);break;case"int32":case"sint32":case"sfixed32":h("m%s=d%s|0",u,u);break;case"uint64":_=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":h("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",u,u,_)('else if(typeof d%s==="string")',u)("m%s=parseInt(d%s,10)",u,u)('else if(typeof d%s==="number")',u)("m%s=d%s",u,u)('else if(typeof d%s==="object")',u)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",u,u,u,_?"true":"");break;case"bytes":h('if(typeof d%s==="string")',u)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",u,u,u)("else if(d%s.length >= 0)",u)("m%s=d%s",u,u);break;case"string":h("m%s=String(d%s)",u,u);break;case"bool":h("m%s=Boolean(d%s)",u,u);break}}return h}e.fromObject=function(c){var a=c.fieldsArray,u=s.codegen(["d"],c.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!a.length)return u("return new this.ctor");u("var m=new this.ctor");for(var d=0;d<a.length;++d){var p=a[d].resolve(),m=s.safeProp(p.name);p.map?(u("if(d%s){",m)('if(typeof d%s!=="object")',m)("throw TypeError(%j)",p.fullName+": object expected")("m%s={}",m)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",m),r(u,p,d,m+"[ks[i]]")("}")("}")):p.repeated?(u("if(d%s){",m)("if(!Array.isArray(d%s))",m)("throw TypeError(%j)",p.fullName+": array expected")("m%s=[]",m)("for(var i=0;i<d%s.length;++i){",m),r(u,p,d,m+"[i]")("}")("}")):(p.resolvedType instanceof t||u("if(d%s!=null){",m),r(u,p,d,m),p.resolvedType instanceof t||u("}"))}return u("return m")};function o(h,c,a,u){if(c.resolvedType)c.resolvedType instanceof t?h("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",u,a,u,u,a,u,u):h("d%s=types[%i].toObject(m%s,o)",u,a,u);else{var d=!1;switch(c.type){case"double":case"float":h("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",u,u,u,u);break;case"uint64":d=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":h('if(typeof m%s==="number")',u)("d%s=o.longs===String?String(m%s):m%s",u,u,u)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",u,u,u,u,d?"true":"",u);break;case"bytes":h("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",u,u,u,u,u);break;default:h("d%s=m%s",u,u);break}}return h}e.toObject=function(c){var a=c.fieldsArray.slice().sort(s.compareFieldsById);if(!a.length)return s.codegen()("return {}");for(var u=s.codegen(["m","o"],c.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],p=[],m=[],g=0;g<a.length;++g)a[g].partOf||(a[g].resolve().repeated?d:a[g].map?p:m).push(a[g]);if(d.length){for(u("if(o.arrays||o.defaults){"),g=0;g<d.length;++g)u("d%s=[]",s.safeProp(d[g].name));u("}")}if(p.length){for(u("if(o.objects||o.defaults){"),g=0;g<p.length;++g)u("d%s={}",s.safeProp(p[g].name));u("}")}if(m.length){for(u("if(o.defaults){"),g=0;g<m.length;++g){var _=m[g],y=s.safeProp(_.name);if(_.resolvedType instanceof t)u("d%s=o.enums===String?%j:%j",y,_.resolvedType.valuesById[_.typeDefault],_.typeDefault);else if(_.long)u("if(util.Long){")("var n=new util.Long(%i,%i,%j)",_.typeDefault.low,_.typeDefault.high,_.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",y)("}else")("d%s=o.longs===String?%j:%i",y,_.typeDefault.toString(),_.typeDefault.toNumber());else if(_.bytes){var v="["+Array.prototype.slice.call(_.typeDefault).join(",")+"]";u("if(o.bytes===String)d%s=%j",y,String.fromCharCode.apply(String,_.typeDefault))("else{")("d%s=%s",y,v)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",y,y)("}")}else u("d%s=%j",y,_.typeDefault)}u("}")}var N=!1;for(g=0;g<a.length;++g){var _=a[g],w=c._fieldsArray.indexOf(_),y=s.safeProp(_.name);_.map?(N||(N=!0,u("var ks2")),u("if(m%s&&(ks2=Object.keys(m%s)).length){",y,y)("d%s={}",y)("for(var j=0;j<ks2.length;++j){"),o(u,_,w,y+"[ks2[j]]")("}")):_.repeated?(u("if(m%s&&m%s.length){",y,y)("d%s=[]",y)("for(var j=0;j<m%s.length;++j){",y),o(u,_,w,y+"[j]")("}")):(u("if(m%s!=null&&m.hasOwnProperty(%j)){",y,_.name),o(u,_,w,y),_.partOf&&u("if(o.oneofs)")("d%s=%j",s.safeProp(_.partOf.name),_.name)),u("}")}return u("return d")}}(converter)),converter}var wrappers={};(function(n){var e=n,t=message;e[".google.protobuf.Any"]={fromObject:function(s){if(s&&s["@type"]){var r=s["@type"].substring(s["@type"].lastIndexOf("/")+1),o=this.lookup(r);if(o){var h=s["@type"].charAt(0)==="."?s["@type"].slice(1):s["@type"];return h.indexOf("/")===-1&&(h="/"+h),this.create({type_url:h,value:o.encode(o.fromObject(s)).finish()})}}return this.fromObject(s)},toObject:function(s,r){var o="type.googleapis.com/",h="",c="";if(r&&r.json&&s.type_url&&s.value){c=s.type_url.substring(s.type_url.lastIndexOf("/")+1),h=s.type_url.substring(0,s.type_url.lastIndexOf("/")+1);var a=this.lookup(c);a&&(s=a.decode(s.value))}if(!(s instanceof this.ctor)&&s instanceof t){var u=s.$type.toObject(s,r),d=s.$type.fullName[0]==="."?s.$type.fullName.slice(1):s.$type.fullName;return h===""&&(h=o),c=h+d,u["@type"]=c,u}return this.toObject(s,r)}}})(wrappers);var type,hasRequiredType;function requireType(){if(hasRequiredType)return type;hasRequiredType=1,type=y;var n=requireNamespace();((y.prototype=Object.create(n.prototype)).constructor=y).className="Type";var e=require_enum(),t=requireOneof(),s=requireField(),r=requireMapfield(),o=requireService(),h=message,c=reader,a=writer,u=requireUtil(),d=requireEncoder(),p=requireDecoder(),m=requireVerifier(),g=requireConverter(),_=wrappers;function y(N,w){n.call(this,N,w),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var N=Object.keys(this.fields),w=0;w<N.length;++w){var k=this.fields[N[w]],U=k.id;if(this._fieldsById[U])throw Error("duplicate id "+U+" in "+this);this._fieldsById[U]=k}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=u.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=u.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(N){var w=N.prototype;w instanceof h||((N.prototype=new h).constructor=N,u.merge(N.prototype,w)),N.$type=N.prototype.$type=this,u.merge(N,h,!0),this._ctor=N;for(var k=0;k<this.fieldsArray.length;++k)this._fieldsArray[k].resolve();var U={};for(k=0;k<this.oneofsArray.length;++k)U[this._oneofsArray[k].resolve().name]={get:u.oneOfGetter(this._oneofsArray[k].oneof),set:u.oneOfSetter(this._oneofsArray[k].oneof)};k&&Object.defineProperties(N.prototype,U)}}}),y.generateConstructor=function(w){for(var k=u.codegen(["p"],w.name),U=0,ee;U<w.fieldsArray.length;++U)(ee=w._fieldsArray[U]).map?k("this%s={}",u.safeProp(ee.name)):ee.repeated&&k("this%s=[]",u.safeProp(ee.name));return k("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function v(N){return N._fieldsById=N._fieldsArray=N._oneofsArray=null,delete N.encode,delete N.decode,delete N.verify,N}return y.fromJSON=function(w,k){var U=new y(w,k.options);U.extensions=k.extensions,U.reserved=k.reserved;for(var ee=Object.keys(k.fields),ie=0;ie<ee.length;++ie)U.add((typeof k.fields[ee[ie]].keyType<"u"?r.fromJSON:s.fromJSON)(ee[ie],k.fields[ee[ie]]));if(k.oneofs)for(ee=Object.keys(k.oneofs),ie=0;ie<ee.length;++ie)U.add(t.fromJSON(ee[ie],k.oneofs[ee[ie]]));if(k.nested)for(ee=Object.keys(k.nested),ie=0;ie<ee.length;++ie){var se=k.nested[ee[ie]];U.add((se.id!==void 0?s.fromJSON:se.fields!==void 0?y.fromJSON:se.values!==void 0?e.fromJSON:se.methods!==void 0?o.fromJSON:n.fromJSON)(ee[ie],se))}return k.extensions&&k.extensions.length&&(U.extensions=k.extensions),k.reserved&&k.reserved.length&&(U.reserved=k.reserved),k.group&&(U.group=!0),k.comment&&(U.comment=k.comment),U},y.prototype.toJSON=function(w){var k=n.prototype.toJSON.call(this,w),U=w?Boolean(w.keepComments):!1;return u.toObject(["options",k&&k.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,w),"fields",n.arrayToJSON(this.fieldsArray.filter(function(ee){return!ee.declaringField}),w)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",k&&k.nested||void 0,"comment",U?this.comment:void 0])},y.prototype.resolveAll=function(){for(var w=this.fieldsArray,k=0;k<w.length;)w[k++].resolve();var U=this.oneofsArray;for(k=0;k<U.length;)U[k++].resolve();return n.prototype.resolveAll.call(this)},y.prototype.get=function(w){return this.fields[w]||this.oneofs&&this.oneofs[w]||this.nested&&this.nested[w]||null},y.prototype.add=function(w){if(this.get(w.name))throw Error("duplicate name '"+w.name+"' in "+this);if(w instanceof s&&w.extend===void 0){if(this._fieldsById?this._fieldsById[w.id]:this.fieldsById[w.id])throw Error("duplicate id "+w.id+" in "+this);if(this.isReservedId(w.id))throw Error("id "+w.id+" is reserved in "+this);if(this.isReservedName(w.name))throw Error("name '"+w.name+"' is reserved in "+this);return w.parent&&w.parent.remove(w),this.fields[w.name]=w,w.message=this,w.onAdd(this),v(this)}return w instanceof t?(this.oneofs||(this.oneofs={}),this.oneofs[w.name]=w,w.onAdd(this),v(this)):n.prototype.add.call(this,w)},y.prototype.remove=function(w){if(w instanceof s&&w.extend===void 0){if(!this.fields||this.fields[w.name]!==w)throw Error(w+" is not a member of "+this);return delete this.fields[w.name],w.parent=null,w.onRemove(this),v(this)}if(w instanceof t){if(!this.oneofs||this.oneofs[w.name]!==w)throw Error(w+" is not a member of "+this);return delete this.oneofs[w.name],w.parent=null,w.onRemove(this),v(this)}return n.prototype.remove.call(this,w)},y.prototype.isReservedId=function(w){return n.isReservedId(this.reserved,w)},y.prototype.isReservedName=function(w){return n.isReservedName(this.reserved,w)},y.prototype.create=function(w){return new this.ctor(w)},y.prototype.setup=function(){for(var w=this.fullName,k=[],U=0;U<this.fieldsArray.length;++U)k.push(this._fieldsArray[U].resolve().resolvedType);this.encode=d(this)({Writer:a,types:k,util:u}),this.decode=p(this)({Reader:c,types:k,util:u}),this.verify=m(this)({types:k,util:u}),this.fromObject=g.fromObject(this)({types:k,util:u}),this.toObject=g.toObject(this)({types:k,util:u});var ee=_[w];if(ee){var ie=Object.create(this);ie.fromObject=this.fromObject,this.fromObject=ee.fromObject.bind(ie),ie.toObject=this.toObject,this.toObject=ee.toObject.bind(ie)}return this},y.prototype.encode=function(w,k){return this.setup().encode(w,k)},y.prototype.encodeDelimited=function(w,k){return this.encode(w,k&&k.len?k.fork():k).ldelim()},y.prototype.decode=function(w,k){return this.setup().decode(w,k)},y.prototype.decodeDelimited=function(w){return w instanceof c||(w=c.create(w)),this.decode(w,w.uint32())},y.prototype.verify=function(w){return this.setup().verify(w)},y.prototype.fromObject=function(w){return this.setup().fromObject(w)},y.prototype.toObject=function(w,k){return this.setup().toObject(w,k)},y.d=function(w){return function(U){u.decorateType(U,w)}},type}var root,hasRequiredRoot;function requireRoot(){if(hasRequiredRoot)return root;hasRequiredRoot=1,root=a;var n=requireNamespace();((a.prototype=Object.create(n.prototype)).constructor=a).className="Root";var e=requireField(),t=require_enum(),s=requireOneof(),r=requireUtil(),o,h,c;function a(m){n.call(this,"",m),this.deferred=[],this.files=[]}a.fromJSON=function(g,_){return _||(_=new a),g.options&&_.setOptions(g.options),_.addJSON(g.nested)},a.prototype.resolvePath=r.path.resolve,a.prototype.fetch=r.fetch;function u(){}a.prototype.load=function m(g,_,y){typeof _=="function"&&(y=_,_=void 0);var v=this;if(!y)return r.asPromise(m,v,g,_);var N=y===u;function w(le,ue){if(y){var he=y;if(y=null,N)throw le;he(le,ue)}}function k(le){var ue=le.lastIndexOf("google/protobuf/");if(ue>-1){var he=le.substring(ue);if(he in c)return he}return null}function U(le,ue){try{if(r.isString(ue)&&ue.charAt(0)==="{"&&(ue=JSON.parse(ue)),!r.isString(ue))v.setOptions(ue.options).addJSON(ue.nested);else{h.filename=le;var he=h(ue,v,_),pe,de=0;if(he.imports)for(;de<he.imports.length;++de)(pe=k(he.imports[de])||v.resolvePath(le,he.imports[de]))&&ee(pe);if(he.weakImports)for(de=0;de<he.weakImports.length;++de)(pe=k(he.weakImports[de])||v.resolvePath(le,he.weakImports[de]))&&ee(pe,!0)}}catch(fe){w(fe)}!N&&!ie&&w(null,v)}function ee(le,ue){if(le=k(le)||le,!(v.files.indexOf(le)>-1)){if(v.files.push(le),le in c){N?U(le,c[le]):(++ie,setTimeout(function(){--ie,U(le,c[le])}));return}if(N){var he;try{he=r.fs.readFileSync(le).toString("utf8")}catch(pe){ue||w(pe);return}U(le,he)}else++ie,v.fetch(le,function(pe,de){if(--ie,!!y){if(pe){ue?ie||w(null,v):w(pe);return}U(le,de)}})}}var ie=0;r.isString(g)&&(g=[g]);for(var se=0,oe;se<g.length;++se)(oe=v.resolvePath("",g[se]))&&ee(oe);if(N)return v;ie||w(null,v)},a.prototype.loadSync=function(g,_){if(!r.isNode)throw Error("not supported");return this.load(g,_,u)},a.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(g){return"'extend "+g.extend+"' in "+g.parent.fullName}).join(", "));return n.prototype.resolveAll.call(this)};var d=/^[A-Z]/;function p(m,g){var _=g.parent.lookup(g.extend);if(_){var y=new e(g.fullName,g.id,g.type,g.rule,void 0,g.options);return _.get(y.name)||(y.declaringField=g,g.extensionField=y,_.add(y)),!0}return!1}return a.prototype._handleAdd=function(g){if(g instanceof e)g.extend!==void 0&&!g.extensionField&&(p(this,g)||this.deferred.push(g));else if(g instanceof t)d.test(g.name)&&(g.parent[g.name]=g.values);else if(!(g instanceof s)){if(g instanceof o)for(var _=0;_<this.deferred.length;)p(this,this.deferred[_])?this.deferred.splice(_,1):++_;for(var y=0;y<g.nestedArray.length;++y)this._handleAdd(g._nestedArray[y]);d.test(g.name)&&(g.parent[g.name]=g)}},a.prototype._handleRemove=function(g){if(g instanceof e){if(g.extend!==void 0)if(g.extensionField)g.extensionField.parent.remove(g.extensionField),g.extensionField=null;else{var _=this.deferred.indexOf(g);_>-1&&this.deferred.splice(_,1)}}else if(g instanceof t)d.test(g.name)&&delete g.parent[g.name];else if(g instanceof n){for(var y=0;y<g.nestedArray.length;++y)this._handleRemove(g._nestedArray[y]);d.test(g.name)&&delete g.parent[g.name]}},a._configure=function(m,g,_){o=m,h=g,c=_},root}var hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,function(n){var e=n.exports=requireMinimal(),t=roots,s,r;e.codegen=codegen_1,e.fetch=fetch_1,e.path=path,e.fs=e.inquire("fs"),e.toArray=function(d){if(d){for(var p=Object.keys(d),m=new Array(p.length),g=0;g<p.length;)m[g]=d[p[g++]];return m}return[]},e.toObject=function(d){for(var p={},m=0;m<d.length;){var g=d[m++],_=d[m++];_!==void 0&&(p[g]=_)}return p};var o=/\\/g,h=/"/g;e.isReserved=function(d){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(d)},e.safeProp=function(d){return!/^[$\w_]+$/.test(d)||e.isReserved(d)?'["'+d.replace(o,"\\\\").replace(h,'\\"')+'"]':"."+d},e.ucFirst=function(d){return d.charAt(0).toUpperCase()+d.substring(1)};var c=/_([a-z])/g;e.camelCase=function(d){return d.substring(0,1)+d.substring(1).replace(c,function(p,m){return m.toUpperCase()})},e.compareFieldsById=function(d,p){return d.id-p.id},e.decorateType=function(d,p){if(d.$type)return p&&d.$type.name!==p&&(e.decorateRoot.remove(d.$type),d.$type.name=p,e.decorateRoot.add(d.$type)),d.$type;s||(s=requireType());var m=new s(p||d.name);return e.decorateRoot.add(m),m.ctor=d,Object.defineProperty(d,"$type",{value:m,enumerable:!1}),Object.defineProperty(d.prototype,"$type",{value:m,enumerable:!1}),m};var a=0;e.decorateEnum=function(d){if(d.$type)return d.$type;r||(r=require_enum());var p=new r("Enum"+a++,d);return e.decorateRoot.add(p),Object.defineProperty(d,"$type",{value:p,enumerable:!1}),p},e.setProperty=function(d,p,m){function g(_,y,v){var N=y.shift();if(N==="__proto__")return _;if(y.length>0)_[N]=g(_[N]||{},y,v);else{var w=_[N];w&&(v=[].concat(w).concat(v)),_[N]=v}return _}if(typeof d!="object")throw TypeError("dst must be an object");if(!p)throw TypeError("path must be specified");return p=p.split("."),g(d,p,m)},Object.defineProperty(e,"decorateRoot",{get:function(){return t.decorated||(t.decorated=new(requireRoot()))}})}(util$2)),utilExports}var object,hasRequiredObject;function requireObject(){if(hasRequiredObject)return object;hasRequiredObject=1,object=t,t.className="ReflectionObject";var n=requireUtil(),e;function t(s,r){if(!n.isString(s))throw TypeError("name must be a string");if(r&&!n.isObject(r))throw TypeError("options must be an object");this.options=r,this.parsedOptions=null,this.name=s,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}return Object.defineProperties(t.prototype,{root:{get:function(){for(var s=this;s.parent!==null;)s=s.parent;return s}},fullName:{get:function(){for(var s=[this.name],r=this.parent;r;)s.unshift(r.name),r=r.parent;return s.join(".")}}}),t.prototype.toJSON=function(){throw Error()},t.prototype.onAdd=function(r){this.parent&&this.parent!==r&&this.parent.remove(this),this.parent=r,this.resolved=!1;var o=r.root;o instanceof e&&o._handleAdd(this)},t.prototype.onRemove=function(r){var o=r.root;o instanceof e&&o._handleRemove(this),this.parent=null,this.resolved=!1},t.prototype.resolve=function(){return this.resolved?this:(this.root instanceof e&&(this.resolved=!0),this)},t.prototype.getOption=function(r){if(this.options)return this.options[r]},t.prototype.setOption=function(r,o,h){return(!h||!this.options||this.options[r]===void 0)&&((this.options||(this.options={}))[r]=o),this},t.prototype.setParsedOption=function(r,o,h){this.parsedOptions||(this.parsedOptions=[]);var c=this.parsedOptions;if(h){var a=c.find(function(p){return Object.prototype.hasOwnProperty.call(p,r)});if(a){var u=a[r];n.setProperty(u,h,o)}else a={},a[r]=n.setProperty({},h,o),c.push(a)}else{var d={};d[r]=o,c.push(d)}return this},t.prototype.setOptions=function(r,o){if(r)for(var h=Object.keys(r),c=0;c<h.length;++c)this.setOption(h[c],r[h[c]],o);return this},t.prototype.toString=function(){var r=this.constructor.className,o=this.fullName;return o.length?r+" "+o:r},t._configure=function(s){e=s},object}var _enum,hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,_enum=s;var n=requireObject();((s.prototype=Object.create(n.prototype)).constructor=s).className="Enum";var e=requireNamespace(),t=requireUtil();function s(r,o,h,c,a,u){if(n.call(this,r,h),o&&typeof o!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=c,this.comments=a||{},this.valuesOptions=u,this.reserved=void 0,o)for(var d=Object.keys(o),p=0;p<d.length;++p)typeof o[d[p]]=="number"&&(this.valuesById[this.values[d[p]]=o[d[p]]]=d[p])}return s.fromJSON=function(o,h){var c=new s(o,h.values,h.options,h.comment,h.comments);return c.reserved=h.reserved,c},s.prototype.toJSON=function(o){var h=o?Boolean(o.keepComments):!1;return t.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",h?this.comment:void 0,"comments",h?this.comments:void 0])},s.prototype.add=function(o,h,c,a){if(!t.isString(o))throw TypeError("name must be a string");if(!t.isInteger(h))throw TypeError("id must be an integer");if(this.values[o]!==void 0)throw Error("duplicate name '"+o+"' in "+this);if(this.isReservedId(h))throw Error("id "+h+" is reserved in "+this);if(this.isReservedName(o))throw Error("name '"+o+"' is reserved in "+this);if(this.valuesById[h]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+h+" in "+this);this.values[o]=h}else this.valuesById[this.values[o]=h]=o;return a&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[o]=a||null),this.comments[o]=c||null,this},s.prototype.remove=function(o){if(!t.isString(o))throw TypeError("name must be a string");var h=this.values[o];if(h==null)throw Error("name '"+o+"' does not exist in "+this);return delete this.valuesById[h],delete this.values[o],delete this.comments[o],this.valuesOptions&&delete this.valuesOptions[o],this},s.prototype.isReservedId=function(o){return e.isReservedId(this.reserved,o)},s.prototype.isReservedName=function(o){return e.isReservedName(this.reserved,o)},_enum}var encoder_1,hasRequiredEncoder;function requireEncoder(){if(hasRequiredEncoder)return encoder_1;hasRequiredEncoder=1,encoder_1=r;var n=require_enum(),e=requireTypes(),t=requireUtil();function s(o,h,c,a){return h.resolvedType.group?o("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,a,(h.id<<3|3)>>>0,(h.id<<3|4)>>>0):o("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,a,(h.id<<3|2)>>>0)}function r(o){for(var h=t.codegen(["m","w"],o.name+"$encode")("if(!w)")("w=Writer.create()"),c,a,u=o.fieldsArray.slice().sort(t.compareFieldsById),c=0;c<u.length;++c){var d=u[c].resolve(),p=o._fieldsArray.indexOf(d),m=d.resolvedType instanceof n?"int32":d.type,g=e.basic[m];a="m"+t.safeProp(d.name),d.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",a,d.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",a)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(d.id<<3|2)>>>0,8|e.mapKey[d.keyType],d.keyType),g===void 0?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",p,a):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|g,m,a),h("}")("}")):d.repeated?(h("if(%s!=null&&%s.length){",a,a),d.packed&&e.packed[m]!==void 0?h("w.uint32(%i).fork()",(d.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",a)("w.%s(%s[i])",m,a)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",a),g===void 0?s(h,d,p,a+"[i]"):h("w.uint32(%i).%s(%s[i])",(d.id<<3|g)>>>0,m,a)),h("}")):(d.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",a,d.name),g===void 0?s(h,d,p,a):h("w.uint32(%i).%s(%s)",(d.id<<3|g)>>>0,m,a))}return h("return w")}return encoder_1}(function(n){var e=n.exports=indexMinimal;e.build="light";function t(r,o,h){return typeof o=="function"?(h=o,o=new e.Root):o||(o=new e.Root),o.load(r,h)}e.load=t;function s(r,o){return o||(o=new e.Root),o.loadSync(r)}e.loadSync=s,e.encoder=requireEncoder(),e.decoder=requireDecoder(),e.verifier=requireVerifier(),e.converter=requireConverter(),e.ReflectionObject=requireObject(),e.Namespace=requireNamespace(),e.Root=requireRoot(),e.Enum=require_enum(),e.Type=requireType(),e.Field=requireField(),e.OneOf=requireOneof(),e.MapField=requireMapfield(),e.Service=requireService(),e.Method=requireMethod(),e.Message=message,e.wrappers=wrappers,e.types=requireTypes(),e.util=requireUtil(),e.ReflectionObject._configure(e.Root),e.Namespace._configure(e.Type,e.Service,e.Enum),e.Root._configure(e.Type),e.Field._configure(e.Type)})(indexLight);var tokenize_1=tokenize$1,delimRe=/[\s{}=;:[\],'"()<>]/g,stringDoubleRe=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,stringSingleRe=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,setCommentRe=/^ *[*/]+ */,setCommentAltRe=/^\s*\*?\/*/,setCommentSplitRe=/\n/g,whitespaceRe=/\s/,unescapeRe=/\\(.?)/g,unescapeMap={0:"\0",r:"\r",n:`
`,t:"	"};function unescape$1(n){return n.replace(unescapeRe,function(e,t){switch(t){case"\\":case"":return t;default:return unescapeMap[t]||""}})}tokenize$1.unescape=unescape$1;function tokenize$1(n,e){n=n.toString();var t=0,s=n.length,r=1,o=0,h={},c=[],a=null;function u(U){return Error("illegal "+U+" (line "+r+")")}function d(){var U=a==="'"?stringSingleRe:stringDoubleRe;U.lastIndex=t-1;var ee=U.exec(n);if(!ee)throw u("string");return t=U.lastIndex,v(a),a=null,unescape$1(ee[1])}function p(U){return n.charAt(U)}function m(U,ee,ie){var se={type:n.charAt(U++),lineEmpty:!1,leading:ie},oe;e?oe=2:oe=3;var le=U-oe,ue;do if(--le<0||(ue=n.charAt(le))===`
`){se.lineEmpty=!0;break}while(ue===" "||ue==="	");for(var he=n.substring(U,ee).split(setCommentSplitRe),pe=0;pe<he.length;++pe)he[pe]=he[pe].replace(e?setCommentAltRe:setCommentRe,"").trim();se.text=he.join(`
`).trim(),h[r]=se,o=r}function g(U){var ee=_(U),ie=n.substring(U,ee),se=/^\s*\/{1,2}/.test(ie);return se}function _(U){for(var ee=U;ee<s&&p(ee)!==`
`;)ee++;return ee}function y(){if(c.length>0)return c.shift();if(a)return d();var U,ee,ie,se,oe,le=t===0;do{if(t===s)return null;for(U=!1;whitespaceRe.test(ie=p(t));)if(ie===`
`&&(le=!0,++r),++t===s)return null;if(p(t)==="/"){if(++t===s)throw u("comment");if(p(t)==="/")if(e){if(se=t,oe=!1,g(t)){oe=!0;do if(t=_(t),t===s||(t++,!le))break;while(g(t))}else t=Math.min(s,_(t)+1);oe&&(m(se,t,le),le=!0),r++,U=!0}else{for(oe=p(se=t+1)==="/";p(++t)!==`
`;)if(t===s)return null;++t,oe&&(m(se,t-1,le),le=!0),++r,U=!0}else if((ie=p(t))==="*"){se=t+1,oe=e||p(se)==="*";do{if(ie===`
`&&++r,++t===s)throw u("comment");ee=ie,ie=p(t)}while(ee!=="*"||ie!=="/");++t,oe&&(m(se,t-2,le),le=!0),U=!0}else return"/"}}while(U);var ue=t;delimRe.lastIndex=0;var he=delimRe.test(p(ue++));if(!he)for(;ue<s&&!delimRe.test(p(ue));)++ue;var pe=n.substring(t,t=ue);return(pe==='"'||pe==="'")&&(a=pe),pe}function v(U){c.push(U)}function N(){if(!c.length){var U=y();if(U===null)return null;v(U)}return c[0]}function w(U,ee){var ie=N(),se=ie===U;if(se)return y(),!0;if(!ee)throw u("token '"+ie+"', '"+U+"' expected");return!1}function k(U){var ee=null,ie;return U===void 0?(ie=h[r-1],delete h[r-1],ie&&(e||ie.type==="*"||ie.lineEmpty)&&(ee=ie.leading?ie.text:null)):(o<U&&N(),ie=h[U],delete h[U],ie&&!ie.lineEmpty&&(e||ie.type==="/")&&(ee=ie.leading?null:ie.text)),ee}return Object.defineProperty({next:y,peek:N,push:v,skip:w,cmnt:k},"line",{get:function(){return r}})}var parse_1=parse;parse.filename=null;parse.defaults={keepCase:!1};var tokenize=tokenize_1,Root=requireRoot(),Type=requireType(),Field=requireField(),MapField=requireMapfield(),OneOf=requireOneof(),Enum=require_enum(),Service=requireService(),Method=requireMethod(),types=requireTypes(),util=requireUtil(),base10Re=/^[1-9][0-9]*$/,base10NegRe=/^-?[1-9][0-9]*$/,base16Re=/^0[x][0-9a-fA-F]+$/,base16NegRe=/^-?0[x][0-9a-fA-F]+$/,base8Re=/^0[0-7]+$/,base8NegRe=/^-?0[0-7]+$/,numberRe=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,nameRe=/^[a-zA-Z_][a-zA-Z_0-9]*$/,typeRefRe=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,fqTypeRefRe=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function parse(n,e,t){e instanceof Root||(t=e,e=new Root),t||(t=parse.defaults);var s=t.preferTrailingComment||!1,r=tokenize(n,t.alternateCommentMode||!1),o=r.next,h=r.push,c=r.peek,a=r.skip,u=r.cmnt,d=!0,p,m,g,_,y=!1,v=e,N=t.keepCase?function(_e){return _e}:util.camelCase;function w(_e,ge,ve){var Ee=parse.filename;return ve||(parse.filename=null),Error("illegal "+(ge||"token")+" '"+_e+"' ("+(Ee?Ee+", ":"")+"line "+r.line+")")}function k(){var _e=[],ge;do{if((ge=o())!=='"'&&ge!=="'")throw w(ge);_e.push(o()),a(ge),ge=c()}while(ge==='"'||ge==="'");return _e.join("")}function U(_e){var ge=o();switch(ge){case"'":case'"':return h(ge),k();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return ie(ge,!0)}catch{if(_e&&typeRefRe.test(ge))return ge;throw w(ge,"value")}}function ee(_e,ge){var ve,Ee;do ge&&((ve=c())==='"'||ve==="'")?_e.push(k()):_e.push([Ee=se(o()),a("to",!0)?se(o()):Ee]);while(a(",",!0));a(";")}function ie(_e,ge){var ve=1;switch(_e.charAt(0)==="-"&&(ve=-1,_e=_e.substring(1)),_e){case"inf":case"INF":case"Inf":return ve*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(base10Re.test(_e))return ve*parseInt(_e,10);if(base16Re.test(_e))return ve*parseInt(_e,16);if(base8Re.test(_e))return ve*parseInt(_e,8);if(numberRe.test(_e))return ve*parseFloat(_e);throw w(_e,"number",ge)}function se(_e,ge){switch(_e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!ge&&_e.charAt(0)==="-")throw w(_e,"id");if(base10NegRe.test(_e))return parseInt(_e,10);if(base16NegRe.test(_e))return parseInt(_e,16);if(base8NegRe.test(_e))return parseInt(_e,8);throw w(_e,"id")}function oe(){if(p!==void 0)throw w("package");if(p=o(),!typeRefRe.test(p))throw w(p,"name");v=v.define(p),a(";")}function le(){var _e=c(),ge;switch(_e){case"weak":ge=g||(g=[]),o();break;case"public":o();default:ge=m||(m=[]);break}_e=k(),a(";"),ge.push(_e)}function ue(){if(a("="),_=k(),y=_==="proto3",!y&&_!=="proto2")throw w(_,"syntax");a(";")}function he(_e,ge){switch(ge){case"option":return xe(_e,ge),a(";"),!0;case"message":return de(_e,ge),!0;case"enum":return Ae(_e,ge),!0;case"service":return Fe(_e,ge),!0;case"extend":return Ue(_e,ge),!0}return!1}function pe(_e,ge,ve){var Ee=r.line;if(_e&&(typeof _e.comment!="string"&&(_e.comment=u()),_e.filename=parse.filename),a("{",!0)){for(var we;(we=o())!=="}";)ge(we);a(";",!0)}else ve&&ve(),a(";"),_e&&(typeof _e.comment!="string"||s)&&(_e.comment=u(Ee)||_e.comment)}function de(_e,ge){if(!nameRe.test(ge=o()))throw w(ge,"type name");var ve=new Type(ge);pe(ve,function(we){if(!he(ve,we))switch(we){case"map":Ce(ve);break;case"required":case"repeated":fe(ve,we);break;case"optional":y?fe(ve,"proto3_optional"):fe(ve,"optional");break;case"oneof":be(ve,we);break;case"extensions":ee(ve.extensions||(ve.extensions=[]));break;case"reserved":ee(ve.reserved||(ve.reserved=[]),!0);break;default:if(!y||!typeRefRe.test(we))throw w(we);h(we),fe(ve,"optional");break}}),_e.add(ve)}function fe(_e,ge,ve){var Ee=o();if(Ee==="group"){Te(_e,ge);return}for(;Ee.endsWith(".")||c().startsWith(".");)Ee+=o();if(!typeRefRe.test(Ee))throw w(Ee,"type");var we=o();if(!nameRe.test(we))throw w(we,"name");we=N(we),a("=");var Re=new Field(we,se(o()),Ee,ge,ve);if(pe(Re,function(He){if(He==="option")xe(Re,He),a(";");else throw w(He)},function(){Ie(Re)}),ge==="proto3_optional"){var Le=new OneOf("_"+we);Re.setOption("proto3_optional",!0),Le.add(Re),_e.add(Le)}else _e.add(Re);!y&&Re.repeated&&(types.packed[Ee]!==void 0||types.basic[Ee]===void 0)&&Re.setOption("packed",!1,!0)}function Te(_e,ge){var ve=o();if(!nameRe.test(ve))throw w(ve,"name");var Ee=util.lcFirst(ve);ve===Ee&&(ve=util.ucFirst(ve)),a("=");var we=se(o()),Re=new Type(ve);Re.group=!0;var Le=new Field(Ee,we,ve,ge);Le.filename=parse.filename,pe(Re,function(He){switch(He){case"option":xe(Re,He),a(";");break;case"required":case"repeated":fe(Re,He);break;case"optional":y?fe(Re,"proto3_optional"):fe(Re,"optional");break;case"message":de(Re,He);break;case"enum":Ae(Re,He);break;default:throw w(He)}}),_e.add(Re).add(Le)}function Ce(_e){a("<");var ge=o();if(types.mapKey[ge]===void 0)throw w(ge,"type");a(",");var ve=o();if(!typeRefRe.test(ve))throw w(ve,"type");a(">");var Ee=o();if(!nameRe.test(Ee))throw w(Ee,"name");a("=");var we=new MapField(N(Ee),se(o()),ge,ve);pe(we,function(Le){if(Le==="option")xe(we,Le),a(";");else throw w(Le)},function(){Ie(we)}),_e.add(we)}function be(_e,ge){if(!nameRe.test(ge=o()))throw w(ge,"name");var ve=new OneOf(N(ge));pe(ve,function(we){we==="option"?(xe(ve,we),a(";")):(h(we),fe(ve,"optional"))}),_e.add(ve)}function Ae(_e,ge){if(!nameRe.test(ge=o()))throw w(ge,"name");var ve=new Enum(ge);pe(ve,function(we){switch(we){case"option":xe(ve,we),a(";");break;case"reserved":ee(ve.reserved||(ve.reserved=[]),!0);break;default:Pe(ve,we)}}),_e.add(ve)}function Pe(_e,ge){if(!nameRe.test(ge))throw w(ge,"name");a("=");var ve=se(o(),!0),Ee={options:void 0};Ee.setOption=function(we,Re){this.options===void 0&&(this.options={}),this.options[we]=Re},pe(Ee,function(Re){if(Re==="option")xe(Ee,Re),a(";");else throw w(Re)},function(){Ie(Ee)}),_e.add(ge,ve,Ee.comment,Ee.options)}function xe(_e,ge){var ve=a("(",!0);if(!typeRefRe.test(ge=o()))throw w(ge,"name");var Ee=ge,we=Ee,Re;ve&&(a(")"),Ee="("+Ee+")",we=Ee,ge=c(),fqTypeRefRe.test(ge)&&(Re=ge.slice(1),Ee+=ge,o())),a("=");var Le=Se(_e,Ee);Oe(_e,we,Le,Re)}function Se(_e,ge){if(a("{",!0)){for(var ve={};!a("}",!0);){if(!nameRe.test(Be=o()))throw w(Be,"name");var Ee,we=Be;if(a(":",!0),c()==="{")Ee=Se(_e,ge+"."+Be);else if(c()==="["){Ee=[];var Re;if(a("[",!0)){do Re=U(!0),Ee.push(Re);while(a(",",!0));a("]"),typeof Re<"u"&&Me(_e,ge+"."+Be,Re)}}else Ee=U(!0),Me(_e,ge+"."+Be,Ee);var Le=ve[we];Le&&(Ee=[].concat(Le).concat(Ee)),ve[we]=Ee,a(",",!0),a(";",!0)}return ve}var Xe=U(!0);return Me(_e,ge,Xe),Xe}function Me(_e,ge,ve){_e.setOption&&_e.setOption(ge,ve)}function Oe(_e,ge,ve,Ee){_e.setParsedOption&&_e.setParsedOption(ge,ve,Ee)}function Ie(_e){if(a("[",!0)){do xe(_e,"option");while(a(",",!0));a("]")}return _e}function Fe(_e,ge){if(!nameRe.test(ge=o()))throw w(ge,"service name");var ve=new Service(ge);pe(ve,function(we){if(!he(ve,we))if(we==="rpc")Ne(ve,we);else throw w(we)}),_e.add(ve)}function Ne(_e,ge){var ve=u(),Ee=ge;if(!nameRe.test(ge=o()))throw w(ge,"name");var we=ge,Re,Le,Xe,He;if(a("("),a("stream",!0)&&(Le=!0),!typeRefRe.test(ge=o())||(Re=ge,a(")"),a("returns"),a("("),a("stream",!0)&&(He=!0),!typeRefRe.test(ge=o())))throw w(ge);Xe=ge,a(")");var je=new Method(we,Ee,Re,Xe,Le,He);je.comment=ve,pe(je,function(qe){if(qe==="option")xe(je,qe),a(";");else throw w(qe)}),_e.add(je)}function Ue(_e,ge){if(!typeRefRe.test(ge=o()))throw w(ge,"reference");var ve=ge;pe(null,function(we){switch(we){case"required":case"repeated":fe(_e,we,ve);break;case"optional":y?fe(_e,"proto3_optional",ve):fe(_e,"optional",ve);break;default:if(!y||!typeRefRe.test(we))throw w(we);h(we),fe(_e,"optional",ve);break}})}for(var Be;(Be=o())!==null;)switch(Be){case"package":if(!d)throw w(Be);oe();break;case"import":if(!d)throw w(Be);le();break;case"syntax":if(!d)throw w(Be);ue();break;case"option":xe(v,Be),a(";");break;default:if(he(v,Be)){d=!1;continue}throw w(Be)}return parse.filename=null,{package:p,imports:m,weakImports:g,syntax:_,root:e}}var common_1=common,commonRe=/\/|\./;function common(n,e){commonRe.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),common[n]=e}common("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var timeType;common("duration",{Duration:timeType={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common("timestamp",{Timestamp:timeType});common("empty",{Empty:{fields:{}}});common("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common.get=function n(e){return common[e]||null};(function(n){var e=n.exports=indexLightExports;e.build="full",e.tokenize=tokenize_1,e.parse=parse_1,e.common=common_1,e.Root._configure(e.Type,e.parse,e.common)})(src);(function(n){n.exports=srcExports})(protobufjs);class BackendProto{constructor(){ne(this,"root");protobufjsExports.load("assets/protos/crash_protocol.proto",(e,t)=>{if(e)throw e;this.root=t})}decodeResponseBody(e,t){if(!this.root)throw Error("<BackendProto:decodeResponseBody> root not loaded");const s=this.root.lookupType("crash_protocol.GenericResponse"),r=this.root.lookupType("crash_protocol.ErrorResponse");let o=buffer.Buffer.from(new Uint8Array(e));try{let h=s.decode(o);t(h)}catch{let c=r.decode(o);t(c)}}encodeRequestBody(e,t){if(!this.root)throw Error("<BackendProto:encodeRequestBody> root not loaded");const s=this.root.lookupType("crash_protocol.GenericRequest");let r=s.verify(e);if(r)throw Error(r);let o=s.encode(e).finish();t(o)}}const backendProto=new BackendProto;var BeRqEnum=(n=>(n[n.REQUEST=0]="REQUEST",n[n.PING_PONG=1]="PING_PONG",n[n.CONNECT=2]="CONNECT",n[n.GAME_START=3]="GAME_START",n[n.GAME_LOCK=4]="GAME_LOCK",n[n.GAME_PLAY=5]="GAME_PLAY",n[n.GAME_END=6]="GAME_END",n[n.CASH_OUT=7]="CASH_OUT",n[n.JOIN_GAME=8]="JOIN_GAME",n[n.LEAVE_GAME=9]="LEAVE_GAME",n[n.CONFIRM_JOIN_GAME=10]="CONFIRM_JOIN_GAME",n[n.BACKGROUND_FAN=11]="BACKGROUND_FAN",n))(BeRqEnum||{}),UserStatusEnum=(n=>(n.SPECTING="SPECTING",n.BETTING="BETTING",n.PLAYING="PLAYING",n))(UserStatusEnum||{});const CrashSpeed=6e-5;function getElapsePayout(n){let e=Math.trunc(100*Math.exp(CrashSpeed*n))/100;if(!Number.isFinite(e))throw new Error("Infinite Payout");return Math.max(e,1)}class User{constructor(){ne(this,"userId");ne(this,"budget");ne(this,"status");ne(this,"bonusBudget");ne(this,"username");ne(this,"photoURL");this.userId="",this.status=UserStatusEnum.BETTING,this.budget=0,this.bonusBudget=0,this.username="FromsolversUser123",this.photoURL="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Cute-kittens-12929201-1600-1200.jpg/1024px-Cute-kittens-12929201-1600-1200.jpg"}}const user=new User;class Game{constructor(){ne(this,"status");ne(this,"startAt");ne(this,"gameId");ne(this,"bet");ne(this,"hasWon");ne(this,"multiplier");ne(this,"remoteMultiplier");ne(this,"last");ne(this,"ready");ne(this,"observers",[]);ne(this,"remoteGameEnding",async(e,t,s)=>{this.ready=!0;const r=this.status;this.status=BeRqEnum.GAME_END,this.gameId=e,this.startAt=t,this.multiplier=s,this.notifyGameEnding(this.status!==r)});ne(this,"remoteGameStarting",async(e,t)=>{this.ready=!0;let s=this.status!==BeRqEnum.GAME_START;this.status=BeRqEnum.GAME_START,this.gameId=e,this.startAt=t,s&&(this.hasWon=!1),this.notifyGameStarting(s)});ne(this,"remoteGameLocking",async(e,t)=>{this.ready=!0;const s=this.status;this.status=BeRqEnum.GAME_LOCK,this.gameId=e,this.startAt=t,this.hasWon=!1,this.notifyGameLocking(this.status!==s)});ne(this,"remoteGamePlaying",async(e,t,s)=>{this.ready=!0;const r=this.status;this.status=BeRqEnum.GAME_PLAY,this.gameId=e,this.startAt=t,this.hasWon=!1,this.remoteMultiplier=s,this.flushMultiplier(),this.notifyGamePlaying(this.status!==r)});this.startAt=new Date,this.status=-1,this.gameId="",this.ready=!1,this.hasWon=!1,this.multiplier=1,this.remoteMultiplier=1,this.last=0}update(){if(this.status===BeRqEnum.GAME_PLAY){const t=this.multiplier;this.flushMultiplier(),this.multiplier!=t&&this.notifyGamePlaying(!1)}let e=Date.now()-this.last;this.last=Date.now(),console.log("=====  fps=",app.ticker.FPS,"    dm=",app.ticker.deltaMS,"    dt=",app.ticker.deltaTime,"    delta=",e)}flush(){switch(this.status){case BeRqEnum.GAME_END:{this.notifyGameEnding(!0);break}case BeRqEnum.GAME_LOCK:{this.notifyGameLocking(!0);break}case BeRqEnum.GAME_PLAY:{this.notifyGamePlaying(!0);break}case BeRqEnum.GAME_START:{this.notifyGameStarting(!0);break}}}flushMultiplier(){const e=new Date().getTime()-this.startAt.getTime()-MULTIPLIER_REMOTE_DELAY;e<Number.EPSILON?this.multiplier=1:this.multiplier=getElapsePayout(e),this.multiplier>this.remoteMultiplier&&(this.multiplier=this.remoteMultiplier)}addObserver(e){if(this.observers.includes(e))return console.log("Game: GameObserver has been added already.");this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);if(t===-1)return console.log("Game: Nonexistent observer.");this.observers.splice(t,1)}clear(){this.observers=[],this.status=-1,this.startAt=new Date,this.gameId="",this.ready=!1,this.hasWon=!1,this.multiplier=1,this.remoteMultiplier=1,this.bet=void 0}notifyGameEnding(e){for(const t of this.observers)t.onGameEnding(e)}notifyGameStarting(e){for(const t of this.observers)t.onGameStarting(e)}notifyGameLocking(e){for(const t of this.observers)t.onGameLocking(e)}notifyGamePlaying(e){e&&(user.status=user.status===UserStatusEnum.BETTING?UserStatusEnum.PLAYING:user.status);for(const t of this.observers)t.onGamePlaying(e)}}const game=new Game;function timestampMs(n){return n.seconds*1e3+(n.nanos?n.nanos/1e6:0)}function timestampToDate(n){const e=timestampMs(n);return new Date(e)}function dateToTimestamp(n){let e=n.getTime(),t=e%1e3;return{seconds:Math.floor(e/1e3),nanos:t*1e6}}var rngBrowserExports={},rngBrowser={get exports(){return rngBrowserExports},set exports(n){rngBrowserExports=n}},getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);rngBrowser.exports=function(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);rngBrowser.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),rnds[e]=t>>>((e&3)<<3)&255;return rnds}}var byteToHex=[];for(var i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid$2(n,e){var t=e||0,s=byteToHex;return[s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],"-",s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]],s[n[t++]]].join("")}var bytesToUuid_1=bytesToUuid$2,rng$1=rngBrowserExports,bytesToUuid$1=bytesToUuid_1,_nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1$1(n,e,t){var s=e&&t||0,r=e||[];n=n||{};var o=n.node||_nodeId,h=n.clockseq!==void 0?n.clockseq:_clockseq;if(o==null||h==null){var c=rng$1();o==null&&(o=_nodeId=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),h==null&&(h=_clockseq=(c[6]<<8|c[7])&16383)}var a=n.msecs!==void 0?n.msecs:new Date().getTime(),u=n.nsecs!==void 0?n.nsecs:_lastNSecs+1,d=a-_lastMSecs+(u-_lastNSecs)/1e4;if(d<0&&n.clockseq===void 0&&(h=h+1&16383),(d<0||a>_lastMSecs)&&n.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=a,_lastNSecs=u,_clockseq=h,a+=122192928e5;var p=((a&268435455)*1e4+u)%4294967296;r[s++]=p>>>24&255,r[s++]=p>>>16&255,r[s++]=p>>>8&255,r[s++]=p&255;var m=a/4294967296*1e4&268435455;r[s++]=m>>>8&255,r[s++]=m&255,r[s++]=m>>>24&15|16,r[s++]=m>>>16&255,r[s++]=h>>>8|128,r[s++]=h&255;for(var g=0;g<6;++g)r[s+g]=o[g];return e||bytesToUuid$1(r)}var v1_1=v1$1,rng=rngBrowserExports,bytesToUuid=bytesToUuid_1;function v4$1(n,e,t){var s=e&&t||0;typeof n=="string"&&(e=n==="binary"?new Array(16):null,n=null),n=n||{};var r=n.random||(n.rng||rng)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e)for(var o=0;o<16;++o)e[s+o]=r[o];return e||bytesToUuid(r)}var v4_1=v4$1,v1=v1_1,v4=v4_1,uuid=v4;uuid.v1=v1;uuid.v4=v4;var uuid_1=uuid;class BackendConfigs{constructor(e){ne(this,"betPrecision");ne(this,"multiplierPrecision");ne(this,"percentagePrecision");ne(this,"_minBet");ne(this,"_maxBet");ne(this,"_maxMultiplier");ne(this,"_maxProfit");this.betPrecision=(e==null?void 0:e.betPrecision)||2,this.multiplierPrecision=(e==null?void 0:e.multiplierPrecision)||2,this.percentagePrecision=(e==null?void 0:e.percentagePrecision)||2,this._minBet=(e==null?void 0:e.minBet)||1,this._maxBet=(e==null?void 0:e.maxBet)||1e4,this._maxMultiplier=(e==null?void 0:e.maxMultiplier)||1e4,this._maxProfit=(e==null?void 0:e.maxProfit)||1e7}updateConfig(e){this.betPrecision=e.betPrecision,this.multiplierPrecision=e.multiplierPrecision,this._minBet=e.minBet,this._maxBet=e.maxBet,this._maxMultiplier=e.maxMultiplier,this._maxProfit=e.maxProfit}get minBet(){return this._minBet/10**this.betPrecision}get maxBet(){return this._maxBet/10**this.betPrecision}get minMultiplier(){return 1+1/10**this.multiplierPrecision}get maxMultiplier(){return this._maxMultiplier/10**this.multiplierPrecision}get maxProfit(){return this._maxProfit/10**this.betPrecision}decodeMultiplier(e){return e/10**this.multiplierPrecision}decodeCoins(e){return e/10**this.betPrecision}decodePercentage(e){return e/10**this.percentagePrecision}encodeMultiplier(e){return Math.round(e*10**this.multiplierPrecision)}encodeCoins(e){return Math.round(e*10**this.betPrecision)}encodePercentage(e){return Math.round(e*10**this.percentagePrecision)}}const backendConfigs=new BackendConfigs,AwardData=[{username:"BrangyCastroBrangyBrangy",time:"12/03/2023 - 12:45 pm",bet:4595.2,multiplier:5.53,payout:-40.92,color:"#4201cb"},{username:"Daniel",multiplier:2.43,time:"12/03/2023 - 12:45 pm",bet:4.54,payout:100.9,color:"#303941"},{username:"Antonio",multiplier:2.42,time:"12/03/2023 - 12:45 pm",bet:4.56,payout:0,color:"#303941"},{username:"Hans",multiplier:2.44,time:"12/03/2023 - 12:45 pm",bet:4.52,payout:-100.09,color:"#007cc2"},{username:"Jesus",multiplier:2.45,time:"12/03/2023 - 12:45 pm",bet:4.56,payout:100.09,color:"#7700d4"},{username:"Holw",multiplier:2.46,time:"12/03/2023 - 12:45 pm",bet:4.54,payout:-100.09,color:"#4201cb"},{username:"BrangyC",multiplier:2.47,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#007cc2"},{username:"BrangyC",multiplier:2.48,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:0,color:"#7700d4"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:-100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:100.09,color:"#303941"},{username:"BrangyC",multiplier:2.49,time:"12/03/2023 - 12:45 pm",bet:4.53,payout:-100.09,color:"#303941"}],LeaderboardData=[{username:"BrangyCastroBrangy",multiplier:5.53,bet:100.03,win:400.92,color:"#4201cb"},{username:"Daniel",multiplier:2.43,bet:4.54,win:100.09,color:"#303941"},{username:"Antonio",multiplier:2.42,bet:4.56,win:100.09,color:"#303941"},{username:"Hans",multiplier:2.44,bet:4.52,win:100.09,color:"#007cc2"},{username:"Jesus",multiplier:2.45,bet:4.56,win:100.09,color:"#7700d4"},{username:"Holw",multiplier:2.46,bet:4.54,win:100.09,color:"#4201cb"},{username:"BrangyC",multiplier:2.47,bet:4.53,win:100.09,color:"#007cc2"},{username:"BrangyC",multiplier:2.48,bet:4.53,win:100.09,color:"#7700d4"},{username:"BrangyC",multiplier:2.49,bet:4.53,win:100.09,color:"#303941"}],i18nEN={betButtonText:"Go Bet",cancelButtonText:"Cancel",cashOutButtonText:"Cashout",automaticCurrencyCashingText:"Automatic Payment",automaticMultiplierCashingText:"Automatic Payment",gameOverLabelText:"GAME CRASHED",betClosedLabelText:"BETS CLOSED",youWinLabelText:"YOU WIN",settingsLangTitle:"Language",settingsLangSubtitle:"Adjust language of the game",settingsMusicTitle:"Game music",settingsMusicSubtitle:"Adjust Game music",settingsSoundEffectsTitle:"Game sound effects",settingsSoundEffectsSubtitle:"Adjust Game sound effects",settingsContactSupportTitle:"Contact support",settingsContactSupportSubtitle:"If you have problems with the game",settingsAnimationTitle:"Animation",settingsAnimationSubtitle:"Turn on/off",loadingMessage:"Game Brewing",loadingDoneMessage:"We're Ready",connectionLostMessage:"Connection lost, please wait a few moments",backgroundFanText:"username won",numberOfRounds:"Number of rounds",onWin:"On Win",onLoss:"On Loss",stopOnProfit:"Stop on profit",stopOnLoss:"Stop on loss",startAutoBet:"Start auto bet",decrease:"Decrease",increase:"Increase",automaticGame:"Automatic game",minimum:"Minimum",maximum:"Maximum",warningAutoBet:"It is recommended not to disable auto cash out in case you have an unstable connection.",bonus:"Bonus",bet:"Bet",nextGameLabelText:n=>`Next game in ${Math.ceil(n)}s`,stableConnectionText:n=>`Connection Stable: ${n}ms`,unstableConnectionText:n=>`Connection Untable: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,e)=>`The number of coins in the bet must be between ${n} and ${e}.`,betInvalidAmountOfAutoMultiplierMessage:(n,e)=>`The auto cash multiplier must be between ${n} and ${e}`,betInvalidAmountOfAutoProfitMessage:n=>`The auto cash profit must be between the number of coins in the bet and ${n}`,betInvalidOnWinInputMessage:"Invalid on Win Percentaje",betInvalidOnLossInputMessage:"Invalid on Loss Percentaje"},i18nES={betButtonText:"Apostar",cancelButtonText:"Cancelar",cashOutButtonText:"Cobrar",automaticCurrencyCashingText:"Cobro automtico",automaticMultiplierCashingText:"Cobro automtico",gameOverLabelText:"FIN DEL JUEGO",betClosedLabelText:"APUESTAS CERRADAS",youWinLabelText:"GANASTE",settingsLangTitle:"Idioma",settingsLangSubtitle:"Seleccione el idioma para el juego",settingsMusicTitle:"Msica",settingsMusicSubtitle:"Ajustar la Msica del juego",settingsSoundEffectsTitle:"Efectos de Sonido",settingsSoundEffectsSubtitle:"Ajustar los Efectos de Sonido del juego",settingsContactSupportTitle:"Atencin al Cliente",settingsContactSupportSubtitle:"problemas con el juego?",settingsAnimationTitle:"Animaciones",settingsAnimationSubtitle:"Habilitar/Deshabilitar",loadingMessage:"Preparando el juego",loadingDoneMessage:"Estamos Listos",connectionLostMessage:"Conexin perdida, por favor espere unos momentos",backgroundFanText:"usuario gan",numberOfRounds:"Nmero de rondas",onWin:"Al Ganar",onLoss:"Al Perder",stopOnProfit:"Parada en beneficio",stopOnLoss:"Parada por prdida",startAutoBet:"Iniciar apuesta automtica",decrease:"Disminuir",increase:"Aumentar",automaticGame:"Juego automtico",minimum:"Mnimo",maximum:"Mximo",warningAutoBet:"Se recomienda no desactivar el retiro automtico en caso de que tenga una conexin inestable.",bonus:"Bono",bet:"Apuesta",nextGameLabelText:n=>`Nuevo juego en ${Math.ceil(n)}s`,stableConnectionText:n=>`Conexin estable: ${n}ms`,unstableConnectionText:n=>`Conexin inestable: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,e)=>`El nmero de monedas en la apuesta debe estar entre ${n} y ${e}`,betInvalidAmountOfAutoMultiplierMessage:(n,e)=>`El multiplicador de cobro automtico debe estar entre ${n} y ${e}`,betInvalidAmountOfAutoProfitMessage:n=>`El multiplicador de cobro automtico debe estar entre el nmero de monedas de la apuesta y ${n}`,betInvalidOnWinInputMessage:"Invalido Porcentaje seleccionado al ganar",betInvalidOnLossInputMessage:"Invalido Porcentaje seleccionado al perder"},i18nPT={betButtonText:"Apostar",cancelButtonText:"Cancelar",cashOutButtonText:"Sacar",automaticCurrencyCashingText:"Pagamento automtico",automaticMultiplierCashingText:"Pagamento automtico",gameOverLabelText:"FIM DO JOGO",betClosedLabelText:"APOSTAS FECHADAS",youWinLabelText:"GANHO",settingsLangTitle:"Idioma",settingsLangSubtitle:"Selecione o idioma para o jogo",settingsMusicTitle:"Msica",settingsMusicSubtitle:"Ajustar msica do jogo",settingsSoundEffectsTitle:"Efeitos sonoros",settingsSoundEffectsSubtitle:"Ajustar efeitos sonoros do jogo",settingsContactSupportTitle:"Suporte ao cliente",settingsContactSupportSubtitle:"Problemas com o jogo?",settingsAnimationTitle:"Animaes",settingsAnimationSubtitle:"Habilitar/Desabilitar",loadingMessage:"Preparando o jogo",loadingDoneMessage:"Estamos prontos",connectionLostMessage:"Conexo perdida, aguarde alguns instantes",backgroundFanText:"usurio ganhou",numberOfRounds:"Nmero de rodadas",onWin:"Sobre a vitria",onLoss:"Sobre a perda",stopOnProfit:"Parada por lucro",stopOnLoss:"Parada em caso de perda",startAutoBet:"Iniciar aposta automtica",decrease:"Diminuir",increase:"Aumento",automaticGame:"Jogo automtico",minimum:"Mnimo",maximum:"Mximo",warningAutoBet:"Recomenda-se no desabilitar o saque automtico caso voc tenha uma conexo instvel.",bonus:"Bnus",bet:"Aposta",nextGameLabelText:n=>`Novo jogo em ${Math.ceil(n)}s`,stableConnectionText:n=>`Conexo estvel: ${n}ms`,unstableConnectionText:n=>`Conexo instvel: ${n}ms`,betInvalidAmountOfCoinsMessage:(n,e)=>`O nmero de moedas na aposta deve estar entre ${n} e ${e}.`,betInvalidAmountOfAutoMultiplierMessage:(n,e)=>`O multiplicador automtico de dinheiro deve estar entre ${n} e ${e}.`,betInvalidAmountOfAutoProfitMessage:n=>`O lucro em dinheiro automtico deve estar entre o nmero de moedas na aposta e ${n}`,betInvalidOnWinInputMessage:"Invalid on Win Percentaje",betInvalidOnLossInputMessage:"Invalid on Loss Percentaje"};var Language=(n=>(n.ES="es",n.EN="en",n.PT="pt",n))(Language||{});let i18nMessage={[Language.EN.toString()]:i18nEN,[Language.ES.toString()]:i18nES,[Language.PT.toString()]:i18nPT};class I18n{constructor(e){ne(this,"_language");ne(this,"_translatedText");ne(this,"callback");this._language=e||Language.PT,this._translatedText=i18nMessage[this._language]}get language(){return this._language}set language(e){this._language!==e&&(this._language=e,this._translatedText=i18nMessage[this._language],this.callback&&this.callback(this._translatedText))}get translatedText(){return this._translatedText}}const i18n=new I18n,requestAdapter=n=>{switch(n.method){case BeRqEnum.JOIN_GAME:return n.joinParams.bet=backendConfigs.encodeCoins(n.joinParams.bet),n.joinParams.autoMultiplier&&(n.joinParams.autoMultiplier=backendConfigs.encodeMultiplier(n.joinParams.autoMultiplier)),n.joinParams.autoProfit&&(n.joinParams.autoProfit=backendConfigs.encodeCoins(n.joinParams.autoProfit)),n.joinParams.betOnWin&&(n.joinParams.betOnWin=backendConfigs.encodePercentage(n.joinParams.betOnWin),n.joinParams.betOnWin===0&&(n.joinParams.betOnWin=null)),n.joinParams.betOnLoss&&(n.joinParams.betOnLoss=backendConfigs.encodePercentage(n.joinParams.betOnLoss),n.joinParams.betOnLoss===0&&(n.joinParams.betOnLoss=null)),n.joinParams.stopOnProfit&&(n.joinParams.stopOnProfit=backendConfigs.encodeCoins(n.joinParams.stopOnProfit),n.joinParams.stopOnProfit===0&&(n.joinParams.stopOnProfit=null)),n.joinParams.stopOnLoss&&(n.joinParams.stopOnLoss=backendConfigs.encodeCoins(n.joinParams.stopOnLoss),n.joinParams.stopOnLoss===0&&(n.joinParams.stopOnLoss=null)),n;default:return n}};function playerInfoRespAdapter(n){return n.budget=backendConfigs.decodeCoins(n.budget),n.bonusBudget=backendConfigs.decodeCoins(n.bonusBudget),n.betInfo&&(n.betInfo.amount=backendConfigs.decodeCoins(n.betInfo.amount),n.betInfo.autoMultiplier&&(n.betInfo.autoMultiplier=backendConfigs.decodeMultiplier(n.betInfo.autoMultiplier)),n.betInfo.autoProfit&&(n.betInfo.autoProfit=backendConfigs.decodeCoins(n.betInfo.autoProfit)),n.betInfo.stopOnProfit&&(n.betInfo.stopOnProfit=backendConfigs.decodeCoins(n.betInfo.stopOnProfit)),n.betInfo.stopOnLoss&&(n.betInfo.stopOnLoss=backendConfigs.decodeCoins(n.betInfo.stopOnLoss)),n.betInfo.betOnWin&&(n.betInfo.betOnWin=backendConfigs.decodePercentage(n.betInfo.betOnWin)),n.betInfo.betOnLoss&&(n.betInfo.betOnLoss=backendConfigs.decodePercentage(n.betInfo.betOnLoss))),n}const responseAdapter=n=>{if("error"in n)return n;switch(n.method){case BeRqEnum.CONNECT:return backendConfigs.updateConfig(n.connectResponse.configs),n.connectResponse.playerInfo=playerInfoRespAdapter(n.connectResponse.playerInfo),n;case BeRqEnum.GAME_START:return n.gameStartResponse.lastMultipliers=n.gameStartResponse.lastMultipliers.map(e=>backendConfigs.decodeMultiplier(e)),n;case BeRqEnum.GAME_LOCK:return n.gameLockResponse.lastMultipliers=n.gameLockResponse.lastMultipliers.map(e=>backendConfigs.decodeMultiplier(e)),n;case BeRqEnum.GAME_PLAY:return n.gamePlayResponse.lastMultipliers=n.gamePlayResponse.lastMultipliers.map(e=>backendConfigs.decodeMultiplier(e)),n.gamePlayResponse.multiplier=backendConfigs.decodeMultiplier(n.gamePlayResponse.multiplier),n;case BeRqEnum.GAME_END:return n.gameEndResponse.lastMultipliers=n.gameEndResponse.lastMultipliers.map(e=>backendConfigs.decodeMultiplier(e)),n.gameEndResponse.crashMultiplier=backendConfigs.decodeMultiplier(n.gameEndResponse.crashMultiplier),n;case BeRqEnum.CASH_OUT:return n.cashOutResponse.cashOutMultiplier=backendConfigs.decodeMultiplier(n.cashOutResponse.cashOutMultiplier),n.cashOutResponse.profit=backendConfigs.decodeCoins(n.cashOutResponse.profit),n.cashOutResponse.playerInfo=playerInfoRespAdapter(n.cashOutResponse.playerInfo),n;case BeRqEnum.JOIN_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;case BeRqEnum.LEAVE_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;case BeRqEnum.BACKGROUND_FAN:return n.backgroundFanResponse.cashOutMultiplier=backendConfigs.decodeMultiplier(n.backgroundFanResponse.cashOutMultiplier),n.backgroundFanResponse.profit=backendConfigs.decodeCoins(n.backgroundFanResponse.profit),n;case BeRqEnum.CONFIRM_JOIN_GAME:return n.playerInfoResponse=playerInfoRespAdapter(n.playerInfoResponse),n;default:return n}};function updateUserAndGame(n){user.userId=n.id,user.budget=n.budget,user.status=n.state,user.bonusBudget=n.bonusBudget,n.betInfo?game.bet={coins:n.betInfo.amount,autoMultiplier:n.betInfo.autoMultiplier||void 0,autoProfit:n.betInfo.autoProfit||void 0,auto:"autoRounds"in n.betInfo&&n.betInfo.autoRounds!==null?{autoRounds:n.betInfo.autoRounds||0,betOnWin:n.betInfo.betOnWin||0,betOnLoss:n.betInfo.betOnLoss||0,stopOnProfit:n.betInfo.stopOnProfit||0,stopOnLoss:n.betInfo.stopOnLoss||0}:void 0}:game.bet=void 0}class BackendService{constructor(){ne(this,"client");ne(this,"requestQueue");ne(this,"sentLatencyStatus");ne(this,"callbackPreviousMultipliers");ne(this,"callbackAutomaticCashOut");ne(this,"callbackBackgroundFan");ne(this,"dataAll");ne(this,"dataLeaderboard");this.requestQueue={},this.sentLatencyStatus=e=>{},this.callbackPreviousMultipliers=e=>{},this.dataAll=AwardData,this.dataLeaderboard=LeaderboardData}startConnection(e){return new Promise((t,s)=>{const r=new browser.w3cwebsocket(BACKEND_URL);r.binaryType="arraybuffer",this.client=r,r.onopen=()=>{console.log("Connection established..")},r.onerror=o=>{console.error("Socket encountered error: ",o,"Closing socket"),r.close()},r.onclose=o=>{console.log("Socket is closed.",o.reason),game.clear(),this.requestQueue={},this.sentLatencyStatus=h=>{},this.callbackPreviousMultipliers=h=>{},e()},r.onmessage=o=>{let h=typeof o.data=="string"?buffer.Buffer.from(o.data):o.data;backendProto.decodeResponseBody(h,c=>{switch(c=responseAdapter(c),c.method){case BeRqEnum.BACKGROUND_FAN:if("error"in c){console.error(c);return}const a=c.backgroundFanResponse;this.callbackBackgroundFan&&a.gameId===game.gameId&&this.callbackBackgroundFan(a.profit,a.cashOutMultiplier);break;case BeRqEnum.PING_PONG:{if("error"in c){console.error(c.error);return}this.pingPong(c);break}case BeRqEnum.CONNECT:{"error"in c?s(c.error):(console.log("New connection succesfully done",c),updateUserAndGame(c.connectResponse.playerInfo),t(user.userId));break}case BeRqEnum.REQUEST:break;case BeRqEnum.GAME_END:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameEndResponse.lastMultipliers,!1);let u=timestampToDate(c.gameEndResponse.nextStateTime);game.remoteGameEnding(c.gameEndResponse.gameId,u,c.gameEndResponse.crashMultiplier);break}case BeRqEnum.GAME_LOCK:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameLockResponse.lastMultipliers,!1);let u=timestampToDate(c.gameLockResponse.nextStateTime);game.remoteGameLocking(c.gameLockResponse.gameId,u);break}case BeRqEnum.GAME_PLAY:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gamePlayResponse.lastMultipliers,!0);let u=timestampToDate(c.gamePlayResponse.startTime);game.remoteGamePlaying(c.gamePlayResponse.gameId,u,c.gamePlayResponse.multiplier);break}case BeRqEnum.GAME_START:{if("error"in c){console.error(c.error);return}this.callbackPreviousMultipliers(c.gameStartResponse.lastMultipliers,!1);let u=timestampToDate(c.gameStartResponse.nextStateTime);game.remoteGameStarting(c.gameStartResponse.gameId,u);break}default:{if(c.transactionId in this.requestQueue){const{callback:u,payload:d}=this.requestQueue[c.transactionId];delete this.requestQueue[c.transactionId],c.method===d.method&&u(c)}else this.callbackAutomaticCashOut&&c.method===BeRqEnum.CASH_OUT&&("error"in c?console.log(c.error):(updateUserAndGame(c.cashOutResponse.playerInfo),this.callbackAutomaticCashOut(c.cashOutResponse.profit)));break}}})}})}sendMessage(e){e=requestAdapter(e),backendProto.encodeRequestBody(e,t=>{this.client&&this.client.send(t.buffer.slice(t.byteOffset,t.byteOffset+t.length))})}pingPong(e){let t=e.pingPongMessage;t.lastClientTime&&(t.previousClientTime=t.lastClientTime),t.lastClientTime=dateToTimestamp(new Date);const s=timestampMs(t.lastServerTime)-timestampMs(t.previousServerTime)-t.pingPongDeltaMs,r=timestampMs(t.lastClientTime)-timestampMs(t.previousClientTime||t.lastClientTime)-t.pingPongDeltaMs,o=(s+r)/2,h=Math.round(o/2);this.sentLatencyStatus(h);let c={method:BeRqEnum.PING_PONG,transactionId:uuid_1.v4(),pingPongMessage:t};this.sendMessage(c)}bet(e,t,s,r){return new Promise((o,h)=>{let c=i18n.translatedText,a=[];(e<backendConfigs.minBet||e>backendConfigs.maxBet)&&a.push({message:c.betInvalidAmountOfCoinsMessage,args:[backendConfigs.minBet,backendConfigs.maxBet]}),t&&(t<backendConfigs.minMultiplier||t>backendConfigs.maxMultiplier)&&a.push({message:c.betInvalidAmountOfAutoMultiplierMessage,args:[backendConfigs.minMultiplier,backendConfigs.maxMultiplier]}),s&&(s<e*backendConfigs.minMultiplier||s>backendConfigs.maxProfit)&&a.push({message:c.betInvalidAmountOfAutoProfitMessage,args:[backendConfigs.maxProfit]}),r&&(r.betOnWin<-100&&a.push({message:c.betInvalidOnWinInputMessage}),r.betOnLoss<-100&&a.push({message:c.betInvalidOnLossInputMessage})),a.length>0&&h({validationErrors:a});let u={method:BeRqEnum.JOIN_GAME,transactionId:uuid_1.v4(),joinParams:{bet:e,autoMultiplier:t||null,autoProfit:s||null,autoRounds:(r==null?void 0:r.autoRounds)||null,betOnWin:(r==null?void 0:r.betOnWin)||null,betOnLoss:(r==null?void 0:r.betOnLoss)||null,stopOnProfit:(r==null?void 0:r.stopOnProfit)||null,stopOnLoss:(r==null?void 0:r.stopOnLoss)||null}};this.requestQueue[u.transactionId]={callback:d=>{var p;"error"in d?h({serverError:d.error}):(updateUserAndGame(d.playerInfoResponse),console.assert(((p=game.bet)==null?void 0:p.coins)===e),o({coins:e}))},payload:u},this.sendMessage(u)})}cancelBet(){return new Promise((e,t)=>{let s={method:BeRqEnum.LEAVE_GAME,transactionId:uuid_1.v4(),emptyParams:{}};this.sendMessage(s),this.requestQueue[s.transactionId]={callback:r=>{"error"in r?t(r.error):(updateUserAndGame(r.playerInfoResponse),console.assert(typeof game.bet>"u"),e(r.playerInfoResponse.budget))},payload:s}})}cashOut(){return new Promise((e,t)=>{let s={method:BeRqEnum.CASH_OUT,transactionId:uuid_1.v4(),emptyParams:{}};this.sendMessage(s),this.requestQueue[s.transactionId]={callback:r=>{var o;"error"in r?t(r.error):(updateUserAndGame(r.cashOutResponse.playerInfo),game.hasWon=!0,e({cashOutMultiplier:r.cashOutResponse.cashOutMultiplier,bet:((o=r.cashOutResponse.playerInfo.betInfo)==null?void 0:o.amount)||0,profit:r.cashOutResponse.profit,budget:r.cashOutResponse.playerInfo.budget}))},payload:s}})}}const backendService=new BackendService;class TableAll extends HTMLElement{constructor(){super();ne(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);ne(this,"data");this.data=backendService.dataAll;const t=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const o=document.createElement("div");o.classList.add("table-body"),s.append(r,o),t.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,t.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let t="";this.data.forEach(o=>{let h=`
                <div class="body-item">
                    <div>${o.username}</div>
                    <div>${o.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${o.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${o.color}" >
                            x${o.multiplier}
                        </div>
                    </div>
                    <div>
                        ${o.payout>0?'<label style="color: #1AA655">+ $</label>':o.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(o.payout).toFixed(2)}
                    </div>
                </div>
            `;t+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=t}renderHeader(){var r;let t="";this.cols.forEach(o=>{t+=`<div class="header-item">${o}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=t}}customElements.define("table-all",TableAll);class TableHighWins extends HTMLElement{constructor(){super();ne(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);ne(this,"data");this.data=backendService.dataAll;const t=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const o=document.createElement("div");o.classList.add("table-body"),s.append(r,o),t.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,t.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let t="";this.data.forEach(o=>{let h=`
                <div class="body-item">
                    <div>${o.username}</div>
                    <div>${o.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${o.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${o.color}" >
                            x${o.multiplier}
                        </div>
                    </div>
                    <div>
                        ${o.payout>0?'<label style="color: #1AA655">+ $</label>':o.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(o.payout).toFixed(2)}
                    </div>
                </div>
            `;t+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=t}renderHeader(){var r;let t="";this.cols.forEach(o=>{t+=`<div class="header-item">${o}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=t}}customElements.define("table-high-wins",TableHighWins);class TableLuckyWins extends HTMLElement{constructor(){super();ne(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);ne(this,"data");this.data=backendService.dataAll;const t=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const o=document.createElement("div");o.classList.add("table-body"),s.append(r,o),t.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,t.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let t="";this.data.forEach(o=>{let h=`
                <div class="body-item">
                    <div>${o.username}</div>
                    <div>${o.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${o.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${o.color}" >
                            x${o.multiplier}
                        </div>
                    </div>
                    <div>
                        ${o.payout>0?'<label style="color: #1AA655">+ $</label>':o.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(o.payout).toFixed(2)}
                    </div>
                </div>
            `;t+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=t}renderHeader(){var r;let t="";this.cols.forEach(o=>{t+=`<div class="header-item">${o}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=t}}customElements.define("table-lucky-wins",TableLuckyWins);class TableMyWagers extends HTMLElement{constructor(){super();ne(this,"cols",["Username","Time","Bet","Multiplier","Payout"]);ne(this,"data");this.data=backendService.dataAll;const t=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const o=document.createElement("div");o.classList.add("table-body"),s.append(r,o),t.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.4rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
            }
            .badge-multi {
                border-radius: 16px;
                padding: 12px;
                width: 40px;
                margin: auto;
            }
        `,t.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let t="";this.data.forEach(o=>{let h=`
                <div class="body-item">
                    <div>${o.username}</div>
                    <div>${o.time}</div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${o.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${o.color}" >
                            x${o.multiplier}
                        </div>
                    </div>
                    <div>
                        ${o.payout>0?'<label style="color: #1AA655">+ $</label>':o.payout<0?'<label style="color: #FF0000">- $</label>':"<label>$</label>"}
                        ${Math.abs(o.payout).toFixed(2)}
                    </div>
                </div>
            `;t+=h});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=t}renderHeader(){var r;let t="";this.cols.forEach(o=>{t+=`<div class="header-item">${o}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=t}}customElements.define("table-my-wagers",TableMyWagers);class ModalAward extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const e=`
        <style>
            tab-panel[id='tabs-award'] {
                --tabs-gap: 10px;
                --tab-width: 200rem;
                --tab-padding: 2rem 1rem;
                --tabs-height: 30.5rem;
                --tab-border-border-bottom: 1px solid #168c48;
            }

            pop-up[id='modal-award'] {
                --pop-up-dialog-margin: auto;
                --pop-up-dialog-background-color: #000;
                --pop-up-dialog-border-radius: 24px;
                --pop-up-dialog-width: 90rem;
                --pop-up-dialog-height: 70rem;
                --pop-up-contents-height: 55rem;
                --pop-up-close-line-top: 40px;
                --pop-up-close-line-right: 40px;
                --pop-up-close-box-shadow: none;
                --pop-up-close-font-size: 30px;
            }
            @media screen and (max-width: 390px) {
                pop-up[id='modal-award'] {
                    --pop-up-dialog-width: 40rem;
                }    
            }
            @media (min-width: 391px) and (max-width: 730px) {
                pop-up[id='modal-award'] {
                    --pop-up-dialog-width: 50rem;
                }    
            }
        </style>    
        `;this.innerHTML=`
            ${e}
          <pop-up static="true" id="modal-award">
            <div class="flex" slot="modal">   
                <h1>Detalle</h1>
                <tab-panel id="tabs-award">
                    <div class="item" slot="tab">
                        All
                    </div>
                    <div slot="content">
                        <table-all></table-all>
                    </div>
                    <div class="item" slot="tab">
                        High Wins
                    </div>
                    <div slot="content">
                        <table-high-wins></table-high-wins>
                    </div>
                    <div class="item" slot="tab">
                        Lucky Wins
                    </div>
                    <div slot="content">
                        <table-lucky-wins></table-lucky-wins>
                    </div>
                    <div class="item" slot="tab">
                        My Wagers
                    </div>
                    <div slot="content">
                        <table-my-wagers></table-my-wagers>
                    </div>
                </tab-panel>
            </div>
          </pop-up>
    `}}customElements.define("modal-award",ModalAward);function truncateString(n,e){if(n.length<=e)return{origin:n,truncate:n};const t=n.substring(0,e);return{origin:n,truncate:`${t}...`}}class TableLeaderboard extends HTMLElement{constructor(){super();ne(this,"cols",["Username","Bet","Multiplier","Win"]);ne(this,"data");this.data=backendService.dataLeaderboard;const t=this.attachShadow({mode:"open"}),s=document.createElement("div");s.classList.add("table-container");const r=document.createElement("div");r.classList.add("table-header");const o=document.createElement("div");o.classList.add("table-body"),s.append(r,o),t.appendChild(s);const h=document.createElement("style");h.textContent=`
            .table-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: hidden;
                width: 100%;
            }
            .table-header {
                align-items: center;
                color: rgba(255, 255, 255, 0.7);
                display: grid;
                font-size: 1.2rem;
                font-style: normal;
                font-weight: 500;
                grid-template-columns: 2fr 1fr 1fr 1fr;
                letter-spacing: -0.5px;
                line-height: 125%;
                padding: 10px;
            }
            .header-item {
                align-items: center;
                display: flex;
                flex-direction: column;
            }
            .table-body {
                overflow: auto;
            }
            .body-item {
                background: rgba(255, 255, 255, 0.06);
                border-radius: 1.6rem;
                display: grid;
                grid-template-columns: 2fr 1fr 1fr 1fr;
                margin-bottom: 1rem;
                padding: 1rem 0rem;
                text-align: center;
                align-items: center;
                font-style: normal;
                font-weight: 500;
                font-size: 1.2rem;
                line-height: 125%;
                letter-spacing: -0.5px;
            }
            .badge-multi {
                border-radius: 1.6rem;
                padding: 0.8rem;
                width: 4rem;
                margin: auto;
            }
        `,t.appendChild(h)}connectedCallback(){this.render()}render(){this.renderHeader(),this.renderBody()}renderBody(){var r;let t="";this.data.forEach(o=>{const{truncate:h}=truncateString(o.username,12);let c=`
                <div class="body-item">
                    <div>${h}</div>
                    <div>
                        $
                        ${o.bet.toFixed(2)}
                    </div>
                    <div>
                        <div class="badge-multi" style="background-color: ${o.color}" >
                            x${o.multiplier}
                        </div>
                    </div>
                    <div>
                        <lable style="color: #345DBB">$ </lable>
                        ${o.win.toFixed(2)}
                    </div>
                </div>
            `;t+=c});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-body");s.innerHTML=t}renderHeader(){var r;let t="";this.cols.forEach(o=>{t+=`<div class="header-item">${o}</div>`});let s=(r=this.shadowRoot)==null?void 0:r.querySelector(".table-header");s.innerHTML=t}}customElements.define("table-leaderboard",TableLeaderboard);class ModalLeaderboard extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const e=`
            <style>
                pop-up[id='modal-leaderboard'] {
                    --pop-up-close-display: none;
                    --pop-up-dialog-position: absolute;
                    --pop-up-dialog-top: 12rem;
                    --pop-up-dialog-right: 2.4rem;
                    --pop-up-dialog-background-color: #000;
                    --pop-up-dialog-border-radius: 2.4rem;
                    --pop-up-overlay-background-color: rgba(0, 0, 0, 0);
                    --pop-up-dialog-width: 40rem;
                    --pop-up-dialog-height: 30rem;
                    
                    --pop-up-overlay-border-radius: 2.4rem;
                }
                @media screen and (max-width: 461px) {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-close-display: block;
                    }
                }
                @media (min-width: 461px) and (max-width: 960px) {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-close-display: block;
                    }
                }
                @media (min-width: 961px)  {
                    pop-up[id='modal-leaderboard'] {
                        --pop-up-overlay-position: absolute;
                        --pop-up-overlay-top: 120px;
                        --pop-up-overlay-right: 24px;
                        --pop-up-overlay-left: none;
                        --pop-up-overlay-width: 40rem;
                        --pop-up-overlay-height: 30rem;
                    }
                }
            </style>
        `;this.innerHTML=`
            ${e}
          <pop-up static="true" id="modal-leaderboard">
            <div class="flex" slot="modal">
                <div style="height: 28rem;">
                    <table-leaderboard></table-leaderboard>
                </div>
            </div>
          </pop-up>
    `}}customElements.define("modal-leaderboard",ModalLeaderboard);class AppElement extends HTMLElement{connectedCallback(){this.innerHTML=`
        <modal-info></modal-info>
        <modal-award></modal-award>
        <modal-leaderboard></modal-leaderboard>
      `}}ne(AppElement,"observedAttributes",[]);customElements.define("element-root",AppElement);const _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1;DisplayObject.prototype._cacheData=null;DisplayObject.prototype._cacheAsBitmapResolution=null;DisplayObject.prototype._cacheAsBitmapMultisample=null;class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(n){if(this._cacheAsBitmap===n)return;this._cacheAsBitmap=n;let e;n?(this._cacheData||(this._cacheData=new CacheData),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});DisplayObject.prototype._renderCached=function n(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};DisplayObject.prototype._initCachedDisplayObject=function n(e){var m,g;if((m=this._cacheData)!=null&&m.sprite)return;const t=this.alpha;this.alpha=1,e.batch.flush();const s=this.getLocalBounds(null,!0).clone();if((g=this.filters)!=null&&g.length){const _=this.filters[0].padding;s.pad(_)}s.ceil(settings$1.RESOLUTION);const r=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),h=e.renderTexture.destinationFrame.clone(),c=e.projection.transform,a=RenderTexture.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),u=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=u,BaseTexture.addToCache(a.baseTexture,u),Texture.addToCache(a,u);const d=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:a,clear:!0,transform:d,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=c,e.renderTexture.bind(r,o,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const p=new Sprite(a);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-(s.x/s.width),p.anchor.y=-(s.y/s.height),p.alpha=t,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)};DisplayObject.prototype._renderCachedCanvas=function n(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};DisplayObject.prototype._initCachedDisplayObjectCanvas=function n(e){var d;if((d=this._cacheData)!=null&&d.sprite)return;const t=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const r=e.canvasContext.activeContext,o=e._projTransform;t.ceil(settings$1.RESOLUTION);const h=RenderTexture.create({width:t.width,height:t.height}),c=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=c,BaseTexture.addToCache(h.baseTexture,c),Texture.addToCache(h,c);const a=_tempMatrix;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:h,clear:!0,transform:a,skipUpdateTransform:!1}),e.canvasContext.activeContext=r,e._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const u=new Sprite(h);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(t.x/t.width),u.anchor.y=-(t.y/t.height),u.alpha=s,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};DisplayObject.prototype._calculateCachedBounds=function n(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};DisplayObject.prototype._getCachedLocalBounds=function n(){return this._cacheData.sprite.getLocalBounds(null)};DisplayObject.prototype._destroyCachedDisplayObject=function n(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};DisplayObject.prototype._cacheAsBitmapDestroy=function n(e){this.cacheAsBitmap=!1,this.destroy(e)};DisplayObject.prototype.name=null;Container.prototype.getChildByName=function n(e,t){for(let s=0,r=this.children.length;s<r;s++)if(this.children[s].name===e)return this.children[s];if(t)for(let s=0,r=this.children.length;s<r;s++){const o=this.children[s];if(!o.getChildByName)continue;const h=o.getChildByName(e,!0);if(h)return h}return null};DisplayObject.prototype.getGlobalPosition=function n(e=new Point,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var fragment$5=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class AlphaFilter extends Filter{constructor(e=1){super(defaultVertex,fragment$5,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(n){const e=GAUSSIAN_VALUES[n],t=e.length;let s=fragTemplate,r="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let h;for(let c=0;c<n;c++){let a=o.replace("%index%",c.toString());h=c,c>=t&&(h=n-c-1),a=a.replace("%value%",e[h].toString()),r+=a,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}const vertTemplate=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(n,e){const t=Math.ceil(n/2);let s=vertTemplate,r="",o;e?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let h=0;h<n;h++){let c=o.replace("%index%",h.toString());c=c.replace("%sampleIndex%",`${h-(t-1)}.0`),r+=c,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}class BlurFilterPass extends Filter{constructor(e,t=8,s=4,r=Filter.defaultResolution,o=5){const h=generateBlurVertSource(o,e),c=generateBlurFragSource(o);super(h,c),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=s,this.blur=t}apply(e,t,s,r){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/t.width):this.uniforms.strength=1/s.height*(s.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,t,s,r);else{const o=e.getFilterTexture(),h=e.renderer;let c=t,a=o;this.state.blend=!1,e.applyFilter(this,c,a,CLEAR_MODES.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(c,CLEAR_MODES.BLIT),this.uniforms.uSampler=a;const d=a;a=c,c=d,h.shader.bind(this),h.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,a,s,r),e.returnFilterTexture(o)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class BlurFilter extends Filter{constructor(e=8,t=4,s=Filter.defaultResolution,r=5){super(),this.blurXFilter=new BlurFilterPass(!0,e,t,s,r),this.blurYFilter=new BlurFilterPass(!1,e,t,s,r),this.resolution=s,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,s,r){const o=Math.abs(this.blurXFilter.strength),h=Math.abs(this.blurYFilter.strength);if(o&&h){const c=e.getFilterTexture();this.blurXFilter.apply(e,t,c,CLEAR_MODES.CLEAR),this.blurYFilter.apply(e,c,s,r),e.returnFilterTexture(c)}else h?this.blurYFilter.apply(e,t,s,r):this.blurXFilter.apply(e,t,s,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var fragment$4=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ColorMatrixFilter extends Filter{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(defaultFilterVertex,fragment$4,e),this.alpha=1}_loadMatrix(e,t=!1){let s=e;t&&(this._multiply(s,this.uniforms.m,e),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(e,t,s){return e[0]=t[0]*s[0]+t[1]*s[5]+t[2]*s[10]+t[3]*s[15],e[1]=t[0]*s[1]+t[1]*s[6]+t[2]*s[11]+t[3]*s[16],e[2]=t[0]*s[2]+t[1]*s[7]+t[2]*s[12]+t[3]*s[17],e[3]=t[0]*s[3]+t[1]*s[8]+t[2]*s[13]+t[3]*s[18],e[4]=t[0]*s[4]+t[1]*s[9]+t[2]*s[14]+t[3]*s[19]+t[4],e[5]=t[5]*s[0]+t[6]*s[5]+t[7]*s[10]+t[8]*s[15],e[6]=t[5]*s[1]+t[6]*s[6]+t[7]*s[11]+t[8]*s[16],e[7]=t[5]*s[2]+t[6]*s[7]+t[7]*s[12]+t[8]*s[17],e[8]=t[5]*s[3]+t[6]*s[8]+t[7]*s[13]+t[8]*s[18],e[9]=t[5]*s[4]+t[6]*s[9]+t[7]*s[14]+t[8]*s[19]+t[9],e[10]=t[10]*s[0]+t[11]*s[5]+t[12]*s[10]+t[13]*s[15],e[11]=t[10]*s[1]+t[11]*s[6]+t[12]*s[11]+t[13]*s[16],e[12]=t[10]*s[2]+t[11]*s[7]+t[12]*s[12]+t[13]*s[17],e[13]=t[10]*s[3]+t[11]*s[8]+t[12]*s[13]+t[13]*s[18],e[14]=t[10]*s[4]+t[11]*s[9]+t[12]*s[14]+t[13]*s[19]+t[14],e[15]=t[15]*s[0]+t[16]*s[5]+t[17]*s[10]+t[18]*s[15],e[16]=t[15]*s[1]+t[16]*s[6]+t[17]*s[11]+t[18]*s[16],e[17]=t[15]*s[2]+t[16]*s[7]+t[17]*s[12]+t[18]*s[17],e[18]=t[15]*s[3]+t[16]*s[8]+t[17]*s[13]+t[18]*s[18],e[19]=t[15]*s[4]+t[16]*s[9]+t[17]*s[14]+t[18]*s[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const s=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(s,t)}tint(e,t){const s=e>>16&255,r=e>>8&255,o=e&255,h=[s/255,0,0,0,0,0,r/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(h,t)}greyscale(e,t){const s=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(s,t)}blackAndWhite(e){const t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)}hue(e,t){e=(e||0)/180*Math.PI;const s=Math.cos(e),r=Math.sin(e),o=Math.sqrt,h=1/3,c=o(h),a=s+(1-s)*h,u=h*(1-s)-c*r,d=h*(1-s)+c*r,p=h*(1-s)+c*r,m=s+h*(1-s),g=h*(1-s)-c*r,_=h*(1-s)-c*r,y=h*(1-s)+c*r,v=s+h*(1-s),N=[a,u,d,0,0,p,m,g,0,0,_,y,v,0,0,0,0,0,1,0];this._loadMatrix(N,t)}contrast(e,t){const s=(e||0)+1,r=-.5*(s-1),o=[s,0,0,0,r,0,s,0,0,r,0,0,s,0,r,0,0,0,1,0];this._loadMatrix(o,t)}saturate(e=0,t){const s=e*2/3+1,r=(s-1)*-.5,o=[s,r,r,0,0,r,s,r,0,0,r,r,s,0,0,0,0,0,1,0];this._loadMatrix(o,t)}desaturate(){this.saturate(-1)}negative(e){const t=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(t,e)}sepia(e){const t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)}technicolor(e){const t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)}polaroid(e){const t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)}toBGR(e){const t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)}kodachrome(e){const t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)}browni(e){const t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)}vintage(e){const t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)}colorTone(e,t,s,r,o){e=e||.2,t=t||.15,s=s||16770432,r=r||3375104;const h=(s>>16&255)/255,c=(s>>8&255)/255,a=(s&255)/255,u=(r>>16&255)/255,d=(r>>8&255)/255,p=(r&255)/255,m=[.3,.59,.11,0,0,h,c,a,e,0,u,d,p,t,0,h-u,c-d,a-p,0,0];this._loadMatrix(m,o)}night(e,t){e=e||.1;const s=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(s,t)}predator(e,t){const s=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(s,t)}lsd(e){const t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var fragment$3=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vertex$2=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class DisplacementFilter extends Filter{constructor(e,t){const s=new Matrix;e.renderable=!1,super(vertex$2,fragment$3,{mapSampler:e._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=s,t==null&&(t=20),this.scale=new Point(t,t)}apply(e,t,s,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,h=Math.sqrt(o.a*o.a+o.b*o.b),c=Math.sqrt(o.c*o.c+o.d*o.d);h!==0&&c!==0&&(this.uniforms.rotation[0]=o.a/h,this.uniforms.rotation[1]=o.b/h,this.uniforms.rotation[2]=o.c/c,this.uniforms.rotation[3]=o.d/c),e.applyFilter(this,t,s,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var fragment$2=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,vertex$1=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class FXAAFilter extends Filter{constructor(){super(vertex$1,fragment$2)}}var fragment$1=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class NoiseFilter extends Filter{constructor(e=.5,t=Math.random()){super(defaultFilterVertex,fragment$1,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const filters={AlphaFilter,BlurFilter,BlurFilterPass,ColorMatrixFilter,DisplacementFilter,FXAAFilter,NoiseFilter};Object.entries(filters).forEach(([n,e])=>{Object.defineProperty(filters,n,{get(){return deprecation("7.1.0",`filters.${n} has moved to ${n}`),e}})});class FederatedEvent{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point,this.page=new Point,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,s,r,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new Point,this.movement=new Point,this.offset=new Point,this.global=new Point,this.screen=new Point}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,s,r,o,h,c,a,u,d,p,m,g,_,y){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const PROPAGATION_LIMIT=2048,tempHitLocation=new Point,tempLocalMapping=new Point;class EventBoundary{constructor(e){this.dispatch=new eventemitter3Exports,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((s,r)=>s.priority-r.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let s=0,r=t.length;s<r;s++)t[s].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){const s=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,tempHitLocation.set(e,t),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,t){if(!e.target)return;const s=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,o=s.length-1;r<o;r++)if(e.currentTarget=s[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(e.currentTarget=s[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,s=this.rootTarget){e.eventPhase=e.BUBBLING_PHASE;const r=s.children;if(r)for(let o=0;o<r.length;o++)this.all(e,t,r[o]);e.currentTarget=s,this.notifyTarget(e,t)}propagationPath(e){const t=[e];for(let s=0;s<PROPAGATION_LIMIT&&e!==this.rootTarget;s++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestRecursive(e,t,s,r,o){if(!e||!e.visible||o(e,s))return null;if(e.interactiveChildren&&e.children){const h=e.children;for(let c=h.length-1;c>=0;c--){const a=h[c],u=this.hitTestRecursive(a,t||a.interactive,s,r,o);if(u){if(u.length>0&&!u[u.length-1].parent)continue;return(u.length>0||e.interactive)&&u.push(e),u}}}return t&&r(e,s)?e.interactive?[e]:[]:null}hitPruneFn(e,t){var s;if(e.hitArea&&(e.worldTransform.applyInverse(t,tempLocalMapping),!e.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,t)))return!0}return!1}hitTestFn(e,t){return e.hitArea?!0:e.containsPoint?e.containsPoint(t):!1}notifyTarget(e,t){var o,h;t=t??e.type;const s=`on${t}`;(h=(o=e.currentTarget)[s])==null||h.call(o,e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const r=t.button===2;this.dispatchEvent(t,r?"rightdown":"mousedown")}const s=this.trackingData(e.pointerId);s.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){var c,a;if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e),s=t.pointerType==="mouse"||t.pointerType==="pen",r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.overTargets);if(((c=r.overTargets)==null?void 0:c.length)>0&&o!==t.target){const u=e.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(e,u,o);if(this.dispatchEvent(d,"pointerout"),s&&this.dispatchEvent(d,"mouseout"),!t.composedPath().includes(o)){const p=this.createPointerEvent(e,"pointerleave",o);for(p.eventPhase=p.AT_TARGET;p.target&&!t.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),s&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(d)}if(o!==t.target){const u=e.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(t,u);this.dispatchEvent(d,"pointerover"),s&&this.dispatchEvent(d,"mouseover");let p=o==null?void 0:o.parent;for(;p&&p!==this.rootTarget.parent&&p!==t.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const g=this.clonePointerEvent(t,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==o&&g.target!==this.rootTarget.parent;)g.currentTarget=g.target,this.notifyTarget(g),s&&this.notifyTarget(g,"mouseenter"),g.target=g.target.parent;this.freeEvent(g)}this.freeEvent(d)}const h=this.moveOnAll?"all":"dispatchEvent";this[h](t,"pointermove"),this.all(t,"globalpointermove"),t.pointerType==="touch"&&(this[h](t,"touchmove"),this.all(t,"globaltouchmove")),s&&(this[h](t,"mousemove"),this.all(t,"globalmousemove"),this.cursor=(a=t.target)==null?void 0:a.cursor),r.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){var h;if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),s=this.createPointerEvent(e),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(h=s.target)==null?void 0:h.cursor);const o=this.clonePointerEvent(s,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;t.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(o)}mapPointerOut(e){if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.findMountedTarget(t.overTargets),o=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(o),s&&this.dispatchEvent(o,"mouseout");const h=this.createPointerEvent(e,"pointerleave",r);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),s&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;t.overTargets=null,this.freeEvent(o),this.freeEvent(h)}this.cursor=null}mapPointerUp(e){if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),s=this.createPointerEvent(e);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const c=s.button===2;this.dispatchEvent(s,c?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.pressTargetsByButton[e.button]);let h=o;if(o&&!s.composedPath().includes(o)){let c=o;for(;c&&!s.composedPath().includes(c);){if(s.currentTarget=c,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.notifyTarget(s,a?"rightupoutside":"mouseupoutside")}c=c.parent}delete r.pressTargetsByButton[e.button],h=c}if(h){const c=this.clonePointerEvent(s,"click");c.target=h,c.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:c.target,timeStamp:t});const a=r.clicksByButton[e.button];a.target===c.target&&t-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=c.target,a.timeStamp=t,c.detail=a.clickCount,c.pointerType==="mouse"?this.dispatchEvent(c,"click"):c.pointerType==="touch"&&this.dispatchEvent(c,"tap"),this.dispatchEvent(c,"pointertap"),this.freeEvent(c)}this.freeEvent(s)}mapPointerUpOutside(e){if(!(e instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),s=this.findMountedTarget(t.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(s){let o=s;for(;o;)r.currentTarget=o,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof FederatedWheelEvent)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let s=1;s<e.length&&e[s].parent===t;s++)t=e[s];return t}createPointerEvent(e,t,s){const r=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=s??this.hitTest(r.global.x,r.global.y),typeof t=="string"&&(r.type=t),r}createWheelEvent(e){const t=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const s=this.allocateEvent(FederatedPointerEvent);return s.nativeEvent=e.nativeEvent,s.originalEvent=e.originalEvent,this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.target=e.target,s.path=e.composedPath().slice(),s.type=t??s.type,s}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof FederatedPointerEvent&&t instanceof FederatedPointerEvent&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof FederatedMouseEvent&&t instanceof FederatedMouseEvent&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const s=e.currentTarget._events[t];if(s)if("fn"in s)s.fn.call(s.context,e);else for(let r=0,o=s.length;r<o&&!e.propagationImmediatelyStopped;r++)s[r].fn.call(s[r].context,e)}}const MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class EventSystem{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new EventBoundary(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:e,resolution:t}=this.renderer;this.setTargetElement(e),this.resolution=t}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const s=this.cursorStyles[e];if(s)switch(typeof s){case"string":t&&(this.domElement.style.cursor=s);break;case"function":s(e);break;case"object":t&&Object.assign(this.domElement.style,s);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}onPointerDown(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let s=0,r=t.length;s<r;s++){const o=t[s],h=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const t=this.normalizeToPointerData(e);for(let s=0,r=t.length;s<r;s++){const o=this.bootstrapEvent(this.rootPointerEvent,t[s]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const s=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let o=0,h=r.length;o<h;o++){const c=this.bootstrapEvent(this.rootPointerEvent,r[o]);c.type+=s,this.rootBoundary.mapEvent(c)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const t=this.normalizeToPointerData(e);for(let s=0,r=t.length;s<r;s++){const o=this.bootstrapEvent(this.rootPointerEvent,t[s]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,s){let r;this.domElement.parentElement?r=this.domElement.getBoundingClientRect():r={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const o=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*o,e.y=(s-r.top)*(this.domElement.height/r.height)*o}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let s=0,r=e.changedTouches.length;s<r;s++){const o=e.changedTouches[s];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=e.type,t.push(o)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const s=e;typeof s.isPrimary>"u"&&(s.isPrimary=!0),typeof s.width>"u"&&(s.width=1),typeof s.height>"u"&&(s.height=1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="mouse"),typeof s.pointerId>"u"&&(s.pointerId=MOUSE_POINTER_ID),typeof s.pressure>"u"&&(s.pressure=.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),s.isNormalized=!0,t.push(s)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=TOUCH_TO_POINTER[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}}EventSystem.extension={name:"events",type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem]};extensions$1.add(EventSystem);const FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(n,e,t){const s=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=s?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.on(n,e,r)},removeEventListener(n,e,t){const s=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=s?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.off(n,e,r)},dispatchEvent(n){if(!(n instanceof FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};DisplayObject.mixin(FederatedDisplayObject);const accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};DisplayObject.mixin(accessibleTarget);const KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;class AccessibilityManager{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile.tablet||isMobile.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width=`${DIV_TOUCH_SIZE}px`,t.style.height=`${DIV_TOUCH_SIZE}px`,t.style.position="absolute",t.style.top=`${DIV_TOUCH_POS_X}px`,t.style.left=`${DIV_TOUCH_POS_Y}px`,t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${DIV_HOOK_SIZE}px`,e.style.height=`${DIV_HOOK_SIZE}px`,e.style.position="absolute",e.style.top=`${DIV_HOOK_POS_X}px`,e.style.left=`${DIV_HOOK_POS_Y}px`,e.style.zIndex=DIV_HOOK_ZINDEX.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let s=0;s<t.length;s++)this.updateAccessibleObjects(t[s])}update(){const e=performance.now();if(isMobile.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:s,width:r,height:o}=this.renderer.view.getBoundingClientRect(),{width:h,height:c,resolution:a}=this.renderer,u=r/h*a,d=o/c*a;let p=this.div;p.style.left=`${t}px`,p.style.top=`${s}px`,p.style.width=`${h}px`,p.style.height=`${c}px`;for(let m=0;m<this.children.length;m++){const g=this.children[m];if(g.renderId!==this.renderId)g._accessibleActive=!1,removeItems(this.children,m,1),this.div.removeChild(g._accessibleDiv),this.pool.push(g._accessibleDiv),g._accessibleDiv=null,m--;else{p=g._accessibleDiv;let _=g.hitArea;const y=g.worldTransform;g.hitArea?(p.style.left=`${(y.tx+_.x*y.a)*u}px`,p.style.top=`${(y.ty+_.y*y.d)*d}px`,p.style.width=`${_.width*y.a*u}px`,p.style.height=`${_.height*y.d*d}px`):(_=g.getBounds(),this.capHitArea(_),p.style.left=`${_.x*u}px`,p.style.top=`${_.y*d}px`,p.style.width=`${_.width*u}px`,p.style.height=`${_.height*d}px`,p.title!==g.accessibleTitle&&g.accessibleTitle!==null&&(p.title=g.accessibleTitle),p.getAttribute("aria-label")!==g.accessibleHint&&g.accessibleHint!==null&&p.setAttribute("aria-label",g.accessibleHint)),(g.accessibleTitle!==p.title||g.tabIndex!==p.tabIndex)&&(p.title=g.accessibleTitle,p.tabIndex=g.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:s}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>s&&(e.height=s-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=`${DIV_TOUCH_SIZE}px`,t.style.height=`${DIV_TOUCH_SIZE}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:s}=e.target,r=this.renderer.events.rootBoundary,o=Object.assign(new FederatedEvent(r),{target:s});r.rootTarget=this.renderer.lastObjectRendered,t.forEach(h=>r.dispatchEvent(o,h))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===KEY_CODE_TAB&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}AccessibilityManager.extension={name:"accessibility",type:[ExtensionType.RendererPlugin,ExtensionType.CanvasRendererPlugin]};extensions$1.add(AccessibilityManager);const _Application=class{constructor(n){this.stage=new Container,n=Object.assign({forceCanvas:!1},n),this.renderer=autoDetectRenderer(n),_Application._plugins.forEach(e=>{e.init.call(this,n)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(n,e){const t=_Application._plugins.slice(0);t.reverse(),t.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(n),this.renderer=null}};let Application=_Application;Application._plugins=[];extensions$1.handleByList(ExtensionType.Application,Application._plugins);class ResizePlugin{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let t,s;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:o}=this._resizeTo;t=r,s=o}this.renderer.resize(t,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ResizePlugin.extension=ExtensionType.Application;extensions$1.add(ResizePlugin);var INTERNAL_FORMATS=(n=>(n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n))(INTERNAL_FORMATS||{});const INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let storedGl,extensions;function getCompressedTextureExtensions(){extensions={s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc")}}const detectCompressedTextures={extension:{type:ExtensionType.DetectionParser,priority:2},test:async()=>{const e=settings$1.ADAPTER.createCanvas().getContext("webgl");return e?(storedGl=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async n=>{extensions||getCompressedTextureExtensions();const e=[];for(const t in extensions)extensions[t]&&e.push(t);return[...e,...n]},remove:async n=>(extensions||getCompressedTextureExtensions(),n.filter(e=>!(e in extensions)))};extensions$1.add(detectCompressedTextures);class BlobResource extends BufferResource{constructor(e,t={width:1,height:1,autoLoad:!0}){let s,r;typeof e=="string"?(s=e,r=new Uint8Array):(s=null,r=e),super(r,t),this.origin=s,this.buffer=r?new ViewableBuffer(r):null,this.origin&&t.autoLoad!==!1&&this.load(),r!=null&&r.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}async load(){const s=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(s),this.buffer=new ViewableBuffer(s),this.loaded=!0,this.onBlobLoaded(s),this.update(),this}}class CompressedTextureResource extends BlobResource{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||CompressedTextureResource._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,s){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let h=0,c=this.levels;h<c;h++){const{levelID:a,levelWidth:u,levelHeight:d,levelBuffer:p}=this._levelBuffers[h];r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,u,d,0,p)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,t,s,r,o,h,c){const a=new Array(s);let u=e.byteOffset,d=h,p=c,m=d+r-1&~(r-1),g=p+o-1&~(o-1),_=m*g*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t];for(let y=0;y<s;y++)a[y]={levelID:y,levelWidth:s>1?d:m,levelHeight:s>1?p:g,levelBuffer:new Uint8Array(e.buffer,u,_)},u+=_,d=d>>1||1,p=p>>1||1,m=d+r-1&~(r-1),g=p+o-1&~(o-1),_=m*g*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t];return a}}const DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT={[FOURCC_DXT1]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[FOURCC_DXT3]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[FOURCC_DXT5]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},DXGI_TO_FORMAT={[70]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function parseDDS(n){const e=new Uint32Array(n);if(e[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");const s=new Uint32Array(n,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),r=s[DDS_FIELDS.HEIGHT],o=s[DDS_FIELDS.WIDTH],h=s[DDS_FIELDS.MIPMAP_COUNT],c=new Uint32Array(n,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),a=c[PF_FLAGS];if(a&DDPF_FOURCC){const u=c[DDS_PF_FIELDS.FOURCC];if(u!==FOURCC_DX10){const k=FOURCC_TO_FORMAT[u],U=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,ee=new Uint8Array(n,U);return[new CompressedTextureResource(ee,{format:k,width:o,height:r,levels:h})]}const d=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,p=new Uint32Array(e.buffer,d,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),m=p[DDS_DX10_FIELDS.DXGI_FORMAT],g=p[DDS_DX10_FIELDS.RESOURCE_DIMENSION],_=p[DDS_DX10_FIELDS.MISC_FLAG],y=p[DDS_DX10_FIELDS.ARRAY_SIZE],v=DXGI_TO_FORMAT[m];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${m}`);if(_===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(g===6)throw new Error("DDSParser does not supported 3D texture data");const N=new Array,w=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(y===1)N.push(new Uint8Array(n,w));else{const k=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[v];let U=0,ee=o,ie=r;for(let oe=0;oe<h;oe++){const le=Math.max(1,ee+3&-4),ue=Math.max(1,ie+3&-4),he=le*ue*k;U+=he,ee=ee>>>1,ie=ie>>>1}let se=w;for(let oe=0;oe<y;oe++)N.push(new Uint8Array(n,se,U)),se+=U}return N.map(k=>new CompressedTextureResource(k,{format:v,width:o,height:r,levels:h}))}throw a&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):a&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):a&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT={[TYPES.UNSIGNED_BYTE]:1,[TYPES.UNSIGNED_SHORT]:2,[TYPES.INT]:4,[TYPES.UNSIGNED_INT]:4,[TYPES.FLOAT]:4,[TYPES.HALF_FLOAT]:8},FORMATS_TO_COMPONENTS={[FORMATS.RGBA]:4,[FORMATS.RGB]:3,[FORMATS.RG]:2,[FORMATS.RED]:1,[FORMATS.LUMINANCE]:1,[FORMATS.LUMINANCE_ALPHA]:2,[FORMATS.ALPHA]:1},TYPES_TO_BYTES_PER_PIXEL={[TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[TYPES.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(n,e,t=!1){const s=new DataView(e);if(!validate(n,s))return null;const r=s.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,o=s.getUint32(KTX_FIELDS.GL_TYPE,r),h=s.getUint32(KTX_FIELDS.GL_FORMAT,r),c=s.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,r),a=s.getUint32(KTX_FIELDS.PIXEL_WIDTH,r),u=s.getUint32(KTX_FIELDS.PIXEL_HEIGHT,r)||1,d=s.getUint32(KTX_FIELDS.PIXEL_DEPTH,r)||1,p=s.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,r)||1,m=s.getUint32(KTX_FIELDS.NUMBER_OF_FACES,r),g=s.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,r),_=s.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,r);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");const y=4,v=4,N=a+3&-4,w=u+3&-4,k=new Array(p);let U=a*u;o===0&&(U=N*w);let ee;if(o!==0?TYPES_TO_BYTES_PER_COMPONENT[o]?ee=TYPES_TO_BYTES_PER_COMPONENT[o]*FORMATS_TO_COMPONENTS[h]:ee=TYPES_TO_BYTES_PER_PIXEL[o]:ee=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[c],ee===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const ie=t?parseKvData(s,_,r):null;let oe=U*ee,le=a,ue=u,he=N,pe=w,de=FILE_HEADER_SIZE+_;for(let fe=0;fe<g;fe++){const Te=s.getUint32(de,r);let Ce=de+4;for(let be=0;be<p;be++){let Ae=k[be];Ae||(Ae=k[be]=new Array(g)),Ae[fe]={levelID:fe,levelWidth:g>1||o!==0?le:he,levelHeight:g>1||o!==0?ue:pe,levelBuffer:new Uint8Array(e,Ce,oe)},Ce+=oe}de+=Te+4,de=de%4!==0?de+4-de%4:de,le=le>>1||1,ue=ue>>1||1,he=le+y-1&~(y-1),pe=ue+v-1&~(v-1),oe=he*pe*ee}return o!==0?{uncompressed:k.map(fe=>{let Te=fe[0].levelBuffer,Ce=!1;return o===TYPES.FLOAT?Te=new Float32Array(fe[0].levelBuffer.buffer,fe[0].levelBuffer.byteOffset,fe[0].levelBuffer.byteLength/4):o===TYPES.UNSIGNED_INT?(Ce=!0,Te=new Uint32Array(fe[0].levelBuffer.buffer,fe[0].levelBuffer.byteOffset,fe[0].levelBuffer.byteLength/4)):o===TYPES.INT&&(Ce=!0,Te=new Int32Array(fe[0].levelBuffer.buffer,fe[0].levelBuffer.byteOffset,fe[0].levelBuffer.byteLength/4)),{resource:new BufferResource(Te,{width:fe[0].levelWidth,height:fe[0].levelHeight}),type:o,format:Ce?convertFormatToInteger(h):h}}),kvData:ie}:{compressed:k.map(fe=>new CompressedTextureResource(null,{format:c,width:a,height:u,levels:g,levelBuffers:fe})),kvData:ie}}function validate(n,e){for(let t=0;t<FILE_IDENTIFIER.length;t++)if(e.getUint8(t)!==FILE_IDENTIFIER[t])return console.error(`${n} is not a valid *.ktx file!`),!1;return!0}function convertFormatToInteger(n){switch(n){case FORMATS.RGBA:return FORMATS.RGBA_INTEGER;case FORMATS.RGB:return FORMATS.RGB_INTEGER;case FORMATS.RG:return FORMATS.RG_INTEGER;case FORMATS.RED:return FORMATS.RED_INTEGER;default:return n}}function parseKvData(n,e,t){const s=new Map;let r=0;for(;r<e;){const o=n.getUint32(FILE_HEADER_SIZE+r,t),h=FILE_HEADER_SIZE+r+4,c=3-(o+3)%4;if(o===0||o>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let a=0;for(;a<o&&n.getUint8(h+a)!==0;a++);if(a===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(n.buffer,h,a)),d=new DataView(n.buffer,h+a+1,o-a-1);s.set(u,d),r+=4+o+c}return s}const loadDDS={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return checkExtension(n,".dds")},async load(n,e,t){const r=await(await settings$1.ADAPTER.fetch(n)).arrayBuffer(),h=parseDDS(r).map(c=>{const a=new BaseTexture(c,{mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(n),...e.data});return createTexture(a,t,n)});return h.length===1?h[0]:h},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};extensions$1.add(loadDDS);const loadKTX={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},test(n){return checkExtension(n,".ktx")},async load(n,e,t){const r=await(await settings$1.ADAPTER.fetch(n)).arrayBuffer(),{compressed:o,uncompressed:h,kvData:c}=parseKTX(n,r),a=o??h,u={mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(n),...e.data},d=a.map(p=>{a===h&&Object.assign(u,{type:p.type,format:p.format});const m=new BaseTexture(p,u);return m.ktxKeyValueData=c,createTexture(m,t,n)});return d.length===1?d[0]:d},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};extensions$1.add(loadKTX);const resolveCompressedTextureUrl={extension:ExtensionType.ResolveParser,test:n=>{const t=n.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(t)},parse:n=>{var s,r;if(n.split("?")[0].split(".").pop()==="ktx"){const o=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(o.some(h=>n.endsWith(h)))return{resolution:parseFloat(((s=settings$1.RETINA_PREFIX.exec(n))==null?void 0:s[1])??"1"),format:o.find(h=>n.endsWith(h)),src:n}}return{resolution:parseFloat(((r=settings$1.RETINA_PREFIX.exec(n))==null?void 0:r[1])??"1"),format:n.split(".").pop(),src:n}}};extensions$1.add(resolveCompressedTextureUrl);const TEMP_RECT=new Rectangle,BYTES_PER_PIXEL=4,_Extract=class{constructor(n){this.renderer=n}async image(n,e,t){const s=new Image;return s.src=await this.base64(n,e,t),s}async base64(n,e,t){const s=this.canvas(n);if(s.toDataURL!==void 0)return s.toDataURL(e,t);if(s.convertToBlob!==void 0){const r=await s.convertToBlob({type:e,quality:t});return await new Promise(o=>{const h=new FileReader;h.onload=()=>o(h.result),h.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(n,e){const t=this.renderer;let s,r=!1,o,h=!1;n&&(n instanceof RenderTexture?o=n:(o=this.renderer.generateTexture(n),h=!0)),o?(s=o.baseTexture.resolution,e=e??o.frame,r=!1,t.renderTexture.bind(o)):(s=t.resolution,e||(e=TEMP_RECT,e.width=t.width,e.height=t.height),r=!0,t.renderTexture.bind(null));const c=Math.round(e.width*s),a=Math.round(e.height*s);let u=new CanvasRenderTarget(c,a,1);const d=new Uint8Array(BYTES_PER_PIXEL*c*a),p=t.gl;p.readPixels(Math.round(e.x*s),Math.round(e.y*s),c,a,p.RGBA,p.UNSIGNED_BYTE,d);const m=u.context.getImageData(0,0,c,a);if(_Extract.arrayPostDivide(d,m.data),u.context.putImageData(m,0,0),r){const g=new CanvasRenderTarget(u.width,u.height,1);g.context.scale(1,-1),g.context.drawImage(u.canvas,0,-a),u.destroy(),u=g}return h&&o.destroy(!0),u.canvas}pixels(n,e){const t=this.renderer;let s,r,o=!1;n&&(n instanceof RenderTexture?r=n:(r=this.renderer.generateTexture(n),o=!0)),r?(s=r.baseTexture.resolution,e=e??r.frame,t.renderTexture.bind(r)):(s=t.resolution,e||(e=TEMP_RECT,e.width=t.width,e.height=t.height),t.renderTexture.bind(null));const h=Math.round(e.width*s),c=Math.round(e.height*s),a=new Uint8Array(BYTES_PER_PIXEL*h*c),u=t.gl;return u.readPixels(Math.round(e.x*s),Math.round(e.y*s),h,c,u.RGBA,u.UNSIGNED_BYTE,a),o&&r.destroy(!0),_Extract.arrayPostDivide(a,a),a}destroy(){this.renderer=null}static arrayPostDivide(n,e){for(let t=0;t<n.length;t+=4){const s=e[t+3]=n[t+3];s!==0?(e[t]=Math.round(Math.min(n[t]*255/s,255)),e[t+1]=Math.round(Math.min(n[t+1]*255/s,255)),e[t+2]=Math.round(Math.min(n[t+2]*255/s,255))):(e[t]=n[t],e[t+1]=n[t+1],e[t+2]=n[t+2])}}};let Extract=_Extract;Extract.extension={name:"extract",type:ExtensionType.RendererSystem};extensions$1.add(Extract);class ParticleBuffer{constructor(e,t,s){this.geometry=new Geometry,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let o=e[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||TYPES.FLOAT,offset:o.offset},t[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new Buffer(createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let h=0;h<this.dynamicProperties.length;++h){const c=this.dynamicProperties[h];c.offset=t,t+=c.size,this.dynamicStride+=c.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Buffer(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let h=0;h<this.staticProperties.length;++h){const c=this.staticProperties[h];c.offset=r,r+=c.size,this.staticStride+=c.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new Buffer(this.staticData,!0,!1);for(let h=0;h<this.dynamicProperties.length;++h){const c=this.dynamicProperties[h];e.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===TYPES.UNSIGNED_BYTE,c.type,this.dynamicStride*4,c.offset*4)}for(let h=0;h<this.staticProperties.length;++h){const c=this.staticProperties[h];e.addAttribute(c.attributeName,this.staticBuffer,0,c.type===TYPES.UNSIGNED_BYTE,c.type,this.staticStride*4,c.offset*4)}}uploadDynamic(e,t,s){for(let r=0;r<this.dynamicProperties.length;r++){const o=this.dynamicProperties[r];o.uploadFunction(e,t,s,o.type===TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,s){for(let r=0;r<this.staticProperties.length;r++){const o=this.staticProperties[r];o.uploadFunction(e,t,s,o.type===TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var fragment=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ParticleRenderer extends ObjectRenderer{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Shader.from(vertex,fragment,{}),this.state=State$1.for2d()}render(e){const t=e.children,s=e._maxSize,r=e._batchSize,o=this.renderer;let h=t.length;if(h===0)return;h>s&&!e.autoResize&&(h=s);let c=e._buffers;c||(c=e._buffers=this.generateBuffers(e));const a=t[0]._texture.baseTexture,u=a.alphaMode>0;this.state.blendMode=correctBlendMode(e.blendMode,u),o.state.set(this.state);const d=o.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=premultiplyRgba(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,u),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);let m=!1;for(let g=0,_=0;g<h;g+=r,_+=1){let y=h-g;y>r&&(y=r),_>=c.length&&c.push(this._generateOneMoreBuffer(e));const v=c[_];v.uploadDynamic(t,g,y);const N=e._bufferUpdateIDs[_]||0;m=m||v._updateID<N,m&&(v._updateID=e._updateID,v.uploadStatic(t,g,y)),o.geometry.bind(v.geometry),d.drawElements(d.TRIANGLES,y*6,d.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],s=e._maxSize,r=e._batchSize,o=e._properties;for(let h=0;h<s;h+=r)t.push(new ParticleBuffer(this.properties,o,r));return t}_generateOneMoreBuffer(e){const t=e._batchSize,s=e._properties;return new ParticleBuffer(this.properties,s,t)}uploadVertices(e,t,s,r,o,h){let c=0,a=0,u=0,d=0;for(let p=0;p<s;++p){const m=e[t+p],g=m._texture,_=m.scale.x,y=m.scale.y,v=g.trim,N=g.orig;v?(a=v.x-m.anchor.x*N.width,c=a+v.width,d=v.y-m.anchor.y*N.height,u=d+v.height):(c=N.width*(1-m.anchor.x),a=N.width*-m.anchor.x,u=N.height*(1-m.anchor.y),d=N.height*-m.anchor.y),r[h]=a*_,r[h+1]=d*y,r[h+o]=c*_,r[h+o+1]=d*y,r[h+o*2]=c*_,r[h+o*2+1]=u*y,r[h+o*3]=a*_,r[h+o*3+1]=u*y,h+=o*4}}uploadPosition(e,t,s,r,o,h){for(let c=0;c<s;c++){const a=e[t+c].position;r[h]=a.x,r[h+1]=a.y,r[h+o]=a.x,r[h+o+1]=a.y,r[h+o*2]=a.x,r[h+o*2+1]=a.y,r[h+o*3]=a.x,r[h+o*3+1]=a.y,h+=o*4}}uploadRotation(e,t,s,r,o,h){for(let c=0;c<s;c++){const a=e[t+c].rotation;r[h]=a,r[h+o]=a,r[h+o*2]=a,r[h+o*3]=a,h+=o*4}}uploadUvs(e,t,s,r,o,h){for(let c=0;c<s;++c){const a=e[t+c]._texture._uvs;a?(r[h]=a.x0,r[h+1]=a.y0,r[h+o]=a.x1,r[h+o+1]=a.y1,r[h+o*2]=a.x2,r[h+o*2+1]=a.y2,r[h+o*3]=a.x3,r[h+o*3+1]=a.y3,h+=o*4):(r[h]=0,r[h+1]=0,r[h+o]=0,r[h+o+1]=0,r[h+o*2]=0,r[h+o*2+1]=0,r[h+o*3]=0,r[h+o*3+1]=0,h+=o*4)}}uploadTint(e,t,s,r,o,h){for(let c=0;c<s;++c){const a=e[t+c],u=a._texture.baseTexture.alphaMode>0,d=a.alpha,p=d<1&&u?premultiplyTint(a._tintRGB,d):a._tintRGB+(d*255<<24);r[h]=p,r[h+o]=p,r[h+o*2]=p,r[h+o*3]=p,h+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ParticleRenderer.extension={name:"particle",type:ExtensionType.RendererPlugin};extensions$1.add(ParticleRenderer);var TEXT_GRADIENT=(n=>(n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",n))(TEXT_GRADIENT||{});const contextSettings={willReadFrequently:!0},_TextMetrics=class{static get experimentalLetterSpacingSupported(){let n=_TextMetrics._experimentalLetterSpacingSupported;if(n!==void 0){const e=settings$1.ADAPTER.getCanvasRenderingContext2D().prototype;n=_TextMetrics._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return n}constructor(n,e,t,s,r,o,h,c,a){this.text=n,this.style=e,this.width=t,this.height=s,this.lines=r,this.lineWidths=o,this.lineHeight=h,this.maxLineWidth=c,this.fontProperties=a}static measureText(n,e,t,s=_TextMetrics._canvas){t=t??e.wordWrap;const r=e.toFontString(),o=_TextMetrics.measureFont(r);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const h=s.getContext("2d",contextSettings);h.font=r;const a=(t?_TextMetrics.wordWrap(n,e,s):n).split(/(?:\r\n|\r|\n)/),u=new Array(a.length);let d=0;for(let _=0;_<a.length;_++){const y=_TextMetrics._measureText(a[_],e.letterSpacing,h);u[_]=y,d=Math.max(d,y)}let p=d+e.strokeThickness;e.dropShadow&&(p+=e.dropShadowDistance);const m=e.lineHeight||o.fontSize+e.strokeThickness;let g=Math.max(m,o.fontSize+e.strokeThickness*2)+(a.length-1)*(m+e.leading);return e.dropShadow&&(g+=e.dropShadowDistance),new _TextMetrics(n,e,p,g,a,u,m+e.leading,d,o)}static _measureText(n,e,t){let s=!1;_TextMetrics.experimentalLetterSpacingSupported&&(_TextMetrics.experimentalLetterSpacing?(t.letterSpacing=`${e}px`,t.textLetterSpacing=`${e}px`,s=!0):(t.letterSpacing="0px",t.textLetterSpacing="0px"));let r=t.measureText(n).width;return r>0&&(s?r-=e:r+=(_TextMetrics.graphemeSegmenter(n).length-1)*e),r}static wordWrap(n,e,t=_TextMetrics._canvas){const s=t.getContext("2d",contextSettings);let r=0,o="",h="";const c=Object.create(null),{letterSpacing:a,whiteSpace:u}=e,d=_TextMetrics.collapseSpaces(u),p=_TextMetrics.collapseNewlines(u);let m=!d;const g=e.wordWrapWidth+a,_=_TextMetrics.tokenize(n);for(let y=0;y<_.length;y++){let v=_[y];if(_TextMetrics.isNewline(v)){if(!p){h+=_TextMetrics.addLine(o),m=!d,o="",r=0;continue}v=" "}if(d){const w=_TextMetrics.isBreakingSpace(v),k=_TextMetrics.isBreakingSpace(o[o.length-1]);if(w&&k)continue}const N=_TextMetrics.getFromCache(v,a,c,s);if(N>g)if(o!==""&&(h+=_TextMetrics.addLine(o),o="",r=0),_TextMetrics.canBreakWords(v,e.breakWords)){const w=_TextMetrics.wordWrapSplit(v);for(let k=0;k<w.length;k++){let U=w[k],ee=U,ie=1;for(;w[k+ie];){const oe=w[k+ie];if(!_TextMetrics.canBreakChars(ee,oe,v,k,e.breakWords))U+=oe;else break;ee=oe,ie++}k+=ie-1;const se=_TextMetrics.getFromCache(U,a,c,s);se+r>g&&(h+=_TextMetrics.addLine(o),m=!1,o="",r=0),o+=U,r+=se}}else{o.length>0&&(h+=_TextMetrics.addLine(o),o="",r=0);const w=y===_.length-1;h+=_TextMetrics.addLine(v,!w),m=!1,o="",r=0}else N+r>g&&(m=!1,h+=_TextMetrics.addLine(o),o="",r=0),(o.length>0||!_TextMetrics.isBreakingSpace(v)||m)&&(o+=v,r+=N)}return h+=_TextMetrics.addLine(o,!1),h}static addLine(n,e=!0){return n=_TextMetrics.trimRight(n),n=e?`${n}
`:n,n}static getFromCache(n,e,t,s){let r=t[n];return typeof r!="number"&&(r=_TextMetrics._measureText(n,e,s)+e,t[n]=r),r}static collapseSpaces(n){return n==="normal"||n==="pre-line"}static collapseNewlines(n){return n==="normal"}static trimRight(n){if(typeof n!="string")return"";for(let e=n.length-1;e>=0;e--){const t=n[e];if(!_TextMetrics.isBreakingSpace(t))break;n=n.slice(0,-1)}return n}static isNewline(n){return typeof n!="string"?!1:_TextMetrics._newlines.includes(n.charCodeAt(0))}static isBreakingSpace(n,e){return typeof n!="string"?!1:_TextMetrics._breakingSpaces.includes(n.charCodeAt(0))}static tokenize(n){const e=[];let t="";if(typeof n!="string")return e;for(let s=0;s<n.length;s++){const r=n[s],o=n[s+1];if(_TextMetrics.isBreakingSpace(r,o)||_TextMetrics.isNewline(r)){t!==""&&(e.push(t),t=""),e.push(r);continue}t+=r}return t!==""&&e.push(t),e}static canBreakWords(n,e){return e}static canBreakChars(n,e,t,s,r){return!0}static wordWrapSplit(n){return _TextMetrics.graphemeSegmenter(n)}static measureFont(n){if(_TextMetrics._fonts[n])return _TextMetrics._fonts[n];const e={ascent:0,descent:0,fontSize:0},t=_TextMetrics._canvas,s=_TextMetrics._context;s.font=n;const r=_TextMetrics.METRICS_STRING+_TextMetrics.BASELINE_SYMBOL,o=Math.ceil(s.measureText(r).width);let h=Math.ceil(s.measureText(_TextMetrics.BASELINE_SYMBOL).width);const c=Math.ceil(_TextMetrics.HEIGHT_MULTIPLIER*h);if(h=h*_TextMetrics.BASELINE_MULTIPLIER|0,o===0||c===0)return _TextMetrics._fonts[n]=e,e;t.width=o,t.height=c,s.fillStyle="#f00",s.fillRect(0,0,o,c),s.font=n,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,h);const a=s.getImageData(0,0,o,c).data,u=a.length,d=o*4;let p=0,m=0,g=!1;for(p=0;p<h;++p){for(let _=0;_<d;_+=4)if(a[m+_]!==255){g=!0;break}if(!g)m+=d;else break}for(e.ascent=h-p,m=u-d,g=!1,p=c;p>h;--p){for(let _=0;_<d;_+=4)if(a[m+_]!==255){g=!0;break}if(!g)m-=d;else break}return e.descent=p-h,e.fontSize=e.ascent+e.descent,_TextMetrics._fonts[n]=e,e}static clearMetrics(n=""){n?delete _TextMetrics._fonts[n]:_TextMetrics._fonts={}}static get _canvas(){if(!_TextMetrics.__canvas){let n;try{const e=new OffscreenCanvas(0,0),t=e.getContext("2d",contextSettings);if(t!=null&&t.measureText)return _TextMetrics.__canvas=e,e;n=settings$1.ADAPTER.createCanvas()}catch{n=settings$1.ADAPTER.createCanvas()}n.width=n.height=10,_TextMetrics.__canvas=n}return _TextMetrics.__canvas}static get _context(){return _TextMetrics.__context||(_TextMetrics.__context=_TextMetrics._canvas.getContext("2d",contextSettings)),_TextMetrics.__context}};let TextMetrics=_TextMetrics;TextMetrics.METRICS_STRING="|q";TextMetrics.BASELINE_SYMBOL="M";TextMetrics.BASELINE_MULTIPLIER=1.4;TextMetrics.HEIGHT_MULTIPLIER=2;TextMetrics.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return e=>[...n.segment(e)].map(t=>t.segment)}return n=>[...n]})();TextMetrics.experimentalLetterSpacing=!1;TextMetrics._fonts={};TextMetrics._newlines=[10,13];TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=class{constructor(n){this.styleID=0,this.reset(),deepCopyProperties(this,n,n)}clone(){const n={};return deepCopyProperties(n,this,_TextStyle.defaultStyle),new _TextStyle(n)}reset(){deepCopyProperties(this,_TextStyle.defaultStyle,_TextStyle.defaultStyle)}get align(){return this._align}set align(n){this._align!==n&&(this._align=n,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(n){this._breakWords!==n&&(this._breakWords=n,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(n){this._dropShadow!==n&&(this._dropShadow=n,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(n){this._dropShadowAlpha!==n&&(this._dropShadowAlpha=n,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(n){this._dropShadowAngle!==n&&(this._dropShadowAngle=n,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(n){this._dropShadowBlur!==n&&(this._dropShadowBlur=n,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(n){const e=getColor(n);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(n){this._dropShadowDistance!==n&&(this._dropShadowDistance=n,this.styleID++)}get fill(){return this._fill}set fill(n){const e=getColor(n);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(n){this._fillGradientType!==n&&(this._fillGradientType=n,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(n){areArraysEqual(this._fillGradientStops,n)||(this._fillGradientStops=n,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(n){this.fontFamily!==n&&(this._fontFamily=n,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(n){this._fontSize!==n&&(this._fontSize=n,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(n){this._fontStyle!==n&&(this._fontStyle=n,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(n){this._fontVariant!==n&&(this._fontVariant=n,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(n){this._fontWeight!==n&&(this._fontWeight=n,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(n){this._lineHeight!==n&&(this._lineHeight=n,this.styleID++)}get leading(){return this._leading}set leading(n){this._leading!==n&&(this._leading=n,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(n){this._lineJoin!==n&&(this._lineJoin=n,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(n){this._miterLimit!==n&&(this._miterLimit=n,this.styleID++)}get padding(){return this._padding}set padding(n){this._padding!==n&&(this._padding=n,this.styleID++)}get stroke(){return this._stroke}set stroke(n){const e=getColor(n);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(n){this._strokeThickness!==n&&(this._strokeThickness=n,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(n){this._textBaseline!==n&&(this._textBaseline=n,this.styleID++)}get trim(){return this._trim}set trim(n){this._trim!==n&&(this._trim=n,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(n){this._whiteSpace!==n&&(this._whiteSpace=n,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(n){this._wordWrap!==n&&(this._wordWrap=n,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(n){this._wordWrapWidth!==n&&(this._wordWrapWidth=n,this.styleID++)}toFontString(){const n=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let s=e[t].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!genericFontFamilies.includes(s)&&(s=`"${s}"`),e[t]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${n} ${e.join(",")}`}};let TextStyle=_TextStyle;TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function getSingleColor(n){return typeof n=="number"?hex2string(n):(typeof n=="string"&&n.startsWith("0x")&&(n=n.replace("0x","#")),n)}function getColor(n){if(Array.isArray(n)){for(let e=0;e<n.length;++e)n[e]=getSingleColor(n[e]);return n}else return getSingleColor(n)}function areArraysEqual(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function deepCopyProperties(n,e,t){for(const s in t)Array.isArray(e[s])?n[s]=e[s].slice():n[s]=e[s]}const defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=class extends Sprite{constructor(n,e,t){let s=!1;t||(t=settings$1.ADAPTER.createCanvas(),s=!0),t.width=3,t.height=3;const r=Texture.from(t);r.orig=new Rectangle,r.trim=new Rectangle,super(r),this._ownCanvas=s,this.canvas=t,this.context=t.getContext("2d",{willReadFrequently:!0}),this._resolution=_Text.defaultResolution??settings$1.RESOLUTION,this._autoResolution=_Text.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=n,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return TextMetrics.experimentalLetterSpacing}static set experimentalLetterSpacing(n){deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),TextMetrics.experimentalLetterSpacing=n}updateText(n){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&n)return;this._font=this._style.toFontString();const t=this.context,s=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=s.width,o=s.height,h=s.lines,c=s.lineHeight,a=s.lineWidths,u=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),t.scale(this._resolution,this._resolution),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.font=this._font,t.lineWidth=e.strokeThickness,t.textBaseline=e.textBaseline,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit;let p,m;const g=e.dropShadow?2:1;for(let _=0;_<g;++_){const y=e.dropShadow&&_===0,v=y?Math.ceil(Math.max(1,o)+e.padding*2):0,N=v*this._resolution;if(y){t.fillStyle="black",t.strokeStyle="black";const k=e.dropShadowColor,U=hex2rgb(typeof k=="number"?k:string2hex(k)),ee=e.dropShadowBlur*this._resolution,ie=e.dropShadowDistance*this._resolution;t.shadowColor=`rgba(${U[0]*255},${U[1]*255},${U[2]*255},${e.dropShadowAlpha})`,t.shadowBlur=ee,t.shadowOffsetX=Math.cos(e.dropShadowAngle)*ie,t.shadowOffsetY=Math.sin(e.dropShadowAngle)*ie+N}else t.fillStyle=this._generateFillStyle(e,h,s),t.strokeStyle=e.stroke,t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;let w=(c-d.fontSize)/2;c-d.fontSize<0&&(w=0);for(let k=0;k<h.length;k++)p=e.strokeThickness/2,m=e.strokeThickness/2+k*c+d.ascent+w,e.align==="right"?p+=u-a[k]:e.align==="center"&&(p+=(u-a[k])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[k],p+e.padding,m+e.padding-v,!0),e.fill&&this.drawLetterSpacing(h[k],p+e.padding,m+e.padding-v)}this.updateTexture()}drawLetterSpacing(n,e,t,s=!1){const o=this._style.letterSpacing;let h=!1;if(TextMetrics.experimentalLetterSpacingSupported&&(TextMetrics.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,h=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||h){s?this.context.strokeText(n,e,t):this.context.fillText(n,e,t);return}let c=e;const a=TextMetrics.graphemeSegmenter(n);let u=this.context.measureText(n).width,d=0;for(let p=0;p<a.length;++p){const m=a[p];s?this.context.strokeText(m,c,t):this.context.fillText(m,c,t);let g="";for(let _=p+1;_<a.length;++_)g+=a[_];d=this.context.measureText(g).width,c+=u-d+o,u=d}}updateTexture(){const n=this.canvas;if(this._style.trim){const o=trimCanvas(n);o.data&&(n.width=o.width,n.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,t=this._style,s=t.trim?0:t.padding,r=e.baseTexture;e.trim.width=e._frame.width=n.width/this._resolution,e.trim.height=e._frame.height=n.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),r.setRealSize(n.width,n.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(n){this._autoResolution&&this._resolution!==n.resolution&&(this._resolution=n.resolution,this.dirty=!0),this.updateText(!0),super._render(n)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(n,e){return this.updateText(!0),this._textureID===-1&&(n=!1),super.getBounds(n,e)}getLocalBounds(n){return this.updateText(!0),super.getLocalBounds.call(this,n)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(n,e,t){const s=n.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let r;const o=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,c=this.canvas.width/this._resolution-o-h*2,a=this.canvas.height/this._resolution-o-h*2,u=s.slice(),d=n.fillGradientStops.slice();if(!d.length){const p=u.length+1;for(let m=1;m<p;++m)d.push(m/p)}if(u.unshift(s[0]),d.unshift(0),u.push(s[s.length-1]),d.push(1),n.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(c/2,h,c/2,a+h);const p=t.fontProperties.fontSize+n.strokeThickness;for(let m=0;m<e.length;m++){const g=t.lineHeight*(m-1)+p,_=t.lineHeight*m;let y=_;m>0&&g>_&&(y=(_+g)/2);const v=_+p,N=t.lineHeight*(m+1);let w=v;m+1<e.length&&N<v&&(w=(v+N)/2);const k=(w-y)/a;for(let U=0;U<u.length;U++){let ee=0;typeof d[U]=="number"?ee=d[U]:ee=U/u.length;let ie=Math.min(1,Math.max(0,y/a+ee*k));ie=Number(ie.toFixed(5)),r.addColorStop(ie,u[U])}}}else{r=this.context.createLinearGradient(h,a/2,c+h,a/2);const p=u.length+1;let m=1;for(let g=0;g<u.length;g++){let _;typeof d[g]=="number"?_=d[g]:_=m/p,r.addColorStop(_,u[g]),m++}}return r}destroy(n){typeof n=="boolean"&&(n={children:n}),n=Object.assign({},defaultDestroyOptions,n),super.destroy(n),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(n){this.updateText(!0);const e=sign(this.scale.x)||1;this.scale.x=e*n/this._texture.orig.width,this._width=n}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(n){this.updateText(!0);const e=sign(this.scale.y)||1;this.scale.y=e*n/this._texture.orig.height,this._height=n}get style(){return this._style}set style(n){n=n||{},n instanceof TextStyle?this._style=n:this._style=new TextStyle(n),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(n){n=String(n??""),this._text!==n&&(this._text=n,this.dirty=!0)}get resolution(){return this._resolution}set resolution(n){this._autoResolution=!1,this._resolution!==n&&(this._resolution=n,this.dirty=!0)}};let Text=_Text;Text.defaultAutoResolution=!0;class CountLimiter{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function findMultipleBaseTextures(n,e){var s;let t=!1;if((s=n==null?void 0:n._textures)!=null&&s.length){for(let r=0;r<n._textures.length;r++)if(n._textures[r]instanceof Texture){const o=n._textures[r].baseTexture;e.includes(o)||(e.push(o),t=!0)}}return t}function findBaseTexture(n,e){if(n.baseTexture instanceof BaseTexture){const t=n.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function findTexture(n,e){if(n._texture&&n._texture instanceof Texture){const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function drawText(n,e){return e instanceof Text?(e.updateText(!0),!0):!1}function calculateTextStyle(n,e){if(e instanceof TextStyle){const t=e.toFontString();return TextMetrics.measureFont(t),!0}return!1}function findText(n,e){if(n instanceof Text){e.includes(n.style)||e.push(n.style),e.includes(n)||e.push(n);const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function findTextStyle(n,e){return n instanceof TextStyle?(e.includes(n)||e.push(n),!0):!1}const _BasePrepare=class{constructor(n){this.limiter=new CountLimiter(_BasePrepare.uploadsPerFrame),this.renderer=n,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(n){return new Promise(e=>{n&&this.add(n),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const n=this.queue[0];let e=!1;if(n&&!n._destroyed){for(let t=0,s=this.uploadHooks.length;t<s;t++)if(this.uploadHooks[t](this.uploadHookHelper,n)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;const n=this.completes.slice(0);this.completes.length=0;for(let e=0,t=n.length;e<t;e++)n[e]()}}registerFindHook(n){return n&&this.addHooks.push(n),this}registerUploadHook(n){return n&&this.uploadHooks.push(n),this}add(n){for(let e=0,t=this.addHooks.length;e<t&&!this.addHooks[e](n,this.queue);e++);if(n instanceof Container)for(let e=n.children.length-1;e>=0;e--)this.add(n.children[e]);return this}destroy(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let BasePrepare=_BasePrepare;BasePrepare.uploadsPerFrame=4;Object.defineProperties(settings$1,{UPLOADS_PER_FRAME:{get(){return BasePrepare.uploadsPerFrame},set(n){deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),BasePrepare.uploadsPerFrame=n}}});function uploadBaseTextures(n,e){return e instanceof BaseTexture?(e._glTextures[n.CONTEXT_UID]||n.texture.bind(e),!0):!1}function uploadGraphics(n,e){if(!(e instanceof Graphics))return!1;const{geometry:t}=e;e.finishPoly(),t.updateBatches();const{batches:s}=t;for(let r=0;r<s.length;r++){const{texture:o}=s[r].style;o&&uploadBaseTextures(n,o.baseTexture)}return t.batchable||n.geometry.bind(t,e._resolveDirectShader(n)),!0}function findGraphics(n,e){return n instanceof Graphics?(e.push(n),!0):!1}class Prepare extends BasePrepare{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}}Prepare.extension={name:"prepare",type:ExtensionType.RendererSystem};extensions$1.add(Prepare);new Point;var gl2FragmentSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,gl2VertexSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gl1FragmentSrc=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gl1VertexSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fragmentSimpleSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const tempMat=new Matrix;class TilingSpriteRenderer extends ObjectRenderer{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new QuadUv,this.state=State$1.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,fragmentSimpleSrc,t),this.shader=e.context.webGLVersion>1?Shader.from(gl2VertexSrc,gl2FragmentSrc,t):Shader.from(gl1VertexSrc,gl1FragmentSrc,t)}render(e){const t=this.renderer,s=this.quad;let r=s.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const o=e.uvRespectAnchor?e.anchor.x:0,h=e.uvRespectAnchor?e.anchor.y:0;r=s.uvs,r[0]=r[6]=-o,r[1]=r[3]=-h,r[2]=r[4]=1-o,r[5]=r[7]=1-h,s.invalidate();const c=e._texture,a=c.baseTexture,u=a.alphaMode>0,d=e.tileTransform.localTransform,p=e.uvMatrix;let m=a.isPowerOfTwo&&c.frame.width===a.width&&c.frame.height===a.height;m&&(a._glTextures[t.CONTEXT_UID]?m=a.wrapMode!==WRAP_MODES.CLAMP:a.wrapMode===WRAP_MODES.CLAMP&&(a.wrapMode=WRAP_MODES.REPEAT));const g=m?this.simpleShader:this.shader,_=c.width,y=c.height,v=e._width,N=e._height;tempMat.set(d.a*_/v,d.b*_/N,d.c*y/v,d.d*y/N,d.tx/v,d.ty/N),tempMat.invert(),m?tempMat.prepend(p.mapCoord):(g.uniforms.uMapCoord=p.mapCoord.toArray(!0),g.uniforms.uClampFrame=p.uClampFrame,g.uniforms.uClampOffset=p.uClampOffset),g.uniforms.uTransform=tempMat.toArray(!0),g.uniforms.uColor=premultiplyTintToRgba(e.tint,e.worldAlpha,g.uniforms.uColor,u),g.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),g.uniforms.uSampler=c,t.shader.bind(g),t.geometry.bind(s),this.state.blendMode=correctBlendMode(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}TilingSpriteRenderer.extension={name:"tilingSprite",type:ExtensionType.RendererPlugin};extensions$1.add(TilingSpriteRenderer);const _Spritesheet=class{constructor(n,e,t=null){this.linkedSheets=[],this._texture=n instanceof Texture?n:null,this.baseTexture=n instanceof BaseTexture?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const s=this.baseTexture.resource;this.resolution=this._updateResolution(t||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(n=null){const{scale:e}=this.data.meta;let t=getResolutionOfUrl(n,null);return t===null&&(t=parseFloat(e??"1")),t!==1&&this.baseTexture.setResolution(t),t}parse(){return new Promise(n=>{this._callback=n,this._batchIndex=0,this._frameKeys.length<=_Spritesheet.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(n){let e=n;const t=_Spritesheet.BATCH_SIZE;for(;e-n<t&&e<this._frameKeys.length;){const s=this._frameKeys[e],r=this._frames[s],o=r.frame;if(o){let h=null,c=null;const a=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,u=new Rectangle(0,0,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution);r.rotated?h=new Rectangle(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):h=new Rectangle(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(c=new Rectangle(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new Texture(this.baseTexture,h,u,c,r.rotated?2:0,r.anchor),Texture.addToCache(this.textures[s],s)}e++}}_processAnimations(){const n=this.data.animations||{};for(const e in n){this.animations[e]=[];for(let t=0;t<n[e].length;t++){const s=n[e][t];this.animations[e].push(this.textures[s])}}}_parseComplete(){const n=this._callback;this._callback=null,this._batchIndex=0,n.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_Spritesheet.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_Spritesheet.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(n=!1){var e;for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,n&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Spritesheet=_Spritesheet;Spritesheet.BATCH_SIZE=1e3;const validImages=["jpg","png","jpeg","avif","webp"];function getCacheableAssets(n,e,t){const s={};if(n.forEach(r=>{s[r]=e}),Object.keys(e.textures).forEach(r=>{s[r]=e.textures[r]}),!t){const r=path$1.dirname(n[0]);e.linkedSheets.forEach((o,h)=>{const c=getCacheableAssets([`${r}/${e.data.meta.related_multi_packs[h]}`],o,!0);Object.assign(s,c)})}return s}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:n=>n instanceof Spritesheet,getCacheableAssets:(n,e)=>getCacheableAssets(n,e,!1)},resolver:{test:n=>{const t=n.split("?")[0].split("."),s=t.pop(),r=t.pop();return s==="json"&&validImages.includes(r)},parse:n=>{var t;const e=n.split(".");return{resolution:parseFloat(((t=settings$1.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:e[e.length-2],src:n}}},loader:{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},async testParse(n,e){return path$1.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){var u,d;let s=path$1.dirname(e.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let r=s+n.meta.image;r=copySearchParams(r,e.src);const h=(await t.load([r]))[r],c=new Spritesheet(h.baseTexture,n,e.src);await c.parse();const a=(u=n==null?void 0:n.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(a)){const p=[];for(const g of a){if(typeof g!="string")continue;let _=s+g;(d=e.data)!=null&&d.ignoreMultiPack||(_=copySearchParams(_,e.src),p.push(t.load({src:_,data:{ignoreMultiPack:!0}})))}const m=await Promise.all(p);c.linkedSheets=m,m.forEach(g=>{g.linkedSheets=[c].concat(c.linkedSheets.filter(_=>_!==g))})}return c},unload(n){n.destroy(!0)}}};extensions$1.add(spritesheetAsset);class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class TextFormat{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in t){const h=t[o].match(/^[a-z]+/gm)[0],c=t[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(const u in c){const d=c[u].split("="),p=d[0],m=d[1].replace(/"/gm,""),g=parseFloat(m),_=isNaN(g)?m:g;a[p]=_}s[h].push(a)}const r=new BitmapFontData;return s.info.forEach(o=>r.info.push({face:o.face,size:parseInt(o.size,10)})),s.common.forEach(o=>r.common.push({lineHeight:parseInt(o.lineHeight,10)})),s.page.forEach(o=>r.page.push({id:parseInt(o.id,10),file:o.file})),s.char.forEach(o=>r.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),s.kerning.forEach(o=>r.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),s.distanceField.forEach(o=>r.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),r}}class XMLFormat{static test(e){const t=e;return"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const t=new BitmapFontData,s=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),o=e.getElementsByTagName("page"),h=e.getElementsByTagName("char"),c=e.getElementsByTagName("kerning"),a=e.getElementsByTagName("distanceField");for(let u=0;u<s.length;u++)t.info.push({face:s[u].getAttribute("face"),size:parseInt(s[u].getAttribute("size"),10)});for(let u=0;u<r.length;u++)t.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(let u=0;u<o.length;u++)t.page.push({id:parseInt(o[u].getAttribute("id"),10)||0,file:o[u].getAttribute("file")});for(let u=0;u<h.length;u++){const d=h[u];t.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<c.length;u++)t.kerning.push({first:parseInt(c[u].getAttribute("first"),10),second:parseInt(c[u].getAttribute("second"),10),amount:parseInt(c[u].getAttribute("amount"),10)});for(let u=0;u<a.length;u++)t.distanceField.push({fieldType:a[u].getAttribute("fieldType"),distanceRange:parseInt(a[u].getAttribute("distanceRange"),10)});return t}}class XMLStringFormat{static test(e){return typeof e=="string"&&e.includes("<font>")?XMLFormat.test(settings$1.ADAPTER.parseXML(e)):!1}static parse(e){return XMLFormat.parse(settings$1.ADAPTER.parseXML(e))}}const formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(n){for(let e=0;e<formats.length;e++)if(formats[e].test(n))return formats[e];return null}function generateFillStyle(n,e,t,s,r,o){const h=t.fill;if(Array.isArray(h)){if(h.length===1)return h[0]}else return h;let c;const a=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,d=n.width/s-a-u*2,p=n.height/s-a-u*2,m=h.slice(),g=t.fillGradientStops.slice();if(!g.length){const _=m.length+1;for(let y=1;y<_;++y)g.push(y/_)}if(m.unshift(h[0]),g.unshift(0),m.push(h[h.length-1]),g.push(1),t.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){c=e.createLinearGradient(d/2,u,d/2,p+u);let _=0;const v=(o.fontProperties.fontSize+t.strokeThickness)/p;for(let N=0;N<r.length;N++){const w=o.lineHeight*N;for(let k=0;k<m.length;k++){let U=0;typeof g[k]=="number"?U=g[k]:U=k/m.length;const ee=w/p+U*v;let ie=Math.max(_,ee);ie=Math.min(ie,1),c.addColorStop(ie,m[k]),_=ie}}}else{c=e.createLinearGradient(u,p/2,d+u,p/2);const _=m.length+1;let y=1;for(let v=0;v<m.length;v++){let N;typeof g[v]=="number"?N=g[v]:N=y/_,c.addColorStop(N,m[v]),y++}}return c}function drawGlyph(n,e,t,s,r,o,h){const c=t.text,a=t.fontProperties;e.translate(s,r),e.scale(o,o);const u=h.strokeThickness/2,d=-(h.strokeThickness/2);if(e.font=h.toFontString(),e.lineWidth=h.strokeThickness,e.textBaseline=h.textBaseline,e.lineJoin=h.lineJoin,e.miterLimit=h.miterLimit,e.fillStyle=generateFillStyle(n,e,h,o,[c],t),e.strokeStyle=h.stroke,h.dropShadow){const p=h.dropShadowColor,m=hex2rgb(typeof p=="number"?p:string2hex(p)),g=h.dropShadowBlur*o,_=h.dropShadowDistance*o;e.shadowColor=`rgba(${m[0]*255},${m[1]*255},${m[2]*255},${h.dropShadowAlpha})`,e.shadowBlur=g,e.shadowOffsetX=Math.cos(h.dropShadowAngle)*_,e.shadowOffsetY=Math.sin(h.dropShadowAngle)*_}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;h.stroke&&h.strokeThickness&&e.strokeText(c,u,d+t.lineHeight-a.descent),h.fill&&e.fillText(c,u,d+t.lineHeight-a.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function extractCharCode(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}function splitTextToCharacters(n){return Array.from?Array.from(n):n.split("")}function resolveCharacters(n){typeof n=="string"&&(n=[n]);const e=[];for(let t=0,s=n.length;t<s;t++){const r=n[t];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const o=r[0].charCodeAt(0),h=r[1].charCodeAt(0);if(h<o)throw new Error("[BitmapFont]: Invalid character range.");for(let c=o,a=h;c<=a;c++)e.push(String.fromCharCode(c))}else e.push(...splitTextToCharacters(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const _BitmapFont=class{constructor(n,e,t){var u;const[s]=n.info,[r]=n.common,[o]=n.page,[h]=n.distanceField,c=getResolutionOfUrl(o.file),a={};this._ownsTextures=t,this.font=s.face,this.size=s.size,this.lineHeight=r.lineHeight/c,this.chars={},this.pageTextures=a;for(let d=0;d<n.page.length;d++){const{id:p,file:m}=n.page[d];a[p]=e instanceof Array?e[d]:e[m],h!=null&&h.fieldType&&h.fieldType!=="none"&&(a[p].baseTexture.alphaMode=ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,a[p].baseTexture.mipmap=MIPMAP_MODES.OFF)}for(let d=0;d<n.char.length;d++){const{id:p,page:m}=n.char[d];let{x:g,y:_,width:y,height:v,xoffset:N,yoffset:w,xadvance:k}=n.char[d];g/=c,_/=c,y/=c,v/=c,N/=c,w/=c,k/=c;const U=new Rectangle(g+a[m].frame.x/c,_+a[m].frame.y/c,y,v);this.chars[p]={xOffset:N,yOffset:w,xAdvance:k,kerning:{},texture:new Texture(a[m].baseTexture,U),page:m}}for(let d=0;d<n.kerning.length;d++){let{first:p,second:m,amount:g}=n.kerning[d];p/=c,m/=c,g/=c,this.chars[m]&&(this.chars[m].kerning[p]=g)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((u=h==null?void 0:h.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const n in this.chars)this.chars[n].texture.destroy(),this.chars[n].texture=null;for(const n in this.pageTextures)this._ownsTextures&&this.pageTextures[n].destroy(!0),this.pageTextures[n]=null;this.chars=null,this.pageTextures=null}static install(n,e,t){let s;if(n instanceof BitmapFontData)s=n;else{const o=autoDetectFormat(n);if(!o)throw new Error("Unrecognized data format for font.");s=o.parse(n)}e instanceof Texture&&(e=[e]);const r=new _BitmapFont(s,e,t);return _BitmapFont.available[r.font]=r,r}static uninstall(n){const e=_BitmapFont.available[n];if(!e)throw new Error(`No font found named '${n}'`);e.destroy(),delete _BitmapFont.available[n]}static from(n,e,t){if(!n)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:r,resolution:o,textureWidth:h,textureHeight:c,...a}=Object.assign({},_BitmapFont.defaultOptions,t),u=resolveCharacters(s),d=e instanceof TextStyle?e:new TextStyle(e),p=h,m=new BitmapFontData;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};let g=0,_=0,y,v,N,w=0;const k=[];for(let ee=0;ee<u.length;ee++){y||(y=settings$1.ADAPTER.createCanvas(),y.width=h,y.height=c,v=y.getContext("2d"),N=new BaseTexture(y,{resolution:o,...a}),k.push(new Texture(N)),m.page.push({id:k.length-1,file:""}));const ie=u[ee],se=TextMetrics.measureText(ie,d,!1,y),oe=se.width,le=Math.ceil(se.height),ue=Math.ceil((d.fontStyle==="italic"?2:1)*oe);if(_>=c-le*o){if(_===0)throw new Error(`[BitmapFont] textureHeight ${c}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${ie}')`);--ee,y=null,v=null,N=null,_=0,g=0,w=0;continue}if(w=Math.max(le+se.fontProperties.descent,w),ue*o+g>=p){if(g===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${ie}')`);--ee,_+=w*o,_=Math.ceil(_),g=0,w=0;continue}drawGlyph(y,v,se,g,_,o,d);const he=extractCharCode(se.text);m.char.push({id:he,page:k.length-1,x:g/o,y:_/o,width:ue,height:le,xoffset:0,yoffset:0,xadvance:oe-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),g+=(ue+2*r)*o,g=Math.ceil(g)}for(let ee=0,ie=u.length;ee<ie;ee++){const se=u[ee];for(let oe=0;oe<ie;oe++){const le=u[oe],ue=v.measureText(se).width,he=v.measureText(le).width,de=v.measureText(se+le).width-(ue+he);de&&m.kerning.push({first:extractCharCode(se),second:extractCharCode(le),amount:de})}}const U=new _BitmapFont(m,k,!0);return _BitmapFont.available[n]!==void 0&&_BitmapFont.uninstall(n),_BitmapFont.available[n]=U,U}};let BitmapFont=_BitmapFont;BitmapFont.ALPHA=[["a","z"],["A","Z"]," "];BitmapFont.NUMERIC=[["0","9"]];BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];BitmapFont.ASCII=[[" ","~"]];BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC};BitmapFont.available={};var msdfFrag=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,msdfVert=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=class extends Container{constructor(n,e={}){super(),this._tint=16777215;const{align:t,tint:s,maxWidth:r,letterSpacing:o,fontName:h,fontSize:c}=Object.assign({},_BitmapText.styleDefaults,e);if(!BitmapFont.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=t,this._tint=s,this._font=void 0,this._fontName=h,this._fontSize=c,this.text=n,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new ObservablePoint(()=>{this.dirty=!0},this,0,0),this._roundPixels=settings$1.ROUND_PIXELS,this.dirty=!0,this._resolution=settings$1.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var ue;const n=BitmapFont.available[this._fontName],e=this.fontSize,t=e/n.size,s=new Point,r=[],o=[],h=[],c=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",a=splitTextToCharacters(c),u=this._maxWidth*n.size/e,d=n.distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;let p=null,m=0,g=0,_=0,y=-1,v=0,N=0,w=0,k=0;for(let he=0;he<a.length;he++){const pe=a[he],de=extractCharCode(pe);if(/(?:\s)/.test(pe)&&(y=he,v=m,k++),pe==="\r"||pe===`
`){o.push(m),h.push(-1),g=Math.max(g,m),++_,++N,s.x=0,s.y+=n.lineHeight,p=null,k=0;continue}const fe=n.chars[de];if(!fe)continue;p&&fe.kerning[p]&&(s.x+=fe.kerning[p]);const Te=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point};Te.texture=fe.texture,Te.line=_,Te.charCode=de,Te.position.x=Math.round(s.x+fe.xOffset+this._letterSpacing/2),Te.position.y=Math.round(s.y+fe.yOffset),Te.prevSpaces=k,r.push(Te),m=Te.position.x+Math.max(fe.xAdvance-fe.xOffset,fe.texture.orig.width),s.x+=fe.xAdvance+this._letterSpacing,w=Math.max(w,fe.yOffset+fe.texture.height),p=de,y!==-1&&u>0&&s.x>u&&(++N,removeItems(r,1+y-N,1+he-y),he=y,y=-1,o.push(v),h.push(r.length>0?r[r.length-1].prevSpaces:0),g=Math.max(g,v),_++,s.x=0,s.y+=n.lineHeight,p=null,k=0)}const U=a[a.length-1];U!=="\r"&&U!==`
`&&(/(?:\s)/.test(U)&&(m=v),o.push(m),g=Math.max(g,m),h.push(-1));const ee=[];for(let he=0;he<=_;he++){let pe=0;this._align==="right"?pe=g-o[he]:this._align==="center"?pe=(g-o[he])/2:this._align==="justify"&&(pe=h[he]<0?0:(g-o[he])/h[he]),ee.push(pe)}const ie=r.length,se={},oe=[],le=this._activePagesMeshData;d.push(...le);for(let he=0;he<ie;he++){const pe=r[he].texture,de=pe.baseTexture.uid;if(!se[de]){let fe=d.pop();if(!fe){const Ce=new MeshGeometry;let be,Ae;n.distanceFieldType==="none"?(be=new MeshMaterial(Texture.EMPTY),Ae=BLEND_MODES.NORMAL):(be=new MeshMaterial(Texture.EMPTY,{program:Program.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),Ae=BLEND_MODES.NORMAL_NPM);const Pe=new Mesh(Ce,be);Pe.blendMode=Ae,fe={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Pe,vertices:null,uvs:null,indices:null}}fe.index=0,fe.indexCount=0,fe.vertexCount=0,fe.uvsCount=0,fe.total=0;const{_textureCache:Te}=this;Te[de]=Te[de]||new Texture(pe.baseTexture),fe.mesh.texture=Te[de],fe.mesh.tint=this._tint,oe.push(fe),se[de]=fe}se[de].total++}for(let he=0;he<le.length;he++)oe.includes(le[he])||this.removeChild(le[he].mesh);for(let he=0;he<oe.length;he++)oe[he].mesh.parent!==this&&this.addChild(oe[he].mesh);this._activePagesMeshData=oe;for(const he in se){const pe=se[he],de=pe.total;if(!(((ue=pe.indices)==null?void 0:ue.length)>6*de)||pe.vertices.length<Mesh.BATCHABLE_SIZE*2)pe.vertices=new Float32Array(4*2*de),pe.uvs=new Float32Array(4*2*de),pe.indices=new Uint16Array(6*de);else{const fe=pe.total,Te=pe.vertices;for(let Ce=fe*4*2;Ce<Te.length;Ce++)Te[Ce]=0}pe.mesh.size=6*de}for(let he=0;he<ie;he++){const pe=r[he];let de=pe.position.x+ee[pe.line]*(this._align==="justify"?pe.prevSpaces:1);this._roundPixels&&(de=Math.round(de));const fe=de*t,Te=pe.position.y*t,Ce=pe.texture,be=se[Ce.baseTexture.uid],Ae=Ce.frame,Pe=Ce._uvs,xe=be.index++;be.indices[xe*6+0]=0+xe*4,be.indices[xe*6+1]=1+xe*4,be.indices[xe*6+2]=2+xe*4,be.indices[xe*6+3]=0+xe*4,be.indices[xe*6+4]=2+xe*4,be.indices[xe*6+5]=3+xe*4,be.vertices[xe*8+0]=fe,be.vertices[xe*8+1]=Te,be.vertices[xe*8+2]=fe+Ae.width*t,be.vertices[xe*8+3]=Te,be.vertices[xe*8+4]=fe+Ae.width*t,be.vertices[xe*8+5]=Te+Ae.height*t,be.vertices[xe*8+6]=fe,be.vertices[xe*8+7]=Te+Ae.height*t,be.uvs[xe*8+0]=Pe.x0,be.uvs[xe*8+1]=Pe.y0,be.uvs[xe*8+2]=Pe.x1,be.uvs[xe*8+3]=Pe.y1,be.uvs[xe*8+4]=Pe.x2,be.uvs[xe*8+5]=Pe.y2,be.uvs[xe*8+6]=Pe.x3,be.uvs[xe*8+7]=Pe.y3}this._textWidth=g*t,this._textHeight=(s.y+n.lineHeight)*t;for(const he in se){const pe=se[he];if(this.anchor.x!==0||this.anchor.y!==0){let Ce=0;const be=this._textWidth*this.anchor.x,Ae=this._textHeight*this.anchor.y;for(let Pe=0;Pe<pe.total;Pe++)pe.vertices[Ce++]-=be,pe.vertices[Ce++]-=Ae,pe.vertices[Ce++]-=be,pe.vertices[Ce++]-=Ae,pe.vertices[Ce++]-=be,pe.vertices[Ce++]-=Ae,pe.vertices[Ce++]-=be,pe.vertices[Ce++]-=Ae}this._maxLineHeight=w*t;const de=pe.mesh.geometry.getBuffer("aVertexPosition"),fe=pe.mesh.geometry.getBuffer("aTextureCoord"),Te=pe.mesh.geometry.getIndex();de.data=pe.vertices,fe.data=pe.uvs,Te.data=pe.indices,de.update(),fe.update(),Te.update()}for(let he=0;he<r.length;he++)charRenderDataPool.push(r[he]);this._font=n,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(n){this._autoResolution&&this._resolution!==n.resolution&&(this._resolution=n.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:t,size:s}=BitmapFont.available[this._fontName];if(t!=="none"){const{a:r,b:o,c:h,d:c}=this.worldTransform,a=Math.sqrt(r*r+o*o),u=Math.sqrt(h*h+c*c),d=(Math.abs(a)+Math.abs(u))/2,p=this.fontSize/s,m=n._view.resolution;for(const g of this._activePagesMeshData)g.mesh.shader.uniforms.uFWidth=d*e*p*m}super._render(n)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const n=BitmapFont.available[this._fontName];if(!n)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==n&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(n){if(this._tint!==n){this._tint=n;for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=n}}get align(){return this._align}set align(n){this._align!==n&&(this._align=n,this.dirty=!0)}get fontName(){return this._fontName}set fontName(n){if(!BitmapFont.available[n])throw new Error(`Missing BitmapFont "${n}"`);this._fontName!==n&&(this._fontName=n,this.dirty=!0)}get fontSize(){return this._fontSize??BitmapFont.available[this._fontName].size}set fontSize(n){this._fontSize!==n&&(this._fontSize=n,this.dirty=!0)}get anchor(){return this._anchor}set anchor(n){typeof n=="number"?this._anchor.set(n):this._anchor.copyFrom(n)}get text(){return this._text}set text(n){n=String(n??""),this._text!==n&&(this._text=n,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(n){this._maxWidth!==n&&(this._maxWidth=n,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(n){this._letterSpacing!==n&&(this._letterSpacing=n,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(n){n!==this._roundPixels&&(this._roundPixels=n,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(n){this._autoResolution=!1,this._resolution!==n&&(this._resolution=n,this.dirty=!0)}destroy(n){const{_textureCache:e}=this,s=BitmapFont.available[this._fontName].distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;s.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],s.filter(r=>e[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=Texture.EMPTY});for(const r in e)e[r].destroy(),delete e[r];this._font=null,this._textureCache=null,super.destroy(n)}};let BitmapText=_BitmapText;BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const validExtensions=[".xml",".fnt"],loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},test(n){return validExtensions.includes(path$1.extname(n).toLowerCase())},async testParse(n){return TextFormat.test(n)||XMLStringFormat.test(n)},async parse(n,e,t){const s=TextFormat.test(n)?TextFormat.parse(n):XMLStringFormat.parse(n),{src:r}=e,{page:o}=s,h=[];for(let u=0;u<o.length;++u){const d=o[u].file;let p=path$1.join(path$1.dirname(r),d);p=copySearchParams(p,r),h.push(p)}const c=await t.load(h),a=h.map(u=>c[u]);return BitmapFont.install(s,a,!0)},async load(n,e){return(await settings$1.ADAPTER.fetch(n)).text()},unload(n){n.destroy()}};extensions$1.add(loadBitmapFont);let assetsManifest={bundles:[]};const loadedBundles=[];function checkBundleExists(n){return!!assetsManifest.bundles.find(e=>e.name===n)}async function loadBundles(n){typeof n=="string"&&(n=[n]);for(const t of n)if(!checkBundleExists(t))throw new Error(`[Assets] Invalid bundle: ${t}`);const e=n.filter(t=>!loadedBundles.includes(t));e.length&&(console.log("[Assets] Load:",e.join(", ")),await Assets.loadBundle(e),loadedBundles.push(...e))}function areBundlesLoaded(n){for(const e of n)if(!loadedBundles.includes(e))return!1;return!0}async function fetchAssetsManifest(n){const t=await(await fetch(n)).json();if(!t.bundles)throw new Error("[Assets] Invalid assets manifest");return t}async function initAssets(){assetsManifest=await fetchAssetsManifest("assets/assets-manifest.json"),await Assets.init({manifest:assetsManifest,basePath:"assets"}),await loadBundles(["preload","default"]);const n=assetsManifest.bundles.map(e=>e.name);Assets.backgroundLoadBundle(n)}class Pool{constructor(e){ne(this,"ctor");ne(this,"list",[]);this.ctor=e}get(){return this.list.pop()??new this.ctor}giveBack(e){this.list.includes(e)||this.list.push(e)}}class MultiPool{constructor(){ne(this,"map",new Map)}get(e){let t=this.map.get(e);return t||(t=new Pool(e),this.map.set(e,t)),t.get()}giveBack(e){const t=this.map.get(e.constructor);t&&t.giveBack(e)}}const pool=new MultiPool;class Navigation{constructor(){ne(this,"container",new Container);ne(this,"width",0);ne(this,"height",0);ne(this,"background");ne(this,"currentScreen");ne(this,"currentPopup")}setBackground(e){this.background=new e,this.addAndShowScreen(this.background)}async addAndShowScreen(e){this.container.parent||app.stage.addChild(this.container),this.container.addChild(e),e.prepare&&e.prepare(),e.resize&&e.resize(this.width,this.height),e.update&&app.ticker.add(e.update,e),e.show&&(e.interactiveChildren=!1,await e.show(),e.interactiveChildren=!0)}async hideAndRemoveScreen(e){e.interactiveChildren=!1,e.hide&&await e.hide(),e.update&&app.ticker.remove(e.update,e),e.parent&&e.parent.removeChild(e),e.reset&&e.reset()}async showScreen(e){this.currentScreen&&(this.currentScreen.interactiveChildren=!1),e.assetBundles&&!areBundlesLoaded(e.assetBundles)&&await loadBundles(e.assetBundles),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=pool.get(e),await this.addAndShowScreen(this.currentScreen)}resize(e,t){var s,r,o,h,c,a;this.width=e,this.height=t,(r=(s=this.currentScreen)==null?void 0:s.resize)==null||r.call(s,e,t),(h=(o=this.currentPopup)==null?void 0:o.resize)==null||h.call(o,e,t),(a=(c=this.background)==null?void 0:c.resize)==null||a.call(c,e,t)}async presentPopup(e){var t,s;this.currentScreen&&await((s=(t=this.currentScreen).pause)==null?void 0:s.call(t)),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),this.currentPopup=new e,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var t,s;if(!this.currentPopup)return;const e=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(e),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(s=(t=this.currentScreen).resume)==null||s.call(t))}blur(){var e,t,s,r,o,h;(t=(e=this.currentScreen)==null?void 0:e.blur)==null||t.call(e),(r=(s=this.currentPopup)==null?void 0:s.blur)==null||r.call(s),(h=(o=this.background)==null?void 0:o.blur)==null||h.call(o)}focus(){var e,t,s,r,o,h;(t=(e=this.currentScreen)==null?void 0:e.focus)==null||t.call(e),(r=(s=this.currentPopup)==null?void 0:s.focus)==null||r.call(s),(h=(o=this.background)==null?void 0:o.focus)==null||h.call(o)}}const navigation=new Navigation;function waitFor(n=1){return new Promise(e=>{setTimeout(()=>e(),n*1e3)})}let O;function nt(n){return O=n,n}function l(){return O}let ot=0;const F=class extends eventemitter3Exports{constructor(n){super(),this.id=ot++,this.init(n)}set(n,e){if(this[n]===void 0)throw new Error(`Property with name ${n} does not exist.`);switch(n){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"paused":this.paused=e;break;case"loop":this.loop=e;break;case"muted":this.muted=e;break}return this}get progress(){const{currentTime:n}=this._source;return n/this._duration}get paused(){return this._paused}set paused(n){this._paused=n,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(n){this._playing=!1,this._duration=n.source.duration;const e=this._source=n.source.cloneNode(!1);e.src=n.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),n.context.on("refresh",this.refresh,this),n.context.on("refreshPaused",this.refreshPaused,this),this._media=n}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(n){this._speed=n,this.refresh()}get volume(){return this._volume}set volume(n){this._volume=n,this.refresh()}get loop(){return this._loop}set loop(n){this._loop=n,this.refresh()}get muted(){return this._muted}set muted(n){this._muted=n,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(n){console.warn("HTML Audio does not support filters")}refresh(){const n=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const t=n.volume*(n.muted?0:1),s=e.volume*(e.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*t*s,this._source.playbackRate=this._speed*n.speed*e.speed}refreshPaused(){const n=this._media.context,e=this._media.parent,t=this._paused||e.paused||n.paused;t!==this._pausedReal&&(this._pausedReal=t,t?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",t))}play(n){const{start:e,end:t,speed:s,loop:r,volume:o,muted:h}=n;t&&console.assert(t>e,"End time is before start time"),this._speed=s,this._volume=o,this._loop=!!r,this._muted=h,this.refresh(),this.loop&&t!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=e,this._end=t||this._duration,this._start=Math.max(0,this._start-F.PADDING),this._end=Math.min(this._end+F.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=e,this._source.onloadedmetadata=null,this.emit("progress",e,this._duration),Ticker.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){Ticker.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){Ticker.shared.remove(this._onUpdate,this),this.removeAllListeners();const n=this._source;n&&(n.onended=null,n.onplay=null,n.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let E=F;E.PADDING=.1;class M extends eventemitter3Exports{init(e){this.parent=e,this._source=e.options.source||new Audio,e.url&&(this._source.src=e.url)}create(){return new E(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(e){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(e){const t=this._source,s=this.parent;if(t.readyState===4){s.isLoaded=!0;const a=s.autoPlayStart();e&&setTimeout(()=>{e(null,s,a)},0);return}if(!s.url){e(new Error("sound.url or sound.source must be set"));return}t.src=s.url;const r=()=>{c(),s.isLoaded=!0;const a=s.autoPlayStart();e&&e(null,s,a)},o=()=>{c(),e&&e(new Error("Sound loading has been aborted"))},h=()=>{c();const a=`Failed to load audio element (code: ${t.error.code})`;e?e(new Error(a)):console.error(a)},c=()=>{t.removeEventListener("canplaythrough",r),t.removeEventListener("load",r),t.removeEventListener("abort",o),t.removeEventListener("error",h)};t.addEventListener("canplaythrough",r,!1),t.addEventListener("load",r,!1),t.addEventListener("abort",o,!1),t.addEventListener("error",h,!1),t.load()}}class I{constructor(e,t){this.parent=e,Object.assign(this,t),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(e){return this.parent.play({complete:e,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}class f{static setParamValue(e,t){if(e.setValueAtTime){const s=l().context;e.setValueAtTime(t,s.audioContext.currentTime)}else e.value=t;return t}}let at=0;class T extends eventemitter3Exports{constructor(e){super(),this.id=at++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(e)}set(e,t){if(this[e]===void 0)throw new Error(`Property with name ${e} does not exist.`);switch(e){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"muted":this.muted=t;break;case"loop":this.loop=t;break;case"paused":this.paused=t;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(e){this._speed=e,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(e){this._volume=e,this.refresh()}get muted(){return this._muted}set muted(e){this._muted=e,this.refresh()}get loop(){return this._loop}set loop(e){this._loop=e,this.refresh()}get filters(){return this._filters}set filters(e){var t;this._filters&&((t=this._filters)==null||t.filter(s=>s).forEach(s=>s.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=e!=null&&e.length?e.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const e=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const s=e.volume*(e.muted?0:1),r=t.volume*(t.muted?0:1),o=this._volume*(this._muted?0:1);f.setParamValue(this._gain.gain,o*r*s),f.setParamValue(this._source.playbackRate,this._speed*t.speed*e.speed),this.applyFilters()}applyFilters(){var e;if((e=this._filters)!=null&&e.length){this._source.disconnect();let t=this._source;this._filters.forEach(s=>{t.connect(s.destination),t=s}),t.connect(this._gain)}}refreshPaused(){const e=this._media.context,t=this._media.parent,s=this._paused||t.paused||e.paused;s!==this._pausedReal&&(this._pausedReal=s,s?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",s))}play(e){const{start:t,end:s,speed:r,loop:o,volume:h,muted:c,filters:a}=e;s&&console.assert(s>t,"End time is before start time"),this._paused=!1;const{source:u,gain:d}=this._media.nodes.cloneBufferSource();this._source=u,this._gain=d,this._speed=r,this._volume=h,this._loop=!!o,this._muted=c,this._filters=a,this.refresh();const p=this._source.buffer.duration;this._duration=p,this._end=s,this._lastUpdate=this._now(),this._elapsed=t,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=s,this._source.loopStart=t,this._source.start(0,t)):s?this._source.start(0,t,s-t):this._source.start(0,t),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(e){Ticker.shared.remove(this._updateListener,this),e&&Ticker.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(e){this._paused=e,this.refreshPaused()}destroy(){var e;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(e=this._filters)==null||e.forEach(t=>t.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(e=!1){if(this._source){const t=this._now(),s=t-this._lastUpdate;if(s>0||e){const r=this._source.playbackRate.value;this._elapsed+=s*r,this._lastUpdate=t;const o=this._duration;let h;if(this._source.loopStart){const c=this._source.loopEnd-this._source.loopStart;h=(this._source.loopStart+this._elapsed%c)/o}else h=this._elapsed%o/o;this._progress=h,this.emit("progress",this._progress,o)}}}init(e){this._media=e,e.context.events.on("refresh",this.refresh,this),e.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class C{constructor(e,t){this._output=t,this._input=e}get destination(){return this._input}get filters(){return this._filters}set filters(e){if(this._filters&&(this._filters.forEach(t=>{t&&t.disconnect()}),this._filters=null,this._input.connect(this._output)),e&&e.length){this._filters=e.slice(0),this._input.disconnect();let t=null;e.forEach(s=>{t===null?this._input.connect(s.destination):t.connect(s.destination),t=s}),t.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const j=class extends C{constructor(n){const e=n.audioContext,t=e.createBufferSource(),s=e.createGain(),r=e.createAnalyser();t.connect(r),r.connect(s),s.connect(n.destination),super(r,s),this.context=n,this.bufferSource=t,this.gain=s,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(j.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const n=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=n.buffer,f.setParamValue(e.playbackRate,n.playbackRate.value),e.loop=n.loop;const t=this.context.audioContext.createGain();return e.connect(t),t.connect(this.destination),{source:e,gain:t}}get bufferSize(){return this.script.bufferSize}};let L=j;L.BUFFER_SIZE=0;class A{init(e){this.parent=e,this._nodes=new L(this.context),this._source=this._nodes.bufferSource,this.source=e.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(e){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",e)}this._source=null,this.source=null}create(){return new T(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(e){this._nodes.filters=e}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(e){this._source.buffer=e}get nodes(){return this._nodes}load(e){this.source?this._decode(this.source,e):this.parent.url?this._loadUrl(e):e?e(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(e){const t=this.parent.url,s=await settings$1.ADAPTER.fetch(t);this._decode(await s.arrayBuffer(),e)}_decode(e,t){const s=(r,o)=>{if(r)t&&t(r);else{this.parent.isLoaded=!0,this.buffer=o;const h=this.parent.autoPlayStart();t&&t(null,this.parent,h)}};e instanceof AudioBuffer?s(null,e):this.parent.context.decode(e,s)}}var ut=Object.defineProperty,G=Object.getOwnPropertySymbols,ht=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,B=(n,e,t)=>e in n?ut(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K=(n,e)=>{for(var t in e||(e={}))ht.call(e,t)&&B(n,t,e[t]);if(G)for(var t of G(e))lt.call(e,t)&&B(n,t,e[t]);return n};const b=class{static from(n){let e={};typeof n=="string"?e.url=n:n instanceof ArrayBuffer||n instanceof AudioBuffer||n instanceof HTMLAudioElement?e.source=n:e=n,e=K({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},e),Object.freeze(e);const t=l().useLegacy?new M:new A;return new b(t,e)}constructor(n,e){this.media=n,this.options=e,this._instances=[],this._sprites={},this.media.init(this);const t=e.complete;this._autoPlayOptions=t?{complete:t}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}get context(){return l().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(n){this._paused=n,this.refreshPaused()}get speed(){return this._speed}set speed(n){this._speed=n,this.refresh()}get filters(){return this.media.filters}set filters(n){this.media.filters=n}addSprites(n,e){if(typeof n=="object"){const s={};for(const r in n)s[r]=this.addSprites(r,n[r]);return s}console.assert(!this._sprites[n],`Alias ${n} is already taken`);const t=new I(this,e);return this._sprites[n]=t,t}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(n){if(n){const e=this._sprites[n];e!==void 0&&(e.destroy(),delete this._sprites[n])}else for(const e in this._sprites)this.removeSprites(e);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let n=this._instances.length-1;n>=0;n--)this._instances[n].stop();return this}play(n,e){let t;if(typeof n=="string"?t={sprite:n,loop:this.loop,complete:e}:typeof n=="function"?(t={},t.complete=n):t=n,t=K({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},t||{}),t.sprite){const r=t.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);const o=this._sprites[r];t.start=o.start+(t.start||0),t.end=o.end,t.speed=o.speed||1,t.loop=o.loop||t.loop,delete t.sprite}if(t.offset&&(t.start=t.offset),!this.isLoaded)return new Promise((r,o)=>{this.autoPlay=!0,this._autoPlayOptions=t,this._preload((h,c,a)=>{h?o(h):(t.loaded&&t.loaded(h,c,a),r(a))})});(this.singleInstance||t.singleInstance)&&this._removeInstances();const s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",()=>{t.complete&&t.complete(this),this._onComplete(s)}),s.once("stop",()=>{this._onComplete(s)}),s.play(t),s}refresh(){const n=this._instances.length;for(let e=0;e<n;e++)this._instances[e].refresh()}refreshPaused(){const n=this._instances.length;for(let e=0;e<n;e++)this._instances[e].refreshPaused()}get volume(){return this._volume}set volume(n){this._volume=n,this.refresh()}get muted(){return this._muted}set muted(n){this._muted=n,this.refresh()}get loop(){return this._loop}set loop(n){this._loop=n,this.refresh()}_preload(n){this.media.load(n)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let n;return this.autoPlay&&(n=this.play(this._autoPlayOptions)),n}_removeInstances(){for(let n=this._instances.length-1;n>=0;n--)this._poolInstance(this._instances[n]);this._instances.length=0}_onComplete(n){if(this._instances){const e=this._instances.indexOf(n);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(n)}_createInstance(){if(b._pool.length>0){const n=b._pool.pop();return n.init(this.media),n}return this.media.create()}_poolInstance(n){n.destroy(),b._pool.indexOf(n)<0&&b._pool.push(n)}};let x=b;x._pool=[];class R extends eventemitter3Exports{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(e){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class P extends C{constructor(){const e=window,t=new P.AudioContext,s=t.createDynamicsCompressor(),r=t.createAnalyser();r.connect(s),s.connect(t.destination),super(r,s),this._ctx=t,this._offlineCtx=new P.OfflineAudioContext(1,2,e.OfflineAudioContext?Math.max(8e3,Math.min(96e3,t.sampleRate)):44100),this._unlocked=!1,this.compressor=s,this.analyser=r,this.events=new eventemitter3Exports,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,t.state!=="running"&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){const e=this._ctx.createBufferSource();e.buffer=this._ctx.createBuffer(1,1,22050),e.connect(this._ctx.destination),e.start(0,0,0),e.context.state==="suspended"&&e.context.resume()}static get AudioContext(){const e=window;return e.AudioContext||e.webkitAudioContext||null}static get OfflineAudioContext(){const e=window;return e.OfflineAudioContext||e.webkitOfflineAudioContext||null}destroy(){super.destroy();const e=this._ctx;typeof e.close<"u"&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(e){e&&this._ctx.state==="running"?this._ctx.suspend():!e&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=e}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(e,t){const s=o=>{t(new Error((o==null?void 0:o.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(e,o=>{t(null,o)},s);r&&r.catch(s)}}var ct=Object.defineProperty,D=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable,q=(n,e,t)=>e in n?ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,V=(n,e)=>{for(var t in e||(e={}))dt.call(e,t)&&q(n,t,e[t]);if(D)for(var t of D(e))pt.call(e,t)&&q(n,t,e[t]);return n};class H{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new P),this._htmlAudioContext=new R,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(e){this.useLegacy||(this._context.filters=e)}get supported(){return P.AudioContext!==null}add(e,t){if(typeof e=="object"){const o={};for(const h in e){const c=this._getOptions(e[h],t);o[h]=this.add(h,c)}return o}if(console.assert(!this._sounds[e],`Sound with alias ${e} already exists.`),t instanceof x)return this._sounds[e]=t,t;const s=this._getOptions(t),r=x.from(s);return this._sounds[e]=r,r}_getOptions(e,t){let s;return typeof e=="string"?s={url:e}:e instanceof ArrayBuffer||e instanceof AudioBuffer||e instanceof HTMLAudioElement?s={source:e}:s=e,s=V(V({},s),t||{}),s}get useLegacy(){return this._useLegacy}set useLegacy(e){this._useLegacy=e,this._context=!e&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(e){return this.exists(e,!0),this._sounds[e].destroy(),delete this._sounds[e],this}get volumeAll(){return this._context.volume}set volumeAll(e){this._context.volume=e,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(e){this._context.speed=e,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const e in this._sounds)this._sounds[e].destroy(),delete this._sounds[e];return this}stopAll(){for(const e in this._sounds)this._sounds[e].stop();return this}exists(e,t=!1){const s=!!this._sounds[e];return t&&console.assert(s,`No sound matching alias '${e}'.`),s}find(e){return this.exists(e,!0),this._sounds[e]}play(e,t){return this.find(e).play(t)}stop(e){return this.find(e).stop()}pause(e){return this.find(e).pause()}resume(e){return this.find(e).resume()}volume(e,t){const s=this.find(e);return t!==void 0&&(s.volume=t),s.volume}speed(e,t){const s=this.find(e);return t!==void 0&&(s.speed=t),s.speed}duration(e){return this.find(e).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}var $t=Object.defineProperty,z=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable,Z=(n,e,t)=>e in n?$t(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Mt=(n,e)=>{for(var t in e||(e={}))kt.call(e,t)&&Z(n,t,e[t]);if(z)for(var t of z(e))Ot.call(e,t)&&Z(n,t,e[t]);return n};const $=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],S={};function Q(n){const e=Mt({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},n||{}),t=document.createElement("audio"),s={},r=/^no$/;$.forEach(o=>{const h=t.canPlayType(`audio/${o}`).replace(r,""),c=e[o]?t.canPlayType(e[o]).replace(r,""):"";s[o]=!!h||!!c}),Object.assign(S,s)}Q();var Tt=Object.defineProperty,jt=Object.defineProperties,Gt=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable,J=(n,e,t)=>e in n?Tt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Rt=(n,e)=>{for(var t in e||(e={}))Bt.call(e,t)&&J(n,t,e[t]);if(Y)for(var t of Y(e))Kt.call(e,t)&&J(n,t,e[t]);return n},Dt=(n,e)=>jt(n,Gt(e));const X=n=>{var e,t;const s=n.src;return(t=(e=n==null?void 0:n.alias)==null?void 0:e[0])!=null?t:path$1.basename(s,path$1.extname(s))},tt={extension:ExtensionType.Asset,detection:{test:async()=>!0,add:async n=>[...n,...$.filter(e=>S[e])],remove:async n=>n.filter(e=>n.includes(e))},loader:{extension:{type:[ExtensionType.LoadParser],priority:LoaderParserPriority.High},test(n){const e=path$1.extname(n).slice(1);return!!S[e]},async load(n,e){const t=await new Promise((s,r)=>x.from(Dt(Rt({},e.data),{url:n,preload:!0,loaded(o,h){var c,a;o?r(o):s(h),(a=(c=e.data)==null?void 0:c.loaded)==null||a.call(c,o,h)}})));return l().add(X(e),t),t},async unload(n,e){l().remove(X(e))}}};extensions$1.add(tt);const qt=nt(new H);function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inheritsLoose(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults={duration:.5,overwrite:!1,delay:0},_suppressOverwrites,_reverting$1,_context,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString=function n(e){return typeof e=="string"},_isFunction=function n(e){return typeof e=="function"},_isNumber=function n(e){return typeof e=="number"},_isUndefined=function n(e){return typeof e>"u"},_isObject=function n(e){return typeof e=="object"},_isNotFalse=function n(e){return e!==!1},_windowExists$1=function n(){return typeof window<"u"},_isFuncOrString=function n(e){return _isFunction(e)||_isString(e)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$1,_coreInitted,_doc$1,_globals={},_installScope={},_coreReady,_install=function n(e){return(_installScope=_merge(e,_globals))&&gsap},_missingPlugin=function n(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},_warn=function n(e,t){return!t&&console.warn(e)},_addGlobal=function n(e,t){return e&&(_globals[e]=t)&&_installScope&&(_installScope[e]=t)||_globals},_emptyFunc=function n(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function n(e){var t=e[0],s,r;if(_isObject(t)||_isFunction(t)||(e=[e]),!(s=(t._gsap||{}).harness)){for(r=_harnessPlugins.length;r--&&!_harnessPlugins[r].targetTest(t););s=_harnessPlugins[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new GSCache(e[r],s)))||e.splice(r,1);return e},_getCache=function n(e){return e._gsap||_harness(toArray(e))[0]._gsap},_getProperty=function n(e,t,s){return(s=e[t])&&_isFunction(s)?e[t]():_isUndefined(s)&&e.getAttribute&&e.getAttribute(t)||s},_forEachName=function n(e,t){return(e=e.split(",")).forEach(t)||e},_round=function n(e){return Math.round(e*1e5)/1e5||0},_roundPrecise=function n(e){return Math.round(e*1e7)/1e7||0},_parseRelative=function n(e,t){var s=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),s==="+"?e+r:s==="-"?e-r:s==="*"?e*r:e/r},_arrayContainsAny=function n(e,t){for(var s=t.length,r=0;e.indexOf(t[r])<0&&++r<s;);return r<s},_lazyRender=function n(){var e=_lazyTweens.length,t=_lazyTweens.slice(0),s,r;for(_lazyLookup={},_lazyTweens.length=0,s=0;s<e;s++)r=t[s],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},_lazySafeRender=function n(e,t,s,r){_lazyTweens.length&&!_reverting$1&&_lazyRender(),e.render(t,s,r||_reverting$1&&t<0&&(e._initted||e._startAt)),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function n(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(_delimitedValueExp).length<2?t:_isString(e)?e.trim():e},_passThrough=function n(e){return e},_setDefaults=function n(e,t){for(var s in t)s in e||(e[s]=t[s]);return e},_setKeyframeDefaults=function n(e){return function(t,s){for(var r in s)r in t||r==="duration"&&e||r==="ease"||(t[r]=s[r])}},_merge=function n(e,t){for(var s in t)e[s]=t[s];return e},_mergeDeep=function n(e,t){for(var s in t)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(e[s]=_isObject(t[s])?n(e[s]||(e[s]={}),t[s]):t[s]);return e},_copyExcluding=function n(e,t){var s={},r;for(r in e)r in t||(s[r]=e[r]);return s},_inheritDefaults=function n(e){var t=e.parent||_globalTimeline,s=e.keyframes?_setKeyframeDefaults(_isArray(e.keyframes)):_setDefaults;if(_isNotFalse(e.inherit))for(;t;)s(e,t.vars.defaults),t=t.parent||t._dp;return e},_arraysMatch=function n(e,t){for(var s=e.length,r=s===t.length;r&&s--&&e[s]===t[s];);return s<0},_addLinkedListItem=function n(e,t,s,r,o){s===void 0&&(s="_first"),r===void 0&&(r="_last");var h=e[r],c;if(o)for(c=t[o];h&&h[o]>c;)h=h._prev;return h?(t._next=h._next,h._next=t):(t._next=e[s],e[s]=t),t._next?t._next._prev=t:e[r]=t,t._prev=h,t.parent=t._dp=e,t},_removeLinkedListItem=function n(e,t,s,r){s===void 0&&(s="_first"),r===void 0&&(r="_last");var o=t._prev,h=t._next;o?o._next=h:e[s]===t&&(e[s]=h),h?h._prev=o:e[r]===t&&(e[r]=o),t._next=t._prev=t.parent=null},_removeFromParent=function n(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},_uncache=function n(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var s=e;s;)s._dirty=1,s=s.parent;return e},_recacheAncestors=function n(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},_rewindStartAt=function n(e,t,s,r){return e._startAt&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},_hasNoPausedAncestors=function n(e){return!e||e._ts&&n(e.parent)},_elapsedCycleDuration=function n(e){return e._repeat?_animationCycle(e._tTime,e=e.duration()+e._rDelay)*e:0},_animationCycle=function n(e,t){var s=Math.floor(e/=t);return e&&s===e?s-1:s},_parentToChildTotalTime=function n(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},_setEnd=function n(e){return e._end=_roundPrecise(e._start+(e._tDur/Math.abs(e._ts||e._rts||_tinyNum)||0))},_alignPlayhead=function n(e,t){var s=e._dp;return s&&s.smoothChildTiming&&e._ts&&(e._start=_roundPrecise(s._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),_setEnd(e),s._dirty||_uncache(s,e)),e},_postAddChecks=function n(e,t){var s;if((t._time||t._initted&&!t._dur)&&(s=_parentToChildTotalTime(e.rawTime(),t),(!t._dur||_clamp(0,t.totalDuration(),s)-t._tTime>_tinyNum)&&t.render(s,!0)),_uncache(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(s=e;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;e._zTime=-_tinyNum}},_addToTimeline=function n(e,t,s,r){return t.parent&&_removeFromParent(t),t._start=_roundPrecise((_isNumber(s)?s:s||e!==_globalTimeline?_parsePosition(e,s,t):e._time)+t._delay),t._end=_roundPrecise(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),_addLinkedListItem(e,t,"_first","_last",e._sort?"_start":0),_isFromOrFromStart(t)||(e._recent=t),r||_postAddChecks(e,t),e._ts<0&&_alignPlayhead(e,e._tTime),e},_scrollTrigger=function n(e,t){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",t))&&_globals.ScrollTrigger.create(t,e)},_attemptInitTween=function n(e,t,s,r,o){if(_initTween(e,t,o),!e._initted)return 1;if(!s&&e._pt&&!_reverting$1&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(e),e._lazy=[o,r],1},_parentPlayheadIsBeforeStart=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},_isFromOrFromStart=function n(e){var t=e.data;return t==="isFromStart"||t==="isStart"},_renderZeroDurationTween=function n(e,t,s,r){var o=e.ratio,h=t<0||!t&&(!e._start&&_parentPlayheadIsBeforeStart(e)&&!(!e._initted&&_isFromOrFromStart(e))||(e._ts<0||e._dp._ts<0)&&!_isFromOrFromStart(e))?0:1,c=e._rDelay,a=0,u,d,p;if(c&&e._repeat&&(a=_clamp(0,e._tDur,t),d=_animationCycle(a,c),e._yoyo&&d&1&&(h=1-h),d!==_animationCycle(e._tTime,c)&&(o=1-h,e.vars.repeatRefresh&&e._initted&&e.invalidate())),h!==o||_reverting$1||r||e._zTime===_tinyNum||!t&&e._zTime){if(!e._initted&&_attemptInitTween(e,t,r,s,a))return;for(p=e._zTime,e._zTime=t||(s?_tinyNum:0),s||(s=t&&!p),e.ratio=h,e._from&&(h=1-h),e._time=0,e._tTime=a,u=e._pt;u;)u.r(h,u.d),u=u._next;t<0&&_rewindStartAt(e,t,s,!0),e._onUpdate&&!s&&_callback(e,"onUpdate"),a&&e._repeat&&!s&&e.parent&&_callback(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===h&&(h&&_removeFromParent(e,1),!s&&!_reverting$1&&(_callback(e,h?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},_findNextPauseTween=function n(e,t,s){var r;if(s>t)for(r=e._first;r&&r._start<=s;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=s;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},_setDuration=function n(e,t,s,r){var o=e._repeat,h=_roundPrecise(t)||0,c=e._tTime/e._tDur;return c&&!r&&(e._time*=h/e._dur),e._dur=h,e._tDur=o?o<0?1e10:_roundPrecise(h*(o+1)+e._rDelay*o):h,c>0&&!r&&_alignPlayhead(e,e._tTime=e._tDur*c),e.parent&&_setEnd(e),s||_uncache(e.parent,e),e},_onUpdateTotalDuration=function n(e){return e instanceof Timeline?_uncache(e):_setDuration(e,e._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition=function n(e,t,s){var r=e.labels,o=e._recent||_zeroPosition,h=e.duration()>=_bigNum$1?o.endTime(!1):e._dur,c,a,u;return _isString(t)&&(isNaN(t)||t in r)?(a=t.charAt(0),u=t.substr(-1)==="%",c=t.indexOf("="),a==="<"||a===">"?(c>=0&&(t=t.replace(/=/,"")),(a==="<"?o._start:o.endTime(o._repeat>=0))+(parseFloat(t.substr(1))||0)*(u?(c<0?o:s).totalDuration()/100:1)):c<0?(t in r||(r[t]=h),r[t]):(a=parseFloat(t.charAt(c-1)+t.substr(c+1)),u&&s&&(a=a/100*(_isArray(s)?s[0]:s).totalDuration()),c>1?n(e,t.substr(0,c-1),s)+a:h+a)):t==null?h:+t},_createTweenType=function n(e,t,s){var r=_isNumber(t[1]),o=(r?2:1)+(e<2?0:1),h=t[o],c,a;if(r&&(h.duration=t[1]),h.parent=s,e){for(c=h,a=s;a&&!("immediateRender"in c);)c=a.vars.defaults||{},a=_isNotFalse(a.vars.inherit)&&a.parent;h.immediateRender=_isNotFalse(c.immediateRender),e<2?h.runBackwards=1:h.startAt=t[o-1]}return new Tween$1(t[0],h,t[o+1])},_conditionalReturn=function n(e,t){return e||e===0?t(e):t},_clamp=function n(e,t,s){return s<e?e:s>t?t:s},getUnit=function n(e,t){return!_isString(e)||!(t=_unitExp.exec(e))?"":t[1]},clamp=function n(e,t,s){return _conditionalReturn(s,function(r){return _clamp(e,t,r)})},_slice=[].slice,_isArrayLike=function n(e,t){return e&&_isObject(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&_isObject(e[0]))&&!e.nodeType&&e!==_win$1},_flatten=function n(e,t,s){return s===void 0&&(s=[]),e.forEach(function(r){var o;return _isString(r)&&!t||_isArrayLike(r,1)?(o=s).push.apply(o,toArray(r)):s.push(r)})||s},toArray=function n(e,t,s){return _context&&!t&&_context.selector?_context.selector(e):_isString(e)&&!s&&(_coreInitted||!_wake())?_slice.call((t||_doc$1).querySelectorAll(e),0):_isArray(e)?_flatten(e,s):_isArrayLike(e)?_slice.call(e,0):e?[e]:[]},selector=function n(e){return e=toArray(e)[0]||_warn("Invalid scope")||{},function(t){var s=e.current||e.nativeElement||e;return toArray(t,s.querySelectorAll?s:s===e?_warn("Invalid scope")||_doc$1.createElement("div"):e)}},shuffle=function n(e){return e.sort(function(){return .5-Math.random()})},distribute=function n(e){if(_isFunction(e))return e;var t=_isObject(e)?e:{each:e},s=_parseEase(t.ease),r=t.from||0,o=parseFloat(t.base)||0,h={},c=r>0&&r<1,a=isNaN(r)||c,u=t.axis,d=r,p=r;return _isString(r)?d=p={center:.5,edges:.5,end:1}[r]||0:!c&&a&&(d=r[0],p=r[1]),function(m,g,_){var y=(_||t).length,v=h[y],N,w,k,U,ee,ie,se,oe,le;if(!v){if(le=t.grid==="auto"?0:(t.grid||[1,_bigNum$1])[1],!le){for(se=-_bigNum$1;se<(se=_[le++].getBoundingClientRect().left)&&le<y;);le--}for(v=h[y]=[],N=a?Math.min(le,y)*d-.5:r%le,w=le===_bigNum$1?0:a?y*p/le-.5:r/le|0,se=0,oe=_bigNum$1,ie=0;ie<y;ie++)k=ie%le-N,U=w-(ie/le|0),v[ie]=ee=u?Math.abs(u==="y"?U:k):_sqrt(k*k+U*U),ee>se&&(se=ee),ee<oe&&(oe=ee);r==="random"&&shuffle(v),v.max=se-oe,v.min=oe,v.v=y=(parseFloat(t.amount)||parseFloat(t.each)*(le>y?y-1:u?u==="y"?y/le:le:Math.max(le,y/le))||0)*(r==="edges"?-1:1),v.b=y<0?o-y:o,v.u=getUnit(t.amount||t.each)||0,s=s&&y<0?_invertEase(s):s}return y=(v[m]-v.min)/v.max||0,_roundPrecise(v.b+(s?s(y):y)*v.v)+v.u}},_roundModifier=function n(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(s){var r=_roundPrecise(Math.round(parseFloat(s)/e)*e*t);return(r-r%1)/t+(_isNumber(s)?0:getUnit(s))}},snap=function n(e,t){var s=_isArray(e),r,o;return!s&&_isObject(e)&&(r=s=e.radius||_bigNum$1,e.values?(e=toArray(e.values),(o=!_isNumber(e[0]))&&(r*=r)):e=_roundModifier(e.increment)),_conditionalReturn(t,s?_isFunction(e)?function(h){return o=e(h),Math.abs(o-h)<=r?o:h}:function(h){for(var c=parseFloat(o?h.x:h),a=parseFloat(o?h.y:0),u=_bigNum$1,d=0,p=e.length,m,g;p--;)o?(m=e[p].x-c,g=e[p].y-a,m=m*m+g*g):m=Math.abs(e[p]-c),m<u&&(u=m,d=p);return d=!r||u<=r?e[d]:h,o||d===h||_isNumber(h)?d:d+getUnit(h)}:_roundModifier(e))},random=function n(e,t,s,r){return _conditionalReturn(_isArray(e)?!t:s===!0?!!(s=0):!r,function(){return _isArray(e)?e[~~(Math.random()*e.length)]:(s=s||1e-5)&&(r=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((e-s/2+Math.random()*(t-e+s*.99))/s)*s*r)/r})},pipe=function n(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return function(r){return t.reduce(function(o,h){return h(o)},r)}},unitize=function n(e,t){return function(s){return e(parseFloat(s))+(t||getUnit(s))}},normalize=function n(e,t,s){return mapRange(e,t,0,1,s)},_wrapArray=function n(e,t,s){return _conditionalReturn(s,function(r){return e[~~t(r)]})},wrap=function n(e,t,s){var r=t-e;return _isArray(e)?_wrapArray(e,n(0,e.length),t):_conditionalReturn(s,function(o){return(r+(o-e)%r)%r+e})},wrapYoyo=function n(e,t,s){var r=t-e,o=r*2;return _isArray(e)?_wrapArray(e,n(0,e.length-1),t):_conditionalReturn(s,function(h){return h=(o+(h-e)%o)%o||0,e+(h>r?o-h:h)})},_replaceRandom=function n(e){for(var t=0,s="",r,o,h,c;~(r=e.indexOf("random(",t));)h=e.indexOf(")",r),c=e.charAt(r+7)==="[",o=e.substr(r+7,h-r-7).match(c?_delimitedValueExp:_strictNumExp),s+=e.substr(t,r-t)+random(c?o:+o[0],c?0:+o[1],+o[2]||1e-5),t=h+1;return s+e.substr(t,e.length-t)},mapRange=function n(e,t,s,r,o){var h=t-e,c=r-s;return _conditionalReturn(o,function(a){return s+((a-e)/h*c||0)})},interpolate=function n(e,t,s,r){var o=isNaN(e+t)?0:function(g){return(1-g)*e+g*t};if(!o){var h=_isString(e),c={},a,u,d,p,m;if(s===!0&&(r=1)&&(s=null),h)e={p:e},t={p:t};else if(_isArray(e)&&!_isArray(t)){for(d=[],p=e.length,m=p-2,u=1;u<p;u++)d.push(n(e[u-1],e[u]));p--,o=function(_){_*=p;var y=Math.min(m,~~_);return d[y](_-y)},s=t}else r||(e=_merge(_isArray(e)?[]:{},e));if(!d){for(a in t)_addPropTween.call(c,e,a,"get",t[a]);o=function(_){return _renderPropTweens(_,c)||(h?e.p:e)}}}return _conditionalReturn(s,o)},_getLabelInDirection=function n(e,t,s){var r=e.labels,o=_bigNum$1,h,c,a;for(h in r)c=r[h]-t,c<0==!!s&&c&&o>(c=Math.abs(c))&&(a=h,o=c);return a},_callback=function n(e,t,s){var r=e.vars,o=r[t],h=_context,c=e._ctx,a,u,d;if(o)return a=r[t+"Params"],u=r.callbackScope||e,s&&_lazyTweens.length&&_lazyRender(),c&&(_context=c),d=a?o.apply(u,a):o.call(u),_context=h,d},_interrupt=function n(e){return _removeFromParent(e),e.scrollTrigger&&e.scrollTrigger.kill(!!_reverting$1),e.progress()<1&&_callback(e,"onInterrupt"),e},_quickTween,_createPlugin=function n(e){e=!e.name&&e.default||e;var t=e.name,s=_isFunction(e),r=t&&!s&&e.init?function(){this._props=[]}:e,o={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},h={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),e!==r){if(_plugins[t])return;_setDefaults(r,_setDefaults(_copyExcluding(e,o),h)),_merge(r.prototype,_merge(o,_copyExcluding(e,h))),_plugins[r.prop=t]=r,e.targetTest&&(_harnessPlugins.push(r),_reservedProps[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}_addGlobal(t,r),e.register&&e.register(gsap,r,PropTween)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function n(e,t,s){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(s-t)*e*6:e<.5?s:e*3<2?t+(s-t)*(2/3-e)*6:t)*_255+.5|0},splitColor=function n(e,t,s){var r=e?_isNumber(e)?[e>>16,e>>8&_255,e&_255]:0:_colorLookup.black,o,h,c,a,u,d,p,m,g,_;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),_colorLookup[e])r=_colorLookup[e];else if(e.charAt(0)==="#"){if(e.length<6&&(o=e.charAt(1),h=e.charAt(2),c=e.charAt(3),e="#"+o+o+h+h+c+c+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&_255,r&_255,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&_255,e&_255]}else if(e.substr(0,3)==="hsl"){if(r=_=e.match(_strictNumExp),!t)a=+r[0]%360/360,u=+r[1]/100,d=+r[2]/100,h=d<=.5?d*(u+1):d+u-d*u,o=d*2-h,r.length>3&&(r[3]*=1),r[0]=_hue(a+1/3,o,h),r[1]=_hue(a,o,h),r[2]=_hue(a-1/3,o,h);else if(~e.indexOf("="))return r=e.match(_numExp),s&&r.length<4&&(r[3]=1),r}else r=e.match(_strictNumExp)||_colorLookup.transparent;r=r.map(Number)}return t&&!_&&(o=r[0]/_255,h=r[1]/_255,c=r[2]/_255,p=Math.max(o,h,c),m=Math.min(o,h,c),d=(p+m)/2,p===m?a=u=0:(g=p-m,u=d>.5?g/(2-p-m):g/(p+m),a=p===o?(h-c)/g+(h<c?6:0):p===h?(c-o)/g+2:(o-h)/g+4,a*=60),r[0]=~~(a+.5),r[1]=~~(u*100+.5),r[2]=~~(d*100+.5)),s&&r.length<4&&(r[3]=1),r},_colorOrderData=function n(e){var t=[],s=[],r=-1;return e.split(_colorExp).forEach(function(o){var h=o.match(_numWithUnitExp)||[];t.push.apply(t,h),s.push(r+=h.length+1)}),t.c=s,t},_formatColors=function n(e,t,s){var r="",o=(e+r).match(_colorExp),h=t?"hsla(":"rgba(",c=0,a,u,d,p;if(!o)return e;if(o=o.map(function(m){return(m=splitColor(m,t,1))&&h+(t?m[0]+","+m[1]+"%,"+m[2]+"%,"+m[3]:m.join(","))+")"}),s&&(d=_colorOrderData(e),a=s.c,a.join(r)!==d.c.join(r)))for(u=e.replace(_colorExp,"1").split(_numWithUnitExp),p=u.length-1;c<p;c++)r+=u[c]+(~a.indexOf(c)?o.shift()||h+"0,0,0,0)":(d.length?d:o.length?o:s).shift());if(!u)for(u=e.split(_colorExp),p=u.length-1;c<p;c++)r+=u[c]+o[c];return r+u[p]},_colorExp=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in _colorLookup)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function n(e){var t=e.join(" "),s;if(_colorExp.lastIndex=0,_colorExp.test(t))return s=_hslExp.test(t),e[1]=_formatColors(e[1],s),e[0]=_formatColors(e[0],s,_colorOrderData(e[1])),!0},_tickerActive,_ticker=function(){var n=Date.now,e=500,t=33,s=n(),r=s,o=1e3/240,h=o,c=[],a,u,d,p,m,g,_=function y(v){var N=n()-r,w=v===!0,k,U,ee,ie;if(N>e&&(s+=N-t),r+=N,ee=r-s,k=ee-h,(k>0||w)&&(ie=++p.frame,m=ee-p.time*1e3,p.time=ee=ee/1e3,h+=k+(k>=o?4:o-k),U=1),w||(a=u(y)),U)for(g=0;g<c.length;g++)c[g](ee,m,ie,v)};return p={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(v){return m/(1e3/(v||60))},wake:function(){_coreReady&&(!_coreInitted&&_windowExists$1()&&(_win$1=_coreInitted=window,_doc$1=_win$1.document||{},_globals.gsap=gsap,(_win$1.gsapVersions||(_win$1.gsapVersions=[])).push(gsap.version),_install(_installScope||_win$1.GreenSockGlobals||!_win$1.gsap&&_win$1||{}),d=_win$1.requestAnimationFrame),a&&p.sleep(),u=d||function(v){return setTimeout(v,h-p.time*1e3+1|0)},_tickerActive=1,_(2))},sleep:function(){(d?_win$1.cancelAnimationFrame:clearTimeout)(a),_tickerActive=0,u=_emptyFunc},lagSmoothing:function(v,N){e=v||1/0,t=Math.min(N||33,e)},fps:function(v){o=1e3/(v||240),h=p.time*1e3+o},add:function(v,N,w){var k=N?function(U,ee,ie,se){v(U,ee,ie,se),p.remove(k)}:v;return p.remove(v),c[w?"unshift":"push"](k),_wake(),k},remove:function(v,N){~(N=c.indexOf(v))&&c.splice(N,1)&&g>=N&&g--},_listeners:c},p}(),_wake=function n(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function n(e){for(var t={},s=e.substr(1,e.length-3).split(":"),r=s[0],o=1,h=s.length,c,a,u;o<h;o++)a=s[o],c=o!==h-1?a.lastIndexOf(","):a.length,u=a.substr(0,c),t[r]=isNaN(u)?u.replace(_quotesExp,"").trim():+u,r=a.substr(c+1).trim();return t},_valueInParentheses=function n(e){var t=e.indexOf("(")+1,s=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<s?e.indexOf(")",s+1):s)},_configEaseFromString=function n(e){var t=(e+"").split("("),s=_easeMap[t[0]];return s&&t.length>1&&s.config?s.config.apply(null,~e.indexOf("{")?[_parseObjectInString(t[1])]:_valueInParentheses(e).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(e)?_easeMap._CE("",e):s},_invertEase=function n(e){return function(t){return 1-e(1-t)}},_propagateYoyoEase=function n(e,t){for(var s=e._first,r;s;)s instanceof Timeline?n(s,t):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==t&&(s.timeline?n(s.timeline,t):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=t)),s=s._next},_parseEase=function n(e,t){return e&&(_isFunction(e)?e:_easeMap[e]||_configEaseFromString(e))||t},_insertEase=function n(e,t,s,r){s===void 0&&(s=function(a){return 1-t(1-a)}),r===void 0&&(r=function(a){return a<.5?t(a*2)/2:1-t((1-a)*2)/2});var o={easeIn:t,easeOut:s,easeInOut:r},h;return _forEachName(e,function(c){_easeMap[c]=_globals[c]=o,_easeMap[h=c.toLowerCase()]=s;for(var a in o)_easeMap[h+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=_easeMap[c+"."+a]=o[a]}),o},_easeInOutFromOut=function n(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},_configElastic=function n(e,t,s){var r=t>=1?t:1,o=(s||(e?.3:.45))/(t<1?t:1),h=o/_2PI*(Math.asin(1/r)||0),c=function(d){return d===1?1:r*Math.pow(2,-10*d)*_sin((d-h)*o)+1},a=e==="out"?c:e==="in"?function(u){return 1-c(1-u)}:_easeInOutFromOut(c);return o=_2PI/o,a.config=function(u,d){return n(e,u,d)},a},_configBack=function n(e,t){t===void 0&&(t=1.70158);var s=function(h){return h?--h*h*((t+1)*h+t)+1:0},r=e==="out"?s:e==="in"?function(o){return 1-s(1-o)}:_easeInOutFromOut(s);return r.config=function(o){return n(e,o)},r};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;_insertEase(n+",Power"+(t-1),e?function(s){return Math.pow(s,t)}:function(s){return s},function(s){return 1-Math.pow(1-s,t)},function(s){return s<.5?Math.pow(s*2,t)/2:1-Math.pow((1-s)*2,t)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(n,e){var t=1/e,s=2*t,r=2.5*t,o=function(c){return c<t?n*c*c:c<s?n*Math.pow(c-1.5/e,2)+.75:c<r?n*(c-=2.25/e)*c+.9375:n*Math.pow(c-2.625/e,2)+.984375};_insertEase("Bounce",function(h){return 1-o(1-h)},o)})(7.5625,2.75);_insertEase("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});_insertEase("Circ",function(n){return-(_sqrt(1-n*n)-1)});_insertEase("Sine",function(n){return n===1?1:-_cos(n*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function n(e,t){e===void 0&&(e=1);var s=1/e,r=e+(t?0:1),o=t?1:0,h=1-_tinyNum;return function(c){return((r*_clamp(0,h,c)|0)+o)*s}}};_defaults.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return _callbackNames+=n+","+n+"Params,"});var GSCache=function n(e,t){this.id=_gsID++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:_getProperty,this.set=t?t.getSetter:_getSetter},Animation$1=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,_setDuration(this,+t.duration,1,1),this.data=t.data,_context&&(this._ctx=_context,_context.data.push(this)),_tickerActive||_ticker.wake()}var e=n.prototype;return e.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},e.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},e.totalDuration=function(s){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(s,r){if(_wake(),!arguments.length)return this._tTime;var o=this._dp;if(o&&o.smoothChildTiming&&this._ts){for(_alignPlayhead(this,s),!o._dp||o.parent||_postAddChecks(o,this);o&&o.parent;)o.parent._time!==o._start+(o._ts>=0?o._tTime/o._ts:(o.totalDuration()-o._tTime)/-o._ts)&&o.totalTime(o._tTime,!0),o=o.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===_tinyNum||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),_lazySafeRender(this,s,r)),this},e.time=function(s,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(s?this._dur:0),r):this._time},e.totalProgress=function(s,r){return arguments.length?this.totalTime(this.totalDuration()*s,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(s,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+_elapsedCycleDuration(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(s,r){var o=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*o,r):this._repeat?_animationCycle(this._tTime,o)+1:1},e.timeScale=function(s){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-_tinyNum?0:this._rts,this.totalTime(_clamp(-this._delay,this._tDur,r),!0),_setEnd(this),_recacheAncestors(this)},e.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},e.startTime=function(s){if(arguments.length){this._start=s;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&_addToTimeline(r,this,s-this._delay),this}return this._start},e.endTime=function(s){return this._start+(_isNotFalse(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(s){var r=this.parent||this._dp;return r?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(r.rawTime(s),this):this._tTime:this._tTime},e.revert=function(s){s===void 0&&(s=_revertConfig);var r=_reverting$1;return _reverting$1=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),_reverting$1=r,this},e.globalTime=function(s){for(var r=this,o=arguments.length?s:r.rawTime();r;)o=r._start+o/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(s):o},e.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(s){if(arguments.length){var r=this._time;return this._rDelay=s,_onUpdateTotalDuration(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},e.seek=function(s,r){return this.totalTime(_parsePosition(this,s),_isNotFalse(r))},e.restart=function(s,r){return this.play().totalTime(s?-this._delay:0,_isNotFalse(r))},e.play=function(s,r){return s!=null&&this.seek(s,r),this.reversed(!1).paused(!1)},e.reverse=function(s,r){return s!=null&&this.seek(s||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(s,r){return s!=null&&this.seek(s,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-_tinyNum:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},e.isActive=function(){var s=this.parent||this._dp,r=this._start,o;return!!(!s||this._ts&&this._initted&&s.isActive()&&(o=s.rawTime(!0))>=r&&o<this.endTime(!0)-_tinyNum)},e.eventCallback=function(s,r,o){var h=this.vars;return arguments.length>1?(r?(h[s]=r,o&&(h[s+"Params"]=o),s==="onUpdate"&&(this._onUpdate=r)):delete h[s],this):h[s]},e.then=function(s){var r=this;return new Promise(function(o){var h=_isFunction(s)?s:_passThrough,c=function(){var u=r.then;r.then=null,_isFunction(h)&&(h=h(r))&&(h.then||h===r)&&(r.then=u),o(h),r.then=u};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?c():r._prom=c})},e.kill=function(){_interrupt(this)},n}();_setDefaults(Animation$1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(n){_inheritsLoose(e,n);function e(s,r){var o;return s===void 0&&(s={}),o=n.call(this,s)||this,o.labels={},o.smoothChildTiming=!!s.smoothChildTiming,o.autoRemoveChildren=!!s.autoRemoveChildren,o._sort=_isNotFalse(s.sortChildren),_globalTimeline&&_addToTimeline(s.parent||_globalTimeline,_assertThisInitialized(o),r),s.reversed&&o.reverse(),s.paused&&o.paused(!0),s.scrollTrigger&&_scrollTrigger(_assertThisInitialized(o),s.scrollTrigger),o}var t=e.prototype;return t.to=function(r,o,h){return _createTweenType(0,arguments,this),this},t.from=function(r,o,h){return _createTweenType(1,arguments,this),this},t.fromTo=function(r,o,h,c){return _createTweenType(2,arguments,this),this},t.set=function(r,o,h){return o.duration=0,o.parent=this,_inheritDefaults(o).repeatDelay||(o.repeat=0),o.immediateRender=!!o.immediateRender,new Tween$1(r,o,_parsePosition(this,h),1),this},t.call=function(r,o,h){return _addToTimeline(this,Tween$1.delayedCall(0,r,o),h)},t.staggerTo=function(r,o,h,c,a,u,d){return h.duration=o,h.stagger=h.stagger||c,h.onComplete=u,h.onCompleteParams=d,h.parent=this,new Tween$1(r,h,_parsePosition(this,a)),this},t.staggerFrom=function(r,o,h,c,a,u,d){return h.runBackwards=1,_inheritDefaults(h).immediateRender=_isNotFalse(h.immediateRender),this.staggerTo(r,o,h,c,a,u,d)},t.staggerFromTo=function(r,o,h,c,a,u,d,p){return c.startAt=h,_inheritDefaults(c).immediateRender=_isNotFalse(c.immediateRender),this.staggerTo(r,o,c,a,u,d,p)},t.render=function(r,o,h){var c=this._time,a=this._dirty?this.totalDuration():this._tDur,u=this._dur,d=r<=0?0:_roundPrecise(r),p=this._zTime<0!=r<0&&(this._initted||!u),m,g,_,y,v,N,w,k,U,ee,ie,se;if(this!==_globalTimeline&&d>a&&r>=0&&(d=a),d!==this._tTime||h||p){if(c!==this._time&&u&&(d+=this._time-c,r+=this._time-c),m=d,U=this._start,k=this._ts,N=!k,p&&(u||(c=this._zTime),(r||!o)&&(this._zTime=r)),this._repeat){if(ie=this._yoyo,v=u+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(v*100+r,o,h);if(m=_roundPrecise(d%v),d===a?(y=this._repeat,m=u):(y=~~(d/v),y&&y===d/v&&(m=u,y--),m>u&&(m=u)),ee=_animationCycle(this._tTime,v),!c&&this._tTime&&ee!==y&&(ee=y),ie&&y&1&&(m=u-m,se=1),y!==ee&&!this._lock){var oe=ie&&ee&1,le=oe===(ie&&y&1);if(y<ee&&(oe=!oe),c=oe?0:u,this._lock=1,this.render(c||(se?0:_roundPrecise(y*v)),o,!u)._lock=0,this._tTime=d,!o&&this.parent&&_callback(this,"onRepeat"),this.vars.repeatRefresh&&!se&&(this.invalidate()._lock=1),c&&c!==this._time||N!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(u=this._dur,a=this._tDur,le&&(this._lock=2,c=oe?u:-1e-4,this.render(c,!0),this.vars.repeatRefresh&&!se&&this.invalidate()),this._lock=0,!this._ts&&!N)return this;_propagateYoyoEase(this,se)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(w=_findNextPauseTween(this,_roundPrecise(c),_roundPrecise(m)),w&&(d-=m-(m=w._start))),this._tTime=d,this._time=m,this._act=!k,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,c=0),!c&&m&&!o&&(_callback(this,"onStart"),this._tTime!==d))return this;if(m>=c&&r>=0)for(g=this._first;g;){if(_=g._next,(g._act||m>=g._start)&&g._ts&&w!==g){if(g.parent!==this)return this.render(r,o,h);if(g.render(g._ts>0?(m-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(m-g._start)*g._ts,o,h),m!==this._time||!this._ts&&!N){w=0,_&&(d+=this._zTime=-_tinyNum);break}}g=_}else{g=this._last;for(var ue=r<0?r:m;g;){if(_=g._prev,(g._act||ue<=g._end)&&g._ts&&w!==g){if(g.parent!==this)return this.render(r,o,h);if(g.render(g._ts>0?(ue-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(ue-g._start)*g._ts,o,h||_reverting$1&&(g._initted||g._startAt)),m!==this._time||!this._ts&&!N){w=0,_&&(d+=this._zTime=ue?-_tinyNum:_tinyNum);break}}g=_}}if(w&&!o&&(this.pause(),w.render(m>=c?0:-_tinyNum)._zTime=m>=c?1:-1,this._ts))return this._start=U,_setEnd(this),this.render(r,o,h);this._onUpdate&&!o&&_callback(this,"onUpdate",!0),(d===a&&this._tTime>=this.totalDuration()||!d&&c)&&(U===this._start||Math.abs(k)!==Math.abs(this._ts))&&(this._lock||((r||!u)&&(d===a&&this._ts>0||!d&&this._ts<0)&&_removeFromParent(this,1),!o&&!(r<0&&!c)&&(d||c||!a)&&(_callback(this,d===a&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(d<a&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,o){var h=this;if(_isNumber(o)||(o=_parsePosition(this,o,r)),!(r instanceof Animation$1)){if(_isArray(r))return r.forEach(function(c){return h.add(c,o)}),this;if(_isString(r))return this.addLabel(r,o);if(_isFunction(r))r=Tween$1.delayedCall(0,r);else return this}return this!==r?_addToTimeline(this,r,o):this},t.getChildren=function(r,o,h,c){r===void 0&&(r=!0),o===void 0&&(o=!0),h===void 0&&(h=!0),c===void 0&&(c=-_bigNum$1);for(var a=[],u=this._first;u;)u._start>=c&&(u instanceof Tween$1?o&&a.push(u):(h&&a.push(u),r&&a.push.apply(a,u.getChildren(!0,o,h)))),u=u._next;return a},t.getById=function(r){for(var o=this.getChildren(1,1,1),h=o.length;h--;)if(o[h].vars.id===r)return o[h]},t.remove=function(r){return _isString(r)?this.removeLabel(r):_isFunction(r)?this.killTweensOf(r):(_removeLinkedListItem(this,r),r===this._recent&&(this._recent=this._last),_uncache(this))},t.totalTime=function(r,o){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,o),this._forcing=0,this):this._tTime},t.addLabel=function(r,o){return this.labels[r]=_parsePosition(this,o),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,o,h){var c=Tween$1.delayedCall(0,o||_emptyFunc,h);return c.data="isPause",this._hasPause=1,_addToTimeline(this,c,_parsePosition(this,r))},t.removePause=function(r){var o=this._first;for(r=_parsePosition(this,r);o;)o._start===r&&o.data==="isPause"&&_removeFromParent(o),o=o._next},t.killTweensOf=function(r,o,h){for(var c=this.getTweensOf(r,h),a=c.length;a--;)_overwritingTween!==c[a]&&c[a].kill(r,o);return this},t.getTweensOf=function(r,o){for(var h=[],c=toArray(r),a=this._first,u=_isNumber(o),d;a;)a instanceof Tween$1?_arrayContainsAny(a._targets,c)&&(u?(!_overwritingTween||a._initted&&a._ts)&&a.globalTime(0)<=o&&a.globalTime(a.totalDuration())>o:!o||a.isActive())&&h.push(a):(d=a.getTweensOf(c,o)).length&&h.push.apply(h,d),a=a._next;return h},t.tweenTo=function(r,o){o=o||{};var h=this,c=_parsePosition(h,r),a=o,u=a.startAt,d=a.onStart,p=a.onStartParams,m=a.immediateRender,g,_=Tween$1.to(h,_setDefaults({ease:o.ease||"none",lazy:!1,immediateRender:!1,time:c,overwrite:"auto",duration:o.duration||Math.abs((c-(u&&"time"in u?u.time:h._time))/h.timeScale())||_tinyNum,onStart:function(){if(h.pause(),!g){var v=o.duration||Math.abs((c-(u&&"time"in u?u.time:h._time))/h.timeScale());_._dur!==v&&_setDuration(_,v,0,1).render(_._time,!0,!0),g=1}d&&d.apply(_,p||[])}},o));return m?_.render(0):_},t.tweenFromTo=function(r,o,h){return this.tweenTo(o,_setDefaults({startAt:{time:_parsePosition(this,r)}},h))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),_getLabelInDirection(this,_parsePosition(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+_tinyNum)},t.shiftChildren=function(r,o,h){h===void 0&&(h=0);for(var c=this._first,a=this.labels,u;c;)c._start>=h&&(c._start+=r,c._end+=r),c=c._next;if(o)for(u in a)a[u]>=h&&(a[u]+=r);return _uncache(this)},t.invalidate=function(r){var o=this._first;for(this._lock=0;o;)o.invalidate(r),o=o._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var o=this._first,h;o;)h=o._next,this.remove(o),o=h;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),_uncache(this)},t.totalDuration=function(r){var o=0,h=this,c=h._last,a=_bigNum$1,u,d,p;if(arguments.length)return h.timeScale((h._repeat<0?h.duration():h.totalDuration())/(h.reversed()?-r:r));if(h._dirty){for(p=h.parent;c;)u=c._prev,c._dirty&&c.totalDuration(),d=c._start,d>a&&h._sort&&c._ts&&!h._lock?(h._lock=1,_addToTimeline(h,c,d-c._delay,1)._lock=0):a=d,d<0&&c._ts&&(o-=d,(!p&&!h._dp||p&&p.smoothChildTiming)&&(h._start+=d/h._ts,h._time-=d,h._tTime-=d),h.shiftChildren(-d,!1,-1/0),a=0),c._end>o&&c._ts&&(o=c._end),c=u;_setDuration(h,h===_globalTimeline&&h._time>o?h._time:o,1,1),h._dirty=0}return h._tDur},e.updateRoot=function(r){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(r,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var o=_globalTimeline._first;if((!o||!o._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;o&&!o._ts;)o=o._next;o||_ticker.sleep()}}},e}(Animation$1);_setDefaults(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function n(e,t,s,r,o,h,c){var a=new PropTween(this._pt,e,t,0,1,_renderComplexString,null,o),u=0,d=0,p,m,g,_,y,v,N,w;for(a.b=s,a.e=r,s+="",r+="",(N=~r.indexOf("random("))&&(r=_replaceRandom(r)),h&&(w=[s,r],h(w,e,t),s=w[0],r=w[1]),m=s.match(_complexStringNumExp)||[];p=_complexStringNumExp.exec(r);)_=p[0],y=r.substring(u,p.index),g?g=(g+1)%5:y.substr(-5)==="rgba("&&(g=1),_!==m[d++]&&(v=parseFloat(m[d-1])||0,a._pt={_next:a._pt,p:y||d===1?y:",",s:v,c:_.charAt(1)==="="?_parseRelative(v,_)-v:parseFloat(_)-v,m:g&&g<4?Math.round:0},u=_complexStringNumExp.lastIndex);return a.c=u<r.length?r.substring(u,r.length):"",a.fp=c,(_relExp.test(r)||N)&&(a.e=0),this._pt=a,a},_addPropTween=function n(e,t,s,r,o,h,c,a,u,d){_isFunction(r)&&(r=r(o||0,e,h));var p=e[t],m=s!=="get"?s:_isFunction(p)?u?e[t.indexOf("set")||!_isFunction(e["get"+t.substr(3)])?t:"get"+t.substr(3)](u):e[t]():p,g=_isFunction(p)?u?_setterFuncWithParam:_setterFunc:_setterPlain,_;if(_isString(r)&&(~r.indexOf("random(")&&(r=_replaceRandom(r)),r.charAt(1)==="="&&(_=_parseRelative(m,r)+(getUnit(m)||0),(_||_===0)&&(r=_))),!d||m!==r||_forceAllPropTweens)return!isNaN(m*r)&&r!==""?(_=new PropTween(this._pt,e,t,+m||0,r-(m||0),typeof p=="boolean"?_renderBoolean:_renderPlain,0,g),u&&(_.fp=u),c&&_.modifier(c,this,e),this._pt=_):(!p&&!(t in e)&&_missingPlugin(t,r),_addComplexStringPropTween.call(this,e,t,m,r,g,a||_config.stringFilter,u))},_processVars=function n(e,t,s,r,o){if(_isFunction(e)&&(e=_parseFuncOrString(e,o,t,s,r)),!_isObject(e)||e.style&&e.nodeType||_isArray(e)||_isTypedArray(e))return _isString(e)?_parseFuncOrString(e,o,t,s,r):e;var h={},c;for(c in e)h[c]=_parseFuncOrString(e[c],o,t,s,r);return h},_checkPlugin=function n(e,t,s,r,o,h){var c,a,u,d;if(_plugins[e]&&(c=new _plugins[e]).init(o,c.rawVars?t[e]:_processVars(t[e],r,o,h,s),s,r,h)!==!1&&(s._pt=a=new PropTween(s._pt,o,e,0,1,c.render,c,0,c.priority),s!==_quickTween))for(u=s._ptLookup[s._targets.indexOf(o)],d=c._props.length;d--;)u[c._props[d]]=a;return c},_overwritingTween,_forceAllPropTweens,_initTween=function n(e,t,s){var r=e.vars,o=r.ease,h=r.startAt,c=r.immediateRender,a=r.lazy,u=r.onUpdate,d=r.onUpdateParams,p=r.callbackScope,m=r.runBackwards,g=r.yoyoEase,_=r.keyframes,y=r.autoRevert,v=e._dur,N=e._startAt,w=e._targets,k=e.parent,U=k&&k.data==="nested"?k.vars.targets:w,ee=e._overwrite==="auto"&&!_suppressOverwrites,ie=e.timeline,se,oe,le,ue,he,pe,de,fe,Te,Ce,be,Ae,Pe;if(ie&&(!_||!o)&&(o="none"),e._ease=_parseEase(o,_defaults.ease),e._yEase=g?_invertEase(_parseEase(g===!0?o:g,_defaults.ease)):0,g&&e._yoyo&&!e._repeat&&(g=e._yEase,e._yEase=e._ease,e._ease=g),e._from=!ie&&!!r.runBackwards,!ie||_&&!r.stagger){if(fe=w[0]?_getCache(w[0]).harness:0,Ae=fe&&r[fe.prop],se=_copyExcluding(r,_reservedProps),N&&(N._zTime<0&&N.progress(1),t<0&&m&&c&&!y?N.render(-1,!0):N.revert(m&&v?_revertConfigNoKill:_startAtRevertConfig),N._lazy=0),h){if(_removeFromParent(e._startAt=Tween$1.set(w,_setDefaults({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:!N&&_isNotFalse(a),startAt:null,delay:0,onUpdate:u,onUpdateParams:d,callbackScope:p,stagger:0},h))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1||!c&&!y)&&e._startAt.revert(_revertConfigNoKill),c&&v&&t<=0&&s<=0){t&&(e._zTime=t);return}}else if(m&&v&&!N){if(t&&(c=!1),le=_setDefaults({overwrite:!1,data:"isFromStart",lazy:c&&!N&&_isNotFalse(a),immediateRender:c,stagger:0,parent:k},se),Ae&&(le[fe.prop]=Ae),_removeFromParent(e._startAt=Tween$1.set(w,le)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(_reverting$1?e._startAt.revert(_revertConfigNoKill):e._startAt.render(-1,!0)),e._zTime=t,!c)n(e._startAt,_tinyNum,_tinyNum);else if(!t)return}for(e._pt=e._ptCache=0,a=v&&_isNotFalse(a)||a&&!v,oe=0;oe<w.length;oe++){if(he=w[oe],de=he._gsap||_harness(w)[oe]._gsap,e._ptLookup[oe]=Ce={},_lazyLookup[de.id]&&_lazyTweens.length&&_lazyRender(),be=U===w?oe:U.indexOf(he),fe&&(Te=new fe).init(he,Ae||se,e,be,U)!==!1&&(e._pt=ue=new PropTween(e._pt,he,Te.name,0,1,Te.render,Te,0,Te.priority),Te._props.forEach(function(xe){Ce[xe]=ue}),Te.priority&&(pe=1)),!fe||Ae)for(le in se)_plugins[le]&&(Te=_checkPlugin(le,se,e,be,he,U))?Te.priority&&(pe=1):Ce[le]=ue=_addPropTween.call(e,he,le,"get",se[le],be,U,0,r.stringFilter);e._op&&e._op[oe]&&e.kill(he,e._op[oe]),ee&&e._pt&&(_overwritingTween=e,_globalTimeline.killTweensOf(he,Ce,e.globalTime(t)),Pe=!e.parent,_overwritingTween=0),e._pt&&a&&(_lazyLookup[de.id]=1)}pe&&_sortPropTweensByPriority(e),e._onInit&&e._onInit(e)}e._onUpdate=u,e._initted=(!e._op||e._pt)&&!Pe,_&&t<=0&&ie.render(_bigNum$1,!0,!0)},_updatePropTweens=function n(e,t,s,r,o,h,c){var a=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,d,p,m;if(!a)for(a=e._ptCache[t]=[],p=e._ptLookup,m=e._targets.length;m--;){if(u=p[m][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return _forceAllPropTweens=1,e.vars[t]="+=0",_initTween(e,c),_forceAllPropTweens=0,1;a.push(u)}for(m=a.length;m--;)d=a[m],u=d._pt||d,u.s=(r||r===0)&&!o?r:u.s+(r||0)+h*u.c,u.c=s-u.s,d.e&&(d.e=_round(s)+getUnit(d.e)),d.b&&(d.b=u.s+getUnit(d.b))},_addAliasesToVars=function n(e,t){var s=e[0]?_getCache(e[0]).harness:0,r=s&&s.aliases,o,h,c,a;if(!r)return t;o=_merge({},t);for(h in r)if(h in o)for(a=r[h].split(","),c=a.length;c--;)o[a[c]]=o[h];return o},_parseKeyframe=function n(e,t,s,r){var o=t.ease||r||"power1.inOut",h,c;if(_isArray(t))c=s[e]||(s[e]=[]),t.forEach(function(a,u){return c.push({t:u/(t.length-1)*100,v:a,e:o})});else for(h in t)c=s[h]||(s[h]=[]),h==="ease"||c.push({t:parseFloat(e),v:t[h],e:o})},_parseFuncOrString=function n(e,t,s,r,o){return _isFunction(e)?e.call(t,s,r,o):_isString(e)&&~e.indexOf("random(")?_replaceRandom(e):e},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return _staggerPropsToSkip[n]=1});var Tween$1=function(n){_inheritsLoose(e,n);function e(s,r,o,h){var c;typeof r=="number"&&(o.duration=r,r=o,o=null),c=n.call(this,h?r:_inheritDefaults(r))||this;var a=c.vars,u=a.duration,d=a.delay,p=a.immediateRender,m=a.stagger,g=a.overwrite,_=a.keyframes,y=a.defaults,v=a.scrollTrigger,N=a.yoyoEase,w=r.parent||_globalTimeline,k=(_isArray(s)||_isTypedArray(s)?_isNumber(s[0]):"length"in r)?[s]:toArray(s),U,ee,ie,se,oe,le,ue,he;if(c._targets=k.length?_harness(k):_warn("GSAP target "+s+" not found. https://greensock.com",!_config.nullTargetWarn)||[],c._ptLookup=[],c._overwrite=g,_||m||_isFuncOrString(u)||_isFuncOrString(d)){if(r=c.vars,U=c.timeline=new Timeline({data:"nested",defaults:y||{},targets:w&&w.data==="nested"?w.vars.targets:k}),U.kill(),U.parent=U._dp=_assertThisInitialized(c),U._start=0,m||_isFuncOrString(u)||_isFuncOrString(d)){if(se=k.length,ue=m&&distribute(m),_isObject(m))for(oe in m)~_staggerTweenProps.indexOf(oe)&&(he||(he={}),he[oe]=m[oe]);for(ee=0;ee<se;ee++)ie=_copyExcluding(r,_staggerPropsToSkip),ie.stagger=0,N&&(ie.yoyoEase=N),he&&_merge(ie,he),le=k[ee],ie.duration=+_parseFuncOrString(u,_assertThisInitialized(c),ee,le,k),ie.delay=(+_parseFuncOrString(d,_assertThisInitialized(c),ee,le,k)||0)-c._delay,!m&&se===1&&ie.delay&&(c._delay=d=ie.delay,c._start+=d,ie.delay=0),U.to(le,ie,ue?ue(ee,le,k):0),U._ease=_easeMap.none;U.duration()?u=d=0:c.timeline=0}else if(_){_inheritDefaults(_setDefaults(U.vars.defaults,{ease:"none"})),U._ease=_parseEase(_.ease||r.ease||"none");var pe=0,de,fe,Te;if(_isArray(_))_.forEach(function(Ce){return U.to(k,Ce,">")}),U.duration();else{ie={};for(oe in _)oe==="ease"||oe==="easeEach"||_parseKeyframe(oe,_[oe],ie,_.easeEach);for(oe in ie)for(de=ie[oe].sort(function(Ce,be){return Ce.t-be.t}),pe=0,ee=0;ee<de.length;ee++)fe=de[ee],Te={ease:fe.e,duration:(fe.t-(ee?de[ee-1].t:0))/100*u},Te[oe]=fe.v,U.to(k,Te,pe),pe+=Te.duration;U.duration()<u&&U.to({},{duration:u-U.duration()})}}u||c.duration(u=U.duration())}else c.timeline=0;return g===!0&&!_suppressOverwrites&&(_overwritingTween=_assertThisInitialized(c),_globalTimeline.killTweensOf(k),_overwritingTween=0),_addToTimeline(w,_assertThisInitialized(c),o),r.reversed&&c.reverse(),r.paused&&c.paused(!0),(p||!u&&!_&&c._start===_roundPrecise(w._time)&&_isNotFalse(p)&&_hasNoPausedAncestors(_assertThisInitialized(c))&&w.data!=="nested")&&(c._tTime=-_tinyNum,c.render(Math.max(0,-d)||0)),v&&_scrollTrigger(_assertThisInitialized(c),v),c}var t=e.prototype;return t.render=function(r,o,h){var c=this._time,a=this._tDur,u=this._dur,d=r<0,p=r>a-_tinyNum&&!d?a:r<_tinyNum?0:r,m,g,_,y,v,N,w,k,U;if(!u)_renderZeroDurationTween(this,r,o,h);else if(p!==this._tTime||!r||h||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==d){if(m=p,k=this.timeline,this._repeat){if(y=u+this._rDelay,this._repeat<-1&&d)return this.totalTime(y*100+r,o,h);if(m=_roundPrecise(p%y),p===a?(_=this._repeat,m=u):(_=~~(p/y),_&&_===p/y&&(m=u,_--),m>u&&(m=u)),N=this._yoyo&&_&1,N&&(U=this._yEase,m=u-m),v=_animationCycle(this._tTime,y),m===c&&!h&&this._initted)return this._tTime=p,this;_!==v&&(k&&this._yEase&&_propagateYoyoEase(k,N),this.vars.repeatRefresh&&!N&&!this._lock&&(this._lock=h=1,this.render(_roundPrecise(y*_),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,d?r:m,h,o,p))return this._tTime=0,this;if(c!==this._time)return this;if(u!==this._dur)return this.render(r,o,h)}if(this._tTime=p,this._time=m,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=w=(U||this._ease)(m/u),this._from&&(this.ratio=w=1-w),m&&!c&&!o&&(_callback(this,"onStart"),this._tTime!==p))return this;for(g=this._pt;g;)g.r(w,g.d),g=g._next;k&&k.render(r<0?r:!m&&N?-_tinyNum:k._dur*k._ease(m/this._dur),o,h)||this._startAt&&(this._zTime=r),this._onUpdate&&!o&&(d&&_rewindStartAt(this,r,o,h),_callback(this,"onUpdate")),this._repeat&&_!==v&&this.vars.onRepeat&&!o&&this.parent&&_callback(this,"onRepeat"),(p===this._tDur||!p)&&this._tTime===p&&(d&&!this._onUpdate&&_rewindStartAt(this,r,!0,!0),(r||!u)&&(p===this._tDur&&this._ts>0||!p&&this._ts<0)&&_removeFromParent(this,1),!o&&!(d&&!c)&&(p||c||N)&&(_callback(this,p===a?"onComplete":"onReverseComplete",!0),this._prom&&!(p<a&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,o,h,c){_tickerActive||_ticker.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||_initTween(this,a),u=this._ease(a/this._dur),_updatePropTweens(this,r,o,h,c,u,a)?this.resetTo(r,o,h,c):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,o){if(o===void 0&&(o="all"),!r&&(!o||o==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this;if(this.timeline){var h=this.timeline.totalDuration();return this.timeline.killTweensOf(r,o,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&h!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/h,0,1),this}var c=this._targets,a=r?toArray(r):c,u=this._ptLookup,d=this._pt,p,m,g,_,y,v,N;if((!o||o==="all")&&_arraysMatch(c,a))return o==="all"&&(this._pt=0),_interrupt(this);for(p=this._op=this._op||[],o!=="all"&&(_isString(o)&&(y={},_forEachName(o,function(w){return y[w]=1}),o=y),o=_addAliasesToVars(c,o)),N=c.length;N--;)if(~a.indexOf(c[N])){m=u[N],o==="all"?(p[N]=o,_=m,g={}):(g=p[N]=p[N]||{},_=o);for(y in _)v=m&&m[y],v&&((!("kill"in v.d)||v.d.kill(y)===!0)&&_removeLinkedListItem(this,v,"_pt"),delete m[y]),g!=="all"&&(g[y]=1)}return this._initted&&!this._pt&&d&&_interrupt(this),this},e.to=function(r,o){return new e(r,o,arguments[2])},e.from=function(r,o){return _createTweenType(1,arguments)},e.delayedCall=function(r,o,h,c){return new e(o,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:o,onReverseComplete:o,onCompleteParams:h,onReverseCompleteParams:h,callbackScope:c})},e.fromTo=function(r,o,h){return _createTweenType(2,arguments)},e.set=function(r,o){return o.duration=0,o.repeatDelay||(o.repeat=0),new e(r,o)},e.killTweensOf=function(r,o,h){return _globalTimeline.killTweensOf(r,o,h)},e}(Animation$1);_setDefaults(Tween$1.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(n){Tween$1[n]=function(){var e=new Timeline,t=_slice.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var _setterPlain=function n(e,t,s){return e[t]=s},_setterFunc=function n(e,t,s){return e[t](s)},_setterFuncWithParam=function n(e,t,s,r){return e[t](r.fp,s)},_setterAttribute=function n(e,t,s){return e.setAttribute(t,s)},_getSetter=function n(e,t){return _isFunction(e[t])?_setterFunc:_isUndefined(e[t])&&e.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function n(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},_renderBoolean=function n(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},_renderComplexString=function n(e,t){var s=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;s;)r=s.p+(s.m?s.m(s.s+s.c*e):Math.round((s.s+s.c*e)*1e4)/1e4)+r,s=s._next;r+=t.c}t.set(t.t,t.p,r,t)},_renderPropTweens=function n(e,t){for(var s=t._pt;s;)s.r(e,s.d),s=s._next},_addPluginModifier=function n(e,t,s,r){for(var o=this._pt,h;o;)h=o._next,o.p===r&&o.modifier(e,t,s),o=h},_killPropTweensOf=function n(e){for(var t=this._pt,s,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?_removeLinkedListItem(this,t,"_pt"):t.dep||(s=1),t=r;return!s},_setterWithModifier=function n(e,t,s,r){r.mSet(e,t,r.m.call(r.tween,s,r.mt),r)},_sortPropTweensByPriority=function n(e){for(var t=e._pt,s,r,o,h;t;){for(s=t._next,r=o;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:h)?t._prev._next=t:o=t,(t._next=r)?r._prev=t:h=t,t=s}e._pt=o},PropTween=function(){function n(t,s,r,o,h,c,a,u,d){this.t=s,this.s=o,this.c=h,this.p=r,this.r=c||_renderPlain,this.d=a||this,this.set=u||_setterPlain,this.pr=d||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(s,r,o){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=s,this.mt=o,this.tween=r},n}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return _reservedProps[n]=1});_globals.TweenMax=_globals.TweenLite=Tween$1;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners={},_emptyArray=[],_lastMediaTime=0,_dispatch=function n(e){return(_listeners[e]||_emptyArray).map(function(t){return t()})},_onMediaChange=function n(){var e=Date.now(),t=[];e-_lastMediaTime>2&&(_dispatch("matchMediaInit"),_media.forEach(function(s){var r=s.queries,o=s.conditions,h,c,a,u;for(c in r)h=_win$1.matchMedia(r[c]).matches,h&&(a=1),h!==o[c]&&(o[c]=h,u=1);u&&(s.revert(),a&&t.push(s))}),_dispatch("matchMediaRevert"),t.forEach(function(s){return s.onMatch(s)}),_lastMediaTime=e,_dispatch("matchMedia"))},Context=function(){function n(t,s){this.selector=s&&selector(s),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=n.prototype;return e.add=function(s,r,o){_isFunction(s)&&(o=r,r=s,s=_isFunction);var h=this,c=function(){var u=_context,d=h.selector,p;return u&&u!==h&&u.data.push(h),o&&(h.selector=selector(o)),_context=h,p=r.apply(h,arguments),_isFunction(p)&&h._r.push(p),_context=u,h.selector=d,h.isReverted=!1,p};return h.last=c,s===_isFunction?c(h):s?h[s]=c:c},e.ignore=function(s){var r=_context;_context=null,s(this),_context=r},e.getTweens=function(){var s=[];return this.data.forEach(function(r){return r instanceof n?s.push.apply(s,r.getTweens()):r instanceof Tween$1&&!(r.parent&&r.parent.data==="nested")&&s.push(r)}),s},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(s,r){var o=this;if(s){var h=this.getTweens();this.data.forEach(function(a){a.data==="isFlip"&&(a.revert(),a.getChildren(!0,!0,!1).forEach(function(u){return h.splice(h.indexOf(u),1)}))}),h.map(function(a){return{g:a.globalTime(0),t:a}}).sort(function(a,u){return u.g-a.g||-1}).forEach(function(a){return a.t.revert(s)}),this.data.forEach(function(a){return!(a instanceof Animation$1)&&a.revert&&a.revert(s)}),this._r.forEach(function(a){return a(s,o)}),this.isReverted=!0}else this.data.forEach(function(a){return a.kill&&a.kill()});if(this.clear(),r){var c=_media.indexOf(this);~c&&_media.splice(c,1)}},e.revert=function(s){this.kill(s||{})},n}(),MatchMedia=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(s,r,o){_isObject(s)||(s={matches:s});var h=new Context(0,o||this.scope),c=h.conditions={},a,u,d;this.contexts.push(h),r=h.add("onMatch",r),h.queries=s;for(u in s)u==="all"?d=1:(a=_win$1.matchMedia(s[u]),a&&(_media.indexOf(h)<0&&_media.push(h),(c[u]=a.matches)&&(d=1),a.addListener?a.addListener(_onMediaChange):a.addEventListener("change",_onMediaChange)));return d&&r(h),this},e.revert=function(s){this.kill(s||{})},e.kill=function(s){this.contexts.forEach(function(r){return r.kill(s,!0)})},n}(),_gsap={registerPlugin:function n(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];t.forEach(function(r){return _createPlugin(r)})},timeline:function n(e){return new Timeline(e)},getTweensOf:function n(e,t){return _globalTimeline.getTweensOf(e,t)},getProperty:function n(e,t,s,r){_isString(e)&&(e=toArray(e)[0]);var o=_getCache(e||{}).get,h=s?_passThrough:_numericIfPossible;return s==="native"&&(s=""),e&&(t?h((_plugins[t]&&_plugins[t].get||o)(e,t,s,r)):function(c,a,u){return h((_plugins[c]&&_plugins[c].get||o)(e,c,a,u))})},quickSetter:function n(e,t,s){if(e=toArray(e),e.length>1){var r=e.map(function(d){return gsap.quickSetter(d,t,s)}),o=r.length;return function(d){for(var p=o;p--;)r[p](d)}}e=e[0]||{};var h=_plugins[t],c=_getCache(e),a=c.harness&&(c.harness.aliases||{})[t]||t,u=h?function(d){var p=new h;_quickTween._pt=0,p.init(e,s?d+s:d,_quickTween,0,[e]),p.render(1,p),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:c.set(e,a);return h?u:function(d){return u(e,a,s?d+s:d,c,1)}},quickTo:function n(e,t,s){var r,o=gsap.to(e,_merge((r={},r[t]="+=0.1",r.paused=!0,r),s||{})),h=function(a,u,d){return o.resetTo(t,a,u,d)};return h.tween=o,h},isTweening:function n(e){return _globalTimeline.getTweensOf(e,!0).length>0},defaults:function n(e){return e&&e.ease&&(e.ease=_parseEase(e.ease,_defaults.ease)),_mergeDeep(_defaults,e||{})},config:function n(e){return _mergeDeep(_config,e||{})},registerEffect:function n(e){var t=e.name,s=e.effect,r=e.plugins,o=e.defaults,h=e.extendTimeline;(r||"").split(",").forEach(function(c){return c&&!_plugins[c]&&!_globals[c]&&_warn(t+" effect requires "+c+" plugin.")}),_effects[t]=function(c,a,u){return s(toArray(c),_setDefaults(a||{},o),u)},h&&(Timeline.prototype[t]=function(c,a,u){return this.add(_effects[t](c,_isObject(a)?a:(u=a)&&{},this),u)})},registerEase:function n(e,t){_easeMap[e]=_parseEase(t)},parseEase:function n(e,t){return arguments.length?_parseEase(e,t):_easeMap},getById:function n(e){return _globalTimeline.getById(e)},exportRoot:function n(e,t){e===void 0&&(e={});var s=new Timeline(e),r,o;for(s.smoothChildTiming=_isNotFalse(e.smoothChildTiming),_globalTimeline.remove(s),s._dp=0,s._time=s._tTime=_globalTimeline._time,r=_globalTimeline._first;r;)o=r._next,(t||!(!r._dur&&r instanceof Tween$1&&r.vars.onComplete===r._targets[0]))&&_addToTimeline(s,r,r._start-r._delay),r=o;return _addToTimeline(_globalTimeline,s,0),s},context:function n(e,t){return e?new Context(e,t):_context},matchMedia:function n(e){return new MatchMedia(e)},matchMediaRefresh:function n(){return _media.forEach(function(e){var t=e.conditions,s,r;for(r in t)t[r]&&(t[r]=!1,s=1);s&&e.revert()})||_onMediaChange()},addEventListener:function n(e,t){var s=_listeners[e]||(_listeners[e]=[]);~s.indexOf(t)||s.push(t)},removeEventListener:function n(e,t){var s=_listeners[e],r=s&&s.indexOf(t);r>=0&&s.splice(r,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween:Tween$1,Timeline,Animation:Animation$1,getCache:_getCache,_removeLinkedListItem,reverting:function n(){return _reverting$1},context:function n(e){return e&&_context&&(_context.data.push(e),e._ctx=_context),_context},suppressOverwrites:function n(e){return _suppressOverwrites=e}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return _gsap[n]=Tween$1[n]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function n(e,t){for(var s=e._pt;s&&s.p!==t&&s.op!==t&&s.fp!==t;)s=s._next;return s},_addModifiers=function n(e,t){var s=e._targets,r,o,h;for(r in t)for(o=s.length;o--;)h=e._ptLookup[o][r],h&&(h=h.d)&&(h._pt&&(h=_getPluginPropTween(h,r)),h&&h.modifier&&h.modifier(t[r],e,s[o],r))},_buildModifierPlugin=function n(e,t){return{name:e,rawVars:1,init:function(r,o,h){h._onInit=function(c){var a,u;if(_isString(o)&&(a={},_forEachName(o,function(d){return a[d]=1}),o=a),t){a={};for(u in o)a[u]=t(o[u]);o=a}_addModifiers(c,o)}}}},gsap=_gsap.registerPlugin({name:"attr",init:function n(e,t,s,r,o){var h,c,a;this.tween=s;for(h in t)a=e.getAttribute(h)||"",c=this.add(e,"setAttribute",(a||0)+"",t[h],r,o,0,0,h),c.op=h,c.b=a,this._props.push(h)},render:function n(e,t){for(var s=t._pt;s;)_reverting$1?s.set(s.t,s.p,s.b,s):s.r(e,s.d),s=s._next}},{name:"endArray",init:function n(e,t){for(var s=t.length;s--;)this.add(e,s,e[s]||0,t[s],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween$1.version=Timeline.version=gsap.version="3.11.4";_coreReady=1;_windowExists$1()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _win,_doc,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists=function n(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function n(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderPropWithEnd=function n(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},_renderCSSPropWithBeginning=function n(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},_renderRoundedCSSProp=function n(e,t){var s=t.s+t.c*e;t.set(t.t,t.p,~~(s+(s<0?-.5:.5))+t.u,t)},_renderNonTweeningValue=function n(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},_renderNonTweeningValueOnlyAtEnd=function n(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},_setterCSSStyle=function n(e,t,s){return e.style[t]=s},_setterCSSProp=function n(e,t,s){return e.style.setProperty(t,s)},_setterTransform=function n(e,t,s){return e._gsap[t]=s},_setterScale=function n(e,t,s){return e._gsap.scaleX=e._gsap.scaleY=s},_setterScaleWithRender=function n(e,t,s,r,o){var h=e._gsap;h.scaleX=h.scaleY=s,h.renderTransform(o,h)},_setterTransformWithRender=function n(e,t,s,r,o){var h=e._gsap;h[t]=s,h.renderTransform(o,h)},_transformProp="transform",_transformOriginProp=_transformProp+"Origin",_saveStyle=function n(e,t){var s=this,r=this.target,o=r.style;if(e in _transformProps){if(this.tfm=this.tfm||{},e!=="transform"&&(e=_propertyAliases[e]||e,~e.indexOf(",")?e.split(",").forEach(function(h){return s.tfm[h]=_get(r,h)}):this.tfm[e]=r._gsap.x?r._gsap[e]:_get(r,e)),this.props.indexOf(_transformProp)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,t,"")),e=_transformProp}(o||t)&&this.props.push(e,t,o[e])},_removeIndependentTransforms=function n(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},_revertStyle=function n(){var e=this.props,t=this.target,s=t.style,r=t._gsap,o,h;for(o=0;o<e.length;o+=3)e[o+1]?t[e[o]]=e[o+2]:e[o+2]?s[e[o]]=e[o+2]:s.removeProperty(e[o].replace(_capsExp,"-$1").toLowerCase());if(this.tfm){for(h in this.tfm)r[h]=this.tfm[h];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),o=_reverting(),o&&!o.isStart&&!s[_transformProp]&&(_removeIndependentTransforms(s),r.uncache=1)}},_getStyleSaver=function n(e,t){var s={target:e,props:[],revert:_revertStyle,save:_saveStyle};return t&&t.split(",").forEach(function(r){return s.save(r)}),s},_supports3D,_createElement=function n(e,t){var s=_doc.createElementNS?_doc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):_doc.createElement(e);return s.style?s:_doc.createElement(e)},_getComputedProperty=function n(e,t,s){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(_capsExp,"-$1").toLowerCase())||r.getPropertyValue(t)||!s&&n(e,_checkPropPrefix(t)||t,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function n(e,t,s){var r=t||_tempDiv,o=r.style,h=5;if(e in o&&!s)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);h--&&!(_prefixes[h]+e in o););return h<0?null:(h===3?"ms":h>=0?_prefixes[h]:"")+e},_initCore=function n(){_windowExists()&&window.document&&(_win=window,_doc=_win.document,_docElement=_doc.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp=_checkPropPrefix(_transformProp),_transformOriginProp=_transformProp+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap.core.reverting,_pluginInitted=1)},_getBBoxHack=function n(e){var t=_createElement("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,r=this.nextSibling,o=this.style.cssText,h;if(_docElement.appendChild(t),t.appendChild(this),this.style.display="block",e)try{h=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(h=this._gsapBBox());return s&&(r?s.insertBefore(this,r):s.appendChild(this)),_docElement.removeChild(t),this.style.cssText=o,h},_getAttributeFallbacks=function n(e,t){for(var s=t.length;s--;)if(e.hasAttribute(t[s]))return e.getAttribute(t[s])},_getBBox=function n(e){var t;try{t=e.getBBox()}catch{t=_getBBoxHack.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===_getBBoxHack||(t=_getBBoxHack.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+_getAttributeFallbacks(e,["x","cx","x1"])||0,y:+_getAttributeFallbacks(e,["y","cy","y1"])||0,width:0,height:0}:t},_isSVG=function n(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&_getBBox(e))},_removeProperty=function n(e,t){if(t){var s=e.style;t in _transformProps&&t!==_transformOriginProp&&(t=_transformProp),s.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),s.removeProperty(t.replace(_capsExp,"-$1").toLowerCase())):s.removeAttribute(t)}},_addNonTweeningPT=function n(e,t,s,r,o,h){var c=new PropTween(e._pt,t,s,0,1,h?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return e._pt=c,c.b=r,c.e=o,e._props.push(s),c},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function n(e,t,s,r){var o=parseFloat(s)||0,h=(s+"").trim().substr((o+"").length)||"px",c=_tempDiv.style,a=_horizontalExp.test(t),u=e.tagName.toLowerCase()==="svg",d=(u?"client":"offset")+(a?"Width":"Height"),p=100,m=r==="px",g=r==="%",_,y,v,N;return r===h||!o||_nonConvertibleUnits[r]||_nonConvertibleUnits[h]?o:(h!=="px"&&!m&&(o=n(e,t,s,"px")),N=e.getCTM&&_isSVG(e),(g||h==="%")&&(_transformProps[t]||~t.indexOf("adius"))?(_=N?e.getBBox()[a?"width":"height"]:e[d],_round(g?o/_*p:o/100*_)):(c[a?"width":"height"]=p+(m?h:r),y=~t.indexOf("adius")||r==="em"&&e.appendChild&&!u?e:e.parentNode,N&&(y=(e.ownerSVGElement||{}).parentNode),(!y||y===_doc||!y.appendChild)&&(y=_doc.body),v=y._gsap,v&&g&&v.width&&a&&v.time===_ticker.time&&!v.uncache?_round(o/v.width*p):((g||h==="%")&&!_nonStandardLayouts[_getComputedProperty(y,"display")]&&(c.position=_getComputedProperty(e,"position")),y===e&&(c.position="static"),y.appendChild(_tempDiv),_=_tempDiv[d],y.removeChild(_tempDiv),c.position="absolute",a&&g&&(v=_getCache(y),v.time=_ticker.time,v.width=y[d]),_round(m?_*o/p:_&&o?p/_*o:0))))},_get=function n(e,t,s,r){var o;return _pluginInitted||_initCore(),t in _propertyAliases&&t!=="transform"&&(t=_propertyAliases[t],~t.indexOf(",")&&(t=t.split(",")[0])),_transformProps[t]&&t!=="transform"?(o=_parseTransform(e,r),o=t!=="transformOrigin"?o[t]:o.svg?o.origin:_firstTwoOnly(_getComputedProperty(e,_transformOriginProp))+" "+o.zOrigin+"px"):(o=e.style[t],(!o||o==="auto"||r||~(o+"").indexOf("calc("))&&(o=_specialProps[t]&&_specialProps[t](e,t,s)||_getComputedProperty(e,t)||_getProperty(e,t)||(t==="opacity"?1:0))),s&&!~(o+"").trim().indexOf(" ")?_convertToUnit(e,t,o,s)+s:o},_tweenComplexCSSString=function n(e,t,s,r){if(!s||s==="none"){var o=_checkPropPrefix(t,e,1),h=o&&_getComputedProperty(e,o,1);h&&h!==s?(t=o,s=h):t==="borderColor"&&(s=_getComputedProperty(e,"borderTopColor"))}var c=new PropTween(this._pt,e.style,t,0,1,_renderComplexString),a=0,u=0,d,p,m,g,_,y,v,N,w,k,U,ee;if(c.b=s,c.e=r,s+="",r+="",r==="auto"&&(e.style[t]=r,r=_getComputedProperty(e,t)||r,e.style[t]=s),d=[s,r],_colorStringFilter(d),s=d[0],r=d[1],m=s.match(_numWithUnitExp)||[],ee=r.match(_numWithUnitExp)||[],ee.length){for(;p=_numWithUnitExp.exec(r);)v=p[0],w=r.substring(a,p.index),_?_=(_+1)%5:(w.substr(-5)==="rgba("||w.substr(-5)==="hsla(")&&(_=1),v!==(y=m[u++]||"")&&(g=parseFloat(y)||0,U=y.substr((g+"").length),v.charAt(1)==="="&&(v=_parseRelative(g,v)+U),N=parseFloat(v),k=v.substr((N+"").length),a=_numWithUnitExp.lastIndex-k.length,k||(k=k||_config.units[t]||U,a===r.length&&(r+=k,c.e+=k)),U!==k&&(g=_convertToUnit(e,t,y,k)||0),c._pt={_next:c._pt,p:w||u===1?w:",",s:g,c:N-g,m:_&&_<4||t==="zIndex"?Math.round:0});c.c=a<r.length?r.substring(a,r.length):""}else c.r=t==="display"&&r==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(r)&&(c.e=0),this._pt=c,c},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function n(e){var t=e.split(" "),s=t[0],r=t[1]||"50%";return(s==="top"||s==="bottom"||r==="left"||r==="right")&&(e=s,s=r,r=e),t[0]=_keywordToPercent[s]||s,t[1]=_keywordToPercent[r]||r,t.join(" ")},_renderClearProps=function n(e,t){if(t.tween&&t.tween._time===t.tween._dur){var s=t.t,r=s.style,o=t.u,h=s._gsap,c,a,u;if(o==="all"||o===!0)r.cssText="",a=1;else for(o=o.split(","),u=o.length;--u>-1;)c=o[u],_transformProps[c]&&(a=1,c=c==="transformOrigin"?_transformOriginProp:_transformProp),_removeProperty(s,c);a&&(_removeProperty(s,_transformProp),h&&(h.svg&&s.removeAttribute("transform"),_parseTransform(s,1),h.uncache=1,_removeIndependentTransforms(r)))}},_specialProps={clearProps:function n(e,t,s,r,o){if(o.data!=="isFromStart"){var h=e._pt=new PropTween(e._pt,t,s,0,0,_renderClearProps);return h.u=r,h.pr=-10,h.tween=o,e._props.push(s),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function n(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},_getComputedTransformMatrixAsArray=function n(e){var t=_getComputedProperty(e,_transformProp);return _isNullTransform(t)?_identity2DMatrix:t.substr(7).match(_numExp).map(_round)},_getMatrix=function n(e,t){var s=e._gsap||_getCache(e),r=e.style,o=_getComputedTransformMatrixAsArray(e),h,c,a,u;return s.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,o=[a.a,a.b,a.c,a.d,a.e,a.f],o.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:o):(o===_identity2DMatrix&&!e.offsetParent&&e!==_docElement&&!s.svg&&(a=r.display,r.display="block",h=e.parentNode,(!h||!e.offsetParent)&&(u=1,c=e.nextElementSibling,_docElement.appendChild(e)),o=_getComputedTransformMatrixAsArray(e),a?r.display=a:_removeProperty(e,"display"),u&&(c?h.insertBefore(e,c):h?h.appendChild(e):_docElement.removeChild(e))),t&&o.length>6?[o[0],o[1],o[4],o[5],o[12],o[13]]:o)},_applySVGOrigin=function n(e,t,s,r,o,h){var c=e._gsap,a=o||_getMatrix(e,!0),u=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,m=c.yOffset||0,g=a[0],_=a[1],y=a[2],v=a[3],N=a[4],w=a[5],k=t.split(" "),U=parseFloat(k[0])||0,ee=parseFloat(k[1])||0,ie,se,oe,le;s?a!==_identity2DMatrix&&(se=g*v-_*y)&&(oe=U*(v/se)+ee*(-y/se)+(y*w-v*N)/se,le=U*(-_/se)+ee*(g/se)-(g*w-_*N)/se,U=oe,ee=le):(ie=_getBBox(e),U=ie.x+(~k[0].indexOf("%")?U/100*ie.width:U),ee=ie.y+(~(k[1]||k[0]).indexOf("%")?ee/100*ie.height:ee)),r||r!==!1&&c.smooth?(N=U-u,w=ee-d,c.xOffset=p+(N*g+w*y)-N,c.yOffset=m+(N*_+w*v)-w):c.xOffset=c.yOffset=0,c.xOrigin=U,c.yOrigin=ee,c.smooth=!!r,c.origin=t,c.originIsAbsolute=!!s,e.style[_transformOriginProp]="0px 0px",h&&(_addNonTweeningPT(h,c,"xOrigin",u,U),_addNonTweeningPT(h,c,"yOrigin",d,ee),_addNonTweeningPT(h,c,"xOffset",p,c.xOffset),_addNonTweeningPT(h,c,"yOffset",m,c.yOffset)),e.setAttribute("data-svg-origin",U+" "+ee)},_parseTransform=function n(e,t){var s=e._gsap||new GSCache(e);if("x"in s&&!t&&!s.uncache)return s;var r=e.style,o=s.scaleX<0,h="px",c="deg",a=getComputedStyle(e),u=_getComputedProperty(e,_transformOriginProp)||"0",d,p,m,g,_,y,v,N,w,k,U,ee,ie,se,oe,le,ue,he,pe,de,fe,Te,Ce,be,Ae,Pe,xe,Se,Me,Oe,Ie,Fe;return d=p=m=y=v=N=w=k=U=0,g=_=1,s.svg=!!(e.getCTM&&_isSVG(e)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(r[_transformProp]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[_transformProp]!=="none"?a[_transformProp]:"")),r.scale=r.rotate=r.translate="none"),se=_getMatrix(e,s.svg),s.svg&&(s.uncache?(Ae=e.getBBox(),u=s.xOrigin-Ae.x+"px "+(s.yOrigin-Ae.y)+"px",be=""):be=!t&&e.getAttribute("data-svg-origin"),_applySVGOrigin(e,be||u,!!be||s.originIsAbsolute,s.smooth!==!1,se)),ee=s.xOrigin||0,ie=s.yOrigin||0,se!==_identity2DMatrix&&(he=se[0],pe=se[1],de=se[2],fe=se[3],d=Te=se[4],p=Ce=se[5],se.length===6?(g=Math.sqrt(he*he+pe*pe),_=Math.sqrt(fe*fe+de*de),y=he||pe?_atan2(pe,he)*_RAD2DEG:0,w=de||fe?_atan2(de,fe)*_RAD2DEG+y:0,w&&(_*=Math.abs(Math.cos(w*_DEG2RAD))),s.svg&&(d-=ee-(ee*he+ie*de),p-=ie-(ee*pe+ie*fe))):(Fe=se[6],Oe=se[7],xe=se[8],Se=se[9],Me=se[10],Ie=se[11],d=se[12],p=se[13],m=se[14],oe=_atan2(Fe,Me),v=oe*_RAD2DEG,oe&&(le=Math.cos(-oe),ue=Math.sin(-oe),be=Te*le+xe*ue,Ae=Ce*le+Se*ue,Pe=Fe*le+Me*ue,xe=Te*-ue+xe*le,Se=Ce*-ue+Se*le,Me=Fe*-ue+Me*le,Ie=Oe*-ue+Ie*le,Te=be,Ce=Ae,Fe=Pe),oe=_atan2(-de,Me),N=oe*_RAD2DEG,oe&&(le=Math.cos(-oe),ue=Math.sin(-oe),be=he*le-xe*ue,Ae=pe*le-Se*ue,Pe=de*le-Me*ue,Ie=fe*ue+Ie*le,he=be,pe=Ae,de=Pe),oe=_atan2(pe,he),y=oe*_RAD2DEG,oe&&(le=Math.cos(oe),ue=Math.sin(oe),be=he*le+pe*ue,Ae=Te*le+Ce*ue,pe=pe*le-he*ue,Ce=Ce*le-Te*ue,he=be,Te=Ae),v&&Math.abs(v)+Math.abs(y)>359.9&&(v=y=0,N=180-N),g=_round(Math.sqrt(he*he+pe*pe+de*de)),_=_round(Math.sqrt(Ce*Ce+Fe*Fe)),oe=_atan2(Te,Ce),w=Math.abs(oe)>2e-4?oe*_RAD2DEG:0,U=Ie?1/(Ie<0?-Ie:Ie):0),s.svg&&(be=e.getAttribute("transform"),s.forceCSS=e.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(e,_transformProp)),be&&e.setAttribute("transform",be))),Math.abs(w)>90&&Math.abs(w)<270&&(o?(g*=-1,w+=y<=0?180:-180,y+=y<=0?180:-180):(_*=-1,w+=w<=0?180:-180)),t=t||s.uncache,s.x=d-((s.xPercent=d&&(!t&&s.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-d)?-50:0)))?e.offsetWidth*s.xPercent/100:0)+h,s.y=p-((s.yPercent=p&&(!t&&s.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-p)?-50:0)))?e.offsetHeight*s.yPercent/100:0)+h,s.z=m+h,s.scaleX=_round(g),s.scaleY=_round(_),s.rotation=_round(y)+c,s.rotationX=_round(v)+c,s.rotationY=_round(N)+c,s.skewX=w+c,s.skewY=k+c,s.transformPerspective=U+h,(s.zOrigin=parseFloat(u.split(" ")[2])||0)&&(r[_transformOriginProp]=_firstTwoOnly(u)),s.xOffset=s.yOffset=0,s.force3D=_config.force3D,s.renderTransform=s.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,s.uncache=0,s},_firstTwoOnly=function n(e){return(e=e.split(" "))[0]+" "+e[1]},_addPxTranslate=function n(e,t,s){var r=getUnit(t);return _round(parseFloat(t)+parseFloat(_convertToUnit(e,"x",s+"px",r)))+r},_renderNon3DTransforms=function n(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,_renderCSSTransforms(e,t)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function n(e,t){var s=t||this,r=s.xPercent,o=s.yPercent,h=s.x,c=s.y,a=s.z,u=s.rotation,d=s.rotationY,p=s.rotationX,m=s.skewX,g=s.skewY,_=s.scaleX,y=s.scaleY,v=s.transformPerspective,N=s.force3D,w=s.target,k=s.zOrigin,U="",ee=N==="auto"&&e&&e!==1||N===!0;if(k&&(p!==_zeroDeg||d!==_zeroDeg)){var ie=parseFloat(d)*_DEG2RAD,se=Math.sin(ie),oe=Math.cos(ie),le;ie=parseFloat(p)*_DEG2RAD,le=Math.cos(ie),h=_addPxTranslate(w,h,se*le*-k),c=_addPxTranslate(w,c,-Math.sin(ie)*-k),a=_addPxTranslate(w,a,oe*le*-k+k)}v!==_zeroPx&&(U+="perspective("+v+_endParenthesis),(r||o)&&(U+="translate("+r+"%, "+o+"%) "),(ee||h!==_zeroPx||c!==_zeroPx||a!==_zeroPx)&&(U+=a!==_zeroPx||ee?"translate3d("+h+", "+c+", "+a+") ":"translate("+h+", "+c+_endParenthesis),u!==_zeroDeg&&(U+="rotate("+u+_endParenthesis),d!==_zeroDeg&&(U+="rotateY("+d+_endParenthesis),p!==_zeroDeg&&(U+="rotateX("+p+_endParenthesis),(m!==_zeroDeg||g!==_zeroDeg)&&(U+="skew("+m+", "+g+_endParenthesis),(_!==1||y!==1)&&(U+="scale("+_+", "+y+_endParenthesis),w.style[_transformProp]=U||"translate(0, 0)"},_renderSVGTransforms=function n(e,t){var s=t||this,r=s.xPercent,o=s.yPercent,h=s.x,c=s.y,a=s.rotation,u=s.skewX,d=s.skewY,p=s.scaleX,m=s.scaleY,g=s.target,_=s.xOrigin,y=s.yOrigin,v=s.xOffset,N=s.yOffset,w=s.forceCSS,k=parseFloat(h),U=parseFloat(c),ee,ie,se,oe,le;a=parseFloat(a),u=parseFloat(u),d=parseFloat(d),d&&(d=parseFloat(d),u+=d,a+=d),a||u?(a*=_DEG2RAD,u*=_DEG2RAD,ee=Math.cos(a)*p,ie=Math.sin(a)*p,se=Math.sin(a-u)*-m,oe=Math.cos(a-u)*m,u&&(d*=_DEG2RAD,le=Math.tan(u-d),le=Math.sqrt(1+le*le),se*=le,oe*=le,d&&(le=Math.tan(d),le=Math.sqrt(1+le*le),ee*=le,ie*=le)),ee=_round(ee),ie=_round(ie),se=_round(se),oe=_round(oe)):(ee=p,oe=m,ie=se=0),(k&&!~(h+"").indexOf("px")||U&&!~(c+"").indexOf("px"))&&(k=_convertToUnit(g,"x",h,"px"),U=_convertToUnit(g,"y",c,"px")),(_||y||v||N)&&(k=_round(k+_-(_*ee+y*se)+v),U=_round(U+y-(_*ie+y*oe)+N)),(r||o)&&(le=g.getBBox(),k=_round(k+r/100*le.width),U=_round(U+o/100*le.height)),le="matrix("+ee+","+ie+","+se+","+oe+","+k+","+U+")",g.setAttribute("transform",le),w&&(g.style[_transformProp]=le)},_addRotationalPropTween=function n(e,t,s,r,o){var h=360,c=_isString(o),a=parseFloat(o)*(c&&~o.indexOf("rad")?_RAD2DEG:1),u=a-r,d=r+u+"deg",p,m;return c&&(p=o.split("_")[1],p==="short"&&(u%=h,u!==u%(h/2)&&(u+=u<0?h:-h)),p==="cw"&&u<0?u=(u+h*_bigNum)%h-~~(u/h)*h:p==="ccw"&&u>0&&(u=(u-h*_bigNum)%h-~~(u/h)*h)),e._pt=m=new PropTween(e._pt,t,s,r,u,_renderPropWithEnd),m.e=d,m.u="deg",e._props.push(s),m},_assign=function n(e,t){for(var s in t)e[s]=t[s];return e},_addRawTransformPTs=function n(e,t,s){var r=_assign({},s._gsap),o="perspective,force3D,transformOrigin,svgOrigin",h=s.style,c,a,u,d,p,m,g,_;r.svg?(u=s.getAttribute("transform"),s.setAttribute("transform",""),h[_transformProp]=t,c=_parseTransform(s,1),_removeProperty(s,_transformProp),s.setAttribute("transform",u)):(u=getComputedStyle(s)[_transformProp],h[_transformProp]=t,c=_parseTransform(s,1),h[_transformProp]=u);for(a in _transformProps)u=r[a],d=c[a],u!==d&&o.indexOf(a)<0&&(g=getUnit(u),_=getUnit(d),p=g!==_?_convertToUnit(s,a,u,_):parseFloat(u),m=parseFloat(d),e._pt=new PropTween(e._pt,c,a,p,m-p,_renderCSSProp),e._pt.u=_||0,e._props.push(a));_assign(c,r)};_forEachName("padding,margin,Width,Radius",function(n,e){var t="Top",s="Right",r="Bottom",o="Left",h=(e<3?[t,s,r,o]:[t+o,t+s,r+s,r+o]).map(function(c){return e<2?n+c:"border"+c+n});_specialProps[e>1?"border"+n:n]=function(c,a,u,d,p){var m,g;if(arguments.length<4)return m=h.map(function(_){return _get(c,_,u)}),g=m.join(" "),g.split(m[0]).length===5?m[0]:g;m=(d+"").split(" "),g={},h.forEach(function(_,y){return g[_]=m[y]=m[y]||m[(y-1)/2|0]}),c.init(a,g,p)}});var CSSPlugin={name:"css",register:_initCore,targetTest:function n(e){return e.style&&e.nodeType},init:function n(e,t,s,r,o){var h=this._props,c=e.style,a=s.vars.startAt,u,d,p,m,g,_,y,v,N,w,k,U,ee,ie,se,oe;_pluginInitted||_initCore(),this.styles=this.styles||_getStyleSaver(e),oe=this.styles.props,this.tween=s;for(y in t)if(y!=="autoRound"&&(d=t[y],!(_plugins[y]&&_checkPlugin(y,t,s,r,e,o)))){if(g=typeof d,_=_specialProps[y],g==="function"&&(d=d.call(s,r,e,o),g=typeof d),g==="string"&&~d.indexOf("random(")&&(d=_replaceRandom(d)),_)_(this,e,y,d,s)&&(se=1);else if(y.substr(0,2)==="--")u=(getComputedStyle(e).getPropertyValue(y)+"").trim(),d+="",_colorExp.lastIndex=0,_colorExp.test(u)||(v=getUnit(u),N=getUnit(d)),N?v!==N&&(u=_convertToUnit(e,y,u,N)+N):v&&(d+=v),this.add(c,"setProperty",u,d,r,o,0,0,y),h.push(y),oe.push(y,0,c[y]);else if(g!=="undefined"){if(a&&y in a?(u=typeof a[y]=="function"?a[y].call(s,r,e,o):a[y],_isString(u)&&~u.indexOf("random(")&&(u=_replaceRandom(u)),getUnit(u+"")||(u+=_config.units[y]||getUnit(_get(e,y))||""),(u+"").charAt(1)==="="&&(u=_get(e,y))):u=_get(e,y),m=parseFloat(u),w=g==="string"&&d.charAt(1)==="="&&d.substr(0,2),w&&(d=d.substr(2)),p=parseFloat(d),y in _propertyAliases&&(y==="autoAlpha"&&(m===1&&_get(e,"visibility")==="hidden"&&p&&(m=0),oe.push("visibility",0,c.visibility),_addNonTweeningPT(this,c,"visibility",m?"inherit":"hidden",p?"inherit":"hidden",!p)),y!=="scale"&&y!=="transform"&&(y=_propertyAliases[y],~y.indexOf(",")&&(y=y.split(",")[0]))),k=y in _transformProps,k){if(this.styles.save(y),U||(ee=e._gsap,ee.renderTransform&&!t.parseTransform||_parseTransform(e,t.parseTransform),ie=t.smoothOrigin!==!1&&ee.smooth,U=this._pt=new PropTween(this._pt,c,_transformProp,0,1,ee.renderTransform,ee,0,-1),U.dep=1),y==="scale")this._pt=new PropTween(this._pt,ee,"scaleY",ee.scaleY,(w?_parseRelative(ee.scaleY,w+p):p)-ee.scaleY||0,_renderCSSProp),this._pt.u=0,h.push("scaleY",y),y+="X";else if(y==="transformOrigin"){oe.push(_transformOriginProp,0,c[_transformOriginProp]),d=_convertKeywordsToPercentages(d),ee.svg?_applySVGOrigin(e,d,0,ie,0,this):(N=parseFloat(d.split(" ")[2])||0,N!==ee.zOrigin&&_addNonTweeningPT(this,ee,"zOrigin",ee.zOrigin,N),_addNonTweeningPT(this,c,y,_firstTwoOnly(u),_firstTwoOnly(d)));continue}else if(y==="svgOrigin"){_applySVGOrigin(e,d,1,ie,0,this);continue}else if(y in _rotationalProperties){_addRotationalPropTween(this,ee,y,m,w?_parseRelative(m,w+d):d);continue}else if(y==="smoothOrigin"){_addNonTweeningPT(this,ee,"smooth",ee.smooth,d);continue}else if(y==="force3D"){ee[y]=d;continue}else if(y==="transform"){_addRawTransformPTs(this,d,e);continue}}else y in c||(y=_checkPropPrefix(y)||y);if(k||(p||p===0)&&(m||m===0)&&!_complexExp.test(d)&&y in c)v=(u+"").substr((m+"").length),p||(p=0),N=getUnit(d)||(y in _config.units?_config.units[y]:v),v!==N&&(m=_convertToUnit(e,y,u,N)),this._pt=new PropTween(this._pt,k?ee:c,y,m,(w?_parseRelative(m,w+p):p)-m,!k&&(N==="px"||y==="zIndex")&&t.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=N||0,v!==N&&N!=="%"&&(this._pt.b=u,this._pt.r=_renderCSSPropWithBeginning);else if(y in c)_tweenComplexCSSString.call(this,e,y,u,w?w+d:d);else if(y in e)this.add(e,y,u||e[y],w?w+d:d,r,o);else if(y!=="parseTransform"){_missingPlugin(y,d);continue}k||(y in c?oe.push(y,0,c[y]):oe.push(y,1,u||e[y])),h.push(y)}}se&&_sortPropTweensByPriority(this)},render:function n(e,t){if(t.tween._time||!_reverting())for(var s=t._pt;s;)s.r(e,s.d),s=s._next;else t.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function n(e,t,s){var r=_propertyAliases[t];return r&&r.indexOf(",")<0&&(t=r),t in _transformProps&&t!==_transformOriginProp&&(e._gsap.x||_get(e,"x"))?s&&_recentSetterPlugin===s?t==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=s||{})&&(t==="scale"?_setterScaleWithRender:_setterTransformWithRender):e.style&&!_isUndefined(e.style[t])?_setterCSSStyle:~t.indexOf("-")?_setterCSSProp:_getSetter(e,t)},core:{_removeProperty,_getMatrix}};gsap.utils.checkPrefix=_checkPropPrefix;gsap.core.getStyleSaver=_getStyleSaver;(function(n,e,t,s){var r=_forEachName(n+","+e+","+t,function(o){_transformProps[o]=1});_forEachName(e,function(o){_config.units[o]="deg",_rotationalProperties[o]=1}),_propertyAliases[r[13]]=n+","+e,_forEachName(s,function(o){var h=o.split(":");_propertyAliases[h[1]]=r[h[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){_config.units[n]="px"});gsap.registerPlugin(CSSPlugin);var gsapWithCSS=gsap.registerPlugin(CSSPlugin)||gsap;gsapWithCSS.core.Tween;class BGM{constructor(){ne(this,"currentAlias");ne(this,"current");ne(this,"volume",1)}async play(e,t){if(this.currentAlias!==e){if(this.current){const s=this.current;gsapWithCSS.killTweensOf(s),gsapWithCSS.to(s,{volume:0,duration:1,ease:"linear"}).then(()=>{s.stop()})}this.current=qt.find(e),this.currentAlias=e,this.current.play({loop:!0,...t}),this.current.volume=0,gsapWithCSS.killTweensOf(this.current),gsapWithCSS.to(this.current,{volume:this.volume,duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(e){this.volume=e,this.current&&(this.current.volume=this.volume)}}class SFX{constructor(){ne(this,"volume",1)}play(e,t){const s=this.volume*((t==null?void 0:t.volume)??1);qt.play(e,{...t,volume:s})}getVolume(){return this.volume}setVolume(e){this.volume=e}}function setMasterVolume(n){qt.volumeAll=n,n?qt.unmuteAll():qt.muteAll()}const bgm=new BGM,sfx=new SFX,defaultLabelStyle={fontFamily:"Epilogue Regular",fill:16777215,align:"left"};class Label extends Text{constructor(e,t,s=!0,r){t={...defaultLabelStyle,...t},super(e,t,r),s&&this.anchor.set(.5)}}const defaultFsLogoOptions={scale:.8};class FsLogo extends Container{constructor(t={}){super();ne(this,"image");const s={...defaultFsLogoOptions,...t};this.image=Sprite.from("logo-fs"),this.image.scale.set(s.scale),this.image.anchor.set(.5),this.addChild(this.image)}}var dist={},Collector$1={};Object.defineProperty(Collector$1,"__esModule",{value:!0});Collector$1.Collector=void 0;class Collector{constructor(e){this.emit=(...t)=>{e.emitCollecting(this,t)}}}Collector$1.Collector=Collector;var CollectorArray$1={};Object.defineProperty(CollectorArray$1,"__esModule",{value:!0});CollectorArray$1.CollectorArray=void 0;const Collector_1$3=Collector$1;class CollectorArray extends Collector_1$3.Collector{constructor(){super(...arguments),this.result=[]}handleResult(e){return this.result.push(e),!0}getResult(){return this.result}reset(){this.result.length=0}}CollectorArray$1.CollectorArray=CollectorArray;var CollectorLast$1={};Object.defineProperty(CollectorLast$1,"__esModule",{value:!0});CollectorLast$1.CollectorLast=void 0;const Collector_1$2=Collector$1;class CollectorLast extends Collector_1$2.Collector{handleResult(e){return this.result=e,!0}getResult(){return this.result}reset(){delete this.result}}CollectorLast$1.CollectorLast=CollectorLast;var CollectorUntil0$1={};Object.defineProperty(CollectorUntil0$1,"__esModule",{value:!0});CollectorUntil0$1.CollectorUntil0=void 0;const Collector_1$1=Collector$1;class CollectorUntil0 extends Collector_1$1.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,this.result}getResult(){return this.result}reset(){this.result=!1}}CollectorUntil0$1.CollectorUntil0=CollectorUntil0;var CollectorWhile0$1={};Object.defineProperty(CollectorWhile0$1,"__esModule",{value:!0});CollectorWhile0$1.CollectorWhile0=void 0;const Collector_1=Collector$1;class CollectorWhile0 extends Collector_1.Collector{constructor(){super(...arguments),this.result=!1}handleResult(e){return this.result=e,!this.result}getResult(){return this.result}reset(){this.result=!1}}CollectorWhile0$1.CollectorWhile0=CollectorWhile0;var Signal$1={},SignalConnection={};Object.defineProperty(SignalConnection,"__esModule",{value:!0});SignalConnection.SignalConnectionImpl=void 0;class SignalConnectionImpl{constructor(e,t){this.link=e,this.parentCleanup=t}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(e){this.link&&this.link.setEnabled(e)}get enabled(){return this.link!==null&&this.link.isEnabled()}}SignalConnection.SignalConnectionImpl=SignalConnectionImpl;var SignalLink$1={};Object.defineProperty(SignalLink$1,"__esModule",{value:!0});SignalLink$1.SignalLink=void 0;class SignalLink{constructor(e=null,t=null,s=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=e??this,this.next=t??this,this.order=s}isEnabled(){return this.enabled&&!this.newLink}setEnabled(e){this.enabled=e}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(e,t){let s=this.prev;for(;s!==this&&!(s.order<=t);)s=s.prev;const r=new SignalLink(s,s.next,t);return r.callback=e,s.next=r,r.next.prev=r,r}}SignalLink$1.SignalLink=SignalLink;Object.defineProperty(Signal$1,"__esModule",{value:!0});Signal$1.Signal=void 0;const SignalConnection_1=SignalConnection,SignalLink_1=SignalLink$1;class Signal{constructor(){this.head=new SignalLink_1.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(e,t=0){this.connectionsCount++;const s=this.head.insert(e,t);return this.emitDepth>0&&(this.hasNewLinks=!0,s.newLink=!0),new SignalConnection_1.SignalConnectionImpl(s,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(e){for(let t=this.head.next;t!==this.head;t=t.next)if(t.callback===e)return this.decrementConnectionCount(),t.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...e){this.emitDepth++;for(let t=this.head.next;t!==this.head;t=t.next)t.isEnabled()&&t.callback&&t.callback.apply(null,e);this.emitDepth--,this.unsetNewLink()}emitCollecting(e,t){this.emitDepth++;for(let s=this.head.next;s!==this.head;s=s.next)if(s.isEnabled()&&s.callback){const r=s.callback.apply(null,t);if(!e.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let e=this.head.next;e!==this.head;e=e.next)e.newLink=!1;this.hasNewLinks=!1}}}Signal$1.Signal=Signal;var SignalConnections$1={};Object.defineProperty(SignalConnections$1,"__esModule",{value:!0});SignalConnections$1.SignalConnections=void 0;class SignalConnections{constructor(){this.list=[]}add(e){this.list.push(e)}disconnectAll(){for(const e of this.list)e.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}SignalConnections$1.SignalConnections=SignalConnections;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SignalConnections=n.Signal=n.CollectorWhile0=n.CollectorUntil0=n.CollectorLast=n.CollectorArray=n.Collector=void 0;var e=Collector$1;Object.defineProperty(n,"Collector",{enumerable:!0,get:function(){return e.Collector}});var t=CollectorArray$1;Object.defineProperty(n,"CollectorArray",{enumerable:!0,get:function(){return t.CollectorArray}});var s=CollectorLast$1;Object.defineProperty(n,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=CollectorUntil0$1;Object.defineProperty(n,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var o=CollectorWhile0$1;Object.defineProperty(n,"CollectorWhile0",{enumerable:!0,get:function(){return o.CollectorWhile0}});var h=Signal$1;Object.defineProperty(n,"Signal",{enumerable:!0,get:function(){return h.Signal}});var c=SignalConnections$1;Object.defineProperty(n,"SignalConnections",{enumerable:!0,get:function(){return c.SignalConnections}})})(dist);let Button$1=class{constructor(e){this.view=e,this.createEvents(),this.enabled=!0}down(e){}up(e){}hover(e){}press(e){}out(e){}upOut(e){}get isDown(){return this._isDown}set enabled(e){this._enabled=e,this.view.interactive=e,this.view.cursor=e?"pointer":"default",e||this._processUp()}get enabled(){return this._enabled}_processUp(e){this._isDown&&this.onUp.emit(this,e),this._isDown=!1}_processUpOut(e){this._isDown&&(this.onUp.emit(this,e),this.onUpOut.emit(this,e)),this._isDown=!1}_processOut(e){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,e))}_upOut(e){this.upOut(e)}_out(e){this.out(e)}createEvents(){this.onPress=new dist.Signal,this.onDown=new dist.Signal,this.onUp=new dist.Signal,this.onHover=new dist.Signal,this.onOut=new dist.Signal,this.onUpOut=new dist.Signal,this.view.on("pointerdown",e=>{this._isDown=!0,this.onDown.emit(this,e)}),this.view.on("pointerup",e=>{this._processUp(e)}),this.view.on("pointerupoutside",e=>{this._processUpOut(e)}),this.view.on("pointerout",e=>{this._processOut(e)}),this.view.on("pointertap",e=>{this._isDown=!1,this.onPress.emit(this,e),this.press(e)}),this.view.on("pointerover",e=>{this._isMouseIn=!0,this.onHover.emit(this,e)}),this.onDown.connect((e,t)=>{this.down(t)}),this.onUp.connect((e,t)=>{this.up(t)}),this.onUpOut.connect((e,t)=>{this._upOut(t)}),isMobile.any||this.onHover.connect((e,t)=>{this.hover(t)}),this.onOut.connect((e,t)=>{this._out(t)})}};function getView(n){return typeof n=="string"?Sprite.from(n):n}class Switcher extends Container{constructor(e,t,s=0){super(),this.active=0,this.innerView=new Container,this.addChild(this.innerView),this.active=s,e.map((r,o)=>{const h=getView(r);return this.innerView.addChild(h),h.visible=o===s,h}),this.onChange=new dist.Signal,t?Array.isArray(t)?this.triggerEvents=new Set(t):this.triggerEvents=new Set([t]):this.triggerEvents=new Set(["onPress"]),this.events=new Button$1(this),this.events.onPress.connect(()=>this.switch(this.nextActive,"onPress")),this.events.onDown.connect(()=>this.switch(this.nextActive,"onDown")),this.events.onUp.connect(()=>this.switch(this.nextActive,"onUp")),this.events.onHover.connect(()=>this.switch(this.nextActive,"onHover")),this.events.onOut.connect(()=>this.switch(this.nextActive,"onOut")),this.events.onUpOut.connect(()=>this.switch(this.nextActive,"onUpOut"))}get activeView(){return this.views[this.active]}get views(){return this.innerView.children}switch(e,t){if(!this.triggerEvents.has(t))return;this.activeView.visible=!1,this.active=e!==void 0?e:this.nextActive;const s=this.views[this.active];s.visible=!0;const r=this.views.length>2?this.active:this.active===1;this.onChange.emit(r)}forceSwitch(e){this.activeView.visible=!1,this.active=e!==void 0?e:this.nextActive;const t=this.views[this.active];t.visible=!0}get nextActive(){return this.active<this.views.length-1?this.active+1:0}}function removeHitBox(...n){n.forEach(e=>e&&(e.hitArea=new Rectangle))}class ProgressBar extends Container{constructor({bg:e,fill:t,fillOffset:s,progress:r}){if(super(),this.progressStart=0,this._progress=0,this.innerView=new Container,this.addChild(this.innerView),this.bg=new Container,this.bg.addChild(getView(e)),this.innerView.addChild(this.bg),t){this.fill=new Container,this.fill.addChild(getView(t));const o=(s==null?void 0:s.x)??0,h=(s==null?void 0:s.y)??0;this.fill.x=(this.bg.width-this.fill.width)/2+o,this.fill.y=(this.bg.height-this.fill.height)/2+h,this.fillMask=new Graphics,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}this.progress=r}validate(e){return e=Math.round(e),e<0?0:e>100?100:e}set progress(e){this._progress=this.validate(e);const t=this.bg.width/100*this.progressStart,s=this.bg.width/100*this._progress-t;this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(t,0,s,this.fill.height)}get progress(){return this._progress}}class SliderBase extends ProgressBar{constructor(e){super({bg:e.bg,fill:e.fill??e.bg,fillOffset:e.fillOffset}),this.dragging=0,this.min=0,this.max=100,e.slider1&&(this.slider1=this.createSlider(e.slider1),e.showValue&&(this.value1Text=new Text("",e.valueTextStyle||{fill:16777215}),this.value1Text.anchor.set(.5),this.addChild(this.value1Text))),e.slider2&&(this.slider2=this.createSlider(e.slider2),e.showValue&&(this.value2Text=new Text("",e.valueTextStyle||{fill:16777215}),this.value2Text.anchor.set(.5),this.addChild(this.value2Text))),this.min=e.min??0,this.max=e.max??100,this.activate()}activate(){this.bg.interactive=!0,this.bg.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this),this.slider1&&(this.slider1.interactive=!0,this.slider1.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),this.slider2&&(this.slider2.interactive=!0,this.slider2.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),removeHitBox(this.fill,this.value1Text,this.value2Text)}createSlider(e){const t=getView(e);t.x=t.width/2;const s=new Container;return s.addChild(t),t instanceof Sprite&&t.anchor.set(.5),s.y=this.bg.height/2,this.addChild(s),s}startUpdate(e){this.dragging=1,this.update(e)}endUpdate(){this.dragging&&(this.dragging=0)}update(e){}}function getTextView(n){return n instanceof Text?n:new Text(n)}function fitToView(n,e,t=0){let s=e.scale.x,r=e.scale.y;const o=n.width-t*2,h=n.height-t*2,c=o-Math.round(e.width),a=h-Math.round(e.height);c<0&&(s=o/(e.width*s)),a<0&&(r=h/(e.height*r)),(s<=0||r<=0)&&(e.visible=!1),e.scale.set(Math.min(s,r))}/*!
 * tweedle.js - v2.0.1
 * Compiled Tue, 20 Dec 2022 14:21:53 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let NOW;typeof self>"u"&&typeof process<"u"&&process.hrtime?NOW=function(){const n=process.hrtime();return n[0]*1e3+n[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?NOW=self.performance.now.bind(self.performance):Date.now!==void 0?NOW=Date.now:NOW=function(){return new Date().getTime()};class Group{constructor(){Group.prototype.__init.call(this),Group.prototype.__init2.call(this),Group.prototype.__init3.call(this),Group.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Group._shared||(Group._shared=new Group),Group._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=NOW}getAll(){return Object.keys(this._tweens).map(e=>this._tweens[e])}removeAll(){this._tweens={}}add(e){this._tweens[e.getId()]=e}remove(e){delete this._tweens[e.getId()]}update(e,t=!1){if(e==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),e=0):e=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const o=this._tweens[s[r]];o&&o.update(e,!0)==!1&&!t&&delete this._tweens[s[r]]}return!0}}const Easing={Step:{None(n){return n<.5?0:1}},Linear:{None(n){return n}},Quadratic:{In(n){return n*n},Out(n){return n*(2-n)},InOut(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In(n){return n*n*n},Out(n){return--n*n*n+1},InOut(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In(n){return n*n*n*n},Out(n){return 1- --n*n*n*n},InOut(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In(n){return n*n*n*n*n},Out(n){return--n*n*n*n*n+1},InOut(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In(n){return 1-Math.cos(n*Math.PI/2)},Out(n){return Math.sin(n*Math.PI/2)},InOut(n){return .5*(1-Math.cos(Math.PI*n))}},Exponential:{In(n){return n==0?0:Math.pow(1024,n-1)},Out(n){return n==1?1:1-Math.pow(2,-10*n)},InOut(n){return n==0?0:n==1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}},Circular:{In(n){return 1-Math.sqrt(1-n*n)},Out(n){return Math.sqrt(1- --n*n)},InOut(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In(n){return n==0?0:n==1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out(n){return n==0?0:n==1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut(n){return n==0?0:n==1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}},Back:{In(n){return n*n*((1.70158+1)*n-1.70158)},Out(n){return--n*n*((1.70158+1)*n+1.70158)+1},InOut(n){const e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}},Bounce:{In(n){return 1-Easing.Bounce.Out(1-n)},Out(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut(n){return n<.5?Easing.Bounce.In(n*2)*.5:Easing.Bounce.Out(n*2-1)*.5+.5}}},Interpolation={Geom:{Linear(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.Linear;return e<0?o(n[0],n[1],s):e>1?o(n[t],n[t-1],t-s):o(n[r],n[r+1>t?t:r+1],s-r)},Bezier(n,e){let t=0;const s=n.length-1,r=Math.pow,o=Interpolation.Utils.Bernstein;for(let h=0;h<=s;h++)t+=o(s,h)*r(1-e,s-h)*r(e,h)*n[h];return t},QuadraticBezier(n,e){let t=0;const s=n.length-1;if(e==1)return n[s];const r=Math.pow,o=Interpolation.Utils.Bernstein,h=s*e,c=Math.floor(h),a=(h-c)*.5+.5*(c%2),u=c-c%2,d=u+1,p=u+2;return t+=o(2,0)*r(1-a,2-0)*r(a,0)*n[u],t+=o(2,1)*r(1-a,2-1)*r(a,1)*n[d],t+=o(2,2)*r(1-a,2-2)*r(a,2)*n[p],t},CubicBezier(n,e){let t=0;const s=n.length-1;if(e==1)return n[s];const r=Math.pow,o=Interpolation.Utils.Bernstein,h=s*e,c=Math.floor(h),a=(h-c)*(1/3)+1/3*(c%3),u=c-c%3,d=u+1,p=u+2,m=u+3;return t+=o(3,0)*r(1-a,3-0)*r(a,0)*n[u],t+=o(3,1)*r(1-a,3-1)*r(a,1)*n[d],t+=o(3,2)*r(1-a,3-2)*r(a,2)*n[p],t+=o(3,3)*r(1-a,3-3)*r(a,3)*n[m],t},CatmullRom(n,e){const t=n.length-1;let s=t*e,r=Math.floor(s);const o=Interpolation.Utils.CatmullRom;return n[0]==n[t]?(e<0&&(r=Math.floor(s=t*(1+e))),o(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],s-r)):e<0?n[0]-(o(n[0],n[0],n[1],n[1],-s)-n[0]):e>1?n[t]-(o(n[t],n[t],n[t-1],n[t-1],s-t)-n[t]):o(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],s-r)}},Angle:{Radians(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.WrapLinear;return e<0?o(n[0],n[1],s,2*Math.PI):e>1?o(n[t],n[t-1],t-s,2*Math.PI):o(n[r],n[r+1>t?t:r+1],s-r,2*Math.PI)},Degrees(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.WrapLinear;return e<0?o(n[0],n[1],s,360):e>1?o(n[t],n[t-1],t-s,360):o(n[r],n[r+1>t?t:r+1],s-r,360)}},Color:{RGB(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.RGBLinear;return e<0?o(n[0],n[1],s):e>1?o(n[t],n[t-1],t-s):o(n[r],n[r+1>t?t:r+1],s-r)},HSV(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.HSVLinear;return e<0?o(n[0],n[1],s):e>1?o(n[t],n[t-1],t-s):o(n[r],n[r+1>t?t:r+1],s-r)},HCL(n,e){const t=n.length-1,s=t*e,r=Math.floor(s),o=Interpolation.Utils.HCLLinear;return e<0?o(n[0],n[1],s):e>1?o(n[t],n[t-1],t-s):o(n[r],n[r+1>t?t:r+1],s-r)}},Utils:{RGBsplit(n){const e=n>>24&255,t=n>>16&255,s=n>>8&255,r=n&255;return{a:e,r:t,g:s,b:r}},HSVsplit(n){const e=Interpolation.Utils.RGBsplit(n);e.r/=255,e.g/=255,e.b/=255;const t=Math.max(e.r,e.g,e.b),s=Math.min(e.r,e.g,e.b);let r;const o=t,h=t-s,c=t==0?0:h/t;if(t==s)r=0;else{switch(t){case e.r:r=(e.g-e.b)/h+(e.g<e.b?6:0);break;case e.g:r=(e.b-e.r)/h+2;break;case e.b:r=(e.r-e.g)/h+4;break}r/=6}return{a:e.a,h:r,s:c,v:o}},HSVJoin(n){let e,t,s;const r=Math.floor(n.h*6),o=n.h*6-r,h=n.v*(1-n.s),c=n.v*(1-o*n.s),a=n.v*(1-(1-o)*n.s);switch(r%6){case 0:e=n.v,t=a,s=h;break;case 1:e=c,t=n.v,s=h;break;case 2:e=h,t=n.v,s=a;break;case 3:e=h,t=c,s=n.v;break;case 4:e=a,t=h,s=n.v;break;case 5:e=n.v,t=h,s=c;break}return n.a<<24|e<<16|t<<8|s},HCLSplit(n){const s=.530454533953517,r=Interpolation.Utils.RGBsplit(n),o={a:r.a,h:0,c:0,l:0};let h=0;const c=Math.min(r.r,Math.min(r.g,r.b)),a=Math.max(r.r,Math.max(r.g,r.b));let u=3/100;return o.c=a-c,o.c!=0&&(h=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,u*=c/a),u=Math.exp(u),o.h=(h/2-Math.min(h%1,-h%1)/6)%1,o.c*=u,o.l=Interpolation.Utils.Linear(-c,a,u)/(s*2),o},HCLJoin(n){const s=.530454533953517,r={a:n.a,r:0,g:0,b:0};if(n.l!=0){let o=n.h;const h=n.c,c=n.l*s,a=Math.exp((1-h/(2*c))*(3/100)),u=(2*c-h)/(2*a-1),d=h/a,p=(o+Math.min(2*o%1/4,-2*o%1/8))*Math.PI*2;let m;o*=6,o<=.999?(m=Math.tan(p),r.r=1,r.g=m/(1+m)):o<=1.001?(r.r=1,r.g=1):o<=2?(m=Math.tan(p),r.r=(1+m)/m,r.g=1):o<=3?(m=Math.tan(p),r.g=1,r.b=1+m):o<=3.999?(m=Math.tan(p),r.g=1/(1+m),r.b=1):o<=4.001?(r.g=0,r.b=1):o<=5?(m=Math.tan(p),r.r=-1/m,r.b=1):(m=Math.tan(p),r.r=1,r.b=-m),r.r=r.r*d+u,r.g=r.g*d+u,r.b=r.b*d+u}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(n,e,t,s){let r;return n=(n+s*Math.trunc(Math.abs(n/s)))%s,e=(e+s*Math.trunc(Math.abs(e/s)))%s,Math.abs(n-e)<=.5*s?r=Interpolation.Utils.Linear(n,e,t):(n<e?r=Interpolation.Utils.Linear(n+s,e,t):r=Interpolation.Utils.Linear(n,e+s,t),r=r%s),r},RGBLinear(n,e,t){const s=Interpolation.Utils.RGBsplit(n),r=Interpolation.Utils.RGBsplit(e),o=Interpolation.Utils.Linear(s.a,r.a,t),h=Interpolation.Utils.Linear(s.r,r.r,t),c=Interpolation.Utils.Linear(s.g,r.g,t),a=Interpolation.Utils.Linear(s.b,r.b,t);return o<<24|h<<16|c<<8|a},HSVLinear(n,e,t){const s=Interpolation.Utils.HSVsplit(n),r=Interpolation.Utils.HSVsplit(e);let o;Math.abs(s.h-r.h)<=.5?o=Interpolation.Utils.Linear(s.h,r.h,t):(s.h<r.h?o=Interpolation.Utils.Linear(s.h+1,r.h,t):o=Interpolation.Utils.Linear(s.h,r.h+1,t),o=o%1);const h=Interpolation.Utils.Linear(s.s,r.s,t),c=Interpolation.Utils.Linear(s.v,r.v,t),a=Interpolation.Utils.Linear(s.a,r.a,t);return Interpolation.Utils.HSVJoin({a,h:o,s:h,v:c})},HCLLinear(n,e,t){const s=Interpolation.Utils.HCLSplit(n),r=Interpolation.Utils.HCLSplit(e);let o;Math.abs(s.h-r.h)<=.5?o=Interpolation.Utils.Linear(s.h,r.h,t):(s.h<r.h?o=Interpolation.Utils.Linear(s.h+1,r.h,t):o=Interpolation.Utils.Linear(s.h,r.h+1,t),o=o%1);const h=Interpolation.Utils.Linear(s.c,r.c,t),c=Interpolation.Utils.Linear(s.l,r.l,t),a=Interpolation.Utils.Linear(s.a,r.a,t);return Interpolation.Utils.HSVJoin({a,h:o,s:h,v:c})},Linear(n,e,t){return(e-n)*t+n},Bernstein(n,e){const t=Interpolation.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){const n=[1];return function(e){let t=1;if(n[e])return n[e];for(let s=e;s>1;s--)t*=s;return n[e]=t,t}}(),CatmullRom(n,e,t,s,r){const o=(t-n)*.5,h=(s-e)*.5,c=r*r,a=r*c;return(2*e-2*t+o+h)*a+(-3*e+3*t-2*o-h)*c+o*r+e}}};class Sequence{static __initStatic(){this._nextId=0}static nextId(){return Sequence._nextId++}}Sequence.__initStatic();class Tween{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=e=>!0}__init15(){this._easingFunction=Easing.Linear.None}__init16(){this._yoyoEasingFunction=void 0}__init17(){this._interpolationFunction=Interpolation.Geom.Linear}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Sequence.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Group.shared}set _group(e){this._groupRef=e}constructor(e,t){Tween.prototype.__init.call(this),Tween.prototype.__init2.call(this),Tween.prototype.__init3.call(this),Tween.prototype.__init4.call(this),Tween.prototype.__init5.call(this),Tween.prototype.__init6.call(this),Tween.prototype.__init7.call(this),Tween.prototype.__init8.call(this),Tween.prototype.__init9.call(this),Tween.prototype.__init10.call(this),Tween.prototype.__init11.call(this),Tween.prototype.__init12.call(this),Tween.prototype.__init13.call(this),Tween.prototype.__init14.call(this),Tween.prototype.__init15.call(this),Tween.prototype.__init16.call(this),Tween.prototype.__init17.call(this),Tween.prototype.__init18.call(this),Tween.prototype.__init19.call(this),Tween.prototype.__init20.call(this),Tween.prototype.__init21.call(this),Tween.prototype.__init22.call(this),this._object=e,this._group=t}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(e){try{JSON.stringify(e)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(e,this._valuesStart,e,this._valuesStartRepeat,!0),this}to(e,t){try{this._valuesEnd=JSON.parse(JSON.stringify(e))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(e,t)}return t!==void 0&&(this._duration=t),this}dynamicTo(e,t){return this._valuesEnd=e,t!==void 0&&(this._duration=t),this}duration(e){return this._duration=e,this}start(e){return this._isPlaying?this:(e!=null&&(this._delayTime=e),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(e){return this.reset(),this.start(e)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const e=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,e),this}_setupProperties(e,t,s,r,o){for(const h in s){const c=e[h],a=Array.isArray(c),u=!Number.isNaN(Number(c)),d=a?"array":typeof c,p=d=="object",m=typeof s[h]=="object",g=!a&&Array.isArray(s[h]);d=="undefined"||d=="function"||s[h]==null||!a&&!u&&!p||((p||a||m)&&c&&!g?(typeof t[h]>"u"&&(t[h]=a?[]:{}),typeof r[h]>"u"&&(r[h]=a?[]:{}),this._setupProperties(c,t[h],s[h],r[h],o)):((typeof t[h]>"u"||o)&&(t[h]=c),(typeof r[h]>"u"||o)&&(g?r[h]=s[h].slice().reverse()[0]:r[h]=t[h]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(e=!1){let t=[];if(e||(t=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!e){this._chainedTweens=t;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(e,t=!1){return this.resume(),this.update(e*this._duration-(t?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this}startChainedTweens(e=!1){e&&this.stop();for(let t=0,s=this._chainedTweens.length;t<s;t++)this._chainedTweens[t].start();return this}group(e){return this._group=e,this}delay(e){return this._delayTime=e,this}timescale(e){return this._timescale=e,this}repeat(e=1/0){return this._repeat=e,this}repeatDelay(e){return this._repeatDelayTime=e,this}yoyo(e=!0){return this._yoyo=e,this}easing(e){return this._easingFunction=e,this}safetyCheck(e){return this._safetyCheckFunction=e,this}yoyoEasing(e){return this._yoyoEasingFunction=e,this}interpolation(e){return this._interpolationFunction=e,this}chain(...e){return this._chainedTweens=e,this}onStart(e){return this._onStartCallback=e,this}onAfterDelay(e){return this._onAfterDelayCallback=e,this}onUpdate(e){return this._onUpdateCallback=e,this}onRepeat(e){return this._onRepeatCallback=e,this}onComplete(e){return this._onCompleteCallback=e,this}onStop(e){return this._onStopCallback=e,this}update(e,t=!1){const s=this._internalUpdate(e);return!s&&!t&&this._group.remove(this),s}_internalUpdate(e){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;e*=this._timescale;let t;this._elapsedTime+=e;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),t=r/this._duration,this._duration==0&&(r>=0?t=1:t=0),t=Math.min(1,t),t=Math.max(0,t);let o=Number.isFinite(r)?r%this._duration:r;Number.isNaN(o)&&(o=0);const h=Math.floor(r/this._duration);let c;if(this._reversed&&this._yoyoEasingFunction?c=this._yoyoEasingFunction(t):c=this._easingFunction(t),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&(t!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,t,this),t==1){if(this._repeat-this._repeatCount>0){const a=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+h),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||o<=0)&&this._onUpdateCallback(this._object,t,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let u=1;Number.isFinite(h)?u=this._repeatCount-a:Number.isFinite(this._repeat)&&(u=this._repeat-a);for(let d=0;d<u;d++)this._onRepeatCallback(this._object,a+1+d,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return o>0&&Number.isFinite(this._repeat)&&this._internalUpdate(o),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let a=0,u=this._chainedTweens.length;a<u;a++)this._chainedTweens[a].start(),o>0&&this._chainedTweens[a].update(o);return this._isPlaying=!1,!1}return!0}_updateProperties(e,t,s,r){for(const o in s){if(t[o]==null)continue;const h=t[o];let c=s[o];const a=Array.isArray(e[o]),u=Array.isArray(c);!a&&u?this._reversed?e[o]=this._interpolationFunction(c.concat([h]),r):e[o]=this._interpolationFunction([h].concat(c),r):typeof c=="object"&&c?this._updateProperties(e[o],h,c,r):(c=this._handleRelativeValue(h,c),typeof c=="number"&&(typeof h=="number"||typeof h=="string")&&(e[o]=Number(h)+(c-Number(h))*r,typeof h=="string"&&(e[o]=String(e[o]))))}}_handleRelativeValue(e,t){return typeof t!="string"?t:t.charAt(0)=="+"||t.charAt(0)=="-"?e+Number(t):Number(t)}_swapEndStartRepeatValues(e,t){for(const s in e){const r=!Array.isArray(e[s])&&Array.isArray(t[s]);if(typeof e[s]=="object")this._swapEndStartRepeatValues(e[s],t[s]);else{const o=e[s];if(typeof t[s]=="string")e[s]=Number(e[s])+Number(t[s]),t[s]=o;else if(r){const h=t[s].slice().reverse();e[s]=h[0],t[s]=h}else e[s]=t[s],t[s]=o}}}_moveForwardStartRepeatValues(e,t){for(const s in e)typeof t[s]=="object"?this._moveForwardStartRepeatValues(e[s],t[s]):typeof t[s]=="string"&&(e[s]=Number(e[s])+Number(t[s]))}}class FancyButton extends Container{constructor({defaultView:e,hoverView:t,pressedView:s,disabledView:r,text:o,padding:h,offset:c,textOffset:a,iconOffset:u,anchor:d,anchorX:p,anchorY:m,icon:g,animations:_}){super(),this.createViews({defaultView:e,hoverView:t,pressedView:s,disabledView:r,text:o,icon:g}),this.anchor=new ObservablePoint(this.resetViewsPositions,this),this.anchor.set(p??d??0,m??d??0),this.padding=h??0,this.offset=c,this.textOffset=a,this.iconOffset=u,_&&(this.animations=_,Ticker.shared.add(()=>Group.shared.update())),this.setState("default"),this.addEvents()}set text(e){this.textView||this.createTextView(typeof e=="number"?e.toString():e),this.textView.text=e,this.setState(this.state),this.adjustTextView(this.state)}get text(){var e;return(e=this.textView)==null?void 0:e.text}set enabled(e){this.events.enabled=e,this.setState(e?"default":"disabled")}get enabled(){return this.events.enabled}setState(e){if(this.state===e)return;const t=this.getStateView(this.state),s=this.getStateView(e);t.visible=!1,s.visible=!0,this.state=e,this.setOffset(s,e,this.offset),this.adjustTextView(e),this.adjustIconView(e),this.playAnimations(e)}createTextView(e){this.textView=getTextView(e),this.textView.anchor.set(0)}createIconView(e){this.iconView=getView(e)}setOffset(e,t,s){const r=s?s[t]:{x:0,y:0},o=s==null?void 0:s.default;r?(e.x+=r.x??0,e.y+=r.y??0):o?(e.x+=o.x??0,e.y+=o.y??0):(s.x||s.y)&&(e.x+=s.x??0,e.y+=s.y??0)}getStateView(e){switch(e){case"hover":return this.hoverView??this.defaultView;case"pressed":return this.pressedView??this.defaultView;case"disabled":return this.disabledView??this.defaultView;case"default":default:return this.defaultView}}adjustTextView(e){if(!this.textView)return;const t=this.getStateView(this.state);fitToView(t,this.textView,this.padding),t.addChild(this.textView),this.textView.x=(t.width-this.textView.width)/2,this.textView.y=(t.height-this.textView.height)/2,this.setOffset(this.textView,e,this.textOffset)}adjustIconView(e){if(!this.iconView)return;const t=this.getStateView(this.state);fitToView(t,this.iconView,this.padding),t.addChild(this.iconView),this.iconView.x=t.width/2-this.iconView.width/2,this.iconView.y=t.height/2-this.iconView.height/2,this.setOffset(this.iconView,e,this.iconOffset)}resetViewsPositions(){var r,o;const e=((r=this.anchor)==null?void 0:r.x)??0,t=((o=this.anchor)==null?void 0:o.y)??0;[this.defaultView,this.hoverView,this.pressedView,this.disabledView].forEach(h=>{var c;h&&((c=h.anchor)==null||c.set(0),h.x=-h.width*e,h.y=-h.height*t)})}createViews(e){const{defaultView:t,hoverView:s,pressedView:r,disabledView:o,text:h,icon:c}=e;this.innerView=new Container,this.addChild(this.innerView),this.defaultView=getView(t),this.innerView.addChild(this.defaultView),s&&(this.hoverView=getView(s),this.innerView.addChild(this.hoverView),this.hoverView.visible=!1),r&&(this.pressedView=getView(r),this.innerView.addChild(this.pressedView),this.pressedView.visible=!1),o&&(this.disabledView=getView(o),this.innerView.addChild(this.disabledView),this.disabledView.visible=!1),h&&this.createTextView(h),c&&this.createIconView(c)}addEvents(){this.events=new Button$1(this),this.onPress=new dist.Signal,this.onDown=new dist.Signal,this.onUp=new dist.Signal,this.onHover=new dist.Signal,this.onOut=new dist.Signal,this.onUpOut=new dist.Signal,this.events.onPress.connect((e,t)=>{this.onPress.emit(this,t),this.setState("hover")}),this.events.onDown.connect((e,t)=>{this.onDown.emit(this,t),this.setState("pressed")}),this.events.onUp.connect((e,t)=>{this.onUp.emit(this,t),this.setState("hover")}),this.events.onHover.connect((e,t)=>{this.onHover.emit(this,t),this.setState("hover")}),this.events.onOut.connect((e,t)=>{this.onOut.emit(this,t),this.setState("default")}),this.events.onUpOut.connect((e,t)=>{this.onUpOut.emit(this,t),this.setState("default")})}playAnimations(e){if(this.originalInnerViewState||(this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}}),this.animations&&this.animations[e]){const t=this.animations[e];new Tween(this.innerView).to(t.props,t.duration).start()}else this.animations&&e==="default"&&new Tween(this.innerView).to(this.originalInnerViewState,100).start()}}class Input extends Container{constructor(e){super(),this.editing=!1,this.tick=0,this.activation=!1,this.options=e,this.bg=getView(e.bg),this.bg.cursor="text",this.bg.interactive=!0;const t={fill:0,align:"center"},s=new TextStyle(e.textStyle??t);if(this.inputField=new Text("",s),this.inputMask=new Graphics().beginFill(16777215).drawRect(this.padding,this.padding,this.bg.width-this.padding*2,this.bg.height-this.padding*2),this.inputField.mask=this.inputMask,this._cursor=new Sprite(Texture.WHITE),this._cursor.tint=Number(e.textStyle.fill)||0,this._cursor.anchor.set(.5),this._cursor.width=2,this._cursor.height=this.inputField.height*.8,this._cursor.alpha=0,this._cursor.mask=this.inputMask,this.placeholder=new Text(e.placeholder,s??t),this.placeholder.visible=!!e.placeholder,this.value=e.value??"",this.addChild(this.bg,this.inputField,this.placeholder,this._cursor,this.inputMask),this.align(),this.cursor="text",this.interactive=!0,this.on("pointertap",()=>this.activation=!0),isMobile.any){window.addEventListener("touchstart",()=>this.handleActivation());let r=document.getElementById("v-keyboard");r||(r=document.createElement("input"),document.body.appendChild(r),r.setAttribute("id","v-keyboard"),r.style.opacity="0"),r.oninput=()=>{let o=r.value;const h=this.options.maxLength;h&&o.length>this.options.maxLength&&(o=o.substring(0,h),r.value=o),this.value=o,this.onChange.emit(this.value)}}else window.addEventListener("click",()=>{this.handleActivation(),this.onEnter.emit(this.value)}),window.addEventListener("keydown",r=>{const o=r.key;o==="Backspace"?this._delete():o==="Escape"||o==="Enter"?(this.stopEditing(),this.onEnter.emit(this.value)):o.length===1&&this._add(o)});this.onEnter=new dist.Signal,this.onChange=new dist.Signal,Ticker.shared.add(r=>this.update(r))}_add(e){this.editing&&(this.options.maxLength&&this.value.length>=this.options.maxLength||(this.value=this.value+e,this.onChange.emit(this.value)))}_delete(){if(!this.editing||this.value.length===0)return;const e=this.value.split("");e.pop(),this.value=e.join(""),this.onChange.emit(this.value)}_startEditing(){if(this.tick=0,this.editing=!0,this.placeholder.visible=!1,this._cursor.alpha=1,isMobile.any){const e=document.getElementById("v-keyboard");e.focus(),e.click(),e.value=this.value}this.align()}handleActivation(){this.stopEditing(),this.activation&&(this._startEditing(),this.activation=!1)}stopEditing(){var e;this._cursor.alpha=0,this.editing=!1,this.inputField.text===""&&(this.placeholder.visible=!0),this.value.length===0&&(this.placeholder.visible=!0),isMobile.any&&((e=document.getElementById("v-keyboard"))==null||e.blur()),this.align()}update(e){this.editing&&(this.tick+=e*.1,this._cursor.alpha=Math.round(Math.sin(this.tick)*.5+.5))}align(){const e=this.getAlign();this.inputField.anchor.set(e,.5),this.inputField.x=this.bg.width*e+(e===1?-this.padding:this.padding),this.inputField.y=this.bg.height/2,this.placeholder.anchor.set(e,.5),this.placeholder.x=this.bg.width*e+(e===1?-this.padding:this.padding),this.placeholder.y=this.bg.height/2,this._cursor.x=this.getCursorPosX(),this._cursor.y=this.inputField.y}get padding(){return this.options.padding|0}getAlign(){const e=this.bg.width*.95;if(this.inputField.width+this.padding*3>e)return this.editing?1:0;switch(this.options.align){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}getCursorPosX(){switch(this.getAlign()){case 0:return this.inputField.x+this.inputField.width;case .5:return this.inputField.x+this.inputField.width*.5;case 1:return this.inputField.x;default:return 0}}set value(e){this.inputField.text=e,e.length!==0?this.placeholder.visible=!1:this.placeholder.visible=!this.editing,this.align()}get value(){return this.inputField.text}}class Layout extends Container{constructor(e){super(),this.children=[],this.options=e,e!=null&&e.type&&(this.type=e.type),e!=null&&e.children&&e.children.map(t=>this.addChild(t))}onChildrenChange(){var r,o,h;let e=((r=this.options)==null?void 0:r.horPadding)??0,t=((o=this.options)==null?void 0:o.vertPadding)??0;const s=((h=this.options)==null?void 0:h.elementsMargin)??0;this.children.forEach(c=>{var a;switch(!this.type&&e+c.width>=this.parent.width?(t+=s+c.height,e=((a=this.options)==null?void 0:a.horPadding)??0,c.x=e,c.y=t):(c.x=e,c.y=t),this.type){case"horizontal":e+=s+c.width;break;case"vertical":t+=s+c.height;break;default:e+=s+c.width;break}})}}class Spring{constructor(e={}){this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=e,this._options.max=e.max||160,this._options.damp=e.damp||.8,this._options.springiness=e.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(e){this._options.max=e}get damp(){return this._options.damp}set damp(e){this._options.damp=e}get springiness(){return this._options.springiness}set springiness(e){this._options.springiness=e}}class ScrollSpring{constructor(){this._spring=new Spring,this._pos=0,this.to=0}start(e,t,s){this._speed=e,this._pos=t,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const r=this.to-this._pos,o=Math.abs(r)/r,h=Math.abs(this._speed)/this._speed;o!==h?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const e=this.to-this._pos;Math.abs(e)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}class SlidingNumber{constructor(e={}){this.position=0,this.constrain=!0,this.min=0,this.max=0,this.maxSpeed=400,this._offset=0,this._prev=0,this._speed=0,this._targetSpeed=0,this._speedChecker=0,this._grab=0,this.constrain=e.constrain??!0,this.maxSpeed=e.maxSpeed??400,this._ease=e.ease??new ScrollSpring}set value(e){this._speed=0,this.position=e}get value(){return this.position}grab(e){this._grab=e,this._offset=this.position-e,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(e){this._speedChecker++,this.position=e+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(){this._hasStopped||(this.constrain?this._updateConstrain():this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(){const e=this.max;this.position>this.min||this.position<e||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,e)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}class Trackpad{constructor(e){this.xAxis=new SlidingNumber({ease:e.xEase,maxSpeed:e.maxSpeed,constrain:e.constrain}),this.yAxis=new SlidingNumber({ease:e.yEase,maxSpeed:e.maxSpeed,constrain:e.constrain}),this._frame=new Rectangle,this._bounds=new Rectangle,this._globalPosition=new Point}pointerDown(e){this.xAxis.grab(e.x),this.yAxis.grab(e.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(e){this._globalPosition=e}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(),this.yAxis.slide())}resize(e,t){this._frame.x=0,this._frame.width=e,this._frame.y=0,this._frame.height=t,this._dirty=!0}setBounds(e,t,s,r){this._bounds.x=e,this._bounds.width=t-e,this._bounds.y=s,this._bounds.height=r-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}class ScrollBox extends Container{constructor(e){var s;super(),this.__width=0,this.__height=0,this.freeSlot={x:0,y:0},this.isDragging=0,this.childrenInteractiveStorage=[],this.ticker=Ticker.shared,this.options=e,this.addBackground(),this.__width=e.width|this.background.width,this.__height=e.height|this.background.height,e.vertPadding||(e.vertPadding=e.padding??0),e.horPadding||(e.horPadding=e.padding??0),this.layout=new Layout({type:e.type,elementsMargin:e.elementsMargin,vertPadding:e.vertPadding,horPadding:e.horPadding}),super.addChild(this.layout),(s=e.items)!=null&&s.length&&e.items.forEach(r=>{this.addItem(r)}),this.hasBounds&&(this.addMask(),this.makeScrollable()),this.onMouseScrollBinded=this.onMouseScroll.bind(this);const t=new ScrollSpring;this._trackpad=new Trackpad({constrain:!0,yEase:t}),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.resize(),this.ticker.add(this.update,this)}get hasBounds(){return!!this.__width||!!this.__height}onChildrenChange(){}addItem(...e){var t;if(e.length>1)e.forEach(s=>this.addItem(s));else{const s=e[0];(!s.width||!s.height)&&console.error("ScrollBox item should have size"),s.x=this.freeSlot.x,s.y=this.freeSlot.y,this.layout.addChild(s),this.options.disableDynamicRendering||(s.renderable=this.isItemVisible(s));const r=((t=this.options)==null?void 0:t.elementsMargin)??0;switch(this.options.type){case"horizontal":this.freeSlot.x+=r+s.width;break;default:this.freeSlot.y+=r+s.height;break}}return this.resize(),e[0]}removeItem(e){const t=this.layout.children[e];t&&(this.layout.removeChild(t),this.resize())}isItemVisible(e){const t=this.options.type==="vertical"||!this.options.type;let s=!1;const r=this.layout;if(t){const o=e.y+r.y;o+e.height+this.options.vertPadding>=0&&o-this.options.vertPadding-this.options.elementsMargin<=this.options.height&&(s=!0)}else{const o=e.x+r.x;o+e.width>=0&&o<=this.options.width&&(s=!0)}return s}get items(){var e;return((e=this.layout)==null?void 0:e.children)??[]}addBackground(){this.background=typeof this.options.background=="string"?Sprite.from(this.options.background):new Graphics,this.addChild(this.background),this.resize()}addMask(){this.borderMask=new Graphics,super.addChild(this.borderMask),this.mask=this.borderMask,this.resize()}makeScrollable(){this.on("pointerdown",s=>{this.isDragging=1,this._trackpad.pointerDown(s.global)}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("globalpointermove",s=>{this._trackpad.pointerMove(s.global),this.isDragging&&this.disableChildrenInteractivity()});const{onMouseHover:e,onMouseOut:t}=this;this.on("mouseover",e,this).on("mouseout",t,this)}disableChildrenInteractivity(){this.items.forEach((e,t)=>{this.childrenInteractiveStorage[t]||(this.childrenInteractiveStorage[t]=e.interactive===!0),e.interactive=!1})}restoreChildrenInteractivity(){this.items.forEach((e,t)=>{const s=this.childrenInteractiveStorage[t]===!0;s&&(e.interactive=s,delete this.childrenInteractiveStorage[t])})}setInteractive(e){this.interactive=e}get layoutHeight(){return this.layout.height+this.options.vertPadding*2}get layoutWidth(){return this.layout.width+this.options.horPadding*2}resize(){if(this.renderAllItems(),this.borderMask&&(this.lastWidth!==this.layoutWidth||this.lastHeight!==this.layoutHeight)){const e=this.options.vertPadding,t=this.options.horPadding;this.options.width||(this.__width+=this.layoutWidth),this.options.height||(this.__height+=this.layoutHeight),this.borderMask.clear().lineStyle(0).beginFill(16777215).drawRoundedRect(0,0,this.__width,this.__height,this.options.radius|0),removeHitBox(this.borderMask),this.background instanceof Graphics&&typeof this.options.background=="number"&&this.background.clear().lineStyle(0).beginFill(this.options.background).drawRect(0,0,this.__width+t,this.__height+e),this.options.type==="horizontal"?this.setInteractive(this.layoutWidth>this.__width):this.setInteractive(this.layoutHeight>this.__height),this.lastWidth=this.layoutWidth,this.lastHeight=this.layoutHeight}if(this._trackpad){const e=this.borderMask.width-this.layout.width-this.options.horPadding*2,t=this.borderMask.height-this.layout.height-this.options.vertPadding*2;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(t):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(e):(this._trackpad.yAxis.max=-Math.abs(t),this._trackpad.xAxis.max=-Math.abs(e))}this.stopRenderHiddenItems()}onMouseHover(){this.renderAllItems(),document.addEventListener("mousewheel",this.onMouseScrollBinded),document.addEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseOut(){this.stopRenderHiddenItems(),document.removeEventListener("mousewheel",this.onMouseScrollBinded),document.removeEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseScroll(e){if(this.renderAllItems(),this.options.type==="horizontal"&&(typeof e.deltaX<"u"||typeof e.deltaY<"u")){const t=e.deltaY?this.layout.x-e.deltaY:this.layout.x-e.deltaX;t<0&&t+this.layoutWidth+this.options.horPadding<this.__width?this._trackpad.xAxis.value=this.__width-this.layoutWidth:t>this.options.horPadding?this._trackpad.xAxis.value=0:this._trackpad.xAxis.value=t}else if(typeof e.deltaY<"u"){const t=this.layout.y-e.deltaY;t<0&&t+this.layoutHeight+this.options.vertPadding<this.__height?this._trackpad.yAxis.value=this.__height-this.layoutHeight:t>this.options.vertPadding?this._trackpad.yAxis.value=0:this._trackpad.yAxis.value=t}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.layout.children.length-1):this.scrollTop()}scrollTop(){this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0}renderAllItems(){this.options.disableDynamicRendering||this.items.forEach(e=>{e.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||this.items.forEach(e=>{e.renderable=this.isItemVisible(e)})}scrollTo(e){if(!this.interactive)return;const t=this.layout.children[e];t&&(this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-t.x-t.width-this.options.horPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-t.y-t.height-this.options.vertPadding:0)}get height(){return this.__height}get width(){return this.__width}update(){this._trackpad.update(),this.options.type==="horizontal"?this.layout.x!==this._trackpad.x?(this.renderAllItems(),this.layout.x=this._trackpad.x):this.stopRenderHiddenItems():this.layout.y!==this._trackpad.y?(this.renderAllItems(),this.layout.y=this._trackpad.y):this.stopRenderHiddenItems()}}const defaultVisibleItems=5;class Select extends Container{constructor({closedBG:e,textStyle:t,items:s,openBG:r,selected:o,selectedTextOffset:h,scrollBox:c,visibleItems:a}){super(),this.openButton=new FancyButton({defaultView:getView(e),text:new Text(s!=null&&s.items?s.items[0]:"",t),textOffset:h}),this.openButton.onPress.connect(()=>this.toggle()),this.addChild(this.openButton),this.openView=getView(r),this.openView.visible=!1,this.addChild(this.openView);const u=new Graphics().beginFill(0,1e-5).drawRect(0,0,this.openButton.width,this.openButton.height);this.closeButton=new FancyButton({defaultView:u,text:new Text(s!=null&&s.items?s.items[0]:"",t),textOffset:h}),this.closeButton.onPress.connect(()=>this.toggle()),this.openView.addChild(this.closeButton),this.scrollBox=new ScrollBox({type:"vertical",elementsMargin:0,width:this.openButton.width,height:this.openButton.height*(a??defaultVisibleItems),radius:0,padding:0,...c}),this.scrollBox.y=this.openButton.height,this.openView.addChild(this.scrollBox),c!=null&&c.offset&&(this.scrollBox.x+=c.offset.x??0,this.scrollBox.y+=c.offset.y??0),this.onSelect=new dist.Signal,this.convertItemsToButtons(s).forEach((d,p)=>{const m=d.text;p===o&&(this.openButton.text=m,this.closeButton.text=m),d.onPress.connect(()=>{this.value=p,this.onSelect.emit(p,m),this.openButton.text=m,this.closeButton.text=m,this.close()}),this.scrollBox.addItem(d)})}toggle(){this.openView.visible=!this.openView.visible,this.openButton.visible=!this.openButton.visible}open(){this.openView.visible=!0,this.openButton.visible=!1}close(){this.openView.visible=!1,this.openButton.visible=!0}convertItemsToButtons({items:e,backgroundColor:t,hoverColor:s,width:r,height:o,textStyle:h,radius:c}){const a=[];return e.forEach(u=>{const d=new Graphics().beginFill(t).drawRoundedRect(0,0,r,o,c),p=s??t,m=new Graphics().beginFill(p).drawRoundedRect(0,0,r,o,c),g=new Text(u,h),_=new FancyButton({defaultView:d,hoverView:m,text:g});a.push(_)}),a}}class Slider extends SliderBase{constructor(e){super({bg:e.bg,slider1:e.slider,fill:e.fill??"",min:e.min,max:e.max,value1:e.value,valueTextStyle:e.valueTextStyle,showValue:e.showValue,valueTextOffset:e.valueTextOffset,fillOffset:e.fillOffset}),this.onChange=new dist.Signal,this.onUpdate=new dist.Signal,this.options=e,this.value=e.value??0}get value(){return this._value1}set value(e){var t,s,r;if(e!==this._value1){if(e<this.min&&(e=this.min),e>this.max&&(e=this.max),this._value1=e,this.progress=(this.max-this.min)/100*e,this.slider1.x=(this.bg.width-this.slider1.width)/100*this.progress,this.options.showValue){this.value1Text.text=`${e}`;const o=this.slider1.x+this.slider1.width/2,h=this.slider1.y;this.value1Text.x=o+(((t=this.options.valueTextOffset)==null?void 0:t.x)??0),this.value1Text.y=h+(((s=this.options.valueTextOffset)==null?void 0:s.y)??0)}(r=this.onUpdate)==null||r.emit(this.value)}}update(e){if(!this.dragging)return;const t=e.currentTarget,{x:s}=t.parent.worldTransform.applyInverse(e.global),r=this.validate(s/this.bg.width*100);r!==this.progress&&(this.value=(this.max-this.min)/100*r)}}const defaultRoundedBoxOptions={color:0,width:350,height:600,shadow:!0,shadowColor:655397,shadowOffset:22,alpha:1,radius:34};class RoundedBox extends Container{constructor(t={}){super();ne(this,"image");ne(this,"shadow");const s={...defaultRoundedBoxOptions,...t};this.image=new NineSlicePlane(Texture.from("rounded-rectangle"),s.radius,s.radius,s.radius,s.radius),this.image.width=s.width,this.image.height=s.height,this.image.tint=s.color,this.image.alpha=s.alpha,this.image.x=-this.image.width*.5,this.image.y=-this.image.height*.5,this.addChild(this.image),s.shadow&&(this.shadow=new NineSlicePlane(Texture.from("rounded-rectangle"),34,34,34,34),this.shadow.width=s.width,this.shadow.height=s.height,this.shadow.tint=s.shadowColor,this.shadow.x=-this.shadow.width*.5,this.shadow.y=-this.shadow.height*.5+s.shadowOffset,this.addChildAt(this.shadow,0))}get boxWidth(){return this.image.width}get boxHeight(){return this.image.height}set boxWidth(t){this.image.width=t}}class Responsive{constructor(){ne(this,"isDesktop",!0)}get getIsDesktop(){return this.isDesktop}checkResponsive(e){if(e<=980){this.isDesktop=!1;return}this.isDesktop=!0}}const responsive=new Responsive;class Header extends Container{constructor(){super();ne(this,"container");ne(this,"bg");ne(this,"fsLogo");ne(this,"userLabel");ne(this,"image");ne(this,"balanceContainer");ne(this,"layoutUser");ne(this,"panelBaseUser");this.container=new Container,this.addChild(this.container),this.bg=new Sprite(Texture.WHITE),this.container.addChild(this.bg),this.fsLogo=new FsLogo,this.container.addChild(this.fsLogo),this.panelBaseUser=new RoundedBox({width:200,height:40,alpha:.5,shadow:!1,color:2369584}),this.container.addChild(this.panelBaseUser),this.layoutUser=new Layout({type:"horizontal",elementsMargin:-20}),this.layoutUser.x=-this.panelBaseUser.boxWidth*.5+30,this.panelBaseUser.addChild(this.layoutUser),this.userLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:12,fill:16777215},!1),this.userLabel.x=-60,this.userLabel.y=-8,this.panelBaseUser.addChild(this.userLabel),this.image=Sprite.from((user==null?void 0:user.photoURL)||"user-default"),this.image.scale.set(.8),this.image.anchor.set(.5),this.image.roundPixels=!0,this.image.height=20,this.image.width=20,this.image.x=-this.panelBaseUser.boxWidth*.5+20,this.panelBaseUser.addChild(this.image),this.balanceContainer=new Balance,this.container.addChild(this.balanceContainer);let t=setInterval(()=>{const{truncate:s}=truncateString(user.username,18);this.userLabel.text=s,this.balanceContainer.balance=user.budget.toFixed(2),this.balanceContainer.bonus=user.bonusBudget.toFixed(2),clearInterval(t)},100);responsive.getIsDesktop?this.balanceContainer.visible=!0:this.balanceContainer.visible=!1}resize(t){this.bg.width=t,this.bg.height=60,this.bg.tint=264209,this.fsLogo.x=50,this.fsLogo.y=30,this.balanceContainer.x=t-380,this.balanceContainer.y=30,this.panelBaseUser.x=t-120,this.panelBaseUser.y=30}refreshUserDetails(){this.userLabel.text=`${user.username}`,this.balanceContainer.balance=user.budget.toFixed(2),this.balanceContainer.bonus=user.bonusBudget.toFixed(2),console.log(user.bonusBudget)}}class Balance extends Container{constructor(){super();ne(this,"currencyLabel");ne(this,"currencyBonus");ne(this,"bonusText");ne(this,"balanceLabel");ne(this,"bonusLabel");ne(this,"slashLabel");ne(this,"panelBase");const t=i18n.translatedText;this.panelBase=new RoundedBox({width:280,height:40,alpha:.5,shadow:!1,color:2369584}),this.addChild(this.panelBase),this.bonusText=new Label(t.bonus,{fontFamily:"Epilogue Bold",fontSize:14,fill:16765810}),this.bonusText.x=-100,this.panelBase.addChild(this.bonusText),this.currencyBonus=new Label("$",{fontFamily:"Epilogue Bold",fontSize:14}),this.currencyBonus.x=-70,this.panelBase.addChild(this.currencyBonus),this.bonusLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14},!1),this.bonusLabel.x=-60,this.bonusLabel.y=-10,this.panelBase.addChild(this.bonusLabel),this.slashLabel=new Label("/",{fontFamily:"Epilogue Bold",fontSize:14}),this.slashLabel.x=10,this.panelBase.addChild(this.slashLabel),this.currencyLabel=new Label("$",{fontFamily:"Epilogue Bold",fontSize:14,fill:3431867}),this.currencyLabel.x=30,this.panelBase.addChild(this.currencyLabel),this.balanceLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14},!1),this.balanceLabel.x=40,this.balanceLabel.y=-10,this.panelBase.addChild(this.balanceLabel)}set balance(t){this.balanceLabel.text=t}set bonus(t){parseFloat(t)*10**backendConfigs.betPrecision<1?(this.bonusText.visible=!1,this.currencyBonus.visible=!1,this.bonusLabel.visible=!1,this.slashLabel.visible=!1,this.panelBase.boxWidth=150,this.panelBase.x=140,this.currencyLabel.x=-120,this.balanceLabel.x=-100):(this.panelBase.boxWidth=280,this.panelBase.x=0,this.currencyLabel.x=30,this.balanceLabel.x=40,this.bonusText.visible=!0,this.currencyBonus.visible=!0,this.bonusLabel.visible=!0,this.slashLabel.visible=!0),this.bonusLabel.text=t}}const defaultPlusButtonOptions={text:"",width:56,height:56,labelColor:15471969,labelFontSize:8};class PlusButton extends FancyButton{constructor(t={}){const s={...defaultPlusButtonOptions,...t},r=new NineSlicePlane(Texture.from("button-plus"),10,16,16,20);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-plus-hover"),16,16,16,20);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button-plus"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-plus-disabled"),16,16,16,20);h.width=s.width,h.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.label.y=-8,this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav"),this.label.y=-3}handleUp(){this.label.y=-8}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}}const defaultMinusButtonOptions={text:"",width:56,height:56,labelColor:15471969,labelFontSize:8};class MinusButton extends FancyButton{constructor(t={}){const s={...defaultMinusButtonOptions,...t},r=new NineSlicePlane(Texture.from("button-minus"),10,16,16,20);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-minus-hover"),16,16,16,20);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button-minus"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-minus-disabled"),16,16,16,20);h.width=s.width,h.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.label.y=-8,this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav"),this.label.y=-3}handleUp(){this.label.y=-8}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}}const defaultTextInputOptions={width:240,height:60,placeholder:"Enter text",fontSize:24,fontFamily:"Epilogue Bold",align:"center"};class TextInput extends Container{constructor(t={},s,r,o,h){const c={...defaultTextInputOptions,...t};super();ne(this,"container");ne(this,"input");ne(this,"bg");ne(this,"enabled");ne(this,"_value");ne(this,"_onEnter");ne(this,"timer");this._onEnter=r,this.container=new Container,this.addChild(this.container),this.bg=new Sprite(Texture.EMPTY),this.bg.width=c.width,this.bg.height=c.height,this.container.addChild(this.bg);let a={bg:this.bg,placeholder:c.placeholder,align:c.align,maxLength:6,textStyle:{fontFamily:c.fontFamily,fontSize:c.fontSize,fill:16777215}};this.input=new Input(a),this._value="",this.input.value="",this.enabled=!0;const u=new RegExp(`^-?\\d*(\\.\\d{0,${s}}|)$`);this.input.onChange.connect(d=>{for(;d.length>0&&d[0]=="0";)d=d.slice(1);if(d[0]==="."&&(d="0"+d),d==="-."&&(d="-0."),this.enabled&&d.match(u)){this.timer&&(clearTimeout(this.timer),this.timer=void 0);let p=+d;(d==="-"||d==="")&&o<0?(this.input.value=d,this.value=d,this._onEnter(0)):p<=h&&p>=o?(this.input.value=d,this.value=d,this._onEnter(p)):this.timer=setTimeout(()=>{this.input.value=Math.max(o,parseFloat(this._value)).toFixed(s)},3e3)}else this.input.value=this.value}),this.container.addChild(this.input)}get value(){return this._value}set value(t){this.input.value=this._value=t}}let PreviousResults$1=class{constructor(){ne(this,"results",[]);ne(this,"currentResult","")}get getResults(){return this.results}get getCurrentResult(){return this.currentResult}set setResults(e){this.results=e}set setCurrentResult(e){this.currentResult=e}};const previousResults=new PreviousResults$1,defaultIconButtonOptions={image:"",imageDisabled:"",drawWidth:50,drawHeight:50,drawRadius:100};class IconButton extends FancyButton{constructor(t={},s=!0){const r={...defaultIconButtonOptions,...t},o=Sprite.from(r.image),h=Sprite.from(r.imageDisabled||"icon-unde-disabled");super({defaultView:o,disabledView:h,anchor:.5});ne(this,"container");ne(this,"bg");ne(this,"image");ne(this,"imageDisabled");ne(this,"ripplePool",[]);this.container=new Container,this.addChild(this.container),this.bg=new Graphics,this.bg.beginFill(264209,.5),this.bg.drawRoundedRect(0,0,r.drawWidth,r.drawHeight,r.drawRadius),this.bg.visible=s,this.container.addChild(this.bg),this.image=o,this.image.interactiveChildren=!1,this.image.scale.set(.8),this.image.x=this.container.width*.25,this.image.y=this.container.height*.25,this.imageDisabled=h,this.imageDisabled.interactiveChildren=!1,this.imageDisabled.scale.set(.8),this.imageDisabled.x=this.container.width*.25,this.imageDisabled.y=this.container.height*.25,this.onHover.connect(this.handleHover.bind(this)),this.onOut.connect(this.handleOut.bind(this)),this.onDown.connect(this.handleDown.bind(this)),this.container.pivot.x=this.container.width/2,this.container.pivot.y=this.container.height/2,this.container.addChild(this.image),this.container.addChild(this.imageDisabled)}handleHover(){gsapWithCSS.to(this.scale,{x:1.2,y:1.2,duration:.2,ease:"back.out"})}handleOut(){gsapWithCSS.to(this.scale,{x:1,y:1,duration:.2,ease:"back.out"})}handleDown(){this.playRipples()}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),gsapWithCSS.killTweensOf(this.image),this.visible=!0,this.interactive=!0,t?(this.image.alpha=0,this.scale.set(1.5),gsapWithCSS.to(this.image,{alpha:1,duration:.3,ease:"linear"}),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"sine.out"})):(this.image.alpha=1,this.scale.set(1))}async hide(t=!0){this.interactive=!1,gsapWithCSS.killTweensOf(this.scale),gsapWithCSS.killTweensOf(this.image),t?(gsapWithCSS.to(this.image,{alpha:0,duration:.3,ease:"linear"}),await gsapWithCSS.to(this.scale,{x:1.5,y:1.5,duration:.3,ease:"sine.out"})):(this.image.alpha=0,this.scale.set(0)),this.visible=!1}async playRipples(t=3){for(let s=0;s<t;s++)this.playRipple(),await waitFor(.2)}async playRipple(){const t=this.ripplePool.pop()??new Sprite;gsapWithCSS.killTweensOf(t.scale),gsapWithCSS.killTweensOf(t),t.anchor.set(.5),t.scale.set(1),t.alpha=.5,this.addChild(t),gsapWithCSS.to(t.scale,{x:3,y:3,duration:.6,ease:"linear"}),await gsapWithCSS.to(t,{alpha:0,duration:.6,ease:"linear"}),this.removeChild(t),this.ripplePool.push(t)}}class HashPopup extends Container{constructor(){super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"layout");ne(this,"dateLabel");ne(this,"infoLabel");ne(this,"multiplier");ne(this,"arrowLeft");ne(this,"arrowRight");ne(this,"iconClose");ne(this,"inputHash");ne(this,"inputResult");this.bg=Sprite.from(Texture.EMPTY),this.bg.alpha=0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:440,height:330,alpha:.8,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.iconClose=new IconButton({image:"icon-close"},!1),this.iconClose.y=-this.panelBase.boxHeight*.5+25,this.iconClose.x=this.panelBase.boxWidth*.5-50,this.iconClose.onPress.connect(()=>navigation.dismissPopup()),this.panel.addChild(this.iconClose),this.dateLabel=new Label("16/05/2023 at 15:58:02",{fill:16777215,fontSize:14}),this.dateLabel.y=-this.panelBase.boxHeight*.5+25,this.panel.addChild(this.dateLabel),this.layout=new Layout({type:"horizontal",elementsMargin:25}),this.layout.pivot.x=this.layout.width/2,this.layout.x=-this.panelBase.boxWidth*.5+150,this.layout.y=-this.panelBase.boxHeight*.5+60,this.panel.addChild(this.layout),this.arrowLeft=Sprite.from("icon-arrow-down"),this.arrowLeft.angle=90,this.arrowLeft.anchor.set(.5),this.layout.addChild(this.arrowLeft),this.multiplier=new Badge({text:"5.12x",width:80,height:36,labelFontSize:12,isPivot:!1}),this.multiplier.pivot.x=this.multiplier.width/6,this.multiplier.pivot.y=this.multiplier.height/2,this.layout.addChild(this.multiplier),this.arrowRight=Sprite.from("icon-arrow-down"),this.arrowRight.angle=270,this.arrowRight.anchor.set(.5),this.layout.addChild(this.arrowRight),this.inputHash=new InputHash("Hash"),this.inputHash.x=-this.panelBase.boxWidth*.5+20,this.inputHash.y=-this.panelBase.boxHeight*.5+110,this.inputHash.resultText="774156eca98d895d3bf02da7fe0b4f87bd61749c85d82674c755409296bcceb3",this.panel.addChild(this.inputHash),this.inputResult=new InputHash("Result"),this.inputResult.x=-this.panelBase.boxWidth*.5+20,this.inputResult.y=-this.panelBase.boxHeight*.5+190,this.inputResult.resultText="result_is_2.99_drhcsnh0aztbm5pn",this.panel.addChild(this.inputResult),this.infoLabel=new Label("Mas informacin sobre Hash",{fill:16777215,fontSize:12}),this.infoLabel.alpha=.5,this.infoLabel.y=this.panelBase.boxHeight*.5-25,this.panel.addChild(this.infoLabel)}update(){this.multiplier.textLabel=previousResults.getCurrentResult}resize(t,s){this.bg.width=t,this.bg.height=s,responsive.getIsDesktop?(this.panel.x=t-240,this.panel.y=s-370):(this.panel.x=t/2,this.panel.y=s-370)}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.from(this.bg,{alpha:.5,duration:.2,ease:"linear"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"})}}class InputHash extends Layout{constructor(t){super({type:"vertical",elementsMargin:5});ne(this,"title");ne(this,"resuelt");ne(this,"graphics");ne(this,"iconClipboard");ne(this,"copyTooltip");ne(this,"_resueltOrigin","");this.title=new Label(t,{fill:16777215,fontSize:14},!1),this.addChild(this.title),this.graphics=new Graphics().beginFill(0,.8).lineStyle({width:1,color:1477704}).drawRoundedRect(0,0,400,40,10),this.addChild(this.graphics),this.resuelt=new Text("",{fill:16777215,fontSize:12}),this.resuelt.x=10,this.resuelt.y=this.graphics.height*.5-6,this.graphics.addChild(this.resuelt),this.iconClipboard=Sprite.from("icon-clipboard"),this.iconClipboard.anchor.set(.5),this.iconClipboard.x=this.graphics.width-20,this.iconClipboard.y=this.graphics.height*.5,this.iconClipboard.cursor="pointer",this.iconClipboard.interactive=!0,this.on("click",()=>{navigator.clipboard.writeText(this._resueltOrigin),this.showCopyTooltip(),setTimeout(()=>{this.hideCopyTooltip()},2e3)}),this.graphics.addChild(this.iconClipboard),this.copyTooltip=new Badge({text:"Copy!!!",width:60,height:30,radius:8,labelFontSize:12,isPivot:!1,isPositionLabel:!0,fill:0}),this.copyTooltip.x=this.graphics.width-60,this.copyTooltip.y=-this.graphics.height+7,this.copyTooltip.alpha=0,this.graphics.addChild(this.copyTooltip)}set resultText(t){const{truncate:s,origin:r}=truncateString(t,45);this._resueltOrigin=r,this.resuelt.text=s}async showCopyTooltip(t=!0){gsapWithCSS.killTweensOf(this.copyTooltip),t?gsapWithCSS.to(this.copyTooltip,{alpha:1,duration:.2,ease:"power4.in"}):this.alpha=1}async hideCopyTooltip(t=!0){gsapWithCSS.killTweensOf(this.copyTooltip),t?gsapWithCSS.to(this.copyTooltip,{alpha:0,duration:.2,ease:"linear"}):this.alpha=0}}const defaultBadgeOptions={text:"-",width:155,height:70,radius:15,fill:4325835,labelColor:16777215,labelFontSize:20,labelFontFamily:"Epilogue Regular",isPivot:!0,isPositionLabel:!0,onClick:!1,labelAlpha:1};class Badge extends Container{constructor(t={}){const s={...defaultBadgeOptions,...t};super();ne(this,"graphics");ne(this,"label");this.graphics=new Graphics().beginFill(s.fill).drawRoundedRect(0,0,s.width,s.height,s.radius).endFill(),s.isPivot&&(this.graphics.pivot.x=this.graphics.width/2,this.graphics.pivot.y=this.graphics.height/2),this.addChild(this.graphics),this.label=new Label(s.text,{fill:s.labelColor,fontSize:s.labelFontSize,fontFamily:s.labelFontFamily,breakWords:!0,wordWrap:!0,wordWrapWidth:s.width-20}),this.label.alpha=s.labelAlpha,s.isPositionLabel&&(this.label.x=this.graphics.width/2,this.label.y=this.graphics.height/2),this.addChild(this.label),s.onClick&&(this.interactive=!0,this.cursor="pointer",this.on("click",()=>{previousResults.setCurrentResult=this.label.text,navigation.presentPopup(HashPopup)}),this.on("tap",()=>{previousResults.setCurrentResult=this.label.text,navigation.presentPopup(HashPopup)}))}set textLabel(t){this.label.text=t}get textLabel(){return this.label.text}}var AlignIndicador=(n=>(n.CENTER="center",n.RIGHT="right",n.LEFT="left",n))(AlignIndicador||{});const defaultTooltipOptions={text:"",width:60,height:30,radius:8,labelFontSize:12,isPivot:!1,isPositionLabel:!0,fill:0,alignIndicador:"center",labelAlpha:1};class Tooltip extends Container{constructor(t={}){super();ne(this,"baseTooltip");ne(this,"graphics");const s={...defaultTooltipOptions,...t};this.alpha=0,this.baseTooltip=new Badge({text:s.text,width:s.width,height:s.height,radius:s.radius,labelFontSize:s.labelFontSize,isPivot:s.isPivot,isPositionLabel:s.isPositionLabel,fill:s.fill,labelAlpha:s.labelAlpha}),this.addChild(this.baseTooltip),this.graphics=new Graphics,this.graphics.beginFill(0),this.graphics.moveTo(10.866,16.5),this.graphics.bezierCurveTo(10.4811,17.1667,9.51888,17.1667,9.13398,16.5),this.graphics.lineTo(.473724,1.5),this.graphics.bezierCurveTo(.0888229,.83333,.569948,-187347e-11,1.33975,-180618e-11),this.graphics.lineTo(18.6603,-29197e-11),this.graphics.bezierCurveTo(19.4301,-224672e-12,19.9112,.833334,19.5263,1.5),this.graphics.lineTo(10.866,16.5),this.graphics.closePath(),this.graphics.y=s.height,s.alignIndicador==="left"&&(this.graphics.x=50),s.alignIndicador==="center"&&(this.graphics.x=s.width/2),s.alignIndicador==="right"&&(this.graphics.x=s.width-70),this.addChild(this.graphics)}async showTooltip(t=!0){gsapWithCSS.killTweensOf(this),t?gsapWithCSS.to(this,{alpha:1,duration:.2,ease:"power4.in"}):this.alpha=1}async hideTooltip(t=!0){gsapWithCSS.killTweensOf(this),t?gsapWithCSS.to(this,{alpha:0,duration:.2,ease:"linear"}):this.alpha=0}}class Bets extends Container{constructor(t,s,r,o,h,c,a){super();ne(this,"layout");ne(this,"panelBase");ne(this,"container");ne(this,"plusBtn");ne(this,"minusBtn");ne(this,"bet");ne(this,"textInput");ne(this,"dollarLabel");ne(this,"incrementer");ne(this,"_enabled");ne(this,"nDecimals");ne(this,"maxValue");ne(this,"minValue");ne(this,"tooltip");this.scale.set(.8),this.incrementer=s,this.bet=t,this.nDecimals=o,this.maxValue=c,this.minValue=h,this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:270,height:70,alpha:.5,shadow:!1}),this.container.addChild(this.panelBase),this.layout=new Layout({type:"horizontal"}),this.layout.x=-this.panelBase.boxWidth*.5+38,this.container.addChild(this.layout),this.minusBtn=new MinusButton,this.minusBtn.onPress.connect(this.decremented.bind(this)),this.layout.addChild(this.minusBtn),this.dollarLabel=new Label(r,{fontFamily:"Epilogue Bold",fontSize:24,fill:16777215}),this.layout.addChild(this.dollarLabel),this.textInput=new TextInput({placeholder:"bets",fontSize:22,width:120,height:50,align:"right"},o,u=>{this.bet=u},h,c),this.textInput.value=this.bet.toFixed(this.nDecimals),this.textInput.pivot.x=this.textInput.width*.3,this.textInput.pivot.y=this.textInput.height/2,this.textInput.on("mouseover",()=>this._enabled&&this.tooltip.showTooltip()),this.textInput.on("mouseout",()=>this.tooltip.hideTooltip()),this.layout.addChild(this.textInput),this.plusBtn=new PlusButton,this.plusBtn.onPress.connect(this.incremented.bind(this)),this.layout.addChild(this.plusBtn),this.plusBtn.enabled=!0,this.minusBtn.enabled=!0,this._enabled=!0,this.tooltip=new Tooltip({text:a,width:380,height:80,labelFontSize:22,radius:24,labelAlpha:.7}),this.tooltip.y=-130,this.tooltip.x=-200,a&&this.container.addChild(this.tooltip)}incremented(){if(this.bet+this.incrementer<=this.maxValue){let t=(this.bet+this.incrementer).toFixed(this.nDecimals);this.bet=parseFloat(t),this.textInput.value=t}else this.bet=this.maxValue,this.textInput.value=this.bet.toFixed(this.nDecimals)}decremented(){if(this.bet-this.incrementer>=this.minValue){let t=(this.bet-this.incrementer).toFixed(this.nDecimals);this.bet=parseFloat(t),this.textInput.value=t}else this.bet=this.minValue,this.textInput.value=this.bet.toFixed(this.nDecimals)}set value(t){this.bet=t,this.textInput.value=this.bet.toFixed(this.nDecimals)}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.textInput.enabled=t,this.minusBtn.enabled=t,this.plusBtn.enabled=t}}const defaultLogoOptions={scale:.5};class Logo extends Container{constructor(t={}){super();ne(this,"image");ne(this,"imageScale");const s={...defaultLogoOptions,...t};this.imageScale=s.scale,this.image=Sprite.from("logo-r10-crash"),this.image.scale.set(s.scale),this.image.anchor.set(.5),this.addChild(this.image),responsive.getIsDesktop?this.scale.set(1):this.scale.set(.8)}async show(t=!0){gsapWithCSS.killTweensOf(this.image.scale),this.visible=!0,t?(this.image.scale.set(0),await gsapWithCSS.to(this.image.scale,{x:this.imageScale,y:this.imageScale,duration:.3,ease:"back.out"})):this.image.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.image.scale),t?await gsapWithCSS.to(this.image.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.image.scale.set(0),this.visible=!1}}const defaultButtonOptions={text:"",width:155,height:70,labelColor:2369584,labelFontSize:20,radius:20};class Button extends FancyButton{constructor(t={}){const s={...defaultButtonOptions,...t},r=new NineSlicePlane(Texture.from("button"),s.radius,s.radius,s.radius,s.radius);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-hover"),s.radius,s.radius,s.radius,s.radius);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button"),s.radius,s.radius,s.radius,s.radius);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-disabled"),s.radius,s.radius,s.radius,s.radius);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.scale.set(.8),this.x=38,this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(t){this.label.style.fill=t}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class AutomaticCashing extends Container{constructor(t,s,r,o,h,c,a,u,d=.45,p=0){super();ne(this,"container");ne(this,"panelBase");ne(this,"titleLabel");ne(this,"bets");ne(this,"switch");ne(this,"switchValue");ne(this,"_enabled");ne(this,"tooltip");const m=i18n.translatedText;this.scale.set(.8),this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:680,height:70,alpha:d,shadow:!1,color:p}),this.container.addChild(this.panelBase),this.switch=new Switcher([Sprite.from("switch-off"),Sprite.from("switch-on")]),this.switchValue=s,this.switch.forceSwitch(this.switchValue?1:0),this.switch.pivot.x=this.panelBase.boxWidth*.5-130,this.switch.pivot.y=this.switch.height/2,this.switch.x=-this.panelBase.boxWidth*.5+280,this.switch.onChange.connect(g=>{this._enabled?this.switchValue=typeof g=="boolean"?g:g!==0:this.switch.forceSwitch(this.switchValue?1:0)}),this.switch.scale.set(1.2),this.switch.on("mouseover",()=>this._enabled&&!this.switchValue&&this.tooltip.showTooltip()),this.switch.on("mouseout",()=>this.tooltip.hideTooltip()),this.container.addChild(this.switch),this.titleLabel=new Label(r,{fontFamily:"Epilogue Bold",fontSize:18,fill:16777215}),this.titleLabel.anchor.set(0),this.titleLabel.x=-this.panelBase.boxWidth*.5+100,this.titleLabel.y=-10,this.container.addChild(this.titleLabel),this.bets=new Bets(t,1,o,h,c,a,u),this.bets.scale.set(.6),this.bets.x=this.panelBase.boxWidth-440,this.container.addChild(this.bets),this.tooltip=new Tooltip({text:m.warningAutoBet,width:260,height:80,labelFontSize:14,radius:24,alignIndicador:AlignIndicador.LEFT,labelAlpha:.7}),this.tooltip.y=-130,this.tooltip.x=-250,this.addChild(this.tooltip),this._enabled=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.bets.enabled=t,this.container.alpha=t?1:.5}get value(){return this.switchValue}switchOff(t=0){this.switch.forceSwitch(t),this.switchValue=!1}get bet(){return this.bets.bet}updateText(t){this.titleLabel.text=t}}class ProgressBarMultiplier extends ProgressBar{constructor(t,s="1.00x",r=0){super({bg:"progressbar-bg",fill:"progressbar",progress:r});ne(this,"multiplierLabel");ne(this,"image");ne(this,"maxMultiplier");ne(this,"_maxWidth",400);ne(this,"lastFloorMultiplier");this.maxMultiplier=t,this.lastFloorMultiplier=1,this.multiplierLabel=new Label(s,{fontSize:90,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.multiplierLabel.pivot.x=this.multiplierLabel.width/2,this.multiplierLabel.anchor.x=0,this.multiplierLabel.x=this.width/2,this.multiplierLabel.y=80,this.addChild(this.multiplierLabel),this.image=Sprite.from("balon"),this.image.y=-5,this.image.x=-5,this.addChild(this.image)}set multiplier(t){const s=Math.log(t)/Math.log(this.maxMultiplier),r=this._maxWidth*s-5;this.progress=100*s,this.image.x=r>this._maxWidth?this._maxWidth:r,this.multiplierLabel.text=`${t.toFixed(2)}x`;const o=Math.floor(t);this.lastFloorMultiplier!=o&&(this.lastFloorMultiplier=o,gsapWithCSS.killTweensOf(this.multiplierLabel.scale),this.multiplierLabel.scale.set(.86),gsapWithCSS.to(this.multiplierLabel.scale,{x:1,y:1,duration:.4,ease:"back.out"}))}}class ConnectionStatus extends Container{constructor(){super();ne(this,"hasStableConnection");ne(this,"container");ne(this,"stableBg");ne(this,"unstableBg");ne(this,"unstableImage");ne(this,"stableImage");ne(this,"statusLabel");this.container=new Container,this.addChild(this.container),this.stableBg=new Graphics,this.stableBg.beginFill(1746517),this.stableBg.drawRoundedRect(0,0,230,40,10),this.stableBg.visible=!1,this.stableBg.endFill(),this.container.addChild(this.stableBg),this.unstableBg=new Graphics,this.unstableBg.beginFill(16711680),this.unstableBg.drawRoundedRect(0,0,230,40,10),this.unstableBg.visible=!1,this.unstableBg.endFill(),this.container.addChild(this.unstableBg),this.stableImage=Sprite.from("stable-connection"),this.stableImage.visible=!1,this.stableImage.scale.set(.8),this.stableImage.anchor.set(.5),this.container.addChild(this.stableImage),this.unstableImage=Sprite.from("unstable-connection"),this.unstableImage.visible=!1,this.unstableImage.scale.set(.8),this.unstableImage.anchor.set(.5),this.container.addChild(this.unstableImage),this.statusLabel=new Label("",{fontFamily:"Epilogue Bold",fontSize:14,fill:16777215},!1),this.container.addChild(this.statusLabel),this.resize(),responsive.getIsDesktop?this.scale.set(1):this.scale.set(.6)}async stableConnection(t){this.statusLabel.text=i18n.translatedText.stableConnectionText(t),this.hasStableConnection!==!0&&(this.hasStableConnection=!0,this.unstableImage.visible=!1,this.unstableBg.visible=!1,this.stableImage.visible=!0,this.stableBg.visible=!0,await this.show())}async unstableConnection(t){this.statusLabel.text=i18n.translatedText.unstableConnectionText(t),this.hasStableConnection!==!1&&(this.hasStableConnection=!1,this.stableImage.visible=!1,this.stableBg.visible=!1,this.unstableImage.visible=!0,this.unstableBg.visible=!0,await this.show())}async show(t=!0){gsapWithCSS.killTweensOf(this.container.scale),this.visible=!0,t?(this.container.scale.set(0),await gsapWithCSS.to(this.container.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.container.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.container.scale),t?await gsapWithCSS.to(this.container.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.container.scale.set(0),this.visible=!1}resize(){this.stableImage.x=20,this.stableImage.y=20,this.unstableImage.x=20,this.unstableImage.y=20,this.statusLabel.x=40,this.statusLabel.y=this.height/2}}class Animation{constructor(){ne(this,"isAnimation",!0)}getAnimation(){return this.isAnimation}setAnimation(e){this.isAnimation=e}}const animation=new Animation;class StorageWrapper{getString(e){return localStorage.getItem(e)??void 0}setString(e,t){localStorage.setItem(e,t)}getNumber(e){const t=this.getString(e)??void 0,s=Number(t);return isNaN(s)?null:s}setNumber(e,t){this.setString(e,String(t))}getBool(e){const t=localStorage.getItem(e);if(t)return t.toLowerCase()==="true"}setBool(e,t){localStorage.setItem(e,String(t))}getObject(e){const t=this.getString(e);if(t)try{return JSON.parse(t)}catch(s){console.warn(s);return}}setObject(e,t){this.setString(e,JSON.stringify(t))}}const storage=new StorageWrapper,KEY_VOLUME_MASTER="volume-master",KEY_VOLUME_BGM="volume-bgm",KEY_VOLUME_SFX="volume-sfx",KEY_ANIMATION="animation";class UserSettings{constructor(){bgm.setVolume(this.getBgmVolume()),sfx.setVolume(this.getSfxVolume()),animation.setAnimation(this.getAnimation())}getAnimation(){return storage.getBool(KEY_ANIMATION)??!0}setAnimation(e){animation.setAnimation(e),storage.setBool(KEY_ANIMATION,e)}getMasterVolume(){return storage.getNumber(KEY_VOLUME_MASTER)??.5}setMasterVolume(e){setMasterVolume(e),storage.setNumber(KEY_VOLUME_MASTER,e)}getBgmVolume(){return storage.getNumber(KEY_VOLUME_BGM)??1}setBgmVolume(e){bgm.setVolume(e),storage.setNumber(KEY_VOLUME_BGM,e)}getSfxVolume(){return storage.getNumber(KEY_VOLUME_SFX)??1}setSfxVolume(e){sfx.setVolume(e),storage.setNumber(KEY_VOLUME_SFX,e)}}const userSettings=new UserSettings,defaultSettingHeaderOption={icon:"icon-animation",showIcon:!0,title:"",subtitle:""};class SettingHeader extends Layout{constructor(t={}){const s={...defaultSettingHeaderOption,...t};super({type:"horizontal",elementsMargin:16});ne(this,"icon");ne(this,"layout");ne(this,"title");ne(this,"subtitle");this.icon=Sprite.from(s.icon),s.showIcon&&this.addChild(this.icon),this.layout=new Layout({type:"vertical",elementsMargin:0}),this.addChild(this.layout),this.title=new Label(s.title,{align:"left",fill:16777215,fontSize:14,fontFamily:"Epilogue Bold"}),this.title.anchor.x=0,this.title.y=-50,this.layout.addChild(this.title),this.subtitle=new Label(s.subtitle,{align:"left",fill:16777215,fontSize:12}),this.subtitle.anchor.x=0,this.subtitle.y=-28,this.subtitle.alpha=.5,this.layout.addChild(this.subtitle)}}class Divider extends Container{constructor(){super();ne(this,"divider");this.divider=new Graphics().beginFill(16777215,.1).drawRoundedRect(0,0,280,1,10).beginFill(16777215).drawRoundedRect(4,4,280-4*2,1-4*2,10),this.addChild(this.divider)}}const defaultVolumeSliderOption={showDivider:!0,title:"",subtitle:"",min:-.1,max:100,value:100};class VolumeSlider extends Layout{constructor(t={},s){const r=Texture.from("icon-volume"),o=Texture.from("icon-volume-average"),h=Texture.from("icon-volume-mute"),c=240,a=2,u=10,d=4,p=9,m=1477704,g=16744993,_=1477704,y=16777215,v=new Graphics().beginFill(y,.4).drawRoundedRect(0,0,c,a,u).beginFill(y).drawRoundedRect(d,d,c-d*2,a-d*2,u),N=new Graphics().beginFill(_).drawRoundedRect(0,0,c,a,u).beginFill(g).drawRoundedRect(d,d,c-d*2,a-d*2,u),w=new Graphics().drawCircle(0,0,p).beginFill(m).drawCircle(0,0,p).endFill(),k={...defaultVolumeSliderOption,...t};super({type:"vertical",elementsMargin:10});ne(this,"layout");ne(this,"icon");ne(this,"settingHeader");ne(this,"slider");ne(this,"divider");this.settingHeader=new SettingHeader({showIcon:!1,title:k.title,subtitle:k.subtitle}),this.addChild(this.settingHeader),this.layout=new Layout({type:"horizontal",horPadding:10}),this.addChild(this.layout),this.icon=new Sprite(r),this.icon.anchor.set(.5),this.layout.addChild(this.icon),this.slider=new Slider({bg:v,fill:N,slider:w,min:k.min,max:k.max,value:k.value}),this.slider.onUpdate.connect(U=>{U<=0?this.icon.texture=h:U>0&&U<60?this.icon.texture=o:this.icon.texture=r,s(U)}),this.layout.addChild(this.slider),this.divider=new Divider,k.showDivider&&this.addChild(this.divider)}get value(){return this.slider.value}set value(t){this.slider.value=t}}const defaultSwitchAnimationOption={showDivider:!0};class SwitchAnimation extends Layout{constructor(t={}){const s={...defaultSwitchAnimationOption,...t};super({type:"vertical",elementsMargin:10});ne(this,"layout");ne(this,"switch");ne(this,"settingHeader");ne(this,"divider");let r=i18n.translatedText;this.layout=new Layout({type:"horizontal",elementsMargin:70}),this.addChild(this.layout),this.settingHeader=new SettingHeader({icon:"icon-animation",title:r.settingsAnimationTitle,subtitle:r.settingsAnimationSubtitle}),this.layout.addChild(this.settingHeader),this.switch=new Switcher([Sprite.from("switch-off"),Sprite.from("switch-on")]),this.switch.forceSwitch(Number(userSettings.getAnimation())),this.switch.onChange.connect(o=>{userSettings.setAnimation(typeof o=="boolean"?o:o!==0)}),this.switch.scale.set(1.2),this.layout.addChild(this.switch),this.divider=new Divider,s.showDivider&&this.addChild(this.divider)}updateText(){let t=i18n.translatedText;this.settingHeader.title.text=t.settingsAnimationTitle,this.settingHeader.subtitle.text=t.settingsAnimationSubtitle}}const LanguageMap={Portuguese:Language.PT,English:Language.EN,Spanish:Language.ES},defaultSelectLanguageOption={backgroundColor:0,borderColor:16777215,dropDownBackgroundColor:0,dropDownHoverColor:8092539,fontColor:16777215,fontSize:14,width:280,height:40,radius:8,itemsAmount:100};class SelectLanguage extends Layout{constructor(t,s={}){const r={...defaultSelectLanguageOption,...s};super({type:"vertical",elementsMargin:10});ne(this,"settingHeader");ne(this,"select");let o=i18n.translatedText;this.settingHeader=new SettingHeader({icon:"icon-language",title:o.settingsLangTitle,subtitle:o.settingsLangSubtitle}),this.addChild(this.settingHeader);const h={fill:r.fontColor,fontSize:r.fontSize};let c={closedBG:this.getClosedBG(r.backgroundColor,r.borderColor,r.width,r.height,r.radius),openBG:this.getOpenBG(r.dropDownBackgroundColor,r.borderColor,r.width,r.height,r.radius),textStyle:h,items:{items:Object.keys(LanguageMap),backgroundColor:r.backgroundColor,hoverColor:r.dropDownHoverColor,width:r.width,height:r.height,textStyle:{...h,dropShadowBlur:5},radius:r.radius},scrollBox:{radius:r.radius}};this.select=new Select(c),this.select.onSelect.connect((a,u)=>{i18n.language=LanguageMap[u];let d=i18n.translatedText;this.settingHeader.title.text=d.settingsLangTitle,this.settingHeader.subtitle.text=d.settingsLangSubtitle,t&&t()}),this.addChild(this.select)}getOpenBG(t,s,r,o,h){const c=new Graphics().beginFill(t).lineStyle({width:1,color:s,alpha:.2}).drawRoundedRect(0,0,r,o*5,h),a=Sprite.from("icon-arrow-down");return a.angle=180,a.anchor.set(.5),a.x=r*.9,a.y=o/2,c.addChild(a),c}getClosedBG(t,s,r,o,h){const c=new Graphics().beginFill(t,.1).lineStyle({width:1,color:s,alpha:.2}).drawRoundedRect(0,0,r,o,h),a=Sprite.from("icon-arrow-down");return a.anchor.set(.5),a.x=r*.9,a.y=o/2,c.addChild(a),c}}class SettingsPopup extends Container{constructor(){super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"layout");ne(this,"bgmSlider");ne(this,"sfxSlider");ne(this,"switchAnimation");ne(this,"selectLanguage");ne(this,"settingHeaderSupport");ne(this,"divider");ne(this,"layoutSupport");let t=i18n.translatedText;this.bg=Sprite.from(Texture.EMPTY),this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:324,height:500,alpha:.8,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.layout=new Layout({type:"vertical",elementsMargin:10}),this.layout.x=-140,this.layout.y=-this.panelBase.boxHeight*.5+30,this.panel.addChild(this.layout),this.switchAnimation=new SwitchAnimation,this.layout.addChild(this.switchAnimation),this.bgmSlider=new VolumeSlider({title:t.settingsMusicTitle,subtitle:t.settingsMusicSubtitle},r=>{userSettings.setBgmVolume(r/100)}),this.layout.addChild(this.bgmSlider),this.sfxSlider=new VolumeSlider({title:t.settingsSoundEffectsTitle,subtitle:t.settingsSoundEffectsSubtitle},r=>{userSettings.setSfxVolume(r/100)}),this.layout.addChild(this.sfxSlider),this.layoutSupport=new Layout({type:"vertical",elementsMargin:10}),this.layout.addChild(this.layoutSupport),this.settingHeaderSupport=new SettingHeader({icon:"icon-support",title:t.settingsContactSupportTitle,subtitle:t.settingsContactSupportSubtitle}),this.layoutSupport.addChild(this.settingHeaderSupport),this.divider=new Divider,this.layoutSupport.addChild(this.divider);const s=()=>{let r=i18n.translatedText;this.bgmSlider.settingHeader.title.text=r.settingsMusicTitle,this.bgmSlider.settingHeader.subtitle.text=r.settingsMusicSubtitle,this.sfxSlider.settingHeader.title.text=r.settingsSoundEffectsTitle,this.sfxSlider.settingHeader.subtitle.text=r.settingsSoundEffectsSubtitle,this.settingHeaderSupport.title.text=r.settingsContactSupportTitle,this.settingHeaderSupport.subtitle.text=r.settingsContactSupportSubtitle,this.switchAnimation.updateText()};this.selectLanguage=new SelectLanguage(s),this.layout.addChild(this.selectLanguage)}resize(t,s){this.bg.width=t,this.bg.height=s,this.panel.x=t-200,this.panel.y=360}prepare(){this.bgmSlider.value=userSettings.getBgmVolume()*100,this.sfxSlider.value=userSettings.getSfxVolume()*100}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),this.bg.alpha=0,this.panel.pivot.y=200,gsapWithCSS.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:300,duration:.3,ease:"back.in"})}}class PanelSettingsPopup extends Container{constructor(){super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"container");ne(this,"layout");ne(this,"settings");ne(this,"expand");ne(this,"minimize");ne(this,"leaderboard");ne(this,"award");ne(this,"info");ne(this,"close");ne(this,"currentModal");this.currentModal=null,this.bg=Sprite.from(Texture.EMPTY),this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new Graphics,this.panelBase.beginFill(264209,.5),this.panelBase.drawRoundedRect(0,0,30,240,8),this.panelBase.x=-15,this.panelBase.y=-100,this.panel.addChild(this.panelBase),this.layout=new Layout({type:"vertical",elementsMargin:20}),this.layout.y=10,this.layout.x=6,this.panelBase.addChild(this.layout),this.info=new IconButton({image:"icon-info"},!1),this.info.onPress.connect(this.toggleInfo.bind(this)),this.layout.addChild(this.info),this.container=new Container,this.layout.addChild(this.container),this.expand=new IconButton({image:"icon-expand"},!1),this.expand.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.expand),this.minimize=new IconButton({image:"icon-minimize"},!1),this.minimize.visible=!1,this.minimize.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.minimize),this.settings=new IconButton({image:"icon-setting"},!1),this.settings.onPress.connect(this.toggleSettings.bind(this)),this.layout.addChild(this.settings),this.award=new IconButton({image:"icon-award"},!1),this.award.onPress.connect(this.toggleAword.bind(this)),this.layout.addChild(this.award),this.leaderboard=new IconButton({image:"icon-leaderboard"},!1),this.leaderboard.onPress.connect(this.toggleLeaderboard.bind(this)),this.layout.addChild(this.leaderboard),this.close=new IconButton({image:"icon-close"},!1),this.layout.addChild(this.close)}resize(t,s){this.bg.width=t,this.bg.height=s,this.panel.x=t-25,this.panel.y=200}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),this.bg.alpha=0,this.panel.pivot.y=100,gsapWithCSS.to(this.bg,{alpha:.8,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:0,duration:.3,ease:"back.out"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.killTweensOf(this.panel.pivot),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"}),await gsapWithCSS.to(this.panel.pivot,{y:300,duration:.3,ease:"back.in"})}toggleModal(t){const s=document.getElementById(t);if(s){this.currentModal=t;const r=s.getAttribute("active")===String(!0);s.setAttribute("active",!r)}}dismissModal(){if(!this.currentModal)return;const t=document.getElementById(this.currentModal);this.currentModal=null,t&&t.setAttribute("active","false")}handlerFullScreen(){if(document.fullscreenElement)this.minimize.visible=!1,this.expand.visible=!0,document.exitFullscreen();else{this.minimize.visible=!0,this.expand.visible=!1;const t=document.body;t==null||t.requestFullscreen()}}toggleSettings(){navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(SettingsPopup)}toggleInfo(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-info")}toggleAword(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-award")}toggleLeaderboard(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-leaderboard")}}class PanelSetting extends Container{constructor(){super();ne(this,"layout");ne(this,"container");ne(this,"settings");ne(this,"expand");ne(this,"minimize");ne(this,"leaderboard");ne(this,"award");ne(this,"info");ne(this,"close");ne(this,"grid");ne(this,"currentModal");this.currentModal=null,this.layout=new Layout({type:"horizontal",elementsMargin:40}),this.layout.visible=responsive.getIsDesktop,this.addChild(this.layout),this.info=new IconButton({image:"icon-info"},!1),this.info.onPress.connect(this.toggleInfo.bind(this)),this.layout.addChild(this.info),this.container=new Container,this.layout.addChild(this.container),this.expand=new IconButton({image:"icon-expand"},!1),this.expand.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.expand),this.minimize=new IconButton({image:"icon-minimize"},!1),this.minimize.visible=!1,this.minimize.onPress.connect(this.handlerFullScreen.bind(this)),this.container.addChild(this.minimize),this.settings=new IconButton({image:"icon-setting"},!1),this.settings.onPress.connect(this.toggleSettings.bind(this)),this.layout.addChild(this.settings),this.award=new IconButton({image:"icon-award"},!1),this.award.onPress.connect(this.toggleAword.bind(this)),this.layout.addChild(this.award),this.leaderboard=new IconButton({image:"icon-leaderboard"},!1),this.leaderboard.onPress.connect(this.toggleLeaderboard.bind(this)),this.layout.addChild(this.leaderboard),this.close=new IconButton({image:"icon-close"},!1),this.layout.addChild(this.close),this.grid=new IconButton({image:"icon-grid",drawRadius:6,drawWidth:30,drawHeight:30}),this.grid.x=15,this.grid.y=-20,this.grid.visible=!responsive.getIsDesktop,this.grid.onPress.connect(this.toggleGrid.bind(this)),this.addChild(this.grid)}toggleModal(t){const s=document.getElementById(t);if(s){this.currentModal=t;const r=s.getAttribute("active")===String(!0);s.setAttribute("active",!r)}}dismissModal(){if(!this.currentModal)return;const t=document.getElementById(this.currentModal);this.currentModal=null,t&&t.setAttribute("active","false")}handlerFullScreen(){if(document.fullscreenElement)this.minimize.visible=!1,this.expand.visible=!0,document.exitFullscreen();else{this.minimize.visible=!0,this.expand.visible=!1;const t=document.body;t==null||t.requestFullscreen()}}toggleSettings(){if(navigation.currentPopup!==void 0){navigation.dismissPopup();return}navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(SettingsPopup)}toggleInfo(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-info")}toggleAword(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-award")}toggleLeaderboard(){navigation.dismissPopup(),this.dismissModal(),this.toggleModal("modal-leaderboard")}toggleGrid(){if(navigation.currentPopup!==void 0){navigation.dismissPopup();return}navigation.dismissPopup(),this.dismissModal(),navigation.presentPopup(PanelSettingsPopup)}}class Result extends Container{constructor(t="",s=35,r=45){super();ne(this,"container");ne(this,"layout");ne(this,"label1");ne(this,"label2");this.container=new Container,this.addChild(this.container),this.layout=new Layout({type:"vertical",elementsMargin:-8}),this.container.addChild(this.layout),this.label1=new Label(t,{fontSize:s,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.layout.addChild(this.label1),this.label2=new Label("...",{fontSize:r,fill:16765810,fontFamily:"Epilogue ExtraBold",lineJoin:"bevel",strokeThickness:6}),this.layout.addChild(this.label2)}updateText(t){this.label1.text=t}set winValue(t){this.label2.text=t}set visibleLabel(t){this.label1.visible=t,this.label2.visible=t}}const defaultButtonCancelOptions={text:"",width:155,height:70,labelColor:16777215,labelFontSize:20};class ButtonCancel extends FancyButton{constructor(t={}){const s={...defaultButtonCancelOptions,...t},r=new NineSlicePlane(Texture.from("button-cancel"),10,16,16,20);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-cancel-hover"),16,16,16,20);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button-cancel"),16,16,16,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-disabled"),16,16,16,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.scale.set(.8),this.x=38,this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(t){this.label.style.fill=t}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}const showMultipliers=12;class PreviousResults extends Container{constructor(){super();ne(this,"scrollBox");ne(this,"multiplierBadge");ne(this,"widthBadge",100);ne(this,"heightBadge",40);ne(this,"radiusBadge",15);ne(this,"borderBadge",2);ne(this,"borderColorBadge",16777215);ne(this,"graphics");this.multiplierBadge=[];const t=responsive.getIsDesktop?.1:1;this.graphics=new Graphics().beginFill(0,t).drawRoundedRect(0,0,460,180,24).endFill(),this.graphics.pivot.x=this.graphics.width/2,this.addChild(this.graphics),this.scrollBox=new ScrollBox({elementsMargin:10,width:440,height:150,items:this.multipliers,horPadding:2,vertPadding:2}),this.scrollBox.pivot.x=this.scrollBox.width/2,this.scrollBox.pivot.y=this.scrollBox.height/2,this.scrollBox.x=this.graphics.width/2,this.scrollBox.y=this.graphics.height/2,this.graphics.addChild(this.scrollBox)}updateResults(t,s=!1){if(s){let r=Math.min(t.length,showMultipliers-1);this.multiplierBadge[0].textLabel="In Game",this.multiplierBadge[0].graphics.lineStyle(this.borderBadge,this.borderColorBadge).drawRoundedRect(0,0,this.widthBadge,this.heightBadge,this.radiusBadge);for(let o=0;o<r;o++)this.multiplierBadge[o+1].textLabel=`${t[o].toFixed(2)}x`}else{this.multiplierBadge[0].graphics.lineStyle(this.borderBadge,this.listColors[0]).drawRoundedRect(0,0,this.widthBadge,this.heightBadge,this.radiusBadge);let r=Math.min(t.length,showMultipliers);for(let o=0;o<r;o++)this.multiplierBadge[o].textLabel=`${t[o].toFixed(2)}x`}}get multipliers(){const t=[],s=this.listColors;for(let r=0;r<showMultipliers;r+=1){const o=new Badge({width:this.widthBadge,height:this.heightBadge,radius:this.radiusBadge,fill:s[r],labelFontSize:14,isPivot:!1,onClick:!0});this.multiplierBadge.push(o),t.push(o)}return t}get listColors(){return[1155406,4325835,3160385,7798996,10551501,31938,4325835,3160385,7798996,10551501,31938,4325835]}}const defaultButtonResetOptions={text:"",width:100,height:45,labelColor:16777215,labelFontSize:20};class ButtonReset extends FancyButton{constructor(t={}){const s={...defaultButtonResetOptions,...t},r=new NineSlicePlane(Texture.from("button-reset"),20,20,20,20);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-reset-hover"),20,20,20,20);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button-reset"),20,20,20,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-reset-disabled"),20,20,20,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(t){this.label.style.fill=t}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}const defaultButtonLinkOptions={text:"",width:130,height:50,labelColor:16777215,labelFontSize:20};class ButtonLink extends FancyButton{constructor(t={}){const s={...defaultButtonLinkOptions,...t},r=new NineSlicePlane(Texture.from("button-link"),20,20,20,20);r.width=s.width,r.height=s.height;const o=new NineSlicePlane(Texture.from("button-link-disabled"),20,20,20,20);o.width=s.width,o.height=s.height;const h=new NineSlicePlane(Texture.from("button-link"),20,20,20,20);h.width=s.width,h.height=s.height;const c=new NineSlicePlane(Texture.from("button-link-disabled"),20,20,20,20);c.width=s.width,c.height=s.height;super({defaultView:r,hoverView:o,pressedView:h,disabledView:c,anchor:.5});ne(this,"label");ne(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize,fontFamily:"Epilogue Bold"}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set fillDisabledLabel(t){this.label.style.fill=t}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:1,y:1,duration:.3,ease:"back.out"})):this.scale.set(1)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class ProblemOccurredPopup extends Container{constructor(){super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"iconReconnecting");ne(this,"titleLabel");ne(this,"subtitleLabel");ne(this,"buttonLabel");this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.5,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({color:0,width:550,height:390,shadow:!1,radius:24}),this.panelBase.filters=[new AlphaFilter(.9),new BlurFilter],this.panel.addChild(this.panelBase),this.iconReconnecting=Sprite.from("icon-problem-occurred"),this.iconReconnecting.y=-140,this.iconReconnecting.anchor.set(.5),this.panel.addChild(this.iconReconnecting),this.titleLabel=new Label("A problem occurred!",{fontFamily:"Epilogue Bold",fontSize:28}),this.titleLabel.y=-90,this.panel.addChild(this.titleLabel),this.subtitleLabel=new Label("We are currently troubleshooting, please try again.",{fontSize:16,breakWords:!0,wordWrap:!0,wordWrapWidth:400}),this.subtitleLabel.y=0,this.subtitleLabel.alpha=.7,this.panel.addChild(this.subtitleLabel),this.buttonLabel=new Label("Volver a intentar",{fontSize:20,fontFamily:"Epilogue Bold"}),this.buttonLabel.y=140,this.panel.addChild(this.buttonLabel),this.buttonLabel.interactive=!0,this.buttonLabel.cursor="pointer"}setText(t,s){this.titleLabel.text=t,this.subtitleLabel.text=s}resize(t,s){this.bg.width=t,this.bg.height=s,this.panel.x=t/2,this.panel.y=s/2}async show(){this.bg.alpha=.8}async hide(){this.bg.alpha=0}}class AutoBetPopup extends Container{constructor(){var s,r,o,h,c;super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"layout");ne(this,"label");ne(this,"iconClose");ne(this,"automaticCashingCurrency");ne(this,"automaticCashingMultiplier");ne(this,"numberOfRounds");ne(this,"stopOnProfit");ne(this,"stopOnLoss");ne(this,"onWin");ne(this,"onLoss");ne(this,"startAutoBetButton");ne(this,"bet");ne(this,"problemOcurredPopup");ne(this,"onGameEnding",async t=>{t&&this.upd()});ne(this,"onGamePlaying",async t=>{t&&this.upd()});ne(this,"onGameStarting",async t=>{t&&this.upd()});ne(this,"onGameLocking",async t=>{t&&this.upd()});const t=i18n.translatedText;game.addObserver(this),this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.3,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:600,height:750,shadow:!1,radius:24}),this.panel.addChild(this.panelBase),this.label=new Label(t.automaticGame,{fontSize:20,fontFamily:"Epilogue Bold"},!1),this.label.y=-this.panelBase.boxHeight*.5+25,this.label.x=-this.panelBase.boxWidth*.5+25,this.panel.addChild(this.label),this.iconClose=new IconButton({image:"icon-close"},!1),this.iconClose.y=-this.panelBase.boxHeight*.5+25,this.iconClose.x=this.panelBase.boxWidth*.5-50,this.iconClose.onPress.connect(()=>navigation.dismissPopup()),this.panel.addChild(this.iconClose),this.bet=new ItemBet(((s=game.bet)==null?void 0:s.coins)||1,t.bet,"$",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxBet,`${t.minimum} x1.01 / ${t.maximum} x${backendConfigs.maxMultiplier}`),this.bet.y=-this.panelBase.boxHeight*.5+120,this.panel.addChild(this.bet),this.automaticCashingMultiplier=new AutomaticCashing(((r=game.bet)==null?void 0:r.autoMultiplier)||2,!!((o=game.bet)!=null&&o.autoMultiplier),t.automaticMultiplierCashingText,"x ",backendConfigs.multiplierPrecision,backendConfigs.minMultiplier,backendConfigs.maxMultiplier,`${t.minimum} x1.01 / ${t.maximum} x${backendConfigs.maxMultiplier}`,.06,16777215),this.automaticCashingMultiplier.y=-this.panelBase.boxHeight*.5+190,this.panel.addChild(this.automaticCashingMultiplier),this.automaticCashingCurrency=new AutomaticCashing(((h=game.bet)==null?void 0:h.autoProfit)||2,!!((c=game.bet)!=null&&c.autoProfit),t.automaticCurrencyCashingText,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxProfit,`${t.maximum} $ ${backendConfigs.maxBet.toFixed(2)}`,.06,16777215),this.automaticCashingCurrency.y=-this.panelBase.boxHeight*.5+260,this.panel.addChild(this.automaticCashingCurrency),this.layout=new Layout({type:"vertical",elementsMargin:16}),this.layout.y=-this.panelBase.boxHeight*.5+330,this.panel.addChild(this.layout),this.numberOfRounds=new ItemSimple(t.numberOfRounds,0,"",1,100),this.layout.addChild(this.numberOfRounds),this.onWin=new ItemOn(t.onWin,backendConfigs.betPrecision,"%",-100,1e5),this.layout.addChild(this.onWin),this.onLoss=new ItemOn(t.onLoss,backendConfigs.betPrecision,"%",-100,1e5),this.layout.addChild(this.onLoss),this.stopOnProfit=new ItemSimple(t.stopOnProfit,backendConfigs.betPrecision,"$",0,1e5),this.layout.addChild(this.stopOnProfit),this.stopOnLoss=new ItemSimple(t.stopOnLoss,backendConfigs.betPrecision,"$",0,1e5),this.layout.addChild(this.stopOnLoss),this.startAutoBetButton=new Button({text:t.startAutoBet,width:300,radius:40}),this.upd(),this.startAutoBetButton.onPress.connect(async()=>{this.iconClose.visible=!1,this.startAutoBetButton.disabled();const a=navigation.currentScreen;if(a instanceof HomeScreen)try{await a.handlerBet(this.bet.bets.bet,this.automaticCashingMultiplier.value?this.automaticCashingMultiplier.bet:void 0,this.automaticCashingCurrency.value?this.automaticCashingCurrency.bet:void 0,{autoRounds:this.numberOfRounds.panelTextInput.bet,betOnWin:this.onWin.panelTextInput.bet*(this.onWin.isIncrease?1:-1),betOnLoss:this.onLoss.panelTextInput.bet*(this.onLoss.isIncrease?1:-1),stopOnProfit:this.stopOnProfit.panelTextInput.bet,stopOnLoss:this.stopOnLoss.panelTextInput.bet}),await navigation.dismissPopup()}catch(u){if(u!=null&&u.validationErrors){let d=u.validationErrors.map(p=>p!=null&&p.args?"- "+p.message(p.args):"- "+p.message);this.problemOcurredPopup.setText("A problem ocurred",`${d.join(`
`)}`),this.problemOcurredPopup.visible=!0}else u!=null&&u.serverError&&(this.problemOcurredPopup.setText("A problem ocurred",`${u.serverError}`),this.problemOcurredPopup.visible=!0);this.iconClose.visible=!0,game.status==BeRqEnum.GAME_START&&this.startAutoBetButton.activated()}else this.iconClose.visible=!0}),this.layout.addChild(this.startAutoBetButton),this.problemOcurredPopup=new ProblemOccurredPopup,this.problemOcurredPopup.visible=!1,this.problemOcurredPopup.buttonLabel.on("click",()=>{this.problemOcurredPopup.visible=!1}),this.addChild(this.problemOcurredPopup),responsive.getIsDesktop?this.panel.scale.set(1):this.panel.scale.set(.6)}resize(t,s){this.problemOcurredPopup.resize(t,s),this.bg.width=t,this.bg.height=s,this.panel.x=t/2,this.panel.y=s/2}upd(){game.bet?(this.bet.bets.value=game.bet.coins,game.bet.autoProfit?(this.automaticCashingCurrency.bets.value=game.bet.autoProfit,this.automaticCashingCurrency.switchOff(1)):this.automaticCashingCurrency.switchOff(0),game.bet.autoMultiplier?(this.automaticCashingMultiplier.bets.value=game.bet.autoMultiplier,this.automaticCashingMultiplier.switchOff(1)):this.automaticCashingMultiplier.switchOff(0),game.bet.auto?(this.numberOfRounds.panelTextInput.value=game.bet.auto.autoRounds,this.onWin.panelTextInput.value=Math.abs(game.bet.auto.betOnWin),this.onLoss.panelTextInput.value=Math.abs(game.bet.auto.betOnLoss),this.onWin.isIncrease=game.bet.auto.betOnWin>=0,this.onLoss.isIncrease=game.bet.auto.betOnLoss>=0,this.stopOnProfit.panelTextInput.value=game.bet.auto.stopOnProfit,this.stopOnLoss.panelTextInput.value=game.bet.auto.stopOnLoss):this.numberOfRounds.panelTextInput.value=1,this.startAutoBetButton.visible=!1):(this.startAutoBetButton.visible=!0,user.status===UserStatusEnum.SPECTING&&game.status!==BeRqEnum.GAME_LOCK?this.startAutoBetButton.activated():this.startAutoBetButton.disabled())}async show(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.from(this.bg,{alpha:.5,duration:.2,ease:"linear"})}async hide(){gsapWithCSS.killTweensOf(this.bg),gsapWithCSS.to(this.bg,{alpha:0,duration:.2,ease:"linear"})}}ne(AutoBetPopup,"assetBundles",["home","common"]);class ItemBet extends Container{constructor(t,s,r,o,h,c,a){super();ne(this,"panelBaseItem");ne(this,"label");ne(this,"bets");this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(s,{fontSize:16,fontFamily:"Epilogue Bold"}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-10,this.panelBaseItem.addChild(this.label),this.bets=new Bets(t,1,r,o,h,c,a),this.bets.scale.set(.6),this.bets.x=this.panelBaseItem.width-300,this.panelBaseItem.addChild(this.bets)}}class ItemSimple extends Container{constructor(t,s,r,o,h){super();ne(this,"panelBaseItem");ne(this,"label");ne(this,"panelTextInput");this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(t,{fontSize:16,fontFamily:"Epilogue Bold"}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-10,this.panelBaseItem.addChild(this.label),this.panelTextInput=new PanelTextInput(s,r,o,h),this.panelTextInput.x=this.panelBaseItem.width-320,this.panelBaseItem.addChild(this.panelTextInput)}}class ItemOn extends Container{constructor(t,s,r,o,h){super();ne(this,"panelBaseItem");ne(this,"label");ne(this,"panelTextInput");ne(this,"decreaseEnabledBtn");ne(this,"decreaseDisabledBtn");ne(this,"increaseEnabledBtn");ne(this,"increaseDisabledBtn");const c=i18n.translatedText;this.panelBaseItem=new PanelBaseItem,this.addChild(this.panelBaseItem),this.label=new Label(t,{fontSize:16,fontFamily:"Epilogue Bold",breakWords:!0,wordWrap:!0,wordWrapWidth:80}),this.label.anchor.set(0),this.label.x=-this.panelBaseItem.width+230,this.label.y=-20,this.panelBaseItem.addChild(this.label),this.panelTextInput=new PanelTextInput(s,r,o,h),this.panelTextInput.x=this.panelBaseItem.width-600,this.panelTextInput=new PanelTextInput(s,r,o,h,a=>{this.isIncrease=a===0?null:a>0}),this.panelTextInput.x=-90,this.panelBaseItem.addChild(this.panelTextInput),this.increaseDisabledBtn=new ButtonLink({text:c.increase,labelFontSize:16}),this.increaseDisabledBtn.x=this.panelBaseItem.width-430,this.panelBaseItem.addChild(this.increaseDisabledBtn),this.increaseEnabledBtn=new ButtonReset({text:c.increase,labelFontSize:16,width:130}),this.increaseEnabledBtn.x=this.panelBaseItem.width-430,this.panelBaseItem.addChild(this.increaseEnabledBtn),this.decreaseEnabledBtn=new ButtonReset({text:c.decrease,labelFontSize:16,width:130}),this.decreaseEnabledBtn.x=this.panelBaseItem.width-290,this.panelBaseItem.addChild(this.decreaseEnabledBtn),this.decreaseDisabledBtn=new ButtonLink({text:c.decrease,labelFontSize:16}),this.decreaseDisabledBtn.x=this.panelBaseItem.width-290,this.panelBaseItem.addChild(this.decreaseDisabledBtn),this.increaseEnabledBtn.visible=!1,this.decreaseEnabledBtn.visible=!1}set isIncrease(t){t!==null?(this.increaseEnabledBtn.visible=t,this.decreaseDisabledBtn.visible=t,this.increaseDisabledBtn.visible=!t,this.decreaseEnabledBtn.visible=!t):(this.increaseEnabledBtn.visible=!1,this.decreaseDisabledBtn.visible=!0,this.increaseDisabledBtn.visible=!0,this.decreaseEnabledBtn.visible=!1)}get isIncrease(){return this.increaseDisabledBtn.visible&&this.decreaseDisabledBtn.visible?null:this.increaseEnabledBtn.visible}}class PanelBaseItem extends Container{constructor(){super();ne(this,"panelBase");this.scale.set(.8),this.panelBase=new RoundedBox({width:680,height:70,alpha:.06,shadow:!1,color:16777215}),this.addChild(this.panelBase)}}class PanelTextInput extends Container{constructor(t,s,r,o,h){super();ne(this,"layout");ne(this,"panelBase");ne(this,"container");ne(this,"textInput");ne(this,"dollarLabel");ne(this,"bet");ne(this,"nDecimals");ne(this,"onEnter");this.onEnter=h,this.scale.set(.8),this.bet=0,this.nDecimals=t,this.container=new Container,this.addChild(this.container),this.panelBase=new RoundedBox({width:250,height:60,alpha:.08,shadow:!1,color:16777215}),this.container.addChild(this.panelBase),this.layout=new Layout({type:"horizontal"}),this.layout.x=-this.panelBase.boxWidth*.5+50,this.container.addChild(this.layout),this.dollarLabel=new Label(s,{fontFamily:"Epilogue Bold",fontSize:24}),s&&this.layout.addChild(this.dollarLabel),this.textInput=new TextInput({placeholder:"bets",fontSize:22,width:350,height:50},t,c=>{this.bet=c,h&&h(c)},r,o),this.textInput.value=this.bet.toFixed(this.nDecimals),this.textInput.pivot.x=this.textInput.width*.3,this.textInput.pivot.y=this.textInput.height/2,this.layout.addChild(this.textInput)}set value(t){this.bet=t,this.textInput.value=this.bet.toFixed(this.nDecimals),this.onEnter&&this.onEnter(t)}}const defaultPreviousButtonOptions={text:"",drawWidth:25,labelColor:16777215,labelFontSize:14,radius:20};class PreviousButton extends FancyButton{constructor(t={}){const s={...defaultPreviousButtonOptions,...t},r=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),o=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),h=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth),c=new Graphics().beginFill(1155406).drawCircle(0,0,s.drawWidth);super({defaultView:r,hoverView:o,pressedView:h,disabledView:c});ne(this,"label");ne(this,"container");this.container=new Container,this.addChild(this.container),this.defaultView&&this.container.addChild(this.defaultView),this.hoverView&&this.container.addChild(this.hoverView),this.pressedView&&this.container.addChild(this.pressedView),this.disabledView&&this.container.addChild(this.disabledView),this.label=new Label(s.text,{fill:s.labelColor,align:"center",fontSize:s.labelFontSize}),this.container.addChild(this.label),this.onDown.connect(this.handleDown.bind(this)),this.onUp.connect(this.handleUp.bind(this)),this.onHover.connect(this.handleHover.bind(this)),this.on("pointerupoutside",this.handleUp.bind(this)),this.on("pointerout",this.handleUp.bind(this))}set text(t){this.label.text=t}set fillDisabledLabel(t){this.label.style.fill=t}handleHover(){sfx.play("common/sfx-hover.wav")}handleDown(){sfx.play("common/sfx-press.wav")}handleUp(){}async show(t=!0){gsapWithCSS.killTweensOf(this.scale),this.visible=!0,t?(this.scale.set(0),await gsapWithCSS.to(this.scale,{x:.8,y:.8,duration:.3,ease:"back.out"})):this.scale.set(.8)}async hide(t=!0){gsapWithCSS.killTweensOf(this.scale),t?await gsapWithCSS.to(this.scale,{x:0,y:0,duration:.3,ease:"back.in"}):this.scale.set(0),this.visible=!1}disabled(){this.enabled=!1,this.label.style.fill=16777215,this.label.alpha=.5}activated(){this.enabled=!0,this.label.style.fill=2369584,this.label.alpha=1}}class HomeScreen extends Container{constructor(){var r,o,h,c,a;super();ne(this,"nextGameLabel");ne(this,"betClosedLabel");ne(this,"gameOverLabel");ne(this,"youWinLabel");ne(this,"backgroundFanLabels");ne(this,"header");ne(this,"bets");ne(this,"logo");ne(this,"graphicsAutomaticCashing");ne(this,"automaticCashingCurrency");ne(this,"automaticCashingMultiplier");ne(this,"progressBar");ne(this,"connectionStatus");ne(this,"panelSetting");ne(this,"previousResults");ne(this,"layout");ne(this,"containerBtn");ne(this,"betButton");ne(this,"cancelButton");ne(this,"cashoutButton");ne(this,"undoButton");ne(this,"replayButton");ne(this,"previousResultButton");ne(this,"automaticCashingButton");ne(this,"problemOcurredPopup");ne(this,"onGameEnding",async t=>{if(!t)return;let s=!!game.bet;this.automaticCashingCurrency.enabled=!s,this.automaticCashingMultiplier.enabled=!s,this.bets.enabled=!s,this.betButton.hide(!1),this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!1,game.hasWon?(this.youWinLabel.visibleLabel=!0,this.gameOverLabel.winValue=`${game.multiplier.toFixed(2)}x`,this.gameOverLabel.visibleLabel=!0):(this.youWinLabel.visibleLabel=!1,this.gameOverLabel.winValue=`${game.multiplier.toFixed(2)}x`,this.gameOverLabel.visibleLabel=!0),await waitFor(1),await this.logo.show()});ne(this,"onGamePlaying",async t=>{t&&(user.status===UserStatusEnum.SPECTING?(this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.automaticCashingCurrency.switchOff(),this.automaticCashingMultiplier.switchOff(),this.cancelButton.visible=!1,this.betButton.show(!0),this.betButton.activated(),this.cashoutButton.hide(!0)):user.status===UserStatusEnum.BETTING?(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!0,this.betButton.hide(!0),this.betButton.disabled(),this.cashoutButton.hide(!1)):(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!1,this.betButton.hide(!0),this.betButton.disabled(),this.cashoutButton.show(!0)),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cashoutButton.enabled=!0,this.progressBar.visible=!0,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!1,this.gameOverLabel.visibleLabel=!1,this.youWinLabel.visibleLabel=!1,await this.logo.hide()),this.progressBar.multiplier=game.multiplier});ne(this,"onGameStarting",async t=>{let s=!!game.bet;t&&(this.automaticCashingCurrency.enabled=!s,this.automaticCashingMultiplier.enabled=!s,this.bets.enabled=!s,this.undoButton.enabled=!0,this.replayButton.enabled=!0,user.status===UserStatusEnum.SPECTING?(this.cancelButton.visible=!1,this.betButton.show(!0),this.betButton.activated()):user.status===UserStatusEnum.BETTING?(this.cancelButton.visible=!0,this.betButton.visible=!1):(this.cancelButton.visible=!0,this.betButton.visible=!1),this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!0,this.betClosedLabel.visible=!1,this.gameOverLabel.visibleLabel=!1,this.youWinLabel.visibleLabel=!1);const r=(game.startAt.getTime()-new Date().getTime())/1e3;r>=0&&(this.nextGameLabel.text=i18n.translatedText.nextGameLabelText(r))});ne(this,"onGameLocking",async t=>{t&&(this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.betButton.show(!1),this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0,this.cancelButton.visible=!1,this.cashoutButton.hide(!1),this.progressBar.visible=!1,this.nextGameLabel.visible=!1,this.betClosedLabel.visible=!0,this.gameOverLabel.visibleLabel=!1)});ne(this,"handlerBet",async(t,s,r,o)=>{this.automaticCashingCurrency.enabled=!1,this.automaticCashingMultiplier.enabled=!1,this.bets.enabled=!1,this.cancelButton.visible=!1,this.betButton.visible=!0,this.betButton.disabled(),this.undoButton.enabled=!1,this.replayButton.enabled=!0;try{if(user.budget-t<0)throw Error("Not Enough Coins");let{coins:h}=await backendService.bet(t,s,r,o);this.betButton.visible=!1,this.cancelButton.activated(),this.cancelButton.visible=!0,this.bets.value=h,this.header.refreshUserDetails(),this.bets.value=t,r?(this.automaticCashingCurrency.bets.value=r,this.automaticCashingCurrency.switchOff(1)):this.automaticCashingCurrency.switchOff(0),s?(this.automaticCashingMultiplier.bets.value=s,this.automaticCashingMultiplier.switchOff(1)):this.automaticCashingMultiplier.switchOff(0);return}catch(h){throw this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.betButton.visible=!0,this.betButton.activated(),this.undoButton.enabled=!0,this.replayButton.enabled=!0,this.cancelButton.visible=!1,h}});ne(this,"handlerCancelBet",async()=>{this.cancelButton.disabled();try{await backendService.cancelBet(),this.header.refreshUserDetails(),this.automaticCashingCurrency.enabled=!0,this.automaticCashingMultiplier.enabled=!0,this.bets.enabled=!0,this.betButton.show(!0),this.betButton.activated(),this.undoButton.enabled=!0,this.replayButton.enabled=!0,this.cancelButton.visible=!1}catch{this.cancelButton.activated()}});ne(this,"handlerCashout",async()=>{this.cashoutButton.enabled=!1;let t=await backendService.cashOut();t.profit>0&&(this.youWinLabel.winValue=`$${t.profit.toFixed(2)}`,this.youWinLabel.visibleLabel=!0,this.cancelButton.visible=!1,this.header.refreshUserDetails())});const t=i18n.translatedText;this.logo=new Logo({scale:.25}),this.addChild(this.logo),this.layout=new Layout({type:"horizontal",elementsMargin:10}),this.addChild(this.layout),this.undoButton=new IconButton({image:"icon-unde",imageDisabled:"icon-unde-disabled"}),this.layout.addChild(this.undoButton),this.containerBtn=new Container,this.containerBtn.pivot.x=this.containerBtn.width/2,this.containerBtn.pivot.y=this.containerBtn.height/2,this.layout.addChild(this.containerBtn),this.betButton=new Button({text:t.betButtonText}),this.betButton.onPress.connect(()=>{this.handlerBet(this.bets.bet,this.automaticCashingMultiplier.value?this.automaticCashingMultiplier.bet:void 0,this.automaticCashingCurrency.value?this.automaticCashingCurrency.bet:void 0).then(()=>{}).catch(u=>{if(u!=null&&u.validationErrors){let d=u.validationErrors.map(p=>p!=null&&p.args?"- "+p.message(p.args):"- "+p.message);this.problemOcurredPopup.setText("A problem ocurred",`${d.join(`
`)}`),this.problemOcurredPopup.visible=!0}else u!=null&&u.serverError&&(this.problemOcurredPopup.setText("A problem ocurred",`${u.serverError}`),this.problemOcurredPopup.visible=!0)})}),this.containerBtn.addChild(this.betButton),this.cancelButton=new ButtonCancel({text:t.cancelButtonText}),this.cancelButton.onPress.connect(this.handlerCancelBet.bind(this)),this.cancelButton.visible=!1,this.containerBtn.addChild(this.cancelButton),this.cashoutButton=new Button({text:t.cashOutButtonText}),this.cashoutButton.onPress.connect(this.handlerCashout.bind(this)),this.containerBtn.addChild(this.cashoutButton),this.replayButton=new IconButton({image:"icon-replay",imageDisabled:"icon-replay-disabled"}),this.replayButton.onPress.connect(()=>navigation.presentPopup(AutoBetPopup)),this.layout.addChild(this.replayButton),this.previousResultButton=new PreviousButton({text:"G"}),this.previousResultButton.onPress.connect(()=>{this.previousResults.visible=!this.previousResults.visible}),this.addChild(this.previousResultButton),this.automaticCashingButton=new IconButton({image:"icon-tool",imageDisabled:"icon-replay-disabled"}),this.automaticCashingButton.onPress.connect(()=>{this.graphicsAutomaticCashing.visible=!this.graphicsAutomaticCashing.visible}),this.addChild(this.automaticCashingButton),this.header=new Header,this.addChild(this.header),this.bets=new Bets(((r=game.bet)==null?void 0:r.coins)||1,1,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxBet),this.addChild(this.bets);const s=responsive.getIsDesktop?.1:1;this.graphicsAutomaticCashing=new Graphics().beginFill(0,s).drawRoundedRect(0,0,480,160,24).endFill(),this.graphicsAutomaticCashing.pivot.x=this.graphicsAutomaticCashing.width/2,this.addChild(this.graphicsAutomaticCashing),this.automaticCashingCurrency=new AutomaticCashing(((o=game.bet)==null?void 0:o.autoProfit)||2,!!((h=game.bet)!=null&&h.autoProfit),t.automaticCurrencyCashingText,"$ ",backendConfigs.betPrecision,backendConfigs.minBet,backendConfigs.maxProfit,`${t.maximum} $ ${backendConfigs.maxBet.toFixed(2)}`),this.automaticCashingMultiplier=new AutomaticCashing(((c=game.bet)==null?void 0:c.autoMultiplier)||2,!!((a=game.bet)!=null&&a.autoMultiplier),t.automaticMultiplierCashingText,"x ",backendConfigs.multiplierPrecision,backendConfigs.minMultiplier,backendConfigs.maxMultiplier,`${t.minimum} x1.01 / ${t.maximum} x${backendConfigs.maxMultiplier}`),responsive.getIsDesktop?(this.previousResultButton.visible=!1,this.automaticCashingButton.visible=!1,this.graphicsAutomaticCashing.visible=!0):(this.previousResultButton.visible=!0,this.automaticCashingButton.visible=!0,this.graphicsAutomaticCashing.visible=!1),this.automaticCashingMultiplier.x=this.graphicsAutomaticCashing.width/2,this.automaticCashingMultiplier.y=40,this.automaticCashingCurrency.x=this.graphicsAutomaticCashing.width/2,this.automaticCashingCurrency.y=110,this.graphicsAutomaticCashing.addChild(this.automaticCashingCurrency),this.graphicsAutomaticCashing.addChild(this.automaticCashingMultiplier),this.progressBar=new ProgressBarMultiplier(backendConfigs.maxMultiplier),this.progressBar.pivot.x=this.progressBar.width/2,this.addChild(this.progressBar),this.nextGameLabel=new Label("",{fontSize:45,fill:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.nextGameLabel.visible=!1,this.addChild(this.nextGameLabel),this.gameOverLabel=new Result(t.gameOverLabelText),this.gameOverLabel.visibleLabel=!1,this.addChild(this.gameOverLabel),this.backgroundFanLabels={},this.betClosedLabel=new Label(t.betClosedLabelText,{fontSize:45,fill:15887982,stroke:16777215,fontFamily:"Epilogue Bold",lineJoin:"bevel",strokeThickness:6}),this.betClosedLabel.visible=!1,this.addChild(this.betClosedLabel),this.connectionStatus=new ConnectionStatus,this.connectionStatus.stableConnection(0),backendService.sentLatencyStatus=u=>{u<=100?this.connectionStatus.stableConnection(u):this.connectionStatus.unstableConnection(u)},this.addChild(this.connectionStatus),this.panelSetting=new PanelSetting,this.addChild(this.panelSetting),this.youWinLabel=new Result(t.youWinLabelText),this.youWinLabel.visibleLabel=!1,this.addChild(this.youWinLabel),this.previousResults=new PreviousResults,responsive.getIsDesktop||(this.previousResults.visible=!1),backendService.callbackPreviousMultipliers=(u,d)=>{d?this.previousResultButton.text="G":this.previousResultButton.text=`${u[0]}x`,this.previousResults.updateResults(u,d)},this.addChild(this.previousResults),backendService.callbackAutomaticCashOut=u=>{u>0&&(this.youWinLabel.winValue=`$${u.toFixed(2)}`,this.youWinLabel.visibleLabel=!0,this.cancelButton.visible=!1,this.header.refreshUserDetails())},backendService.callbackBackgroundFan=u=>{const d=new Result(i18n.translatedText.backgroundFanText,15,20);d.visibleLabel=!1,this.addChild(d),d.x=window.innerWidth*.7,d.y=window.innerHeight*.3;const p=uuid_1.v4();this.backgroundFanLabels[p]=d,d.winValue=u.toFixed(2),d.visibleLabel=!0,setTimeout(()=>{d.visibleLabel=!1,this.removeChild(d),delete this.backgroundFanLabels[p]},2e3)},game.addObserver(this),game.flush(),this.problemOcurredPopup=new ProblemOccurredPopup,this.problemOcurredPopup.visible=!1,this.problemOcurredPopup.interactive=!0,this.problemOcurredPopup.on("click",()=>{this.problemOcurredPopup.visible=!1}),this.addChild(this.problemOcurredPopup),i18n.callback=u=>{this.betButton.label.text=u.betButtonText,this.cancelButton.label.text=u.cancelButtonText,this.cashoutButton.label.text=u.cashOutButtonText,this.betClosedLabel.text=u.betClosedLabelText,this.automaticCashingCurrency.updateText(u.automaticCurrencyCashingText),this.automaticCashingMultiplier.updateText(u.automaticMultiplierCashingText),this.gameOverLabel.updateText(u.gameOverLabelText),this.youWinLabel.updateText(u.youWinLabelText),Object.values(this.backgroundFanLabels).forEach(d=>{d.updateText(u.backgroundFanText)})}}resize(t,s){this.logo.x=t*.5,this.logo.y=190,this.layout.pivot.x=this.layout.width/2,this.layout.pivot.y=this.layout.height/2,this.layout.x=t*.5+25,this.layout.y=s-40,this.nextGameLabel.x=t*.5,this.nextGameLabel.y=s*.5,this.gameOverLabel.x=t*.5,this.gameOverLabel.y=s*.55,Object.values(this.backgroundFanLabels).forEach(r=>{r.x=t*.7,r.y=s*.3}),this.betClosedLabel.x=t*.5,this.betClosedLabel.y=s*.5,this.youWinLabel.x=t*.5,this.youWinLabel.y=s*.45,this.progressBar.x=t*.5,this.progressBar.y=120,this.header.resize(t),this.bets.x=t/2,this.bets.y=s-140,this.connectionStatus.x=10,this.connectionStatus.y=70,responsive.getIsDesktop?(this.previousResults.x=t-250,this.previousResults.y=s-200,this.graphicsAutomaticCashing.x=300,this.graphicsAutomaticCashing.y=s-180,this.panelSetting.x=t-355,this.panelSetting.y=80):(this.previousResults.x=t/2,this.previousResults.y=s-350,this.graphicsAutomaticCashing.x=t/2,this.graphicsAutomaticCashing.y=s-340,this.panelSetting.x=t-40,this.panelSetting.y=100),this.problemOcurredPopup.resize(t,s),this.previousResultButton.x=t/2+140,this.previousResultButton.y=s-140,this.automaticCashingButton.x=t/2-140,this.automaticCashingButton.y=s-140}update(){}async show(){bgm.play("common/bgm-main.mp3",{volume:.7}),await waitFor(.5),this.interactiveChildren=!0}async hide(){await waitFor(.1)}}ne(HomeScreen,"assetBundles",["home","common"]);class LoadScreen extends Container{constructor(){super();ne(this,"fsLogo");ne(this,"message");ne(this,"logo");this.logo=new Logo({scale:.3}),this.addChild(this.logo),this.fsLogo=new FsLogo({scale:1.2}),this.addChild(this.fsLogo),this.message=new Text(i18n.translatedText.loadingMessage,{fill:0,fontFamily:"Verdana",align:"center"}),this.message.anchor.set(.5),this.addChild(this.message)}resize(t,s){this.logo.x=t*.5,this.logo.y=s*.5,this.message.x=t*.5,this.message.y=s*.75,this.fsLogo.x=t*.5,this.fsLogo.y=s-50}async show(){gsapWithCSS.killTweensOf(this.message),this.message.alpha=1}async hide(){this.message.text=i18n.translatedText.loadingDoneMessage,gsapWithCSS.killTweensOf(this.message),await gsapWithCSS.to(this.message,{alpha:0,duration:.3,ease:"linear",delay:.5})}}ne(LoadScreen,"assetBundles",["preload"]);class BackgroundStadium extends Container{constructor(){super();ne(this,"direction",-Math.PI*.15);ne(this,"sprite");ne(this,"spriteBg");this.sprite=new Sprite(Texture.from("stadium")),console.log("width = ",this.sprite.width),this.spriteBg=new Sprite(Texture.from("bg-stadius")),this.sprite.anchor.set(.5,0),this.spriteBg.anchor.set(.5,0),this.addChild(this.sprite),this.addChild(this.spriteBg)}get width(){return this.sprite.width}get height(){return this.sprite.height}resize(t,s){this.sprite.x=.5*t,this.sprite.y=0,this.sprite.scale.set(s/this.sprite.height),this.spriteBg.x=.5*t,this.spriteBg.y=0,this.spriteBg.width=t,this.spriteBg.height=s}}class ConnectionLostPopup extends Container{constructor(){super();ne(this,"bg");ne(this,"panel");ne(this,"panelBase");ne(this,"iconReconnecting");ne(this,"title");ne(this,"subtitle");this.bg=Sprite.from(Texture.WHITE),this.bg.alpha=.3,this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new Container,this.addChild(this.panel),this.panelBase=new RoundedBox({width:450,height:250,shadow:!1,radius:24}),this.panelBase.filters=[new AlphaFilter(.6),new BlurFilter],this.panel.addChild(this.panelBase),this.iconReconnecting=Sprite.from("icon-reconnecting"),this.iconReconnecting.y=-70,this.iconReconnecting.anchor.set(.5),this.panel.addChild(this.iconReconnecting),this.title=new Label("You are reconnecting",{fontFamily:"Epilogue Bold",fontSize:28}),this.title.y=-10,this.panel.addChild(this.title),this.subtitle=new Label("Hold on a moment, we are trying to reconnect you.",{fontSize:16,breakWords:!0,wordWrap:!0,wordWrapWidth:400}),this.subtitle.y=40,this.subtitle.alpha=.7,this.panel.addChild(this.subtitle)}resize(t,s){this.bg.width=t,this.bg.height=s,this.panel.x=t/2,this.panel.y=s/2}async show(){this.bg.alpha=.8}async hide(){this.bg.alpha=0}}const app=new Application({resolution:Math.max(window.devicePixelRatio,2),backgroundColor:16777215});function resize(){const n=DESKTOP_WIDTH,e=DESKTOP_HEIGHT;if(responsive.getIsDesktop){app.renderer.view.style.width=`${n}px`,app.renderer.view.style.height=`${e}px`,window.scrollTo(0,0);let t,s;t=document.getElementById("scaleable-container"),s=document.getElementById("game-container");let r=Math.min(t.clientWidth/s.clientWidth,t.clientHeight/s.clientHeight),o=Math.round(s.clientWidth*r),h=Math.round(s.clientHeight*r),c=o/s.clientWidth,a=h/s.clientHeight;s.style.transform=`translate(-50%, -50%) scale(${c},${a})`;const u=n,d=e;app.renderer.resize(u,d),navigation.resize(u,d)}else{const t=window.innerWidth,s=window.innerHeight,r=375,o=700,h=t<r?r/t:1.2,c=s<o?o/s:1.2,a=h>c?h:c,u=t*a,d=s*a;app.renderer.view.style.width=`${t}px`,app.renderer.view.style.height=`${s}px`,window.scrollTo(0,0);let p;p=document.getElementById("game-container"),p.style.height="100%",app.renderer.resize(u,d),navigation.resize(u,d)}}function visibilityChange(){document.hidden?(qt.pauseAll(),navigation.blur()):(qt.resumeAll(),navigation.focus())}async function initGame(){try{await backendService.startConnection(async()=>{navigation.currentScreen instanceof ConnectionLostPopup||await navigation.presentPopup(ConnectionLostPopup),await initGame()}),navigation.dismissPopup(),await navigation.showScreen(HomeScreen)}catch{await waitFor(.5),await initGame()}}async function init(){var t;app.view.id="CrashGameFS",(t=document.getElementById("pixiContainer"))==null||t.appendChild(app.view);const n=1920,e=window.innerWidth>n?n:window.innerWidth;responsive.checkResponsive(e),window.addEventListener("resize",resize),resize(),document.addEventListener("visibilitychange",visibilityChange),await initAssets(),navigation.setBackground(BackgroundStadium),await navigation.showScreen(LoadScreen),app.ticker.add(game.update,game),app.ticker.maxFPS=10,await initGame()}init();
